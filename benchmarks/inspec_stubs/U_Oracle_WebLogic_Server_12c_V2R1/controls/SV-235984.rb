control 'SV-235984' do
  title 'Oracle WebLogic must ensure authentication of both client and server during the entire session.'
  desc "This control focuses on communications protection at the session, versus packet level. 

At the application layer, session IDs are tokens generated by web applications to uniquely identify an application user's session. Web applications utilize session tokens or session IDs in order to establish application user identity. Proper use of session IDs addresses man-in-the-middle attacks, including session hijacking or insertion of false information into a session. 

Application servers must provide the capability to perform mutual authentication. Mutual authentication is when both the client and the server authenticate each other."
  desc 'check', "1. Access AC
2. From 'Domain Structure', select 'Environment' -> 'Servers' 
3. From the list of servers, select one which needs check for Mutual Authentication configuration verification
4. From 'Configuration' tab -> 'General' tab, ensure 'Listen Port Enabled' checkbox is deselected
5. Ensure 'SSL Listen Port Enabled' checkbox is selected and a valid port number is in 'SSL Listen Port' field, e.g., 7002
6. From 'Configuration' tab -> 'SSL' tab, click 'Advanced' link
7. Ensure 'Two Way Client Cert Behavior' field value is set to 'Client Certs Requested And Enforced'
8. Repeat steps 3-7 for all servers requiring Mutual Authentication configuration checking

If any servers requiring Mutual Authentication do not have the 'SSL Listen Port Enabled' checkbox selected or the 'Two Way Client Cert Behavior' field value set to 'Client Certs Requested And Enforced', this is a finding."
  desc 'fix', "1. Obtain the certificate(s) for the trusted certificate authority that signed the certificates for the client(s)
2. Access EM 
3. Select the domain from the navigation tree, and use the dropdown to select 'WebLogic Domain' -> 'Security' -> 'Keystore' 
4. Locate the desired keystore in which to load the client certificate(s), select and click 'Manage' button
5. From 'Manage Certificates' page, click 'Import'
6. Complete 'Certificate Type', 'Alias' and 'Certificate Source' fields and click 'OK'. Ensure the imported certificate(s) appears in the list.
7. Access AC
8. Utilize 'Change Center' to create a new change session
9. From 'Domain Structure', select 'Environment' -> 'Servers' 
10. From the list of servers, select one which needs Mutual Authentication set up
11. From 'Configuration' tab -> 'SSL' tab, click 'Advanced' link
12. Set 'Two Way Client Cert Behavior' field value is set to 'Client Certs Requested And Enforced'
13. Repeat steps 7-12 for all servers requiring SSL configuration
14. From 'Domain Structure', select 'Environment' -> 'Servers', click 'Control' tab
15. Select checkbox for all servers configured in previous steps and click 'Restart SSL'"
  impact 0.5
  ref 'DPMS Target Oracle WebLogic Server 12c'
  tag check_id: 'C-39203r628728_chk'
  tag severity: 'medium'
  tag gid: 'V-235984'
  tag rid: 'SV-235984r628730_rule'
  tag stig_id: 'WBLC-08-000223'
  tag gtitle: 'SRG-APP-000219-AS-000147'
  tag fix_id: 'F-39166r628729_fix'
  tag 'documentable'
  tag legacy: ['SV-70575', 'V-56321']
  tag cci: ['CCI-001184']
  tag nist: ['SC-23']
end
