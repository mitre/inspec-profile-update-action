control 'SV-215606' do
  title 'The Windows 2012 DNS Server permissions must be set so that the key file can only be read or modified by the account that runs the name server software.'
  desc 'To enable zone transfer (requests and responses) through authenticated messages, it is necessary to generate a key for every pair of name servers. The key can also be used for securing other transactions, such as dynamic updates, DNS queries, and responses. The binary key string that is generated by most key generation utilities used with DNSSEC is Base64-encoded. TSIG is a string used to generate the message authentication hash stored in a TSIG RR and used to authenticate an entire DNS message.'
  desc 'check', "Access Windows Explorer.

Navigate to the following location:
%ALLUSERSPROFILE%\\Microsoft\\Crypto
Note: If the %ALLUSERSPROFILE%\\Microsoft\\Crypto folder doesn't exist, this is not applicable.

Verify the permissions on the folder, sub-folders and files are limited to “SYSTEM” and Administrators for “FULL CONTROL”.

If any other user or group has greater than READ permissions to the %ALLUSERSPROFILE%\\Microsoft\\Crypto folder, sub-folders and files, this is a finding."
  desc 'fix', 'Access Windows Explorer.

Navigate to the following location:
%ALLUSERSPROFILE%\\Microsoft\\Crypto

Modify permissions on the folder, sub-folders and files to “FULL CONTROL” for “SYSTEM” and Administrators  and to “READ” for all other Users/Groups.'
  impact 0.5
  ref 'DPMS Target Microsoft Windows 2012 Server Domain Name System'
  tag check_id: 'C-16800r314293_chk'
  tag severity: 'medium'
  tag gid: 'V-215606'
  tag rid: 'SV-215606r561297_rule'
  tag stig_id: 'WDNS-IA-000008'
  tag gtitle: 'SRG-APP-000176-DNS-000019'
  tag fix_id: 'F-16798r314294_fix'
  tag 'documentable'
  tag legacy: ['SV-73075', 'V-58645']
  tag cci: ['CCI-000186']
  tag nist: ['IA-5 (2) (a) (1)']
end
