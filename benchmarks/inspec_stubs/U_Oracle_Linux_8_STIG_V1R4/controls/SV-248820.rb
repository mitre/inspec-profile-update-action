control 'SV-248820' do
  title 'OL 8 must compare internal information system clocks at least every 24 hours with a server synchronized to an authoritative time source, such as the United States Naval Observatory (USNO) time servers, or a time server designated for the appropriate DoD network (NIPRNet/SIPRNet), and/or the Global Positioning System (GPS).'
  desc 'Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside the configured acceptable allowance (drift) may be inaccurate. 
 
Synchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network. 
 
Organizations should consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints). 
 
If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis. 
 
Time stamps generated by the operating system include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC. 
 
OL 8 uses the "timedatectl" command to view the status of the "systemd-timesyncd.service". The "timedatectl" status will display the local time, UTC, and the offset from UTC. 
 
Note that USNO offers authenticated NTP service to DoD and U.S. Government agencies operating on the NIPR and SIPR networks. Visit https://www.usno.navy.mil/USNO/time/ntp/dod-customers for more information.

'
  desc 'check', 'Verify OL 8 is comparing internal information system clocks at least every 24 hours with an NTP server with the following command: 
 
$ sudo grep maxpoll /etc/chrony.conf 
 
server [ntp.server.name] iburst maxpoll 16 
 
If the "maxpoll" option is set to a number greater than "16" or the line is commented out, this is a finding.'
  desc 'fix', 'Configure OL 8 to compare internal information system clocks at least every 24 hours with an NTP server by adding/modifying the following line in the "/etc/chrony.conf" file. 
 
server [ntp.server.name] iburst maxpoll 16'
  impact 0.5
  ref 'DPMS Target Oracle Linux 8'
  tag check_id: 'C-52254r780024_chk'
  tag severity: 'medium'
  tag gid: 'V-248820'
  tag rid: 'SV-248820r853845_rule'
  tag stig_id: 'OL08-00-030740'
  tag gtitle: 'SRG-OS-000355-GPOS-00143'
  tag fix_id: 'F-52208r780025_fix'
  tag satisfies: ['SRG-OS-000355-GPOS-00143', 'SRG-OS-000356-GPOS-00144', 'SRG-OS-000359-GPOS-00146']
  tag 'documentable'
  tag cci: ['CCI-001890', 'CCI-001891', 'CCI-002046']
  tag nist: ['AU-8 b', 'AU-8 (1) (a)', 'AU-8 (1) (b)']
end
