control 'SV-220430' do
  title 'The Cisco switch must be configured to drop all fragmented Internet Control Message Protocol (ICMP) packets destined to itself.'
  desc "Fragmented ICMP packets can be generated by hackers for denial-of-service (DoS) attacks such as Ping O' Death and Teardrop. It is imperative that all fragmented ICMP packets are dropped."
  desc 'check', 'Review the external and internal access control lists (ACLs) to verify that the switch is configured drop all fragmented ICMP packets destined to itself. 

ip access-list extended EXTERNAL_ACL 
 deny icmp any host x.11.1.2 fragments 
 permit icmp host x.11.1.1 host x.11.1.2 echo 
… 
 … 
deny ip any any 
! 
ip access-list extended INTERNAL_ACL 
deny icmp any host 10.1.12.2 fragments 
permit icmp any any 

Note: Ensure the statement to deny ICMP fragments is before any permit statements for ICMP. 

If the switch is not configured to drop all fragmented ICMP packets destined to itself, this is a finding.'
  desc 'fix', 'Configure the external and internal ACLs to drop all fragmented ICMP packets destined to itself as shown in the example below: 

SW1(config)#ip access-list extended EXTERNAL_ACL 
SW1(config-ext-nacl)#deny icmp any host x.11.1.2 fragments 

SW1(config)#ip access-list extended INTERNAL_ACL 
SW1(config-ext-nacl)#deny icmp any host 10.1.12.2 fragments 

Note: Ensure the above statement is before any permit statements for ICMP.'
  impact 0.5
  ref 'DPMS Target Cisco IOS Switch RTR'
  tag check_id: 'C-22145r508375_chk'
  tag severity: 'medium'
  tag gid: 'V-220430'
  tag rid: 'SV-220430r622190_rule'
  tag stig_id: 'CISC-RT-000140'
  tag gtitle: 'SRG-NET-000205-RTR-000002'
  tag fix_id: 'F-22134r508376_fix'
  tag 'documentable'
  tag legacy: ['SV-110707', 'V-101603']
  tag cci: ['CCI-001097']
  tag nist: ['SC-7 a']
end
