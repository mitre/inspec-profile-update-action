control 'SV-94939' do
  title 'Samsung Android 8 with Knox must implement the management setting: Disable Manual Date Time Changes.'
  desc 'Determining the correct time a particular application event occurred on a system is critical when conducting forensic analysis and investigating system events. 

Periodically synchronizing internal clocks with an authoritative time source is needed in order to correctly correlate the timing of events that occur across the enterprise. The three authoritative time sources for Samsung Android 8 with Knox are an authoritative time server that is synchronized with redundant United States Naval Observatory (USNO) time servers as designated for the appropriate DoD network (NIPRNet or SIPRNet), or the Global Positioning System (GPS), or the wireless carrier.

Time stamps generated by the audit system in Samsung Android 8 with Knox must include both date and time. The time may be expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.

SFR ID: FMT_SMF_EXT.1.1 #47'
  desc 'check', 'Review Samsung Android 8 with Knox configuration settings to determine if the mobile device is configured to disable manual date and time changes.

This validation procedure is performed on both the MDM Administration Console and the Samsung Android 8 with Knox device.

On the MDM console, do the following:
1. Ask the MDM Administrator to display the "Date Time Changes Enabled" check box in the "Android Date Time" rule. 
2. Verify the check box is not selected.

On the Samsung Android 8 with Knox device, do the following:
1. Open the device settings.
2. Select "General management".
3. Select "Date and time".
4. Verify "Automatic date and time" is on.
5. Verify a user cannot turn off "Automatic date and time".

If the MDM console "Date Time Changes Enabled" is set or on the Samsung Android 8 with Knox device, "Automatic date and time" is not set or the user is able to turn off this option, this is a finding.'
  desc 'fix', 'Configure Samsung Android 8 with Knox to disable manual date and time changes.

On the MDM console, deselect the "Date Time Changes Enabled" check box in the "Android Date Time" rule.'
  impact 0.5
  ref 'DPMS Target Samsung Android OS 8 with Knox 3.x - COBO use case'
  tag check_id: 'C-79907r1_chk'
  tag severity: 'medium'
  tag gid: 'V-80235'
  tag rid: 'SV-94939r1_rule'
  tag stig_id: 'KNOX-08-015500'
  tag gtitle: 'PP-MDF-991000'
  tag fix_id: 'F-87041r1_fix'
  tag 'documentable'
  tag cci: ['CCI-000366']
  tag nist: ['CM-6 b']
end
