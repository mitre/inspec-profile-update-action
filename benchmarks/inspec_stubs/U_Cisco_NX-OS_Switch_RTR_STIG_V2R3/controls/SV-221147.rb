control 'SV-221147' do
  title 'The Cisco Multicast Source Discovery Protocol (MSDP) switch must be configured to use a loopback address as the source address when originating MSDP traffic.'
  desc 'Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of MSDP switches. It is easier to construct appropriate ingress filters for switch management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the switchâ€™s loopback address instead of the numerous physical interface addresses.'
  desc 'check', 'Step 1: Review the switch configuration to verify that a loopback address has been configured.

interface Loopback12
 ip address x.12.2.2/32

Step 2: Verify that the loopback interface is used as the source address for all MSDP packets generated by the switch.

ip msdp peer x.44.2.34 connect-source Loopback12 remote-as nn

If the switch does not use its loopback address as the source address when originating MSDP traffic, this is a finding.'
  desc 'fix', 'Configure the switch to use its loopback address is used as the source address when sending MSDP packets.

SW1(config)# ip msdp peer x.44.2.34 connect-source lo12 remote-as nn'
  impact 0.3
  ref 'DPMS Target Cisco NX-OS Switch RTR'
  tag check_id: 'C-22862r409930_chk'
  tag severity: 'low'
  tag gid: 'V-221147'
  tag rid: 'SV-221147r622190_rule'
  tag stig_id: 'CISC-RT-000950'
  tag gtitle: 'SRG-NET-000512-RTR-000011'
  tag fix_id: 'F-22851r409931_fix'
  tag 'documentable'
  tag legacy: ['SV-111267', 'V-102311']
  tag cci: ['CCI-000366']
  tag nist: ['CM-6 b']
end
