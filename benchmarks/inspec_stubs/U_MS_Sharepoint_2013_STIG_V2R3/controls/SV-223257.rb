control 'SV-223257' do
  title 'SharePoint must ensure authentication of both client and server during the entire session. An example of this is SSL Mutual Authentication.'
  desc "This control focuses on communications protection at the session, versus packet level.

At the application layer, session IDs are tokens generated by web applications to uniquely identify an application user's session. Web applications utilize session tokens or session IDs in order to establish application user identity. Proper use of session IDs addresses man-in-the-middle attacks, including session hijacking or insertion of false information into a session. This control is only implemented where deemed necessary by the organization (e.g., sessions in service-oriented architectures providing web-based services)."
  desc 'check', 'Review the SharePoint server configuration to ensure SSL Mutual authentication of both client and server during the entire session.

Navigate to Central Administration.

Under “System Settings”, click “Configure Alternate Access mappings”.

Review the “Public URL for zone” column values. If any URL does not begin with “https”, this is a finding.'
  desc 'fix', %q(Configure the SharePoint server to ensure SSL Mutual authentication of both client and server during the entire session.

Open IIS Manager.

In the Connections pane, expand "Sites".

Click the "Web Application" site.

In the Actions pane, click "Bindings".

In the Site Bindings window, click "Add".

In the Add Site Binding window, change "Type" to "https", and select the site's SSL certificate. Click "OK".

Remove all bindings that do not use https.

Click "Close".)
  impact 0.7
  ref 'DPMS Target Microsoft SharePoint 2013'
  tag check_id: 'C-24930r430828_chk'
  tag severity: 'high'
  tag gid: 'V-223257'
  tag rid: 'SV-223257r612235_rule'
  tag stig_id: 'SP13-00-000110'
  tag gtitle: 'SRG-APP-000219'
  tag fix_id: 'F-24918r430829_fix'
  tag 'documentable'
  tag legacy: ['SV-74405', 'V-59975']
  tag cci: ['CCI-001184']
  tag nist: ['SC-23']
end
