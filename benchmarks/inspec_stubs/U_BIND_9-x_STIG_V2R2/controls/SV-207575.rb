control 'SV-207575' do
  title 'Permissions assigned to the dnssec-keygen keys used with the BIND 9.x implementation must enforce read-only access to the key owner and deny access to all other users.'
  desc 'To enable zone transfer (requests and responses) through authenticated messages, it is necessary to generate a key for every pair of name servers. The key also can be used for securing other transactions, such as dynamic updates, DNS queries, and responses. The binary key string that is generated by most key generation utilities used with DNSSEC is Base64-encoded. A TSIG is a string used to generate the message authentication hash stored in a TSIG RR and used to authenticate an entire DNS message. Weak permissions could allow an adversary to modify the file(s), thus defeating the security objective.'
  desc 'check', 'If the server is in a classified network, this is Not Applicable.

With the assistance of the DNS Administrator, identify all dnssec-keygen key files that reside on the BIND 9.x server.

An example dnssec-keygen key file will look like:

Kns1.example.com_ns2.example.com.+161+28823.key
OR
Kns1.example.com_ns2.example.com.+161+28823.private

For each key file identified, verify that the key file is owned by "root":

# ls -al
-r-------- 1 root root 77 Jul 1 15:00 Kns1.example.com_ns2.example.com+161+28823.key

If the key files are more permissive than 400, this is a finding.'
  desc 'fix', 'Change the permissions of the dnssec-keygen key files:

# chmod 400 <key_file>'
  impact 0.5
  ref 'DPMS Target BIND 9.x'
  tag check_id: 'C-7830r283779_chk'
  tag severity: 'medium'
  tag gid: 'V-207575'
  tag rid: 'SV-207575r612253_rule'
  tag stig_id: 'BIND-9X-001142'
  tag gtitle: 'SRG-APP-000516-DNS-000086'
  tag fix_id: 'F-7830r283780_fix'
  tag 'documentable'
  tag legacy: ['SV-87085', 'V-72461']
  tag cci: ['CCI-000366']
  tag nist: ['CM-6 b']
end
