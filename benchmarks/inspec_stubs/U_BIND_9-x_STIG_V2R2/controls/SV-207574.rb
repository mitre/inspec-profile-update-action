control 'SV-207574' do
  title 'The two files generated by the BIND 9.x server dnssec-keygen program must be group owned by the server administrator account, or deleted, after they have been copied to the key file in the name server.'
  desc 'To enable zone transfer (requests and responses) through authenticated messages, it is necessary to generate a key for every pair of name servers. The key also can be used for securing other transactions, such as dynamic updates, DNS queries, and responses. The binary key string that is generated by most key generation utilities used with DNSSEC is Base64-encoded. A TSIG is a string used to generate the message authentication hash stored in a TSIG RR and used to authenticate an entire DNS message.'
  desc 'check', 'If the server is in a classified network, this is Not Applicable.

With the assistance of the DNS Administrator, identify all dnssec-keygen key files that reside on the BIND 9.x server.

An example dnssec-keygen key file will look like:

Kns1.example.com_ns2.example.com.+161+28823.key
OR
Kns1.example.com_ns2.example.com.+161+28823.private

For each key file identified, verify that the key file is group-owned by "root":

# ls â€“la
-r-------- 1 root root 77 Jul 1 15:00 Kns1.example.com_ns2.example.com+161+28823.key

If the key file(s) are not group owned by root, this is a finding.'
  desc 'fix', 'Change the group ownership of the keys to the root group.

# chgrp root <key_file>.'
  impact 0.5
  ref 'DPMS Target BIND 9.x'
  tag check_id: 'C-7829r283776_chk'
  tag severity: 'medium'
  tag gid: 'V-207574'
  tag rid: 'SV-207574r612253_rule'
  tag stig_id: 'BIND-9X-001141'
  tag gtitle: 'SRG-APP-000516-DNS-000086'
  tag fix_id: 'F-7829r283777_fix'
  tag 'documentable'
  tag legacy: ['SV-87083', 'V-72459']
  tag cci: ['CCI-000366']
  tag nist: ['CM-6 b']
end
