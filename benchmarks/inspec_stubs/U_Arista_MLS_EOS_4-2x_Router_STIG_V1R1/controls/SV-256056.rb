control 'SV-256056' do
  title 'The Arista Multicast Source Discovery Protocol (MSDP) router must be configured to use its loopback address as the source address when originating MSDP traffic.'
  desc "Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of MSDP routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the router's loopback address instead of the numerous physical interface addresses."
  desc 'check', 'Review the Arista router configuration to verify a loopback address has been configured.

Verify a loopback interface is used as the source address for all MSDP packets generated by the router. Execute the command "sh run sec router msdp".

router#show running-config | section router msdp
router msdp
   originator-id local-interface Loopback0

If the Arista router does not use its loopback address as the source address when originating MSDP traffic, this is a finding.'
  desc 'fix', 'Ensure the Arista router originator-id is the source address loopback0 for originating traffic.

router(config)#router msdp
router (config-router-msdp)#originator-id local-interface loopback0
router (config-router-msdp)#exit'
  impact 0.3
  ref 'DPMS Target Arista MLS EOS 4.2x RTR'
  tag check_id: 'C-59732r882508_chk'
  tag severity: 'low'
  tag gid: 'V-256056'
  tag rid: 'SV-256056r882510_rule'
  tag stig_id: 'ARST-RT-000770'
  tag gtitle: 'SRG-NET-000512-RTR-000011'
  tag fix_id: 'F-59675r882509_fix'
  tag 'documentable'
  tag cci: ['CCI-000366']
  tag nist: ['CM-6 b']
end
