control 'WDNS-22-000090_rule' do
  title 'A unique Transaction Signature (TSIG) key must be generated for each pair of communicating hosts.'
  desc 'To enable zone transfer (requests and responses) through authenticated messages, it is necessary to generate a key for every pair of name servers. The key also can be used for securing other transactions, such as dynamic updates, DNS queries, and responses. The binary key string generated by most key generation utilities used with DNSSEC is Base64 encoded. TSIG is a string used to generate the message authentication hash stored in a TSIG Resource Record (RR) and used to authenticate an entire DNS message.'
  desc 'check', 'Review the DNS implementation. Verify that each pair of communicating hosts has a unique TSIG key (i.e., a separate key for each secondary name server to authenticate transactions with the primary name server, etc.)

If a unique TSIG key has not been generated for each pair of communicating hosts, this is a finding.'
  desc 'fix', 'Regenerate a unique TSIG key for each pair of communicating hosts within the DNS architecture.'
  impact 0.5
  tag check_id: 'C-WDNS-22-000090_chk'
  tag severity: 'medium'
  tag gid: 'WDNS-22-000090'
  tag rid: 'WDNS-22-000090_rule'
  tag stig_id: 'WDNS-22-000090'
  tag gtitle: 'SRG-APP-000176-DNS-000076'
  tag fix_id: 'F-WDNS-22-000090_fix'
  tag 'documentable'
  tag cci: ['CCI-000186']
  tag nist: ['IA-5 (2) (a) (1)']
end
