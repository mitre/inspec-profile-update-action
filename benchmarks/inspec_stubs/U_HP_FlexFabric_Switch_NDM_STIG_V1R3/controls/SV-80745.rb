control 'SV-80745' do
  title 'The HP FlexFabric Switch must record time stamps for audit records that meet a granularity of one second for a minimum degree of precision.'
  desc 'Without sufficient granularity of time stamps, it is not possible to adequately determine the chronological order of records. Time stamps generated by the application include date and time. Granularity of time measurements refers to the degree of synchronization between information system clocks and reference clocks.'
  desc 'check', 'Check if info-center is configured to provide timestamp:

[HP] display info-center

Information Center: Enabled
Console: Enabled
Monitor: Enabled
Log host: Enabled
    192.100.50.27,
    port number: 514, host facility: local7
Log buffer: Enabled
    Max buffer size 1024, current buffer size 512
    Current messages 66, dropped messages 0, overwritten messages 0
Log file: Enabled
Security log file: Enabled
Information timestamp format:
    Log host: Date
    Other output destination: Date
Check logfile content to determine if the time stamp is present:

<HP> cd logfile/
<HP> more logfile.log
%@9377%Jan 20 23:31:03:567 2011 HP5930_SUT SHELL/6/SHELL_CMD: -Line=vty0-IPAddr=16.123.122.155-User=admin; Command is dis info-center
%@9378%Jan 20 23:31:09:342 2011 HP5930_SUT SHELL/6/SHELL_CMD: -Line=vty0-IPAddr=16.123.122.155-User=admin; Command is qui

If the HP FlexFabric Switch is not configured to enable timestamp, this is a finding.'
  desc 'fix', 'Configure timestamp on the logs on the HP FlexFabric Switch:

[HP] info-center timestamp date

By default, the device uses internal system clocks to generate time stamps for audit records in the date format - MMM DD hh:mm:ss:xxx YYYY which provides required granularity.'
  impact 0.5
  ref 'DPMS Target HP Flex Fabric Switch 7 NDM'
  tag check_id: 'C-66901r1_chk'
  tag severity: 'medium'
  tag gid: 'V-66255'
  tag rid: 'SV-80745r1_rule'
  tag stig_id: 'HFFS-ND-000102'
  tag gtitle: 'SRG-APP-000375-NDM-000300'
  tag fix_id: 'F-72331r1_fix'
  tag 'documentable'
  tag cci: ['CCI-001889']
  tag nist: ['AU-8 b']
end
