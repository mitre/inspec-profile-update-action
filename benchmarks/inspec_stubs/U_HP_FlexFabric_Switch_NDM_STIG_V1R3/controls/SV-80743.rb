control 'SV-80743' do
  title 'The HP FlexFabric Switch must record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT).'
  desc 'If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.

Time stamps generated by the application include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.'
  desc 'check', 'Determine if time zone is configured on the HP FlexFabric Switch:

[HP] display clock

15:00:32 EST Thu 07/09/2015
Time Zone : EST minus 05:00:00

Check if info-center is configured to provide timestamp:

[HP] display info-center

Information Center: Enabled
Console: Enabled
Monitor: Enabled
Log host: Enabled
    192.100.50.27,
    port number: 514, host facility: local7
Log buffer: Enabled
    Max buffer size 1024, current buffer size 512
    Current messages 66, dropped messages 0, overwritten messages 0
Log file: Enabled
Security log file: Enabled
Information timestamp format:
    Log host: Date
    Other output destination: Date

Check logfile content to determine if the time stamp is present:

<HP> cd logfile/
<HP> more logfile.log
%@9377%Jan 20 23:31:03:567 2011 HP5930_SUT SHELL/6/SHELL_CMD: -Line=vty0-IPAddr=16.123.122.155-User=admin; Command is dis info-center
%@9378%Jan 20 23:31:09:342 2011 HP5930_SUT SHELL/6/SHELL_CMD: -Line=vty0-IPAddr=16.123.122.155-User=admin; Command is qui

If the HP FlexFabric Switch is not configured to enable timestamp in the log and if time zone is not configurable, this is a finding.'
  desc 'fix', 'Configure time zone on the HP FlexFabric Switch:

[HP] clock timezone EST minus 5:00:00

Configure timestamp on the logs on the HP FlexFabric Switch:

[HP] info-center timestamp date

Note: By default, the device uses internal system clocks to generate time stamps for audit records in the date format - MMM DD hh:mm:ss:xxx YYYY.'
  impact 0.5
  ref 'DPMS Target HP Flex Fabric Switch 7 NDM'
  tag check_id: 'C-66899r1_chk'
  tag severity: 'medium'
  tag gid: 'V-66253'
  tag rid: 'SV-80743r1_rule'
  tag stig_id: 'HFFS-ND-000101'
  tag gtitle: 'SRG-APP-000374-NDM-000299'
  tag fix_id: 'F-72329r1_fix'
  tag 'documentable'
  tag cci: ['CCI-001890']
  tag nist: ['AU-8 b']
end
