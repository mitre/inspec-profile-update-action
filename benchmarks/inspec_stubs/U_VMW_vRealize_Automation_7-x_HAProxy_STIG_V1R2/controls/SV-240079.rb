control 'SV-240079' do
  title 'HAProxy must use the httplog option.'
  desc 'If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis across multiple devices and log records.

Time stamps generated by the web server include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.'
  desc 'check', "At the command prompt, execute the following command:

grep -E  'option\\s+httplog' /etc/haproxy/haproxy.cfg

If the command does not return a line, this is a finding."
  desc 'fix', 'Navigate to and open /etc/haproxy/haproxy.cfg

Navigate to the defaults section.

Add "option httplog" to the "defaults" section.'
  impact 0.5
  ref 'DPMS Target VMware vRealize Automation 7-x HA Proxy'
  tag check_id: 'C-43312r665404_chk'
  tag severity: 'medium'
  tag gid: 'V-240079'
  tag rid: 'SV-240079r879747_rule'
  tag stig_id: 'VRAU-HA-000380'
  tag gtitle: 'SRG-APP-000374-WSR-000172'
  tag fix_id: 'F-43271r665405_fix'
  tag 'documentable'
  tag legacy: ['SV-99845', 'V-89195']
  tag cci: ['CCI-001890']
  tag nist: ['AU-8 b']
end
