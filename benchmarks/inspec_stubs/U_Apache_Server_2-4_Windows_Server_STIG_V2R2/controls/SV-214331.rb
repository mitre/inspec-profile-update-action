control 'SV-214331' do
  title 'The Apache web server must invalidate session identifiers upon hosted application user logout or other session termination.'
  desc %q(Captured sessions can be reused in "replay" attacks. This requirement limits the ability of adversaries from capturing and continuing to employ previously valid session IDs.

Session IDs are tokens generated by web applications to uniquely identify an application user's session. Unique session IDs help to reduce predictability of said identifiers. When a user logs out, or when any other session termination event occurs, the web server must terminate the user session to minimize the potential for an attacker to hijack that particular user session.)
  desc 'check', %q(Review the <'INSTALL PATH'>\conf\httpd.conf file.

Search for the following directive: 

SessionMaxAge

Verify the value of "SessionMaxAge" is set to "600" or less.

If "SessionMaxAge" does not exist or is set to more than "600", this is a finding.)
  desc 'fix', %q(Open the <'INSTALL PATH'>\conf\httpd.conf file.

Set the "SessionMaxAge" directive to a value of no more than "600". 
Add the directive if it does not exist.

Restart the Apache service.)
  impact 0.5
  ref 'DPMS Target Apache Server 2.4 Windows Server'
  tag check_id: 'C-15543r277496_chk'
  tag severity: 'medium'
  tag gid: 'V-214331'
  tag rid: 'SV-214331r505936_rule'
  tag stig_id: 'AS24-W1-000460'
  tag gtitle: 'SRG-APP-000220-WSR-000201'
  tag fix_id: 'F-15541r277497_fix'
  tag 'documentable'
  tag legacy: ['SV-102493', 'V-92405']
  tag cci: ['CCI-001185']
  tag nist: ['SC-23 (1)']
end
