control 'SV-230945' do
  title 'Forescout must be configured to use Coordinated Universal Time (UTC).'
  desc 'If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.

Time stamps generated by the application include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.'
  desc 'check', 'Determine if Forescout records time stamps for log records that can be mapped to UTC. This requirement may be verified by demonstration or configuration review.

Verify by connecting to the appliance via SSH using standard user/operator privilege.

1. Type "date" at the command prompt.
2. Verify the date references accurate time and "UTC" shows just before the year.

If Forescout does not record time stamps for log records that can be mapped to UTC, this is a finding.'
  desc 'fix', 'Configure Forescout to record time stamps for log records that can be mapped to UTC.

Note: Updating time preferences will force Forescout into maintenance mode and the service must be restarted. Use a scheduled outage for planned maintenance and stop Forescout service prior to adjusting time settings.

1. Type the following command at the prompt using the IP address of the required NTP server:
     fstool ntp <ip address>
2. Ensure the date references accurate time and the time zone points to UTC next to the year.'
  impact 0.5
  ref 'DPMS Target Forescout Network Device Management'
  tag check_id: 'C-33875r603674_chk'
  tag severity: 'medium'
  tag gid: 'V-230945'
  tag rid: 'SV-230945r615886_rule'
  tag stig_id: 'FORE-NM-000170'
  tag gtitle: 'SRG-APP-000374-NDM-000299'
  tag fix_id: 'F-33848r603675_fix'
  tag 'documentable'
  tag cci: ['CCI-001890']
  tag nist: ['AU-8 b']
end
