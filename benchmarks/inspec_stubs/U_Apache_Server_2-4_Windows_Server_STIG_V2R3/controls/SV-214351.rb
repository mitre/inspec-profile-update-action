control 'SV-214351' do
  title 'The Apache web server must generate log records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT) with a minimum granularity of one second.'
  desc 'If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis across multiple devices and log records.

Time stamps generated by the Apache web server include date and time. Time is commonly expressed in UTC, a modern continuation of GMT, or local time with an offset from UTC.

Without sufficient granularity of time stamps, it is not possible to adequately determine the chronological order of records.

Time stamps generated by the Apache web server include date and time and must be to a granularity of one second.

'
  desc 'check', %q(Review the web server documentation and configuration to determine the time stamp format for log data.

In a command line, navigate to "<'INSTALLED PATH'>\bin". Run "httpd -M" to view a list of installed modules.

If "log_config_module" is not listed, this is a finding.

In a command line, navigate to "<'INSTALLED PATH'>\bin". Determine the location of the "httpd.conf" file by running the following command:

httpd -V

Review the "HTTPD_ROOT" path.

Navigate to the "HTTPD_ROOT"/conf directory.

Edit the "httpd.conf" file.

Verify the "LogFormat" directive exists.

If it does not exist, this is a finding.

Verify the "LogFormat" line contains the "%t" flag.
 
If "%t" flag is not present, time is not mapped to UTC or GMT time, and this is a finding.)
  desc 'fix', %q(In a command line, navigate to "<'INSTALLED PATH'>\bin". Run "httpd -M" to view a list of installed modules.

If "log_config_module" is not listed, enable this module.

In a command line, navigate to "<'INSTALLED PATH'>\bin". Determine the location of the "httpd.conf" file by running the following command:

httpd -V

Review the "HTTPD_ROOT" path.

Navigate to the "HTTPD_ROOT"/conf directory.

Edit the "httpd.conf" file.

Determine if the "LogFormat" directive exists. If it does not exist, ensure the "LogFormat" line contains the "%t" flag.)
  impact 0.5
  ref 'DPMS Target Apache Server 2.4 Windows Server'
  tag check_id: 'C-15563r277556_chk'
  tag severity: 'medium'
  tag gid: 'V-214351'
  tag rid: 'SV-214351r879748_rule'
  tag stig_id: 'AS24-W1-000760'
  tag gtitle: 'SRG-APP-000375-WSR-000171'
  tag fix_id: 'F-15561r877014_fix'
  tag satisfies: ['SRG-APP-000375-WSR-000171', 'SRG-APP-000374-WSR-000172']
  tag 'documentable'
  tag legacy: ['SV-104687', 'V-94857']
  tag cci: ['CCI-001890']
  tag nist: ['AU-8 b']
end
