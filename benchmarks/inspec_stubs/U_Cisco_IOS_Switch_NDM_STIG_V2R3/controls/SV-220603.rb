control 'SV-220603' do
  title 'The Cisco switch must be configured to record time stamps for log records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT).'
  desc 'If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.

Time stamps generated by the application include date and time. Time is commonly expressed in UTC, a modern continuation of GMT, or local time with an offset from UTC.'
  desc 'check', 'Review the Cisco switch configuration to verify that it records time stamps for audit records that can be mapped to UTC or GMT as shown in the example below:

service timestamps log datetime localtime
!
hostname R2
…
…
…
clock timezone EST -5

Note: UTC is the default; hence, the command set time zone may not be seen in the configuration. This can be verified using the show system uptime command.

If the switch is not configured to record time stamps for audit records that can be mapped to UTC or GMT, this is a finding.'
  desc 'fix', 'Configure the Cisco switch to record time stamps for audit records that can be mapped to UTC or GMT as shown in the example below:

SW2(config)#clock timezone EST -5
SW2(config)#service timestamps log datetime localtime'
  impact 0.5
  ref 'DPMS Target Cisco IOS Switch NDM'
  tag check_id: 'C-22318r507855_chk'
  tag severity: 'medium'
  tag gid: 'V-220603'
  tag rid: 'SV-220603r521267_rule'
  tag stig_id: 'CISC-ND-001050'
  tag gtitle: 'SRG-APP-000374-NDM-000299'
  tag fix_id: 'F-22307r507856_fix'
  tag 'documentable'
  tag legacy: ['SV-110435', 'V-101331']
  tag cci: ['CCI-001890']
  tag nist: ['AU-8 b']
end
