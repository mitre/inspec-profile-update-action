control 'SV-205172' do
  title 'Read/Write access to the key file must be restricted to the account that runs the name server software only.'
  desc 'To enable zone transfer (requests and responses) through authenticated messages, it is necessary to generate a key for every pair of name servers. The key can also be used for securing other transactions, such as dynamic updates, DNS queries, and responses. The binary key string that is generated by most key generation utilities used with DNSSEC is Base64-encoded. TSIG is a string used to generate the message authentication hash stored in a TSIG RR and used to authenticate an entire DNS message.'
  desc 'check', 'Review the DNS system to determine privileges on the key file and the account under which the name server software is run.

If the account under which the name server software is run is not the only account which has read/modify permissions to the key file, this is a finding.'
  desc 'fix', 'Apply permissions to the key file to provide read/modify permissions only to the account under which the name server software is run.'
  impact 0.5
  ref 'DPMS Target DNS'
  tag check_id: 'C-5439r392432_chk'
  tag severity: 'medium'
  tag gid: 'V-205172'
  tag rid: 'SV-205172r879613_rule'
  tag stig_id: 'SRG-APP-000176-DNS-000019'
  tag gtitle: 'SRG-APP-000176'
  tag fix_id: 'F-5439r392433_fix'
  tag 'documentable'
  tag legacy: ['SV-69051', 'V-54805']
  tag cci: ['CCI-000186']
  tag nist: ['IA-5 (2) (a) (1)']
end
