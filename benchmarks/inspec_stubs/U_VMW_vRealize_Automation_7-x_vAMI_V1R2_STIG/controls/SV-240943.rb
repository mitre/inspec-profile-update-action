control 'SV-240943' do
  title 'The vAMI must use sfcBasicPAMAuthentication for authentication of the remote administrator.'
  desc "This control focuses on communications protection at the session, versus packet level. At the application layer, session IDs are tokens generated by web applications to uniquely identify an application user's session. Web applications utilize session tokens or session IDs in order to establish application user identity. Proper use of session IDs addresses man-in-the-middle attacks, including session hijacking or insertion of false information into a session. Application servers must provide the capability to perform mutual authentication. Mutual authentication is when both the client and the server authenticate each other."
  desc 'check', 'At the command prompt, execute the following command:

grep basicAuthLib /opt/vmware/etc/sfcb/sfcb.cfg

If the value of "basicAuthLib" is missing, commented out, or not "sfcBasicPAMAuthentication", this is a finding.'
  desc 'fix', "Navigate to and open /opt/vmware/etc/sfcb/sfcb.cfg.

Configure the sfcb.cfg file with the following value: 'basicAuthLib:   sfcBasicPAMAuthentication'"
  impact 0.5
  ref 'DPMS Target VMware vRealize Automation 7-x vAMI'
  tag check_id: 'C-44176r675994_chk'
  tag severity: 'medium'
  tag gid: 'V-240943'
  tag rid: 'SV-240943r879636_rule'
  tag stig_id: 'VRAU-VA-000285'
  tag gtitle: 'SRG-APP-000219-AS-000147'
  tag fix_id: 'F-44135r675995_fix'
  tag 'documentable'
  tag legacy: ['SV-100879', 'V-90229']
  tag cci: ['CCI-001184']
  tag nist: ['SC-23']
end
