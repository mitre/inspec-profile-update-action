control 'SV-216562' do
  title 'The Cisco router must be configured to drop all fragmented Internet Control Message Protocol (ICMP) packets destined to itself.'
  desc "Fragmented ICMP packets can be generated by hackers for DoS attacks such as Ping O' Death and Teardrop. It is imperative that all fragmented ICMP packets are dropped."
  desc 'check', 'Review the external and internal ACLs to verify that the router is configured to drop all fragmented ICMP packets destined to itself.

ip access-list extended EXTERNAL_ACL
 permit tcp host x.11.1.1 eq bgp host x.11.1.2
 permit tcp host x.11.1.1 host x.11.1.2 eq bgp
 deny   icmp any host x.11.1.2 fragments
 permit icmp host x.11.1.1 host x.11.1.2 echo
 …
 …
deny   ip any any
!
ip access-list extended INTERNAL_ACL
deny icmp any host 10.1.12.2 fragments
permit icmp any any

Note: Ensure the statement to deny ICMP fragments is before any permit statements for ICMP.

If the router is not configured to drop all fragmented ICMP packets destined to itself, this is a finding.'
  desc 'fix', 'Configure the external and internal ACLs to drop all fragmented ICMP packets destined to itself as shown in the example below.

R1(config)#ip access-list extended EXTERNAL_ACL
R1(config-ext-nacl)#deny icmp any host x.11.1.2 fragments

R1(config)#ip access-list extended INTERNAL_ACL
R1(config-ext-nacl)#deny icmp any host 10.1.12.2 fragments

Note: Ensure the above statement is before any permit statements for ICMP.'
  impact 0.5
  ref 'DPMS Target Cisco IOS Router RTR'
  tag check_id: 'C-17797r287070_chk'
  tag severity: 'medium'
  tag gid: 'V-216562'
  tag rid: 'SV-216562r531085_rule'
  tag stig_id: 'CISC-RT-000140'
  tag gtitle: 'SRG-NET-000205-RTR-000002'
  tag fix_id: 'F-17793r287071_fix'
  tag 'documentable'
  tag legacy: ['SV-105663', 'V-96525']
  tag cci: ['CCI-001097']
  tag nist: ['SC-7 a']
end
