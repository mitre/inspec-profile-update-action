control 'SV-16723' do
  title 'An NFS Server is running on the ESX Server host'
  desc 'Datastores may have several types of file system formats.  These include VMFS, Raw Device Mappings, and NFS. VMFS is a proprietary file system developed by VMware that is built to handle a high amount of I/O generated by the ESX Server. Raw Device Mappings (RDM) is a mapping file in a VMFS volume that acts as a proxy for a raw physical device. An RDM can be thought of as a symbolic link from a VMFS volume to a raw LUN. An NFS volume is located on an NFS server. In normal usage there should be no case where an ESX host would be required to export an NFS directory or directories using an NFS server.  If such a server were to exist within the ESX host operating environment, sensitive data from datastores to which the ESX server is attached may become compromised.  Since there should never be a need for an ESX server to export a file system, the presence of a running NFS server is a finding.'
  desc 'check', 'On the ESX Server service console, perform the following:
# ps –ef | grep nfsd

If you see the something other than the “grep nfsd” process, this is a finding.'
  desc 'fix', 'Do not configure an NFS Server on the ESX Server host.'
  impact 0.5
  ref 'DPMS Target ESX Server 3'
  tag check_id: 'C-15970r1_chk'
  tag severity: 'medium'
  tag gid: 'V-15784'
  tag rid: 'SV-16723r1_rule'
  tag stig_id: 'ESX0020'
  tag gtitle: 'An NFS Server is running on ESX Server host.'
  tag fix_id: 'F-15725r1_fix'
  tag 'documentable'
  tag responsibility: ['System Administrator', 'Information Assurance Officer', '[Virtual Server Administrator]']
end
