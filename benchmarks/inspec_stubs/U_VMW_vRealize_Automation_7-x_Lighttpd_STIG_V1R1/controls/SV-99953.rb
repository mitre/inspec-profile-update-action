control 'SV-99953' do
  title 'Lighttpd must record time stamps for log records to a minimum granularity of time.'
  desc 'Without sufficient granularity of time stamps, it is not possible to adequately determine the chronological order of records. 

Time stamps generated by the web server include date and time and must be to a granularity of one second.

In order to ensure that Lighttpd is correctly logging timestamps, the accesslog.format setting must be configured correctly.'
  desc 'check', %q(At the command prompt, execute the following command:

grep 'accesslog.format' /opt/vmware/etc/lighttpd/lighttpd.conf | grep -v ^#

If no value is returned or if the "accesslog.format" is commented out, this is a finding.)
  desc 'fix', %q(Navigate to and open /opt/vmware/etc/lighttpd/lighttpd.conf

Note: If the accesslog.format setting was commented out with a '#' sign, remove the '#' sign.

Configure the lighttpd.conf file with the following: 

accesslog.format = "%h %l %u %t \"%r\" %b %>s \"%{User-Agent}i\" \"%{Referer}i\"")
  impact 0.5
  ref 'DPMS Target VMware vRealize Automation 7.x Lighttpd'
  tag check_id: 'C-88995r1_chk'
  tag severity: 'medium'
  tag gid: 'V-89303'
  tag rid: 'SV-99953r1_rule'
  tag stig_id: 'VRAU-LI-000420'
  tag gtitle: 'SRG-APP-000375-WSR-000171'
  tag fix_id: 'F-96045r1_fix'
  tag 'documentable'
  tag cci: ['CCI-001889']
  tag nist: ['AU-8 b']
end
