control 'SV-252928' do
  title 'TOSS must, for networked systems, compare internal information system clocks at least every 24 hours with a server which is synchronized to one of the redundant United States Naval Observatory (USNO) time servers, or a time server designated for the appropriate DoD network (NIPRNet/SIPRNet), and/or the Global Positioning System (GPS).'
  desc 'Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time that a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside the configured acceptable allowance (drift) may be inaccurate.

Synchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.

Organizations should consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).

If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.

Time stamps generated by the operating system include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.

TOSS utilizes the "timedatectl" command to view the status of the "systemd-timesyncd.service." The "timedatectl" status will display the local time, UTC, and the offset from UTC.

Note that USNO offers authenticated NTP service to DoD and U.S. Government agencies operating on the NIPR and SIPR networks. Visit https://www.usno.navy.mil/USNO/time/ntp/dod-customers for more information.

'
  desc 'check', 'If the system is not networked, this requirement is Not Applicable. 

The system clock must be configured to compare the system clock at least every 24 hours to the authoritative time source. 

Check the value of "maxpoll" in the "/etc/chrony/chrony.conf" file with the following command: 

$ sudo grep maxpoll /etc/chrony/chrony.conf 
server tick.usno.navy.mil iburst maxpoll 16

If "maxpoll" is not set to "16" or does not exist, this is a finding. 

Verify that the "chrony.conf" file is configured to an authoritative DoD time source by running the following command: 

$ grep -i server /etc/chrony.conf 
server tick.usno.navy.mil iburst maxpoll 16
server tock.usno.navy.mil iburst maxpoll 16
server ntp2.usno.navy.mil iburst maxpoll 16

If the parameter "server" is not set, is not set to an authoritative DoD time source, or is commented out, this is a finding.'
  desc 'fix', 'For networked systems, configure TOSS to compare internal information system clocks at least every 24 hours with a server which is synchronized to one of the redundant United States Naval Observatory (USNO) time servers, or a time server designated for the appropriate DoD network (NIPRNet/SIPRNet), and/or the Global Positioning System (GPS).

Add and/or modify the following line in the /etc/chrony.conf file:

server [ntp.server.name] iburst maxpoll 16'
  impact 0.5
  ref 'DPMS Target TOSS 4'
  tag check_id: 'C-56381r824106_chk'
  tag severity: 'medium'
  tag gid: 'V-252928'
  tag rid: 'SV-252928r825085_rule'
  tag stig_id: 'TOSS-04-010180'
  tag gtitle: 'SRG-OS-000355-GPOS-00143'
  tag fix_id: 'F-56331r824107_fix'
  tag satisfies: ['SRG-OS-000355-GPOS-00143', 'SRG-OS-000356-GPOS-00144', 'SRG-OS-000359-GPOS-00146']
  tag 'documentable'
  tag cci: ['CCI-001890', 'CCI-001891', 'CCI-002046']
  tag nist: ['AU-8 b', 'AU-8 (1) (a)', 'AU-8 (1) (b)']
end
