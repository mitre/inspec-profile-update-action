control 'SV-87307' do
  title 'The Cassandra Server must record time stamps, in audit records and application data that can be mapped to Coordinated Universal Time (UTC, formerly GMT).'
  desc 'If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.

Time stamps generated by the DBMS must include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC. 

Some DBMS products offer a data type called TIMESTAMP that is not a representation of date and time. Rather, it is a database state counter and does not correspond to calendar and clock time. This requirement does not refer to that meaning of TIMESTAMP.'
  desc 'check', 'Review the Cassandra Server settings to ensure time stamps, in audit records and application data that can be mapped to Coordinated Universal Time (UTC, formerly GMT) are recorded.

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the <appender> node with the name="FILE" attribute.

Navigate to <encoder> node.

If the <pattern> node does not look like the expected result, this is a finding.

Expected result:
<pattern>%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n</pattern>'
  desc 'fix', 'Configure the Cassandra Server to record time stamps, in audit records and application data that can be mapped to Coordinated Universal Time (UTC, formerly GMT).

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the <appender> node with the name="FILE" attribute.

Navigate to <encoder> node.

Edit the <pattern> to look like the below.
<pattern>%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n</pattern>'
  impact 0.5
  ref 'DPMS Target VMware Cassandra'
  tag check_id: 'C-72831r1_chk'
  tag severity: 'medium'
  tag gid: 'V-72675'
  tag rid: 'SV-87307r1_rule'
  tag stig_id: 'VROM-CS-000220'
  tag gtitle: 'SRG-APP-000374-DB-000322'
  tag fix_id: 'F-79079r1_fix'
  tag 'documentable'
  tag cci: ['CCI-001890']
  tag nist: ['AU-8 b']
end
