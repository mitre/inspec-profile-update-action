<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" id="VMW_vSphere_6-7_RhttpProxy_STIG" xml:lang="en" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2022-01-03">accepted</status><title>VMware vSphere 6.7 RhttpProxy Security Technical Implementation Guide</title><description>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.</description><notice id="terms-of-use" xml:lang="en"></notice><front-matter xml:lang="en"></front-matter><rear-matter xml:lang="en"></rear-matter><reference href="https://cyber.mil"><dc:publisher>DISA</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 2 Benchmark Date: 08 Feb 2022</plain-text><plain-text id="generator">3.2.2.36079</plain-text><plain-text id="conventionsVersion">1.10.0</plain-text><version>1</version><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-240716" selected="true" /><select idref="V-240717" selected="true" /><select idref="V-240718" selected="true" /><select idref="V-240719" selected="true" /><select idref="V-240720" selected="true" /><select idref="V-240721" selected="true" /><select idref="V-240722" selected="true" /><select idref="V-240723" selected="true" /><select idref="V-240724" selected="true" /></Profile><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-240716" selected="true" /><select idref="V-240717" selected="true" /><select idref="V-240718" selected="true" /><select idref="V-240719" selected="true" /><select idref="V-240720" selected="true" /><select idref="V-240721" selected="true" /><select idref="V-240722" selected="true" /><select idref="V-240723" selected="true" /><select idref="V-240724" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-240716" selected="true" /><select idref="V-240717" selected="true" /><select idref="V-240718" selected="true" /><select idref="V-240719" selected="true" /><select idref="V-240720" selected="true" /><select idref="V-240721" selected="true" /><select idref="V-240722" selected="true" /><select idref="V-240723" selected="true" /><select idref="V-240724" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-240716" selected="true" /><select idref="V-240717" selected="true" /><select idref="V-240718" selected="true" /><select idref="V-240719" selected="true" /><select idref="V-240720" selected="true" /><select idref="V-240721" selected="true" /><select idref="V-240722" selected="true" /><select idref="V-240723" selected="true" /><select idref="V-240724" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-240716" selected="true" /><select idref="V-240717" selected="true" /><select idref="V-240718" selected="true" /><select idref="V-240719" selected="true" /><select idref="V-240720" selected="true" /><select idref="V-240721" selected="true" /><select idref="V-240722" selected="true" /><select idref="V-240723" selected="true" /><select idref="V-240724" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-240716" selected="true" /><select idref="V-240717" selected="true" /><select idref="V-240718" selected="true" /><select idref="V-240719" selected="true" /><select idref="V-240720" selected="true" /><select idref="V-240721" selected="true" /><select idref="V-240722" selected="true" /><select idref="V-240723" selected="true" /><select idref="V-240724" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-240716" selected="true" /><select idref="V-240717" selected="true" /><select idref="V-240718" selected="true" /><select idref="V-240719" selected="true" /><select idref="V-240720" selected="true" /><select idref="V-240721" selected="true" /><select idref="V-240722" selected="true" /><select idref="V-240723" selected="true" /><select idref="V-240724" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-240716" selected="true" /><select idref="V-240717" selected="true" /><select idref="V-240718" selected="true" /><select idref="V-240719" selected="true" /><select idref="V-240720" selected="true" /><select idref="V-240721" selected="true" /><select idref="V-240722" selected="true" /><select idref="V-240723" selected="true" /><select idref="V-240724" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-240716" selected="true" /><select idref="V-240717" selected="true" /><select idref="V-240718" selected="true" /><select idref="V-240719" selected="true" /><select idref="V-240720" selected="true" /><select idref="V-240721" selected="true" /><select idref="V-240722" selected="true" /><select idref="V-240723" selected="true" /><select idref="V-240724" selected="true" /></Profile><Group id="V-240716"><title>SRG-APP-000001-WSR-000001</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-240716r679661_rule" weight="10.0" severity="medium"><version>VCRP-67-000001</version><title>The rhttpproxy must drop connections to disconnected clients.</title><description>&lt;VulnDiscussion&gt;The rhttpproxy client connections that are established but no longer connected can consume resources that might otherwise be required by active connections. It is a best practice to terminate connections that are no longer connected to an active client.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 6.7 RhttpProxy</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 6.7 RhttpProxy</dc:subject><dc:identifier>5330</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000054</ident><fixtext fixref="F-43908r679660_fix">Navigate to and open /etc/vmware-rhttpproxy/config.xml.

Locate the &lt;config&gt;/&lt;vmacore&gt;/&lt;tcpKeepAlive&gt;/&lt;clientSocket&gt; block and configure &lt;idleTimeSec&gt; as follows:

&lt;idleTimeSec&gt;900&lt;/idleTimeSec&gt;

Restart the service for changes to take effect.

# vmon-cli --restart rhttpproxy</fixtext><fix id="F-43908r679660_fix" /><check system="C-43949r679659_chk"><check-content-ref href="VMware_vSphere_6.7_RhttpProxy_STIG.xml" name="M" /><check-content>At the command prompt, execute the following command:

# xmllint --xpath '/config/vmacore/tcpKeepAlive/clientSocket/idleTimeSec' /etc/vmware-rhttpproxy/config.xml

Expected result:

&lt;idleTimeSec&gt;900&lt;/idleTimeSec&gt;

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-240717"><title>SRG-APP-000001-WSR-000001</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-240717r679664_rule" weight="10.0" severity="medium"><version>VCRP-67-000002</version><title>The rhttpproxy must set a limit on established connections.</title><description>&lt;VulnDiscussion&gt;The rhttpproxy client connections must be limited to preserve system resources and continue servicing connections without interruption. Without a limit set, the system would be vulnerable to a trivial denial-of-service attack where connections are created en masse and vCenter resources are entirely consumed. The rhttproxy comes configured with a tested and supported value that must be maintained.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 6.7 RhttpProxy</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 6.7 RhttpProxy</dc:subject><dc:identifier>5330</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000054</ident><fixtext fixref="F-43909r679663_fix">Navigate to and open /etc/vmware-rhttpproxy/config.xml.

Locate the &lt;config&gt;/&lt;vmacore&gt;/&lt;http&gt; block and configure &lt;maxConnections&gt; as follows:

&lt;maxConnections&gt; 2048 &lt;/maxConnections&gt;

Restart the service for changes to take effect.

# vmon-cli --restart rhttpproxy</fixtext><fix id="F-43909r679663_fix" /><check system="C-43950r679662_chk"><check-content-ref href="VMware_vSphere_6.7_RhttpProxy_STIG.xml" name="M" /><check-content>At the command prompt, execute the following command:

# xmllint --xpath '/config/vmacore/http/maxConnections' /etc/vmware-rhttpproxy/config.xml

Expected result:

&lt;maxConnections&gt; 2048 &lt;/maxConnections&gt;

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-240718"><title>SRG-APP-000014-WSR-000006</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-240718r679667_rule" weight="10.0" severity="medium"><version>VCRP-67-000003</version><title>The rhttpproxy must be configured to operate solely with FIPS ciphers.</title><description>&lt;VulnDiscussion&gt;The rhttpproxy ships with FIPS 140-2 validated OpenSSL cryptographic libraries and is configured by default to run in FIPS mode. This module is used for all crypto operations performed by rhttproxy, including protection of data-in-transit over the client TLS connection.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 6.7 RhttpProxy</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 6.7 RhttpProxy</dc:subject><dc:identifier>5330</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000068</ident><fixtext fixref="F-43910r679666_fix">Navigate to and open /etc/vmware-rhttpproxy/config.xml.

Locate the &lt;config&gt;/&lt;vmacore&gt;/&lt;ssl&gt; block and configure &lt;fips&gt; as follows:

&lt;fips&gt;true&lt;/fips&gt;

Restart the service for changes to take effect.

# vmon-cli --restart rhttpproxy</fixtext><fix id="F-43910r679666_fix" /><check system="C-43951r679665_chk"><check-content-ref href="VMware_vSphere_6.7_RhttpProxy_STIG.xml" name="M" /><check-content>At the command prompt, execute the following command:

# xmllint --xpath '/config/vmacore/ssl/fips' /etc/vmware-rhttpproxy/config.xml

Expected result:

&lt;fips&gt;true&lt;/fips&gt;

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-240719"><title>SRG-APP-000015-WSR-000014</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-240719r816678_rule" weight="10.0" severity="medium"><version>VCRP-67-000004</version><title>The rhttpproxy must use cryptography to protect the integrity of remote sessions.</title><description>&lt;VulnDiscussion&gt;The rhttpproxy can be configured to support TLS 1.0, 1.1 and 1.2. Due to intrinsic problems in TLS 1.0 and TLS 1.1, they are disabled by default. The &lt;protocol&gt; block in the rhttproxy configuration is commented out by default, and this configuration forces TLS 1.2. The block may also be set to "tls1.2" in certain upgrade scenarios, but the effect is the same.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 6.7 RhttpProxy</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 6.7 RhttpProxy</dc:subject><dc:identifier>5330</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001453</ident><fixtext fixref="F-43911r679669_fix">Navigate to and open /etc/vmware-rhttpproxy/config.xml.

Locate the &lt;config&gt;/&lt;vmacore&gt;/&lt;ssl&gt; block and configure &lt;protocols&gt; as follows:

&lt;protocols&gt;tls1.2&lt;/protocols&gt;

Restart the service for changes to take effect.

# vmon-cli --restart rhttpproxy</fixtext><fix id="F-43911r679669_fix" /><check system="C-43952r816677_chk"><check-content-ref href="VMware_vSphere_6.7_RhttpProxy_STIG.xml" name="M" /><check-content>At the command prompt, execute the following command:

# xmllint --xpath '/config/vmacore/ssl/protocols' /etc/vmware-rhttpproxy/config.xml

Expected result:

&lt;protocols&gt;tls1.2&lt;/protocols&gt;

OR

XPath set is empty

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-240720"><title>SRG-APP-000016-WSR-000005</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-240720r679673_rule" weight="10.0" severity="medium"><version>VCRP-67-000005</version><title>The rhttpproxy must produce log records containing sufficient information to establish the source of events.</title><description>&lt;VulnDiscussion&gt;After a security incident has occurred, investigators will often review log files to determine what happened, and determining the source of an event is crucial for forensics. The rhttpproxy must be configured for verbose logging to capture client IP addresses and the associated actions.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 6.7 RhttpProxy</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 6.7 RhttpProxy</dc:subject><dc:identifier>5330</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000067</ident><fixtext fixref="F-43912r679672_fix">Navigate to and open /etc/vmware-rhttpproxy/config.xml.

Locate the &lt;config&gt;/&lt;log&gt; block and configure &lt;level&gt; as follows:

&lt;level&gt;verbose&lt;/level&gt;

Restart the service for changes to take effect.

# vmon-cli --restart rhttpproxy</fixtext><fix id="F-43912r679672_fix" /><check system="C-43953r679671_chk"><check-content-ref href="VMware_vSphere_6.7_RhttpProxy_STIG.xml" name="M" /><check-content>At the command prompt, execute the following command:

# xmllint --xpath '/config/log/level' /etc/vmware-rhttpproxy/config.xml

Expected result:

&lt;level&gt;verbose&lt;/level&gt;

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-240721"><title>SRG-APP-000092-WSR-000055</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-240721r679676_rule" weight="10.0" severity="medium"><version>VCRP-67-000006</version><title>The rhttpproxy must have logging enabled.</title><description>&lt;VulnDiscussion&gt;After a security incident has occurred, investigators will often review log files to determine what happened. The rhttpproxy must create logs upon service startup to capture information relevant to investigations.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 6.7 RhttpProxy</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 6.7 RhttpProxy</dc:subject><dc:identifier>5330</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001464</ident><fixtext fixref="F-43913r679675_fix">Navigate to and open /etc/vmware-rhttpproxy/config.xml.

Locate the &lt;config&gt;/&lt;log&gt; block and configure &lt;outputToFiles&gt; as follows:

&lt;outputToFiles&gt;true&lt;/outputToFiles&gt;

Restart the service for changes to take effect.

# vmon-cli --restart rhttpproxy</fixtext><fix id="F-43913r679675_fix" /><check system="C-43954r679674_chk"><check-content-ref href="VMware_vSphere_6.7_RhttpProxy_STIG.xml" name="M" /><check-content>At the command prompt, execute the following command:

# xmllint --xpath '/config/log/outputToFiles' /etc/vmware-rhttpproxy/config.xml

Expected result:

&lt;outputToFiles&gt;true&lt;/outputToFiles&gt;

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-240722"><title>SRG-APP-000176-WSR-000096</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-240722r679679_rule" weight="10.0" severity="medium"><version>VCRP-67-000007</version><title>The rhttpproxy private key file must be protected from unauthorized access.</title><description>&lt;VulnDiscussion&gt;The rhttpproxy's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients.

By gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the TLS traffic between a client and the web server.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 6.7 RhttpProxy</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 6.7 RhttpProxy</dc:subject><dc:identifier>5330</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000186</ident><fixtext fixref="F-43914r679678_fix">At the command prompt, execute the following commands:

# chmod 600 /etc/vmware-rhttpproxy/ssl/rui.key
# chown root:root /etc/vmware-rhttpproxy/ssl/rui.key</fixtext><fix id="F-43914r679678_fix" /><check system="C-43955r679677_chk"><check-content-ref href="VMware_vSphere_6.7_RhttpProxy_STIG.xml" name="M" /><check-content>At the command prompt, execute the following command:

# stat -c "%n permissions are %a, is owned by %U and group owned by %G" /etc/vmware-rhttpproxy/ssl/rui.key

Expected result:

/etc/vmware-rhttpproxy/ssl/rui.key permissions are 600, is owned by root and group owned by root

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-240723"><title>SRG-APP-000315-WSR-000003</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-240723r679682_rule" weight="10.0" severity="medium"><version>VCRP-67-000008</version><title>The rhttproxy must exclusively use the HTTPS protocol for client connections.</title><description>&lt;VulnDiscussion&gt;Remotely accessing vCenter via the rhttpproxy involves sensitive information going over the wire. To protect the confidentiality and integrity of these communications, the rhttpproxy must be configured to use an encrypted session of HTTPS rather than plain-text HTTP. The SSL configuration block inside the rhttproxy configuration must be present and configured correctly to safely enable TLS.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 6.7 RhttpProxy</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 6.7 RhttpProxy</dc:subject><dc:identifier>5330</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-002314</ident><fixtext fixref="F-43915r679681_fix">Navigate to and open /etc/vmware-rhttpproxy/config.xml.

Locate the first &lt;ssl&gt; block and set its content to the following:

&lt;ssl&gt;
    &lt;!-- The server private key file --&gt;
    &lt;privateKey&gt;/etc/vmware-rhttpproxy/ssl/rui.key&lt;/privateKey&gt;
    &lt;!-- The server side certificate file --&gt;
    &lt;certificate&gt;/etc/vmware-rhttpproxy/ssl/rui.crt&lt;/certificate&gt;
    &lt;!-- vecs server name. Currently vecs runs on all node types. --&gt;
    &lt;vecsServerName&gt;localhost&lt;/vecsServerName&gt;
&lt;/ssl&gt;

Restart the service for changes to take effect.

# vmon-cli --restart rhttpproxy</fixtext><fix id="F-43915r679681_fix" /><check system="C-43956r679680_chk"><check-content-ref href="VMware_vSphere_6.7_RhttpProxy_STIG.xml" name="M" /><check-content>At the command prompt, execute the following command:

# xmllint --xpath '/config/ssl' /etc/vmware-rhttpproxy/config.xml

Expected result:

&lt;ssl&gt;
    &lt;!-- The server private key file --&gt;
    &lt;privateKey&gt;/etc/vmware-rhttpproxy/ssl/rui.key&lt;/privateKey&gt;
    &lt;!-- The server side certificate file --&gt;
    &lt;certificate&gt;/etc/vmware-rhttpproxy/ssl/rui.crt&lt;/certificate&gt;
    &lt;!-- vecs server name. Currently vecs runs on all node types. --&gt;
    &lt;vecsServerName&gt;localhost&lt;/vecsServerName&gt;
  &lt;/ssl&gt;

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-240724"><title>SRG-APP-000358-WSR-000063</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-240724r679685_rule" weight="10.0" severity="medium"><version>VCRP-67-000009</version><title>The rhttpproxy log files must be moved to a permanent repository in accordance with site policy.</title><description>&lt;VulnDiscussion&gt;The rhttpproxy produces a handful of logs that must be offloaded from the originating system. This information can then be used for diagnostic, forensic, or other purposes relevant to ensuring the availability and integrity of the hosted application.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 6.7 RhttpProxy</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 6.7 RhttpProxy</dc:subject><dc:identifier>5330</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001851</ident><fixtext fixref="F-43916r679684_fix">Navigate to and open /etc/vmware-syslog/stig-services-rhttpproxy.conf.

Create the file if it does not exist.

Set the contents of the file as follows:

input(type="imfile"
      File="/var/log/vmware/rhttpproxy/rhttpproxy.log"
      Tag="rhttpproxy-main"
      Severity="info"
      Facility="local0")</fixtext><fix id="F-43916r679684_fix" /><check system="C-43957r679683_chk"><check-content-ref href="VMware_vSphere_6.7_RhttpProxy_STIG.xml" name="M" /><check-content>At the command prompt, execute the following command:

# grep -v "^#" /etc/vmware-syslog/stig-services-rhttpproxy.conf

Expected result:

input(type="imfile"
      File="/var/log/vmware/rhttpproxy/rhttpproxy.log"
      Tag="rhttpproxy-main"
      Severity="info"
      Facility="local0")

If the file does not exist, this is a finding.

If the output of the command does not match the expected result, this is a finding.</check-content></check></Rule></Group></Benchmark>