<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" id="VMW_NSX_4-x_Tier1_GW_RTR_STIG" xml:lang="en" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2024-07-29">accepted</status><title>VMware NSX 4.x Tier-1 Gateway Router Security Technical Implementation Guide</title><description>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.</description><notice id="terms-of-use" xml:lang="en"></notice><front-matter xml:lang="en"></front-matter><rear-matter xml:lang="en"></rear-matter><reference href="https://cyber.mil"><dc:publisher>DISA</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 1 Benchmark Date: 07 Aug 2024</plain-text><plain-text id="generator">3.5</plain-text><plain-text id="conventionsVersion">1.10.0</plain-text><version>1</version><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263423" selected="true" /><select idref="V-263424" selected="true" /><select idref="V-263425" selected="true" /><select idref="V-263426" selected="true" /></Profile><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263423" selected="true" /><select idref="V-263424" selected="true" /><select idref="V-263425" selected="true" /><select idref="V-263426" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263423" selected="true" /><select idref="V-263424" selected="true" /><select idref="V-263425" selected="true" /><select idref="V-263426" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263423" selected="true" /><select idref="V-263424" selected="true" /><select idref="V-263425" selected="true" /><select idref="V-263426" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263423" selected="true" /><select idref="V-263424" selected="true" /><select idref="V-263425" selected="true" /><select idref="V-263426" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263423" selected="true" /><select idref="V-263424" selected="true" /><select idref="V-263425" selected="true" /><select idref="V-263426" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263423" selected="true" /><select idref="V-263424" selected="true" /><select idref="V-263425" selected="true" /><select idref="V-263426" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263423" selected="true" /><select idref="V-263424" selected="true" /><select idref="V-263425" selected="true" /><select idref="V-263426" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263423" selected="true" /><select idref="V-263424" selected="true" /><select idref="V-263425" selected="true" /><select idref="V-263426" selected="true" /></Profile><Group id="V-263423"><title>SRG-NET-000019-RTR-000007</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263423r978036_rule" weight="10.0" severity="high"><version>NT1R-4X-000016</version><title>The NSX Tier-1 Gateway router must be configured to have all inactive interfaces removed.</title><description>&lt;VulnDiscussion&gt;An inactive interface is rarely monitored or controlled and may expose a network to an undetected attack on that interface. Unauthorized personnel with access to the communication facility could gain access to a router by connecting to a configured interface that is not in use.

If an interface is no longer used, the configuration must be deleted and the interface disabled. For sub-interfaces, delete sub-interfaces that are on inactive interfaces and delete sub-interfaces that are themselves inactive. If the sub-interface is no longer necessary for authorized communications, it must be deleted.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-1 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-1 Gateway Router</dc:subject><dc:identifier>5615</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001414</ident><fixtext fixref="F-67231r978035_fix">To remove a stale linked segment from a Tier-1 Gateway, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Segments and edit the target segment.

Under Connected Gateway, change to "None" and click "Save".

Note: The stale linked segment can also be deleted if there are no active workloads attached to it.

To remove a stale service interface from a Tier-1 Gateway, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-1 Gateways &gt;&gt; Edit the target Tier-1 Gateway.

Expand "Interfaces and GRE Tunnels", then click on the number of interfaces present to open the interfaces dialog.

On the stale service interface, select "Delete" and click "Delete" again to confirm.</fixtext><fix id="F-67231r978035_fix" /><check system="C-67323r978034_chk"><check-content-ref href="VMware_NSX_4.x_Tier-1_Gateway_Router_STIG.xml" name="M" /><check-content>From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-1 Gateways.

For every Tier-1 Gateway, expand the Tier-1 Gateway. Click on the number in the Linked Segments to review the currently linked segments.

For every Tier-1 Gateway, expand the Tier-1 Gateway. Expand Interfaces and GRE Tunnels, and click on the number of interfaces present to open the interfaces dialog.

Review each interface or linked segment present to determine if they are not in use or inactive.

If there are any linked segments or service interfaces present on a Tier-1 Gateway that are not in use or inactive, this is a finding.</check-content></check></Rule></Group><Group id="V-263424"><title>SRG-NET-000131-RTR-000035</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263424r978039_rule" weight="10.0" severity="info"><version>NT1R-4X-000027</version><title>The NSX Tier-1 Gateway router must be configured to have the DHCP service disabled if not in use.</title><description>&lt;VulnDiscussion&gt;A compromised router introduces risk to the entire network infrastructure, as well as data resources that are accessible via the network. The perimeter defense has no oversight or control of attacks by malicious users within the network. Preventing network breaches from within is dependent on implementing a comprehensive defense-in-depth strategy, including securing each device connected to the network. This is accomplished by following and implementing all security guidance applicable for each node type. A fundamental step in securing each router is to enable only the capabilities required for operation.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-1 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-1 Gateway Router</dc:subject><dc:identifier>5615</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-67232r978038_fix">From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-1 Gateways and edit the target Tier-1 Gateway.

Click "Set DHCP Configuration", select "No Dynamic IP Address Allocation", click "Save", and then close "Editing".</fixtext><fix id="F-67232r978038_fix" /><check system="C-67324r978037_chk"><check-content-ref href="VMware_NSX_4.x_Tier-1_Gateway_Router_STIG.xml" name="M" /><check-content>From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-1 Gateways.

For every Tier-1 Gateway expand the Tier-1 Gateway to view the DHCP configuration.

If a DHCP profile is configured and not in use, this is a finding.</check-content></check></Rule></Group><Group id="V-263425"><title>SRG-NET-000512-RTR-000012</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263425r978042_rule" weight="10.0" severity="info"><version>NT1R-4X-000102</version><title>The NSX Tier-1 Gateway router must be configured to advertise a hop limit of at least 32 in Router Advertisement messages for IPv6 stateless auto-configuration deployments.</title><description>&lt;VulnDiscussion&gt;The Neighbor Discovery protocol allows a hop limit value to be advertised by routers in a Router Advertisement message being used by hosts instead of the standardized default value. If a very small value was configured and advertised to hosts on the LAN segment, communications would fail due to the hop limit reaching zero before the packets sent by a host reached its destination.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-1 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-1 Gateway Router</dc:subject><dc:identifier>5615</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-67233r978041_fix">To configure the Neighbor Discovery hop limit, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-1 Gateways &gt;&gt; edit the target Tier-1 gateway.

Expand Additional Settings and select an "ND Profile" from the drop down with a hop limit of 32 or more, then click "Close Editing".

Note: The default ND profile has a hop limit of 64 and cannot be edited. If required, create a new or edit another existing ND profile to use.</fixtext><fix id="F-67233r978041_fix" /><check system="C-67325r978040_chk"><check-content-ref href="VMware_NSX_4.x_Tier-1_Gateway_Router_STIG.xml" name="M" /><check-content>If IPv6 forwarding is not enabled, this is Not Applicable.

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-1 Gateways.

For every Tier-1 Gateway, expand Tier-1 Gateway &gt;&gt;Additional Settings.

Click on the ND profile name to view the hop limit.

If the hop limit is not configured to at least 32, this is a finding.</check-content></check></Rule></Group><Group id="V-263426"><title>SRG-NET-000131-RTR-000035</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263426r978045_rule" weight="10.0" severity="info"><version>NT1R-4X-000107</version><title>The NSX Tier-1 Gateway router must be configured to have multicast disabled if not in use.</title><description>&lt;VulnDiscussion&gt;A compromised router introduces risk to the entire network infrastructure, as well as data resources that are accessible via the network. The perimeter defense has no oversight or control of attacks by malicious users within the network. Preventing network breaches from within is dependent on implementing a comprehensive defense-in-depth strategy, including securing each device connected to the network. This is accomplished by following and implementing all security guidance applicable for each node type. A fundamental step in securing each router is to enable only the capabilities required for operation.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-1 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-1 Gateway Router</dc:subject><dc:identifier>5615</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-67234r978044_fix">If not used, disable Multicast by doing the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-1 Gateways and edit the target Tier-1 Gateway.

Expand Multicast and change from "Enabled" to "Disabled" and then click "Save".</fixtext><fix id="F-67234r978044_fix" /><check system="C-67326r978043_chk"><check-content-ref href="VMware_NSX_4.x_Tier-1_Gateway_Router_STIG.xml" name="M" /><check-content>From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-1 Gateways.

For every Tier-1 Gateway, expand the Tier-1 Gateway then expand Multicast to view the Multicast configuration.

If Multicast is enabled and not in use, this is a finding.

If a Tier-1 Gateway is not linked to a Tier-0 Gateway, this is Not Applicable.</check-content></check></Rule></Group></Benchmark>