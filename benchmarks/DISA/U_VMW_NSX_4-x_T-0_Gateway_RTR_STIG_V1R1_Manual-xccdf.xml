<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" id="VMW_NSX_4-x_Tier0_GW_RTR_STIG" xml:lang="en" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2024-07-26">accepted</status><title>VMware NSX 4.x Tier-0 Gateway Router Security Technical Implementation Guide</title><description>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.</description><notice id="terms-of-use" xml:lang="en"></notice><front-matter xml:lang="en"></front-matter><rear-matter xml:lang="en"></rear-matter><reference href="https://cyber.mil"><dc:publisher>DISA</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 1 Benchmark Date: 07 Aug 2024</plain-text><plain-text id="generator">3.5</plain-text><plain-text id="conventionsVersion">1.10.0</plain-text><version>1</version><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263298" selected="true" /><select idref="V-263299" selected="true" /><select idref="V-263300" selected="true" /><select idref="V-263301" selected="true" /><select idref="V-263302" selected="true" /><select idref="V-263303" selected="true" /><select idref="V-263304" selected="true" /><select idref="V-263305" selected="true" /><select idref="V-263306" selected="true" /><select idref="V-263307" selected="true" /><select idref="V-263308" selected="true" /><select idref="V-263309" selected="true" /><select idref="V-263310" selected="true" /><select idref="V-263311" selected="true" /><select idref="V-263312" selected="true" /><select idref="V-263313" selected="true" /></Profile><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263298" selected="true" /><select idref="V-263299" selected="true" /><select idref="V-263300" selected="true" /><select idref="V-263301" selected="true" /><select idref="V-263302" selected="true" /><select idref="V-263303" selected="true" /><select idref="V-263304" selected="true" /><select idref="V-263305" selected="true" /><select idref="V-263306" selected="true" /><select idref="V-263307" selected="true" /><select idref="V-263308" selected="true" /><select idref="V-263309" selected="true" /><select idref="V-263310" selected="true" /><select idref="V-263311" selected="true" /><select idref="V-263312" selected="true" /><select idref="V-263313" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263298" selected="true" /><select idref="V-263299" selected="true" /><select idref="V-263300" selected="true" /><select idref="V-263301" selected="true" /><select idref="V-263302" selected="true" /><select idref="V-263303" selected="true" /><select idref="V-263304" selected="true" /><select idref="V-263305" selected="true" /><select idref="V-263306" selected="true" /><select idref="V-263307" selected="true" /><select idref="V-263308" selected="true" /><select idref="V-263309" selected="true" /><select idref="V-263310" selected="true" /><select idref="V-263311" selected="true" /><select idref="V-263312" selected="true" /><select idref="V-263313" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263298" selected="true" /><select idref="V-263299" selected="true" /><select idref="V-263300" selected="true" /><select idref="V-263301" selected="true" /><select idref="V-263302" selected="true" /><select idref="V-263303" selected="true" /><select idref="V-263304" selected="true" /><select idref="V-263305" selected="true" /><select idref="V-263306" selected="true" /><select idref="V-263307" selected="true" /><select idref="V-263308" selected="true" /><select idref="V-263309" selected="true" /><select idref="V-263310" selected="true" /><select idref="V-263311" selected="true" /><select idref="V-263312" selected="true" /><select idref="V-263313" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263298" selected="true" /><select idref="V-263299" selected="true" /><select idref="V-263300" selected="true" /><select idref="V-263301" selected="true" /><select idref="V-263302" selected="true" /><select idref="V-263303" selected="true" /><select idref="V-263304" selected="true" /><select idref="V-263305" selected="true" /><select idref="V-263306" selected="true" /><select idref="V-263307" selected="true" /><select idref="V-263308" selected="true" /><select idref="V-263309" selected="true" /><select idref="V-263310" selected="true" /><select idref="V-263311" selected="true" /><select idref="V-263312" selected="true" /><select idref="V-263313" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263298" selected="true" /><select idref="V-263299" selected="true" /><select idref="V-263300" selected="true" /><select idref="V-263301" selected="true" /><select idref="V-263302" selected="true" /><select idref="V-263303" selected="true" /><select idref="V-263304" selected="true" /><select idref="V-263305" selected="true" /><select idref="V-263306" selected="true" /><select idref="V-263307" selected="true" /><select idref="V-263308" selected="true" /><select idref="V-263309" selected="true" /><select idref="V-263310" selected="true" /><select idref="V-263311" selected="true" /><select idref="V-263312" selected="true" /><select idref="V-263313" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263298" selected="true" /><select idref="V-263299" selected="true" /><select idref="V-263300" selected="true" /><select idref="V-263301" selected="true" /><select idref="V-263302" selected="true" /><select idref="V-263303" selected="true" /><select idref="V-263304" selected="true" /><select idref="V-263305" selected="true" /><select idref="V-263306" selected="true" /><select idref="V-263307" selected="true" /><select idref="V-263308" selected="true" /><select idref="V-263309" selected="true" /><select idref="V-263310" selected="true" /><select idref="V-263311" selected="true" /><select idref="V-263312" selected="true" /><select idref="V-263313" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263298" selected="true" /><select idref="V-263299" selected="true" /><select idref="V-263300" selected="true" /><select idref="V-263301" selected="true" /><select idref="V-263302" selected="true" /><select idref="V-263303" selected="true" /><select idref="V-263304" selected="true" /><select idref="V-263305" selected="true" /><select idref="V-263306" selected="true" /><select idref="V-263307" selected="true" /><select idref="V-263308" selected="true" /><select idref="V-263309" selected="true" /><select idref="V-263310" selected="true" /><select idref="V-263311" selected="true" /><select idref="V-263312" selected="true" /><select idref="V-263313" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-263298" selected="true" /><select idref="V-263299" selected="true" /><select idref="V-263300" selected="true" /><select idref="V-263301" selected="true" /><select idref="V-263302" selected="true" /><select idref="V-263303" selected="true" /><select idref="V-263304" selected="true" /><select idref="V-263305" selected="true" /><select idref="V-263306" selected="true" /><select idref="V-263307" selected="true" /><select idref="V-263308" selected="true" /><select idref="V-263309" selected="true" /><select idref="V-263310" selected="true" /><select idref="V-263311" selected="true" /><select idref="V-263312" selected="true" /><select idref="V-263313" selected="true" /></Profile><Group id="V-263298"><title>SRG-NET-000019-RTR-000003</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263298r979591_rule" weight="10.0" severity="high"><version>NT0R-4X-000013</version><title>The NSX Tier-0 Gateway router must be configured to disable Protocol Independent Multicast (PIM) on all interfaces that are not required to support multicast routing.</title><description>&lt;VulnDiscussion&gt;If multicast traffic is forwarded beyond the intended boundary, it is possible that it can be intercepted by unauthorized or unintended personnel. Limiting where, within the network, a given multicast group's data is permitted to flow is an important first step in improving multicast security. 

A scope zone is an instance of a connected region of a given scope. Zones of the same scope cannot overlap while zones of a smaller scope will fit completely within a zone of a larger scope. For example, Admin-local scope is smaller than Site-local scope, so the administratively configured boundary fits within the bounds of a site. According to RFC 4007 IPv6 Scoped Address Architecture (section 5), scope zones are also required to be "convex from a routing perspective"; that is, packets routed within a zone must not pass through any links that are outside of the zone. This requirement forces each zone to be one contiguous island rather than a series of separate islands. 

As stated in the DOD IPv6 IA Guidance for MO3, "One should be able to identify all interfaces of a zone by drawing a closed loop on their network diagram, engulfing some routers and passing through some routers to include only some of their interfaces." Therefore, it is imperative that the network engineers have documented their multicast topology and thereby knows which interfaces are enabled for multicast. Once this is done, the zones can be scoped as required.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001414</ident><fixtext fixref="F-67106r977660_fix">Disable multicast PIM routing on interfaces that are not required to support multicast by doing the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways and expand the target Tier-0 gateway.

Expand "Interfaces and GRE Tunnels", click on the number of interfaces present to open the interfaces dialog, and then select "Edit" on the target interface.

Expand "Multicast", change PIM to "disabled", and then click "Save".</fixtext><fix id="F-67106r977660_fix" /><check system="C-67198r979591_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway, expand the Tier-0 Gateway &gt;&gt; Interfaces and GRE Tunnels, and click on the number of interfaces present to open the interfaces dialog.

Expand each interface that is not required to support multicast routing, then expand "Multicast" and verify PIM is disabled.

If PIM is enabled on any interfaces that are not supporting multicast routing, this is a finding.</check-content></check></Rule></Group><Group id="V-263299"><title>SRG-NET-000019-RTR-000007</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263299r977664_rule" weight="10.0" severity="high"><version>NT0R-4X-000016</version><title>The NSX Tier-0 Gateway router must be configured to have all inactive interfaces removed.</title><description>&lt;VulnDiscussion&gt;An inactive interface is rarely monitored or controlled and may expose a network to an undetected attack on that interface. Unauthorized personnel with access to the communication facility could gain access to a router by connecting to a configured interface that is not in use.

If an interface is no longer used, the configuration must be deleted and the interface disabled. For sub-interfaces, delete sub-interfaces that are on inactive interfaces and delete sub-interfaces that are themselves inactive. If the sub-interface is no longer necessary for authorized communications, it must be deleted.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001414</ident><fixtext fixref="F-67107r977663_fix">Remove unused interfaces by doing the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways and expand the target Tier-0 gateway.

Expand "Interfaces and GRE Tunnels", then click on the number of interfaces present to open the interfaces dialog.

Select "Delete" on the unneeded interface, and then click "Delete" again to confirm.</fixtext><fix id="F-67107r977663_fix" /><check system="C-67199r977662_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway, expand the Tier-0 Gateway &gt;&gt; Interfaces and GRE Tunnels, and click on the number of interfaces present to open the interfaces dialog.

Review each interface present to determine if they are not in use or inactive.

If there are any interfaces present on a Tier-0 Gateway that are not in use or inactive, this is a finding.</check-content></check></Rule></Group><Group id="V-263300"><title>SRG-NET-000131-RTR-000035</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263300r977667_rule" weight="10.0" severity="info"><version>NT0R-4X-000027</version><title>The NSX Tier-0 Gateway router must be configured to have the Dynamic Host Configuration Protocol (DHCP) service disabled if not in use.</title><description>&lt;VulnDiscussion&gt;A compromised router introduces risk to the entire network infrastructure, as well as data resources that are accessible via the network. The perimeter defense has no oversight or control of attacks by malicious users within the network. Preventing network breaches from within is dependent on implementing a comprehensive defense-in-depth strategy, including securing each device connected to the network. This is accomplished by following and implementing all security guidance applicable for each node type. A fundamental step in securing each router is to enable only the capabilities required for operation.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-67108r977666_fix">From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways and edit the target Tier-0 Gateway.

Click "Set DHCP Configuration", select "No Dynamic IP Address Allocation", and then click "Save". Close "Editing".</fixtext><fix id="F-67108r977666_fix" /><check system="C-67200r977665_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway, expand the Tier-0 Gateway to view the DHCP configuration.

If a DHCP profile is configured and not in use, this is a finding.</check-content></check></Rule></Group><Group id="V-263301"><title>SRG-NET-000168-RTR-000077</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263301r977670_rule" weight="10.0" severity="high"><version>NT0R-4X-000029</version><title>The NSX Tier-0 Gateway router must be configured to use encryption for Open Shortest Path First (OSPF) routing protocol authentication.</title><description>&lt;VulnDiscussion&gt;A rogue router could send a fictitious routing update to convince a site's perimeter router to send traffic to an incorrect or even a rogue destination. This diverted traffic could be analyzed to learn confidential information about the site's network or used to disrupt the network's ability to communicate with other networks. This is known as a "traffic attraction attack" and is prevented by configuring neighbor router authentication for routing updates. However, using clear-text authentication provides little benefit since an attacker can intercept traffic and view the authentication key. This would allow the attacker to use the authentication key in an attack.

This requirement applies to all IPv4 and IPv6 protocols that are used to exchange routing or packet forwarding information; this includes all Interior Gateway Protocols (such as OSPF, Enhanced Interior Gateway Routing Protocol [EIGRP], and Intermediate System to Intermediate System [IS-IS]) and exterior gateway protocols (such as Border Gateway Protocol [BGP]), multiprotocol label switching (MPLS)-related protocols (such as Label Distribution Protocol [LDP]), and multicast-related protocols.

Typically routing protocols must be setup on both sides so knowing the authentication key does not necessarily mean an attacker would be able to setup a rogue router and peer with a legitimate one and inject malicious routes.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000803</ident><fixtext fixref="F-67109r977669_fix">To set authentication for OSPF area definitions, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways, and expand the target Tier-0 gateway.

Expand "OSPF", click the number next to "Area Definition". Select "Edit" on the target OSPF Area Definition.

Change the Authentication drop-down to MD5, enter a Key ID and Password, and then click "Save".

Note: The MD5 password can have a maximum of 16 characters.</fixtext><fix id="F-67109r977669_fix" /><check system="C-67201r977668_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>If the Tier-0 Gateway is not using OSPF, this is Not Applicable.

To verify OSPF areas are using authentication with encryption, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway, expand the "Tier-0 Gateway".

Expand "OSPF", click the number next to "Area Definition", and view the "Authentication" field for each area.

If OSPF area definitions do not have the "Authentication" field set to "MD5" and a "Key ID" and "Password" configured, this is a finding.</check-content></check></Rule></Group><Group id="V-263302"><title>SRG-NET-000205-RTR-000014</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263302r977673_rule" weight="10.0" severity="high"><version>NT0R-4X-000051</version><title>The NSX Tier-0 Gateway router must be configured to restrict it from accepting outbound IP packets that contain an illegitimate address in the source address field by enabling Unicast Reverse Path Forwarding (uRPF).</title><description>&lt;VulnDiscussion&gt;A compromised host in an enclave can be used by a malicious platform to launch cyber attacks on third parties. This is a common practice in "botnets", which are a collection of compromised computers using malware to attack other computers or networks. Distributed denial-of-service (DDoS) attacks frequently leverage IP source address spoofing to send packets to multiple hosts that in turn will then send return traffic to the hosts with the IP addresses that were forged. This can generate significant amounts of traffic. Therefore, protection measures to counteract IP source address spoofing must be taken. When uRPF is enabled in strict mode, the packet must be received on the interface that the device would use to forward the return packet; thereby mitigating IP source address spoofing.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001094</ident><fixtext fixref="F-67110r977672_fix">Enable strict URPF mode on interfaces by doing the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways and expand the target Tier-0 gateway.

Expand "Interfaces and GRE Tunnels", click on the number of interfaces present to open the interfaces dialog, and then select "Edit" on the target interface.

From the drop-down, set the URPF mode to "Strict" and then click "Save".</fixtext><fix id="F-67110r977672_fix" /><check system="C-67202r977671_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway, expand Tier-0 Gateway &gt;&gt; Interfaces and GRE Tunnels, and then click on the number of interfaces present to open the interfaces dialog.

Expand each interface to view the URPF Mode configuration.

If URPF Mode is not set to "Strict" on any interface, this is a finding.</check-content></check></Rule></Group><Group id="V-263303"><title>SRG-NET-000230-RTR-000001</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263303r979592_rule" weight="10.0" severity="high"><version>NT0R-4X-000054</version><title>The NSX Tier-0 Gateway router must be configured to implement message authentication for all control plane protocols.</title><description>&lt;VulnDiscussion&gt;A rogue router could send a fictitious routing update to convince a site's perimeter router to send traffic to an incorrect or even a rogue destination. This diverted traffic could be analyzed to learn confidential information about the site's network or used to disrupt the network's ability to communicate with other networks. This is known as a "traffic attraction attack" and is prevented by configuring neighbor router authentication for routing updates.

This requirement applies to all IPv4 and IPv6 protocols that are used to exchange routing or packet forwarding information. This includes Border Gateway Protocol (BGP), Routing Information Protocol (RIP), Open Shortest Path First (OSPF), Enhanced Interior Gateway Routing Protocol (EIGRP), Intermediate System to Intermediate System (IS-IS) and Label Distribution Protocol (LDP).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><ident system="http://cyber.mil/cci">CCI-002205</ident><fixtext fixref="F-67111r977675_fix">To set authentication for BGP neighbors, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways, and expand the target Tier-0 gateway.

Expand BGP. Next to BGP Neighbors, click on the number present to open the dialog, then select "Edit" on the target BGP Neighbor.

Under Timers &amp; Password, enter a password up to 20 characters, and then click "Save".

To set authentication for OSPF Area definitions, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways, and expand the target Tier-0 gateway.

Expand OSPF. Next to "Area Definition", click on the number present to open the dialog, and then select "Edit" on the target OSPF Area.

Change the Authentication drop-down to Password or MD5, enter a Key ID and/or Password, and then click "Save".</fixtext><fix id="F-67111r977675_fix" /><check system="C-67203r977674_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>If the Tier-0 Gateway is not using BGP or OSPF, this is Not Applicable.

Since the router does not reveal if a BGP password is configured, interview the router administrator to determine if a password is configured on BGP neighbors.

If BGP neighbors do not have a password configured, this is a finding.

To verify OSPF areas are using authentication, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway expand the "Tier-0 Gateway".

Expand "OSPF", click the number next to "Area Definition", and view the "Authentication" field for each area.

If OSPF area definitions do not have Password or MD5 set for authentication, this is a finding.</check-content></check></Rule></Group><Group id="V-263304"><title>SRG-NET-000230-RTR-000002</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263304r977679_rule" weight="10.0" severity="medium"><version>NT0R-4X-000055</version><title>The NSX Tier-0 Gateway must be configured to use a unique password for each autonomous system (AS) with which it peers.</title><description>&lt;VulnDiscussion&gt;If the same keys are used between External Border Gateway Protocol (eBGP) neighbors, the chance of a hacker compromising any of the BGP sessions increases. It is possible that a malicious user exists in one autonomous system who would know the key used for the eBGP session. This user would then be able to hijack BGP sessions with other trusted neighbors.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-002205</ident><fixtext fixref="F-67112r977678_fix">To set authentication for BGP neighbors, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways, and expand the target Tier-0 gateway.

Expand BGP. Next to "BGP Neighbors", click on the number present to open the dialog, then select "Edit" on the target BGP Neighbor.

Expand "BGP", click the number next to "BGP Neighbors". Select "Edit" on the target BGP neighbor.

Under Timers &amp; Password, enter a password up to 20 characters that is different from other autonomous systems, and then click "Save".</fixtext><fix id="F-67112r977678_fix" /><check system="C-67204r977677_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>If the Tier-0 Gateway is not using BGP, this is Not Applicable.

Since the NSX Tier-0 Gateway does not reveal the current password, interview the router administrator to determine if unique passwords are being used.

If unique passwords are not being used for each AS, this is a finding.</check-content></check></Rule></Group><Group id="V-263305"><title>SRG-NET-000362-RTR-000113</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263305r977682_rule" weight="10.0" severity="medium"><version>NT0R-4X-000064</version><title>The NSX Tier-0 Gateway router must be configured to have Internet Control Message Protocol (ICMP) unreachable notifications disabled on all external interfaces.</title><description>&lt;VulnDiscussion&gt;The ICMP supports IP traffic by relaying information about paths, routes, and network conditions. Routers automatically send ICMP messages under a wide variety of conditions. Host unreachable ICMP messages are commonly used by attackers for network mapping and diagnosis.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-002385</ident><fixtext fixref="F-67113r977681_fix">To configure a shared rule to drop ICMP unreachable messages, do the following:

From the NSX Manager web interface, go to Security &gt;&gt; Policy Management &gt;&gt; Gateway Firewall &gt;&gt; All Shared Rules.

Click "Add Rule" (add a policy first, if needed) and under "Services", select "ICMP Destination Unreachable" and "Apply".

Enable logging and under the "Applied To" field select the target Tier-0 Gateways and click "Publish" to enforce the new rule.

Note: A rule can also be created under Gateway Specific Rules to meet this requirement.</fixtext><fix id="F-67113r977681_fix" /><check system="C-67205r977680_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>If the Tier-0 Gateway is deployed in an Active/Active HA mode, this is Not Applicable.

From the NSX Manager web interface, go to Security &gt;&gt; Policy Management &gt;&gt; Gateway Firewall &gt;&gt; Gateway Specific Rules, and choose each Tier-0 Gateway in the drop-down.

Review each Tier-0 Gateway Firewall rule to verify one exists to drop ICMP unreachable messages.

If a rule does not exist to drop ICMP unreachable messages, this is a finding.</check-content></check></Rule></Group><Group id="V-263306"><title>SRG-NET-000362-RTR-000114</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263306r977685_rule" weight="10.0" severity="medium"><version>NT0R-4X-000065</version><title>The NSX Tier-0 Gateway router must be configured to have Internet Control Message Protocol (ICMP) mask replies disabled on all external interfaces.</title><description>&lt;VulnDiscussion&gt;The ICMP supports IP traffic by relaying information about paths, routes, and network conditions. Routers automatically send ICMP messages under a wide variety of conditions. Mask Reply ICMP messages are commonly used by attackers for network mapping and diagnosis.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-002385</ident><fixtext fixref="F-67114r977684_fix">To configure a shared rule to drop ICMP unreachable messages, do the following:

From the NSX Manager web interface, go to Security &gt;&gt; Policy Management &gt;&gt; Gateway Firewall &gt;&gt; All Shared Rules.

Click "Add Rule" (add a policy first if needed). Under "Services", select the custom service that identifies ICMP mask replies, and then click "Apply".

Enable logging, under the "Applied To" field select the target Tier-0 Gateways external interfaces, and then select "Publish" to enforce the new rule.

Note: A rule can also be created under Gateway Specific Rules to meet this requirement.

Note: A pre-created service for ICMP mask replies does not exist by default and may need created.</fixtext><fix id="F-67114r977684_fix" /><check system="C-67206r977683_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>If the Tier-0 Gateway is deployed in an Active/Active HA mode, this is Not Applicable.

From the NSX Manager web interface, go to Security &gt;&gt; Policy Management &gt;&gt; Gateway Firewall &gt;&gt; Gateway Specific Rules, and choose each Tier-0 Gateway in the drop-down menu.

Review each Tier-0 Gateway Firewall rule to verify one exists to drop ICMP mask replies.

If a rule does not exist to drop ICMP mask replies, this is a finding.</check-content></check></Rule></Group><Group id="V-263307"><title>SRG-NET-000362-RTR-000115</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263307r977688_rule" weight="10.0" severity="medium"><version>NT0R-4X-000066</version><title>The NSX Tier-0 Gateway router must be configured to have Internet Control Message Protocol (ICMP) redirects disabled on all external interfaces.</title><description>&lt;VulnDiscussion&gt;The ICMP supports IP traffic by relaying information about paths, routes, and network conditions. Routers automatically send ICMP messages under a wide variety of conditions. Redirect ICMP messages are commonly used by attackers for network mapping and diagnosis.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-002385</ident><fixtext fixref="F-67115r977687_fix">To configure a shared rule to drop ICMP unreachable messages, do the following:

From the NSX Manager web interface, go to Security &gt;&gt; Policy Management &gt;&gt; Gateway Firewall &gt;&gt; All Shared Rules.

Click "Add Rule" (add a policy first if needed). Under "Services", select "ICMP Redirect", and then click "Apply".

To enable logging, under the "Applied To" field, select the target Tier-0 Gateways external interfaces, and then click "Publish" to enforce the new rule.

Note: A rule can also be created under Gateway Specific Rules to meet this requirement.</fixtext><fix id="F-67115r977687_fix" /><check system="C-67207r977686_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>If the Tier-0 Gateway is deployed in an Active/Active HA mode, this is Not Applicable.

From the NSX Manager web interface, go to Security &gt;&gt; Policy Management &gt;&gt; Gateway Firewall &gt;&gt; Gateway Specific Rules, and choose each Tier-0 Gateway in the drop-down menu.

Review each Tier-0 Gateway Firewalls rules to verify one exists to drop ICMP redirects.

If a rule does not exist to drop ICMP redirects, this is a finding.</check-content></check></Rule></Group><Group id="V-263308"><title>SRG-NET-000362-RTR-000117</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263308r977691_rule" weight="10.0" severity="medium"><version>NT0R-4X-000067</version><title>The NSX Tier-0 Gateway router must be configured to use the Border Gateway Protocol (BGP) maximum prefixes feature to protect against route table flooding and prefix de-aggregation attacks.</title><description>&lt;VulnDiscussion&gt;The effects of prefix de-aggregation can degrade router performance due to the size of routing tables and also result in black-holing legitimate traffic. Initiated by an attacker or a misconfigured router, prefix de-aggregation occurs when the announcement of a large prefix is fragmented into a collection of smaller prefix announcements.

In 1997, misconfigured routers in the Florida Internet Exchange network (AS7007) de-aggregated every prefix in their routing table and started advertising the first /24 block of each of these prefixes as their own. Faced with this additional burden, the internal routers became overloaded and crashed repeatedly. This caused prefixes advertised by these routers to disappear from routing tables and reappear when the routers came back online. As the routers came back after crashing, they were flooded with the routing table information by their neighbors. The flood of information would again overwhelm the routers and cause them to crash. This process of route flapping served to destabilize not only the surrounding network but also the entire internet. Routers trying to reach those addresses would choose the smaller, more specific /24 blocks first. This caused backbone networks throughout North America and Europe to crash.

Maximum prefix limits on peer connections combined with aggressive prefix-size filtering of customers' reachability advertisements will effectively mitigate the de-aggregation risk. BGP maximum prefix must be used on all eBGP routers to limit the number of prefixes that it should receive from a particular neighbor, whether customer or peering autonomous system (AS). Consider each neighbor and how many routes they should be advertising and set a threshold slightly higher than the number expected.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-002385</ident><fixtext fixref="F-67116r977690_fix">To set maximum prefixes for BGP neighbors, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways and expand the target Tier-0 gateway.

Expand BGP. Next to "BGP Neighbors", click on the number present to open the dialog, and then select "Edit" on the target BGP Neighbor.

Click "Router Filter", add or edit an existing router filter, enter a number for "Maximum Routes", and then click "Add".

Click "Apply", then click "Save" to finish the configuration.</fixtext><fix id="F-67116r977690_fix" /><check system="C-67208r977689_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>If the Tier-0 Gateway is not using BGP, this is Not Applicable.

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway with BGP enabled, expand the Tier-0 Gateway.

Expand BGP, click on the number next to "BGP Neighbors", and then view the router filters for each neighbor.

If "Maximum Routes" is not configured, or a route filter does not exist for each BGP neighbor, this is a finding.</check-content></check></Rule></Group><Group id="V-263309"><title>SRG-NET-000512-RTR-000001</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263309r977694_rule" weight="10.0" severity="info"><version>NT0R-4X-000091</version><title>The NSX Tier-0 Gateway router must be configured to use its loopback address as the source address for Internal Border Gateway Protocol (IBGP) peering sessions.</title><description>&lt;VulnDiscussion&gt;Using a loopback address as the source address offers a multitude of uses for security, access, management, and scalability of the Border Gateway Protocol (BGP) routers. It is easier to construct appropriate ingress filters for router management plane traffic destined to the network management subnet since the source addresses will be from the range used for loopback interfaces instead of a larger range of addresses used for physical interfaces. Log information recorded by authentication and syslog servers will record the routerâ€™s loopback address instead of the numerous physical interface addresses.

The routers within the iBGP domain should also use loopback addresses as the source address when establishing BGP sessions.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-67117r977693_fix">To configure a loopback interface, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways and expand the target Tier-0 gateway.

Expand interfaces and click "Add Interface".

Enter a name, select "Loopback" as the Type, enter an IP address, select an Edge Node for the interface, then click "Save".

Note: More than one loopback may need to be configured depending on the routing architecture.


To set the source address for BGP neighbors, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways &gt;&gt; expand the target Tier-0 gateway.

Expand BGP &gt;&gt; next to BGP Neighbors, click on the number present to open the dialog &gt;&gt; select "Edit" on the target BGP Neighbor.

Under Source Addresses, configure the source address with the loopback address and click "Save".</fixtext><fix id="F-67117r977693_fix" /><check system="C-67209r977692_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>If the Tier-0 Gateway is not using iBGP, this is Not Applicable.

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway with BGP enabled, expand the Tier-0 Gateway.

Expand BGP, click on the number next to BGP Neighbors, then view the source address for each neighbor.

If the Source Address is not configured as the Tier-0 Gateway loopback address for the iBGP session, this is a finding.</check-content></check></Rule></Group><Group id="V-263310"><title>SRG-NET-000512-RTR-000012</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263310r977697_rule" weight="10.0" severity="info"><version>NT0R-4X-000102</version><title>The NSX Tier-0 Gateway router must be configured to advertise a hop limit of at least 32 in Router Advertisement messages for IPv6 stateless auto-configuration deployments.</title><description>&lt;VulnDiscussion&gt;The Neighbor Discovery (ND) protocol allows a hop limit value to be advertised by routers in a Router Advertisement message being used by hosts instead of the standardized default value. If a very small value was configured and advertised to hosts on the LAN segment, communications would fail due to the hop limit reaching zero before the packets sent by a host reached its destination.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-67118r977696_fix">To configure the Neighbor Discovery hop limit, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways &gt;&gt; edit the target Tier-0 gateway.

Expand Additional Settings and select an "ND Profile" from the drop down with a hop limit of 32 or more, then click "Close Editing".

Note: The default ND profile has a hop limit of 64 and cannot be edited. If required, create a new or edit another existing ND profile to use.</fixtext><fix id="F-67118r977696_fix" /><check system="C-67210r977695_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>If IPv6 forwarding is not enabled, this is Not Applicable.

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway, expand Tier-0 Gateway &gt;&gt;Additional Settings.

Click on the ND profile name to view the hop limit.

If the hop limit is not configured to at least 32, this is a finding.</check-content></check></Rule></Group><Group id="V-263311"><title>SRG-NET-000131-RTR-000035</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263311r977700_rule" weight="10.0" severity="info"><version>NT0R-4X-000106</version><title>The NSX Tier-0 Gateway router must be configured to have routing protocols disabled if not in use.</title><description>&lt;VulnDiscussion&gt;A compromised router introduces risk to the entire network infrastructure, as well as data resources that are accessible via the network. The perimeter defense has no oversight or control of attacks by malicious users within the network. Preventing network breaches from within is dependent on implementing a comprehensive defense-in-depth strategy, including securing each device connected to the network. This is accomplished by following and implementing all security guidance applicable for each node type. A fundamental step in securing each router is to enable only the capabilities required for operation.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-67119r977699_fix">If not used in the implementation, then disable BGP, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways and edit the target Tier-0 Gateway.

Expand BGP, change from "On" to "Off", and then click "Save".

If not used in the implementation, then disable OSPF, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways and edit the target Tier-0 Gateway.

Expand OSPF, change from "Enabled" to "Disabled", and then click "Save".</fixtext><fix id="F-67119r977699_fix" /><check system="C-67211r977698_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway, expand the Tier-0 Gateway to view if border gateway protocol (BGP) or Open Shortest Path First (OSPF) is enabled.

If BGP and/or OSPF is enabled and not in use, this is a finding.</check-content></check></Rule></Group><Group id="V-263312"><title>SRG-NET-000131-RTR-000035</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263312r977703_rule" weight="10.0" severity="info"><version>NT0R-4X-000107</version><title>The NSX Tier-0 Gateway router must be configured to have multicast disabled if not in use.</title><description>&lt;VulnDiscussion&gt;A compromised router introduces risk to the entire network infrastructure, as well as data resources that are accessible via the network. The perimeter defense has no oversight or control of attacks by malicious users within the network. Preventing network breaches from within is dependent on implementing a comprehensive defense-in-depth strategy, including securing each device connected to the network. This is accomplished by following and implementing all security guidance applicable for each node type. A fundamental step in securing each router is to enable only the capabilities required for operation.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-67120r977702_fix">If not used, disable Multicast by doing the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways and edit the target Tier-0 Gateway.

Expand Multicast, change from "Enabled" to "Disabled", and then click "Save".</fixtext><fix id="F-67120r977702_fix" /><check system="C-67212r977701_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway, expand the Tier-0 Gateway, then expand "Multicast" to view the multicast configuration.

If multicast is enabled and not in use, this is a finding.</check-content></check></Rule></Group><Group id="V-263313"><title>SRG-NET-000168-RTR-000077</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-263313r977706_rule" weight="10.0" severity="high"><version>NT0R-4X-000108</version><title>The NSX Tier-0 Gateway router must be configured to use encryption for border gateway protocol (BGP) routing protocol authentication.</title><description>&lt;VulnDiscussion&gt;A rogue router could send a fictitious routing update to convince a site's perimeter router to send traffic to an incorrect or even a rogue destination. This diverted traffic could be analyzed to learn confidential information about the site's network or used to disrupt the network's ability to communicate with other networks. This is known as a "traffic attraction attack" and is prevented by configuring neighbor router authentication for routing updates. However, using clear-text authentication provides little benefit since an attacker can intercept traffic and view the authentication key. This would allow the attacker to use the authentication key in an attack.

This requirement applies to all IPv4 and IPv6 protocols that are used to exchange routing or packet forwarding information; this includes all Interior Gateway Protocols (such as Open Shortest Path First [OSPF], Enhanced Interior Gateway Routing Protocol [EIGRP], and Intermediate System to Intermediate System [IS-IS]) and Exterior Gateway Protocols (such as BGP), multiprotocol label switching (MPLS)-related protocols (such as Label Distribution Protocol [LDP]), and multicast-related protocols.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware NSX 4.x Tier-0 Gateway Router</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware NSX 4.x Tier-0 Gateway Router</dc:subject><dc:identifier>5614</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><ident system="http://cyber.mil/cci">CCI-002205</ident><fixtext fixref="F-67121r977705_fix">To set authentication for BGP neighbors, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways, and expand the target Tier-0 gateway.

Expand BGP. Next to "BGP Neighbors", click on the number present to open the dialog, then select "Edit" on the target BGP Neighbor.

Expand "BGP", click the number next to "BGP Neighbors". Select "Edit" on the target BGP neighbor.

Under Timers &amp; Password, enter a password up to 20 characters, and then click "Save".</fixtext><fix id="F-67121r977705_fix" /><check system="C-67213r977704_chk"><check-content-ref href="VMware_NSX_4.x_Tier-0_Gateway_Router_STIG.xml" name="M" /><check-content>If the Tier-0 Gateway is not using BGP, this is Not Applicable.

To verify BGP neighbors are using authentication with encryption, do the following:

From the NSX Manager web interface, go to Networking &gt;&gt; Connectivity &gt;&gt; Tier-0 Gateways.

For every Tier-0 Gateway, expand the "Tier-0 Gateway".

Expand "BGP", click the number next to "BGP Neighbors" and expand each BGP neighbor.

Expand the "Timers and Password" section and review the Password field.

If any BGP neighbors do not have a password configured, this is a finding.</check-content></check></Rule></Group></Benchmark>