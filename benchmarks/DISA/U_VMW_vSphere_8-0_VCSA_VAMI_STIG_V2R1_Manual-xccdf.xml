<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" id="VMW_vSphere_8-0_VCSA_VAMI_STIG" xml:lang="en" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2024-07-11">accepted</status><title>VMware vSphere 8.0 vCenter Appliance Management Interface (VAMI) Security Technical Implementation Guide</title><description>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.</description><notice id="terms-of-use" xml:lang="en"></notice><front-matter xml:lang="en"></front-matter><rear-matter xml:lang="en"></rear-matter><reference href="https://cyber.mil"><dc:publisher>DISA</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 1 Benchmark Date: 01 Aug 2024</plain-text><plain-text id="generator">3.5</plain-text><plain-text id="conventionsVersion">1.10.0</plain-text><version>2</version><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259137" selected="true" /><select idref="V-259138" selected="true" /><select idref="V-259139" selected="true" /><select idref="V-259140" selected="true" /><select idref="V-259141" selected="true" /><select idref="V-259142" selected="true" /><select idref="V-259143" selected="true" /><select idref="V-259144" selected="true" /><select idref="V-259145" selected="true" /><select idref="V-259146" selected="true" /><select idref="V-259147" selected="true" /><select idref="V-259149" selected="true" /><select idref="V-259150" selected="true" /><select idref="V-259151" selected="true" /><select idref="V-259152" selected="true" /><select idref="V-259153" selected="true" /><select idref="V-259155" selected="true" /><select idref="V-259156" selected="true" /><select idref="V-259157" selected="true" /><select idref="V-259158" selected="true" /><select idref="V-259159" selected="true" /><select idref="V-259160" selected="true" /></Profile><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259137" selected="true" /><select idref="V-259138" selected="true" /><select idref="V-259139" selected="true" /><select idref="V-259140" selected="true" /><select idref="V-259141" selected="true" /><select idref="V-259142" selected="true" /><select idref="V-259143" selected="true" /><select idref="V-259144" selected="true" /><select idref="V-259145" selected="true" /><select idref="V-259146" selected="true" /><select idref="V-259147" selected="true" /><select idref="V-259149" selected="true" /><select idref="V-259150" selected="true" /><select idref="V-259151" selected="true" /><select idref="V-259152" selected="true" /><select idref="V-259153" selected="true" /><select idref="V-259155" selected="true" /><select idref="V-259156" selected="true" /><select idref="V-259157" selected="true" /><select idref="V-259158" selected="true" /><select idref="V-259159" selected="true" /><select idref="V-259160" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259137" selected="true" /><select idref="V-259138" selected="true" /><select idref="V-259139" selected="true" /><select idref="V-259140" selected="true" /><select idref="V-259141" selected="true" /><select idref="V-259142" selected="true" /><select idref="V-259143" selected="true" /><select idref="V-259144" selected="true" /><select idref="V-259145" selected="true" /><select idref="V-259146" selected="true" /><select idref="V-259147" selected="true" /><select idref="V-259149" selected="true" /><select idref="V-259150" selected="true" /><select idref="V-259151" selected="true" /><select idref="V-259152" selected="true" /><select idref="V-259153" selected="true" /><select idref="V-259155" selected="true" /><select idref="V-259156" selected="true" /><select idref="V-259157" selected="true" /><select idref="V-259158" selected="true" /><select idref="V-259159" selected="true" /><select idref="V-259160" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259137" selected="true" /><select idref="V-259138" selected="true" /><select idref="V-259139" selected="true" /><select idref="V-259140" selected="true" /><select idref="V-259141" selected="true" /><select idref="V-259142" selected="true" /><select idref="V-259143" selected="true" /><select idref="V-259144" selected="true" /><select idref="V-259145" selected="true" /><select idref="V-259146" selected="true" /><select idref="V-259147" selected="true" /><select idref="V-259149" selected="true" /><select idref="V-259150" selected="true" /><select idref="V-259151" selected="true" /><select idref="V-259152" selected="true" /><select idref="V-259153" selected="true" /><select idref="V-259155" selected="true" /><select idref="V-259156" selected="true" /><select idref="V-259157" selected="true" /><select idref="V-259158" selected="true" /><select idref="V-259159" selected="true" /><select idref="V-259160" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259137" selected="true" /><select idref="V-259138" selected="true" /><select idref="V-259139" selected="true" /><select idref="V-259140" selected="true" /><select idref="V-259141" selected="true" /><select idref="V-259142" selected="true" /><select idref="V-259143" selected="true" /><select idref="V-259144" selected="true" /><select idref="V-259145" selected="true" /><select idref="V-259146" selected="true" /><select idref="V-259147" selected="true" /><select idref="V-259149" selected="true" /><select idref="V-259150" selected="true" /><select idref="V-259151" selected="true" /><select idref="V-259152" selected="true" /><select idref="V-259153" selected="true" /><select idref="V-259155" selected="true" /><select idref="V-259156" selected="true" /><select idref="V-259157" selected="true" /><select idref="V-259158" selected="true" /><select idref="V-259159" selected="true" /><select idref="V-259160" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259137" selected="true" /><select idref="V-259138" selected="true" /><select idref="V-259139" selected="true" /><select idref="V-259140" selected="true" /><select idref="V-259141" selected="true" /><select idref="V-259142" selected="true" /><select idref="V-259143" selected="true" /><select idref="V-259144" selected="true" /><select idref="V-259145" selected="true" /><select idref="V-259146" selected="true" /><select idref="V-259147" selected="true" /><select idref="V-259149" selected="true" /><select idref="V-259150" selected="true" /><select idref="V-259151" selected="true" /><select idref="V-259152" selected="true" /><select idref="V-259153" selected="true" /><select idref="V-259155" selected="true" /><select idref="V-259156" selected="true" /><select idref="V-259157" selected="true" /><select idref="V-259158" selected="true" /><select idref="V-259159" selected="true" /><select idref="V-259160" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259137" selected="true" /><select idref="V-259138" selected="true" /><select idref="V-259139" selected="true" /><select idref="V-259140" selected="true" /><select idref="V-259141" selected="true" /><select idref="V-259142" selected="true" /><select idref="V-259143" selected="true" /><select idref="V-259144" selected="true" /><select idref="V-259145" selected="true" /><select idref="V-259146" selected="true" /><select idref="V-259147" selected="true" /><select idref="V-259149" selected="true" /><select idref="V-259150" selected="true" /><select idref="V-259151" selected="true" /><select idref="V-259152" selected="true" /><select idref="V-259153" selected="true" /><select idref="V-259155" selected="true" /><select idref="V-259156" selected="true" /><select idref="V-259157" selected="true" /><select idref="V-259158" selected="true" /><select idref="V-259159" selected="true" /><select idref="V-259160" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259137" selected="true" /><select idref="V-259138" selected="true" /><select idref="V-259139" selected="true" /><select idref="V-259140" selected="true" /><select idref="V-259141" selected="true" /><select idref="V-259142" selected="true" /><select idref="V-259143" selected="true" /><select idref="V-259144" selected="true" /><select idref="V-259145" selected="true" /><select idref="V-259146" selected="true" /><select idref="V-259147" selected="true" /><select idref="V-259149" selected="true" /><select idref="V-259150" selected="true" /><select idref="V-259151" selected="true" /><select idref="V-259152" selected="true" /><select idref="V-259153" selected="true" /><select idref="V-259155" selected="true" /><select idref="V-259156" selected="true" /><select idref="V-259157" selected="true" /><select idref="V-259158" selected="true" /><select idref="V-259159" selected="true" /><select idref="V-259160" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259137" selected="true" /><select idref="V-259138" selected="true" /><select idref="V-259139" selected="true" /><select idref="V-259140" selected="true" /><select idref="V-259141" selected="true" /><select idref="V-259142" selected="true" /><select idref="V-259143" selected="true" /><select idref="V-259144" selected="true" /><select idref="V-259145" selected="true" /><select idref="V-259146" selected="true" /><select idref="V-259147" selected="true" /><select idref="V-259149" selected="true" /><select idref="V-259150" selected="true" /><select idref="V-259151" selected="true" /><select idref="V-259152" selected="true" /><select idref="V-259153" selected="true" /><select idref="V-259155" selected="true" /><select idref="V-259156" selected="true" /><select idref="V-259157" selected="true" /><select idref="V-259158" selected="true" /><select idref="V-259159" selected="true" /><select idref="V-259160" selected="true" /></Profile><Group id="V-259137"><title>SRG-APP-000001-WSR-000001</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259137r1003685_rule" weight="10.0" severity="medium"><version>VCLD-80-000001</version><title>The vCenter VAMI service must limit the number of allowed simultaneous session requests.</title><description>&lt;VulnDiscussion&gt;Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests. Mitigation against these threats is to take steps to limit the number of resources that can be consumed in certain ways.

VAMI provides the "maxConnections" attribute of the &lt;Connector Elements&gt; to limit the number of concurrent Transmission Control Protocol (TCP) connections. This comes preconfigured with a tested, supported value that must be verified and maintained.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000054</ident><fixtext fixref="F-62786r1003684_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf

Add or reconfigure the following value:

server.max-connections = 1024

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62786r1003684_fix" /><check system="C-62877r1003683_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null |grep "server.max-connections"

Example result:

server.max-connections = 1024

If "server.max-connections" is not configured to 1024 or less, this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259138"><title>SRG-APP-000015-WSR-000014</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259138r1003688_rule" weight="10.0" severity="medium"><version>VCLD-80-000004</version><title>The vCenter VAMI service must use cryptography to protect the integrity of remote sessions.</title><description>&lt;VulnDiscussion&gt;Data exchanged between the user and the web server can range from static display data to credentials used to log in the hosted application. Even when data appears to be static, the nondisplayed logic in a web page may expose business logic or trusted system relationships. The integrity of all the data being exchanged between the user and web server must always be trusted. To protect the integrity and trust, encryption methods should be used to protect the complete communication session.

To protect the integrity and confidentiality of the remote sessions, VAMI uses Secure Sockets Layer (SSL)/Transport Layer Security (TLS).

Satisfies: SRG-APP-000015-WSR-000014, SRG-APP-000315-WSR-000003&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001453</ident><ident system="http://cyber.mil/cci">CCI-002314</ident><fixtext fixref="F-62787r1003687_fix">Navigate to and open:

/opt/vmware/etc/lighttpd/applmgmt-lighttpd.conf

Add or reconfigure the following value:

ssl.engine = "enable"

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62787r1003687_fix" /><check system="C-62878r1003686_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|grep "ssl.engine"

Example result:

ssl.engine = "enable"

If "ssl.engine" is not set to "enable", this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259139"><title>SRG-APP-000016-WSR-000005</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259139r1003691_rule" weight="10.0" severity="medium"><version>VCLD-80-000005</version><title>The vCenter VAMI service must generate information to monitor remote access.</title><description>&lt;VulnDiscussion&gt;Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success.

VAMI uses the "mod_accesslog" module to log information relating to remote requests. These logs can then be piped to external monitoring systems.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000067</ident><fixtext fixref="F-62788r1003690_fix">Navigate to and open:

/opt/vmware/etc/lighttpd/applmgmt-lighttpd.conf

Add the following value in the "server.modules" section:

mod_accesslog

The result should be similar to the following:

server.modules += ("mod_accesslog", "mod_cgi", "mod_magnet", "mod_rewrite")

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62788r1003690_fix" /><check system="C-62879r1003689_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|awk '/server\.modules/,/\)/'|grep mod_accesslog

Example result:

"mod_accesslog",

If the "mod_accesslog" is not present, this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259140"><title>SRG-APP-000095-WSR-000056</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259140r1003694_rule" weight="10.0" severity="medium"><version>VCLD-80-000010</version><title>The vCenter VAMI service must produce log records containing sufficient information to establish what type of events occurred.</title><description>&lt;VulnDiscussion&gt;Web server logging capability is critical for accurate forensic analysis. Without sufficient and accurate information, a correct replay of the events cannot be determined.

Ascertaining the correct type of event that occurred is important during forensic analysis. The correct determination of the event and when it occurred is important in relation to other events that happened at that same time.

Without sufficient information establishing what type of log event occurred, investigation into the cause of event is severely hindered. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, file names involved, access control, or flow control rules invoked.

Satisfies: SRG-APP-000095-WSR-000056, SRG-APP-000096-WSR-000057, SRG-APP-000097-WSR-000058, SRG-APP-000098-WSR-000059, SRG-APP-000099-WSR-000061, SRG-APP-000100-WSR-000064, SRG-APP-000374-WSR-000172, SRG-APP-000375-WSR-000171&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000130</ident><ident system="http://cyber.mil/cci">CCI-000131</ident><ident system="http://cyber.mil/cci">CCI-000132</ident><ident system="http://cyber.mil/cci">CCI-000133</ident><ident system="http://cyber.mil/cci">CCI-000134</ident><ident system="http://cyber.mil/cci">CCI-001487</ident><ident system="http://cyber.mil/cci">CCI-001889</ident><ident system="http://cyber.mil/cci">CCI-001890</ident><fixtext fixref="F-62789r1003693_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf

Comment any existing accesslog.format lines by adding a "#" at the beginning of the line.

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62789r1003693_fix" /><check system="C-62880r1003692_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|grep "accesslog.format"

The default commented, accesslog format is acceptable for this requirement. No output should be returned.

If the command returns any output, this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259141"><title>SRG-APP-000118-WSR-000068</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259141r960930_rule" weight="10.0" severity="medium"><version>VCLD-80-000019</version><title>The vCenter VAMI service log files must only be accessible by privileged users.</title><description>&lt;VulnDiscussion&gt;Log data is essential in the investigation of events. If log data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to log records provides information an attacker could potentially use to their advantage since each event record might contain communication ports, protocols, services, trust relationships, user names, etc.

The web server must protect the log data from unauthorized read, write, copy, etc. This can be done by the web server if the web server is also doing the logging function. The web server may also use an external log system. In either case, the logs must be protected from access by nonprivileged users.

Satisfies: SRG-APP-000118-WSR-000068, SRG-APP-000119-WSR-000069, SRG-APP-000120-WSR-000070&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000162</ident><ident system="http://cyber.mil/cci">CCI-000163</ident><ident system="http://cyber.mil/cci">CCI-000164</ident><fixtext fixref="F-62790r935326_fix">At the command prompt, run the following commands for log files under /opt/vmware/var/log/lighttpd/:

# chmod o-w &lt;file&gt;
# chown lighttpd:lighttpd &lt;file&gt;

At the command prompt, run the following commands for all other log files:

# chmod o-w &lt;file&gt;
# chown root:root &lt;file&gt;

Note: Substitute &lt;file&gt; with the listed file.</fixtext><fix id="F-62790r935326_fix" /><check system="C-62881r935325_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following commands:

# find /var/log/vmware/applmgmt/ /var/log/vmware/applmgmt-audit/ -xdev -type f -a '(' -perm -o+w -o -not -user root -o -not -group root ')' -exec ls -ld {} \;
# find /opt/vmware/var/log/lighttpd/ -xdev -type f -a '(' -perm -o+w -o -not -user lighttpd -o -not -group lighttpd ')' -exec ls -ld {} \;

If any files are returned, this is a finding.</check-content></check></Rule></Group><Group id="V-259142"><title>SRG-APP-000125-WSR-000071</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259142r960948_rule" weight="10.0" severity="medium"><version>VCLD-80-000022</version><title>The vCenter VAMI service must off-load log records onto a different system or media from the system being logged.</title><description>&lt;VulnDiscussion&gt;Protection of log data includes assuring log data is not accidentally lost or deleted. Backing up log records to an unrelated system or onto separate media than the system the web server is actually running on helps to assure that, in the event of a catastrophic system failure, the log records will be retained.

Satisfies: SRG-APP-000125-WSR-000071, SRG-APP-000358-WSR-000063, SRG-APP-000358-WSR-000163&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001348</ident><ident system="http://cyber.mil/cci">CCI-001851</ident><fixtext fixref="F-62791r935329_fix">Navigate to and open:

/etc/vmware-syslog/vmware-services-applmgmt.conf

Create the file if it does not exist.

Set the contents of the file as follows:

#applmgmt.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/applmgmt.log"
      Tag="applmgmt"
      Severity="info"
      Facility="local0")
#applmgmt-audit.log
input(type="imfile"
      File="/var/log/vmware/applmgmt-audit/applmgmt-audit.log"
      Tag="applmgmt-audit"
      Severity="info"
      Facility="local0")
#applmgmt-backup-restore-audit.log
input(type="imfile"
      File="/var/log/vmware/applmgmt-audit/applmgmt-br-audit.log"
      Tag="applmgmt-br-audit"
      Severity="info"
      Facility="local0")
#vami-access.log
input(type="imfile"
      File="/opt/vmware/var/log/lighttpd/access.log"
      Tag="vami-access"
      Severity="info"
      Facility="local0")
#vami-error.log
input(type="imfile"
      File="/opt/vmware/var/log/lighttpd/error.log"
      Tag="vami-error"
      Severity="info"
      Facility="local0")
#dcui.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/dcui.log"
      Tag="dcui"
      Severity="info"
      Facility="local0")
#detwist.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/detwist.log"
      Tag="detwist"
      Severity="info"
      Facility="local0")
#firewall-reload.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/firewall-reload.log"
      Tag="firewall-reload"
      Severity="info"
      Facility="local0")
#applmgmt_vmonsvc.std*
input(type="imfile"
      File="/var/log/vmware/applmgmt/applmgmt_vmonsvc.std*"
      Tag="applmgmt_vmonsvc"
      Severity="info"
      Facility="local0")
#backupSchedulerCron
input(type="imfile"
      File="/var/log/vmware/applmgmt/backupSchedulerCron.log"
      Tag="backupSchedulerCron"
      Severity="info"
      Facility="local0")
#progress.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/progress.log"
      Tag="progress"
      Severity="info"
      Facility="local0")
#statsmoitor-alarms
input(type="imfile"
      File="/var/log/vmware/statsmon/statsmoitor-alarms.log"
      Tag="statsmoitor-alarms"
      Severity="info"
      Facility="local0")
#StatsMonitor
input(type="imfile"
      File="/var/log/vmware/statsmon/StatsMonitor.log"
      Tag="StatsMonitor"
      Severity="info"
      Facility="local0")
#StatsMonitorStartup.log.std*
input(type="imfile"
      File="/var/log/vmware/statsmon/StatsMonitorStartup.log.std*"
      Tag="StatsMonitor-Startup"
      Severity="info"
      Facility="local0")
#PatchRunner
input(type="imfile"
      File="/var/log/vmware/applmgmt/PatchRunner.log"
      Tag="PatchRunner"
      Severity="info"
      Facility="local0")
#update_microservice
input(type="imfile"
      File="/var/log/vmware/applmgmt/update_microservice.log"
      Tag="update_microservice"
      Severity="info"
      Facility="local0")
#vami
input(type="imfile"
      File="/var/log/vmware/applmgmt/vami.log"
      Tag="vami"
      Severity="info"
      Facility="local0")
#vcdb_pre_patch
input(type="imfile"
      File="/var/log/vmware/applmgmt/vcdb_pre_patch.*"
      Tag="vcdb_pre_patch"
      Severity="info"
      Facility="local0")
#dnsmasq.log
input(type="imfile"
      File="/var/log/vmware/dnsmasq.log"
      Tag="dnsmasq"
      Severity="info"
      Facility="local0")
#procstate
input(type="imfile"
      File="/var/log/vmware/procstate"
      Tag="procstate"
      Severity="info"
      Facility="local0")
#backup.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/backup.log"
      Tag="applmgmt-backup"
      Severity="info"
      Facility="local0")
#size.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/size.log"
      Tag="applmgmt-size"
      Severity="info"
      Facility="local0")
#restore.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/restore.log"
      Tag="applmgmt-restore"
      Severity="info"
      Facility="local0")
#reconciliation.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/reconciliation.log"
      Tag="applmgmt-reconciliation"
      Severity="info"
      Facility="local0")
#pnid_change.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/pnid_change.log"
      Tag="applmgmt-pnid-change"
      Severity="info"
      Facility="local0")</fixtext><fix id="F-62791r935329_fix" /><check system="C-62882r935328_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>By default there is a vmware-services-applmgmt.conf rsyslog configuration file which includes the service logs when syslog is configured on vCenter that must be verified.

At the command prompt, run the following command:

# cat /etc/vmware-syslog/vmware-services-applmgmt.conf

Expected result:

#applmgmt.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/applmgmt.log"
      Tag="applmgmt"
      Severity="info"
      Facility="local0")
#applmgmt-audit.log
input(type="imfile"
      File="/var/log/vmware/applmgmt-audit/applmgmt-audit.log"
      Tag="applmgmt-audit"
      Severity="info"
      Facility="local0")
#applmgmt-backup-restore-audit.log
input(type="imfile"
      File="/var/log/vmware/applmgmt-audit/applmgmt-br-audit.log"
      Tag="applmgmt-br-audit"
      Severity="info"
      Facility="local0")
#vami-access.log
input(type="imfile"
      File="/opt/vmware/var/log/lighttpd/access.log"
      Tag="vami-access"
      Severity="info"
      Facility="local0")
#vami-error.log
input(type="imfile"
      File="/opt/vmware/var/log/lighttpd/error.log"
      Tag="vami-error"
      Severity="info"
      Facility="local0")
#dcui.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/dcui.log"
      Tag="dcui"
      Severity="info"
      Facility="local0")
#detwist.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/detwist.log"
      Tag="detwist"
      Severity="info"
      Facility="local0")
#firewall-reload.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/firewall-reload.log"
      Tag="firewall-reload"
      Severity="info"
      Facility="local0")
#applmgmt_vmonsvc.std*
input(type="imfile"
      File="/var/log/vmware/applmgmt/applmgmt_vmonsvc.std*"
      Tag="applmgmt_vmonsvc"
      Severity="info"
      Facility="local0")
#backupSchedulerCron
input(type="imfile"
      File="/var/log/vmware/applmgmt/backupSchedulerCron.log"
      Tag="backupSchedulerCron"
      Severity="info"
      Facility="local0")
#progress.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/progress.log"
      Tag="progress"
      Severity="info"
      Facility="local0")
#statsmoitor-alarms
input(type="imfile"
      File="/var/log/vmware/statsmon/statsmoitor-alarms.log"
      Tag="statsmoitor-alarms"
      Severity="info"
      Facility="local0")
#StatsMonitor
input(type="imfile"
      File="/var/log/vmware/statsmon/StatsMonitor.log"
      Tag="StatsMonitor"
      Severity="info"
      Facility="local0")
#StatsMonitorStartup.log.std*
input(type="imfile"
      File="/var/log/vmware/statsmon/StatsMonitorStartup.log.std*"
      Tag="StatsMonitor-Startup"
      Severity="info"
      Facility="local0")
#PatchRunner
input(type="imfile"
      File="/var/log/vmware/applmgmt/PatchRunner.log"
      Tag="PatchRunner"
      Severity="info"
      Facility="local0")
#update_microservice
input(type="imfile"
      File="/var/log/vmware/applmgmt/update_microservice.log"
      Tag="update_microservice"
      Severity="info"
      Facility="local0")
#vami
input(type="imfile"
      File="/var/log/vmware/applmgmt/vami.log"
      Tag="vami"
      Severity="info"
      Facility="local0")
#vcdb_pre_patch
input(type="imfile"
      File="/var/log/vmware/applmgmt/vcdb_pre_patch.*"
      Tag="vcdb_pre_patch"
      Severity="info"
      Facility="local0")
#dnsmasq.log
input(type="imfile"
      File="/var/log/vmware/dnsmasq.log"
      Tag="dnsmasq"
      Severity="info"
      Facility="local0")
#procstate
input(type="imfile"
      File="/var/log/vmware/procstate"
      Tag="procstate"
      Severity="info"
      Facility="local0")
#backup.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/backup.log"
      Tag="applmgmt-backup"
      Severity="info"
      Facility="local0")
#size.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/size.log"
      Tag="applmgmt-size"
      Severity="info"
      Facility="local0")
#restore.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/restore.log"
      Tag="applmgmt-restore"
      Severity="info"
      Facility="local0")
#reconciliation.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/reconciliation.log"
      Tag="applmgmt-reconciliation"
      Severity="info"
      Facility="local0")
#pnid_change.log
input(type="imfile"
      File="/var/log/vmware/applmgmt/pnid_change.log"
      Tag="applmgmt-pnid-change"
      Severity="info"
      Facility="local0")

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-259143"><title>SRG-APP-000141-WSR-000081</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259143r1003697_rule" weight="10.0" severity="medium"><version>VCLD-80-000031</version><title>The vCenter VAMI service must explicitly disable Multipurpose Internet Mail Extensions (MIME) mime mappings based on "Content-Type".</title><description>&lt;VulnDiscussion&gt;Controlling what a user of a hosted application can access is part of the security posture of the web server. Any time a user can access more functionality than is needed for the operation of the hosted application poses a security issue. A user with too much access can view information that is not needed for the user's job role, or the user could use the function in an unintentional manner.

A MIME tells the web server what type of program various file types and extensions are and what external utilities or programs are needed to execute the file type. A limited number of MIME types must be configured manually, and automatic mapping must be disabled.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62792r1003696_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf

Add or reconfigure the following value:

mimetype.use-xattr = "disable"

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62792r1003696_fix" /><check system="C-62883r1003695_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|grep "mimetype.use-xattr"

Example result:

mimetype.use-xattr="disable"

If "mimetype.use-xattr" is not set to "disable", this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259144"><title>SRG-APP-000141-WSR-000083</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259144r1003700_rule" weight="10.0" severity="medium"><version>VCLD-80-000033</version><title>The vCenter VAMI service must have resource mappings set to disable the serving of certain file types.</title><description>&lt;VulnDiscussion&gt;Resource mapping is the process of tying a particular file type to a process in the web server that can serve that type of file to a requesting client and to identify which file types are not to be delivered to a client.

By not specifying which files can and which files cannot be served to a user, VAMI could deliver sensitive files.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62793r1003699_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf

Add or reconfigure the following value:

url.access-deny = ( "~", ".inc" )

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62793r1003699_fix" /><check system="C-62884r1003698_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# grep "url.access-deny" /var/lib/vmware/cap-lighttpd/lighttpd.conf

Example result:

url.access-deny = ( "~", ".inc" )

If "url.access-deny" is not set to "( "~", ".inc" )", this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259145"><title>SRG-APP-000141-WSR-000085</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259145r1003703_rule" weight="10.0" severity="medium"><version>VCLD-80-000034</version><title>The vCenter VAMI service must have Web Distributed Authoring (WebDAV) disabled.</title><description>&lt;VulnDiscussion&gt;A web server can be installed with functionality that, by its nature, is not secure. WebDAV is an extension to the HTTP protocol that, when developed, was meant to allow users to create, change, and move documents on a server, typically a web server or web share. Allowing this functionality, development, and deployment is much easier for web authors.

WebDAV is not widely used and has serious security concerns because it may allow clients to modify unauthorized files on the web server.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62794r1003702_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf

Delete or comment out the "mod_webdav" line.

Note: The line may be in an included config and not in the parent config itself.

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62794r1003702_fix" /><check system="C-62885r1003701_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|awk '/server\.modules/,/\)/'|grep mod_webdav

If any value is returned, this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259146"><title>SRG-APP-000141-WSR-000086</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259146r1003706_rule" weight="10.0" severity="medium"><version>VCLD-80-000035</version><title>The vCenter VAMI service must protect system resources and privileged operations from hosted applications.</title><description>&lt;VulnDiscussion&gt;Most of the attention to denial-of-service (DoS) attacks focuses on ensuring that systems and applications are not victims of these attacks. However, these systems and applications must also be secured against use to launch such an attack against others.

A variety of technologies exist to limit or, in some cases, eliminate the effects of DoS attacks. Limiting system resources that are allocated to any user to a bare minimum may also reduce the ability of users to launch some DoS attacks.

One DoS mitigation is to prevent VAMI from keeping idle connections open for too long.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62795r1003705_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf file.

Add or reconfigure the following value:

server.max-keep-alive-idle = 30

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62795r1003705_fix" /><check system="C-62886r1003704_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|grep "server.max-keep-alive-idle"

Example result:

server.max-keep-alive-idle=30

If "server.max-keep-alive-idle" is not set to 30, this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259147"><title>SRG-APP-000176-WSR-000096</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259147r961041_rule" weight="10.0" severity="medium"><version>VCLD-80-000040</version><title>The vCenter VAMI service must restrict access to the web server's private key.</title><description>&lt;VulnDiscussion&gt;The web server's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients. By gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the Secure Sockets Layer (SSL) traffic between a client and the web server.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000186</ident><fixtext fixref="F-62796r935344_fix">At the command prompt, run the following commands:

# chown root:root /etc/applmgmt/appliance/server.pem
# chmod 600 /etc/applmgmt/appliance/server.pem</fixtext><fix id="F-62796r935344_fix" /><check system="C-62887r935343_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# stat -c "%n has %a permissions and is owned by %U:%G" /etc/applmgmt/appliance/server.pem

Expected result:

/etc/applmgmt/appliance/server.pem has 600 permissions and is owned by root:root

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-259149"><title>SRG-APP-000246-WSR-000149</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259149r1003709_rule" weight="10.0" severity="medium"><version>VCLD-80-000060</version><title>The vCenter VAMI service must restrict the ability of users to launch denial-of-service (DoS) attacks against other information systems or networks.</title><description>&lt;VulnDiscussion&gt;In UNIX and related computer operating systems, a file descriptor is an indicator used to access a file or other input/output resource, such as a pipe or network connection. File descriptors index into a per-process file descriptor table maintained by the kernel, which in turn indexes into a systemwide table of files opened by all processes, called the file table.

As a single-threaded server, Lighttpd must be limited in the number of file descriptors that can be allocated. This will prevent Lighttpd from being used in a form of DoS attack against the operating system.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001094</ident><fixtext fixref="F-62798r1003708_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf

Add or reconfigure the following value:

server.max-fds = 2048

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62798r1003708_fix" /><check system="C-62889r1003707_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|grep "server.max-fds"

Example result:

server.max-fds=2048

If "server.max-fds" is not set to 2048 or less, this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259150"><title>SRG-APP-000251-WSR-000157</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259150r1003712_rule" weight="10.0" severity="medium"><version>VCLD-80-000061</version><title>The vCenter VAMI service must set the encoding for all text mime types to UTF-8.</title><description>&lt;VulnDiscussion&gt;Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.

An attacker can also enter Unicode into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001310</ident><fixtext fixref="F-62799r1003711_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf

Navigate to the "mimetype.assign" block.

Replace all the mappings whose assigned type is "text/*" with mappings for UTF-8 encoding. For example:

  ".log"          =&gt;      "text/plain; charset=utf-8",
  ".conf"         =&gt;      "text/plain; charset=utf-8",
  ".text"         =&gt;      "text/plain; charset=utf-8",
  ".txt"          =&gt;      "text/plain; charset=utf-8",
  ".spec"         =&gt;      "text/plain; charset=utf-8",
  ".dtd"          =&gt;      "text/xml; charset=utf-8",
  ".xml"          =&gt;      "text/xml; charset=utf-8",

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62799r1003711_fix" /><check system="C-62890r1003710_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|awk '/mimetype\.assign/,/\)/'|grep "text/"|grep -v "charset=utf-8"

If the command returns any value, this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259151"><title>SRG-APP-000266-WSR-000142</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259151r1003715_rule" weight="10.0" severity="medium"><version>VCLD-80-000062</version><title>The vCenter VAMI service must disable directory listing.</title><description>&lt;VulnDiscussion&gt;The goal is to completely control the web user's experience in navigating any portion of the web document root directories. Ensuring all web content directories have at least the equivalent of an "index.html" file is a significant factor to accomplish this end.

Enumeration techniques, such as Uniform Resource Locator (URL) parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. By having a default hosted application web page, the anonymous web user will not obtain directory browsing information or an error message that reveals the server type and version.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001312</ident><fixtext fixref="F-62800r1003714_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf

Add or reconfigure the following value:

dir-listing.activate = "disable"

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62800r1003714_fix" /><check system="C-62891r1003713_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|grep "dir-listing.activate"

Example result:

dir-listing.activate = "disable"

If "dir-listing.activate" is not set to "disable", this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259152"><title>SRG-APP-000266-WSR-000159</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259152r1003718_rule" weight="10.0" severity="medium"><version>VCLD-80-000063</version><title>The vCenter VAMI service must not be configured to use the "mod_status" module.</title><description>&lt;VulnDiscussion&gt;Any application providing too much information in error logs and in administrative messages to the screen risks compromising the data and security of the application and system.

VAMI must only generate error messages that provide information necessary for corrective actions without revealing sensitive or potentially harmful information in error logs and administrative messages. The "mod_status" module generates the status overview of the webserver.

The information covers the following:

- Uptime.
- Average throughput.
- Current throughput.
- Active connections and their state.

While this information is useful on a development system, production systems must not have "mod_status" enabled.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001312</ident><fixtext fixref="F-62801r1003717_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf.

Remove the line containing "mod_status".

Note: The line may be in an included config and not in the parent config.

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62801r1003717_fix" /><check system="C-62892r1003716_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|awk '/server\.modules/,/\)/'|grep mod_status

If any value is returned, this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259153"><title>SRG-APP-000266-WSR-000160</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259153r1003721_rule" weight="10.0" severity="medium"><version>VCLD-80-000064</version><title>The vCenter VAMI service must have debug logging disabled.</title><description>&lt;VulnDiscussion&gt;Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage may be displayed.

Because this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001312</ident><fixtext fixref="F-62802r1003720_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf

Add or reconfigure the following value:

debug.log-request-handling = "disable"

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62802r1003720_fix" /><check system="C-62893r1003719_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:    

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|grep "debug.log-request-handling"

Expected result:

debug.log-request-handling = "disable"

If "debug.log-request-handling" is not set to "disable", this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259155"><title>SRG-APP-000516-WSR-000174</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259155r1003724_rule" weight="10.0" severity="medium"><version>VCLD-80-000097</version><title>The vCenter VAMI service must disable client initiated TLS renegotiation.</title><description>&lt;VulnDiscussion&gt;All versions of the Secure Sockets Layer (SSL) and TLS protocols (up to and including TLS 1.2) are vulnerable to a man-in-the-middle attack (CVE-2009-3555) during a renegotiation. This vulnerability allows an attacker to "prefix" a chosen plaintext to the HTTP request as seen by the web server. The protocols have since been amended by RFC 5746, but the fix must be supported by both client and server to be effective.

While Lighttpd and the underlying OpenSSL libraries are no longer vulnerable, steps must be taken to account for older clients that do not support RFC 5746. To this end, Lighttpd disables client-initiated renegotiation entirely by default. This configuration must be validated and maintained.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-62804r1003723_fix">Navigate to and open:

/var/lib/vmware/cap-lighttpd/lighttpd.conf

Remove any setting for "ssl.disable-client-renegotiation".

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62804r1003723_fix" /><check system="C-62895r1003722_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|grep "ssl\.disable-client-renegotiation"

If no line is returned, this is not a finding.

If "ssl.disable-client-renegotiation" is set to "disabled", this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259156"><title>SRG-APP-000516-WSR-000174</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259156r1003727_rule" weight="10.0" severity="medium"><version>VCLD-80-000098</version><title>The vCenter VAMI service must be configured to hide the server type and version in client responses.</title><description>&lt;VulnDiscussion&gt;Web servers will often display error messages to client users, displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage.

This information could be used by an attacker to blueprint what type of attacks might be successful. Therefore, VAMI must be configured to hide the server version at all times.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-62805r1003726_fix">Navigate to and open:

/opt/vmware/etc/lighttpd/applmgmt-lighttpd.conf

Add or reconfigure the following value:

server.tag = "vami"

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62805r1003726_fix" /><check system="C-62896r1003725_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|grep "server.tag"

Expected result:

server.tag = "vami"

If "server.tag" is not set to "vami", this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259157"><title>SRG-APP-000516-WSR-000174</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259157r1003730_rule" weight="10.0" severity="medium"><version>VCLD-80-000099</version><title>The vCenter VAMI service must implement HTTP Strict Transport Security (HSTS).</title><description>&lt;VulnDiscussion&gt;HSTS instructs web browsers to only use secure connections for all future requests when communicating with a website. Doing so helps prevent SSL protocol attacks, SSL stripping, cookie hijacking, and other attempts to circumvent SSL protection.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-62806r1003729_fix">Navigate to and open:

/opt/vmware/etc/lighttpd/applmgmt-lighttpd.conf

If header "Strict-Transport-Security" is not present, add the following line to the end of the file:

setenv.add-response-header += ("Strict-Transport-Security" =&gt; "max-age=31536000; includeSubDomains; preload")

If header "Strict-Transport-Security" is present and not set to "Deny", update the value as shown below:

"Strict-Transport-Security" =&gt; "max-age=31536000; includeSubDomains; preload",

Note: The last line in the parameter does not need a trailing comma if part of a multi-line configuration.

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62806r1003729_fix" /><check system="C-62897r1003728_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|awk '/setenv\.add-response-header/,/\)/'|sed -e 's/^[ ]*//'|grep "Strict-Transport-Security"

Example result:

"Strict-Transport-Security" =&gt; "max-age=31536000; includeSubDomains; preload"

If the response header "Strict-Transport-Security" is missing or not configured to "max-age=31536000; includeSubDomains; preload", this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259158"><title>SRG-APP-000516-WSR-000174</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259158r1003733_rule" weight="10.0" severity="medium"><version>VCLD-80-000100</version><title>The vCenter VAMI service must implement prevent rendering inside a frame or iframe on another site.</title><description>&lt;VulnDiscussion&gt;Clickjacking, also known as a “UI redress attack”, is when an attacker uses multiple transparent or opaque layers to trick a user into clicking on a button or link on another page when they were intending to click on the top level page. Thus, the attacker is “hijacking” clicks meant for their page and routing them to another page, most likely owned by another application, domain, or both.

Using a similar technique, keystrokes can also be hijacked. With a carefully crafted combination of stylesheets, iframes, and text boxes, a user can be led to believe they are typing in the password to their email or bank account but are instead typing into an invisible frame controlled by the attacker.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-62807r1003732_fix">Navigate to and open:

/opt/vmware/etc/lighttpd/applmgmt-lighttpd.conf

If header "X-Frame-Options" is not present, add the following line to the end of the file:

setenv.add-response-header += ("X-Frame-Options" =&gt; "Deny")

If header "X-Frame-Options" is present and not set to "Deny", update the value as shown below:

"X-Frame-Options" =&gt; "Deny",

Note: The last line in the parameter does not need a trailing comma if part of a multi-line configuration.

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62807r1003732_fix" /><check system="C-62898r1003731_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|awk '/setenv\.add-response-header/,/\)/'|sed -e 's/^[ ]*//'|grep "X-Frame-Options"

Example result:

"X-Frame-Options" =&gt; "Deny",

If the response header "X-Frame-Options" is missing or not configured to "Deny", this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259159"><title>SRG-APP-000516-WSR-000174</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259159r1003736_rule" weight="10.0" severity="medium"><version>VCLD-80-000101</version><title>The vCenter VAMI service must protect against MIME sniffing.</title><description>&lt;VulnDiscussion&gt;MIME sniffing was, and still is, a technique used by some web browsers to examine the content of a particular asset. This is done for the purpose of determining an asset's file format. This technique is useful in the event that there is not enough metadata information present for a particular asset, thus leaving the possibility that the browser interprets the asset incorrectly.

Although MIME sniffing can be useful to determine an asset's correct file format, it can also cause a security vulnerability. This vulnerability can be quite dangerous both for site owners as well as site visitors. This is because an attacker can leverage MIME sniffing to send an XSS (Cross Site Scripting) attack.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-62808r1003735_fix">Navigate to and open:

/opt/vmware/etc/lighttpd/applmgmt-lighttpd.conf

If header "X-Content-Type-Options" is not present, add the following line to the end of the file:

setenv.add-response-header += ("X-Content-Type-Options" =&gt; "nosniff")

If header "X-Content-Type-Options" is present and not set to "nosniff", update the value as shown below:

"X-Content-Type-Options" =&gt; "nosniff",

Note: The last line in the parameter does not need a trailing comma if part of a multi-line configuration.

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62808r1003735_fix" /><check system="C-62899r1003734_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|awk '/setenv\.add-response-header/,/\)/'|sed -e 's/^[ ]*//'|grep "X-Content-Type-Options"

Example result:

"X-Content-Type-Options" =&gt; "nosniff",

If the response header "X-Content-Type-Options" is missing or not configured to "nosniff", this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group><Group id="V-259160"><title>SRG-APP-000516-WSR-000174</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259160r1003739_rule" weight="10.0" severity="medium"><version>VCLD-80-000102</version><title>The vCenter VAMI service must enable Content Security Policy.</title><description>&lt;VulnDiscussion&gt;A Content Security Policy (CSP) requires careful tuning and precise definition of the policy. If enabled, CSP has significant impact on the way browsers render pages (e.g., inline JavaScript is disabled by default and must be explicitly allowed in the policy). CSP prevents a wide range of attacks, including cross-site scripting and other cross-site injections.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA VAMI</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA VAMI</dc:subject><dc:identifier>5571</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-62809r1003738_fix">Navigate to and open:

/opt/vmware/etc/lighttpd/applmgmt-lighttpd.conf

If header "Content-Security-Policy" is not present, add the following line to the end of the file:

setenv.add-response-header += ("Content-Security-Policy" =&gt; "default-src 'self'; img-src 'self' data: https://vcsa.vmware.com; font-src 'self' data:; object-src 'none'; style-src 'self' 'unsafe-inline'")

If header "Content-Security-Policy" is present and not set to "default-src 'self'; img-src 'self' data: https://vcsa.vmware.com; font-src 'self' data:; object-src 'none'; style-src 'self' 'unsafe-inline'", update the value as shown below:

"Content-Security-Policy" =&gt; "default-src 'self'; img-src 'self' data: https://vcsa.vmware.com; font-src 'self' data:; object-src 'none'; style-src 'self' 'unsafe-inline'",

Note: The last line in the parameter does not need a trailing comma if part of a multi-line configuration.

Restart the service with the following command:

# systemctl restart cap-lighttpd</fixtext><fix id="F-62809r1003738_fix" /><check system="C-62900r1003737_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_VAMI_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# /opt/vmware/cap_lighttpd/sbin/lighttpd -p -f /var/lib/vmware/cap-lighttpd/lighttpd.conf 2&gt;/dev/null|awk '/setenv\.add-response-header/,/\)/'|sed -e 's/^[ ]*//'|grep "Content-Security-Policy"

Example result:

"Content-Security-Policy" =&gt; "default-src 'self'; img-src 'self' data: https://vcsa.vmware.com; font-src 'self' data:; object-src 'none'; style-src 'self' 'unsafe-inline'"

If the response header "Content-Security-Policy" is missing or not configured to "default-src 'self'; img-src 'self' data: https://vcsa.vmware.com; font-src 'self' data:; object-src 'none'; style-src 'self' 'unsafe-inline'", this is a finding.

Note: The command must be run from a bash shell and not from a shell generated by the "appliance shell". Use the "chsh" command to change the shell for the account to "/bin/bash". Refer to KB Article 2100508 for more details:

https://kb.vmware.com/s/article/2100508</check-content></check></Rule></Group></Benchmark>