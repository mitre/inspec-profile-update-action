<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:dc="http://purl.org/dc/elements/1.1/" id="vRealize_Ops_Mgr_Cassandra_STIG" xml:lang="en" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2017-06-06">accepted</status><title>vRealize - Cassandra Security Technical Implementation Guide</title><description>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DoD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.</description><notice id="terms-of-use" xml:lang="en"></notice><reference href="http://iase.disa.mil"><dc:publisher>DISA</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 1 Benchmark Date: 05 Jun 2017</plain-text><version>1</version><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-72617" selected="true" /><select idref="V-72619" selected="true" /><select idref="V-72621" selected="true" /><select idref="V-72623" selected="true" /><select idref="V-72625" selected="true" /><select idref="V-72627" selected="true" /><select idref="V-72629" selected="true" /><select idref="V-72631" selected="true" /><select idref="V-72633" selected="true" /><select idref="V-72635" selected="true" /><select idref="V-72637" selected="true" /><select idref="V-72639" selected="true" /><select idref="V-72641" selected="true" /><select idref="V-72643" selected="true" /><select idref="V-72645" selected="true" /><select idref="V-72647" selected="true" /><select idref="V-72649" selected="true" /><select idref="V-72651" selected="true" /><select idref="V-72653" selected="true" /><select idref="V-72655" selected="true" /><select idref="V-72657" selected="true" /><select idref="V-72659" selected="true" /><select idref="V-72661" selected="true" /><select idref="V-72663" selected="true" /><select idref="V-72665" selected="true" /><select idref="V-72667" selected="true" /><select idref="V-72669" selected="true" /><select idref="V-72671" selected="true" /><select idref="V-72673" selected="true" /><select idref="V-72675" selected="true" /><select idref="V-72677" selected="true" /><select idref="V-72679" selected="true" /><select idref="V-72681" selected="true" /><select idref="V-72687" selected="true" /><select idref="V-72689" selected="true" /><select idref="V-72691" selected="true" /><select idref="V-72693" selected="true" /><select idref="V-72695" selected="true" /><select idref="V-72697" selected="true" /><select idref="V-72699" selected="true" /><select idref="V-72701" selected="true" /><select idref="V-72703" selected="true" /><select idref="V-72705" selected="true" /><select idref="V-72707" selected="true" /><select idref="V-72709" selected="true" /><select idref="V-72711" selected="true" /><select idref="V-72713" selected="true" /><select idref="V-72715" selected="true" /><select idref="V-72717" selected="true" /><select idref="V-72719" selected="true" /><select idref="V-72721" selected="true" /><select idref="V-72723" selected="true" /><select idref="V-72725" selected="true" /><select idref="V-72733" selected="true" /><select idref="V-72735" selected="true" /><select idref="V-72751" selected="true" /></Profile><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-72617" selected="true" /><select idref="V-72619" selected="true" /><select idref="V-72621" selected="true" /><select idref="V-72623" selected="true" /><select idref="V-72625" selected="true" /><select idref="V-72627" selected="true" /><select idref="V-72629" selected="true" /><select idref="V-72631" selected="true" /><select idref="V-72633" selected="true" /><select idref="V-72635" selected="true" /><select idref="V-72637" selected="true" /><select idref="V-72639" selected="true" /><select idref="V-72641" selected="true" /><select idref="V-72643" selected="true" /><select idref="V-72645" selected="true" /><select idref="V-72647" selected="true" /><select idref="V-72649" selected="true" /><select idref="V-72651" selected="true" /><select idref="V-72653" selected="true" /><select idref="V-72655" selected="true" /><select idref="V-72657" selected="true" /><select idref="V-72659" selected="true" /><select idref="V-72661" selected="true" /><select idref="V-72663" selected="true" /><select idref="V-72665" selected="true" /><select idref="V-72667" selected="true" /><select idref="V-72669" selected="true" /><select idref="V-72671" selected="true" /><select idref="V-72673" selected="true" /><select idref="V-72675" selected="true" /><select idref="V-72677" selected="true" /><select idref="V-72679" selected="true" /><select idref="V-72681" selected="true" /><select idref="V-72687" selected="true" /><select idref="V-72689" selected="true" /><select idref="V-72691" selected="true" /><select idref="V-72693" selected="true" /><select idref="V-72695" selected="true" /><select idref="V-72697" selected="true" /><select idref="V-72699" selected="true" /><select idref="V-72701" selected="true" /><select idref="V-72703" selected="true" /><select idref="V-72705" selected="true" /><select idref="V-72707" selected="true" /><select idref="V-72709" selected="true" /><select idref="V-72711" selected="true" /><select idref="V-72713" selected="true" /><select idref="V-72715" selected="true" /><select idref="V-72717" selected="true" /><select idref="V-72719" selected="true" /><select idref="V-72721" selected="true" /><select idref="V-72723" selected="true" /><select idref="V-72725" selected="true" /><select idref="V-72733" selected="true" /><select idref="V-72735" selected="true" /><select idref="V-72751" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-72617" selected="true" /><select idref="V-72619" selected="true" /><select idref="V-72621" selected="true" /><select idref="V-72623" selected="true" /><select idref="V-72625" selected="true" /><select idref="V-72627" selected="true" /><select idref="V-72629" selected="true" /><select idref="V-72631" selected="true" /><select idref="V-72633" selected="true" /><select idref="V-72635" selected="true" /><select idref="V-72637" selected="true" /><select idref="V-72639" selected="true" /><select idref="V-72641" selected="true" /><select idref="V-72643" selected="true" /><select idref="V-72645" selected="true" /><select idref="V-72647" selected="true" /><select idref="V-72649" selected="true" /><select idref="V-72651" selected="true" /><select idref="V-72653" selected="true" /><select idref="V-72655" selected="true" /><select idref="V-72657" selected="true" /><select idref="V-72659" selected="true" /><select idref="V-72661" selected="true" /><select idref="V-72663" selected="true" /><select idref="V-72665" selected="true" /><select idref="V-72667" selected="true" /><select idref="V-72669" selected="true" /><select idref="V-72671" selected="true" /><select idref="V-72673" selected="true" /><select idref="V-72675" selected="true" /><select idref="V-72677" selected="true" /><select idref="V-72679" selected="true" /><select idref="V-72681" selected="true" /><select idref="V-72687" selected="true" /><select idref="V-72689" selected="true" /><select idref="V-72691" selected="true" /><select idref="V-72693" selected="true" /><select idref="V-72695" selected="true" /><select idref="V-72697" selected="true" /><select idref="V-72699" selected="true" /><select idref="V-72701" selected="true" /><select idref="V-72703" selected="true" /><select idref="V-72705" selected="true" /><select idref="V-72707" selected="true" /><select idref="V-72709" selected="true" /><select idref="V-72711" selected="true" /><select idref="V-72713" selected="true" /><select idref="V-72715" selected="true" /><select idref="V-72717" selected="true" /><select idref="V-72719" selected="true" /><select idref="V-72721" selected="true" /><select idref="V-72723" selected="true" /><select idref="V-72725" selected="true" /><select idref="V-72733" selected="true" /><select idref="V-72735" selected="true" /><select idref="V-72751" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-72617" selected="true" /><select idref="V-72619" selected="true" /><select idref="V-72621" selected="true" /><select idref="V-72623" selected="true" /><select idref="V-72625" selected="true" /><select idref="V-72627" selected="true" /><select idref="V-72629" selected="true" /><select idref="V-72631" selected="true" /><select idref="V-72633" selected="true" /><select idref="V-72635" selected="true" /><select idref="V-72637" selected="true" /><select idref="V-72639" selected="true" /><select idref="V-72641" selected="true" /><select idref="V-72643" selected="true" /><select idref="V-72645" selected="true" /><select idref="V-72647" selected="true" /><select idref="V-72649" selected="true" /><select idref="V-72651" selected="true" /><select idref="V-72653" selected="true" /><select idref="V-72655" selected="true" /><select idref="V-72657" selected="true" /><select idref="V-72659" selected="true" /><select idref="V-72661" selected="true" /><select idref="V-72663" selected="true" /><select idref="V-72665" selected="true" /><select idref="V-72667" selected="true" /><select idref="V-72669" selected="true" /><select idref="V-72671" selected="true" /><select idref="V-72673" selected="true" /><select idref="V-72675" selected="true" /><select idref="V-72677" selected="true" /><select idref="V-72679" selected="true" /><select idref="V-72681" selected="true" /><select idref="V-72687" selected="true" /><select idref="V-72689" selected="true" /><select idref="V-72691" selected="true" /><select idref="V-72693" selected="true" /><select idref="V-72695" selected="true" /><select idref="V-72697" selected="true" /><select idref="V-72699" selected="true" /><select idref="V-72701" selected="true" /><select idref="V-72703" selected="true" /><select idref="V-72705" selected="true" /><select idref="V-72707" selected="true" /><select idref="V-72709" selected="true" /><select idref="V-72711" selected="true" /><select idref="V-72713" selected="true" /><select idref="V-72715" selected="true" /><select idref="V-72717" selected="true" /><select idref="V-72719" selected="true" /><select idref="V-72721" selected="true" /><select idref="V-72723" selected="true" /><select idref="V-72725" selected="true" /><select idref="V-72733" selected="true" /><select idref="V-72735" selected="true" /><select idref="V-72751" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-72617" selected="true" /><select idref="V-72619" selected="true" /><select idref="V-72621" selected="true" /><select idref="V-72623" selected="true" /><select idref="V-72625" selected="true" /><select idref="V-72627" selected="true" /><select idref="V-72629" selected="true" /><select idref="V-72631" selected="true" /><select idref="V-72633" selected="true" /><select idref="V-72635" selected="true" /><select idref="V-72637" selected="true" /><select idref="V-72639" selected="true" /><select idref="V-72641" selected="true" /><select idref="V-72643" selected="true" /><select idref="V-72645" selected="true" /><select idref="V-72647" selected="true" /><select idref="V-72649" selected="true" /><select idref="V-72651" selected="true" /><select idref="V-72653" selected="true" /><select idref="V-72655" selected="true" /><select idref="V-72657" selected="true" /><select idref="V-72659" selected="true" /><select idref="V-72661" selected="true" /><select idref="V-72663" selected="true" /><select idref="V-72665" selected="true" /><select idref="V-72667" selected="true" /><select idref="V-72669" selected="true" /><select idref="V-72671" selected="true" /><select idref="V-72673" selected="true" /><select idref="V-72675" selected="true" /><select idref="V-72677" selected="true" /><select idref="V-72679" selected="true" /><select idref="V-72681" selected="true" /><select idref="V-72687" selected="true" /><select idref="V-72689" selected="true" /><select idref="V-72691" selected="true" /><select idref="V-72693" selected="true" /><select idref="V-72695" selected="true" /><select idref="V-72697" selected="true" /><select idref="V-72699" selected="true" /><select idref="V-72701" selected="true" /><select idref="V-72703" selected="true" /><select idref="V-72705" selected="true" /><select idref="V-72707" selected="true" /><select idref="V-72709" selected="true" /><select idref="V-72711" selected="true" /><select idref="V-72713" selected="true" /><select idref="V-72715" selected="true" /><select idref="V-72717" selected="true" /><select idref="V-72719" selected="true" /><select idref="V-72721" selected="true" /><select idref="V-72723" selected="true" /><select idref="V-72725" selected="true" /><select idref="V-72733" selected="true" /><select idref="V-72735" selected="true" /><select idref="V-72751" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-72617" selected="true" /><select idref="V-72619" selected="true" /><select idref="V-72621" selected="true" /><select idref="V-72623" selected="true" /><select idref="V-72625" selected="true" /><select idref="V-72627" selected="true" /><select idref="V-72629" selected="true" /><select idref="V-72631" selected="true" /><select idref="V-72633" selected="true" /><select idref="V-72635" selected="true" /><select idref="V-72637" selected="true" /><select idref="V-72639" selected="true" /><select idref="V-72641" selected="true" /><select idref="V-72643" selected="true" /><select idref="V-72645" selected="true" /><select idref="V-72647" selected="true" /><select idref="V-72649" selected="true" /><select idref="V-72651" selected="true" /><select idref="V-72653" selected="true" /><select idref="V-72655" selected="true" /><select idref="V-72657" selected="true" /><select idref="V-72659" selected="true" /><select idref="V-72661" selected="true" /><select idref="V-72663" selected="true" /><select idref="V-72665" selected="true" /><select idref="V-72667" selected="true" /><select idref="V-72669" selected="true" /><select idref="V-72671" selected="true" /><select idref="V-72673" selected="true" /><select idref="V-72675" selected="true" /><select idref="V-72677" selected="true" /><select idref="V-72679" selected="true" /><select idref="V-72681" selected="true" /><select idref="V-72687" selected="true" /><select idref="V-72689" selected="true" /><select idref="V-72691" selected="true" /><select idref="V-72693" selected="true" /><select idref="V-72695" selected="true" /><select idref="V-72697" selected="true" /><select idref="V-72699" selected="true" /><select idref="V-72701" selected="true" /><select idref="V-72703" selected="true" /><select idref="V-72705" selected="true" /><select idref="V-72707" selected="true" /><select idref="V-72709" selected="true" /><select idref="V-72711" selected="true" /><select idref="V-72713" selected="true" /><select idref="V-72715" selected="true" /><select idref="V-72717" selected="true" /><select idref="V-72719" selected="true" /><select idref="V-72721" selected="true" /><select idref="V-72723" selected="true" /><select idref="V-72725" selected="true" /><select idref="V-72733" selected="true" /><select idref="V-72735" selected="true" /><select idref="V-72751" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-72617" selected="true" /><select idref="V-72619" selected="true" /><select idref="V-72621" selected="true" /><select idref="V-72623" selected="true" /><select idref="V-72625" selected="true" /><select idref="V-72627" selected="true" /><select idref="V-72629" selected="true" /><select idref="V-72631" selected="true" /><select idref="V-72633" selected="true" /><select idref="V-72635" selected="true" /><select idref="V-72637" selected="true" /><select idref="V-72639" selected="true" /><select idref="V-72641" selected="true" /><select idref="V-72643" selected="true" /><select idref="V-72645" selected="true" /><select idref="V-72647" selected="true" /><select idref="V-72649" selected="true" /><select idref="V-72651" selected="true" /><select idref="V-72653" selected="true" /><select idref="V-72655" selected="true" /><select idref="V-72657" selected="true" /><select idref="V-72659" selected="true" /><select idref="V-72661" selected="true" /><select idref="V-72663" selected="true" /><select idref="V-72665" selected="true" /><select idref="V-72667" selected="true" /><select idref="V-72669" selected="true" /><select idref="V-72671" selected="true" /><select idref="V-72673" selected="true" /><select idref="V-72675" selected="true" /><select idref="V-72677" selected="true" /><select idref="V-72679" selected="true" /><select idref="V-72681" selected="true" /><select idref="V-72687" selected="true" /><select idref="V-72689" selected="true" /><select idref="V-72691" selected="true" /><select idref="V-72693" selected="true" /><select idref="V-72695" selected="true" /><select idref="V-72697" selected="true" /><select idref="V-72699" selected="true" /><select idref="V-72701" selected="true" /><select idref="V-72703" selected="true" /><select idref="V-72705" selected="true" /><select idref="V-72707" selected="true" /><select idref="V-72709" selected="true" /><select idref="V-72711" selected="true" /><select idref="V-72713" selected="true" /><select idref="V-72715" selected="true" /><select idref="V-72717" selected="true" /><select idref="V-72719" selected="true" /><select idref="V-72721" selected="true" /><select idref="V-72723" selected="true" /><select idref="V-72725" selected="true" /><select idref="V-72733" selected="true" /><select idref="V-72735" selected="true" /><select idref="V-72751" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-72617" selected="true" /><select idref="V-72619" selected="true" /><select idref="V-72621" selected="true" /><select idref="V-72623" selected="true" /><select idref="V-72625" selected="true" /><select idref="V-72627" selected="true" /><select idref="V-72629" selected="true" /><select idref="V-72631" selected="true" /><select idref="V-72633" selected="true" /><select idref="V-72635" selected="true" /><select idref="V-72637" selected="true" /><select idref="V-72639" selected="true" /><select idref="V-72641" selected="true" /><select idref="V-72643" selected="true" /><select idref="V-72645" selected="true" /><select idref="V-72647" selected="true" /><select idref="V-72649" selected="true" /><select idref="V-72651" selected="true" /><select idref="V-72653" selected="true" /><select idref="V-72655" selected="true" /><select idref="V-72657" selected="true" /><select idref="V-72659" selected="true" /><select idref="V-72661" selected="true" /><select idref="V-72663" selected="true" /><select idref="V-72665" selected="true" /><select idref="V-72667" selected="true" /><select idref="V-72669" selected="true" /><select idref="V-72671" selected="true" /><select idref="V-72673" selected="true" /><select idref="V-72675" selected="true" /><select idref="V-72677" selected="true" /><select idref="V-72679" selected="true" /><select idref="V-72681" selected="true" /><select idref="V-72687" selected="true" /><select idref="V-72689" selected="true" /><select idref="V-72691" selected="true" /><select idref="V-72693" selected="true" /><select idref="V-72695" selected="true" /><select idref="V-72697" selected="true" /><select idref="V-72699" selected="true" /><select idref="V-72701" selected="true" /><select idref="V-72703" selected="true" /><select idref="V-72705" selected="true" /><select idref="V-72707" selected="true" /><select idref="V-72709" selected="true" /><select idref="V-72711" selected="true" /><select idref="V-72713" selected="true" /><select idref="V-72715" selected="true" /><select idref="V-72717" selected="true" /><select idref="V-72719" selected="true" /><select idref="V-72721" selected="true" /><select idref="V-72723" selected="true" /><select idref="V-72725" selected="true" /><select idref="V-72733" selected="true" /><select idref="V-72735" selected="true" /><select idref="V-72751" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-72617" selected="true" /><select idref="V-72619" selected="true" /><select idref="V-72621" selected="true" /><select idref="V-72623" selected="true" /><select idref="V-72625" selected="true" /><select idref="V-72627" selected="true" /><select idref="V-72629" selected="true" /><select idref="V-72631" selected="true" /><select idref="V-72633" selected="true" /><select idref="V-72635" selected="true" /><select idref="V-72637" selected="true" /><select idref="V-72639" selected="true" /><select idref="V-72641" selected="true" /><select idref="V-72643" selected="true" /><select idref="V-72645" selected="true" /><select idref="V-72647" selected="true" /><select idref="V-72649" selected="true" /><select idref="V-72651" selected="true" /><select idref="V-72653" selected="true" /><select idref="V-72655" selected="true" /><select idref="V-72657" selected="true" /><select idref="V-72659" selected="true" /><select idref="V-72661" selected="true" /><select idref="V-72663" selected="true" /><select idref="V-72665" selected="true" /><select idref="V-72667" selected="true" /><select idref="V-72669" selected="true" /><select idref="V-72671" selected="true" /><select idref="V-72673" selected="true" /><select idref="V-72675" selected="true" /><select idref="V-72677" selected="true" /><select idref="V-72679" selected="true" /><select idref="V-72681" selected="true" /><select idref="V-72687" selected="true" /><select idref="V-72689" selected="true" /><select idref="V-72691" selected="true" /><select idref="V-72693" selected="true" /><select idref="V-72695" selected="true" /><select idref="V-72697" selected="true" /><select idref="V-72699" selected="true" /><select idref="V-72701" selected="true" /><select idref="V-72703" selected="true" /><select idref="V-72705" selected="true" /><select idref="V-72707" selected="true" /><select idref="V-72709" selected="true" /><select idref="V-72711" selected="true" /><select idref="V-72713" selected="true" /><select idref="V-72715" selected="true" /><select idref="V-72717" selected="true" /><select idref="V-72719" selected="true" /><select idref="V-72721" selected="true" /><select idref="V-72723" selected="true" /><select idref="V-72725" selected="true" /><select idref="V-72733" selected="true" /><select idref="V-72735" selected="true" /><select idref="V-72751" selected="true" /></Profile><Group id="V-72617"><title>SRG-APP-000099-DB-000043</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87249r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000050</version><title>The Cassandra database must produce audit records containing sufficient information to establish the outcome (success or failure) of the events.</title><description>&lt;VulnDiscussion&gt;Information system auditing capability is critical for accurate forensic analysis. Without information about the outcome of events, security personnel cannot make an accurate assessment as to whether an attack was successful or if changes were made to the security state of the system.

Event outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the information system after the event occurred). As such, they also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000134</ident><fixtext fixref="F-79019r1_fix">Configure the Cassandra Server to produce audit records containing sufficient information to establish the outcome (success or failure) of the events.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79019r1_fix" /><check system="C-72771r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure audit records containing sufficient information to establish the outcome (success or failure) of the events are produced.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72619"><title>SRG-APP-000101-DB-000044</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87251r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000055</version><title>The Cassandra database must include additional, more detailed, organization-defined information in the audit records for audit events identified by type, location, or subject.</title><description>&lt;VulnDiscussion&gt;Information system auditing capability is critical for accurate forensic analysis. Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information. To support analysis, some types of events will need information to be logged that exceeds the basic requirements of event type, time stamps, location, source, outcome, and user identity. If additional information is not available, it could negatively impact forensic investigations into user actions or other malicious events.

The organization must determine what additional information is required for complete analysis of the audited events. The additional information required is dependent on the type of information (e.g., sensitivity of the data and the environment within which it resides). At a minimum, the organization must employ either full-text recording of privileged commands or the individual identities of group users, or both. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise. 

Examples of detailed information the organization may require in audit records are full-text recording of privileged commands or the individual identities of group account users.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000135</ident><fixtext fixref="F-79021r1_fix">Configure the Cassandra Server to include additional, more detailed, organization-defined information in the audit records for audit events identified by type, location, or subject.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79021r1_fix" /><check system="C-72773r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure additional, more detailed, organization-defined information in the audit records for audit events identified by type, location, or subject are included.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72621"><title>SRG-APP-000033-DB-000084</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87253r1_rule" severity="high" weight="10.0"><version>VROM-CS-000005</version><title>The Cassandra database must have the correct authorizer value.</title><description>&lt;VulnDiscussion&gt;Authentication with a DoD-approved PKI certificate does not necessarily imply authorization to access the DBMS.  To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems, including databases, must be properly configured to implement access control policies. 

Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. 

Access control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system. 

This requirement is applicable to access control enforcement applications, a category that includes database management systems.  If the DBMS does not follow applicable policy when approving access, it may be in conflict with networks or other applications in the information system. This may result in users either gaining or being denied access inappropriately and in conflict with applicable policy.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000213</ident><fixtext fixref="F-79023r1_fix">Configure the Cassandra Server settings and access controls to permit user access only to objects and data that the user is authorized to view or interact with, and to prevent access to all other objects and data.

At the command line execute the following command:

# sed -i 's/^.*\bauthorizer:.*$/authorizer: CassandraAuthorizer/' /usr/lib/vmware-vcops/user/conf/cassandra/cassandra.yaml</fixtext><fix id="F-79023r1_fix" /><check system="C-72775r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Check the Cassandra Server settings to determine whether users are restricted from accessing objects and data they are not authorized to access.

At the command prompt, execute the following command:

# grep '^\s*authorizer:' /usr/lib/vmware-vcops/user/conf/cassandra/cassandra.yaml

If the line below is returned, this is a finding:
authorizer: AllowAllAuthorizer</check-content></check></Rule></Group><Group id="V-72623"><title>SRG-APP-000089-DB-000064</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87255r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000010</version><title>The Cassandra database must provide audit record generation capability for DoD-defined auditable events within all database components.</title><description>&lt;VulnDiscussion&gt;Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. 

Audit records can be generated from various components within the DBMS (e.g., process, module). Certain specific application functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.

DoD has defined the list of events for which the DBMS will provide an audit record generation capability as the following: 

(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);

(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities, or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and

(iii) All account creation, modification, disabling, and termination actions.

Organizations may define additional events requiring continuous or ad hoc auditing.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000169</ident><fixtext fixref="F-79025r1_fix">Configure the Cassandra Server to generate audit records for at least the DoD minimum set of events.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79025r1_fix" /><check system="C-72777r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Check the Cassandra Server auditing settings to determine whether organization-defined auditable events are being audited by the system.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72625"><title>SRG-APP-000090-DB-000065</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87257r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000015</version><title>The Cassandra database must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.</title><description>&lt;VulnDiscussion&gt;Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events.

Suppression of auditing could permit an adversary to evade detection.

Misconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000171</ident><fixtext fixref="F-79027r1_fix">Configure the Cassandra Server settings to allow designated personnel to select which auditable events are audited.

At the command line execute the following command:

# chmod 0640 /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79027r1_fix" /><check system="C-72779r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Check the Cassandra Server settings and documentation to determine whether designated personnel are able to select which auditable events are being audited.

At the command prompt, execute the following command:

# ls -al /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If the permissions are not "0640", this is a finding.</check-content></check></Rule></Group><Group id="V-72627"><title>SRG-APP-000091-DB-000066</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87259r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000020</version><title>The Cassandra database must be able to generate audit records when privileges/permissions are retrieved.</title><description>&lt;VulnDiscussion&gt;Under some circumstances, it may be useful to monitor who/what is reading privilege/permission/role information. Therefore, it must be possible to configure auditing to do this. DBMSs typically make such information available through views or functions.

This requirement addresses explicit requests for privilege/permission/role membership information. It does not refer to the implicit retrieval of privileges/permissions/role memberships that the DBMS continually performs to determine if any and every action on the database is permitted.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79029r1_fix">Configure the Cassandra Server to produce audit records when privileges/permissions/role memberships are retrieved.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79029r1_fix" /><check system="C-72781r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure that audit records can be produced when privileges/permissions/role memberships are retrieved.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72629"><title>SRG-APP-000091-DB-000325</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87261r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000025</version><title>The Cassandra database must be able to generate audit records when unsuccessful attempts to retrieve privileges/permissions occur.</title><description>&lt;VulnDiscussion&gt;Under some circumstances, it may be useful to monitor who/what is reading privilege/permission/role information. Therefore, it must be possible to configure auditing to do this. DBMSs typically make such information available through views or functions.

This requirement addresses explicit requests for privilege/permission/role membership information. It does not refer to the implicit retrieval of privileges/permissions/role memberships that the DBMS continually performs to determine if any and every action on the database is permitted.

To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79031r1_fix">Configure the Cassandra Server to produce audit records when other errors prevent access to privileges/permissions/role membership.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79031r1_fix" /><check system="C-72783r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure that audit records can be produced when the system denies or fails to complete attempts to retrieve privileges/permissions/role membership.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72631"><title>SRG-APP-000092-DB-000208</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87263r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000030</version><title>The Cassandra database must initiate session auditing upon startup.</title><description>&lt;VulnDiscussion&gt;Session auditing is for use when a user's activities are under investigation. To be sure of capturing all activity during those periods when session auditing is in use, it needs to be in operation for the whole time the DBMS is running.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001464</ident><fixtext fixref="F-79033r1_fix">Configure the Cassandra Server to initiate session auditing upon startup.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79033r1_fix" /><check system="C-72785r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure session auditing is initiated upon startup.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72633"><title>SRG-APP-000095-DB-000039</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87265r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000040</version><title>The Cassandra database must produce audit records containing sufficient information to establish what type of events occurred.</title><description>&lt;VulnDiscussion&gt;Information system auditing capability is critical for accurate forensic analysis. Without establishing what type of event occurred, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. 

Audit record content that may be necessary to satisfy the requirement of this policy includes, for example, time stamps, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.

Associating event types with detected events in the application and audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured application. 

Database software is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly what actions were performed. This requires specific information regarding the event type an audit record is referring to. If event type information is not recorded and stored with the audit record, the record itself is of very limited use.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000130</ident><fixtext fixref="F-79035r1_fix">Configure the Cassandra Server to produce audit records containing sufficient information to establish what type of events occurred.

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the &lt;appender&gt; node with the name="FILE" attribute.

Navigate to &lt;encoder&gt; node.

Edit the &lt;pattern&gt; to look like the below.
&lt;pattern&gt;%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n&lt;/pattern&gt;</fixtext><fix id="F-79035r1_fix" /><check system="C-72787r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure audit records containing sufficient information to establish what type of events occurred are produced.

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the &lt;appender&gt; node with the name="FILE" attribute.

Navigate to &lt;encoder&gt; node.

If the &lt;pattern&gt; node does not look like the expected result, this is a finding.

Expected result:
&lt;pattern&gt;%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n&lt;/pattern&gt;</check-content></check></Rule></Group><Group id="V-72635"><title>SRG-APP-000096-DB-000040</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87267r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000045</version><title>The Cassandra database must produce audit records containing time stamps to establish when the events occurred.</title><description>&lt;VulnDiscussion&gt;Information system auditing capability is critical for accurate forensic analysis. Without establishing when events occurred, it is impossible to establish, correlate, and investigate the events relating to an incident.

In order to compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know the date and time when events occurred.

Associating the date and time with detected events in the application and audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured application. 

Database software is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly when specific actions were performed. This requires the date and time an audit record is referring to. If date and time information is not recorded and stored with the audit record, the record itself is of very limited use.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000131</ident><fixtext fixref="F-79037r1_fix">Configure the Cassandra Server to produce audit records containing time stamps to establish when the events occurred.

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the &lt;appender&gt; node with the name="FILE" attribute.

Navigate to &lt;encoder&gt; node.

Edit the &lt;pattern&gt; to look like the below.
&lt;pattern&gt;%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n&lt;/pattern&gt;</fixtext><fix id="F-79037r1_fix" /><check system="C-72789r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server setting to ensure audit records containing time stamps to establish when the events occurred are produced.

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the &lt;appender&gt; node with the name="FILE" attribute.

Navigate to &lt;encoder&gt; node.

If the &lt;pattern&gt; node does not look like the expected result, this is a finding.

Expected result:
&lt;pattern&gt;%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n&lt;/pattern&gt;</check-content></check></Rule></Group><Group id="V-72637"><title>SRG-APP-000118-DB-000059</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87269r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000065</version><title>The Cassandra database logs must be protected from unauthorized read access.</title><description>&lt;VulnDiscussion&gt;If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.

To ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, copy, etc.

This requirement can be achieved through multiple methods which will depend upon system architecture and design. Some commonly employed methods include ensuring log files enjoy the proper file system permissions utilizing file system protections and limiting log data location. 

Additionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring that audit information is protected from unauthorized access.

Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000162</ident><fixtext fixref="F-79039r1_fix">Configure the Cassandra Server logs to be protected from unauthorized read access.

At the command prompt, execute the following command:

# chmod 0640 /storage/log/vcops/log/cassandra/&lt;file&gt;

Replace &lt;file&gt; with any file with incorrect permissions.</fixtext><fix id="F-79039r1_fix" /><check system="C-72791r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure logs are protected from unauthorized read access.

At the command prompt, execute the following command:

# ls -lL /storage/log/vcops/log/cassandra

If any file does not have permissions of "0640", this is a finding.</check-content></check></Rule></Group><Group id="V-72639"><title>SRG-APP-000119-DB-000060</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87271r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000070</version><title>The Cassandra database logs must have the correct owner.</title><description>&lt;VulnDiscussion&gt;If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is impossible to achieve. 

To ensure the veracity of audit data the information system and/or the application must protect audit information from unauthorized modification. 

This requirement can be achieved through multiple methods that will depend upon system architecture and design. Some commonly employed methods include ensuring log files enjoy the proper file system permissions and limiting log data locations. 

Applications providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights that the user enjoys in order to make access decisions regarding the modification of audit data.

Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity. 

Modification of database audit data could mask the theft of, or the unauthorized modification of, sensitive data stored in the database.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000163</ident><fixtext fixref="F-79041r1_fix">Configure the Cassandra Server logs to have the correct owner.

At the command prompt, execute the following command:

# chown admin /storage/log/vcops/log/cassandra/&lt;file&gt;

Replace &lt;file&gt; with any file that has the incorrect owner.</fixtext><fix id="F-79041r1_fix" /><check system="C-72793r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server to ensure logs have the correct owner.

At the command prompt, execute the following command:

# ls -lL /storage/log/vcops/log/cassandra

If any file is not owned by "admin", this is a finding.</check-content></check></Rule></Group><Group id="V-72641"><title>SRG-APP-000121-DB-000202</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87273r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000080</version><title>The Cassandra database log configuration file must be protected from unauthorized read access.</title><description>&lt;VulnDiscussion&gt;Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. 

Depending upon the log format and application, system and application log tools may provide the only means to manipulate and manage application and system log data. It is, therefore, imperative that access to audit tools be controlled and protected from unauthorized access. 

Applications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order make access decisions regarding the access to audit tools.

Audit tools include, but are not limited to, OS-provided audit tools, vendor-provided audit tools, and open source audit tools needed to successfully view and manipulate audit information system activity and records. 

If an attacker were to gain access to audit tools, he could analyze audit logs for system weaknesses or weaknesses in the auditing itself. An attacker could also manipulate logs to hide evidence of malicious activity.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001493</ident><fixtext fixref="F-79045r1_fix">Configure the Cassandra Server log configuration file to be protected from unauthorized read access.

At the command prompt, execute the following command:

# chmod 0640 /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79045r1_fix" /><check system="C-72797r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure the log configuration file is protected from unauthorized read access.

At the command prompt, execute the following command:

# ls -l /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If the file does not have permissions of "0640", this is a finding.</check-content></check></Rule></Group><Group id="V-72643"><title>SRG-APP-000122-DB-000203</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87275r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000085</version><title>The Cassandra database log configuration file must have the correct owner.</title><description>&lt;VulnDiscussion&gt;Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.

Applications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order make access decisions regarding the modification of audit tools.

Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001494</ident><fixtext fixref="F-79047r1_fix">Configure the Cassandra Server log configuration file to have the correct owner.

At the command prompt, execute the following command:

# chown admin /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79047r1_fix" /><check system="C-72799r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure the log configuration file has the correct owner.

At the command prompt, execute the following command:

# ls -l /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If the file is not owned by "admin", this is a finding.</check-content></check></Rule></Group><Group id="V-72645"><title>SRG-APP-000123-DB-000204</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87277r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000090</version><title>The Cassandra database log configuration file must have the correct group-owner.</title><description>&lt;VulnDiscussion&gt;Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.

Applications providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order make access decisions regarding the deletion of audit tools.

Audit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001495</ident><fixtext fixref="F-79049r1_fix">Configure the Cassandra Server log configuration file to have the correct group-owner.

At the command prompt, execute the following command:

# chown admin /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79049r1_fix" /><check system="C-72801r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure the log configuration file has the correct group-owner.

At the command prompt, execute the following command:

# ls -l /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If the file is not group-owned by "admin", this is a finding.</check-content></check></Rule></Group><Group id="V-72647"><title>SRG-APP-000133-DB-000199</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87279r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000100</version><title>The Cassandra software, including configuration files, must be stored in dedicated directories, or direct-access storage device (DASD) pools, separate from the host OS and other applications.</title><description>&lt;VulnDiscussion&gt;When dealing with change control issues, it should be noted any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system.

Multiple applications can provide a cumulative negative effect. A vulnerability and subsequent exploit to one application can lead to an exploit of other applications sharing the same security context. For example, an exploit to a web server process that leads to unauthorized administrative access to host system directories can most likely lead to a compromise of all applications hosted by the same system. Database software not installed using dedicated directories both threatens and is threatened by other hosted applications. Access controls defined for one application may by default provide access to the other application's database objects or directories. Any method that provides any level of separation of security context assists in the protection between applications.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001499</ident><fixtext fixref="F-79051r1_fix">Configure the Cassandra Server software, including configuration files, to be stored in dedicated directories, or direct-access storage device (DASD) pools, separate from the host OS and other applications.

Install all applications on directories separate from the DBMS software library directory. Relocate any directories or reinstall other application software that currently shares the DBMS software library directory.</fixtext><fix id="F-79051r1_fix" /><check system="C-72803r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server Configuration to ensure its software, including configuration files, is stored in dedicated directories, or direct-access storage device (DASD) pools, separate from the host OS and other applications.

Run following commands from Cassandra host server console: "cd $VCOPS_BASE/Cassandra/&lt;installed Cassandra release name (current example - apache-cassandra-2.1.8)&gt; ls -l"

If the Cassandra software, including configuration files, is not stored separate from the host OS and other applications, this is a finding.</check-content></check></Rule></Group><Group id="V-72649"><title>SRG-APP-000133-DB-000200</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87281r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000105</version><title>Database objects (including but not limited to tables, indexes, storage, stored procedures, functions, triggers, links to software external to the DBMS, etc.) must be owned by database/DBMS principals authorized for ownership.</title><description>&lt;VulnDiscussion&gt;Within the database, object ownership implies full privileges to the owned object, including the privilege to assign access to the owned objects to other subjects. Database functions and procedures can be coded using definer's rights. This allows anyone who utilizes the object to perform the actions if they were the owner. If not properly managed, this can lead to privileged actions being taken by unauthorized individuals.

Conversely, if critical tables or other objects rely on unauthorized owner accounts, these objects may be lost when an account is removed.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001499</ident><fixtext fixref="F-79053r1_fix">Assign ownership of authorized objects to authorized object owner accounts.

Open cqlsh prompt in the Cassandra Server and run "REVOKE &lt;list of permissions&gt; ON &lt;tablename&gt; FROM &lt;current owner user account name&gt;; GRANT ALL PERMISSIONS ON &lt;tablename&gt; TO &lt;superuser account name&gt;;"</fixtext><fix id="F-79053r1_fix" /><check system="C-72805r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review system documentation to identify accounts authorized to own database objects. Review accounts that own objects in the database(s).

If any database objects are found to be owned by users not authorized to own database objects, this is a finding.

Open cqlsh prompt in the Cassandra Server and type "LIST ALL PERMISSIONS;" command.  Review the list of access privileges available. 

If all the objects are owned by superuser account (cassandra in default Cassandra Server configuration), this is not a finding. 

Otherwise, it is a finding.</check-content></check></Rule></Group><Group id="V-72651"><title>SRG-APP-000133-DB-000362</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87283r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000110</version><title>The role(s)/group(s) used to modify database structure (including but not necessarily limited to tables, indexes, storage, etc.) and logic modules (stored procedures, functions, triggers, links to software external to the DBMS, etc.) must be restricted to authorized users.</title><description>&lt;VulnDiscussion&gt;If the DBMS were to allow any user to make changes to database structure or logic, those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.

Accordingly, only qualified and authorized individuals must be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.

Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001499</ident><fixtext fixref="F-79055r1_fix">Configure the Cassandra Server to restrict the role(s)/group(s) used to modify database structure (including but not necessarily limited to tables, indexes, storage, etc.) and logic modules (stored procedures, functions, triggers, links to software external to the DBMS, etc.) to authorized users.

At the command line execute the following command:

# chown root &lt;file&gt;

Replace &lt;file&gt; with the files that are not owned by either "admin" or "root".</fixtext><fix id="F-79055r1_fix" /><check system="C-72807r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure the role(s)/group(s) used to modify database structure (including but not necessarily limited to tables, indexes, storage, etc.) and logic modules (stored procedures, functions, triggers, links to software external to the DBMS, etc.) are restricted to authorized users.

At the command prompt, execute the following command:

# find /usr/lib/vmware-vcops/cassandra -type f ! \( -user admin -o -user root \)

If any files are listed that are not owned by either "admin" or "root", this is a finding.</check-content></check></Rule></Group><Group id="V-72653"><title>SRG-APP-000141-DB-000091</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87285r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000120</version><title>Unused Cassandra database components, software, and database objects must be removed.</title><description>&lt;VulnDiscussion&gt;Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).

It is detrimental for software products to provide, or install by default, functionality exceeding requirements or mission objectives. 

DBMSs must adhere to the principles of least functionality by providing only essential capabilities.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000381</ident><fixtext fixref="F-79057r1_fix">Uninstall unused components or features that are installed and can be uninstalled. Remove any database objects and applications that are installed to support them.

Run the following command from Cassandra host server console:
"rm –rf &lt;path to the unused component directory&gt;".</fixtext><fix id="F-79057r1_fix" /><check system="C-72809r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server to ensure unused database components, software, and database objects are removed.

Open console on server Cassandra DB is hosted on and run following command: "find / | grep "cassandra"". Review the list of files displayed.

If no unused components or features are displayed, this is not a finding. Otherwise, this is a finding.</check-content></check></Rule></Group><Group id="V-72655"><title>SRG-APP-000142-DB-000094</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87287r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000125</version><title>The Cassandra Server must be configured to prohibit or restrict the use of organization-defined functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.</title><description>&lt;VulnDiscussion&gt;In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols/services on information systems.

Applications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component. 

To support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.

Database Management Systems using ports, protocols, and services deemed unsafe are open to attack through those ports, protocols, and services. This can allow unauthorized access to the database and through the database to other components of the information system.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000382</ident><fixtext fixref="F-79059r1_fix">Disable functions, ports, protocols, and services that are not part of https://disa.deps.mil/ext/cop/iase/ppsm/Pages/cal.aspx document, and as such are not approved.

Modify "native_transport_port" and "rpc_address" values in "cassandra.yaml" file, to set them in the approved range (refer to https://disa.deps.mil/ext/cop/iase/ppsm/Pages/cal.aspx document).</fixtext><fix id="F-79059r1_fix" /><check system="C-72811r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Obtain document containing the list of approved ports, protocols and services from https://disa.deps.mil/ext/cop/iase/ppsm/Pages/cal.aspx. Review the Cassandra Server database settings and local documentation for functions, ports, protocols, and services that are not approved. 

Open the console to the server Cassandra DB is hosted at and type: "find / | grep "cassandra.yaml"". Open cassandra.yaml and review "native_transport_port" parameter value. Run "netstat -ntl | grep &lt;"native_transport_port" parameter value &gt;" command from the console on the host.

If protocol, port, and IP address Cassandra communicates on are not found in https://disa.deps.mil/ext/cop/iase/ppsm/Pages/cal.aspx, this is a finding.</check-content></check></Rule></Group><Group id="V-72657"><title>SRG-APP-000148-DB-000103</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87289r1_rule" severity="high" weight="10.0"><version>VROM-CS-000130</version><title>The Cassandra Server must uniquely identify and authenticate organizational users (or processes acting on behalf of organizational users).</title><description>&lt;VulnDiscussion&gt;To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system. 

Organizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses, except the following:

(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; and

(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000764</ident><fixtext fixref="F-79061r1_fix">Configure the Cassandra Server to uniquely identify and authenticate all organizational users who log on/connect to the system.

Create identity-based account for all the users accessing database (CREATE USER IF NOT EXISTS &lt;identity based username&gt; WITH PASSWORD &lt;password&gt;)

Build/configure applications to ensure successful individual authentication prior to shared account access.</fixtext><fix id="F-79061r1_fix" /><check system="C-72813r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure organizational users are uniquely identified and authenticated when logging on/connecting to the system.

Open "cqlsh" prompt in the Cassandra Server and type in "LIST USERS;" command. Review the list of accounts available against product documentation and determine if any shared accounts exist.

If accounts are determined to be shared, determine if individuals are first individually authenticated.

If individuals are not individually authenticated before using the shared account, this is a finding.</check-content></check></Rule></Group><Group id="V-72659"><title>SRG-APP-000164-DB-000401</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87291r1_rule" severity="high" weight="10.0"><version>VROM-CS-000135</version><title>The Cassandra database must enforce the DoD standards for password complexity and lifetime.</title><description>&lt;VulnDiscussion&gt;Native DBMS authentication may be used only when circumstances make it unavoidable. In such cases, the DoD standards for password complexity and lifetime must be implemented.  The rules must be enforced using available configuration parameters or custom code.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000192</ident><fixtext fixref="F-79063r2_fix">Configure the Cassandra database to enforce the DoD standards for password complexity and lifetime.

Use configuration parameters and/or custom code to enforce the following rules for passwords:

a. minimum of 15 characters, including at least one of each of the following character sets:
- Upper-case
- Lower-case
- Numeric
- Special characters (e.g., ~ ! @ # $ % ^ &amp; * ( ) _ + = - ' [ ] / ? &gt; &lt;)
b. Minimum number of characters changed from previous password: 50 percent of the minimum password length; that is, eight
c. Password lifetime limits: Minimum 24 hours, maximum 60 days
d. Number of password changes before an old one may be reused: Minimum of five</fixtext><fix id="F-79063r2_fix" /><check system="C-72815r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra database configuration to ensure the DoD standards for password complexity and lifetime are enforced.

Review the DBMS settings relating to password complexity. Determine whether the following rules are enforced. If any are not, this is a finding.

a. minimum of 15 characters, including at least one of each of the following character sets:
- Upper-case
- Lower-case
- Numeric
- Special characters (e.g., ~ ! @ # $ % ^ &amp; * ( ) _ + = - ' [ ] / ? &gt; &lt;)
b. Minimum number of characters changed from previous password: 50 percent of the minimum password length; that is, eight

Review the DBMS settings relating to password lifetime. Determine whether the following rules are enforced. If any are not, this is a finding.

c. Password lifetime limits: Minimum 24 hours, maximum 60 days
d. Number of password changes before an old one may be reused: Minimum of five</check-content></check></Rule></Group><Group id="V-72661"><title>SRG-APP-000172-DB-000075</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87293r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000140</version><title>The Cassandra database log configuration file must set internode encryption.</title><description>&lt;VulnDiscussion&gt;The DoD standard for authentication is DoD-approved PKI certificates.

Authentication based on User ID and Password may be used only when it is not possible to employ a PKI certificate, and requires AO approval.

In such cases, passwords need to be protected at all times, and encryption is the standard method for protecting passwords during transmission.

DBMS passwords sent in clear text format across the network are vulnerable to discovery by unauthorized users. Disclosure of passwords may easily lead to unauthorized access to the database.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000197</ident><fixtext fixref="F-79065r1_fix">Configure encryption for transmission of passwords across the network. If the database does not provide encryption for logon events natively, employ encryption at the OS or network level.

At the command line execute the following command:

# sed -i 's/^.*\binternode_encryption:.*$/internode_encryption: all/' /usr/lib/vmware-vcops/user/conf/cassandra/cassandra.yaml</fixtext><fix id="F-79065r1_fix" /><check system="C-72817r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review configuration settings for encrypting passwords in transit across the network. If passwords are not encrypted, this is a finding. 

At the command prompt, execute the following command:

# grep '^\s*internode_encryption:' /usr/lib/vmware-vcops/user/conf/cassandra/cassandra.yaml

If the line below is returned, this is a finding:
internode_encryption: all</check-content></check></Rule></Group><Group id="V-72663"><title>SRG-APP-000179-DB-000114</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87295r1_rule" severity="high" weight="10.0"><version>VROM-CS-002055</version><title>The Cassandra Server must use NIST FIPS 140-2 validated cryptographic modules for cryptographic operations.</title><description>&lt;VulnDiscussion&gt;Use of weak or not validated cryptographic algorithms undermines the purposes of utilizing encryption and digital signatures to protect data. Weak algorithms can be easily broken and not validated cryptographic modules may not implement algorithms correctly. Unapproved cryptographic modules or algorithms should not be relied on for authentication, confidentiality or integrity. Weak cryptography could allow an attacker to gain access to and modify data stored in the database as well as the administration settings of the DBMS.

Applications, including DBMSs, utilizing cryptography are required to use approved NIST FIPS 140-2 validated cryptographic modules that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance. 

The security functions validated as part of FIPS 140-2 for cryptographic modules are described in FIPS 140-2 Annex A.

NSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000803</ident><fixtext fixref="F-79067r1_fix">Configure the Cassandra Server to use NIST FIPS 140-2 validated cryptographic modules for cryptographic operations.

To enable the FIPS mode of operation, complete the following steps:

Replace the mod_ssl.so with the following command:
  cd /usr/lib64/apache2-prefork/
  cp mod_ssl.so mod_ssl.so.old
  cp mod_ssl.so.FIPSON.openssl1.0.2 mod_ssl.so

Modify your Apache2 configuration by editing the /etc/apache2/ssl-global.conf file.

Search for the &lt;IfModule mod_ssl.c&gt; line and add the SSLFIPS on directive below it.

Reset the Apache configuration with the service apache2 restart command.</fixtext><fix id="F-79067r1_fix" /><check system="C-72819r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure NIST FIPS 140-2 validated cryptographic modules are used for cryptographic operations.

Review the Apache2 configuration by opening the /etc/apache2/ssl-global.conf file.

Search for the &lt;IfModule mod_ssl.c&gt; line and ensure the SSLFIPS directive is below it.  If the SSLFIPS directive is not under the &lt;IfModule mod_ssl.c&gt; line, this is a finding.</check-content></check></Rule></Group><Group id="V-72665"><title>SRG-APP-000231-DB-000154</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87297r1_rule" severity="high" weight="10.0"><version>VROM-CS-002065</version><title>The Cassandra Server must protect the confidentiality and integrity of all information at rest.</title><description>&lt;VulnDiscussion&gt;This control is intended to address the confidentiality and integrity of information at rest in non-mobile devices and covers user information and system information. Information at rest refers to the state of information when it is located on a secondary storage device (e.g., disk drive, tape drive) within an organizational information system. Applications and application users generate information throughout the course of their application use. 

User data generated, as well as application-specific configuration data, needs to be protected. Organizations may choose to employ different mechanisms to achieve confidentiality and integrity protections, as appropriate. 

If the confidentiality and integrity of application data is not protected, the data will be open to compromise and unauthorized modification.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001199</ident><fixtext fixref="F-79069r1_fix">Configure the Cassandra Server to protect the confidentiality and integrity of all information at rest.

Implement full disk encryption such as VMcrypt or other third-party full disk encryption that uses FIPS 140-2 validated cryptography.</fixtext><fix id="F-79069r1_fix" /><check system="C-72821r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to protect the confidentiality and integrity of all information at rest.

Inspect the server configuration to ensure a full disk encryption solution has been implemented.  If the disk is unencrypted, this is a finding.</check-content></check></Rule></Group><Group id="V-72667"><title>SRG-APP-000233-DB-000124</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87299r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000175</version><title>The Cassandra Server must isolate security functions from non-security functions.</title><description>&lt;VulnDiscussion&gt;An isolation boundary provides access control and protects the integrity of the hardware, software, and firmware that perform security functions. 

Security functions are the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based.

Developers and implementers can increase the assurance in security functions by employing well-defined security policy models; structured, disciplined, and rigorous hardware and software development techniques; and sound system/security engineering principles. 

Database Management Systems typically separate security functionality from non-security functionality via separate databases or schemas. Database objects or code implementing security functionality should not be commingled with objects or code implementing application logic. When security and non-security functionality are commingled, users who have access to non-security functionality may be able to access security functionality.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001084</ident><fixtext fixref="F-79071r1_fix">Configure the Cassandra Server to isolate security functions from non-security functions.

Locate security-related database objects and code in a separate database, schema, or other separate security domain from database objects and code implementing application logic.

Using the "REVOKE" command, modify access privileges for objects in system, system_auth, and system_traces, revoking privileges of non-superuser users.</fixtext><fix id="F-79071r1_fix" /><check system="C-72823r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure objects or code implementing security functionality are located in a separate security domain, such as a separate database or schema created specifically for security functionality.

If security-related database objects or code are not kept separate, this is a finding.

Open "cqlsh" prompt of Cassandra Server and run "LIST ALL PERMISSIONS" command from it. Review username resource and permissions columns.

If for any of the objects under system, system_auth, or system_traces schemas privileges are given to any other users than a superuser (cassandra in default configuration), this is a finding.</check-content></check></Rule></Group><Group id="V-72669"><title>SRG-APP-000243-DB-000374</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87301r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000180</version><title>Access to database files must be limited to relevant processes and to authorized, administrative users.</title><description>&lt;VulnDiscussion&gt;Applications, including DBMSs, must prevent unauthorized and unintended information transfer via shared system resources. Permitting only DBMS processes and authorized, administrative users to have access to the files where the database resides helps ensure that those files are not shared inappropriately and are not open to backdoor access and manipulation.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001090</ident><fixtext fixref="F-79073r1_fix">Configure the permissions granted by the operating system/file system on the database files, database log files, and database backup files so that only relevant system accounts and authorized system administrators and database administrators with a need to know are permitted to read/view these files.

At the command line execute the following command:

# chown root &lt;file&gt;

Replace &lt;file&gt; with the files that are not owned by either "admin" or "root".</fixtext><fix id="F-79073r1_fix" /><check system="C-72825r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the permissions granted to users by the operating system/file system on the database files, database log files, and database backup files. 

At the command prompt, execute the following command:

# find /storage/db/vcops/cassandra/data -type f ! \( -user admin -o -user root \)

If any files are listed that are not owned by either "admin" or "root", this is a finding.</check-content></check></Rule></Group><Group id="V-72671"><title>SRG-APP-000267-DB-000163</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87303r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000200</version><title>The Cassandra Server must reveal detailed error messages only to the ISSO, ISSM, SA, and DBA.</title><description>&lt;VulnDiscussion&gt;If the DBMS provides too much information in error logs and administrative messages to the screen, this could lead to compromise. The structure and content of error messages need to be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements. 

Some default DBMS error messages can contain information that could aid an attacker in, among others things, identifying the database type, host address, or state of the database. Custom errors may contain sensitive customer information. 

It is important that detailed error messages be visible only to those who are authorized to view them; that general users receive only generalized acknowledgment that errors have occurred; and that these generalized messages appear only when relevant to the user's task. For example, a message along the lines of, "An error has occurred. Unable to save your changes. If this problem persists, please contact your help desk" would be relevant. A message such as "Warning: your transaction generated a large number of page splits" would likely not be relevant. 

Administrative users authorized to review detailed error messages typically are the ISSO, ISSM, SA and DBA. Other individuals or roles may be specified according to organization-specific needs, with DBA approval.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001314</ident><fixtext fixref="F-79075r1_fix">Configure the Cassandra Server to only reveal detailed error messages to the ISSO, ISSM, SA and DBA.

At the command prompt, execute the following command:

# chown admin /usr/lib/vmware-vcops/user/conf/cassandra/&lt;file&gt;

Replace &lt;file&gt; with any file not owned by "admin".</fixtext><fix id="F-79075r1_fix" /><check system="C-72827r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server to ensure detailed error messages are only revealed to the ISSO, ISSM, SA and DBA.

At the command prompt, execute the following command:

# ls -l /usr/lib/vmware-vcops/user/conf/cassandra

If any file is not owned by "admin", this is a finding.</check-content></check></Rule></Group><Group id="V-72673"><title>SRG-APP-000356-DB-000314</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87305r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000210</version><title>The Cassandra Server must utilize centralized management of the content captured in audit records generated by all components of the system.</title><description>&lt;VulnDiscussion&gt;Without the ability to centrally manage the content captured in the audit records, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack.

The content captured in audit records must be managed from a central location (necessitating automation). Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. 

The DBMS may write audit records to database tables, to files in the file system, to other kinds of local repository, or directly to a centralized log management system. Whatever the method used, it must be compatible with off-loading the records to the centralized system.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001844</ident><fixtext fixref="F-79077r1_fix">Configure the Cassandra Server to utilize centralized management of the content captured in audit records generated by all components of the system.

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the &lt;configuration&gt; node.

Add the following &lt;appender&gt; node to the &lt;configuration&gt; node.

  &lt;appender name="SYSLOG" class="ch.qos.logback.classic.net.SyslogAppender"&gt;
    &lt;syslogHost&gt;syslogServerHostName&lt;/syslogHost&gt;
    &lt;facility&gt;AUTH&lt;/facility&gt;
    &lt;suffixPattern&gt;%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n &lt;/suffixPattern&gt;
  &lt;/appender&gt;

Navigate to the &lt;root&gt; node.

Add the following to the &lt;root&gt; node.
    &lt;appender-ref ref="SYSLOG" /&gt;</fixtext><fix id="F-79077r1_fix" /><check system="C-72829r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure centralized management of the content captured in audit records generated by all components of the system are utilized.

At the command prompt, execute the following command:

# grep SyslogAppender /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72675"><title>SRG-APP-000374-DB-000322</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87307r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000220</version><title>The Cassandra Server must record time stamps, in audit records and application data that can be mapped to Coordinated Universal Time (UTC, formerly GMT).</title><description>&lt;VulnDiscussion&gt;If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.

Time stamps generated by the DBMS must include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC. 

Some DBMS products offer a data type called TIMESTAMP that is not a representation of date and time. Rather, it is a database state counter and does not correspond to calendar and clock time. This requirement does not refer to that meaning of TIMESTAMP.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001890</ident><fixtext fixref="F-79079r1_fix">Configure the Cassandra Server to record time stamps, in audit records and application data that can be mapped to Coordinated Universal Time (UTC, formerly GMT).

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the &lt;appender&gt; node with the name="FILE" attribute.

Navigate to &lt;encoder&gt; node.

Edit the &lt;pattern&gt; to look like the below.
&lt;pattern&gt;%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n&lt;/pattern&gt;</fixtext><fix id="F-79079r1_fix" /><check system="C-72831r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure time stamps, in audit records and application data that can be mapped to Coordinated Universal Time (UTC, formerly GMT) are recorded.

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the &lt;appender&gt; node with the name="FILE" attribute.

Navigate to &lt;encoder&gt; node.

If the &lt;pattern&gt; node does not look like the expected result, this is a finding.

Expected result:
&lt;pattern&gt;%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n&lt;/pattern&gt;</check-content></check></Rule></Group><Group id="V-72677"><title>SRG-APP-000375-DB-000323</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87309r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000225</version><title>The Cassandra Server must generate time stamps, for audit records and application data, with a minimum granularity of one second.</title><description>&lt;VulnDiscussion&gt;Without sufficient granularity of time stamps, it is not possible to adequately determine the chronological order of records. 

Time stamps generated by the DBMS must include date and time. Granularity of time measurements refers to the precision available in time stamp values. Granularity coarser than one second is not sufficient for audit trail purposes. Time stamp values are typically presented with three or more decimal places of seconds; however, the actual granularity may be coarser than the apparent precision. For example, SQL Server's GETDATE()/CURRENT_TMESTAMP values are presented to three decimal places, but the granularity is not one millisecond: it is about 1/300 of a second.

Some DBMS products offer a data type called TIMESTAMP that is not a representation of date and time. Rather, it is a database state counter and does not correspond to calendar and clock time. This requirement does not refer to that meaning of TIMESTAMP.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001889</ident><fixtext fixref="F-79081r1_fix">Configure the Cassandra Server to generate time stamps, for audit records and application data, with a minimum granularity of one second.

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the &lt;appender&gt; node with the name="FILE" attribute.

Navigate to &lt;encoder&gt; node.

Edit the &lt;pattern&gt; to look like the below.
&lt;pattern&gt;%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n&lt;/pattern&gt;</fixtext><fix id="F-79081r1_fix" /><check system="C-72833r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure time stamps, for audit records and application data, with a minimum granularity of one second are generated.

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the &lt;appender&gt; node with the name="FILE" attribute.

Navigate to &lt;encoder&gt; node.

If the &lt;pattern&gt; node does not look like the expected result, this is a finding.

Expected result:
&lt;pattern&gt;%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n&lt;/pattern&gt;</check-content></check></Rule></Group><Group id="V-72679"><title>SRG-APP-000380-DB-000360</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87311r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000235</version><title>The Cassandra database must protect the truststore file.</title><description>&lt;VulnDiscussion&gt;Failure to provide logical access restrictions associated with changes to configuration may have significant effects on the overall security of the system. 

When dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system. 

Accordingly, only qualified and authorized individuals should be allowed to obtain access to system components for the purposes of initiating changes, including upgrades and modifications.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001813</ident><fixtext fixref="F-79083r1_fix">Configure the Cassandra Server to protect the truststore file.

At the command line execute the following command:

# chmod 0640 /storage/vcops/user/conf/ssl/tcserver.truststore</fixtext><fix id="F-79083r1_fix" /><check system="C-72835r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure the truststore file is protected.

At the command prompt, execute the following command:

# ls -l /storage/vcops/user/conf/ssl/tcserver.truststore

If the file permissions are not "0640", this is a finding.</check-content></check></Rule></Group><Group id="V-72681"><title>SRG-APP-000383-DB-000364</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87313r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000240</version><title>The Cassandra Server must disable network functions, ports, protocols, and services deemed by the organization to be nonsecure, in accord with the Ports, Protocols, and Services Management (PPSM) guidance.</title><description>&lt;VulnDiscussion&gt;Use of nonsecure network functions, ports, protocols, and services exposes the system to avoidable threats.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001762</ident><fixtext fixref="F-79085r1_fix">Configure the Cassandra Server to disable network functions, ports, protocols, and services deemed by the organization to be nonsecure, in accordance with the Ports, Protocols, and Services Management (PPSM) guidance.

Open the console to the server that Cassandra DB is hosted at and type: "find / | grep "cassandra.yaml"". Open "cassandra.yaml" file and modify "start_rpc parameter" value to "false", "start_native_transport parameter" value to "true" and "native_transport_port" parameter value to one in the range of approved ports, according to https://disa.deps.mil/ext/cop/iase/ppsm/Pages/cal.aspx document (default port is 9042).</fixtext><fix id="F-79085r1_fix" /><check system="C-72837r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server to ensure network functions, ports, protocols, and services deemed by the organization to be nonsecure, in accordance with the Ports, Protocols, and Services Management (PPSM) guidance are disabled.

Open the console to the server that Cassandra DB is hosted at and type: "find / | grep "cassandra.yaml"". Open "cassandra.yaml" file and review "start_rpc", "start_native_transport", and "native_transport_port" parameters values.

If "start_rpc" is not set to "false" and "start_native_transport" is not set to "true", this is a finding.

Run following command from the console of server, hosting Cassandra: "netstat -ntl | grep &lt;native_transport_port &gt; parameter value". Review output of this command record for the protocol and port Cassandra listens at.

Obtain the document containing the list of approved ports, protocols, and services from https://disa.deps.mil/ext/cop/iase/ppsm/Pages/cal.aspx.

If protocol and port Cassandra listens at are not approved, this is a finding.</check-content></check></Rule></Group><Group id="V-72687"><title>SRG-APP-000429-DB-000387</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87319r1_rule" severity="high" weight="10.0"><version>VROM-CS-002125</version><title>The Cassandra Server must implement cryptographic mechanisms preventing the unauthorized disclosure of information at rest.</title><description>&lt;VulnDiscussion&gt;DBMSs handling data requiring "data at rest" protections must employ cryptographic mechanisms to prevent unauthorized disclosure and modification of the information at rest. These cryptographic mechanisms may be native to the DBMS or implemented via additional software or operating system/file system settings, as appropriate to the situation.

Selection of a cryptographic mechanism is based on the need to protect the integrity of organizational information. The strength of the mechanism is commensurate with the security category and/or classification of the information. Organizations have the flexibility to either encrypt all information on storage devices (i.e., full disk encryption) or encrypt specific data structures (e.g., files, records, or fields). 

The decision whether and what to encrypt rests with the data owner and is also influenced by the physical measures taken to secure the equipment and media on which the information resides.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-002476</ident><fixtext fixref="F-79091r1_fix">Configure the Cassandra Server to implement cryptographic mechanisms preventing the unauthorized disclosure of information at rest.

Implement full disk encryption such as VMcrypt or other third-party full disk encryption that uses FIPS 140-2 validated cryptography.</fixtext><fix id="F-79091r1_fix" /><check system="C-72843r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server to ensure cryptographic mechanisms are implemented preventing the unauthorized disclosure of organization-defined information at rest on organization-defined information system components.
 
Inspect the server configuration to ensure a full disk encryption solution has been implemented. If the disk is unencrypted, this is a finding.</check-content></check></Rule></Group><Group id="V-72689"><title>SRG-APP-000447-DB-000393</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87321r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000250</version><title>When invalid inputs are received, the Cassandra Server must behave in a predictable and documented manner that reflects organizational and system objectives.</title><description>&lt;VulnDiscussion&gt;A common vulnerability is unplanned behavior when invalid inputs are received. This requirement guards against adverse or unintended system behavior caused by invalid inputs, where information system responses to the invalid input may be disruptive or cause the system to fail into an unsafe state.

The behavior will be derived from the organizational and system requirements and includes, but is not limited to, notification of the appropriate personnel, creating an audit record, and rejecting invalid input.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-002754</ident><fixtext fixref="F-79093r1_fix">Configure the Cassandra Server to behave in a predictable and documented manner that reflects organizational and system objectives when invalid inputs are received.

Modify tables by adding constraints (CREATE TRIGGER IF NOT EXISTS &lt;trigger_name&gt; ON &lt;table name&gt;, where TRIGGER triggered validation event).

Open console to the server, Cassandra DB is hosted at, and type: "find / | grep "logback.xml"". Open "logback.xml" file and set "level" parameter value under &lt;root /&gt; to "ALL".</fixtext><fix id="F-79093r1_fix" /><check system="C-72845r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server to ensure that it behaves in a predictable and documented manner that reflects organizational and system objectives when invalid inputs are received.

Open the "cqlsh" prompt in the Cassandra Server and type "DESCRIBE KEYSPACES;". Type "DESCRIBE &lt;keyspace name&gt;" for all the keyspace names that have been displayed as output for the first command. Review keyspaces content.

Open the console to the server that Cassandra DB is hosted at and type: "find / | grep "logback.xml"". Open "logback.xml" file and review "level" parameter value under &lt;root /&gt;.

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72691"><title>SRG-APP-000456-DB-000390</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87323r1_rule" severity="high" weight="10.0"><version>VROM-CS-000260</version><title>Security-relevant software updates to the Cassandra Server must be installed within the time period directed by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).</title><description>&lt;VulnDiscussion&gt;Security flaws with software applications, including database management systems, are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously. 

Organization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw). 

This requirement will apply to software patch management solutions that are used to install patches across the enclave and also to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period utilized must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.

The application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-002605</ident><fixtext fixref="F-79095r1_fix">Configure the Cassandra Server to install security-relevant software updates within the time period directed by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).

Install the latest updates according to the time period specified in product documentation. Verify that the Cassandra Server was configured to follow product documentation specified updates installation timeframe.</fixtext><fix id="F-79095r1_fix" /><check system="C-72847r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure security-relevant software updates are installed within the time period directed by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).

Run "find / | grep "cassandra-"" from console and review all the Cassandra DB related packages currently installed on the host.

Check at the http://cassandra.apache.org/download/ for the latest updates and patches available. Check product documentation for the time period updates have to be installed on the host.

If there is an update that has to be installed, but is not displayed in the list of Cassandra DB related packages currently installed on the host, this is a finding.</check-content></check></Rule></Group><Group id="V-72693"><title>SRG-APP-000492-DB-000332</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87325r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000265</version><title>The Cassandra Server must be able to generate audit records when security objects are accessed.</title><description>&lt;VulnDiscussion&gt;Changes to the security configuration must be tracked.

This requirement applies to situations where security data is retrieved or modified via data manipulation operations, as opposed to via specialized security functionality.

In an SQL environment, types of access include, but are not necessarily limited to:

SELECT
INSERT
UPDATE
DELETE
EXECUTE&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79097r1_fix">Configure the Cassandra Server to generate audit records when security objects are accessed.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79097r1_fix" /><check system="C-72849r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when security objects are accessed.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72695"><title>SRG-APP-000492-DB-000333</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87327r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000270</version><title>The Cassandra Server must generate audit records when unsuccessful attempts to access security objects occur.</title><description>&lt;VulnDiscussion&gt;Changes to the security configuration must be tracked.

This requirement applies to situations where security data is retrieved or modified via data manipulation operations, as opposed to via specialized security functionality.

In an SQL environment, types of access include, but are not necessarily limited to:

SELECT
INSERT
UPDATE
DELETE
EXECUTE

To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79099r1_fix">Configure the Cassandra Server to generate audit records when unsuccessful attempts to access security objects occur.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79099r1_fix" /><check system="C-72851r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when unsuccessful attempts to access security objects occur.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72697"><title>SRG-APP-000495-DB-000326</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87329r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000285</version><title>The Cassandra Server must generate audit records when privileges/permissions are added.</title><description>&lt;VulnDiscussion&gt;Changes in the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized elevation or restriction of individuals' and groups' privileges could go undetected. Elevated privileges give users access to information and functionality that they should not have; restricted privileges wrongly deny access to authorized users.

In an SQL environment, adding permissions is typically done via the GRANT command, or, in the negative, the DENY command.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79101r1_fix">Configure the Cassandra Server to generate audit records when privileges/permissions are added.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79101r1_fix" /><check system="C-72853r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when privileges/permissions are added.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72699"><title>SRG-APP-000495-DB-000327</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87331r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000290</version><title>The Cassandra Server must generate audit records when unsuccessful attempts to add privileges/permissions occur.</title><description>&lt;VulnDiscussion&gt;Failed attempts to change the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized attempts to elevate or restrict individuals' and groups' privileges could go undetected. 

In an SQL environment, adding permissions is typically done via the GRANT command, or, in the negative, the DENY command. 

To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79103r1_fix">Configure the Cassandra Server to generate audit records when unsuccessful attempts to add privileges/permissions occur.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79103r1_fix" /><check system="C-72855r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when unsuccessful attempts to add privileges/permissions occur.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72701"><title>SRG-APP-000495-DB-000328</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87333r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000295</version><title>The Cassandra Server must generate audit records when privileges/permissions are modified.</title><description>&lt;VulnDiscussion&gt;Changes in the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized elevation or restriction of individuals' and groups' privileges could go undetected. Elevated privileges give users access to information and functionality that they should not have; restricted privileges wrongly deny access to authorized users.

In an SQL environment, modifying permissions is typically done via the GRANT, REVOKE, and DENY commands.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79105r1_fix">Configure the Cassandra Server to generate audit records when privileges/permissions are modified.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79105r1_fix" /><check system="C-72857r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when privileges/permissions are modified.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72703"><title>SRG-APP-000495-DB-000329</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87335r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000300</version><title>The Cassandra Server must generate audit records when unsuccessful attempts to modify privileges/permissions occur.</title><description>&lt;VulnDiscussion&gt;Failed attempts to change the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized attempts to elevate or restrict individuals' and groups' privileges could go undetected. 

In an SQL environment, modifying permissions is typically done via the GRANT, REVOKE, and DENY commands. 

To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79107r1_fix">Configure the Cassandra Server to generate audit records when unsuccessful attempts to modify privileges/permissions occur.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79107r1_fix" /><check system="C-72859r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when unsuccessful attempts to modify privileges/permissions occur.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72705"><title>SRG-APP-000496-DB-000334</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87337r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000305</version><title>The Cassandra Server must generate audit records when security objects are modified.</title><description>&lt;VulnDiscussion&gt;Changes in the database objects (tables, views, procedures, functions) that record and control permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized changes to the security subsystem could go undetected. The database could be severely compromised or rendered inoperative.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79109r1_fix">Configure the Cassandra Server to generate audit records when security objects are modified.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79109r1_fix" /><check system="C-72861r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when security objects are modified.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72707"><title>SRG-APP-000496-DB-000335</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87339r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000310</version><title>The Cassandra Server must generate audit records when unsuccessful attempts to modify security objects occur.</title><description>&lt;VulnDiscussion&gt;Changes in the database objects (tables, views, procedures, functions) that record and control permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized changes to the security subsystem could go undetected. The database could be severely compromised or rendered inoperative.

To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79111r1_fix">Configure the Cassandra Server to generate audit records when unsuccessful attempts to modify security objects occur.

Open console to the server, Cassandra DB is hosted at, and type: "find / | grep "logback.xml"". Open "logback.xml" file and set "level" parameter value under &lt;root /&gt; to "ALL".</fixtext><fix id="F-79111r1_fix" /><check system="C-72863r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when unsuccessful attempts to modify security objects occur.

Open console to the server, Cassandra DB is hosted at, and type: "find / | grep "logback.xml"". Open "logback.xml" file and review "level" parameter value under &lt;root /&gt;.

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72709"><title>SRG-APP-000499-DB-000330</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87341r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000325</version><title>The Cassandra Server must generate audit records when privileges/permissions are deleted.</title><description>&lt;VulnDiscussion&gt;Changes in the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized elevation or restriction of individuals' and groups' privileges could go undetected. Elevated privileges give users access to information and functionality that they should not have; restricted privileges wrongly deny access to authorized users.

In an SQL environment, deleting permissions is typically done via the REVOKE or DENY command.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79113r1_fix">Configure the Cassandra Server to generate audit records when privileges/permissions are deleted.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79113r1_fix" /><check system="C-72865r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when privileges/permissions are deleted.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72711"><title>SRG-APP-000499-DB-000331</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87343r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000330</version><title>The Cassandra Server must generate audit records when unsuccessful attempts to delete privileges/permissions occur.</title><description>&lt;VulnDiscussion&gt;Failed attempts to change the permissions, privileges, and roles granted to users and roles must be tracked. Without an audit trail, unauthorized attempts to elevate or restrict individuals' and groups' privileges could go undetected. 

In an SQL environment, deleting permissions is typically done via the REVOKE or DENY command. 

To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79115r1_fix">Configure the Cassandra Server to generate audit records when unsuccessful attempts to delete privileges/permissions occur.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79115r1_fix" /><check system="C-72867r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when unsuccessful attempts to delete privileges/permissions occur.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72713"><title>SRG-APP-000501-DB-000336</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87345r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000335</version><title>The Cassandra Server must generate audit records when security objects are deleted.</title><description>&lt;VulnDiscussion&gt;The removal of security objects from the database/DBMS would seriously degrade a system's information assurance posture. If such an event occurs, it must be logged.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79117r1_fix">Configure the Cassandra Server to generate audit records when security objects are deleted.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79117r1_fix" /><check system="C-72869r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when security objects are deleted.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72715"><title>SRG-APP-000501-DB-000337</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87347r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000340</version><title>The Cassandra Server must generate audit records when unsuccessful attempts to delete security objects occur.</title><description>&lt;VulnDiscussion&gt;The removal of security objects from the database/DBMS would seriously degrade a system's information assurance posture. If such an action is attempted, it must be logged.

To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79119r1_fix">Configure the Cassandra Server to generate audit records when unsuccessful attempts to delete security objects occur.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79119r1_fix" /><check system="C-72871r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when unsuccessful attempts to delete security objects occur.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72717"><title>SRG-APP-000502-DB-000348</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87349r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000345</version><title>The Cassandra Server must generate audit records when categories of information (e.g., classification levels/security levels) are deleted.</title><description>&lt;VulnDiscussion&gt;Changes in categories of information must be tracked. Without an audit trail, unauthorized access to protected data could go undetected.

For detailed information on categorizing information, refer to FIPS Publication 199, Standards for Security Categorization of Federal Information and Information Systems, and FIPS Publication 200, Minimum Security Requirements for Federal Information and Information Systems.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79121r1_fix">Configure the Cassandra Server to generate audit records when categories of information (e.g., classification levels/security levels) are deleted.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79121r1_fix" /><check system="C-72873r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when categories of information (e.g., classification levels/security levels) are deleted.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72719"><title>SRG-APP-000504-DB-000354</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87351r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000355</version><title>The Cassandra Server must generate audit records for all privileged activities or other system-level access.</title><description>&lt;VulnDiscussion&gt;Without tracking privileged activity, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. 

System documentation should include a definition of the functionality considered privileged.

A privileged function in this context is any operation that modifies the structure of the database, its built-in logic, or its security settings. This would include all Data Definition Language (DDL) statements and all security-related statements. In an SQL environment, it encompasses, but is not necessarily limited to:

CREATE
ALTER
DROP
GRANT
REVOKE
DENY

There may also be Data Manipulation Language (DML) statements that, subject to context, should be regarded as privileged. Possible examples in SQL include:

TRUNCATE TABLE;
DELETE, or
DELETE affecting more than n rows, for some n, or
DELETE without a WHERE clause;

UPDATE or
UPDATE affecting more than n rows, for some n, or
UPDATE without a WHERE clause;

any SELECT, INSERT, UPDATE, or DELETE to an application-defined security table executed by other than a security principal.

Depending on the capabilities of the DBMS and the design of the database and associated applications, audit logging may be achieved by means of DBMS auditing features, database triggers, other mechanisms, or a combination of these.

Note that it is particularly important to audit, and tightly control, any action that weakens the implementation of this requirement itself, since the objective is to have a complete audit trail of all administrative activity.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79123r1_fix">Configure the Cassandra Server to generate audit records for all privileged activities or other system-level access.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79123r1_fix" /><check system="C-72875r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated for all privileged activities or other system-level access.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72721"><title>SRG-APP-000504-DB-000355</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87353r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000360</version><title>The Cassandra Server must generate audit records when unsuccessful attempts to execute privileged activities or other system-level access occur.</title><description>&lt;VulnDiscussion&gt;Without tracking privileged activity, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. 

System documentation should include a definition of the functionality considered privileged.

A privileged function in this context is any operation that modifies the structure of the database, its built-in logic, or its security settings. This would include all Data Definition Language (DDL) statements and all security-related statements. In an SQL environment, it encompasses, but is not necessarily limited to:

CREATE
ALTER
DROP
GRANT
REVOKE
DENY

Note that it is particularly important to audit, and tightly control, any action that weakens the implementation of this requirement itself, since the objective is to have a complete audit trail of all administrative activity.

To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79125r1_fix">Configure the Cassandra Server to generate audit records when unsuccessful attempts to execute privileged activities or other system-level access occur.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79125r1_fix" /><check system="C-72877r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when unsuccessful attempts to execute privileged activities or other system-level access occur.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72723"><title>SRG-APP-000507-DB-000356</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87355r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000365</version><title>The Cassandra Server must be able to generate audit records when successful accesses to objects occur.</title><description>&lt;VulnDiscussion&gt;Without tracking all or selected types of access to all or selected objects (tables, views, procedures, functions, etc.), it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one. 

In an SQL environment, types of access include, but are not necessarily limited to:

SELECT
INSERT
UPDATE
DELETE
EXECUTE&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79127r1_fix">Configure the Cassandra Server to generate audit records when successful accesses to objects occur.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79127r1_fix" /><check system="C-72879r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when successful accesses to objects occur.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72725"><title>SRG-APP-000507-DB-000357</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87357r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000370</version><title>The Cassandra Server must generate audit records when unsuccessful accesses to objects occur.</title><description>&lt;VulnDiscussion&gt;Without tracking all or selected types of access to all or selected objects (tables, views, procedures, functions, etc.), it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. 

In an SQL environment, types of access include, but are not necessarily limited to:

SELECT
INSERT
UPDATE
DELETE
EXECUTE

To aid in diagnosis, it is necessary to keep track of failed attempts in addition to the successful ones.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000172</ident><fixtext fixref="F-79129r1_fix">Configure the Cassandra Server to generate audit records when unsuccessful accesses to objects occur.

At the command line execute the following command:

# sed -i 's/^\(\s*\)&lt;root level=".*"&gt;\(\s*\)$/\1&lt;root level="ALL"&gt;\2/' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml</fixtext><fix id="F-79129r1_fix" /><check system="C-72881r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server configuration to ensure audit records are generated when unsuccessful accesses to objects occur.

At the command prompt, execute the following command:

# grep '&lt;root' /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72733"><title>SRG-APP-000515-DB-000318</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87365r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000390</version><title>The Cassandra Server must off-load audit data to a separate log management facility; this must be continuous and in near real time for systems with a network connection to the storage facility and weekly or more often for stand-alone systems.</title><description>&lt;VulnDiscussion&gt;Information stored in one location is vulnerable to accidental or incidental deletion or alteration.

Off-loading is a common process in information systems with limited audit storage capacity. 

The DBMS may write audit records to database tables, to files in the file system, to other kinds of local repository, or directly to a centralized log management system. Whatever the method used, it must be compatible with off-loading the records to the centralized system.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-001851</ident><fixtext fixref="F-79153r1_fix">Configure the Cassandra Server to off-load audit data to a separate log management facility.

Navigate to and open /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml.

Navigate to the &lt;configuration&gt; node.

Add the following &lt;appender&gt; node to the &lt;configuration&gt; node.

  &lt;appender name="SYSLOG" class="ch.qos.logback.classic.net.SyslogAppender"&gt;
    &lt;syslogHost&gt;syslogServerHostName&lt;/syslogHost&gt;
    &lt;facility&gt;AUTH&lt;/facility&gt;
    &lt;suffixPattern&gt;%-5level [%thread] %date{ISO8601, UTC} %F:%L - %msg%n &lt;/suffixPattern&gt;
  &lt;/appender&gt;

Navigate to the &lt;root&gt; node.

Add the following to the &lt;root&gt; node.
    &lt;appender-ref ref="SYSLOG" /&gt;</fixtext><fix id="F-79153r1_fix" /><check system="C-72889r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server to ensure audit data is off-loaded to a separate log management facility.

At the command prompt, execute the following command:

# grep SyslogAppender /usr/lib/vmware-vcops/user/conf/cassandra/logback.xml

If level is not set to "ALL", this is a finding.</check-content></check></Rule></Group><Group id="V-72735"><title>SRG-APP-000516-DB-000363</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87367r1_rule" severity="low" weight="10.0"><version>VROM-CS-001075</version><title>The DBMS must be configured in accordance with the security configuration settings based on DoD security configuration and implementation guidance, including STIGs, NSA configuration guides, CTOs, DTMs, and IAVMs.</title><description>&lt;VulnDiscussion&gt;Configuring the DBMS to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements. 

In addition to this SRG, sources of guidance on security and information assurance exist. These include NSA configuration guides, CTOs, DTMs, and IAVMs. The DBMS must be configured in compliance with guidance from all such relevant sources.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000366</ident><fixtext fixref="F-79137r1_fix">Configure the Cassandra server in accordance with DoD security configuration and implementation guidance, including STIGs, NSA configuration guides, CTOs, DTMs, and IAVMs.</fixtext><fix id="F-79137r1_fix" /><check system="C-72891r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra documentation and configuration to determine if the server is configured in accordance with DoD security configuration and implementation guidance, including STIGs, NSA configuration guides, CTOs, DTMs, and IAVMs.

Obtain supporting documentation from the ISSO.

Verify that this Security Technical Implementation Guide (STIG) is the most current STIG available for Cassandra on vROps. Assess all of the organization's vROps installations to ensure that they are fully compliant with the most current Cassandra STIG.

If the Cassandra configuration is not compliant with the most current Cassandra STIG, this is a finding.</check-content></check></Rule></Group><Group id="V-72751"><title>SRG-APP-000120-DB-000061</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-87383r1_rule" severity="medium" weight="10.0"><version>VROM-CS-000075</version><title>The Cassandra database logs must have the correct group-owner.</title><description>&lt;VulnDiscussion&gt;If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is impossible to achieve.

To ensure the veracity of audit data, the information system and/or the application must protect audit information from unauthorized deletion. This requirement can be achieved through multiple methods which will depend upon system architecture and design.

Some commonly employed methods include: ensuring log files enjoy the proper file system permissions utilizing file system protections; restricting access; and backing up log data to ensure log data is retained.

Applications providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights the user enjoys in order make access decisions regarding the deletion of audit data.

Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.

Deletion of database audit data could mask the theft of, or the unauthorized modification of, sensitive data stored in the database.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware Cassandra</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware Cassandra</dc:subject><dc:identifier>3179</dc:identifier></reference><ident system="http://iase.disa.mil/cci">CCI-000164</ident><fixtext fixref="F-79155r1_fix">Configure the Cassandra Server logs to have the correct group-owner.

At the command prompt, execute the following command:

# chown admin /storage/log/vcops/log/cassandra/&lt;file&gt;

Replace &lt;file&gt; with any file that has the incorrect group-owner.</fixtext><fix id="F-79155r1_fix" /><check system="C-72893r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_vRealize_Ops_Mgr_Cassandra_STIG.xml" /><check-content>Review the Cassandra Server settings to ensure logs have the correct group-owner.

At the command prompt, execute the following command:

# ls -lL /storage/log/vcops/log/cassandra

If any file is not group-owned by "admin", this is a finding.</check-content></check></Rule></Group></Benchmark>