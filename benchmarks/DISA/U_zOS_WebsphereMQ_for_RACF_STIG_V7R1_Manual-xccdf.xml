<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" id="zOS_WebsphereMQ_for_RACF_STIG" xml:lang="en" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2025-02-24">accepted</status><title>zOS WebsphereMQ for RACF Security Technical Implementation Guide</title><description>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.</description><notice id="terms-of-use" xml:lang="en"></notice><front-matter xml:lang="en"></front-matter><rear-matter xml:lang="en"></rear-matter><reference href="https://cyber.mil"><dc:publisher>DISA</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 1 Benchmark Date: 02 Apr 2025</plain-text><plain-text id="generator">3.5</plain-text><plain-text id="conventionsVersion">1.10.0</plain-text><version>7</version><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-224551" selected="true" /><select idref="V-224552" selected="true" /><select idref="V-224553" selected="true" /><select idref="V-224554" selected="true" /><select idref="V-224555" selected="true" /><select idref="V-224556" selected="true" /><select idref="V-224557" selected="true" /><select idref="V-224558" selected="true" /><select idref="V-224559" selected="true" /><select idref="V-224560" selected="true" /><select idref="V-224561" selected="true" /><select idref="V-224562" selected="true" /><select idref="V-224563" selected="true" /><select idref="V-224564" selected="true" /><select idref="V-224565" selected="true" /><select idref="V-224566" selected="true" /><select idref="V-224567" selected="true" /></Profile><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-224551" selected="true" /><select idref="V-224552" selected="true" /><select idref="V-224553" selected="true" /><select idref="V-224554" selected="true" /><select idref="V-224555" selected="true" /><select idref="V-224556" selected="true" /><select idref="V-224557" selected="true" /><select idref="V-224558" selected="true" /><select idref="V-224559" selected="true" /><select idref="V-224560" selected="true" /><select idref="V-224561" selected="true" /><select idref="V-224562" selected="true" /><select idref="V-224563" selected="true" /><select idref="V-224564" selected="true" /><select idref="V-224565" selected="true" /><select idref="V-224566" selected="true" /><select idref="V-224567" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-224551" selected="true" /><select idref="V-224552" selected="true" /><select idref="V-224553" selected="true" /><select idref="V-224554" selected="true" /><select idref="V-224555" selected="true" /><select idref="V-224556" selected="true" /><select idref="V-224557" selected="true" /><select idref="V-224558" selected="true" /><select idref="V-224559" selected="true" /><select idref="V-224560" selected="true" /><select idref="V-224561" selected="true" /><select idref="V-224562" selected="true" /><select idref="V-224563" selected="true" /><select idref="V-224564" selected="true" /><select idref="V-224565" selected="true" /><select idref="V-224566" selected="true" /><select idref="V-224567" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-224551" selected="true" /><select idref="V-224552" selected="true" /><select idref="V-224553" selected="true" /><select idref="V-224554" selected="true" /><select idref="V-224555" selected="true" /><select idref="V-224556" selected="true" /><select idref="V-224557" selected="true" /><select idref="V-224558" selected="true" /><select idref="V-224559" selected="true" /><select idref="V-224560" selected="true" /><select idref="V-224561" selected="true" /><select idref="V-224562" selected="true" /><select idref="V-224563" selected="true" /><select idref="V-224564" selected="true" /><select idref="V-224565" selected="true" /><select idref="V-224566" selected="true" /><select idref="V-224567" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-224551" selected="true" /><select idref="V-224552" selected="true" /><select idref="V-224553" selected="true" /><select idref="V-224554" selected="true" /><select idref="V-224555" selected="true" /><select idref="V-224556" selected="true" /><select idref="V-224557" selected="true" /><select idref="V-224558" selected="true" /><select idref="V-224559" selected="true" /><select idref="V-224560" selected="true" /><select idref="V-224561" selected="true" /><select idref="V-224562" selected="true" /><select idref="V-224563" selected="true" /><select idref="V-224564" selected="true" /><select idref="V-224565" selected="true" /><select idref="V-224566" selected="true" /><select idref="V-224567" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-224551" selected="true" /><select idref="V-224552" selected="true" /><select idref="V-224553" selected="true" /><select idref="V-224554" selected="true" /><select idref="V-224555" selected="true" /><select idref="V-224556" selected="true" /><select idref="V-224557" selected="true" /><select idref="V-224558" selected="true" /><select idref="V-224559" selected="true" /><select idref="V-224560" selected="true" /><select idref="V-224561" selected="true" /><select idref="V-224562" selected="true" /><select idref="V-224563" selected="true" /><select idref="V-224564" selected="true" /><select idref="V-224565" selected="true" /><select idref="V-224566" selected="true" /><select idref="V-224567" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-224551" selected="true" /><select idref="V-224552" selected="true" /><select idref="V-224553" selected="true" /><select idref="V-224554" selected="true" /><select idref="V-224555" selected="true" /><select idref="V-224556" selected="true" /><select idref="V-224557" selected="true" /><select idref="V-224558" selected="true" /><select idref="V-224559" selected="true" /><select idref="V-224560" selected="true" /><select idref="V-224561" selected="true" /><select idref="V-224562" selected="true" /><select idref="V-224563" selected="true" /><select idref="V-224564" selected="true" /><select idref="V-224565" selected="true" /><select idref="V-224566" selected="true" /><select idref="V-224567" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-224551" selected="true" /><select idref="V-224552" selected="true" /><select idref="V-224553" selected="true" /><select idref="V-224554" selected="true" /><select idref="V-224555" selected="true" /><select idref="V-224556" selected="true" /><select idref="V-224557" selected="true" /><select idref="V-224558" selected="true" /><select idref="V-224559" selected="true" /><select idref="V-224560" selected="true" /><select idref="V-224561" selected="true" /><select idref="V-224562" selected="true" /><select idref="V-224563" selected="true" /><select idref="V-224564" selected="true" /><select idref="V-224565" selected="true" /><select idref="V-224566" selected="true" /><select idref="V-224567" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-224551" selected="true" /><select idref="V-224552" selected="true" /><select idref="V-224553" selected="true" /><select idref="V-224554" selected="true" /><select idref="V-224555" selected="true" /><select idref="V-224556" selected="true" /><select idref="V-224557" selected="true" /><select idref="V-224558" selected="true" /><select idref="V-224559" selected="true" /><select idref="V-224560" selected="true" /><select idref="V-224561" selected="true" /><select idref="V-224562" selected="true" /><select idref="V-224563" selected="true" /><select idref="V-224564" selected="true" /><select idref="V-224565" selected="true" /><select idref="V-224566" selected="true" /><select idref="V-224567" selected="true" /></Profile><Group id="V-224551"><title>SRG-OS-000033</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224551r958408_rule" weight="10.0" severity="high"><version>ZWMQ0011</version><title>WebSphere MQ channel security must be implemented in accordance with security requirements.</title><description>&lt;VulnDiscussion&gt;WebSphere MQ Channel security can be configured to provide authentication, message privacy, and message integrity between queue managers. Secure Sockets Layer (SSL) uses encryption techniques, digital signatures and digital certificates to provide message privacy, message integrity and mutual authentication between clients and servers.

Failure to properly secure a WebSphere MQ channel may lead to unauthorized access. This exposure could compromise the availability, integrity, and confidentiality of some system services, applications, and customer data.

Satisfies: SRG-OS-000505, SRG-OS-000555&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">V-6958</ident><ident system="http://cyber.mil/legacy">SV-7259</ident><ident system="http://cyber.mil/cci">CCI-000068</ident><ident system="http://cyber.mil/cci">CCI-002421</ident><ident system="http://cyber.mil/cci">CCI-002423</ident><ident system="http://cyber.mil/cci">CCI-002450</ident><fixtext fixref="F-26222r868571_fix">Review the WebSphere MQ Screen interface invoked by the REXX CSQOREXX. Reviewing the channel's SSLCIPH setting.

Display the channel properties and look for the "SSL Cipher Specification" value.

Ensure that a FIPS 140-2 compliant value is shown.

ECDHE_ECDSA_AES_128_CBC_SHA256
ECDHE_ECDSA_AES_256_CBC_SHA384
ECDHE_RSA_AES_128_CBC_SHA256
ECDHE_RSA_AES_256_CBC_SHA384
TLS_RSA_WITH_3DES_EDE_CBC_SHA
TLS_RSA_WITH_AES_128_CBC_SHA
TLS_RSA_WITH_AES_128_CBC_SHA256
TLS_RSA_WITH_AES_256_CBC_SHA
TLS_RSA_WITH_AES_256_CBC_SHA256

Note that both ends of the channel must specify the same cipher specification. 

Repeat these steps for each queue manager ssid identified.</fixtext><fix id="F-26222r868571_fix" /><check system="C-26234r868570_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>Refer to the following report produced by the z/OS Data Collection:

- MQSRPT(ssid)

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

Collect the following Information for WebSphere MQ and MQSeries queue manager.

- If a WebSphere MQ queue manager communicates with a MQSeries queue manager, provide the WebSphere MQ queue manager and channel names used to connect with MQSeries.

Automated Analysis requires Additional Analysis.
Automated Analysis
Refer to the following report produced by the z/OS Data Collection:

- PDI(ZWMQ0011)

If the following guidelines are true for each channel definition displayed from the DISPLAY CHANNEL command, this is not a finding.

___ Verify that each WebSphere MQ channel is using SSL by checking for the SSLCIPH parameter, which must specify a FIPS 140-2 compliant value of the following: (Note: Both ends of the channel must specify the same cipher specification.)

ECDHE_ECDSA_AES_128_CBC_SHA256
ECDHE_ECDSA_AES_256_CBC_SHA384
ECDHE_RSA_AES_128_CBC_SHA256
ECDHE_RSA_AES_256_CBC_SHA384
TLS_RSA_WITH_3DES_EDE_CBC_SHA
TLS_RSA_WITH_AES_128_CBC_SHA
TLS_RSA_WITH_AES_128_CBC_SHA256
TLS_RSA_WITH_AES_256_CBC_SHA
TLS_RSA_WITH_AES_256_CBC_SHA256

___ Repeat the above step for each queue manager ssid identified.</check-content></check></Rule></Group><Group id="V-224552"><title>SRG-OS-000403</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224552r958868_rule" weight="10.0" severity="medium"><version>ZWMQ0012</version><title>WebSphere MQ channel security is not implemented in accordance with security requirements.</title><description>&lt;VulnDiscussion&gt;WebSphere MQ channel security can be configured to provide authentication, message privacy, and message integrity between queue managers. WebSphere MQ channels use SSL encryption techniques, digital signatures and digital certificates to provide message privacy, message integrity and mutual authentication between clients and servers.

Failure to properly secure a WebSphere MQ channel may lead to unauthorized access. This exposure could compromise the availability, integrity, and confidentiality of some system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">V-6980</ident><ident system="http://cyber.mil/legacy">SV-111903</ident><ident system="http://cyber.mil/cci">CCI-002470</ident><fixtext fixref="F-26223r870231_fix">Refer to the following report produced by the z/OS Data Collection:

- MQSRPT(ssid)

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier). 

1) Find the DISPLAY QMGR SSLKEYR command to locate the start of the Queue Manager definitions.
2) Verify that each WebSphere MQ queue manager is using a digital certificate by reviewing the SSLKEYR parameter to ensure that a keyring is identified, i.e., SSLKEYR(sslkeyring-id).
3) Issue the following RACF commands, where ssidCHIN is the lid for the WebSphere MQ Channel Initiator's userid and sslkeyring-id is obtained from the above action:

RACDCERT ID(ssidCHIN) LISTRING(sslkeyring-id)

NOTE: The sslkeyring-id is case sensitive.

The output will contain columns for Certificate Label Name and Cert Owner. Find the Cert Owner of ID(ssidCHIN). Use the Certificate Label Name for ID(ssidCHIN) in the following command:

RACDCERT ID(ssidCHIN) LIST(LABEL('Certificate Label Name'))

NOTE: The Certificate Label Name is case sensitive.

Review the Issuer's Name field in the resulting output for information on any of the following:

OU=PKI.OU=DoD.O=U.S. Government.C=US
OU=ECA.O=U.S. Government.C=US

4) Repeat these steps for each queue manager ssid identified.

To implement the requirements stated above, the following two items are provided which attempt to assist with (1) Technical "how to" information and (2) A DISA Point of contact for obtaining SSL certificates for CSD WebSphere MQ channels:

1. Review the information available on setting up SSL, Keyrings, and Digital Certificates in the RACF Security Administrator's Guide as well as the WebSphere MQ Security manual. Also review the information contained in the documentation provided as part of the install package from the DISA SSO Resource Management Factory (formerly Software Factory).

2. For information on obtaining an SSL certificate in the DISA CSD environment, send email inquiry to disaraoperations@disa.mil.</fixtext><fix id="F-26223r870231_fix" /><check system="C-26235r870230_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>a) Refer to the following report produced by the MQSeries/WebSphere MQ Data Collection:

- MQSERIES.RPT(MQSssid)

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier). To determine which release of MQSeries/WebSphere MQ, review MQSssid report for message CSQU000I.

Refer to the following item gathered from the MQSeries/WebSphere MQ Worksheet in the Preliminary Information Worksheets:

- DOC(MQWMQNFO)

b) If site is running MQSeries 5.2 or below, this is NOT APPLICABLE.

c) For each WebSphere MQ 5.3 and above, review the MQSssid report(s) and perform the following steps:

1) Find the DISPLAY QMGR SSLKEYR command to locate the start of the Queue Manager definitions.
2) Verify that each WebSphere MQ 5.3 queue manager is using a digital certificate by reviewing the SSLKEYR parameter to ensure that a keyring is identified, i.e., SSLKEYR(sslkeyring-id).
3) Issue the following RACF commands, where ssidCHIN is the lid for the WebSphere MQ Channel Initiator's userid and sslkeyring-id is obtained from the above action:

RACDCERT ID(ssidCHIN) LISTRING(sslkeyring-id)

NOTE: The sslkeyring-id is case sensitive.

The output will contain columns for Certificate Label Name and Cert Owner. Find the Cert Owner of ID(ssidCHIN). Use the Certificate Label Name for ID(ssidCHIN) in the following command:

RACDCERT ID(ssidCHIN) LIST(LABEL('Certificate Label Name'))

NOTE: The Certificate Label Name is case sensitive.

Review the Issuer's Name field in the resulting output for information on any of the following:

OU=PKI.OU=DoD.O=U.S. Government.C=US
OU=ECA.O=U.S. Government.C=US

4) Repeat these steps for each queue manager ssid identified.

d) If the all of the items in (c) above are true, there is no finding.

e) If any of the items in (c) above are untrue, this is a finding.</check-content></check></Rule></Group><Group id="V-224553"><title>SRG-OS-000480</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224553r959010_rule" weight="10.0" severity="medium"><version>ZWMQ0014</version><title>Production WebSphere MQ Remotes must utilize Certified Name Filters (CNF).</title><description>&lt;VulnDiscussion&gt;IBM WebSphere MQ can use a user ID associated with an ACP certificate as a channel user ID. When an entity at one end of an SSL channel receives a certificate from a remote connection, the entity asks The ACP if there is a user ID associated with that certificate. The entity uses that user ID as the channel user ID. If there is no user ID associated with the certificate, the entity uses the user ID under which the channel initiator is running. Without a validly defined Certificate Name Filter for the entity IBM WebSphere MQ will set the channel user ID to the default.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">V-31561</ident><ident system="http://cyber.mil/legacy">SV-41848</ident><ident system="http://cyber.mil/cci">CCI-001133</ident><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-26224r868583_fix">The responsible MQ System programmer(s) shall create and maintain a spread sheet that contains a list of all Production WebSphere MQ Remotes, associated individual USERIDs with corresponding valid Certified Name Filters (CNF). This documentation will be reviewed and validated annually by responsible MQ System programmer(s) and forwarded for approval by the ISSM.

The ISSO will define the associated USERIDs, the CNF, and grant the minimal need to know access, by granting only the required resources and Commands for each USERID in the ACP. See IBM WebSphere MQ Security manual for details on defining CNF for WebSphere MQ.

Generic access shall not be granted such as resource permission at the SSID. MQ resource level.</fixtext><fix id="F-26224r868583_fix" /><check system="C-26236r868582_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>Validate that the list of all Production WebSphere MQ Remotes exist, and contains approved Certified Name Filters and associated USERIDS.

If the filter(s) is (are) defined, accurate and has been approved by Vulnerability ICER0030 and the associated USERID(s) is only granted need to know permissions and authority to resources and commands, this is not a finding. 

If there is no Certificate Name Filter for WebSphere MQ Remotes this is a Finding.

Note: Improper use of CNF filters for MQ Series will result in the following Message ID.

CSQX632I found in the following example:

CSQX632I csect-name SSL certificate has no
associated user ID, remote channel
channel-name - channel initiator user ID
used
</check-content></check></Rule></Group><Group id="V-224554"><title>SRG-OS-000163</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224554r1070102_rule" weight="10.0" severity="medium"><version>ZWMQ0020</version><title>User timeout parameter values for WebSphere MQ queue managers are not specified in accordance with security requirements.
</title><description>&lt;VulnDiscussion&gt;Users signed on to a WebSphere MQ queue manager could leave their terminals unattended for long periods of time.  This may allow unauthorized individuals to gain access to WebSphere MQ resources and application data.  This exposure could compromise the availability, integrity, and confidentiality of some system services and application data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">V-3903</ident><ident system="http://cyber.mil/legacy">SV-3903</ident><ident system="http://cyber.mil/cci">CCI-000057</ident><ident system="http://cyber.mil/cci">CCI-001133</ident><fixtext fixref="F-26225r1070101_fix">Review the WebSphere MQ System Setup Guide and the information on the ALTER SECURITY command in the WebSphere MQ Script (MQSC) Command Reference.

Ensure the values for the TIMEOUT and INTERVAL parameters are specified in accordance with security requirements.</fixtext><fix id="F-26225r1070101_fix" /><check system="C-26237r1070100_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>Refer to the following report produced by the z/OS Data Collection:

-	MQSRPT(ssid)

Note:	ssid is the queue manager name (a.k.a., subsystem identifier).

Automated Analysis
Refer to the following report produced by the z/OS Data Collection:

-	PDI(ZWMQ0020)

Review the ssid report(s) and perform the following steps:

1. Find the DISPLAY SECURITY command to locate the start of the security parameter settings.
2. Review the CSQH015I and CSQH016I messages to determine the Timeout and Interval parameter settings respectively.
3. Repeat these steps for each queue manager ssid.

The standard values are:

TIMEOUT(15)
INTERVAL(5)

If the Timeout and Interval values conform to the standard values, this is not a finding.

If the Timeout and/or Interval values do not conform to the standard values, this is a finding.</check-content></check></Rule></Group><Group id="V-224555"><title>SRG-OS-000104</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224555r958482_rule" weight="10.0" severity="medium"><version>ZWMQ0030</version><title>WebSphere MQ started tasks are not defined in accordance with the proper security requirements.</title><description>&lt;VulnDiscussion&gt;Started tasks are used to execute WebSphere MQ queue manager services.  Improperly defined WebSphere MQ started tasks may result in inappropriate access to application resources and the loss of accountability.  This exposure could compromise the availability of some system services and application data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">SV-7526</ident><ident system="http://cyber.mil/legacy">V-3904</ident><ident system="http://cyber.mil/cci">CCI-000764</ident><fixtext fixref="F-26226r521025_fix">Each queue manager started task procedure xxxxMSTR and distributed queuing started task procedure xxxxCHIN will have a matching profile defined to the STARTED resource class.  Create a corresponding userid for each started task. The STC userids will be defined as PROTECTED userids. Queue manager and channel initiator started tasks will not be defined with the TRUSTED attribute.

The following sample contains commands to properly define the required Started Procs:

Note that this example uses "qmq1" as the value for ssid.

AU qmq1mstr NAME('STC, MQSERIES') NOPASS DFLTGRP(STC) OWNER(STC) DATA('MQSERIES QUEUE MANAGER PROC')      
                
AU qmq1chin NAME('STC, MQSERIES') NOPASSDFLTGRP(STC) OWNER(STC) DATA('MQSERIES DISTRIBUTED QUEUING CHANNEL INIT PROC')   

RDEF STARTED qmq1mstr.** UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('MAP qmq1mstr PROC TO qmq1mstr USERID') STDATA(USER(=MEMBER) GROUP(STC) TRACE(YES))

RDEF STARTED qmq1chin.** UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('MAP qmq1mstr PROC TO qmq1chin USERID') STDATA(USER(=MEMBER) GROUP(STC) TRACE(YES))

SETR RACL(STARTED) REFRESH

</fixtext><fix id="F-26226r521025_fix" /><check system="C-26238r521024_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>a)	Refer to the following reports produced by the RACF Data Collection:

-	DSMON.RPT(RACSPT)
-	RACFCMDS.RPT(LISTUSER)

Provide a list of all WebSphere MQ Subsystem Ids (Queue managers) and Release levels.

b)	Review WebSphere MQ started tasks and ensure the following items are in effect:

NOTE:	ssid is the queue manager name (a.k.a., subsystem identifier).
ssidMSTR is the name of a queue manager STC.
ssidCHIN is the name of a distributed queuing (a.k.a., channel initiator) STC.

1)	Each ssidMSTR and ssidCHIN started task is associated with a unique userid.
2)	All ssidMSTR and ssidCHIN started tasks are defined to the STARTED resource class.
3)	All ssidMSTR and ssidCHIN started tasks userid are defined as a PROTECTED.

c)	If both of the items in (b) are true, there is NO FINDING.

d)	If either item in (b) is untrue, this is a FINDING.</check-content></check></Rule></Group><Group id="V-224556"><title>SRG-OS-000080</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224556r1070081_rule" weight="10.0" severity="medium"><version>ZWMQ0040</version><title>WebSphere MQ all update and alter access to MQSeries/WebSphere MQ product and system data sets are not properly restricted.</title><description>&lt;VulnDiscussion&gt;MVS data sets provide the configuration, operational, and executable properties of WebSphere MQ. Some data sets are responsible for the security implementation of WebSphere MQ. Failure to properly protect these data sets may lead to unauthorized access. This exposure could compromise the availability, integrity, and confidentiality of system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">SV-3905</ident><ident system="http://cyber.mil/legacy">V-3905</ident><ident system="http://cyber.mil/cci">CCI-001499</ident><ident system="http://cyber.mil/cci">CCI-002234</ident><fixtext fixref="F-26227r1070080_fix">The systems programmer will have the ISSO ensure that all update and alter access to MQSeries/WebSphere MQ product and system data sets are restricted to WebSphere MQ administrators, systems programmers, and MQSeries/WebSphere MQ started tasks.

The installation requires that the following data sets be APF authorized. 

hlqual.SCSQAUTH
hlqual.SCSQLINK
hlqual.SCSQANLx
hlqual.SCSQSNL
hlqual.SCSQMVR1
hlqual.SCSQMVR2

Read access to data sets referenced by the CSQINP1, CSQINP2, and CSQXLIB DDs in the queue manager's procedure will be restricted to the queue manager userid, WebSphere MQ administrator, and systems programming personnel. Log all access to these data sets.

Write and allocate access to data set profiles protecting all page sets, logs, bootstrap data sets (BSDS), and data sets referenced by the CSQOUTX and CSQSNAP DDs in the queue manager's procedure will be restricted to the queue manager userid, WebSphere MQ administrator, and systems programming personnel. Log all write and allocate access to these data sets.

Allocate access to all archive data sets in the queue manager's procedure will be restricted to the queue manager userid, WebSphere MQ administrator, and systems programming personnel. Log all allocate access to these data sets.</fixtext><fix id="F-26227r1070080_fix" /><check system="C-26239r1070079_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>Refer to the following report produced by the ACP Data Collection:

-	SENSITVE.RPT(MQSRPT)

Ensure ACP data sets rules for MQSeries/WebSphere MQ system data sets (e.g., SYS2.MQM.) restrict access as follows:

Note: ssid is the queue manager name (a.k.a., subsystem identifier).

READ access to data sets referenced by the following DDnames is restricted to MQSeries/WebSphere MQ STCs, MQSeries/WebSphere MQ administrators, and system programming personnel. All access to these data sets is logged.

DDname       Procedure      Description
CSQINP1       ssidMSTR       Input parameters
CSQINP2       ssidMSTR       Input parameters
CSQXLIB       ssidCHIN         User exit library

Note: WRITE/UPDATE and/or ALLOCATE/ALTER access to these data sets is restricted to MQSeries/WebSphere MQ administrators and systems programming personnel.

WRITE/UPDATE and/or ALLOCATE/ALTER access to data sets referenced by the following DDnames is restricted to MQSeries/WebSphere MQ STCs, MQSeries/WebSphere MQ administrators, and systems programming personnel. All WRITE and ALLOCATE access to these data sets is logged.

DDname       Procedure       Description
CSQPxxxx     ssidMSTR         Page data sets
BSDSx           ssidMSTR         Bootstrap data sets
CSQOUTx     ssidMSTR         SYSOUT data sets
CSQSNAP     ssidMSTR         DUMP data set
(See note)   ssidMSTR          Log data sets

Note: To determine the log data set names, review the JESMSGLG file of the ssidMSTR active task(s). Find CSQJ001I messages to obtain DSNs.
 
ALLOCATE/ALTER access to archive data sets is restricted to MQSeries/WebSphere MQ STCs, MQSeries/WebSphere MQ administrator, and system programming personnel. All ALLOCATE/ALTER access to these data sets is logged.

Note: To determine the archive data sets names, review the JESMSGLG file of the ssidMSTR active task(s). Find the CSQY122I message to obtain the ARCPRFX1 and ARCPRFX2 DSN HLQs.

Except for the specific data set requirements just mentioned, WRITE/UPDATE and/or ALLOCATE/ALTER access to all other MQSeries/WebSphere MQ system data sets is restricted to the MQSeries/WebSphere MQ administrator and system programming personnel.

If all the items above are true, this is not a finding.

If any item above is untrue, this is a finding.</check-content></check></Rule></Group><Group id="V-224557"><title>SRG-OS-000080</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224557r1056162_rule" weight="10.0" severity="medium"><version>ZWMQ0049</version><title>WebSphere MQ resource classes must be properly activated for security checking by the ESM.</title><description>&lt;VulnDiscussion&gt;WebSphere MQ resources allow for the control of administrator functions, connections, commands, queues, processes, and namelists. Some resources provide the ability to disable or bypass security checking. Failure to ensure the classes have been made ACTIVE under RACF will prevent RACF from enforcing security rules. This exposure could compromise the availability, integrity, and confidentiality of system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">V-6959</ident><ident system="http://cyber.mil/legacy">SV-7534</ident><ident system="http://cyber.mil/cci">CCI-000213</ident><ident system="http://cyber.mil/cci">CCI-002358</ident><fixtext fixref="F-26228r1056162_fix">Ensure that all WebSphere MQ resources are active and properly defined.

Ensure the following WebSphere MQ resource classes are active:

GMQADMIN
GMQNLIST
GMQPROC
GMQQUEUE
MQADMIN
MQCMDS
MQCONN
MQNLIST
MQPROC
MQQUEUE

When SCYCASE is set to mixed, CLASMAP Definitions must include the following entries:

GMXADMIN
GMXNLIST
GMXPROC
GMXQUEUE
GMXTOPIC
MXADMIN
MXNLIST
MXPROC
MXQUEUE
MXTOPIC

NOTE: If MQADMIN or MXADMIN resource classes are not active, no security checking is performed.

The following sample contains commands to activate the required classes:

SETR CLASSACT(MQADMIN MQCMDS MQCONN)
SETR CLASSACT(MQNLIST MQPROC MQQUEUE)
SETR CLASSACT(MXADMIN MXNLIST MXPROC MXQUEUE)</fixtext><fix id="F-26228r1056162_fix" /><check system="C-26240r1050693_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>Refer to the following reports produced by the RACF Data Collection:

- RACFCMDS.RPT(SETROPTS)
- DSMON.RPT(RACCDT) - Alternate list of active resource classes

Automated Analysis
Refer to the following report produced by the RACF Data Collection:

- PDI(ZWMQ0049)

Ensure the following WebSphere MQ resource classes are active:

GMQADMIN
GMQNLIST
GMQPROC
GMQQUEUE
MQADMIN
MQCMDS
MQCONN
MQNLIST
MQPROC
MQQUEUE

If the classes noted above are not active, this is a finding.

When SCYCASE is set to mixed, CLASMAP Definitions must include the following entries:

GMXADMIN
GMXNLIST
GMXPROC
GMXQUEUE
GMXTOPIC
MXADMIN
MXNLIST
MXPROC
MXQUEUE
MXTOPIC

If when SCYCASE is set to mixed, CLASMAP Definitions do not include the entries shown above, this is a finding.

NOTE: If MQADMIN or MXADMIN resource classes are not active, no security checking is performed.</check-content></check></Rule></Group><Group id="V-224558"><title>SRG-OS-000080</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224558r1050698_rule" weight="10.0" severity="high"><version>ZWMQ0051</version><title>WebSphere MQ switch profiles must be properly defined to the appropriate ADMIN class.</title><description>&lt;VulnDiscussion&gt;WebSphere MQ resources allow for the control of administrator functions, connections, commands, queues, processes, and namelists. Some resources provide the ability to disable or bypass security checking. Failure to properly protect WebSphere MQ resources may result in unauthorized access. This exposure could compromise the availability, integrity, and confidentiality of system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">SV-7538</ident><ident system="http://cyber.mil/legacy">V-6960</ident><ident system="http://cyber.mil/cci">CCI-000213</ident><fixtext fixref="F-26229r1050697_fix">Ensure all switch profiles are special MQSeries/WebSphere MQ profiles that are used to turn on/off security checking for a type of resource. Due to the security exposure this creates, no profiles with the first two qualifiers of ssid.NO will be defined to the MQADMIN or MXADMIN class, with one exception. Due to the fact that (1) all sensitive MQSeries/WebSphere MQ commands are restricted to queue managers, channel initiators, and designated systems personnel, and (2) no command resource checking is performed on DISPLAY commands, at the discretion of the ISSO, a ssid.NO.CMD.RESC.CHECKS switch profile may be defined to the MQADMIN or MXADMIN class.

1. Identify if any switch profiles exist using the sample search command:

SR CLASS(MQADMIN) NOMASK FILTER(*.NO.**)

2. Use the "RDEL MQADMIN &lt;SwitchProfileName&gt;" to remove the profile and follow up with a "SETR RACL(MQADMIN) REF".

3. An additional refresh to an active WebSphere MQ queue manager may be required. A sample is shown below using the value QMD1 as the queue manager name.

From the Console:

&gt;QMD1 REFRESH SECURITY(*)

</fixtext><fix id="F-26229r1050697_fix" /><check system="C-26241r1050696_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>a) Refer to the following report produced by the Z/OS Data Collection:

- MQSRPT(ssid)

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

Automated Analysis requires Additional Analysis.
Automated Analysis
Refer to the following report produced by the z/OS Data Collection:

- PDI(ZWMQ0051)

b) Review the Security switches identified in response to the DISPLAY SECURITY command in each ssid report(s). If all of the following switches specify ON, there is no finding.

SUBSYSTEM
CONNECTION
COMMAND
CONTEXT
ALTERNATE USER
PROCESS
NAMELIST
QUEUE
COMMAND RESOURCES

c) If SUBSYSTEM specifies OFF, this is a finding with a severity of Category I.

d) If any of the other above switches specify OFF (other than the exception mentioned below), this is a finding. Downgrade the severity to a Category II.

e) If COMMAND RESOURCE Security switch specifies OFF, there is no finding.

NOTE: At the discretion of the ISSO, COMMAND RESOURCE Security switch may specify OFF by defining ssid.NO.CMD.RESC.CHECKS in the MQADMIN (or MXADMIN if SCYCASE is setto MIXED) resource class.</check-content></check></Rule></Group><Group id="V-224559"><title>SRG-OS-000080</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224559r1070084_rule" weight="10.0" severity="medium"><version>ZWMQ0052</version><title>WebSphere MQ connection class resource definitions must be protected in accordance with security.</title><description>&lt;VulnDiscussion&gt;WebSphere MQ resources allow for the control of administrator functions, connections, commands, queues, processes, and namelists. Some resources provide the ability to disable or bypass security checking. Failure to properly protect WebSphere MQ resources may result in unauthorized access. This exposure could compromise the availability, integrity, and confidentiality of system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">V-6962</ident><ident system="http://cyber.mil/legacy">SV-7541</ident><ident system="http://cyber.mil/cci">CCI-000213</ident><fixtext fixref="F-26230r1070083_fix">Review the following connection resources defined to the MQCONN resource class or MXCONN resource class if SCYCASE is set to MIXED:

Resource       Authorized Users
ssid.BATCH       TSO and batch job userids
ssid.CICS       CICS region userids
ssid.IMS       IMS region userids
ssid.CHIN       Channel initiator userids

Note: ssid is the queue manager name (a.k.a., subsystem identifier).

For all connection resources defined to the MQCONN resource class, ensure the following items are in effect:

Note: If a resource profile is not defined for a particular security check, and a user issues a request that would involve making that check, MQSeries/WebSphere MQ denies access.

1. Resource profiles are defined with a UACC(NONE).
2. Access authorization to these connections restricts access to the appropriate users as indicated above.
3. All access FAILUREs are logged.

A set of sample commands is provided below to implement the minimum profiles necessary for proper security. Note that the IMS and/or CICS profiles can be omitted if those products do not run on the target system.

/* THE FOLLOWING PROFILE FORCES GRANULAR PROFILES DEFINITIONS */
RDEF MQCONN ** UACC(NONE) OWNER(ADMIN) AUDIT(FAILURES(READ)) DATA('MQCONN DENY-BY-DEFAULT PROFILE')

RDEF MQCONN &lt;ssid&gt;.BATCH UACC(NONE) OWNER(ADMIN) AUDIT(FAILURES(READAUDIT(FAILURES(READ)) DATA('REQUIRED FOR ZWMQ0052')
PE &lt;ssid&gt;.BATCH CL(MQCONN) ID(&lt;applicableTSO&amp;batchUsers&gt;)

RDEF MQCONN &lt;ssid&gt;.CICS UACC(NONE) OWNER(ADMIN) AUDIT(FAILURES(READ)) DATA('REQUIRED FOR ZWMQ0052')
PE &lt;ssid&gt;.CICS CL(MQCONN) ID(&lt;CICSRegionUserids&gt;)

RDEF MQCONN &lt;ssid&gt;.IMS UACC(NONE) OWNER(ADMIN) AUDIT(FAILURES(READ)) DATA('REQUIRED FOR ZWMQ0052')
PE &lt;ssid&gt;.IMS CL(MQCONN) ID(&lt;IMSRegionUserids&gt;)

RDEF MQCONN &lt;ssid&gt;.CHIN UACC(NONE) OWNER(ADMIN) AUDIT(FAILURES(READ)) DATA('REQUIRED FOR ZWMQ0052')
PE &lt;ssid&gt;.CHIN CL(MQCONN) ID(&lt;WebsphereMQCHINUsrids&gt;)

SETR RACL(MQCONN) REF

Note that an additional WebSphere MQ Refresh may be required for active queue managers. This is done from the CONSOLE:

The example is for a queue manager Named QMD1:
&gt;QMD1 REFRESH SECURITY(*)</fixtext><fix id="F-26230r1070083_fix" /><check system="C-26242r1070082_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>Refer to the following reports produced by the RACF Data Collection:

-	SENSITVE.RPT(MQCONN)

Review the following connection resources defined to the MQCONN resource class or MXCONN resource class if SCYCASE is set to MIXED:

Resource       Authorized Users
ssid.BATCH       TSO and batch job userids
ssid.CICS       CICS region userids
ssid.IMS       IMS region userids
ssid.CHIN       Channel initiator userids

Note: ssid is the queue manager name (a.k.a., subsystem identifier).

For all connection resources defined to the MQCONN resource class or MXCONN resource class if SCYCASE is set to MIXED, ensure the following items are in effect:

Note: If a resource profile is not defined for a particular security check, and a user issues a request that would involve making that check, MQSeries/WebSphere MQ denies access.

1. Resource profiles are defined with a UACC(NONE).
2. Access authorization to these connections restricts access to the appropriate users as indicated above.
3. All access FAILUREs are logged.  

If all of the items above are true, this is not a finding.

If any item above is untrue, this is a finding.</check-content></check></Rule></Group><Group id="V-224560"><title>SRG-OS-000104</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224560r958482_rule" weight="10.0" severity="medium"><version>ZWMQ0053</version><title>WebSphere MQ dead letter and alias dead letter queues are not properly defined.</title><description>&lt;VulnDiscussion&gt;WebSphere MQ resources allow for the control of administrator functions, connections, commands, queues, processes, and namelists. Some resources provide the ability to disable or bypass security checking. Failure to properly protect WebSphere MQ resources may result in unauthorized access. This exposure could compromise the availability, integrity, and confidentiality of system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">SV-7267</ident><ident system="http://cyber.mil/legacy">V-6964</ident><ident system="http://cyber.mil/cci">CCI-000764</ident><ident system="http://cyber.mil/cci">CCI-001762</ident><fixtext fixref="F-26231r868594_fix">The systems programmer responsible for supporting MQSeries/WebSphere MQ will ensure that the dead-letter queue and its alias are properly defined.

The following scenario describes how to securely define a dead-letter queue:

(1) Define the real dead-letter queue with attributes PUT(ENABLED) and GET(ENABLED).

(2) Give update authority for the dead-letter queue to CKTI (the MQSeries/WebSphere MQ-supplied CICS task initiator), channel initiators, and any automated application used for dead-letter queue maintenance.

(3) Define an alias queue that resolves to the real dead-letter queue, but give the alias queue the attributes PUT(ENABLED) and GET(DISABLED).

(4) To put a message on the dead-letter queue, an application uses the alias queue. The application does the following:

(a) Retrieve the name of the real dead-letter queue. To do this, it opens the queue manager object using MQOPEN, and then issues an MQINQ to get the dead-letter queue name.

(b) Build the name of the alias queue by appending the characters ".PUT" to this name, in this case, ssid.DEAD.QUEUE.PUT.

(c) Open the alias queue, ssid.DEAD.QUEUE.PUT.

(d) Put the message on the real dead-letter queue by issuing an MQPUT against the alias queue.

(5) Give the userid associated with the application update authority to the alias, but no access to the real dead-letter queue.

NOTE: If an alias queue is not used in place of the dead-letter queue, then the ACP rules for the dead-letter queue will be coded to restrict unauthorized users and systems from reading the messages on the file.

Undeliverable messages can be routed to a dead-letter queue. Two levels of access should be established for these queues. The first level allows applications, as well as some MQSeries/WebSphere MQ objects, to put messages to this queue. The second level restricts the ability to get messages from this queue and protects sensitive data. This will be accomplished by defining an alias queue that resolves to the real dead-letter queue, but defines the alias queue with the attributes PUT(ENABLED) and GET(DISABLED). The ability to get messages from the dead-letter queue will be restricted to message channel agents (MCAs), CKTI (MQSeries/WebSphere MQ-supplied CICS task initiator), channel initiators utility, and any automated application used for dead-letter queue maintenance.</fixtext><fix id="F-26231r868594_fix" /><check system="C-26243r868591_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>a) Refer to the following report produced by the z/OS Data Collection:

- MQSRPT(ssid)

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

b) Review the ssid report(s) and perform the following steps:

1) Find the DISPLAY QMGR DEADQ command to locate the start of the dead-letter queue information. Review the DEADQ parameter to obtain the name of the real dead-letter queue.

2) From the top of the report, find the QUEUE(dead-letter.queue.name) entry to locate the start of the real dead-letter queue definition. Review the GET and PUT parameters to determine their values, and ensure they conform to the specified security requirements.

The  standard values are:

GET(ENABLED)
PUT(ENABLED)

NOTE: Dead-letter.queue.name is the value of the DEADQ parameter determined in Step 1.
 
3) From the top of the report, find the QUEUE(dead-letter.queue.name.PUT) entry to locate the start of the alias dead-letter queue definition. Review the GET and PUT parameters to determine their values, and ensure they conform to those specified in the security requirements.

The standard values are:

GET(DISABLED)
PUT(ENABLED)

NOTE 1: Dead-letter.queue.name is the value of the DEADQ parameter determined in Step 1.

NOTE 2: The TARGQ parameter value for the alias queue will be the real dead letter queue name.

NOTE 3: If an alias queue is not used in place of the dead-letter queue, then the ACP rules for the dead-letter queue must be coded to restrict unauthorized users and systems from reading the messages on the file.

c) If all of the items in (b) are true, there is no finding.

d) If any item in (b) is untrue, this is a finding.</check-content></check></Rule></Group><Group id="V-224561"><title>SRG-OS-000080</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224561r1050704_rule" weight="10.0" severity="medium"><version>ZWMQ0054</version><title>WebSphere MQ MQQUEUE (Queue) resource profiles defined to the appropriate class must be protected in accordance with security requirements.</title><description>&lt;VulnDiscussion&gt;WebSphere MQ resources allow for the control of administrator functions, connections, commands, queues, processes, and namelists. Some resources provide the ability to disable or bypass security checking. Failure to properly protect WebSphere MQ resources may result in unauthorized access. This exposure could compromise the availability, integrity, and confidentiality of system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">V-6965</ident><ident system="http://cyber.mil/legacy">SV-7544</ident><ident system="http://cyber.mil/cci">CCI-000213</ident><fixtext fixref="F-26232r1050703_fix">For all queue resources defined to the MQQUEUE, GMQQUEUE, MXQUEUE, or GMXQUEUE resource classes, ensure the following items are in effect:

For all queues identified by the DISPLAY QUEUE(*) ALL command in the MQSRPT(ssid), these queues will be prefixed by ssid to identify the resources to be protected. Ensure these queue resources are defined to the MQQUEUE or GMQQUEUE resource classes. If the following guidance is true, this is not a finding.

1) Resource profiles are defined with a UACC(NONE).

2) For message queues (i.e., ssid.queuename), access authorization restricts access to users requiring the ability to get messages from and put messages to message queues. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list. Decentralized MQ administrators, non-DECC datacenter users, can have up to ALTER access to the user Message Queues.

3) For system queues (i.e., ssid.SYSTEM.queuename), access authorization restricts UPDATE and/or ALTER access to WebSphere MQ STCs, WebSphere MQ administrators, systems programming personnel, and CICS regions running WebSphere MQ applications.

4) For the following system queues, ensure that UPDATE access is restricted to auditors and users that require access to review message queues.
ssid.SYSTEM.COMMAND.INPUT
ssid.SYSTEM.COMMAND.REPLY
ssid.SYSTEM.CSQOREXX.*
ssid.SYSTEM.CSQUTIL.*

5) For the real dead-letter queue (to determine queue name refer to ZWMQ0053), ALTER access authorization restricts access to WebSphere MQ STCs, WebSphere MQ administrators, CICS regions running WebSphere MQ applications, and any automated application used for dead-letter queue maintenance.

6) For the alias dead-letter queue (to determine queue name, refer to ZWMQ0053), UPDATE access authorization restricts access to users requiring the ability to put messages to the dead-letter queue. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list.

Example:

RDEF MQQUEUE &lt;ssid&gt;.SYSTEM.** UACC(NONE) OWNER(ADMIN) AUDIT(FAILURE(READ)) DATA('REQUIRED FOR ZWMQ0054')
PE &lt;ssid&gt;.SYSTEM.** CL(MQQUEUE) ID(&lt;RestrictedUsersAsSpecifiecAbove&gt;)

RDEF MQQUEUE &lt;ssid&gt;.&lt;qname&gt;.** UACC(NONE) OWNER(ADMIN) AUDIT(FAILURE(READ)) DATA('REQUIRED FOR ZWMQ0054')
PE &lt;ssid&gt;.&lt;qname&gt; CL(MQQUEUE) ID(&lt;AsSpecifiedAbove&gt;)

RDEF MQQUEUE &lt;ssid&gt;.&lt;RealDeadLetterQue&gt;.** UACC(NONE) OWNER(ADMIN) AUDIT(FAILURE(READ)) DATA('REQUIRED FOR ZWMQ0054')
PE &lt;ssid&gt;.&lt;RealDeadLetterQue&gt; CL(MQQUEUE) ID(&lt;AsSpecifiedAbove&gt;)

RDEF MQQUEUE &lt;ssid&gt;.&lt;AliasDeadLetterQue&gt;.** UACC(NONE) OWNER(ADMIN) AUDIT(FAILURE(READ)) DATA('REQUIRED FOR ZWMQ0054')
PE &lt;ssid&gt;.&lt;AliasDeadLetterQue&gt; CL(MQQUEUE) ID(&lt;AsSpecifiedAbove&gt;)

SETR RACL(MQQUEUE) REF</fixtext><fix id="F-26232r1050703_fix" /><check system="C-26244r1050702_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>Refer to the following report produced by the z/OS Data Collection:

- MQSRPT(ssid)

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier). 

Refer to the following reports produced by the Data Set and Resource Data Collection:

- SENSITVE.RPT(MQQUEUE)

For all queues identified by the DISPLAY QUEUE(*) ALL command in the MQSRPT(ssid), these queues will be prefixed by ssid to identify the resources to be protected. Ensure these queue resources are defined to the MQQUEUE, GMQQUEUE, MXQUEUE, or GMXQUUE resource classes. Ensure the following items are in effect:

1) Resource profiles are defined with a UACC(NONE).

2) For message queues (i.e., ssid.queuename), access authorization restricts access to users requiring the ability to get messages from and put messages to message queues. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list.

3) For system queues (i.e., ssid.SYSTEM.queuename), ALTER access authorization restricts access to WebSphere MQ STCs, WebSphere MQ administrators, systems programming personnel, and CICS regions running WebSphere MQ applications.

4) For the following system queues, ensure that UPDATE access is restricted to WebSphere MQ STCs, WebSphere MQ administrators, systems programming personnel, CICS regions running WebSphere MQ applications, auditors, and users that require access to review message queues:
ssid.SYSTEM.COMMAND.INPUT
ssid.SYSTEM.COMMAND.REPLY
ssid.SYSTEM.CSQOREXX.*

5) For system queues (i.e., ssid.SYSTEM.CSQUTIL.*), ensure that UPDATE access is restricted to WebSphere MQ STCs, WebSphere MQ administrators, systems programming personnel, CICS regions running WebSphere MQ applications, and auditors.

6) For the real dead-letter queue (to determine queue name refer to ZWMQ0053), ALTER access authorization restricts access to WebSphere MQ STCs, WebSphere MQ administrators, CICS regions running WebSphere MQ applications, and any automated application used for dead-letter queue maintenance.

7) For the alias dead-letter queue (to determine queue name, refer to ZWMQ0053), UPDATE access authorization restricts access to users requiring the ability to put messages to the dead-letter queue. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list.</check-content></check></Rule></Group><Group id="V-224562"><title>SRG-OS-000080</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224562r1050707_rule" weight="10.0" severity="medium"><version>ZWMQ0055</version><title>WebSphere MQ Process resource profiles defined in the appropriate Class must be protected in accordance with security requirements.</title><description>&lt;VulnDiscussion&gt;WebSphere MQ Process resources allow for the control of processes. Failure to properly protect WebSphere MQ resources may result in unauthorized access. This exposure could compromise the availability, integrity, and confidentiality of system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">SV-7546</ident><ident system="http://cyber.mil/legacy">V-6966</ident><ident system="http://cyber.mil/cci">CCI-000213</ident><fixtext fixref="F-26233r1050706_fix">Process security validates userids authorized to issue MQSeries/WebSphere MQ inquiries on process definitions. A process definition object defines an application that is started in response to a trigger event on a queue manager. Process security will be active, and all profiles ssid.processname will be defined to the appropriate class. Restrict read access to those userids requiring access to make process inquiries.

For all process resources (i.e., ssid.processname) defined to the MQPROC, GMQPROC, MXPROC, and GMXPROC resource classes, ensure the following items are in effect:

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

1) Resource profiles are defined with a UACC(NONE).
2) Access authorization restricts access to users requiring the ability to make process inquires. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list.

A set of sample commands are provided below to implement the minimum profiles necessary for proper security.  

/* THE FOLLOWING PROFILE FORCES GRANULAR PROFILES DEFINITIONS */
RDEF MQPROC ** UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('MQPROC DENY-BY-DEFAULT PROFILE')

RDEF MQPROC &lt;ssid&gt;.** UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('REQUIRED FOR ZWMQ0055')
PE &lt;ssid&gt;.** CL(MQPROC) ID(&lt;ApplicableUsers&gt;)

SETR RACL(MQPROC) REF

Note that an additional WebSphere MQ Refresh may be required for active queue managers. This is done from the CONSOLE:

The example is for a Que Manager Named QMD1
&gt;QMD1 REFRESH SECURITY(*)

The following is a sample of the commands required to allow a group (GRP1) to inquire on processes beginning with the letter V on queue manager (QM1):

RDEFINE MQPROC QM1.V* UACC(NONE) AUDIT(ALL(READ))
PERMIT QM1.V* CLASS(MQPROC) ID(GRP1) ACCESS(READ)</fixtext><fix id="F-26233r1050706_fix" /><check system="C-26245r1050705_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>a) Refer to the following reports produced by the RACF Data Collection:

- SENSITVE.RPT(MQPROC)

b) For all process resources (i.e., ssid.processname) defined to the MQPROC, GMQPROC, MXPROC, or GMXPROC resource classes, ensure the following items are in effect:

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

1) Resource profiles are defined with a UACC(NONE).
2) Access authorization restricts access to users requiring the ability to make process inquires. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list.

c) If both of the items in (b) are true, there is no finding.

d) If either item in (b) is untrue, this is a finding.
</check-content></check></Rule></Group><Group id="V-224563"><title>SRG-OS-000080</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224563r1050710_rule" weight="10.0" severity="medium"><version>ZWMQ0056</version><title>WebSphere MQ Namelist resource profiles defined in the appropriate class must be protected in accordance with security requirements.</title><description>&lt;VulnDiscussion&gt;WebSphere MQ resources allow for the control of administrator functions, connections, commands, queues, processes, and namelists. Some resources provide the ability to disable or bypass security checking. Failure to properly protect WebSphere MQ resources may result in unauthorized access. This exposure could compromise the availability, integrity, and confidentiality of system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">V-6967</ident><ident system="http://cyber.mil/legacy">SV-7548</ident><ident system="http://cyber.mil/cci">CCI-000213</ident><fixtext fixref="F-26234r1050709_fix">A namelist is a MQSeries/WebSphere MQ object that contains a list of queue names. Namelist security validates userids authorized to inquire on namelists. Namelist security will be active, and all profiles ssid.namelist will be defined to the MQNLIST, GMQNLIST, MXNLIST, or GMXNLIST classes with UACC(NONE) specified. Restrict read access to those userids requiring access to make namelist inquiries.

For all namelist resources (i.e., ssid.namelist) defined to the MQNLIST, GMQNLIST, MXNLIST, or GMXNLIST resource classes, ensure the following items are in effect:

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

1) Resource profiles are defined with a UACC(NONE).
2) Access authorization restricts access to users requiring the ability to make namelist inquires. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list.

A set of sample commands are provided below to implement the minimum profiles necessary for proper security.  

/* THE FOLLOWING PROFILE FORCES GRANULAR PROFILES DEFINITIONS */
RDEF MQNLIST ** UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('MQCONN DENY-BY-DEFAULT PROFILE')

RDEF MQNLIST &lt;ssid&gt;.** UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('REQUIRED FOR ZWMQ0056')
PE &lt;ssid&gt;.** CL(MQNLIST) ID(&lt;applicable&gt;)

SETR RACL(MQNLIST) REF

Note that an additional WebSphere MQ Refresh may be required for active queue managers. This is done from the CONSOLE:

The example is for a queue manager named QMD1:
&gt;QMD1 REFRESH SECURITY(*)</fixtext><fix id="F-26234r1050709_fix" /><check system="C-26246r1050708_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>a) Refer to the following reports produced by the RACF Data Collection:

- SENSITVE.RPT(MQNLIST)

b) For all namelist resources (i.e., ssid.namelist) defined to the MQNLIST, GMQNLIST, MXNLIST, or FMXNLIST resource classes, ensure the following items are in effect:

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

1) Resource profiles are defined with a UACC(NONE).
2) Access authorization restricts access to users requiring the ability to make namelist inquires. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list.

c) If both of the items in (b) are true, there is no finding.

d) If either item in (b) is untrue, this is a finding.</check-content></check></Rule></Group><Group id="V-224564"><title>SRG-OS-000080</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224564r1050713_rule" weight="10.0" severity="medium"><version>ZWMQ0057</version><title>WebSphere MQ Alternate User resources defined to appropriate ADMIN resource class must be protected in accordance with security requirements.</title><description>&lt;VulnDiscussion&gt;WebSphere MQ resources allow for the control of administrator functions, connections, commands, queues, processes, and namelists. Some resources provide the ability to disable or bypass security checking. Failure to properly protect WebSphere MQ resources may result in unauthorized access. This exposure could compromise the availability, integrity, and confidentiality of system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">SV-7550</ident><ident system="http://cyber.mil/legacy">V-6969</ident><ident system="http://cyber.mil/cci">CCI-000213</ident><fixtext fixref="F-26235r1050712_fix">Alternate userid security allows access to be requested under another userid. Alternate userid security will be active, and all profiles ssid.ALTERNATE.USER.alternateuserid will be defined to the MQADMIN or MXADMIN class with UACC(NONE) specified. Restrict update access to those userids requiring access to alternate userids.

For all alternate user resources (i.e., ssid.ALTERNATE.USER.alternateuserid) defined to the MQADMIN or MXADMIN resource class, ensure the following items are in effect:

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

1) Resource profiles are defined with a UACC(NONE).
2) Access authorization restricts access to users requiring the ability to use the alternate userid. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list.

A set of sample commands are provided below to implement the minimum profiles necessary for proper security.  

/* THE FOLLOWING PROFILE FORCES GRANULAR PROFILES DEFINITIONS */
RDEF MQADMIN ** UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('MQADMIN DENY-BY-DEFAULT PROFILE')

RDEF MQADMIN &lt;ssid&gt;.ALTERNATE.USER.** UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('MQADMIN DENY-BY-DEFAULT for ALT USER PROFILE')

The following is a sample of the commands required to allow payroll server (PAYSRV1) to specify alternate userids starting with the characters PS on queue manager (QM1):

RDEFINE MQADMIN QMD1.ALTERNATE.USER.PS* UACC(NONE) AUDIT(ALL)

PERMIT QMD1.ALTERNATE.USER.PS* CLASS(MQADMIN) ID(PAYSRV1) ACCESS(UPDATE)

SETR RACL(MQADMIN) REF

Note that an additional WebSphere MQ Refresh may be required for active queue managers. This is done from the CONSOLE:

The example is for a queue manager named QMD1:
&gt;QMD1 REFRESH SECURITY(*)</fixtext><fix id="F-26235r1050712_fix" /><check system="C-26247r1050711_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>a) Refer to the following reports produced by the RACF Data Collection:

- SENSITVE.RPT(MQADMIN)

b) For all alternate user resources (i.e., ssid.ALTERNATE.USER.alternateuserid) defined to the MQADMIN or MXADMIN resource class, ensure the following items are in effect:

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

1) Resource profiles are defined with a UACC(NONE).
2) Access authorization restricts access to users requiring the ability to use the alternate userid. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list.

c) If both of the items in (b) are true, there is no finding.

d) If either item in (b) is untrue, this is a finding.</check-content></check></Rule></Group><Group id="V-224565"><title>SRG-OS-000080</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224565r1050716_rule" weight="10.0" severity="medium"><version>ZWMQ0058</version><title>WebSphere MQ context resources defined to the appropriate ADMIN resource class must be protected in accordance with security requirements.</title><description>&lt;VulnDiscussion&gt;Context security validates whether a userid has authority to pass or set identity and/or origin data for a message. Context security will be active to avoid security exposure.

This exposure could compromise the availability, integrity, and confidentiality of system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">SV-7552</ident><ident system="http://cyber.mil/legacy">V-6971</ident><ident system="http://cyber.mil/cci">CCI-000213</ident><fixtext fixref="F-26236r1050715_fix">Context security validates whether a userid has authority to pass or set identity and/or origin data for a message. Context security will be active, and all profiles ssid.CONTEXT will be defined to the appropriate ADMIN class with UACC(NONE) specified, where ssid is the queue manager name.

Read access is required when the PASS option is specified for an MQOPEN or MQPUT1. Update or control access is required when the SET or OUTPUT option is specified.

For all context resources (i.e., ssid.CONTEXT) defined to the MQADMIN or MXADMIN resource class, ensure the following items are in effect:

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

1) Resource profiles are defined with a UACC(NONE).
2) Access authorization restricts access to users requiring the ability to pass or set identity and/or origin data for a message. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list.

A set of sample commands are provided below to implement the minimum profiles necessary for proper security.  

/* THE FOLLOWING PROFILE FORCES GRANULAR PROFILES DEFINITIONS */
RDEF MQADMIN ** UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('MQADMIN DENY-BY-DEFAULT PROFILE')

RDEF MQADMIN &lt;ssid&gt;.CONTEXT UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('MQADMIN PROFILE REQUIRED FOR CONTEXT SECURITY')

The following is a sample of the commands required to allow a systems programming group (SYS1) to offload and reload messages for queue manager (QMD1):

PERMIT QMD1.CONTEXT CLASS(MQADMIN) ID(SYS1) ACCESS(CONTROL)

The following refresh is required for RACListed classes:

SETR RACL(MQADMIN) REF

Note that an additional WebSphere MQ Refresh may be required for active queue managers. This is done from the CONSOLE:

The example is for a queue manager named QMD1:
&gt;QMD1 REFRESH SECURITY(*)</fixtext><fix id="F-26236r1050715_fix" /><check system="C-26248r1050714_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>a) Refer to the following reports produced by the RACF Data Collection:

- SENSITVE.RPT(MQADMIN)

b) For all context resources (i.e., ssid.CONTEXT) defined to the MQADMIN or MXADMIN resource class, ensure the following items are in effect:

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

1) Resource profiles are defined with a UACC(NONE).
2) Access authorization restricts access to users requiring the ability to pass or set identity and/or origin data for a message. This is difficult to determine. However, an item for concern may be a profile with * READ specified in the access list.

c) If both of the items in (b) are true, there is no finding.

d) If either item in (b) is untrue, this is a finding.</check-content></check></Rule></Group><Group id="V-224566"><title>SRG-OS-000080</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224566r958472_rule" weight="10.0" severity="medium"><version>ZWMQ0059</version><title>WebSphere MQ command resources defined to MQCMDS resource class are not protected in accordance with security requirements.</title><description>&lt;VulnDiscussion&gt;WebSphere MQ resources allow for the control of  commands.  Failure to properly protect WebSphere MQ Command resources may result in unauthorized access.  This exposure could compromise the availability, integrity, and confidentiality of system services, applications, and customer data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">SV-7554</ident><ident system="http://cyber.mil/legacy">V-6973</ident><ident system="http://cyber.mil/cci">CCI-000213</ident><ident system="http://cyber.mil/cci">CCI-002234</ident><fixtext fixref="F-26237r521058_fix">Command security validates userids authorized to issue MQSeries / WebSphere MQ commands.  Command security will be active

For all command resources (i.e., ssid.command) defined to the MQCMDS resource class, ensure the following items are in effect:

NOTE 1:	ssid is the queue manager name (a.k.a., subsystem identifier).

1)	Resource profiles are defined with a UACC(NONE).
2)	Access authorization restricts access to the appropriate personnel as designated in the table entitled "Websphere MQ Command Security Controls " in the zOS STIG Addendum.
3)	All command access is logged as designated in the table entitled "Websphere MQ Command Security Controls" in the zOS STIG Addendum.

A set of sample commands are provided below to implement the minimum profiles necessary for proper security.  

/* THE FOLLOWING PROFILE FORCES GRANULAR PROFILES DEFINITIONS */
RDEF MQCMDS ** UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('MQCMDS DENY-BY-DEFAULT PROFILE')

RDEF MQCMDSN &lt;ssid&gt;.&lt;CmdName&gt;.** UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('MQCMDS Required See ZWMQ0059')

PE &lt;ssid&gt;.&lt;CmdNAme&gt;.** CL(MQCMDS) ID(&lt;autherizeduser&gt;) ACC(C)

SETR RACL(MQCMDS) REF

Note that an additional WebSphere MQ Refresh may be required for active Qmanagers.  This is done from the CONSOLE:

The example is for a Que Manager Named QMD1
&gt;QMD1 REFRESH SECURITY(*)
</fixtext><fix id="F-26237r521058_fix" /><check system="C-26249r521057_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>a)	Refer to the following reports produced by the Data Set and Resource Data Collection:

-	SENSITVE.RPT(MQCMDS)

b)	For all command resources (i.e., ssid.command) defined to the MQCMDS resource class, ensure the following items are in effect:

NOTE:	ssid is the queue manager name (a.k.a., subsystem identifier).

1)	Resource profiles are defined with a UACC(NONE).
2)	Access authorization restricts access to the appropriate personnel as designated in the Websphere MQ COMMAND SECURITY CONTROLS Table in the z/OS STIG Addendum.
3)	All command access is logged as designated in the Websphere MQ COMMAND SECURITY CONTROLS Table in the z/OS STIG Addendum.

c)	If all of the items in (b) are true, there is NO FINDING.

d)	If any item in (b) is untrue, this is a FINDING.</check-content></check></Rule></Group><Group id="V-224567"><title>SRG-OS-000080</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-224567r1050719_rule" weight="10.0" severity="medium"><version>ZWMQ0060</version><title>WebSphere MQ RESLEVEL resources in the appropriate ADMIN resource class must be protected in accordance with security requirements.</title><description>&lt;VulnDiscussion&gt;RESLEVEL security profiles control the number of userids checked for API-resource security. RESLEVEL is a powerful option that can cause the bypassing of all security checks. RESLEVEL security will not be implemented.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target zOS WebsphereMQ for RACF</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>zOS WebsphereMQ for RACF</dc:subject><dc:identifier>4167</dc:identifier></reference><ident system="http://cyber.mil/legacy">SV-7556</ident><ident system="http://cyber.mil/legacy">V-6975</ident><ident system="http://cyber.mil/cci">CCI-001762</ident><ident system="http://cyber.mil/cci">CCI-000213</ident><fixtext fixref="F-26238r1050718_fix">RESLEVEL security profiles control the number of userids checked for API-resource security. RESLEVEL security will not be implemented due to the following exposures and limitations:
1) RESLEVEL is a powerful option that can cause the bypassing of all security checks.
2) Security audit records are not created when the RESLEVEL profile is utilized.
3) If the WARNING option is specified on a RESLEVEL profile, no warning messages are produced.

To protect against any profile in the MQADMIN or MXADMIN class, such as ssid.**, resolving to a RESLEVEL profile, a ssid.RESLEVEL profile will be defined for each queue manager with UACC(NONE) specified and no users or groups specified in the access list.

Ensure the following items are in effect:

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

1) A RESLEVEL resource (i.e., ssid.RESLEVEL) is defined for each queue manager to the MQADMIN  or MXADMIN resource class with a UACC(NONE).
2) Access authorization to these RESLEVEL resources restricts all access. No users or groups must be specified in the access list.

A set of sample commands is provided below to implement the profile necessary for proper security.  

RDEF MQADMIN &lt;ssid&gt;.RESLEVEL UACC(NONE) OWNER(ADMIN) AUDIT(ALL(READ)) DATA('MQADMIN PROFILE REQUIRED BY ZWMQ0060')

SETR RACL(MQADMIN) REF

Note that an additional WebSphere MQ Refresh may be required for active queue managers. This is done from the CONSOLE:

The example is for a queue manager named QMD1:
&gt;QMD1 REFRESH SECURITY(*)</fixtext><fix id="F-26238r1050718_fix" /><check system="C-26250r1050717_chk"><check-content-ref href="zOS_WebsphereMQ_for_RACF_STIG.xml" name="M" /><check-content>a) Refer to the following reports produced by the Data Set and Resource Data Collection:

- SENSITVE.RPT(MQADMIN)

Automated Analysis
Refer to the following report produced by the Data Set and Resource Data Collection:

- PDI(ZWMQ0060)

b) Ensure the following items are in effect:

NOTE: ssid is the queue manager name (a.k.a., subsystem identifier).

1) A RESLEVEL resource (i.e., ssid.RESLEVEL) is defined for each queue manager to the MQADMIN or MXADMIN resource class with a UACC(NONE).
2) Access authorization to these RESLEVEL resources restricts all access. No users or groups must be specified in the access list.

c) If both of the items in (b) are true, there is no finding.

d) If either item in (b) is untrue, this is a finding.</check-content></check></Rule></Group></Benchmark>