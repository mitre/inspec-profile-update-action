<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" id="Windows_DNS" xml:lang="en" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2015-12-28">accepted</status><title>Windows DNS</title><notice id="terms-of-use" xml:lang="en"></notice><reference href="http://iase.disa.mil"><dc:publisher>DISA</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 1.19 Benchmark Date: 22 Jan 2016</plain-text><version>4</version><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3625" selected="true" /><select idref="V-4467" selected="true" /><select idref="V-4468" selected="true" /><select idref="V-4469" selected="true" /><select idref="V-4470" selected="true" /><select idref="V-4473" selected="true" /><select idref="V-4475" selected="true" /><select idref="V-4476" selected="true" /><select idref="V-4477" selected="true" /><select idref="V-4478" selected="true" /><select idref="V-4479" selected="true" /><select idref="V-4481" selected="true" /><select idref="V-4482" selected="true" /><select idref="V-4483" selected="true" /><select idref="V-4485" selected="true" /><select idref="V-4486" selected="true" /><select idref="V-4487" selected="true" /><select idref="V-4488" selected="true" /><select idref="V-4489" selected="true" /><select idref="V-4490" selected="true" /><select idref="V-4492" selected="true" /><select idref="V-4501" selected="true" /><select idref="V-4502" selected="true" /><select idref="V-4503" selected="true" /><select idref="V-4505" selected="true" /><select idref="V-12479" selected="true" /><select idref="V-14756" selected="true" /><select idref="V-14757" selected="true" /><select idref="V-14768" selected="true" /></Profile><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3625" selected="true" /><select idref="V-4467" selected="true" /><select idref="V-4468" selected="true" /><select idref="V-4469" selected="true" /><select idref="V-4470" selected="true" /><select idref="V-4473" selected="true" /><select idref="V-4475" selected="true" /><select idref="V-4476" selected="true" /><select idref="V-4477" selected="true" /><select idref="V-4478" selected="true" /><select idref="V-4479" selected="true" /><select idref="V-4481" selected="true" /><select idref="V-4482" selected="true" /><select idref="V-4483" selected="true" /><select idref="V-4485" selected="true" /><select idref="V-4486" selected="true" /><select idref="V-4487" selected="true" /><select idref="V-4488" selected="true" /><select idref="V-4489" selected="true" /><select idref="V-4490" selected="true" /><select idref="V-4492" selected="true" /><select idref="V-4501" selected="true" /><select idref="V-4502" selected="true" /><select idref="V-4503" selected="true" /><select idref="V-4505" selected="true" /><select idref="V-12479" selected="true" /><select idref="V-14756" selected="true" /><select idref="V-14757" selected="true" /><select idref="V-14768" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3625" selected="true" /><select idref="V-4467" selected="true" /><select idref="V-4468" selected="true" /><select idref="V-4469" selected="true" /><select idref="V-4470" selected="true" /><select idref="V-4473" selected="true" /><select idref="V-4475" selected="true" /><select idref="V-4476" selected="true" /><select idref="V-4477" selected="true" /><select idref="V-4478" selected="true" /><select idref="V-4479" selected="true" /><select idref="V-4481" selected="true" /><select idref="V-4482" selected="true" /><select idref="V-4483" selected="true" /><select idref="V-4485" selected="true" /><select idref="V-4486" selected="true" /><select idref="V-4487" selected="true" /><select idref="V-4488" selected="true" /><select idref="V-4489" selected="true" /><select idref="V-4490" selected="true" /><select idref="V-4492" selected="true" /><select idref="V-4501" selected="true" /><select idref="V-4502" selected="true" /><select idref="V-4503" selected="true" /><select idref="V-4505" selected="true" /><select idref="V-12479" selected="true" /><select idref="V-14756" selected="true" /><select idref="V-14757" selected="true" /><select idref="V-14768" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3625" selected="true" /><select idref="V-4467" selected="true" /><select idref="V-4468" selected="true" /><select idref="V-4469" selected="true" /><select idref="V-4470" selected="true" /><select idref="V-4473" selected="true" /><select idref="V-4475" selected="true" /><select idref="V-4476" selected="true" /><select idref="V-4477" selected="true" /><select idref="V-4478" selected="true" /><select idref="V-4479" selected="true" /><select idref="V-4481" selected="true" /><select idref="V-4482" selected="true" /><select idref="V-4483" selected="true" /><select idref="V-4485" selected="true" /><select idref="V-4486" selected="true" /><select idref="V-4487" selected="true" /><select idref="V-4488" selected="true" /><select idref="V-4489" selected="true" /><select idref="V-4490" selected="true" /><select idref="V-4492" selected="true" /><select idref="V-4501" selected="true" /><select idref="V-4502" selected="true" /><select idref="V-4503" selected="true" /><select idref="V-4505" selected="true" /><select idref="V-12479" selected="true" /><select idref="V-14756" selected="true" /><select idref="V-14757" selected="true" /><select idref="V-14768" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3625" selected="true" /><select idref="V-4467" selected="true" /><select idref="V-4468" selected="true" /><select idref="V-4469" selected="true" /><select idref="V-4470" selected="true" /><select idref="V-4473" selected="true" /><select idref="V-4475" selected="true" /><select idref="V-4476" selected="true" /><select idref="V-4477" selected="true" /><select idref="V-4478" selected="true" /><select idref="V-4479" selected="true" /><select idref="V-4481" selected="true" /><select idref="V-4482" selected="true" /><select idref="V-4483" selected="true" /><select idref="V-4485" selected="true" /><select idref="V-4486" selected="true" /><select idref="V-4487" selected="true" /><select idref="V-4488" selected="true" /><select idref="V-4489" selected="true" /><select idref="V-4490" selected="true" /><select idref="V-4492" selected="true" /><select idref="V-4501" selected="true" /><select idref="V-4502" selected="true" /><select idref="V-4503" selected="true" /><select idref="V-4505" selected="true" /><select idref="V-12479" selected="true" /><select idref="V-14756" selected="true" /><select idref="V-14757" selected="true" /><select idref="V-14768" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3625" selected="true" /><select idref="V-4467" selected="true" /><select idref="V-4468" selected="true" /><select idref="V-4469" selected="true" /><select idref="V-4470" selected="true" /><select idref="V-4473" selected="true" /><select idref="V-4475" selected="true" /><select idref="V-4476" selected="true" /><select idref="V-4477" selected="true" /><select idref="V-4478" selected="true" /><select idref="V-4479" selected="true" /><select idref="V-4481" selected="true" /><select idref="V-4482" selected="true" /><select idref="V-4483" selected="true" /><select idref="V-4485" selected="true" /><select idref="V-4486" selected="true" /><select idref="V-4487" selected="true" /><select idref="V-4488" selected="true" /><select idref="V-4489" selected="true" /><select idref="V-4490" selected="true" /><select idref="V-4492" selected="true" /><select idref="V-4501" selected="true" /><select idref="V-4502" selected="true" /><select idref="V-4503" selected="true" /><select idref="V-4505" selected="true" /><select idref="V-12479" selected="true" /><select idref="V-14756" selected="true" /><select idref="V-14757" selected="true" /><select idref="V-14768" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3625" selected="true" /><select idref="V-4467" selected="true" /><select idref="V-4468" selected="true" /><select idref="V-4469" selected="true" /><select idref="V-4470" selected="true" /><select idref="V-4473" selected="true" /><select idref="V-4475" selected="true" /><select idref="V-4476" selected="true" /><select idref="V-4477" selected="true" /><select idref="V-4478" selected="true" /><select idref="V-4479" selected="true" /><select idref="V-4481" selected="true" /><select idref="V-4482" selected="true" /><select idref="V-4483" selected="true" /><select idref="V-4485" selected="true" /><select idref="V-4486" selected="true" /><select idref="V-4487" selected="true" /><select idref="V-4488" selected="true" /><select idref="V-4489" selected="true" /><select idref="V-4490" selected="true" /><select idref="V-4492" selected="true" /><select idref="V-4501" selected="true" /><select idref="V-4502" selected="true" /><select idref="V-4503" selected="true" /><select idref="V-4505" selected="true" /><select idref="V-12479" selected="true" /><select idref="V-14756" selected="true" /><select idref="V-14757" selected="true" /><select idref="V-14768" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3625" selected="true" /><select idref="V-4467" selected="true" /><select idref="V-4468" selected="true" /><select idref="V-4469" selected="true" /><select idref="V-4470" selected="true" /><select idref="V-4473" selected="true" /><select idref="V-4475" selected="true" /><select idref="V-4476" selected="true" /><select idref="V-4477" selected="true" /><select idref="V-4478" selected="true" /><select idref="V-4479" selected="true" /><select idref="V-4481" selected="true" /><select idref="V-4482" selected="true" /><select idref="V-4483" selected="true" /><select idref="V-4485" selected="true" /><select idref="V-4486" selected="true" /><select idref="V-4487" selected="true" /><select idref="V-4488" selected="true" /><select idref="V-4489" selected="true" /><select idref="V-4490" selected="true" /><select idref="V-4492" selected="true" /><select idref="V-4501" selected="true" /><select idref="V-4502" selected="true" /><select idref="V-4503" selected="true" /><select idref="V-4505" selected="true" /><select idref="V-12479" selected="true" /><select idref="V-14756" selected="true" /><select idref="V-14757" selected="true" /><select idref="V-14768" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-3625" selected="true" /><select idref="V-4467" selected="true" /><select idref="V-4468" selected="true" /><select idref="V-4469" selected="true" /><select idref="V-4470" selected="true" /><select idref="V-4473" selected="true" /><select idref="V-4475" selected="true" /><select idref="V-4476" selected="true" /><select idref="V-4477" selected="true" /><select idref="V-4478" selected="true" /><select idref="V-4479" selected="true" /><select idref="V-4481" selected="true" /><select idref="V-4482" selected="true" /><select idref="V-4483" selected="true" /><select idref="V-4485" selected="true" /><select idref="V-4486" selected="true" /><select idref="V-4487" selected="true" /><select idref="V-4488" selected="true" /><select idref="V-4489" selected="true" /><select idref="V-4490" selected="true" /><select idref="V-4492" selected="true" /><select idref="V-4501" selected="true" /><select idref="V-4502" selected="true" /><select idref="V-4503" selected="true" /><select idref="V-4505" selected="true" /><select idref="V-12479" selected="true" /><select idref="V-14756" selected="true" /><select idref="V-14757" selected="true" /><select idref="V-14768" selected="true" /></Profile><Group id="V-3625"><title>Shares are enabled on name server.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-3625r2_rule" severity="medium" weight="10.0"><version>DNS4580</version><title>Shares other than the default administrative shares are enabled on a name server.</title><description>&lt;VulnDiscussion&gt;Non-administrative shares are unnecessary for name server operation and provide adversaries with an additional possible point of attack.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECAN-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-3556r1_fix">The SA should disable all non-administrative shares.</fixtext><fix id="F-3556r1_fix" /><check system="C-3452r2_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>From a command prompt, type net share and press enter.  If any shares appear other than default administrative shares (e.g., C$, NETLOGON$), then this is a finding</check-content></check></Rule></Group><Group id="V-4467"><title>A zone record has not been validated.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4467r2_rule" severity="low" weight="10.0"><version>DNS0225</version><title>Record owners will validate their zones no less than annually.  The DNS database administrator will remove all zone records that have not been validated in over a year.  </title><description>&lt;VulnDiscussion&gt;If zone information has not been validated in over a year, then there is no assurance that it is still valid.  If invalid records are in a zone, then an adversary could potentially use their existence for improper purposes. An SOP detailing this process can resolve this requirement.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4352r1_fix">Working with DNS Administrators and other appropriate technical personnel, the IAO should attempt to validate the hosts with expired validation dates.  If these cannot be validated within a reasonable period of time, they should be removed.

A zone file should contain adequate documentation that would allow an IAO or newly assigned administrator to quickly learn the scope and structure of that zone.  In particular, each record (or related set of records, such as a group of LAN workstations) should be accompanied by a notation of the date the record was created, modified, or validated and record the owner’s name, title, and organizational affiliation.  The owner of a record is an individual with the authority to request that the record be modified or deleted.</fixtext><fix id="F-4352r1_fix" /><check system="C-3430r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND
DNS zone record documentation will preferably reside in the zone file itself through comments, but if this is not feasible, the DNS database administrator will maintain a separate database for this purpose. The zone file location can be found by examining the named.conf and searching for the zone statement.  Within the zone statement will be a file option that will display the name of the zone file.  The reviewer should check that the record’s last verified date is less than one year prior to the date of the review.  If this is not the case for any host or group of hosts, then this is a finding.

Windows
Ask the DNS database administrator if they maintain a separate database with record documentation.  Windows DNS does not provide the capability to insert comments for records in a zone.  The reviewer should check that the record’s last verified date is less than one year prior to the date of the review.  If this is not the case for any host or group of hosts, then this is a finding.
</check-content></check></Rule></Group><Group id="V-4468"><title>The zone file contains an outside host record.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4468r3_rule" severity="low" weight="10.0"><version>DNS0230</version><title>Resource records for a host in a zone file are included and their fully qualified domain name resides in another zone. The exception is a glue record or CNAME record supporting a system migration.</title><description>&lt;VulnDiscussion&gt; If a name server were able to claim authority for a resource record in a domain for which it was not authoritative, this would pose a security risk.  In this environment, an adversary could use illicit control of a name server to impact IP address resolution beyond the scope of that name server (i.e., by claiming authority for records outside of that servers zones).  Fortunately, all but the oldest versions of BIND and most other DNS implementations do not allow for this behavior.  Nevertheless, the best way to eliminate this risk is to eliminate from the zone files any records for hosts in another zone.  The two key exceptions to this rule involve glue for NS records and CNAME records for legacy resolution support&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4353r1_fix">The DNS database administrator should remove any resource records for a host in a zone file if its fully qualified domain name resides in another zone, unless the record is a glue record or temporary CNAME record supporting a system migration.</fixtext><fix id="F-4353r1_fix" /><check system="C-3431r2_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>Review the zone files and confirm with the DNS administrator that the hosts defined in the zone files do not reside in another zone with its fully qualified domain name.  If extraneous resource records are maintained, then this is a finding.

BIND
The zone file location can be found by examining the named.conf and searching for the zone statement.  Within the zone statement will be a file option that will display the name of the zone file.  Review the zone file and check for records that contain domain names outside of the zone. I.E.  A zone named fso.chambersburg.com will not have a record for a host with a domain ending in disa.mil.

The exceptions are glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms.  In the case of third-party CDNs or cloud offerings, an approved mission need must be demonstrated.

If resource records are maintained that resolve to a fully qualified domain name in another zone, and the usage is not for resource records resolving to hosts that are glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms with a documented and approved mission need, this is a finding.

Windows
Open the DNS management snap in for the Administrative Tools menu.  Expand the Forward Lookup Zones folder.  Expand each zone and ensure the name column for each record does not contain a name for a record that resides outside of the zone. I.E.  A zone named fso.chambersburg.com will not have a record for a host with a domain ending in disa.mil.

The exceptions are glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms.  In the case of third-party CDNs or cloud offerings, an approved mission need must be demonstrated.

If resource records are maintained that resolve to a fully qualified domain name in another zone, and the usage is not for resource records resolving to hosts that are glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms with a documented and approved mission need, this is a finding.</check-content></check></Rule></Group><Group id="V-4469"><title>A CNAME record has been active too long.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4469r3_rule" severity="low" weight="10.0"><version>DNS0235</version><title>Zone-spanning CNAME records, that point to a zone with lesser security, are active for more than six months. </title><description>&lt;VulnDiscussion&gt;The use of CNAME records for exercises, tests or zone-spanning aliases should be temporary (e.g., to facilitate a migration).  When a host name is an alias for a record in another zone, an adversary has two points of attack  the zone in which the alias is defined and the zone authoritative for the aliases canonical name.  This configuration also reduces the speed of client resolution because it requires a second lookup after obtaining the canonical name. Furthermore, in the case of an authoritative name server, this information is promulgated throughout the enterprise to caching servers and thus compounding the vulnerability.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4354r1_fix">The DNS database administrator should remove any zone-spanning CNAME records that have been active for more than six months.</fixtext><fix id="F-4354r1_fix" /><check system="C-3432r3_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND
The zone file location can be found by examining the named.conf and searching for the zone statement.  Within the zone statement will be a file option that will display the name of the zone file.  The record type column will display CNAME.  This is usually the third or fourth field in a record depending if the TTL value is utilized.  Without a TTL value, the CNAME type will be in the third field, otherwise it will display as the fourth field.  Review the zone files and the DNS zone record documentation to confirm that there are no CNAME records, pointing to a zone with lesser security, older than 6 months.  

The exceptions are glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms. In the case of third-party CDNs or cloud offerings, an approved mission need must be demonstrated.

If there are zone-spanning CNAME records older than 6 months and the CNAME records resolve to anything other than fully qualified domain names for glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms with an AO-approved and documented mission need, this is a finding.

Windows
Open the DNS management snap in for the Administrative Tools menu.  Expand the Forward Lookup Zones folder.  Review the type column for each record to locate those with a type of Alias (CNAME).  Ask the DNS administrator to see the database with the record documentation is stored to confirm there are not CNAME records, pointing to a zone with lesser security, older than 6 months. 

The exceptions are glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms. In the case of third-party CDNs or cloud offerings, an approved mission need must be demonstrated.

If there are zone-spanning CNAME records older than 6 months and the CNAME records resolve to anything other than fully qualified domain names for glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms with an AO-approved and documented mission need, this is a finding.</check-content></check></Rule></Group><Group id="V-4470"><title>Zone file contains invalid NS records.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4470r2_rule" severity="high" weight="10.0"><version>DNS0240</version><title>The DNS database administrator has not ensured each NS record in a zone file points to an active name server authoritative for the domain specified in that record.</title><description>&lt;VulnDiscussion&gt;Poorly constructed NS records pose a security risk because they create conditions under which an adversary might be able to provide the missing authoritative name services that are improperly specified in the zone file.  The adversary could issue bogus responses to queries that clients would accept because they learned of the adversary’s name server from a valid authoritative name server, one that need not be compromised for this attack to be successful.

The list of slave servers must remain current within 72 hours of any changes to the zone architecture that would affect the list of slaves.  If a slave server has been retired or is not operational but remains on the list, then an adversary might have a greater opportunity to impersonate that slave without detection, rather than if the slave were actually online.  For example, the adversary may be able to spoof the retired slave’s IP address without an IP address conflict, which would likely not occur if the true slave were active.
&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4355r1_fix">The DNS database administrator should remove any NS records in a zone file that do not point to an active name server authoritative for the domain specified in that record.</fixtext><fix id="F-4355r1_fix" /><check system="C-3442r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND
The zone file location can be found by examining the named.conf and searching for the zone statement.  Within the zone statement will be a file option that will display the name of the zone file.  Review the zone files, and confirm with the DNS administrator that each NS record points to an active name server authoritative for the domain, it this is not the case, then this is a finding.

Windows
Open the DNS management snap in for the Administrative Tools menu.  Expand the Forward Lookup Zones folder.  Review the type column for each record to locate those with a type of Name Server (NS).  Confirm with the DNS administrator that each NS record points to an active name server authoritative for the domain, it this is not the case, then this is a finding.

</check-content></check></Rule></Group><Group id="V-4473"><title>DNS software does not run on dedicated hardware.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4473r3_rule" severity="medium" weight="10.0"><version>DNS0415</version><title>DNS software does not run on dedicated (running only those services required for DNS) hardware. The only currently accepted exception of this requirement is Windows 2000/2003 DNS, which must run on a domain controller that is integrated with Active Directory services.

</title><description>&lt;VulnDiscussion&gt;Even a securely configured operating system is vulnerable to the flaws of the programs that run on it.  To prevent DNS software from being subjected to the vulnerabilities of other programs and services, the DNS server will not run other programs and services at all,  or at least run only those programs that are necessary for either OS or DNS support.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Information Assurance Officer&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-67805r1_fix">Working with DNS and Systems Administrators, the IAO should migrate the DNS software to dedicated hardware for the purpose of supporting the name server or remove/migrate any additional programs or applications, running on the name server to ensure the name server is running on dedicated hardware.</fixtext><fix id="F-67805r1_fix" /><check system="C-62769r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>During the initial interviews, the reviewer may have already identified that a name server is supporting production services other than DNS.  At this point, the reviewer should validate that response through a hands-on check of the actual name server.

UNIX

The only permitted services to be running on a DNS UNIX BIND server are those implementing:

-	DNS
-	Secure shell
-	Host intrusion detection
-	Host file integrity
-	Network management or monitoring
-	Anti-virus
-	Backup
-	UPS
-	NTP

The below are not permitted:

Services started through inetd.conf:
admind, chargen, echo, etherstatd, fingerd, ftpd, httpd, ICQ server, identd, netstat, netstatd, nit, nntp, nsed, nsemntd, pfilt, portd, quaked, rexd, rexecd, rje_mapper, rlogind, rpc_3270, rpc_alias, rpc_database, rpc_keyserv, rpc_sched, rquotad, rsh, rstatd, rusersd, selectd, serverd, showfhd, sprayd, statmon, sunlink_mapper, sysstat, talkd, telnetd, tfsd, tftpd, timed, ttdb, ugidd, uucpd, and walld.

Services started at boot time:
NFS client, NFS server process and SNMP daemon, automounter, printer queue daemon, and RPC portmapper.  (For Solaris, disable the following scripts in rc2.d: S73nfs.client, S74autofs, S80lp, S71rpc, and S99dtlogin and the following scripts in rc3.d: S15nfs.server and S76snmpd.)

Instruction:  In the presence of the reviewer, the SA should enter the following command:

ps –ef

Based on the command output, the reviewer should be able to determine if the machine is dedicated to DNS or if it is supporting other production services.  If additional services are running and it is determined the name server is not running on dedicated hardware, then this is a finding.</check-content></check></Rule></Group><Group id="V-4475"><title>Encryption key file permissions are inadequate.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4475r2_rule" severity="medium" weight="10.0"><version>DNS0420</version><title>Permissions on files containing DNS encryption keys are inadequate.</title><description>&lt;VulnDiscussion&gt;Weak permissions could allow an intruder to view or modify DNS encryption key files. These keys should never be readable by Other or Everyone.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECCD-1, ECCD-2, ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4360r1_fix">The SA should modify permissions of the files containing DNS encryption keys so that only the DNS software process ID (PID) has read access to these files.</fixtext><fix id="F-4360r1_fix" /><check system="C-3493r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>UNIX

Instruction:  The reviewer must work with the SA to obtain the user name running the named process.

In the presence of the reviewer, the SA should enter the following command to obtain the owner of the named process:

ps –ef  | grep named

The location to the encryption keys can be found by examining the keys directive in the /etc/named.conf file.  In the presence of the reviewer, the SA should enter the following command while in the directory containing the DNS encryption keys:

ls –la ‘encryption_key_file’

If the DNS encryption key files have permissions weaker than 640, then this is a finding.

Windows with BIND

Instruction:  The reviewer must work with the SA to obtain the owner of the named.exe. 
In the presence of the reviewer, the SA should right-click on the named.exe file and select Properties | Security tab | Advanced | Owner tab.

For each DNS encryption key file listed in c:\named\etc\named.conf  keys directive , right-click on the file and select Properties | Security tab.

If the DNS encryption key files have permissions that allow read access to anyone beyond the owner of the named.exe, then this is a finding.
</check-content></check></Rule></Group><Group id="V-4476"><title>File permissions on DNS zone files are inadequate.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4476r2_rule" severity="medium" weight="10.0"><version>DNS0425</version><title>Users and/or processes other than the DNS software Process ID (PID) and/or the DNS database administrator have edit/write access to the zone database files.</title><description>&lt;VulnDiscussion&gt;Weak permissions on key files could allow an intruder to view or modify DNS zone files. Permissions on these files will be 640 or more restrictive. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECCD-1, ECCD-2&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4361r1_fix">The SA should modify permissions of zone files that only the DNS software PID and/or the DNS database administrator have edit access to the zone database files. </fixtext><fix id="F-4361r1_fix" /><check system="C-3518r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>UNIX

Instruction:  The reviewer must work with the SA to obtain the username and groupname of the DNS database administrator, DNS software administrator, and the username running the named daemon process.

In the presence of the reviewer, the SA should enter the following command to obtain the owner of the named process:

ps –ef  | grep named

There are different ways (e.g., password/group file, NIS+, etc.) to obtain the DNS database administrator’s username and groupname, the reviewer is to work with the SA to obtain this information based on the configuration of the site’s UNIX OS.

The zone files can be located by viewing the named.conf configuration for the zone statement and the file directive contained within the zone statement.  In the presence of the reviewer, the SA should enter the following command while in the directory containing the zone files:

ls -l

If the zone files have permissions that allow write access to anyone beyond the owner of the named process or the DNS database administrator then this is a finding.

Windows

Instruction:  The reviewer must obtain the username and groupname of the DNS database administrator.  The reviewer must work with the SA to obtain the owner of the named.exe or dns.exe  program.

In the presence of the reviewer, the SA should right-click on the named.exe or dns.exe file and select Properties | Security tab | Advanced | Owner tab.
	
For each Standard or Primary zone file, right-click on the file in %SystemRoot%\System32\Dns and select Properties | Security tab.

If the zone files have permissions that allow write access to anyone beyond Administrators, Enterprise Domain Controllers, Enterprise Admins, Domain Admins, System or DNS Admins, then this is a finding.

For Active directory integrated zones, the permissions of the Active Directory database should be verified.  They usually reside in %SystemRoot%\NTDS\ntds.dit  The permissions should only give full control access to System, Administrators, Creator Owner, and Local Service.  Any others, then this is a finding.
</check-content></check></Rule></Group><Group id="V-4477"><title>Inadequate permissions on DNS configuration files.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4477r4_rule" severity="medium" weight="10.0"><version>DNS0430</version><title>Users or processes other than the DNS software administrator and the DNS software PID have write access to these files. </title><description>&lt;VulnDiscussion&gt;Weak permissions on key DNS configuration files could allow an intruder to view or modify DNS name server configuration files.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECCD-1, ECCD-2&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-44112r2_fix">The SA should modify permissions of the DNS name server configuration files so that only the DNS software administrator and the DNS software PID have write access to the DNS software configuration files.

The SA should modify permission to the DNS configuration files to allow “Authenticated Users” to have Create/Delete Child Object permission to support Secure Dynamic Updates.
 
The SA should modify permission to limit all other write 
access to the DNS configuration files to only the DNS software administrator.
</fixtext><fix id="F-44112r2_fix" /><check system="C-46501r2_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>UNIX

Instruction:  The reviewer must work with the SA to obtain the username and groupname of the DNS software administrator and the username running the named daemon process.

In the presence of the reviewer, the SA should enter the following command to obtain the owner of the named process:

ps –ef  | grep named

There are different ways (i.e., password/group file, NIS+, etc.) to obtain the DNS software administrator’s username and groupname, the reviewer is to work with the SA to obtain this information based on the configuration of the site’s UNIX OS.

In the presence of the reviewer, the SA should enter the following command while in the directory containing the DNS configuration files:

ls –l /etc/named.conf

If the DNS configuration files have permissions that allow write access to anyone beyond the DNS software administrator or the DNS software administrator then this is a finding.

Windows

For ISC BIND:
Instruction: The reviewer must work with the SA to obtain the username and groupname of the DNS software administrator and the owner of the named.exe or dns.exe or dns.exe program.

In the presence of the reviewer, the SA should right-click on the named.exe or dns.exe file and select Properties | Security tab | Advanced | Owner tab.

The reviewer should ask the SA for the location of the ISC BIND named.conf/zone files.  For each DNS configuration file, right-click on the file and select Properties | Security tab.

If the DNS configuration files have permissions that allow write access to anyone beyond the DNS software administrator then this is a finding.

For Windows DNS:

Open the DNS management console and expand the Forward Lookup Zones.  Right click on each zone and select Properties.  Select the Security tab.

In order to accommodate Secure Dynamic Updates the “Authenticated Users” group must have Create/Delete Child objects permission.

If the DNS configuration files have permissions that allow write access to anyone beyond the DNS software administrator or permissions other than those needed to accommodate Secure Dynamic Updates, then this is a finding.



</check-content></check></Rule></Group><Group id="V-4478"><title>IP address is NOTstatically defined.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4478r2_rule" severity="medium" weight="10.0"><version>DNS0435</version><title>The name server’s IP address is NOT statically defined and configured locally on the server. The name server has a DHCP address. </title><description>&lt;VulnDiscussion&gt;Static IP addresses permit a machine to offer Internet services like web, ftp, DNS, and email. Because a specific, known address is associated with your connection, other machines on the Internet know where to send traffic destined for your server.  Required ACL restrictions at the router and or firewall are required to protect the DNS server from unauthorized access. Such ACLS  require a static IP address to be effective.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4363r1_fix">The SA should configure the name server with an IP address that is statically defined.</fixtext><fix id="F-4363r1_fix" /><check system="C-3522r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>UNIX

Instruction:  In the presence of the reviewer, the SA should enter the following command to verify the IP address is not obtained by DHCP, hme0 is used as an example, please confirm the interface:

ifconfig hme0 auto_dhcp status

If “Ifconfig:  hme0:  interface is not under DHCP control,” is not displayed, then this is a finding.

Please note this above mentioned command does not work on every version of UNIX, if this command does not work, please use the below instruction.

In the presence of the reviewer, the SA enters the following command while in the /etc directory:  The reviewer should ensure the file /etc/dhpc.hme0 is not located on the server.

ls -l

If the file dhcp.hme0 is listed (interface designation may different), then this is a finding.

Windows

Instruction:  In the presence of the reviewer, the SA should select Start | Run, this will bring up the “Run” dialog box.  Type cmd at the command line, this will bring up the command screen.  Enter the following command:

ipconfig /all

If “DHCP Enabled” is not set to “No,” then this is a finding.
</check-content></check></Rule></Group><Group id="V-4479"><title>An integrity checking tool is not utilized.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4479r2_rule" severity="medium" weight="10.0"><version>DNS0440</version><title>An integrity checking tool is not installed or not monitoring for modifications to the root.hints and named.conf files.

</title><description>&lt;VulnDiscussion&gt;An integrity checking tool compares file and directory integrity to the baseline. It can alert the system administrator to unauthorized changes in files or directories. Unauthorized changes in files and directories can give a user unauthorized access to system resources.  Undetected changes to DNS name server root hints and configuration files is the single greatest risk to the security and stability of the DNS name server.  An integrity checking tool (e.g., Tripwire) aids in effectively monitoring and controlling changes to ensure improved security and system availability.  This applies to both authoritative and caching name servers.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4364r1_fix">The SA should install an integrity checking tool on the name server and configure the tool to monitor for any modifications to the root.hints and name server configuration files.</fixtext><fix id="F-4364r1_fix" /><check system="C-3579r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>UNIX

Instruction:  The reviewer must work with the SA to obtain the program name.

In the presence of the reviewer, the SA should enter the following command to confirm the integrity checking tool is installed and running:

ps –ef | grep process name

If an integrity checking tool is not installed and running, then this is a finding.

With the assistance of the SA, confirm that the integrity checking tool is monitoring for any modifications to the root hints and name server’s configuration (e.g., named.conf), if this is not the case, then this is a finding.  If using ISC BIND name server software, common names for the root hints file are root.hints, named.cache, or db.cache.  The name is configurable within the named.conf file.  rndc.conf will be protected in the same manner.

Windows

Instruction:  The reviewer must work with the SA to obtain the service name.

Instruction:  The reviewer should examine the Windows Services GUI to identify started services (in Windows 2000/2003, right click on “My Computer” and select “Manage”.  In the left windowpane, click on “Services and Applications”.  A list of services is displayed in the right windowpane.  Click on the “Status” column heading to sort by status.  The started services will be grouped together).  Also check the “Applications” tab of “Task Manager” for applications that do not run as a service (Simultaneously press Ctrl-Alt-Del keys and select the “Applications” tab).  The reviewer should be able to determine if an integrity checking tool is installed and running.

If an integrity checking tool is not installed and running, then this is a finding.

With the assistance of the SA, confirm that the integrity checking tool is monitoring for any modifications to the root hints, which can be found C:/Windows/System32/DNS/cache.dns.  In addition ensure the tool is checking the zone files.   Active directory zone files are stored in the active directory database.  The database can be found using the windows search feature and locating the ntds.dit file which is the database.  For non-active directory zones, obtain the name of the zone from the DNS management console list of forward zones.  Enter the zone name into the windows search and it will display the path to the actual zone files, normally found in a backup directory.

</check-content></check></Rule></Group><Group id="V-4481"><title>Dynamic updates are not authenticated.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4481r2_rule" severity="high" weight="10.0"><version>DNS0450</version><title>Dynamic updates are not cryptographically authenticated.</title><description>&lt;VulnDiscussion&gt;The dynamic update capability has considerable appeal in an environment in which IP addresses change so frequently that it would be unacceptably burdensome or expensive to dedicate the time of a DNS database administrator to this function.  This condition would likely be met at sites that rely on the Dynamic Host Configuration Protocol (DHCP) to assign IP addresses to client devices such as workstations, laptops, and IP telephones.  It would also apply to sites that utilize frequently changing service (SRV) records.

On the other hand, dynamic updates can pose a security risk if the proper security controls are not implemented. When dynamic updates are permitted without any mitigating controls, a host with network access to the name server can modify any zone record with an appropriately crafted dynamic update request.  

The solution is to require cryptographic authentication of all dynamic update requests, but not all DNS software supports this functionality.  &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;DCNR-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4366r1_fix">For BIND implementations, the DNS software administrator must ensure that each zone statement in named.conf contains the phrase allow update{none;};  to disable dynamic updates or allow-update {key ks1.kalamazoo.disa.mil_ns2.kalamazoo.disa.mil;}; (this is an example key name) to encrypt dynamic updates.  For Windows 2000 DNS, disable dynamic updates or if dynamic updates are allowed via the General tab within the Properties dialog box, the DNS software administrator should select Only secure updates.  In cases in which the name server is not running BIND or Windows 2000 DNS, the DNS software administrator must determine how to disable dynamic updates or encrypt them.  If this is not possible, then the product must be replaced as soon as it is feasible to do so.</fixtext><fix id="F-4366r1_fix" /><check system="C-3528r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND

Instruction:  The reviewer should review the configuration files and check each zone statement for the presence of the allow-update phrase, which enables cryptographically authenticated dynamic updates:

The reviewer should identify the allow-update phrase.  The following example disables dynamic updates: 

allow-update {none;};

In addition, the absence of the allow-update clause will deny updates by default.
If dynamic updates are not disabled, as shown in the above example, they must be cryptographically authenticated as shown in the below example.

The following example demonstrates cryptographically authenticated dynamic updates:

allow-update {key ns1.kalamazoo.disa.mil_ns2.kalamazoo.disa.mil;
};

If dynamic updates are not disabled or cryptographically authenticated, then this is a finding.
	
Windows 2000/2003 DNS

Instruction:  In the presence of the reviewer, the SA must review the “Properties” dialog box, select the “General” tab, and check to see if dynamic updates are allowed.  If dynamic updates are enabled, ensure that “Only secure updates” has been selected.  If this is not the case, then this is a finding.
</check-content></check></Rule></Group><Group id="V-4482"><title>A nameserver does not authenticate.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4482r2_rule" severity="high" weight="10.0"><version>DNS0455</version><title>The DNS software administrator will configure each master/slave server supporting a zone to cryptographically authenticate zone transfers.</title><description>&lt;VulnDiscussion&gt;A slave updates its zone information by requesting a zone transfer from its master.  In this transaction, the risk for the slave is that the response to its request is not in fact from its authorized master but from an adversary posing as the master.  In this scenario, such an adversary would be able to modify and insert records into the slaves zone at will.  To protect against this occurrence, the slave must be able to authenticate the master to provide assurance that any zone updates are valid.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;DNS0455&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;A violation of this requirement can have one of two severity levels depending upon the extent of the violation.  If slaves do not authenticate masters in any manner, then the discrepancy would be a Category I finding.  If some form of authentication exists (i.e., based on IP address), but it is not based on cryptography, then the discrepancy would be a Category II finding.&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;DCNR-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4367r1_fix">The DNS software administrator should configure each slave supporting a zone to cryptographically authenticate its master before accepting zone updates.  </fixtext><fix id="F-4367r1_fix" /><check system="C-3531r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND

Instruction:  This check is only applicable to slave servers.  If there is not an allow-transfer phrase within the zone statement, then this is a CAT I finding.  If there is an allow-transfer statement, there must be a TSIG key corresponding to each of the zone partners.  The reviewer can validate this by examining the key and server statements within named.conf.  Check the keys phrase within each of the server statements.  Verify the key statement is configured to cryptographically authenticate the master name server; an example is provided below, if this is not configured, then this is a finding.  

On the master name server, this is an example of a configured key statement:

key ns1.kalamazoo.disa.mil_ns2.kalamazoo.disa.mil. {
algorithm hmac-md5;
include "/etc/dns/keys/tsig-example.key";
};

zone “disa.mil” {
type master;file “db.disa.mil”;
allow-transfer { key ns1.kalamazoo.disa.mil_ns2.kalamazoo.disa.mil.; };
};
On the slave name server, this is an example of a configured key statement:

key ns1.kalamazoo.disa.mil_ns2.kalamazoo.disa.mil. {
	algorithm hmac-,d5;
	include "/etc/dns/keys/tsig-example.key";
};

server 10.2.2.2 {
	keys {ns1.kalamazoo.disa.mil_ns2.kalamazoo.disa.mil};
};

zone “disa.mil” {
	type slave;
	masters { 10.1.1.1; };
	file “db.disa.mil”;
};

A violation of this requirement can have one of two severity levels depending upon the extent of the violation.  If slaves do not authenticate master servers in any manner, then the discrepancy would be a Category I finding.  If some form of authentication exists (i.e., based on IP address), but it is not based on cryptography, then the discrepancy would be a Category II finding.

Windows 2000/2003 DNS:

Instruction:  This check only applies if the name server is not active directory integrated.  If the Windows DNS zone type is not active directory integrated, then the open the DNS management console snap-in, right click on the zone and select properties.  If name servers tab has entries, then this will still be a CAT II finding.  If the name servers tab does not have entries, then this is a CAT I.

In cases in which the name server is not running BIND or Windows DNS, the reviewer must still examine the configuration and its documentation to validate this requirement.
Mitigation:
A violation of this requirement can have one of two severity levels depending upon the extent of the violation.  If slaves do not authenticate masters in any manner, then the discrepancy would be a Category I finding.  If some form of authentication exists (i.e., based on IP address), but it is not based on cryptography, then the discrepancy would be a Category II finding.
</check-content></check></Rule></Group><Group id="V-4483"><title>Zone master server does not limit zone transfers.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4483r2_rule" severity="medium" weight="10.0"><version>DNS0460</version><title>A zone master server does not limit zone transfers to a list of active slave name servers authoritative for that zone.</title><description>&lt;VulnDiscussion&gt;The risk to the master in this situation, is that it would honor a request from a host that is not an authorized slave, but rather an adversary seeking information about the zone.  To protect against this possibility, the master must first have knowledge of what machines are authorized slaves.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECAN-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4368r1_fix">The DNS software administrator should configure each zone master server to limit zone transfers to a list of active slaves authoritative for that zone.  Configuration details may be found in the DNS STIG Section 4.2.8.</fixtext><fix id="F-4368r1_fix" /><check system="C-3539r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND

Instruction:  This check is only applicable to zone master servers.  If there are no allow-transfer phrases within named.conf, then this is a finding.  If there are allow-transfer phrases, then check that there is one corresponding to each of the zone partners.  If this is not the case, then this is also a finding.

If there are allow-transfer phrases for servers other than those supplied, then there may be a finding associated with the incompleteness of the list.

If the key statement references a file, then no other key statement should reference the same file.

If the key statement includes a character representation of the key itself (an improper configuration), then no other key statement should include the same character string.

On the master name server, this is an example of a configured allow-transfer phrase:

zone “disa.mil” {
	type master;
	file “db.disa.mil”;
	allow-transfer {10.10.10.1; key ns1.kalamazoo.disa.mil_ns2.kalamazoo.disa.mil.; };
};

Windows 2000/2003 DNS
This check only applies for Windows DNS zones not integrated with active directory.   From the DNS management console snap-in, expand the Forward Lookup zones branch, select the zone you want to configure and right click and select Properties.  Select the Zone Transfer tab.
If “Allow zone transfers:” is checked, “Only to the following servers” must also be checked.  The reviewer must validate the name servers listed.  If this is not the case, then this is a finding
</check-content></check></Rule></Group><Group id="V-4485"><title>Name server accepts invalid zone change notices.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4485r2_rule" severity="medium" weight="10.0"><version>DNS0470</version><title>A name server is not configured to only accept notifications of zone changes from a host authoritative for that zone.</title><description>&lt;VulnDiscussion&gt;A slave updates its zone information by requesting a zone transfer from its master.  In this transaction, the risk for the slave is that the response to its request is not in fact from its authorized master but from an adversary posing as the master.  In this scenario, such an adversary would be able to modify and insert records into the slaves zone at will.  To protect against this occurrence, the slave must be able to authenticate the master to provide assurance that any zone updates are valid.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4370r1_fix">The DNS software administrator should configure a name server to only accept notifications of zone changes from a host authoritative for that zone.  Configuration details may be found in the DNS STIG.</fixtext><fix id="F-4370r1_fix" /><check system="C-3543r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND

Instruction:  If all of a zone’s NS records are valid, then the default behavior in BIND complies with this requirement and does not require the DNS software administrator to take any additional action.

In some cases, the DNS software administrator must implement a non-default configuration to comply with operation requirements.  If this is the case, the DNS software administrator must have an understanding of the named.conf options that govern how master name servers notify other hosts of zone changes and when slave servers will accept notifications.  If none of these options are selected, the resulting behavior represents an acceptable security risk.  If these phrases are configured, then this is a finding.

The phrases within the options statement that govern this behavior are:

-	notify – which turns notification on or off (defaults to on)

-	allow-notify – which defines from which servers a slave will accept notifications (defaults to the master name server only)

Windows DNS

Instruction:  This check is not applicable to those Windows DNS Zones that are active directory integrated.  Those zones will be replicated through active directory.  For those servers running as a standard secondary zone, verify the name servers listed are only those authoritative for the zone.  From the DNS management console snap-in, expand the Forward Lookup zones branch, select the zone you want to configure and right click and select Properties.  Verify the entries under the Name Servers tab are only those authoritative for the zone.

In cases in which the name server is not running BIND or Windows DNS, the reviewer must still examine the configuration and its documentation to validate this requirement.
</check-content></check></Rule></Group><Group id="V-4486"><title>Recursion is not prohibited.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4486r3_rule" severity="medium" weight="10.0"><version>DNS0475</version><title>Recursion is not prohibited on an authoritative name server.</title><description>&lt;VulnDiscussion&gt;A potential vulnerability of DNS is that an attacker can poison a name server's cache by sending queries that will cause the server to obtain host-to-IP address mappings from bogus name servers that respond with incorrect information. Once a name server has been poisoned, legitimate clients may be directed to non-existent hosts (which constitutes a denial of service) or, worse, hosts that masquerade as legitimate ones to obtain sensitive data or passwords.

To guard against poisoning, name servers authoritative for .mil domains should be separated functionally from name servers that resolve queries on behalf of internal clients. Organizations may achieve this separation by dedicating machines to each function or, if possible, by running two instances of the name server software on the same machine; one for the authoritative function and the other for the resolving function. In this design, each name server process may be bound to a different IP address or network interface to implement the required segregation.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4371r1_fix">The DNS Administrator should configure the authoritative name server to prohibit recursion.  Configuration details may be found in the DNS STIG.</fixtext><fix id="F-4371r1_fix" /><check system="C-47004r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND

The reviewer should identify the recursion and allow-query phrases.  They should look as follows:

Options {
recursion no;
allow-query {none;};
};

Zone “example.com” {
	Type master;
	File “db.example.com”;
	Allow-query { address_match_list };
};

If either of these phrases is missing or have a value other than what is listed above, then this is a finding.

Windows 2003 DNS

Instruction:  This check only applies if the name server is a master name server, the Windows DNS servers are to only be configured as master name servers.
Open the DNS management console snap-in.  Right click on the server and select properties.  If available, under the forwarders tab ensure enable forwarders is not selected.  If “Enable forwarders” is checked, this constitutes a finding.
Also examine the “Advanced” tab of the DNS server “Properties” dialog box.  If “Disable recursion” is not checked, then this is a finding. 
</check-content></check></Rule></Group><Group id="V-4487"><title>Recursive queries not restricted.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4487r2_rule" severity="medium" weight="10.0"><version>DNS0480</version><title>A caching name server does not restrict recursive queries to only the IP addresses and IP address ranges of known supported clients.</title><description>&lt;VulnDiscussion&gt;Any host that can query a resolving name server has the potential to poison the servers name cache or take advantage of other vulnerabilities that may be accessed through the query service.  The best way to prevent this type of attack is to limit queries to internal hosts, which need to have this service available to them.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4372r1_fix">The DNS software administrator should configure the caching name server to accept recursive queries only from the IP addresses and address ranges of known supported.  Configuration details for BIND and Windows DNS  may be found in the DNS STIG.</fixtext><fix id="F-4372r1_fix" /><check system="C-3546r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND

Instruction:  This check is only applicable to caching name servers.  Verify the allow-query and allow-recursion phrases are properly configured.

The reviewer should identify the allow-query and allow-recursion phrases.  It should look as follows:

allow-query {trustworthy_hosts;};
allow-recursion {trustworthy_hosts;};

The name of the ACL does not need to be “trustworthy_hosts” but the name should match the ACL name defined earlier in named.conf for this purpose.  If not, then this is a finding.  The reviewer will also check for whether non-internal IP addresses appear in either the referenced ACL (e.g., trustworthy_hosts) or directly in the statements themselves.  If non-internal IP addresses do appear, then this is a finding.

Windows 2000/2003 DNS

Instruction:  Windows 2000/2003 DNS should not be deployed as a caching name server.  Consequently, the use of forwarders and recursion is prohibited on Windows  DNS.  The reviewer will validate that the "Disable recursion" and the “Secure cache against pollution" on the “Advanced” tab of the name server properties are selected.  Examine the “Advanced” tab of the DNS Server “Properties” dialog box.  If “Disable recursion” and “Secure cache against pollution” is not checked, then this is a finding.

The reviewer will also validate, if available, that the "Enable forwarders" on the “Forwarders” tab of the name server properties is not selected.  Examine the “Forwarders” tab of the DNS Server “Properties” dialog box.  If “Enable forwarders” is checked, then this is a finding.

In cases in which the name server is not running BIND or Windows 2000/2003 DNS, the reviewer must still examine the configuration and its documentation to validate this requirement.
</check-content></check></Rule></Group><Group id="V-4488"><title>Name server logging is inadequate.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4488r3_rule" severity="high" weight="10.0"><version>DNS0485</version><title>The DNS software must log success and failure events when starting and stopping of the name server service daemon, zone transfers, zone update notifications, and dynamic updates. </title><description>&lt;VulnDiscussion&gt;Logging must be comprehensive to be useful for both intrusion monitoring and security investigations. Setting logging at the severity notice should capture most relevant events without requiring unacceptable levels of data storage. The severity levels info and debug are also available to organizations that require additional logging for certain events or applications.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;DNS0485&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;A violation of this requirement can have one of two severity levels depending upon the extent of the violation.  If no logging exists, then the discrepancy would be a Category I finding.  If some logging exists, but not for all of the events listed, then the discrepancy would be a Category II finding.&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECAT-1, ECAT-2&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4373r1_fix">The DNS software administrator will configure the DNS software to log, at a minimum, success and failure of the following events:

- start and stop of the name server service or daemon
- zone transfers
- zone update notifications
- dynamic updates

</fixtext><fix id="F-4373r1_fix" /><check system="C-3547r2_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>The default level for logging was modified in BIND version 9.7. Starting at that version logging is set to debugging level by default. Therefore, if the logging statement is missing AND the version is 9.7 or more recent, this is NOT a finding.

For a BIND configuration for versions before 9.7, if a logging statement is present, it will have the form:

logging {
      channel channel_name
            file path_name | syslog syslog_facility
severity (critical | error | warning |
            notice | info | debug [level]| dynamic);]
print-severity yes/no;
print-time yes/no;
}; 

category category_name {
      channel_name ; [ channel_name ; … 
            }; 
};

Instruction: If a logging statement is not present and the BIND version is prior to 9.7, then this is a finding. The reviewer will look at the severity clause in each of the channel phrases of the logging statement. It should read either notice, info or debug for each defined channel (although debug would not typically appear unless the review is concurrent with a troubleshooting effort). If the logging statement is not properly configured, then this is a finding.

NOTE: Debug level may cause operational issues due to log file sizes and is therefore not a requirement for anything other than troubleshooting purposes.

Windows DNS

Instruction: For a Windows 2003 DNS configuration: On the “Logging Tab” or “Debug Logging” tab of the “DNS Server Properties” dialog box, if “Log Packets for “Notify” and “Update” are not checked, then this is a finding.

Mitigation:
A violation of this requirement can have one of two severity levels depending upon the extent of the violation. If no logging exists, then the discrepancy would be a Category I finding. If some logging exists, but not for all of the events listed, then the discrepancy would be a Category II finding.</check-content></check></Rule></Group><Group id="V-4489"><title>Name server logs are not adequately secured.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4489r2_rule" severity="medium" weight="10.0"><version>DNS0490</version><title>The DNS software administrator has not configured the DNS software to send all log data to either the system logging facility (e.g., UNIX syslog or Windows Application Event Log) or an alternative logging facility with security configuration equivalent to or more restrictive than the system logging facility.</title><description>&lt;VulnDiscussion&gt;On name servers, DNS log data is typically more sensitive than system log data and, consequently, should benefit from security controls at least as restrictive as those for the system logging facility.  DNS software administrators require DNS transaction logs for a wide variety of reasons including troubleshooting, intrusion detection, and forensics.  These logs should be appropriately secured, having file permissions that restrict unauthorized changes or viewing, and archived, being appropriately backed-up and stored in order for them to be examined at a future time.  Furthermore, it is required that the logs be reviewed daily.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;COBR-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4374r1_fix">The DNS software administrator should either configure named.conf to utilize the system logging facility or place additional technical controls (e.g., more restrictive file permissions) on the alternative logging facility so that it is as least as secure as the system logging facility.</fixtext><fix id="F-4374r1_fix" /><check system="C-3553r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>DNS software administrators need DNS transaction logs for a wide variety of reasons including troubleshooting, intrusion detection, and forensics.  These logs should be appropriately secured, having file permissions that restrict unauthorized changes or viewing, and archived, being appropriately backed-up and stored so that they can be examined at a future time.

BIND

The DNS software administrator will configure the DNS software to send all log data to either the system logging facility (e.g., UNIX syslog or Windows Application Event Log) or an alternative logging facility with security configuration equivalent to or more restrictive than the system logging facility.

Instruction:  On an examination of the DNS configuration file (if BIND, named.conf), the reviewer can determine whether log data is sent to a facility other than the system logging facility.  If this is the case, then the reviewer should do the following at a minimum:

-  Compare the file permissions of the operating system logs with the file permissions of the alternative logging facility for DNS (e.g., using ls –l).  If the permissions on the alternative are weaker in any manner, this constitutes a finding.

-  Determine whether the system logs are transferred or copied to media on another machine (e.g., a cron job that periodically moves logs to another computer).  If this is the case and there is not a similar technology in place for the DNS logs, then this constitutes a finding.

The reviewer can identify other ways in which the security of the DNS logs may be weaker than the security of the system logs, and can generate a finding based on that discovery so long as the explanation of the weakness is clearly documented in the SRR results.

Windows DNS

Windows DNS software log files will be equivalent to the system logging facility by default.  In addition,  the DNS debug log file should be checked at %systemroot%\system32\dns\dns.log. The permissions should be restricted to the Administrators and/or Auditors group (in accordance with the Windows STIG permission settings for Windows Event Log settings) on the local computer or the Domain Admins group.

In cases in which the name server is not running BIND or Windows DNS, the reviewer must still examine the configuration and its documentation to validate this requirement.
</check-content></check></Rule></Group><Group id="V-4490"><title>Name server logs do not contain timestamps.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4490r2_rule" severity="low" weight="10.0"><version>DNS0495</version><title>Entries in the name server logs do not contain timestamps and severity information.</title><description>&lt;VulnDiscussion&gt;Forensic analysis of security incidents and day-to-day monitoring are substantially more difficult if there are no timestamps on log entries.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECAR-1, ECAR-2, ECAR-3, ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4375r1_fix">The DNS software administrator should configure the DNS software to add timestamps and severity information to each entry in all logs. Configuration details for BIND may be found in the DNS STIG Section 4.2.5.</fixtext><fix id="F-4375r1_fix" /><check system="C-3554r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND

Instruction:  Based on the logging statement in named.conf, the reviewer can determine where the DNS logs are located.  If there logging is not configured, then this is a finding.  These logs (which in many cases are likely to be the system logs), should be viewed using the UNIX cat or tail commands, a text editor, or – in the case of Windows – the “Event Viewer.”  When examining the logs, the reviewer should ensure that entries have timestamps and severity codes.  If timestamps and severity codes are not found on one or more entries, then this is a finding.

logging {
		channel channel_name
			file path_name | syslog syslog_facility
severity (critical | error | warning |
  notice | info | debug [level]| dynamic);]
			print-severity yes/no;
			print-time yes/no;
		}; 
		category category_name {
			channel_name ; [ channel_name ; … 
		}; 
};

Instruction:  If the DNS entries in the logs do not note their severity (i.e., critical, error, warning, notice, or info), then this constitutes a finding.

Windows DNS

Windows DNS software adds timestamps and severity information by default.

In cases in which the name server is not running BIND or Windows DNS, the reviewer must still examine the configuration and its documentation to validate this requirement.
</check-content></check></Rule></Group><Group id="V-4492"><title>The root hints file is not deleted.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4492r2_rule" severity="low" weight="10.0"><version>DNS0505</version><title>The DNS software administrator has not removed the root hints file on an authoritative name server in order for it to resolve only those records for which it is authoritative, and ensure that all other queries are refused.</title><description>&lt;VulnDiscussion&gt;A potential vulnerability of DNS is that an attacker can poison a name servers cache by sending queries that will cause the server to obtain host-to-IP address mappings from bogus name servers that respond with incorrect information.   The DNS architecture needs to maintain one name server whose zone records are correct and the cache is not poisoned, in this effort the authoritative name server may not forward queries, one of the ways to prevent this, the root hints file is to be deleted.
When authoritative servers are sent queries for zones that they are not authoritative for, and they are configured as a non-caching server (as recommended), they can either be configured to return a referral to the root servers or they can be configured to refuse to answer the query.  The requirement  is to configure authoritative servers to refuse to answer queries for any zones for which they are not authoritative.  This is more efficient for the server, and allows it to spend more of its resources doing what its intended purpose is; answering authoritatively for its zone.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4377r1_fix">The SA should remove the root hints file.  For a BIND installation, the SA should remove the root hints file. Common names for the root hints file are root.hints, named.cache, or db.cache.  The name is configurable within the named.conf file.  

For a Windows 2000/2003 DNS configuration, the SA should: Select the Root Hints Tab of the DNS Server Properties dialog box, to remove entries, right click the entry and click the Remove button.</fixtext><fix id="F-4377r1_fix" /><check system="C-3558r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND

Instruction:  This check only applies if the name server is an authoritative name server.  Ensure there is not a root hints on the name server.  Common names for the root hints file are root.hints, named.cache, or db.cache.  The name is configurable within the named.conf file.

Windows DNS

This check only applies if the name server is an authoritative name server.  For a Windows 2000/2003 DNS configuration: Select the “Root Hints” Tab of the “DNS Server Properties” dialog box, ensure the root name server entries have been removed.  To remove entries, right click the entry and click the “Remove” button.
</check-content></check></Rule></Group><Group id="V-4501"><title>The DHCP server service is not disabled.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4501r1_rule" severity="high" weight="10.0"><version>DNS0805</version><title>The DHCP server service is not disabled on any Windows 2000/2003 DNS server that supports dynamic updates.</title><description>&lt;VulnDiscussion&gt;There is a significant vulnerability potential when the DHCP service runs using the computer account of a Windows Domain Controller, as in the default Windows configuration. This account has full control over all DNS objects stored in Active Directory. In this case the DHCP server has access to modify the SRV (and other) records for all the Domain Controllers. When these records were replicated to other domain controllers (when AD Integrated DNS is used as required by the STIG), all the Windows DNS servers could potentially be compromised. &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECCD-1, ECCD-2&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4386r1_fix">Working with appropriate SA and technical personnel, the IAO should plan to migrate the DHCP service to another machine as soon as it is feasible to do so.</fixtext><fix id="F-4386r1_fix" /><check system="C-3561r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>Log in to the server with an account that has admin rights.  Right-click “My Computer” on the desktop and click “Manage.”  This brings up the “Computer Management” tool.  

Click the plus sign next to “Services and Applications” on the left pane to expand it.  Select “Services” on the left panel.

On the right pane, scroll down and select “DHCP Server.”  Right-click “DHCP Server” and click “Properties.”  This brings up the “DCHP Server Properties”.

The reviewer will validate the DHCP server service is disabled.  The “Disabled” drop down selection is to be selected on the “General” tab of the “DHCP Server Properties.”  If the DHCP server service is not disabled, then this is a finding.</check-content></check></Rule></Group><Group id="V-4502"><title>Zone transfers are not prohibited.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4502r1_rule" severity="high" weight="10.0"><version>DNS0810</version><title>Zone transfers are not prohibited or a VPN solution is not implemented that requires cryptographic authentication of communicating devices and is used exclusively by name servers authoritative for the zone.</title><description>&lt;VulnDiscussion&gt;If zone transfers are not cryptographically authenticated, then there is the potential for an adversary to masquerade as a legitimate zone partner and update zone records without authorization.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;DNS0810&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;If all DNS servers are in a secured Enclave with all appropriate network infrastructure protections and communicate strictly behind the perimeter,  or on a non-contiguous network where the public links between site segments are protected with site-to-site VPNs, and where such network is completely controlled by the server owner, and where access to the network is protected IAW the network infrastructure STIG,  and access to the DNS servers and resources is limited to members and servers of the DNS server owner's organization, then this finding can be downgraded to a CAT II.
&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;DCNR-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4387r1_fix">Working with relevant DNS administrators, the SA should configure Windows DNS to rely on Active Directory to replicate zone data whenever possible.  If this is not feasible, then the SA must establish an IPSEC VPN between relevant zone partners or implement a satisfactory alternative encryption-based authentication technology.

</fixtext><fix id="F-4387r1_fix" /><check system="C-3563r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>The reviewer will validate zone transfers are prohibited.  The reviewer will ensure the "Allow zone transfers" check box is not selected on the “Zone Transfers” tab of the name server properties.

If zone transfers are allowed, then this is a finding.

Windows allows for two ways of synchronizing zone data across name servers: (1) traditional RFC-compliant DNS zone transfers; and (2) AD-replication.  The latter only works when Windows DNS is integrated with AD, which makes each of the DNS records an AD object.  The Windows 2000/2003 DNS implementation of traditional zone transfers does not meet the STIG requirement that the transfers be cryptographically authenticated using a technology such as TSIG.  Fortunately, AD-replication is cryptographically authenticated.  Therefore, the solution in a pure Windows 2000/2003 DNS implementation is to integrate DNS with AD and disable zone transfers</check-content></check></Rule></Group><Group id="V-4503"><title>Forwarders not disabled on Windows DNS server.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4503r1_rule" severity="medium" weight="10.0"><version>DNS0815</version><title>Forwarders on an authoritative Windows 2000/2003 DNS server are not disabled.</title><description>&lt;VulnDiscussion&gt;Windows DNS has historically been more vulnerable to cache poisoning attacks than BIND as the algorithm used for answering recursive queries also makes it more prone to self-imposed denial of service attacks and as an amplification device for attacks on other DNS servers. Additionally, Windows DNS does not allow for the fine-grained access control restrictions (i.e., limiting the clients that are able to perform recursion) that are allowed by BIND and other recursive DNS appliances. Therefore, Windows 2000/2003 DNS should not be deployed as a caching name server.  Consequently, the use of forwarders and recursion is prohibited on Windows 2000/2003 DNS servers.  &lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4388r1_fix">The SA should disable forwarding (on the Forwarders tab of the name servers properties dialog box).</fixtext><fix id="F-4388r1_fix" /><check system="C-3564r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>Windows DNS should not be deployed as a caching name server.  Consequently, the use of forwarders and recursion is prohibited on Windows 2000/2003 DNS.  The reviewer will validate that the "Enable Forwarders" check box is not selected on the “Forwarders” tab of the name server properties.

If forwarders are enabled, then this is a finding.
</check-content></check></Rule></Group><Group id="V-4505"><title>WINS lookups is not prohibited on W2K server.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-4505r1_rule" severity="high" weight="10.0"><version>DNS0825</version><title>WINS lookups is not prohibited on a Windows 2000 DNS server.</title><description>&lt;VulnDiscussion&gt;Integration of WINS and Windows 2000 DNS leaves Windows 2000 DNS open to all the vulnerabilities of WINS, including the ability to update records without authentication.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-4390r1_fix">The SA should disable any integration between DNS and WINS as soon as it feasible to do so.  If WINS is required for legacy applications, then DNS clients will need to be reconfigured to use WINS rather than DNS for NetBIOS name resolution.  The SA should uncheck Use WINS forward lookup on the WINS tab on the properties dialog of each zone.</fixtext><fix id="F-4390r1_fix" /><check system="C-3566r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>The reviewer will validate the "Use WINS forward lookup" is not checked on the “WINS” tab on the properties dialog of each zone.

If WINS is integrated on a Windows 2000 DNS server, then this is a finding.</check-content></check></Rule></Group><Group id="V-12479"><title>Computer accounts are members of DNSUpdateProxy.</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-13038r1_rule" severity="medium" weight="10.0"><version>DNS0260</version><title>Computer accounts for DHCP servers are members of the DNSUpdateProxy group.</title><description>&lt;VulnDiscussion&gt;A built-in security group, DNSUpdateProxy, is provided as of Windows 2000. This group can update DNS records for clients without becoming the owner of the records. When DHCP servers are added as members of this group, any of the (member) DHCP servers can update the records. The first user that is not a member of the DNSUpdateProxy group to modify the records associated with a client; becomes the owner. There is a vulnerability for all servers (even non-domain controllers) on which a DHCP service runs. The DNS records associated with the DHCP server host could be modified by other DHCP servers that are members of the DNSUpdateProxy group. In order to prevent this from occurring, DHCP should not be installed on a domain controller if the group DNSUpdateProxy is utilized.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECLP-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-11799r1_fix">The IAO will ensure computer accounts for DHCP servers are not members of the DNSUpdateProxy group.</fixtext><fix id="F-11799r1_fix" /><check system="C-8639r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>Review the membership of the DNSUpdateProxy group to determine if any of the computer accounts are DHCP servers. If there are any computer accounts for DHCP servers, this is a finding. 

View Computer Management, Local Users and Groups, Groups. Review the membership of the DNSUpdateProxy group to determine if any of the accounts are DHCP servers. </check-content></check></Rule></Group><Group id="V-14756"><title>IPv6 link-local scope addresses are not configured</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15513r1_rule" severity="low" weight="10.0"><version>DNS4600</version><title>The DNS administrator will ensure non-routeable IPv6 link-local scope addresses are not configured in any zone.  Such addresses begin with the prefixes of “FE8”, “FE9”, “FEA”, or “FEB”.</title><description>&lt;VulnDiscussion&gt;IPv6 link local scope addresses are not globally routable and must not be configured in any DNS zone.  Similar to RFC1918, addresses, if a link-local scope address is inserted into a zone provided to clients, most routers will not forward this traffic beyond the local subnet.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Other&lt;/Responsibility&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-14234r1_fix">The SA should remove any link-local addresses and replace with appropriate Site-Local or Global scope addresses.</fixtext><fix id="F-14234r1_fix" /><check system="C-12979r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND

•	Instruction:  Examine all zone statements contained in the named.conf file for a line containing the word file designating the actual file that stores the zones records.  Examine the file that contains zones records for any IPv6 addresses containing the prefixes “FE8”, “FE9”, “FEA”, or “FEB”. If any link-local scope addresses are found, then this is a finding.


Windows DNS

•	Instruction:  From the windows task bar, select Start, Programs/All Programs, Administrative Tools, DNS to open the DNS management console.  Expand the Forward Lookup Zones folder.  Expand each zone folder and examine the host record entries.  The third column titled Data will display the IP.  Verify this column does not contain any IP address that begin with the prefixes  “FE8”, “FE9”, “FEA”, or “FEB”.


</check-content></check></Rule></Group><Group id="V-14757"><title>AAAA addresses are on host that is not IPv6 aware</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15514r1_rule" severity="low" weight="10.0"><version>DNS4610</version><title>AAAA addresses are configured  on a host that is not IPv6 aware.</title><description>&lt;VulnDiscussion&gt;DNS is only responsible for resolving a domain name to an ip address.  Applications and operating systems are responsible for processing the IPv6 or IPv4 record that may be returned.  With this in mind, a denial of service could easily be implemented for an application that is not IPv6 aware.  When the application receives an i.p. address in hexadecimal, it is up to the application/operating system to decide how to handle the response.  Combining both IPv6 and IPv4 records into the same domain can lead to application problems that are beyond the scope of the DNS administrator.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;Other&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-14235r1_fix">The SA should remove the IPv6 records from the IPv4 zone and create a second zone with all IPv6 records.</fixtext><fix id="F-14235r1_fix" /><check system="C-12980r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>BIND

•	Instruction:  Examine all zone statements contained in the named.conf file for a line containing the word file designating the actual file that stores the zones records.  Examine the file that contains zones records and verify IPv6 and IPv4 resource records are not in the same file.  If the records are found in the same file, then this is a finding.


Windows DNS

Instruction:  From the Windows task bar, select Start, Programs/All Programs, Administrative Tools, DNS to open the DNS management console.  Expand the Forward Lookup Zones folder.  Expand each zone folder and examine the host record entries.  The third column titled Data will display the IP.  Verify this column does not contain both IPv4 and IPv6 addresses.

</check-content></check></Rule></Group><Group id="V-14768"><title>IPv6 properly configured on server</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-15525r1_rule" severity="medium" weight="10.0"><version>DNS4630</version><title>The IPv6 protocol is installed and the server is only configured to respond to IPv4 A records.</title><description>&lt;VulnDiscussion&gt;To prevent the possibility of a denial of service in relation to an IPv4 DNS server trying to respond to IPv6 requests, the server should be configured not to listen on any of its IPv6 interfaces unless it does contain IPv6 AAAA resource records in one of the zones.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;System Administrator&lt;/Responsibility&gt;&lt;IAControls&gt;ECSC-1&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target Windows DNS</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>Windows DNS</dc:subject><dc:identifier>960</dc:identifier></reference><fixtext fixref="F-14244r1_fix">The DNS administrator will uninstall IPv6 from any lan interface that is not hosting IPv6 AAAA records within its zones. The following steps should be followed to uninstall IPv6 on an interface:


-Click Start, click Control Panel, and the double-click Network Connections.
-Right-click any local area connection, and then click Properties.
-The display will contain, Microsoft TCP/IP version 6 with a check next to the item if IPv6 is installed.
-Select Microsoft TCP/IP version 6 and then click Uninstall.
-Select Yes to confirm the removal.
-Select Yes restart the computer for the new settings to take effect.
</fixtext><fix id="F-14244r1_fix" /><check system="C-12991r1_chk"><check-content-ref name="M" href="DPMS_XCCDF_Benchmark_Windows DNS.xml" /><check-content>Windows
•Instruction:  Click Start, click All Programs, click Administrative Tools, and select DNS.  Expand the Forward Lookup Zones folder. Expand each zone and check for IPv6 records.  If all records are IPv4, then confirm IPv6 is not enabled on any of the lan interfaces with the following:

-Click Start, click Control Panel, and the double-click Network Connections.
-Right-click any local area connection, and then click Properties.
-The display will contain,  Microsoft TCP/IP version 6 with a check next to the item if IPv6 is installed.
</check-content></check></Rule></Group></Benchmark>