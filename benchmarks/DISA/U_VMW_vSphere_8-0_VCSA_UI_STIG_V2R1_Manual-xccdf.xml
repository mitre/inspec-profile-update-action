<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type='text/xsl' href='STIG_unclass.xsl'?><Benchmark xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:cpe="http://cpe.mitre.org/language/2.0" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:dsig="http://www.w3.org/2000/09/xmldsig#" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.1.xsd" id="VMW_vSphere_8-0_VCSA_UI_STIG" xml:lang="en" xmlns="http://checklists.nist.gov/xccdf/1.1"><status date="2024-07-11">accepted</status><title>VMware vSphere 8.0 vCenter Appliance User Interface (UI) Security Technical Implementation Guide</title><description>This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.</description><notice id="terms-of-use" xml:lang="en"></notice><front-matter xml:lang="en"></front-matter><rear-matter xml:lang="en"></rear-matter><reference href="https://cyber.mil"><dc:publisher>DISA</dc:publisher><dc:source>STIG.DOD.MIL</dc:source></reference><plain-text id="release-info">Release: 1 Benchmark Date: 01 Aug 2024</plain-text><plain-text id="generator">3.5</plain-text><plain-text id="conventionsVersion">1.10.0</plain-text><version>2</version><Profile id="MAC-1_Classified"><title>I - Mission Critical Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259104" selected="true" /><select idref="V-259105" selected="true" /><select idref="V-259106" selected="true" /><select idref="V-259107" selected="true" /><select idref="V-259108" selected="true" /><select idref="V-259109" selected="true" /><select idref="V-259110" selected="true" /><select idref="V-259111" selected="true" /><select idref="V-259112" selected="true" /><select idref="V-259113" selected="true" /><select idref="V-259114" selected="true" /><select idref="V-259115" selected="true" /><select idref="V-259116" selected="true" /><select idref="V-259117" selected="true" /><select idref="V-259118" selected="true" /><select idref="V-259119" selected="true" /><select idref="V-259120" selected="true" /><select idref="V-259121" selected="true" /><select idref="V-259122" selected="true" /><select idref="V-259123" selected="true" /><select idref="V-259124" selected="true" /><select idref="V-259125" selected="true" /><select idref="V-259126" selected="true" /><select idref="V-259127" selected="true" /><select idref="V-259128" selected="true" /><select idref="V-259129" selected="true" /><select idref="V-259130" selected="true" /><select idref="V-259131" selected="true" /><select idref="V-259132" selected="true" /><select idref="V-259133" selected="true" /><select idref="V-259134" selected="true" /><select idref="V-259135" selected="true" /><select idref="V-259136" selected="true" /></Profile><Profile id="MAC-1_Public"><title>I - Mission Critical Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259104" selected="true" /><select idref="V-259105" selected="true" /><select idref="V-259106" selected="true" /><select idref="V-259107" selected="true" /><select idref="V-259108" selected="true" /><select idref="V-259109" selected="true" /><select idref="V-259110" selected="true" /><select idref="V-259111" selected="true" /><select idref="V-259112" selected="true" /><select idref="V-259113" selected="true" /><select idref="V-259114" selected="true" /><select idref="V-259115" selected="true" /><select idref="V-259116" selected="true" /><select idref="V-259117" selected="true" /><select idref="V-259118" selected="true" /><select idref="V-259119" selected="true" /><select idref="V-259120" selected="true" /><select idref="V-259121" selected="true" /><select idref="V-259122" selected="true" /><select idref="V-259123" selected="true" /><select idref="V-259124" selected="true" /><select idref="V-259125" selected="true" /><select idref="V-259126" selected="true" /><select idref="V-259127" selected="true" /><select idref="V-259128" selected="true" /><select idref="V-259129" selected="true" /><select idref="V-259130" selected="true" /><select idref="V-259131" selected="true" /><select idref="V-259132" selected="true" /><select idref="V-259133" selected="true" /><select idref="V-259134" selected="true" /><select idref="V-259135" selected="true" /><select idref="V-259136" selected="true" /></Profile><Profile id="MAC-1_Sensitive"><title>I - Mission Critical Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259104" selected="true" /><select idref="V-259105" selected="true" /><select idref="V-259106" selected="true" /><select idref="V-259107" selected="true" /><select idref="V-259108" selected="true" /><select idref="V-259109" selected="true" /><select idref="V-259110" selected="true" /><select idref="V-259111" selected="true" /><select idref="V-259112" selected="true" /><select idref="V-259113" selected="true" /><select idref="V-259114" selected="true" /><select idref="V-259115" selected="true" /><select idref="V-259116" selected="true" /><select idref="V-259117" selected="true" /><select idref="V-259118" selected="true" /><select idref="V-259119" selected="true" /><select idref="V-259120" selected="true" /><select idref="V-259121" selected="true" /><select idref="V-259122" selected="true" /><select idref="V-259123" selected="true" /><select idref="V-259124" selected="true" /><select idref="V-259125" selected="true" /><select idref="V-259126" selected="true" /><select idref="V-259127" selected="true" /><select idref="V-259128" selected="true" /><select idref="V-259129" selected="true" /><select idref="V-259130" selected="true" /><select idref="V-259131" selected="true" /><select idref="V-259132" selected="true" /><select idref="V-259133" selected="true" /><select idref="V-259134" selected="true" /><select idref="V-259135" selected="true" /><select idref="V-259136" selected="true" /></Profile><Profile id="MAC-2_Classified"><title>II - Mission Support Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259104" selected="true" /><select idref="V-259105" selected="true" /><select idref="V-259106" selected="true" /><select idref="V-259107" selected="true" /><select idref="V-259108" selected="true" /><select idref="V-259109" selected="true" /><select idref="V-259110" selected="true" /><select idref="V-259111" selected="true" /><select idref="V-259112" selected="true" /><select idref="V-259113" selected="true" /><select idref="V-259114" selected="true" /><select idref="V-259115" selected="true" /><select idref="V-259116" selected="true" /><select idref="V-259117" selected="true" /><select idref="V-259118" selected="true" /><select idref="V-259119" selected="true" /><select idref="V-259120" selected="true" /><select idref="V-259121" selected="true" /><select idref="V-259122" selected="true" /><select idref="V-259123" selected="true" /><select idref="V-259124" selected="true" /><select idref="V-259125" selected="true" /><select idref="V-259126" selected="true" /><select idref="V-259127" selected="true" /><select idref="V-259128" selected="true" /><select idref="V-259129" selected="true" /><select idref="V-259130" selected="true" /><select idref="V-259131" selected="true" /><select idref="V-259132" selected="true" /><select idref="V-259133" selected="true" /><select idref="V-259134" selected="true" /><select idref="V-259135" selected="true" /><select idref="V-259136" selected="true" /></Profile><Profile id="MAC-2_Public"><title>II - Mission Support Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259104" selected="true" /><select idref="V-259105" selected="true" /><select idref="V-259106" selected="true" /><select idref="V-259107" selected="true" /><select idref="V-259108" selected="true" /><select idref="V-259109" selected="true" /><select idref="V-259110" selected="true" /><select idref="V-259111" selected="true" /><select idref="V-259112" selected="true" /><select idref="V-259113" selected="true" /><select idref="V-259114" selected="true" /><select idref="V-259115" selected="true" /><select idref="V-259116" selected="true" /><select idref="V-259117" selected="true" /><select idref="V-259118" selected="true" /><select idref="V-259119" selected="true" /><select idref="V-259120" selected="true" /><select idref="V-259121" selected="true" /><select idref="V-259122" selected="true" /><select idref="V-259123" selected="true" /><select idref="V-259124" selected="true" /><select idref="V-259125" selected="true" /><select idref="V-259126" selected="true" /><select idref="V-259127" selected="true" /><select idref="V-259128" selected="true" /><select idref="V-259129" selected="true" /><select idref="V-259130" selected="true" /><select idref="V-259131" selected="true" /><select idref="V-259132" selected="true" /><select idref="V-259133" selected="true" /><select idref="V-259134" selected="true" /><select idref="V-259135" selected="true" /><select idref="V-259136" selected="true" /></Profile><Profile id="MAC-2_Sensitive"><title>II - Mission Support Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259104" selected="true" /><select idref="V-259105" selected="true" /><select idref="V-259106" selected="true" /><select idref="V-259107" selected="true" /><select idref="V-259108" selected="true" /><select idref="V-259109" selected="true" /><select idref="V-259110" selected="true" /><select idref="V-259111" selected="true" /><select idref="V-259112" selected="true" /><select idref="V-259113" selected="true" /><select idref="V-259114" selected="true" /><select idref="V-259115" selected="true" /><select idref="V-259116" selected="true" /><select idref="V-259117" selected="true" /><select idref="V-259118" selected="true" /><select idref="V-259119" selected="true" /><select idref="V-259120" selected="true" /><select idref="V-259121" selected="true" /><select idref="V-259122" selected="true" /><select idref="V-259123" selected="true" /><select idref="V-259124" selected="true" /><select idref="V-259125" selected="true" /><select idref="V-259126" selected="true" /><select idref="V-259127" selected="true" /><select idref="V-259128" selected="true" /><select idref="V-259129" selected="true" /><select idref="V-259130" selected="true" /><select idref="V-259131" selected="true" /><select idref="V-259132" selected="true" /><select idref="V-259133" selected="true" /><select idref="V-259134" selected="true" /><select idref="V-259135" selected="true" /><select idref="V-259136" selected="true" /></Profile><Profile id="MAC-3_Classified"><title>III - Administrative Classified</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259104" selected="true" /><select idref="V-259105" selected="true" /><select idref="V-259106" selected="true" /><select idref="V-259107" selected="true" /><select idref="V-259108" selected="true" /><select idref="V-259109" selected="true" /><select idref="V-259110" selected="true" /><select idref="V-259111" selected="true" /><select idref="V-259112" selected="true" /><select idref="V-259113" selected="true" /><select idref="V-259114" selected="true" /><select idref="V-259115" selected="true" /><select idref="V-259116" selected="true" /><select idref="V-259117" selected="true" /><select idref="V-259118" selected="true" /><select idref="V-259119" selected="true" /><select idref="V-259120" selected="true" /><select idref="V-259121" selected="true" /><select idref="V-259122" selected="true" /><select idref="V-259123" selected="true" /><select idref="V-259124" selected="true" /><select idref="V-259125" selected="true" /><select idref="V-259126" selected="true" /><select idref="V-259127" selected="true" /><select idref="V-259128" selected="true" /><select idref="V-259129" selected="true" /><select idref="V-259130" selected="true" /><select idref="V-259131" selected="true" /><select idref="V-259132" selected="true" /><select idref="V-259133" selected="true" /><select idref="V-259134" selected="true" /><select idref="V-259135" selected="true" /><select idref="V-259136" selected="true" /></Profile><Profile id="MAC-3_Public"><title>III - Administrative Public</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259104" selected="true" /><select idref="V-259105" selected="true" /><select idref="V-259106" selected="true" /><select idref="V-259107" selected="true" /><select idref="V-259108" selected="true" /><select idref="V-259109" selected="true" /><select idref="V-259110" selected="true" /><select idref="V-259111" selected="true" /><select idref="V-259112" selected="true" /><select idref="V-259113" selected="true" /><select idref="V-259114" selected="true" /><select idref="V-259115" selected="true" /><select idref="V-259116" selected="true" /><select idref="V-259117" selected="true" /><select idref="V-259118" selected="true" /><select idref="V-259119" selected="true" /><select idref="V-259120" selected="true" /><select idref="V-259121" selected="true" /><select idref="V-259122" selected="true" /><select idref="V-259123" selected="true" /><select idref="V-259124" selected="true" /><select idref="V-259125" selected="true" /><select idref="V-259126" selected="true" /><select idref="V-259127" selected="true" /><select idref="V-259128" selected="true" /><select idref="V-259129" selected="true" /><select idref="V-259130" selected="true" /><select idref="V-259131" selected="true" /><select idref="V-259132" selected="true" /><select idref="V-259133" selected="true" /><select idref="V-259134" selected="true" /><select idref="V-259135" selected="true" /><select idref="V-259136" selected="true" /></Profile><Profile id="MAC-3_Sensitive"><title>III - Administrative Sensitive</title><description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</description><select idref="V-259104" selected="true" /><select idref="V-259105" selected="true" /><select idref="V-259106" selected="true" /><select idref="V-259107" selected="true" /><select idref="V-259108" selected="true" /><select idref="V-259109" selected="true" /><select idref="V-259110" selected="true" /><select idref="V-259111" selected="true" /><select idref="V-259112" selected="true" /><select idref="V-259113" selected="true" /><select idref="V-259114" selected="true" /><select idref="V-259115" selected="true" /><select idref="V-259116" selected="true" /><select idref="V-259117" selected="true" /><select idref="V-259118" selected="true" /><select idref="V-259119" selected="true" /><select idref="V-259120" selected="true" /><select idref="V-259121" selected="true" /><select idref="V-259122" selected="true" /><select idref="V-259123" selected="true" /><select idref="V-259124" selected="true" /><select idref="V-259125" selected="true" /><select idref="V-259126" selected="true" /><select idref="V-259127" selected="true" /><select idref="V-259128" selected="true" /><select idref="V-259129" selected="true" /><select idref="V-259130" selected="true" /><select idref="V-259131" selected="true" /><select idref="V-259132" selected="true" /><select idref="V-259133" selected="true" /><select idref="V-259134" selected="true" /><select idref="V-259135" selected="true" /><select idref="V-259136" selected="true" /></Profile><Group id="V-259104"><title>SRG-APP-000001-AS-000001</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259104r960735_rule" weight="10.0" severity="medium"><version>VCUI-80-000001</version><title>The vCenter UI service must limit the number of maximum concurrent connections permitted.</title><description>&lt;VulnDiscussion&gt;Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash.

Mitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the maxThreads attribute.

Satisfies: SRG-APP-000001-AS-000001, SRG-APP-000435-AS-000163&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000054</ident><ident system="http://cyber.mil/cci">CCI-002385</ident><fixtext fixref="F-62753r935215_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to the &lt;Connector&gt; node and configure with the value "maxThreads="800"".

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62753r935215_fix" /><check system="C-62844r935214_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath '/Server/Service/Connector[@port="${http.port}"]/@maxThreads' /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

maxThreads="800"

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-259105"><title>SRG-APP-000033-AS-000024</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259105r960792_rule" weight="10.0" severity="medium"><version>VCUI-80-000005</version><title>The vCenter UI service cookies must have secure flag set.</title><description>&lt;VulnDiscussion&gt;The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of a cookie in clear text.

By setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000213</ident><fixtext fixref="F-62754r935218_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Navigate to the &lt;session-config&gt; node and configure the &lt;secure&gt; setting as follows:

&lt;session-config&gt;
  &lt;session-timeout&gt;30&lt;/session-timeout&gt;
  &lt;cookie-config&gt;
      &lt;http-only&gt;true&lt;/http-only&gt;
      &lt;secure&gt;true&lt;/secure&gt;
  &lt;/cookie-config&gt;
&lt;/session-config&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62754r935218_fix" /><check system="C-62845r935217_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed 's/xmlns=".*"//g' | xmllint --xpath '/web-app/session-config/cookie-config/secure' -

Expected result:

&lt;secure&gt;true&lt;/secure&gt;

If the output of the command does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-259106"><title>SRG-APP-000092-AS-000053</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259106r960888_rule" weight="10.0" severity="medium"><version>VCUI-80-000013</version><title>The vCenter UI service must initiate session logging upon startup.</title><description>&lt;VulnDiscussion&gt;Logging must be started as soon as possible when a service starts and as late as possible when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001464</ident><fixtext fixref="F-62755r935221_fix">Navigate to and open:

/etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json

Below the last line of the "PreStartCommandArg" block, add the following line:

"StreamRedirectFile" : "%VMWARE_LOG_DIR%/vmware/vsphere-ui/logs/vsphere-ui-runtime.log",

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62755r935221_fix" /><check system="C-62846r935220_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json

Expected output:

"StreamRedirectFile" : "%VMWARE_LOG_DIR%/vmware/vsphere-ui/logs/vsphere-ui-runtime.log",

If no log file is specified for the "StreamRedirectFile" setting, this is a finding.</check-content></check></Rule></Group><Group id="V-259107"><title>SRG-APP-000095-AS-000056</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259107r960891_rule" weight="10.0" severity="medium"><version>VCUI-80-000014</version><title>The vCenter UI service must produce log records containing sufficient information regarding event details.</title><description>&lt;VulnDiscussion&gt;Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success.

Tomcat can be configured with an "AccessLogValve", a component that can be inserted into the request processing pipeline to provide robust access logging. The "AccessLogValve" creates log files in the same format as those created by standard web servers. When "AccessLogValve" is properly configured, log files will contain all the forensic information necessary in the case of a security incident.

Satisfies: SRG-APP-000095-AS-000056, SRG-APP-000016-AS-000013, SRG-APP-000080-AS-000045, SRG-APP-000089-AS-000050, SRG-APP-000090-AS-000051, SRG-APP-000091-AS-000052, SRG-APP-000096-AS-000059, SRG-APP-000097-AS-000060, SRG-APP-000098-AS-000061, SRG-APP-000099-AS-000062, SRG-APP-000100-AS-000063, SRG-APP-000343-AS-000030, SRG-APP-000375-AS-000211, SRG-APP-000495-AS-000220, SRG-APP-000499-AS-000224, SRG-APP-000503-AS-000228&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000067</ident><ident system="http://cyber.mil/cci">CCI-000130</ident><ident system="http://cyber.mil/cci">CCI-000131</ident><ident system="http://cyber.mil/cci">CCI-000132</ident><ident system="http://cyber.mil/cci">CCI-000133</ident><ident system="http://cyber.mil/cci">CCI-000134</ident><ident system="http://cyber.mil/cci">CCI-000166</ident><ident system="http://cyber.mil/cci">CCI-000169</ident><ident system="http://cyber.mil/cci">CCI-000171</ident><ident system="http://cyber.mil/cci">CCI-000172</ident><ident system="http://cyber.mil/cci">CCI-001487</ident><ident system="http://cyber.mil/cci">CCI-001889</ident><ident system="http://cyber.mil/cci">CCI-002234</ident><fixtext fixref="F-62756r935224_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Inside the &lt;Host&gt; node, find the "AccessLogValve" &lt;Valve&gt; node and replace the "pattern" element as follows:

pattern="%h %{x-forwarded-for}i %l %u %t &amp;quot;%r&amp;quot; %s %b %{#hashedClientId#}s %{#hashedRequestId#}r %I %D"

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62756r935224_fix" /><check system="C-62847r935223_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath '/Server/Service/Engine/Host/Valve[@className="org.apache.catalina.valves.AccessLogValve"]/@pattern' /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Example result:

pattern="%h %{x-forwarded-for}i %l %u %t &amp;quot;%r&amp;quot; %s %b %{#hashedClientId#}s %{#hashedRequestId#}r %I %D"

Required elements:

%h %{X-Forwarded-For}i %l %t %u &amp;quot;%r&amp;quot; %s %b

If the log pattern does not contain the required elements in any order, this is a finding.</check-content></check></Rule></Group><Group id="V-259108"><title>SRG-APP-000118-AS-000078</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259108r960930_rule" weight="10.0" severity="medium"><version>VCUI-80-000025</version><title>The vCenter UI service must protect logs from unauthorized access.</title><description>&lt;VulnDiscussion&gt;Log data is essential in the investigation of events. The accuracy of the information is always pertinent. One of the first steps an attacker will take is the modification or deletion of log records to cover tracks and prolong discovery. The web server must protect the log data from unauthorized modification.

Satisfies: SRG-APP-000118-AS-000078, SRG-APP-000119-AS-000079, SRG-APP-000120-AS-000080&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000162</ident><ident system="http://cyber.mil/cci">CCI-000163</ident><ident system="http://cyber.mil/cci">CCI-000164</ident><fixtext fixref="F-62757r935227_fix">At the command prompt, run the following commands:

# chmod o-w &lt;file&gt;
# chown vsphere-ui:users &lt;file&gt;

Note: Substitute &lt;file&gt; with the listed file.</fixtext><fix id="F-62757r935227_fix" /><check system="C-62848r935226_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# find /var/log/vmware/vsphere-ui/ -xdev -type f -a '(' -perm -o+w -o -not -user vsphere-ui -o -not -group users -a -not -group root ')' -exec ls -ld {} \;

If any files are returned, this is a finding.</check-content></check></Rule></Group><Group id="V-259109"><title>SRG-APP-000133-AS-000092</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259109r960960_rule" weight="10.0" severity="medium"><version>VCUI-80-000034</version><title>The vCenter UI service must limit privileges for creating or modifying hosted application shared files.</title><description>&lt;VulnDiscussion&gt;Application servers have the ability to specify that the hosted applications use shared libraries. The application server must have a capability to divide roles based upon duties wherein one project user (such as a developer) cannot modify the shared library code of another project user. The application server must also be able to specify that nonprivileged users cannot modify any shared library code at all.

Ensuring the Security Lifecycle Listener element is uncommented and sets a minimum Umask value will allow the server to perform a number of security checks when starting and prevent the service from starting if they fail.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001499</ident><fixtext fixref="F-62758r935230_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to the &lt;Server&gt; node and add or update the "org.apache.catalina.security.SecurityListener" as follows:

&lt;Listener className="org.apache.catalina.security.SecurityListener"/&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62758r935230_fix" /><check system="C-62849r935229_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath '/Server/Listener[@className="org.apache.catalina.security.SecurityListener"]' /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Example result:

&lt;Listener className="org.apache.catalina.security.SecurityListener"/&gt;

If the "org.apache.catalina.security.SecurityListener" listener is not present, this is a finding.

If the "org.apache.catalina.security.SecurityListener" listener is configured with a "minimumUmask" and is not "0007", this is a finding.</check-content></check></Rule></Group><Group id="V-259110"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259110r960963_rule" weight="10.0" severity="medium"><version>VCUI-80-000036</version><title>The vCenter UI service must disable stack tracing.</title><description>&lt;VulnDiscussion&gt;Stack tracing provides debugging information from the application call stacks when a runtime error is encountered. If stack tracing is left enabled, Tomcat will provide this call stack information to the requestor, which could result in the loss of sensitive information or data that could be used to compromise the system.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62759r935233_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to and locate:

'allowTrace="true"'

Remove the 'allowTrace="true"' setting.

Note: If "allowTrace" is not present, it defaults to false.

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62759r935233_fix" /><check system="C-62850r935232_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath "//Connector[@allowTrace = 'true']" /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

XPath set is empty

If any connectors are returned, this is a finding.</check-content></check></Rule></Group><Group id="V-259111"><title>SRG-APP-000142-AS-000014</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259111r960966_rule" weight="10.0" severity="medium"><version>VCUI-80-000037</version><title>The vCenter UI service must be configured to use a specified IP address and port.</title><description>&lt;VulnDiscussion&gt;The server must be configured to listen on a specified IP address and port. Without specifying an IP address and port for server to use, the server will listen on all IP addresses available.

Accessing the hosted application through an IP address normally used for nonapplication functions opens the possibility of user access to resources, utilities, files, ports, and protocols that are protected on the desired application IP address.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000382</ident><fixtext fixref="F-62760r935236_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to the &lt;Connector&gt; node and configure the port and address as follows.

port="${http.port}"
address="localhost"

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62760r935236_fix" /><check system="C-62851r935235_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath "//Connector[(@port = '0') or not(@address)]" /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

XPath set is empty

If any connectors are returned, this is a finding.</check-content></check></Rule></Group><Group id="V-259112"><title>SRG-APP-000223-AS-000150</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259112r961116_rule" weight="10.0" severity="medium"><version>VCUI-80-000057</version><title>The vCenter UI service must be configured to limit data exposure between applications.</title><description>&lt;VulnDiscussion&gt;If RECYCLE_FACADES is true or if a security manager is in use, a new facade object will be created for each request. This reduces the chances that a bug in an application might expose data from one request to another.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001664</ident><fixtext fixref="F-62761r935239_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Update or remove the following line:

org.apache.catalina.connector.RECYCLE_FACADES=true

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62761r935239_fix" /><check system="C-62852r935238_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command line, run the following command:

# grep RECYCLE_FACADES /usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Example result:

org.apache.catalina.connector.RECYCLE_FACADES=true

If "org.apache.catalina.connector.RECYCLE_FACADES" is not set to "true", this is a finding.

If the "org.apache.catalina.connector.RECYCLE_FACADES" setting does not exist, this is not a finding.</check-content></check></Rule></Group><Group id="V-259113"><title>SRG-APP-000225-AS-000166</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259113r961122_rule" weight="10.0" severity="medium"><version>VCUI-80-000062</version><title>The vCenter UI service must be configured to fail to a known safe state if system initialization fails.</title><description>&lt;VulnDiscussion&gt;Determining a safe state for failure and weighing that against a potential denial of service for users depends on what type of application the web server is hosting. It is preferable that the service abort startup on any initialization failure rather than continuing in a degraded, and potentially insecure, state.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001190</ident><fixtext fixref="F-62762r935242_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Add or change the following line:

org.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62762r935242_fix" /><check system="C-62853r935241_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command line, run the following command:

# grep EXIT_ON_INIT_FAILURE /usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Example result:

org.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true

If there are no results, or if the "org.apache.catalina.startup.EXIT_ON_INIT_FAILURE" is not set to "true", this is a finding.</check-content></check></Rule></Group><Group id="V-259114"><title>SRG-APP-000251-AS-000165</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259114r961158_rule" weight="10.0" severity="medium"><version>VCUI-80-000065</version><title>The vCenter UI service must set URIEncoding to UTF-8.</title><description>&lt;VulnDiscussion&gt;Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.

An attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or bypass security checks.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001310</ident><fixtext fixref="F-62763r935245_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Configure the &lt;Connector&gt; node with the value:

URIEncoding="UTF-8"

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62763r935245_fix" /><check system="C-62854r935244_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath "//Connector[@URIEncoding != 'UTF-8'] | //Connector[not[@URIEncoding]]" /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

XPath set is empty

If any connectors are returned, this is a finding.</check-content></check></Rule></Group><Group id="V-259115"><title>SRG-APP-000266-AS-000169</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259115r961167_rule" weight="10.0" severity="medium"><version>VCUI-80-000067</version><title>The vCenter UI service "ErrorReportValve showServerInfo" must be set to "false".</title><description>&lt;VulnDiscussion&gt;The Error Report Valve is a simple error handler for HTTP status codes that will generate and return HTML error pages. It can also be configured to return predefined static HTML pages for specific status codes and/or exception types. Disabling "showServerInfo" will only return the HTTP status code and remove all CSS from the default nonerror-related HTTP responses.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001312</ident><fixtext fixref="F-62764r935248_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Locate the following Host block:

&lt;Host ...&gt;
...
&lt;/Host&gt;

Inside this block, add or update the following on a new line:

&lt;Valve className="org.apache.catalina.valves.ErrorReportValve" showServerInfo="false" showReport="false"/&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62764r935248_fix" /><check system="C-62855r935247_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath '/Server/Service/Engine/Host/Valve[@className="org.apache.catalina.valves.ErrorReportValve"]' /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Example result:

&lt;Valve className="org.apache.catalina.valves.ErrorReportValve" showServerInfo="false" showReport="false"/&gt;

If the "ErrorReportValve" element is not defined or "showServerInfo" is not set to "false", this is a finding.</check-content></check></Rule></Group><Group id="V-259116"><title>SRG-APP-000295-AS-000263</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259116r1003678_rule" weight="10.0" severity="medium"><version>VCUI-80-000070</version><title>The vCenter UI service must set an inactive timeout for sessions.</title><description>&lt;VulnDiscussion&gt;Leaving sessions open indefinitely is a major security risk. An attacker can easily use an already authenticated session to access the hosted application as the previously authenticated user. By closing sessions after a set period of inactivity, the web server can make certain that those sessions that are not closed through the user logging out of an application are eventually closed.

Satisfies: SRG-APP-000295-AS-000263, SRG-APP-000389-AS-000253&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-004895</ident><ident system="http://cyber.mil/cci">CCI-002361</ident><fixtext fixref="F-62765r935251_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Navigate to the &lt;session-config&gt; node and configure the &lt;session-timeout&gt; as follows:

&lt;session-config&gt;
  &lt;session-timeout&gt;30&lt;/session-timeout&gt;
  &lt;cookie-config&gt;
      &lt;http-only&gt;true&lt;/http-only&gt;
      &lt;secure&gt;true&lt;/secure&gt;
  &lt;/cookie-config&gt;
&lt;/session-config&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62765r935251_fix" /><check system="C-62856r935250_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed 's/xmlns=".*"//g' | xmllint --xpath '/web-app/session-config/session-timeout' -

Example result:

&lt;session-timeout&gt;30&lt;/session-timeout&gt;

If the value of "session-timeout" is not "30" or less, or is missing, this is a finding.</check-content></check></Rule></Group><Group id="V-259117"><title>SRG-APP-000358-AS-000064</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259117r961395_rule" weight="10.0" severity="medium"><version>VCUI-80-000081</version><title>The vCenter UI service must offload log records onto a different system or media from the system being logged.</title><description>&lt;VulnDiscussion&gt;Information system logging capability is critical for accurate forensic analysis. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, filenames involved, and access control or flow control rules invoked.

Offloading is a common process in information systems with limited log storage capacity.

Centralized management of log records provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. Application servers and their related components are required to offload log records onto a different system or media than the system being logged.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001851</ident><fixtext fixref="F-62766r935254_fix">Navigate to and open:

vmware-services-vsphere-ui.conf

Create the file if it does not exist.

Set the contents of the file as follows:

#vsphere-ui main log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsphere_client_virgo.log"
      Tag="ui-main"
      Severity="info"
      Facility="local0")
#vsphere-ui change log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/changelog.log"
      Tag="ui-changelog"
      Severity="info"
      Facility="local0")
#vsphere-ui dataservice log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/dataservice.log"
      Tag="ui-dataservice"
      Severity="info"
      Facility="local0")
#vsphere-ui apigw log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/apigw.log"
      Tag="ui-apigw"
      Severity="info"
      Facility="local0")
#vsphere-ui equinox log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/equinox.log"
      Tag="ui-equinox"
      Severity="info"
      Facility="local0")
#vsphere-ui event log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/eventlog.log"
      Tag="ui-eventlog"
      Severity="info"
      Facility="local0")
#vsphere-ui op id log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/opId.log"
      Tag="ui-opid"
      Severity="info"
      Facility="local0")
#vsphere-ui performance audit log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/performanceAudit.log"
      Tag="ui-performanceAudit"
      Severity="info"
      Facility="local0")
#vsphere-ui plugin-medic log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/plugin-medic.log"
      Tag="ui-plugin-medic"
      Severity="info"
      Facility="local0")
#vsphere-ui threadmonitor log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/threadmonitor.log"
      Tag="ui-threadmonitor"
      Severity="info"
      Facility="local0")
#vsphere-ui threadpools log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/threadpools.log"
      Tag="ui-threadpools"
      Severity="info"
      Facility="local0")
#vsphere-ui vspheremessaging log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vspheremessaging.log"
      Tag="ui-vspheremessaging"
      Severity="info"
      Facility="local0")
#vsphere-ui rpm log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsphere-ui-rpm.log"
      Tag="ui-rpm"
      Severity="info"
      Facility="local0")
#vsphere-ui runtime log stdout
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsphere-ui-runtime.log*"
      Tag="ui-runtime-stdout"
      Severity="info"
      Facility="local0")
#vsphere-ui runtime log stderr
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsphere-ui-runtime.log*"
      Tag="ui-runtime-stderr"
      Severity="info"
      Facility="local0")
#vsphere-ui access log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/access/localhost_access_log.txt"
      Tag="ui-access"
      Severity="info"
      Facility="local0")
#vsphere-ui gc log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/vsphere-ui-gc*"
      Tag="ui-gc"
      Severity="info"
      Facility="local0")
#vsphere-ui firstboot log
input(type="imfile"
      File="/var/log/firstboot/vsphere_ui_firstboot*"
      Tag="ui-firstboot"
      Severity="info"
      Facility="local0")
#vsphere-ui catalina
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/catalina.*.log"
      Tag="ui-runtime-catalina"
      Severity="info"
      Facility="local0")
#vsphere-ui endpoint
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/endpoint.log"
      Tag="ui-runtime-endpoint"
      Severity="info"
      Facility="local0")
#vsphere-ui localhost
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/localhost.*.log"
      Tag="ui-runtime-localhost"
      Severity="info"
      Facility="local0")
#vsphere-ui vsan
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsan-plugin.log"
      Tag="ui-runtime-vsan"
      Severity="info"
      Facility="local0")</fixtext><fix id="F-62766r935254_fix" /><check system="C-62857r935253_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>By default, a vmware-services-vsphere-ui.conf rsyslog configuration file that includes the service logs when syslog is configured on vCenter, but it must be verified.

At the command prompt, run the following command:

# cat /etc/vmware-syslog/vmware-services-vsphere-ui.conf

Expected result:

#vsphere-ui main log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsphere_client_virgo.log"
      Tag="ui-main"
      Severity="info"
      Facility="local0")
#vsphere-ui change log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/changelog.log"
      Tag="ui-changelog"
      Severity="info"
      Facility="local0")
#vsphere-ui dataservice log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/dataservice.log"
      Tag="ui-dataservice"
      Severity="info"
      Facility="local0")
#vsphere-ui apigw log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/apigw.log"
      Tag="ui-apigw"
      Severity="info"
      Facility="local0")
#vsphere-ui equinox log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/equinox.log"
      Tag="ui-equinox"
      Severity="info"
      Facility="local0")
#vsphere-ui event log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/eventlog.log"
      Tag="ui-eventlog"
      Severity="info"
      Facility="local0")
#vsphere-ui op id log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/opId.log"
      Tag="ui-opid"
      Severity="info"
      Facility="local0")
#vsphere-ui performance audit log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/performanceAudit.log"
      Tag="ui-performanceAudit"
      Severity="info"
      Facility="local0")
#vsphere-ui plugin-medic log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/plugin-medic.log"
      Tag="ui-plugin-medic"
      Severity="info"
      Facility="local0")
#vsphere-ui threadmonitor log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/threadmonitor.log"
      Tag="ui-threadmonitor"
      Severity="info"
      Facility="local0")
#vsphere-ui threadpools log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/threadpools.log"
      Tag="ui-threadpools"
      Severity="info"
      Facility="local0")
#vsphere-ui vspheremessaging log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vspheremessaging.log"
      Tag="ui-vspheremessaging"
      Severity="info"
      Facility="local0")
#vsphere-ui rpm log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsphere-ui-rpm.log"
      Tag="ui-rpm"
      Severity="info"
      Facility="local0")
#vsphere-ui runtime log stdout
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsphere-ui-runtime.log*"
      Tag="ui-runtime-stdout"
      Severity="info"
      Facility="local0")
#vsphere-ui runtime log stderr
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsphere-ui-runtime.log*"
      Tag="ui-runtime-stderr"
      Severity="info"
      Facility="local0")
#vsphere-ui access log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/access/localhost_access_log.txt"
      Tag="ui-access"
      Severity="info"
      Facility="local0")
#vsphere-ui gc log
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/vsphere-ui-gc*"
      Tag="ui-gc"
      Severity="info"
      Facility="local0")
#vsphere-ui firstboot log
input(type="imfile"
      File="/var/log/firstboot/vsphere_ui_firstboot*"
      Tag="ui-firstboot"
      Severity="info"
      Facility="local0")
#vsphere-ui catalina
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/catalina.*.log"
      Tag="ui-runtime-catalina"
      Severity="info"
      Facility="local0")
#vsphere-ui endpoint
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/endpoint.log"
      Tag="ui-runtime-endpoint"
      Severity="info"
      Facility="local0")
#vsphere-ui localhost
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/localhost.*.log"
      Tag="ui-runtime-localhost"
      Severity="info"
      Facility="local0")
#vsphere-ui vsan
input(type="imfile"
      File="/var/log/vmware/vsphere-ui/logs/vsan-plugin.log"
      Tag="ui-runtime-vsan"
      Severity="info"
      Facility="local0")

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-259118"><title>SRG-APP-000516-AS-000237</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259118r961863_rule" weight="10.0" severity="medium"><version>VCUI-80-000124</version><title>The vCenter UI service must enable "STRICT_SERVLET_COMPLIANCE".</title><description>&lt;VulnDiscussion&gt;Strict Servlet Compliance forces Tomcat to adhere to standards specifications including but not limited to RFC2109. RFC2109 sets the standard for HTTP session management. This setting affects several other settings that primarily pertain to cookie headers, cookie values, and sessions. Cookies will be parsed for strict adherence to specifications.

Note that changing a number of these default settings may break some systems, as some browsers are unable to correctly handle the cookie headers that result from a strict adherence to the specifications.

This one setting changes the default values for the following settings:

org.apache.catalina.core.ApplicationContext.GET_RESOURCE_REQUIRE_SLASH
org.apache.catalina.core.ApplicationDispatcher.WRAP_SAME_OBJECT
org.apache.catalina.core.StandardHostValve.ACCESS_SESSION
org.apache.catalina.session.StandardSession.ACTIVITY_CHECK
org.apache.catalina.session.StandardSession.LAST_ACCESS_AT_START
org.apache.tomcat.util.http.ServerCookie.ALWAYS_ADD_EXPIRES
org.apache.tomcat.util.http.ServerCookie.FWD_SLASH_IS_SEPARATOR
org.apache.tomcat.util.http.ServerCookie.PRESERVE_COOKIE_HEADER
org.apache.tomcat.util.http.ServerCookie.STRICT_NAMING
The "resourceOnlyServlets" attribute of any Context element.
The "tldValidation" attribute of any Context element.
The "useRelativeRedirects" attribute of any Context element.
The "xmlNamespaceAware" attribute of any Context element.
The "xmlValidation" attribute of any Context element.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-62767r935257_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Add or change the following line:

org.apache.catalina.STRICT_SERVLET_COMPLIANCE=true

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62767r935257_fix" /><check system="C-62858r935256_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command line, run the following command:

# grep STRICT_SERVLET_COMPLIANCE /usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Example result:

org.apache.catalina.STRICT_SERVLET_COMPLIANCE=true

If there are no results, or if the "org.apache.catalina.STRICT_SERVLET_COMPLIANCE" is not set to "true", this is a finding.</check-content></check></Rule></Group><Group id="V-259119"><title>SRG-APP-000001-AS-000001</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259119r960735_rule" weight="10.0" severity="medium"><version>VCUI-80-000125</version><title>The vCenter UI service must limit the amount of time that each Transmission Control Protocol (TCP) connection is kept alive.</title><description>&lt;VulnDiscussion&gt;Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests.

In Tomcat, the "connectionTimeout" attribute sets the number of milliseconds the server will wait after accepting a connection for the request Uniform Resource Identifier (URI) line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000054</ident><fixtext fixref="F-62768r935260_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Configure the &lt;Connector&gt; node with the value:

connectionTimeout="300000"

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62768r935260_fix" /><check system="C-62859r935259_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>The connection timeout should not be disabled by setting it to "-1".

At the command prompt, run the following command:

# xmllint --xpath "//Connector[@connectionTimeout = '-1']" /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

XPath set is empty

If any connectors are returned, this is a finding.</check-content></check></Rule></Group><Group id="V-259120"><title>SRG-APP-000001-AS-000001</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259120r960735_rule" weight="10.0" severity="medium"><version>VCUI-80-000126</version><title>The vCenter UI service must limit the number of times that each Transmission Control Protocol (TCP) connection is kept alive.</title><description>&lt;VulnDiscussion&gt;KeepAlive provides long lived HTTP sessions that allow multiple requests to be sent over the same connection. Enabling KeepAlive mitigates the effects of several types of denial-of-service attacks.

An advantage of KeepAlive is the reduced latency in subsequent requests (no handshaking). However, a disadvantage is that server resources are not available to handle other requests while a connection is maintained between the server and the client.

Tomcat can be configured to limit the number of subsequent requests that one client can submit to the server over an established connection. This limit helps provide a balance between the advantages of KeepAlive, while not allowing any one connection being held too long by any one client.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000054</ident><fixtext fixref="F-62769r935263_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Configure the &lt;Connector&gt; node with the value:

maxKeepAliveRequests="100"

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62769r935263_fix" /><check system="C-62860r935262_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>The connection timeout should not be unlimited by setting it to "-1".

At the command prompt, run the following command:

# xmllint --xpath "//Connector[@maxKeepAliveRequests = '-1']" /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

XPath set is empty

If any connectors are returned, this is a finding.</check-content></check></Rule></Group><Group id="V-259121"><title>SRG-APP-000251-AS-000165</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259121r961158_rule" weight="10.0" severity="medium"><version>VCUI-80-000127</version><title>The vCenter UI service must configure the "setCharacterEncodingFilter" filter.</title><description>&lt;VulnDiscussion&gt;Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.

An attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. VMware uses the standard Tomcat "SetCharacterEncodingFilter" to provide a layer of defense against character encoding attacks. Filters are Java objects that perform filtering tasks on the request to a resource (a servlet or static content), on the response from a resource, or both.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-001310</ident><fixtext fixref="F-62770r935266_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Configure the &lt;web-app&gt; node with the child nodes listed below:

&lt;filter-mapping&gt;
  &lt;filter-name&gt;setCharacterEncodingFilter&lt;/filter-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

&lt;filter&gt;
  &lt;filter-name&gt;setCharacterEncodingFilter&lt;/filter-name&gt;
  &lt;filter-class&gt;org.apache.catalina.filters.SetCharacterEncodingFilter&lt;/filter-class&gt;
  &lt;async-supported&gt;true&lt;/async-supported&gt;
  &lt;init-param&gt;
    &lt;param-name&gt;encoding&lt;/param-name&gt;
    &lt;param-value&gt;UTF-8&lt;/param-value&gt;
  &lt;/init-param&gt;
  &lt;init-param&gt;
    &lt;param-name&gt;ignore&lt;/param-name&gt;
    &lt;param-value&gt;true&lt;/param-value&gt;
  &lt;/init-param&gt;
&lt;/filter&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62770r935266_fix" /><check system="C-62861r935265_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath "//*[contains(text(), 'setCharacterEncodingFilter')]/parent::*" /usr/lib/vmware-vsphere-ui/server/conf/web.xml

Expected result:

&lt;filter-mapping&gt;
  &lt;filter-name&gt;setCharacterEncodingFilter&lt;/filter-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
&lt;filter&gt;
  &lt;filter-name&gt;setCharacterEncodingFilter&lt;/filter-name&gt;
  &lt;filter-class&gt;org.apache.catalina.filters.SetCharacterEncodingFilter&lt;/filter-class&gt;
  &lt;async-supported&gt;true&lt;/async-supported&gt;
  &lt;init-param&gt;
    &lt;param-name&gt;encoding&lt;/param-name&gt;
    &lt;param-value&gt;UTF-8&lt;/param-value&gt;
  &lt;/init-param&gt;
  &lt;init-param&gt;
    &lt;param-name&gt;ignore&lt;/param-name&gt;
    &lt;param-value&gt;true&lt;/param-value&gt;
  &lt;/init-param&gt;
&lt;/filter&gt;

If the output is does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-259122"><title>SRG-APP-000033-AS-000024</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259122r960792_rule" weight="10.0" severity="medium"><version>VCUI-80-000129</version><title>The vCenter UI service cookies must have "http-only" flag set.</title><description>&lt;VulnDiscussion&gt;Cookies are a common way to save session state over the HTTP(S) protocol. If attackers can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. When a cookie is tagged with the "HttpOnly" flag, it tells the browser this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000213</ident><fixtext fixref="F-62771r935269_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Navigate to the &lt;session-config&gt; node and configure the &lt;http-only&gt; as follows:

&lt;session-config&gt;
  &lt;session-timeout&gt;30&lt;/session-timeout&gt;
  &lt;cookie-config&gt;
      &lt;http-only&gt;true&lt;/http-only&gt;
      &lt;secure&gt;true&lt;/secure&gt;
  &lt;/cookie-config&gt;
&lt;/session-config&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62771r935269_fix" /><check system="C-62862r935268_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed 's/xmlns=".*"//g' | xmllint --xpath '/web-app/session-config/cookie-config/http-only' -

Expected result:

&lt;http-only&gt;true&lt;/http-only&gt;

If the output does not match the expected result, this is a finding.</check-content></check></Rule></Group><Group id="V-259123"><title>SRG-APP-000033-AS-000024</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259123r960792_rule" weight="10.0" severity="medium"><version>VCUI-80-000130</version><title>The vCenter UI service DefaultServlet must be set to "readonly" for "PUT" and "DELETE" commands.</title><description>&lt;VulnDiscussion&gt;The default servlet (or DefaultServlet) is a special servlet provided with Tomcat that is called when no other suitable page is found in a particular folder. The DefaultServlet serves static resources as well as directory listings. The DefaultServlet is configured by default with the "readonly" parameter set to "true" where HTTP commands such as "PUT" and "DELETE" are rejected.

Changing this to "false" allows clients to delete or modify static resources on the server and to upload new resources. DefaultServlet "readonly" must be set to "true", either literally or by absence (default).&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000213</ident><fixtext fixref="F-62772r935272_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Navigate to the /&lt;web-apps&gt;/&lt;servlet&gt;/&lt;servlet-class&gt;org.apache.catalina.servlets.DefaultServlet&lt;/servlet-class&gt;/ node and remove the following node:

&lt;init-param&gt;
      &lt;param-name&gt;readonly&lt;/param-name&gt;
      &lt;param-value&gt;false&lt;/param-value&gt;
&lt;/init-param&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62772r935272_fix" /><check system="C-62863r935271_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath "//*[contains(text(), 'DefaultServlet')]/parent::*" /usr/lib/vmware-vsphere-ui/server/conf/web.xml

Example output:

&lt;servlet&gt;
      &lt;description&gt;File servlet&lt;/description&gt;
      &lt;servlet-name&gt;FileServlet&lt;/servlet-name&gt;
      &lt;servlet-class&gt;org.apache.catalina.servlets.DefaultServlet&lt;/servlet-class&gt;
&lt;/servlet&gt;

If the "readOnly" param-value for the "DefaultServlet" servlet class is set to "false", this is a finding.

If the "readOnly" param-value does not exist, this is not a finding.</check-content></check></Rule></Group><Group id="V-259124"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259124r960963_rule" weight="10.0" severity="medium"><version>VCUI-80-000134</version><title>The vCenter UI service shutdown port must be disabled.</title><description>&lt;VulnDiscussion&gt;Tomcat by default listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. Setting the port to "-1" in $CATALINA_BASE/conf/server.xml instructs Tomcat to not listen for the shutdown command.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62773r935275_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Add or modify the setting "shutdown.port=-1" in the "catalina.properties" file.

Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Configure the &lt;Server&gt; node with the value:

port="${shutdown.port}"

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62773r935275_fix" /><check system="C-62864r935274_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following commands:

# xmllint --xpath "//Server/@port" /usr/lib/vmware-vsphere-ui/server/conf/server.xml
# grep shutdown.port /etc/vmware/vmware-vmon/svcCfgfiles/vsphere-ui.json

Example results:

port="${shutdown.port}"
"-Dshutdown.port=-1",

If "port" does not equal "${shutdown.port}", this is a finding.

If "shutdown.port" does not equal "-1", this is a finding.</check-content></check></Rule></Group><Group id="V-259125"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259125r960963_rule" weight="10.0" severity="medium"><version>VCUI-80-000136</version><title>The vCenter UI service debug parameter must be disabled.</title><description>&lt;VulnDiscussion&gt;Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage may be displayed.

Because this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62774r935278_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Navigate to all &lt;debug&gt; nodes that are not set to "0".

Set the &lt;param-value&gt; to "0" in all &lt;param-name&gt;debug&lt;/param-name&gt; nodes.

Note: The debug setting should look like the following:

&lt;init-param&gt;
      &lt;param-name&gt;debug&lt;/param-name&gt;
      &lt;param-value&gt;0&lt;/param-value&gt;
&lt;/init-param&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62774r935278_fix" /><check system="C-62865r935277_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed 's/xmlns=".*"//g' | xmllint --xpath '//param-name[text()="debug"]/parent::init-param' -

Example result:

&lt;init-param&gt;
      &lt;param-name&gt;debug&lt;/param-name&gt;
      &lt;param-value&gt;0&lt;/param-value&gt;
&lt;/init-param&gt;

If the "debug" parameter is specified and is not "0", this is a finding.

If the "debug" parameter does not exist, this is not a finding.</check-content></check></Rule></Group><Group id="V-259126"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259126r960963_rule" weight="10.0" severity="medium"><version>VCUI-80-000137</version><title>The vCenter UI service directory listings parameter must be disabled.</title><description>&lt;VulnDiscussion&gt;Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring that directory listing is disabled is one approach to mitigating the vulnerability.

In Tomcat, directory listing is disabled by default but can be enabled via the "listings" parameter. Ensure this node is not present to have the default effect.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62775r935281_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/web.xml

Find and remove the entire block returned in the check.

Example:

&lt;init-param&gt;
      &lt;param-name&gt;listings&lt;/param-name&gt;
      &lt;param-value&gt;true&lt;/param-value&gt;
&lt;/init-param&gt;

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62775r935281_fix" /><check system="C-62866r935280_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --format /usr/lib/vmware-vsphere-ui/server/conf/web.xml | sed 's/xmlns=".*"//g' | xmllint --xpath '//param-name[text()="listings"]/parent::init-param' -

Example result:

XPath set is empty

If the "listings" parameter is specified and is not "false", this is a finding.

If the "listings" parameter does not exist, this is not a finding.</check-content></check></Rule></Group><Group id="V-259127"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259127r960963_rule" weight="10.0" severity="medium"><version>VCUI-80-000138</version><title>The vCenter UI service deployXML attribute must be disabled.</title><description>&lt;VulnDiscussion&gt;The Host element controls deployment. Automatic deployment allows for simpler management but also makes it easier for an attacker to deploy a malicious application. Automatic deployment is controlled by the autoDeploy and deployOnStartup attributes. If both are false, only Contexts defined in server.xml will be deployed, and any changes will require a Tomcat restart.

In a hosted environment where web applications may not be trusted, set the deployXML attribute to "false" to ignore any context.xml packaged with the web application that may try to assign increased privileges to the web application. Note that if the security manager is enabled, the deployXML attribute will default to false.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62776r935284_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to the &lt;Host&gt; node and configure with the value "deployXML="false"".

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62776r935284_fix" /><check system="C-62867r935283_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath "//Host/@deployXML" /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

deployXML="false"

If "deployXML" does not equal "false", this is a finding.</check-content></check></Rule></Group><Group id="V-259128"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259128r960963_rule" weight="10.0" severity="medium"><version>VCUI-80-000139</version><title>The vCenter UI service must have Autodeploy disabled.</title><description>&lt;VulnDiscussion&gt;Tomcat allows auto-deployment of applications while it is running. This can allow untested or malicious applications to be automatically loaded into production. Autodeploy must be disabled in production.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62777r935287_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to the &lt;Host&gt; node and configure with the value "autoDeploy="false"".

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62777r935287_fix" /><check system="C-62868r935286_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath "//Host/@autoDeploy" /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Expected result:

autoDeploy="false"

If "autoDeploy" does not equal "false", this is a finding.</check-content></check></Rule></Group><Group id="V-259129"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259129r960963_rule" weight="10.0" severity="medium"><version>VCUI-80-000140</version><title>The vCenter UI service xpoweredBy attribute must be disabled.</title><description>&lt;VulnDiscussion&gt;Individual connectors can be configured to display the Tomcat information to clients. This information can be used to identify server versions that can be useful to attackers for identifying vulnerable versions of Tomcat. Individual connectors must be checked for the xpoweredBy attribute to ensure they do not pass server information to clients. The default value for xpoweredBy is "false".&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62778r935290_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/server.xml

Navigate to the &lt;Connector&gt; node and remove the "xpoweredBy" attribute.

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62778r935290_fix" /><check system="C-62869r935289_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# xmllint --xpath "//Connector/@xpoweredBy" /usr/lib/vmware-vsphere-ui/server/conf/server.xml

Example result:

XPath set is empty

If the "xpoweredBy" parameter is specified and is not "false", this is a finding.

If the "xpoweredBy" parameter does not exist, this is not a finding.</check-content></check></Rule></Group><Group id="V-259130"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259130r960963_rule" weight="10.0" severity="medium"><version>VCUI-80-000141</version><title>The vCenter UI service example applications must be removed.</title><description>&lt;VulnDiscussion&gt;Tomcat provides example applications, documentation, and other directories in the default installation that do not serve a production use. These files must be deleted.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62779r935293_fix">At the command prompt, run the following command:

# rm -rf /usr/lib/vmware-vsphere-ui/server/webapps/examples</fixtext><fix id="F-62779r935293_fix" /><check system="C-62870r935292_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# ls -l /usr/lib/vmware-vsphere-ui/server/webapps/examples

If the examples folder exists or contains any content, this is a finding.</check-content></check></Rule></Group><Group id="V-259131"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259131r960963_rule" weight="10.0" severity="medium"><version>VCUI-80-000142</version><title>The vCenter UI service default ROOT web application must be removed.</title><description>&lt;VulnDiscussion&gt;The default ROOT web application includes the version of Tomcat being used, links to Tomcat documentation, examples, FAQs, and mailing lists. The default ROOT web application must be removed from a publicly accessible instance and a more appropriate default page shown to users.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62780r935296_fix">At the command prompt, run the following command:

# rm -rf /usr/lib/vmware-vsphere-ui/server/webapps/ROOT/*</fixtext><fix id="F-62780r935296_fix" /><check system="C-62871r935295_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# ls -l /usr/lib/vmware-vsphere-ui/server/webapps/ROOT

If the ROOT web application contains any content, this is a finding.</check-content></check></Rule></Group><Group id="V-259132"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259132r960963_rule" weight="10.0" severity="medium"><version>VCUI-80-000143</version><title>The vCenter UI service default documentation must be removed.</title><description>&lt;VulnDiscussion&gt;Tomcat provides documentation and other directories in the default installation that do not serve a production use. These files must be deleted.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62781r935299_fix">At the command prompt, run the following command:

# rm -rf /usr/lib/vmware-vsphere-ui/server/webapps/docs</fixtext><fix id="F-62781r935299_fix" /><check system="C-62872r935298_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# ls -l /usr/lib/vmware-vsphere-ui/server/webapps/docs

If the "docs" folder exists or contains any content, this is a finding.</check-content></check></Rule></Group><Group id="V-259133"><title>SRG-APP-000516-AS-000237</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259133r961863_rule" weight="10.0" severity="medium"><version>VCUI-80-000151</version><title>The vCenter UI service must disable "ALLOW_BACKSLASH".</title><description>&lt;VulnDiscussion&gt;When Tomcat is installed behind a proxy configured to only allow access to certain contexts (web applications), an HTTP request containing "/\../" may allow attackers to work around the proxy restrictions using directory traversal attack methods. If "allow_backslash" is "true", the "\" character will be permitted as a path delimiter. The default value for the setting is "false", but Tomcat must always be configured as if no proxy restricting context access was used, and "allow_backslash" should be set to "false" to prevent directory-traversal-style attacks. This setting can create operability issues with noncompliant clients.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-62782r935302_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Update or remove the following line:

org.apache.catalina.connector.ALLOW_BACKSLASH=false

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62782r935302_fix" /><check system="C-62873r935301_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command line, run the following command:

# grep ALLOW_BACKSLASH /usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Example result:

org.apache.catalina.connector.ALLOW_BACKSLASH=false

If "org.apache.catalina.connector.ALLOW_BACKSLASH" is not set to "false", this is a finding.

If the "org.apache.catalina.connector.ALLOW_BACKSLASH" setting does not exist, this is not a finding.</check-content></check></Rule></Group><Group id="V-259134"><title>SRG-APP-000516-AS-000237</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259134r961863_rule" weight="10.0" severity="medium"><version>VCUI-80-000152</version><title>The vCenter UI service must enable "ENFORCE_ENCODING_IN_GET_WRITER".</title><description>&lt;VulnDiscussion&gt;Some clients try to guess the character encoding of text media when the mandated default of ISO-8859-1 should be used. Some browsers will interpret as UTF-7 when the characters are safe for ISO-8859-1. This can create the potential for a XSS attack. To defend against this, enforce_encoding_in_get_writer must be set to true.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000366</ident><fixtext fixref="F-62783r935305_fix">Navigate to and open:

/usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Update or remove the following line:

org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true

Restart the service with the following command:

# vmon-cli --restart vsphere-ui</fixtext><fix id="F-62783r935305_fix" /><check system="C-62874r935304_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command line, run the following command:

# grep ENFORCE_ENCODING_IN_GET_WRITER /usr/lib/vmware-vsphere-ui/server/conf/catalina.properties

Example result:

org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true

If "org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER" is not set to "true", this is a finding.

If the "org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER" setting does not exist, this is not a finding.</check-content></check></Rule></Group><Group id="V-259135"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259135r960963_rule" weight="10.0" severity="medium"><version>VCUI-80-000154</version><title>The vCenter UI service manager webapp must be removed.</title><description>&lt;VulnDiscussion&gt;Tomcat provides management functionality through either a default manager webapp or through local editing of the configuration files. The manager webapp files must be deleted, and administration must be performed through the local editing of the configuration files.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62784r935308_fix">At the command prompt, run the following command:

# rm -rf /usr/lib/vmware-vsphere-ui/server/webapps/manager</fixtext><fix id="F-62784r935308_fix" /><check system="C-62875r935307_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# ls -l /usr/lib/vmware-vsphere-ui/server/webapps/manager

If the manager folder exists or contains any content, this is a finding.</check-content></check></Rule></Group><Group id="V-259136"><title>SRG-APP-000141-AS-000095</title><description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</description><Rule id="SV-259136r1003680_rule" weight="10.0" severity="medium"><version>VCUI-80-000155</version><title>The vCenter UI service host-manager webapp must be removed.</title><description>&lt;VulnDiscussion&gt;Tomcat provides host management functionality through either a default host-manager webapp or through local editing of the configuration files. The host-manager webapp files must be deleted, and administration must be performed through the local editing of the configuration files.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description><reference><dc:title>DPMS Target VMware vSphere 8.0 VCSA User Interface (UI)</dc:title><dc:publisher>DISA</dc:publisher><dc:type>DPMS Target</dc:type><dc:subject>VMware vSphere 8.0 VCSA User Interface (UI)</dc:subject><dc:identifier>5568</dc:identifier></reference><ident system="http://cyber.mil/cci">CCI-000381</ident><fixtext fixref="F-62785r935311_fix">At the command prompt, run the following command:

# rm -rf /usr/lib/vmware-vsphere-ui/server/webapps/host-manager</fixtext><fix id="F-62785r935311_fix" /><check system="C-62876r1003679_chk"><check-content-ref href="VMware_vSphere_8.0_VCSA_User_Interface_(UI)_STIG.xml" name="M" /><check-content>At the command prompt, run the following command:

# ls -l /usr/lib/vmware-vsphere-ui/server/webapps/host-manager

If the host-manager folder exists or contains any content, this is a finding.</check-content></check></Rule></Group></Benchmark>