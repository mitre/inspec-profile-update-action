{"controls":[{"id":"SV-256737","code":"control 'SV-256737' do\n  title 'Envoy must drop connections to disconnected clients.'\n  desc 'Envoy client connections that are established but no longer connected can consume resources that might otherwise be required by active connections. It is a best practice to terminate connections that are no longer connected to an active client. \n \nEnvoy is hard coded to drop connections after three minutes of idle time. The absence of any \"tcpKeepAliveTimeSec\" settings means this default is in effect. This configuration must be verified and maintained.'\n  desc 'check', \"At the command prompt, run the following command: \n \n# xmllint --xpath '/config/envoy/L4Filter/tcpKeepAliveTimeSec/text()' /etc/vmware-rhttpproxy/config.xml \n \nExpected result: \n \n180 \n \nor \n \nXPath set is empty \n \nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open: \n \n/etc/vmware-rhttpproxy/config.xml \n \nLocate the <config>/<envoy>/<L4Filter> block and configure <tcpKeepAliveTimeSec> as follows: \n \n<tcpKeepAliveTimeSec>180</tcpKeepAliveTimeSec> \n \nRestart the service for changes to take effect. \n \n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA RhttpProxy'\n  tag check_id: 'C-60412r889147_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256737'\n  tag rid: 'SV-256737r889149_rule'\n  tag stig_id: 'VCRP-70-000001'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag fix_id: 'F-60355r889148_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_RhttpProxy_STIG_V1R1/controls/SV-256737.rb"},"title":"Envoy must drop connections to disconnected clients.","desc":"Envoy client connections that are established but no longer connected can consume resources that might otherwise be required by active connections. It is a best practice to terminate connections that are no longer connected to an active client. \n \nEnvoy is hard coded to drop connections after three minutes of idle time. The absence of any \"tcpKeepAliveTimeSec\" settings means this default is in effect. This configuration must be verified and maintained.","descriptions":{"default":"Envoy client connections that are established but no longer connected can consume resources that might otherwise be required by active connections. It is a best practice to terminate connections that are no longer connected to an active client. \n \nEnvoy is hard coded to drop connections after three minutes of idle time. The absence of any \"tcpKeepAliveTimeSec\" settings means this default is in effect. This configuration must be verified and maintained.","check":"At the command prompt, run the following command: \n \n# xmllint --xpath '/config/envoy/L4Filter/tcpKeepAliveTimeSec/text()' /etc/vmware-rhttpproxy/config.xml \n \nExpected result: \n \n180 \n \nor \n \nXPath set is empty \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/etc/vmware-rhttpproxy/config.xml \n \nLocate the <config>/<envoy>/<L4Filter> block and configure <tcpKeepAliveTimeSec> as follows: \n \n<tcpKeepAliveTimeSec>180</tcpKeepAliveTimeSec> \n \nRestart the service for changes to take effect. \n \n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA RhttpProxy"}],"tags":{"check_id":"C-60412r889147_chk","severity":"medium","gid":"V-256737","rid":"SV-256737r889149_rule","stig_id":"VCRP-70-000001","gtitle":"SRG-APP-000001-WSR-000001","fix_id":"F-60355r889148_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-256738","code":"control 'SV-256738' do\n  title 'Envoy must set a limit on established connections.'\n  desc 'Envoy client connections must be limited to preserve system resources and continue servicing connections without interruption. Without a limit set, the system would be vulnerable to a trivial denial-of-service attack where connections are created en masse and vCenter resources are entirely consumed. \n \nEnvoy comes hard coded with a tested and supported value for \"maxHttpsConnections\" that must be verified and maintained.'\n  desc 'check', \"At the command prompt, run the following command: \n \n# xmllint --xpath '/config/envoy/L4Filter/maxHttpsConnections/text()' /etc/vmware-rhttpproxy/config.xml \n \nExpected result: \n \n2048 \n \nor \n \nXPath set is empty \n \nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open: \n \n/etc/vmware-rhttpproxy/config.xml \n \nLocate the <config>/<envoy>/<L4Filter> block and configure <maxHttpsConnections> as follows: \n \n<maxHttpsConnections>2048</maxHttpsConnections> \n \nRestart the service for changes to take effect. \n \n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA RhttpProxy'\n  tag check_id: 'C-60413r889150_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256738'\n  tag rid: 'SV-256738r889152_rule'\n  tag stig_id: 'VCRP-70-000002'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag fix_id: 'F-60356r889151_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_RhttpProxy_STIG_V1R1/controls/SV-256738.rb"},"title":"Envoy must set a limit on established connections.","desc":"Envoy client connections must be limited to preserve system resources and continue servicing connections without interruption. Without a limit set, the system would be vulnerable to a trivial denial-of-service attack where connections are created en masse and vCenter resources are entirely consumed. \n \nEnvoy comes hard coded with a tested and supported value for \"maxHttpsConnections\" that must be verified and maintained.","descriptions":{"default":"Envoy client connections must be limited to preserve system resources and continue servicing connections without interruption. Without a limit set, the system would be vulnerable to a trivial denial-of-service attack where connections are created en masse and vCenter resources are entirely consumed. \n \nEnvoy comes hard coded with a tested and supported value for \"maxHttpsConnections\" that must be verified and maintained.","check":"At the command prompt, run the following command: \n \n# xmllint --xpath '/config/envoy/L4Filter/maxHttpsConnections/text()' /etc/vmware-rhttpproxy/config.xml \n \nExpected result: \n \n2048 \n \nor \n \nXPath set is empty \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/etc/vmware-rhttpproxy/config.xml \n \nLocate the <config>/<envoy>/<L4Filter> block and configure <maxHttpsConnections> as follows: \n \n<maxHttpsConnections>2048</maxHttpsConnections> \n \nRestart the service for changes to take effect. \n \n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA RhttpProxy"}],"tags":{"check_id":"C-60413r889150_chk","severity":"medium","gid":"V-256738","rid":"SV-256738r889152_rule","stig_id":"VCRP-70-000002","gtitle":"SRG-APP-000001-WSR-000001","fix_id":"F-60356r889151_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-256739","code":"control 'SV-256739' do\n  title 'Envoy must be configured to operate in FIPS mode.'\n  desc 'Envoy ships with FIPS 140-2 validated OpenSSL cryptographic libraries and is configured by default to run in FIPS mode. This module is used for all cryptographic operations performed by Envoy, including protection of data-in-transit over the client Transport Layer Security (TLS) connection.\n\n'\n  desc 'check', \"At the command prompt, run the following command: \n \n# xmllint --xpath '/config/vmacore/ssl/fips' /etc/vmware-rhttpproxy/config.xml \n \nExpected result: \n \n<fips>true</fips> \n \nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open: \n \n/etc/vmware-rhttpproxy/config.xml \n \nLocate the <config>/<vmacore>/<ssl> block and configure <fips> as follows: \n \n<fips>true</fips> \n \nRestart the service for changes to take effect. \n \n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA RhttpProxy'\n  tag check_id: 'C-60414r889153_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256739'\n  tag rid: 'SV-256739r889155_rule'\n  tag stig_id: 'VCRP-70-000003'\n  tag gtitle: 'SRG-APP-000014-WSR-000006'\n  tag fix_id: 'F-60357r889154_fix'\n  tag satisfies: ['SRG-APP-000014-WSR-000006', 'SRG-APP-000179-WSR-000111', 'SRG-APP-000416-WSR-000118', 'SRG-APP-000439-WSR-000188', 'SRG-APP-000179-WSR-000110']\n  tag 'documentable'\n  tag cci: ['CCI-000068', 'CCI-000803', 'CCI-002418', 'CCI-002450']\n  tag nist: ['AC-17 (2)', 'IA-7', 'SC-8', 'SC-13 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_RhttpProxy_STIG_V1R1/controls/SV-256739.rb"},"title":"Envoy must be configured to operate in FIPS mode.","desc":"Envoy ships with FIPS 140-2 validated OpenSSL cryptographic libraries and is configured by default to run in FIPS mode. This module is used for all cryptographic operations performed by Envoy, including protection of data-in-transit over the client Transport Layer Security (TLS) connection.\n\n","descriptions":{"default":"Envoy ships with FIPS 140-2 validated OpenSSL cryptographic libraries and is configured by default to run in FIPS mode. This module is used for all cryptographic operations performed by Envoy, including protection of data-in-transit over the client Transport Layer Security (TLS) connection.\n\n","check":"At the command prompt, run the following command: \n \n# xmllint --xpath '/config/vmacore/ssl/fips' /etc/vmware-rhttpproxy/config.xml \n \nExpected result: \n \n<fips>true</fips> \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/etc/vmware-rhttpproxy/config.xml \n \nLocate the <config>/<vmacore>/<ssl> block and configure <fips> as follows: \n \n<fips>true</fips> \n \nRestart the service for changes to take effect. \n \n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA RhttpProxy"}],"tags":{"check_id":"C-60414r889153_chk","severity":"medium","gid":"V-256739","rid":"SV-256739r889155_rule","stig_id":"VCRP-70-000003","gtitle":"SRG-APP-000014-WSR-000006","fix_id":"F-60357r889154_fix","satisfies":["SRG-APP-000014-WSR-000006","SRG-APP-000179-WSR-000111","SRG-APP-000416-WSR-000118","SRG-APP-000439-WSR-000188","SRG-APP-000179-WSR-000110"],"documentable":null,"cci":["CCI-000068","CCI-000803","CCI-002418","CCI-002450"],"nist":["AC-17 (2)","IA-7","SC-8","SC-13 b"]}},{"id":"SV-256740","code":"control 'SV-256740' do\n  title 'Envoy must use only Transport Layer Security (TLS) 1.2 for the protection of client connections.'\n  desc '<0> [object Object]'\n  desc 'check', \"At the command prompt, run the following command: \n \n# xmllint --xpath '/config/vmacore/ssl/protocols' /etc/vmware-rhttpproxy/config.xml \n \nExpected result: \n \nXPath set is empty \n \nor \n \n<protocols>tls1.2</protocols> \n \nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open: \n \n/etc/vmware-rhttpproxy/config.xml \n \nLocate the <config>/<vmacore>/<ssl> block and configure <protocols> as follows: \n \n<protocols>tls1.2</protocols> \n \nRestart the service for changes to take effect. \n \n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA RhttpProxy'\n  tag check_id: 'C-60415r889156_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256740'\n  tag rid: 'SV-256740r889158_rule'\n  tag stig_id: 'VCRP-70-000004'\n  tag gtitle: 'SRG-APP-000015-WSR-000014'\n  tag fix_id: 'F-60358r889157_fix'\n  tag cci: ['CCI-000197', 'CCI-001453', 'CCI-002418', 'CCI-002420', 'CCI-002422']\n  tag nist: ['IA-5 (1) (c)', 'AC-17 (2)', 'SC-8', 'SC-8 (2)', 'SC-8 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_RhttpProxy_STIG_V1R1/controls/SV-256740.rb"},"title":"Envoy must use only Transport Layer Security (TLS) 1.2 for the protection of client connections.","desc":"<0> [object Object]","descriptions":{"default":"<0> [object Object]","check":"At the command prompt, run the following command: \n \n# xmllint --xpath '/config/vmacore/ssl/protocols' /etc/vmware-rhttpproxy/config.xml \n \nExpected result: \n \nXPath set is empty \n \nor \n \n<protocols>tls1.2</protocols> \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/etc/vmware-rhttpproxy/config.xml \n \nLocate the <config>/<vmacore>/<ssl> block and configure <protocols> as follows: \n \n<protocols>tls1.2</protocols> \n \nRestart the service for changes to take effect. \n \n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA RhttpProxy"}],"tags":{"check_id":"C-60415r889156_chk","severity":"medium","gid":"V-256740","rid":"SV-256740r889158_rule","stig_id":"VCRP-70-000004","gtitle":"SRG-APP-000015-WSR-000014","fix_id":"F-60358r889157_fix","cci":["CCI-000197","CCI-001453","CCI-002418","CCI-002420","CCI-002422"],"nist":["IA-5 (1) (c)","AC-17 (2)","SC-8","SC-8 (2)","SC-8 (2)"]}},{"id":"SV-256741","code":"control 'SV-256741' do\n  title 'The Envoy private key file must be protected from unauthorized access.'\n  desc \"Envoy's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients. \n \nBy gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the Transport Layer Security (TLS) traffic between a client and the web server.\"\n  desc 'check', 'At  the command prompt, run the following command: \n \n# stat -c \"%n permissions are %a, is owned by %U and group owned by %G\" /etc/vmware-rhttpproxy/ssl/rui.key \n \nExpected result: \n \n/etc/vmware-rhttpproxy/ssl/rui.key permissions are 600, is owned by root and group owned by root \n \nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'At the command prompt, run the following commands: \n \n# chmod 600 /etc/vmware-rhttpproxy/ssl/rui.key \n# chown root:root /etc/vmware-rhttpproxy/ssl/rui.key'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA RhttpProxy'\n  tag check_id: 'C-60416r889159_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256741'\n  tag rid: 'SV-256741r889161_rule'\n  tag stig_id: 'VCRP-70-000005'\n  tag gtitle: 'SRG-APP-000176-WSR-000096'\n  tag fix_id: 'F-60359r889160_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000186']\n  tag nist: ['IA-5 (2) (a) (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_RhttpProxy_STIG_V1R1/controls/SV-256741.rb"},"title":"The Envoy private key file must be protected from unauthorized access.","desc":"Envoy's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients. \n \nBy gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the Transport Layer Security (TLS) traffic between a client and the web server.","descriptions":{"default":"Envoy's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients. \n \nBy gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the Transport Layer Security (TLS) traffic between a client and the web server.","check":"At  the command prompt, run the following command: \n \n# stat -c \"%n permissions are %a, is owned by %U and group owned by %G\" /etc/vmware-rhttpproxy/ssl/rui.key \n \nExpected result: \n \n/etc/vmware-rhttpproxy/ssl/rui.key permissions are 600, is owned by root and group owned by root \n \nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, run the following commands: \n \n# chmod 600 /etc/vmware-rhttpproxy/ssl/rui.key \n# chown root:root /etc/vmware-rhttpproxy/ssl/rui.key"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA RhttpProxy"}],"tags":{"check_id":"C-60416r889159_chk","severity":"medium","gid":"V-256741","rid":"SV-256741r889161_rule","stig_id":"VCRP-70-000005","gtitle":"SRG-APP-000176-WSR-000096","fix_id":"F-60359r889160_fix","documentable":null,"cci":["CCI-000186"],"nist":["IA-5 (2) (a) (1)"]}},{"id":"SV-256742","code":"control 'SV-256742' do\n  title 'Envoy must exclusively use the HTTPS protocol for client connections.'\n  desc 'Remotely accessing vCenter via Envoy involves sensitive information going over the wire. To protect the confidentiality and integrity of these communications, Envoy must be configured to use an encrypted session of HTTPS rather than plain-text HTTP. The Secure Sockets Layer (SSL) configuration block inside the rhttpproxy configuration must be present and correctly configured to safely enable Transport Layer Security (TLS).'\n  desc 'check', \"At the command prompt, run the following command: \n \n# xmllint --xpath '/config/ssl' /etc/vmware-rhttpproxy/config.xml \n \nExpected result: \n \n<ssl> \n    <!-- The server private key file --> \n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey> \n    <!-- The server side certificate file --> \n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate> \n    <!-- vecs server name. Currently vecs runs on all node types. --> \n    <vecsServerName>localhost</vecsServerName> \n  </ssl> \n \nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open: \n \n/etc/vmware-rhttpproxy/config.xml \n \nLocate the first <ssl> block and set its content to the following: \n \n<ssl> \n    <!-- The server private key file --> \n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey> \n    <!-- The server side certificate file --> \n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate> \n    <!-- vecs server name. Currently vecs runs on all node types. --> \n    <vecsServerName>localhost</vecsServerName> \n</ssl> \n \nRestart the service for changes to take effect. \n \n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA RhttpProxy'\n  tag check_id: 'C-60417r889162_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256742'\n  tag rid: 'SV-256742r889164_rule'\n  tag stig_id: 'VCRP-70-000006'\n  tag gtitle: 'SRG-APP-000315-WSR-000003'\n  tag fix_id: 'F-60360r889163_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002314']\n  tag nist: ['AC-17 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_RhttpProxy_STIG_V1R1/controls/SV-256742.rb"},"title":"Envoy must exclusively use the HTTPS protocol for client connections.","desc":"Remotely accessing vCenter via Envoy involves sensitive information going over the wire. To protect the confidentiality and integrity of these communications, Envoy must be configured to use an encrypted session of HTTPS rather than plain-text HTTP. The Secure Sockets Layer (SSL) configuration block inside the rhttpproxy configuration must be present and correctly configured to safely enable Transport Layer Security (TLS).","descriptions":{"default":"Remotely accessing vCenter via Envoy involves sensitive information going over the wire. To protect the confidentiality and integrity of these communications, Envoy must be configured to use an encrypted session of HTTPS rather than plain-text HTTP. The Secure Sockets Layer (SSL) configuration block inside the rhttpproxy configuration must be present and correctly configured to safely enable Transport Layer Security (TLS).","check":"At the command prompt, run the following command: \n \n# xmllint --xpath '/config/ssl' /etc/vmware-rhttpproxy/config.xml \n \nExpected result: \n \n<ssl> \n    <!-- The server private key file --> \n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey> \n    <!-- The server side certificate file --> \n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate> \n    <!-- vecs server name. Currently vecs runs on all node types. --> \n    <vecsServerName>localhost</vecsServerName> \n  </ssl> \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/etc/vmware-rhttpproxy/config.xml \n \nLocate the first <ssl> block and set its content to the following: \n \n<ssl> \n    <!-- The server private key file --> \n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey> \n    <!-- The server side certificate file --> \n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate> \n    <!-- vecs server name. Currently vecs runs on all node types. --> \n    <vecsServerName>localhost</vecsServerName> \n</ssl> \n \nRestart the service for changes to take effect. \n \n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA RhttpProxy"}],"tags":{"check_id":"C-60417r889162_chk","severity":"medium","gid":"V-256742","rid":"SV-256742r889164_rule","stig_id":"VCRP-70-000006","gtitle":"SRG-APP-000315-WSR-000003","fix_id":"F-60360r889163_fix","documentable":null,"cci":["CCI-002314"],"nist":["AC-17 (1)"]}},{"id":"SV-256743","code":"control 'SV-256743' do\n  title 'Envoy (rhttpproxy) log files must be shipped via syslog to a central log server.'\n  desc 'Envoy produces several logs that must be offloaded from the originating system. This information can then be used for diagnostic purposes, forensics purposes, or other purposes relevant to ensuring the availability and integrity of the hosted application. \n \nEnvoy (rhttpproxy) rsyslog configuration is included in the \"VMware-visl-integration\" package and unpacked to \"/etc/vmware-syslog/vmware-services-rhttpproxy.conf\". Ensuring the package hashes are as expected also ensures the shipped rsyslog configuration is present and unmodified.'\n  desc 'check', 'At the command prompt, run the following command: \n \n# rpm -V VMware-visl-integration|grep vmware-services-rhttpproxy.conf|grep \"^..5......\" \n \nIf the command returns any output, this is a finding.'\n  desc 'fix', 'Navigate to and open: \n \n/etc/vmware-syslog/vmware-services-rhttpproxy.conf \n \nCreate the file if it does not exist. \n \nSet the contents of the file as follows: \n \n#rhttpproxy log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\" \n      Tag=\"rhttpproxy-main\" \n      Severity=\"info\" \n      Facility=\"local0\")'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA RhttpProxy'\n  tag check_id: 'C-60418r889165_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256743'\n  tag rid: 'SV-256743r889167_rule'\n  tag stig_id: 'VCRP-70-000007'\n  tag gtitle: 'SRG-APP-000358-WSR-000063'\n  tag fix_id: 'F-60361r889166_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_RhttpProxy_STIG_V1R1/controls/SV-256743.rb"},"title":"Envoy (rhttpproxy) log files must be shipped via syslog to a central log server.","desc":"Envoy produces several logs that must be offloaded from the originating system. This information can then be used for diagnostic purposes, forensics purposes, or other purposes relevant to ensuring the availability and integrity of the hosted application. \n \nEnvoy (rhttpproxy) rsyslog configuration is included in the \"VMware-visl-integration\" package and unpacked to \"/etc/vmware-syslog/vmware-services-rhttpproxy.conf\". Ensuring the package hashes are as expected also ensures the shipped rsyslog configuration is present and unmodified.","descriptions":{"default":"Envoy produces several logs that must be offloaded from the originating system. This information can then be used for diagnostic purposes, forensics purposes, or other purposes relevant to ensuring the availability and integrity of the hosted application. \n \nEnvoy (rhttpproxy) rsyslog configuration is included in the \"VMware-visl-integration\" package and unpacked to \"/etc/vmware-syslog/vmware-services-rhttpproxy.conf\". Ensuring the package hashes are as expected also ensures the shipped rsyslog configuration is present and unmodified.","check":"At the command prompt, run the following command: \n \n# rpm -V VMware-visl-integration|grep vmware-services-rhttpproxy.conf|grep \"^..5......\" \n \nIf the command returns any output, this is a finding.","fix":"Navigate to and open: \n \n/etc/vmware-syslog/vmware-services-rhttpproxy.conf \n \nCreate the file if it does not exist. \n \nSet the contents of the file as follows: \n \n#rhttpproxy log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\" \n      Tag=\"rhttpproxy-main\" \n      Severity=\"info\" \n      Facility=\"local0\")"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA RhttpProxy"}],"tags":{"check_id":"C-60418r889165_chk","severity":"medium","gid":"V-256743","rid":"SV-256743r889167_rule","stig_id":"VCRP-70-000007","gtitle":"SRG-APP-000358-WSR-000063","fix_id":"F-60361r889166_fix","documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}},{"id":"SV-256744","code":"control 'SV-256744' do\n  title 'Envoy log files must be shipped via syslog to a central log server.'\n  desc 'Envoy rsyslog configuration is included in the \"VMware-visl-integration\" package and unpacked to \"/etc/vmware-syslog/vmware-services-envoy.conf\". Ensuring the package hashes are as expected also ensures the shipped rsyslog configuration is present and unmodified.'\n  desc 'check', 'At the command prompt, run the following command: \n \n# rpm -V VMware-visl-integration|grep vmware-services-envoy.conf|grep \"^..5......\" \n \nIf the command returns any output, this is a finding.'\n  desc 'fix', 'Navigate to and open: \n \n/etc/vmware-syslog/vmware-services-envoy.conf \n \nCreate the file if it does not exist. \n \nSet the contents of the file as follows: \n \n#envoy service log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/envoy/envoy.log\" \n      Tag=\"envoy-main\" \n      Severity=\"info\" \n      Facility=\"local0\") \n#envoy access log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/envoy/envoy-access.log\" \n      Tag=\"envoy-access\" \n      Severity=\"info\" \n      Facility=\"local0\")'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA RhttpProxy'\n  tag check_id: 'C-60419r889168_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256744'\n  tag rid: 'SV-256744r889170_rule'\n  tag stig_id: 'VCRP-70-000008'\n  tag gtitle: 'SRG-APP-000358-WSR-000063'\n  tag fix_id: 'F-60362r889169_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_RhttpProxy_STIG_V1R1/controls/SV-256744.rb"},"title":"Envoy log files must be shipped via syslog to a central log server.","desc":"Envoy rsyslog configuration is included in the \"VMware-visl-integration\" package and unpacked to \"/etc/vmware-syslog/vmware-services-envoy.conf\". Ensuring the package hashes are as expected also ensures the shipped rsyslog configuration is present and unmodified.","descriptions":{"default":"Envoy rsyslog configuration is included in the \"VMware-visl-integration\" package and unpacked to \"/etc/vmware-syslog/vmware-services-envoy.conf\". Ensuring the package hashes are as expected also ensures the shipped rsyslog configuration is present and unmodified.","check":"At the command prompt, run the following command: \n \n# rpm -V VMware-visl-integration|grep vmware-services-envoy.conf|grep \"^..5......\" \n \nIf the command returns any output, this is a finding.","fix":"Navigate to and open: \n \n/etc/vmware-syslog/vmware-services-envoy.conf \n \nCreate the file if it does not exist. \n \nSet the contents of the file as follows: \n \n#envoy service log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/envoy/envoy.log\" \n      Tag=\"envoy-main\" \n      Severity=\"info\" \n      Facility=\"local0\") \n#envoy access log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/envoy/envoy-access.log\" \n      Tag=\"envoy-access\" \n      Severity=\"info\" \n      Facility=\"local0\")"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA RhttpProxy"}],"tags":{"check_id":"C-60419r889168_chk","severity":"medium","gid":"V-256744","rid":"SV-256744r889170_rule","stig_id":"VCRP-70-000008","gtitle":"SRG-APP-000358-WSR-000063","fix_id":"F-60362r889169_fix","documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}}],"groups":[{"id":"controls/SV-256737.rb","title":null,"controls":["SV-256737"]},{"id":"controls/SV-256738.rb","title":null,"controls":["SV-256738"]},{"id":"controls/SV-256739.rb","title":null,"controls":["SV-256739"]},{"id":"controls/SV-256740.rb","title":null,"controls":["SV-256740"]},{"id":"controls/SV-256741.rb","title":null,"controls":["SV-256741"]},{"id":"controls/SV-256742.rb","title":null,"controls":["SV-256742"]},{"id":"controls/SV-256743.rb","title":null,"controls":["SV-256743"]},{"id":"controls/SV-256744.rb","title":null,"controls":["SV-256744"]}],"name":"VMW_vSphere_7-0_vCA_RhttpProxy_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"a8ad19a5a84f4b8f95e7468f06578947692d144f43289fad084abeb200ffe0e2","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
