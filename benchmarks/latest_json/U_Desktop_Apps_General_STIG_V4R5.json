{"controls":[{"id":"SV-6428","code":"control 'SV-6428' do\n  title 'An appropriate backup strategy does not exist for the data.'\n  desc 'Data integrity and availability are key security objectives.  Adequate data backup is one strategy that is crucial to meeting these objectives.  Although users of desktop applications may not be creating mission critical data, all their data represents a resource that, if lost, could result in a permanent loss of information or productivity.\n\nA backup strategy is highly dependent on the physical and logical environments.  In environments where users frequently operate disconnected from a LAN, as in the case of notebook PC users who travel, it is not generally practical for the users to store all their data on a file server.  Developers may require standalone copies of program code while additions or alterations are in progress.  For these and other reasons, strict requirements for desktop backup are not addressed in this document.  However, this section does provide recommendations that should be considered.\n\nUsers should make conscious decisions about the physical location where desktop application data is stored.  They should be aware of the backup policy for that location.  Any backup policy should be implemented in accordance with the following:\n\n-\tMission critical data should be stored on file servers with a formal data backup policy.  Storage of mission critical data on desktop machines should be considered temporary.\n\n-\tTo the greatest extent possible, data files should be stored in a directory hierarchy that is separate from program files.\n\n-\tAn incremental, or change-based, backup solution can be used daily.\n\n-\tA full data backup solution should be used at least weekly.\n\n-\tUse of a Compact Disk-Recordable (CD-R) or Compact Disk-ReWritable (CD-RW) drive should be considered for desktop machines.  CD-R and CD-RW disks provide high capacity at relatively low cost.\n\n-\tThe backup data should be stored on media or another machine that is not physically close to the original data source.\n\n-\tBackup media should receive proper care according to its characteristics.  Regular rotation of tape media is necessary to ensure usability.  The media should be clearly labeled, including any appropriate security classification marking.\n\n-\tBackup tools and schedules should be documented.\n\n-\tRestoration tools and methods should be documented and they should be tested via restoration at least annually.'\n  desc 'check', 'Procedure:  Interview the SA to determine the type of data being housed on the machine.  Interview the SA to determine the backup process being used for the data.  \n\nCriteria:  If there is no backup process or the backup process is inadequate for the data on the machine, this is a finding.'\n  desc 'fix', 'Interview the SA to determine the type of data on the machine and its backup process.  If there is no backup process or the process is inadequate, have the SA create a new backup process.'\n  impact 0.5\n  ref 'DPMS Target Desktop Application - General'\n  tag check_id: 'C-1035r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-6355'\n  tag rid: 'SV-6428r1_rule'\n  tag stig_id: 'DTGW001'\n  tag gtitle: 'DTGW001-Appropriate backup strategy does not exist'\n  tag fix_id: 'F-5881r1_fix'\n  tag 'documentable'\n  tag responsibility: 'System Administrator'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Desktop_Apps_General_STIG_V4R5/controls/SV-6428.rb"},"title":"An appropriate backup strategy does not exist for the data.","desc":"Data integrity and availability are key security objectives.  Adequate data backup is one strategy that is crucial to meeting these objectives.  Although users of desktop applications may not be creating mission critical data, all their data represents a resource that, if lost, could result in a permanent loss of information or productivity.\n\nA backup strategy is highly dependent on the physical and logical environments.  In environments where users frequently operate disconnected from a LAN, as in the case of notebook PC users who travel, it is not generally practical for the users to store all their data on a file server.  Developers may require standalone copies of program code while additions or alterations are in progress.  For these and other reasons, strict requirements for desktop backup are not addressed in this document.  However, this section does provide recommendations that should be considered.\n\nUsers should make conscious decisions about the physical location where desktop application data is stored.  They should be aware of the backup policy for that location.  Any backup policy should be implemented in accordance with the following:\n\n-\tMission critical data should be stored on file servers with a formal data backup policy.  Storage of mission critical data on desktop machines should be considered temporary.\n\n-\tTo the greatest extent possible, data files should be stored in a directory hierarchy that is separate from program files.\n\n-\tAn incremental, or change-based, backup solution can be used daily.\n\n-\tA full data backup solution should be used at least weekly.\n\n-\tUse of a Compact Disk-Recordable (CD-R) or Compact Disk-ReWritable (CD-RW) drive should be considered for desktop machines.  CD-R and CD-RW disks provide high capacity at relatively low cost.\n\n-\tThe backup data should be stored on media or another machine that is not physically close to the original data source.\n\n-\tBackup media should receive proper care according to its characteristics.  Regular rotation of tape media is necessary to ensure usability.  The media should be clearly labeled, including any appropriate security classification marking.\n\n-\tBackup tools and schedules should be documented.\n\n-\tRestoration tools and methods should be documented and they should be tested via restoration at least annually.","descriptions":{"default":"Data integrity and availability are key security objectives.  Adequate data backup is one strategy that is crucial to meeting these objectives.  Although users of desktop applications may not be creating mission critical data, all their data represents a resource that, if lost, could result in a permanent loss of information or productivity.\n\nA backup strategy is highly dependent on the physical and logical environments.  In environments where users frequently operate disconnected from a LAN, as in the case of notebook PC users who travel, it is not generally practical for the users to store all their data on a file server.  Developers may require standalone copies of program code while additions or alterations are in progress.  For these and other reasons, strict requirements for desktop backup are not addressed in this document.  However, this section does provide recommendations that should be considered.\n\nUsers should make conscious decisions about the physical location where desktop application data is stored.  They should be aware of the backup policy for that location.  Any backup policy should be implemented in accordance with the following:\n\n-\tMission critical data should be stored on file servers with a formal data backup policy.  Storage of mission critical data on desktop machines should be considered temporary.\n\n-\tTo the greatest extent possible, data files should be stored in a directory hierarchy that is separate from program files.\n\n-\tAn incremental, or change-based, backup solution can be used daily.\n\n-\tA full data backup solution should be used at least weekly.\n\n-\tUse of a Compact Disk-Recordable (CD-R) or Compact Disk-ReWritable (CD-RW) drive should be considered for desktop machines.  CD-R and CD-RW disks provide high capacity at relatively low cost.\n\n-\tThe backup data should be stored on media or another machine that is not physically close to the original data source.\n\n-\tBackup media should receive proper care according to its characteristics.  Regular rotation of tape media is necessary to ensure usability.  The media should be clearly labeled, including any appropriate security classification marking.\n\n-\tBackup tools and schedules should be documented.\n\n-\tRestoration tools and methods should be documented and they should be tested via restoration at least annually.","check":"Procedure:  Interview the SA to determine the type of data being housed on the machine.  Interview the SA to determine the backup process being used for the data.  \n\nCriteria:  If there is no backup process or the backup process is inadequate for the data on the machine, this is a finding.","fix":"Interview the SA to determine the type of data on the machine and its backup process.  If there is no backup process or the process is inadequate, have the SA create a new backup process."},"impact":0.5,"refs":[{"ref":"DPMS Target Desktop Application - General"}],"tags":{"check_id":"C-1035r1_chk","severity":"medium","gid":"V-6355","rid":"SV-6428r1_rule","stig_id":"DTGW001","gtitle":"DTGW001-Appropriate backup strategy does not exist","fix_id":"F-5881r1_fix","documentable":null,"responsibility":"System Administrator"}},{"id":"SV-6429","code":"control 'SV-6429' do\n  title 'Public instant message clients are installed.'\n  desc 'Instant Messaging or IM clients provide a way for a user to send a message to one or more other users in real time.  Additional capabilities may include file transfer and support for distributed game playing.  Communication between clients and associated directory services are managed through messaging servers.  Commercial IM clients include AOL Instant Messenger (AIM), MSN Messenger, and Yahoo! Messenger, and Skype.  The Windows XP operating system includes the Windows Messenger component as an IM client.  (This should not be confused with Windows Messaging which is a service within Windows.)\n\nIM clients present a security issue when the clients route messages through public servers.  The obvious implication is that potentially sensitive information could be intercepted or altered in the course of transmission.  This same issue is associated with the use of public e-mail servers.\n\nIn order to reduce the potential for disclosure of sensitive Government information and to ensure the validity of official government information, IM clients that connect to public instant messaging services will not be installed. \n\nNOTE:  Clients used to access an internal or DoD controlled IM applications are permitted.'\n  desc 'check', 'Procedure:  Using Windows explorer search for the following files:\nymsgr*.exe, aim.exe\n\nCriteria:  If any of the files are found, this is a finding.\nNote:  If the file is tied to an IM application that is DOD controlled, this is not a finding.'\n  desc 'fix', 'Use Windows explorer to search for the files ymsgr*.exe and aim.exe.  If found, delete them unless the file is tied to an IM  application that is DoD controlled.'\n  impact 0.5\n  ref 'DPMS Target Desktop Application - General'\n  tag check_id: 'C-1038r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-6356'\n  tag rid: 'SV-6429r1_rule'\n  tag stig_id: 'DTGW002'\n  tag gtitle: 'DTGW002-Public instant message clients are install'\n  tag fix_id: 'F-5882r1_fix'\n  tag 'documentable'\n  tag responsibility: 'System Administrator'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Desktop_Apps_General_STIG_V4R5/controls/SV-6429.rb"},"title":"Public instant message clients are installed.","desc":"Instant Messaging or IM clients provide a way for a user to send a message to one or more other users in real time.  Additional capabilities may include file transfer and support for distributed game playing.  Communication between clients and associated directory services are managed through messaging servers.  Commercial IM clients include AOL Instant Messenger (AIM), MSN Messenger, and Yahoo! Messenger, and Skype.  The Windows XP operating system includes the Windows Messenger component as an IM client.  (This should not be confused with Windows Messaging which is a service within Windows.)\n\nIM clients present a security issue when the clients route messages through public servers.  The obvious implication is that potentially sensitive information could be intercepted or altered in the course of transmission.  This same issue is associated with the use of public e-mail servers.\n\nIn order to reduce the potential for disclosure of sensitive Government information and to ensure the validity of official government information, IM clients that connect to public instant messaging services will not be installed. \n\nNOTE:  Clients used to access an internal or DoD controlled IM applications are permitted.","descriptions":{"default":"Instant Messaging or IM clients provide a way for a user to send a message to one or more other users in real time.  Additional capabilities may include file transfer and support for distributed game playing.  Communication between clients and associated directory services are managed through messaging servers.  Commercial IM clients include AOL Instant Messenger (AIM), MSN Messenger, and Yahoo! Messenger, and Skype.  The Windows XP operating system includes the Windows Messenger component as an IM client.  (This should not be confused with Windows Messaging which is a service within Windows.)\n\nIM clients present a security issue when the clients route messages through public servers.  The obvious implication is that potentially sensitive information could be intercepted or altered in the course of transmission.  This same issue is associated with the use of public e-mail servers.\n\nIn order to reduce the potential for disclosure of sensitive Government information and to ensure the validity of official government information, IM clients that connect to public instant messaging services will not be installed. \n\nNOTE:  Clients used to access an internal or DoD controlled IM applications are permitted.","check":"Procedure:  Using Windows explorer search for the following files:\nymsgr*.exe, aim.exe\n\nCriteria:  If any of the files are found, this is a finding.\nNote:  If the file is tied to an IM application that is DOD controlled, this is not a finding.","fix":"Use Windows explorer to search for the files ymsgr*.exe and aim.exe.  If found, delete them unless the file is tied to an IM  application that is DoD controlled."},"impact":0.5,"refs":[{"ref":"DPMS Target Desktop Application - General"}],"tags":{"check_id":"C-1038r1_chk","severity":"medium","gid":"V-6356","rid":"SV-6429r1_rule","stig_id":"DTGW002","gtitle":"DTGW002-Public instant message clients are install","fix_id":"F-5882r1_fix","documentable":null,"responsibility":"System Administrator"}},{"id":"SV-6430","code":"control 'SV-6430' do\n  title 'Peer to Peer clients or utilities are installed.'\n  desc 'File-sharing utilities and clients can provide the ability to share files with other users (Peer-to-Peer Sharing).  This type of utility is a security risk due to the potential risk of loss of sensitive data and the broadcast of the existence of a computer to others.  There are also many legal issues associated with these types of utilities including copyright infringement and intellectual property issues.  These types of utilities and clients include the following examples, Napster, Gnutella, Kazaa, and Freenet.\n\nNOTE:  Clients used to access an internal or DoD controlled file-sharing system are permitted.'\n  desc 'check', 'Procedure:  Using Windows explorer search for the following files:\n*napv*.exe, Gnutella.exe\n\nCriteria:  If any of the files are found examine it to determine if it is a file sharing utility.  If it is, this is a finding.'\n  desc 'fix', 'Use Windows explorer to search for the files *napv.exe and Gnutella.exe.  If found and they are determined to be a file sharing utility, delete them.'\n  impact 0.5\n  ref 'DPMS Target Desktop Application - General'\n  tag check_id: 'C-1041r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-6357'\n  tag rid: 'SV-6430r1_rule'\n  tag stig_id: 'DTGW003'\n  tag gtitle: 'DTGW003-Peer to Peer clients or utilities are inst'\n  tag fix_id: 'F-5883r1_fix'\n  tag 'documentable'\n  tag responsibility: 'System Administrator'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Desktop_Apps_General_STIG_V4R5/controls/SV-6430.rb"},"title":"Peer to Peer clients or utilities are installed.","desc":"File-sharing utilities and clients can provide the ability to share files with other users (Peer-to-Peer Sharing).  This type of utility is a security risk due to the potential risk of loss of sensitive data and the broadcast of the existence of a computer to others.  There are also many legal issues associated with these types of utilities including copyright infringement and intellectual property issues.  These types of utilities and clients include the following examples, Napster, Gnutella, Kazaa, and Freenet.\n\nNOTE:  Clients used to access an internal or DoD controlled file-sharing system are permitted.","descriptions":{"default":"File-sharing utilities and clients can provide the ability to share files with other users (Peer-to-Peer Sharing).  This type of utility is a security risk due to the potential risk of loss of sensitive data and the broadcast of the existence of a computer to others.  There are also many legal issues associated with these types of utilities including copyright infringement and intellectual property issues.  These types of utilities and clients include the following examples, Napster, Gnutella, Kazaa, and Freenet.\n\nNOTE:  Clients used to access an internal or DoD controlled file-sharing system are permitted.","check":"Procedure:  Using Windows explorer search for the following files:\n*napv*.exe, Gnutella.exe\n\nCriteria:  If any of the files are found examine it to determine if it is a file sharing utility.  If it is, this is a finding.","fix":"Use Windows explorer to search for the files *napv.exe and Gnutella.exe.  If found and they are determined to be a file sharing utility, delete them."},"impact":0.5,"refs":[{"ref":"DPMS Target Desktop Application - General"}],"tags":{"check_id":"C-1041r1_chk","severity":"medium","gid":"V-6357","rid":"SV-6430r1_rule","stig_id":"DTGW003","gtitle":"DTGW003-Peer to Peer clients or utilities are inst","fix_id":"F-5883r1_fix","documentable":null,"responsibility":"System Administrator"}},{"id":"SV-7145","code":"control 'SV-7145' do\n  title 'Execution Restricted File Type Properties'\n  desc 'For certain file types, it is necessary to take steps to ensure that the default method of opening the file does not allow mobile code to be executed.  Two techniques to achieve this goal are discussed here—altering the default file type Action and deleting the file type definition.  Although methods of removing Microsoft’s Windows Script Host (WSH) component might meet most of this requirement, that technique should not be the first choice.  It would disable functionality that might be in use for other purposes, and the specific method used would have to be compatible with the Windows File Protection (WFP) feature present in later versions of Windows.\n\nThe default Action property can be altered to change the standard default Action from Open to Edit.  When this technique is used, instead of executing a program with the file contents as code, an editor is opened with the file contents as a document.  For example for a .vbs file, the Open action may be the command ’C:\\\\WINNT\\\\System32\\\\Wscript.exe \"%1\" %*’ and the Edit action may be the command ‘C:\\\\WINNT\\\\System32\\\\Notepad.exe \"%1\" %*’.  Changing the default action to Edit results in a Notepad window opening up instead of the file being executed by the Windows Scripting Host when the .vbs file is opened.  For non-technical user communities, an alternative that may be more appropriate is to have the Edit action be the command ’C:\\\\WINNT\\\\System32\\\\Notepad.exe \"C:\\\\MC_Warn.txt\"’, where the file C:\\\\MC_Warn.txt is created locally and contains a warning that the user has attempted to open a potentially dangerous file.\n\nWhen altering the default file type Action is the technique used, the Always show extension setting adds additional value.  This ensures that users can see the file type before attempting to open it.\n\nWhile the alternate technique of deleting existing Windows file type definitions does provide security, it is not always a more secure long-term solution.  During maintenance or product installation, a non-existent file type is usually defined while existing file type properties are usually not overwritten.\n\nRegardless of which technique is used, the significant result is that when an attempt is made to open certain files using default application actions, any code in the file is not executed.\n\nFIle extensions of certain files should not be hidden.  Users can double click a file without knowing what type of file (or which application) is being opened.'\n  desc 'check', 'On Windows NT/2000/2003/XP--\nStart the Windows Explorer application. \n\nOn the Tools menu, select the Folder Options… item. On the Folder Options window, select the File Types tab. For each of the file types in the table below, select the Edit… button for Windows NT or the Advanced button for Windows 2000/2003/XP. \n\nOn Windows 7/8/2008/2008R2--\nClick on Start. Select Default Programs from the right side of the menu. Choose the Associate a file or protocol with a program option.\n \na) Determine the default Action by looking in the Actions: list for an action in bold font. A typical default action is indicated as “Open”. If none of the entries in the Actions: list appears in bold font, the “Open” action is the default Action. Select the default Action and the Edit… button to determine the application used to perform the action.\nb) Determine the value of the Always show extension option.\n\nFile Type\tExtensions\t\nJScript Script File\tJS\t\t\nWindows Script Component\tSCT,WSC\nJScript Encoded Script File\tJSE\t\t\nWindows Script File\tWSF\nScrap object\tSHS,SHB\t\t\nWindows Script Host Settings File\tWSH\nHTML Applications as Mobile Code\tHTA\t\t\t\nVBScript Encoded Script File\tVBE\t\t\t\nVBScript Script File\tVBS\t\t\t\n\nNOTE: The File Type strings (e.g., “JScript Script File”) may vary according to the specific software release. The key element for the check is the Extension value.\n\n\nCriteria:  If a file type is not defined, this is not a Finding.\na) If the application defined to perform the default Action could execute code in the file, then this is a Finding.  For example, if the default Action for file type .VBS specifies wscript.exe as the application, a Finding is indicated.  On the other hand, if the default Action for any file type specifies notepad.exe as the application, there is not a Finding.\nb) If the Always show extension option is not enabled for each file type, then this is a Finding.\n\n\nFor Windows Vista open the Control Panel select Default Programs select Associate a file type or protocol with a Program:\n\na) Determine the default program by looking in the Current Default: list. A typical default action is indicated as “Open”. If none of the entries in the Actions: list appears in bold font, the “Open” action is the default Action. Select the default Action and the Edit… button to determine the application used to perform the action.\nb) Determine the value of the Always show extension option.\n\nFile Type\tExtensions\t\tFile Type\tExtensions\nJScript Script File\tJS\t\tWindows Script Component\tSCT,WSC\nJScript Encoded Script File\tJSE\t\tWindows Script File\tWSF\nScrap object\tSHS,SHB\t\tWindows Script Host Settings File\tWSH\nHTML Applications as Mobile Code\tHTA\t\t\t\nVBScript Encoded Script File\tVBE\t\t\t\nVBScript Script File\tVBS\t\t\t\n\nNOTE: The File Type strings (e.g., “JScript Script File”) may vary according to the specific software release. The key element for the check is the Extension value.\n\nCriteria:  If a file type is not defined, this is not a Finding.\na) If the application defined in the Current Default list could execute code in the file, then this is a Finding.  For example, if the default program for file type .VBS specifies wscript.exe as the application, a Finding is indicated.  On the other hand, if the default Action for any file type specifies notepad.exe as the application, there is not a Finding.'\n  desc 'fix', 'Change the default action to an application that will not execute the file such as notepad.exe  and ensure that the Always show extension is enabled for the filetype in question.'\n  impact 0.5\n  ref 'DPMS Target Desktop Application - General'\n  tag check_id: 'C-3192r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-6878'\n  tag rid: 'SV-7145r2_rule'\n  tag stig_id: 'DTGW004'\n  tag gtitle: 'DTGW004-Execution Restricted File Type Properties'\n  tag fix_id: 'F-6566r1_fix'\n  tag 'documentable'\n  tag responsibility: 'System Administrator'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Desktop_Apps_General_STIG_V4R5/controls/SV-7145.rb"},"title":"Execution Restricted File Type Properties","desc":"For certain file types, it is necessary to take steps to ensure that the default method of opening the file does not allow mobile code to be executed.  Two techniques to achieve this goal are discussed here—altering the default file type Action and deleting the file type definition.  Although methods of removing Microsoft’s Windows Script Host (WSH) component might meet most of this requirement, that technique should not be the first choice.  It would disable functionality that might be in use for other purposes, and the specific method used would have to be compatible with the Windows File Protection (WFP) feature present in later versions of Windows.\n\nThe default Action property can be altered to change the standard default Action from Open to Edit.  When this technique is used, instead of executing a program with the file contents as code, an editor is opened with the file contents as a document.  For example for a .vbs file, the Open action may be the command ’C:\\WINNT\\System32\\Wscript.exe \"%1\" %*’ and the Edit action may be the command ‘C:\\WINNT\\System32\\Notepad.exe \"%1\" %*’.  Changing the default action to Edit results in a Notepad window opening up instead of the file being executed by the Windows Scripting Host when the .vbs file is opened.  For non-technical user communities, an alternative that may be more appropriate is to have the Edit action be the command ’C:\\WINNT\\System32\\Notepad.exe \"C:\\MC_Warn.txt\"’, where the file C:\\MC_Warn.txt is created locally and contains a warning that the user has attempted to open a potentially dangerous file.\n\nWhen altering the default file type Action is the technique used, the Always show extension setting adds additional value.  This ensures that users can see the file type before attempting to open it.\n\nWhile the alternate technique of deleting existing Windows file type definitions does provide security, it is not always a more secure long-term solution.  During maintenance or product installation, a non-existent file type is usually defined while existing file type properties are usually not overwritten.\n\nRegardless of which technique is used, the significant result is that when an attempt is made to open certain files using default application actions, any code in the file is not executed.\n\nFIle extensions of certain files should not be hidden.  Users can double click a file without knowing what type of file (or which application) is being opened.","descriptions":{"default":"For certain file types, it is necessary to take steps to ensure that the default method of opening the file does not allow mobile code to be executed.  Two techniques to achieve this goal are discussed here—altering the default file type Action and deleting the file type definition.  Although methods of removing Microsoft’s Windows Script Host (WSH) component might meet most of this requirement, that technique should not be the first choice.  It would disable functionality that might be in use for other purposes, and the specific method used would have to be compatible with the Windows File Protection (WFP) feature present in later versions of Windows.\n\nThe default Action property can be altered to change the standard default Action from Open to Edit.  When this technique is used, instead of executing a program with the file contents as code, an editor is opened with the file contents as a document.  For example for a .vbs file, the Open action may be the command ’C:\\WINNT\\System32\\Wscript.exe \"%1\" %*’ and the Edit action may be the command ‘C:\\WINNT\\System32\\Notepad.exe \"%1\" %*’.  Changing the default action to Edit results in a Notepad window opening up instead of the file being executed by the Windows Scripting Host when the .vbs file is opened.  For non-technical user communities, an alternative that may be more appropriate is to have the Edit action be the command ’C:\\WINNT\\System32\\Notepad.exe \"C:\\MC_Warn.txt\"’, where the file C:\\MC_Warn.txt is created locally and contains a warning that the user has attempted to open a potentially dangerous file.\n\nWhen altering the default file type Action is the technique used, the Always show extension setting adds additional value.  This ensures that users can see the file type before attempting to open it.\n\nWhile the alternate technique of deleting existing Windows file type definitions does provide security, it is not always a more secure long-term solution.  During maintenance or product installation, a non-existent file type is usually defined while existing file type properties are usually not overwritten.\n\nRegardless of which technique is used, the significant result is that when an attempt is made to open certain files using default application actions, any code in the file is not executed.\n\nFIle extensions of certain files should not be hidden.  Users can double click a file without knowing what type of file (or which application) is being opened.","check":"On Windows NT/2000/2003/XP--\nStart the Windows Explorer application. \n\nOn the Tools menu, select the Folder Options… item. On the Folder Options window, select the File Types tab. For each of the file types in the table below, select the Edit… button for Windows NT or the Advanced button for Windows 2000/2003/XP. \n\nOn Windows 7/8/2008/2008R2--\nClick on Start. Select Default Programs from the right side of the menu. Choose the Associate a file or protocol with a program option.\n \na) Determine the default Action by looking in the Actions: list for an action in bold font. A typical default action is indicated as “Open”. If none of the entries in the Actions: list appears in bold font, the “Open” action is the default Action. Select the default Action and the Edit… button to determine the application used to perform the action.\nb) Determine the value of the Always show extension option.\n\nFile Type\tExtensions\t\nJScript Script File\tJS\t\t\nWindows Script Component\tSCT,WSC\nJScript Encoded Script File\tJSE\t\t\nWindows Script File\tWSF\nScrap object\tSHS,SHB\t\t\nWindows Script Host Settings File\tWSH\nHTML Applications as Mobile Code\tHTA\t\t\t\nVBScript Encoded Script File\tVBE\t\t\t\nVBScript Script File\tVBS\t\t\t\n\nNOTE: The File Type strings (e.g., “JScript Script File”) may vary according to the specific software release. The key element for the check is the Extension value.\n\n\nCriteria:  If a file type is not defined, this is not a Finding.\na) If the application defined to perform the default Action could execute code in the file, then this is a Finding.  For example, if the default Action for file type .VBS specifies wscript.exe as the application, a Finding is indicated.  On the other hand, if the default Action for any file type specifies notepad.exe as the application, there is not a Finding.\nb) If the Always show extension option is not enabled for each file type, then this is a Finding.\n\n\nFor Windows Vista open the Control Panel select Default Programs select Associate a file type or protocol with a Program:\n\na) Determine the default program by looking in the Current Default: list. A typical default action is indicated as “Open”. If none of the entries in the Actions: list appears in bold font, the “Open” action is the default Action. Select the default Action and the Edit… button to determine the application used to perform the action.\nb) Determine the value of the Always show extension option.\n\nFile Type\tExtensions\t\tFile Type\tExtensions\nJScript Script File\tJS\t\tWindows Script Component\tSCT,WSC\nJScript Encoded Script File\tJSE\t\tWindows Script File\tWSF\nScrap object\tSHS,SHB\t\tWindows Script Host Settings File\tWSH\nHTML Applications as Mobile Code\tHTA\t\t\t\nVBScript Encoded Script File\tVBE\t\t\t\nVBScript Script File\tVBS\t\t\t\n\nNOTE: The File Type strings (e.g., “JScript Script File”) may vary according to the specific software release. The key element for the check is the Extension value.\n\nCriteria:  If a file type is not defined, this is not a Finding.\na) If the application defined in the Current Default list could execute code in the file, then this is a Finding.  For example, if the default program for file type .VBS specifies wscript.exe as the application, a Finding is indicated.  On the other hand, if the default Action for any file type specifies notepad.exe as the application, there is not a Finding.","fix":"Change the default action to an application that will not execute the file such as notepad.exe  and ensure that the Always show extension is enabled for the filetype in question."},"impact":0.5,"refs":[{"ref":"DPMS Target Desktop Application - General"}],"tags":{"check_id":"C-3192r2_chk","severity":"medium","gid":"V-6878","rid":"SV-7145r2_rule","stig_id":"DTGW004","gtitle":"DTGW004-Execution Restricted File Type Properties","fix_id":"F-6566r1_fix","documentable":null,"responsibility":"System Administrator"}},{"id":"SV-7146","code":"control 'SV-7146' do\n  title 'Open-restricted File Type Properties'\n  desc 'For some file types, providing the user an opportunity to cancel the opening of the file provides adequate protection for most environments.  Files that are opened with applications that include internal controls on code execution are good candidates for this technique.\n\nThe Open Confirmation property, enabled through the Confirm open after download setting, provides a notice to the user that allows them to open the file, save the file to disk, or cancel the file open task.  The Always show extension setting adds additional value. This ensures that users can see the file type before attempting to open it.\n\nThe Values of confirm after download and always show extension give the users additional information about a file so a decision can be made as to whether it should be opened.\n\nThe command line tool, ’assoc’, can be used to determine if a given file type definition exists.  For example, on typical Windows systems the command ’assoc.bat’ returns ’.bat=batfile’ indicating that the extension .bat is defined and that the properties are stored in the Windows Registry under the key batfile.\n\nWindows Explorer can be used to manually display and configure the Actions, Always Show Extension, and Open Confirmation properties.  In Windows 2000 and XP use the File Types tab of the Tools | Folder Options dialog in Windows Explorer.\n\nIt must be recognized that performing these changes does not eliminate the danger from malicious code.  Such code could come from a number of sources and use trigger techniques other than the Windows file type open action.  Thus the changes documented here are not a substitute for an anti-virus tool with current definitions.\n\nNOTE:\tThe application of this change affects the behavior of all Windows applications that utilize the affected Registry settings.'\n  desc 'check', 'On Windows NT/2000/2003/XP--\nStart the Windows Explorer application. On the Tools menu, select the Folder Options… item. On the Folder Options window, select the File Types tab. For each of the file types in the table below, select the Edit… button for Windows NT or the Advanced button for Windows 2000/2003/XP. On the Edit File Type window:\na) Determine the value of the Confirm open after download option.\nb) Determine the value of the Always show extension option.\n\nOn Windows 7/8/2008/2008R2--\nStart the Windows Explorer application. Click on the drop-down arrow of the Organize option and select Folder and Search Options. In the Folder Options dialog box, click on the View TAB.\na) Ensure the \"Hide extensions for known file types\" is not selected.\n\nFile Type\tExtensions\t\t\nAdobe Acrobat Document\t         PDF\t\t\nMicrosoft PowerPoint Slide Show\t PPS\nLotusScript Library\t         LSL\t\t\nMicrosoft PowerPoint Template\t POT\nLotusScript Object\t         LSO\t\t\nMicrosoft Word Backup Document\t WBK\nJscript\t                         JS,JSE\t\t\nHTML Applications\t         HTA\nLotusScript Source\t         LSS\t\t\nMicrosoft Word Document\t         DOC\nMicrosoft Excel Backup File      XLK\t\t\nMicrosoft Word Template\t         DOT\nMicrosoft Excel OLE DB Query Files\tRQY\t\t\nMS-DOS Batch File\t         BAT\nMicrosoft Excel Web Query File\t IQY\t\t\nPostScript\t                 PS,EPS\nMicrosoft Excel Template\t XLT\t\t\nRich Text Format\t         RTF\nMicrosoft Excel Worksheet\t XLS,XLB\t\t\nWordPerfect Coach\t         WCH\nVISIO\t                         VSS,VST,VSD,VSW\nMicrosoft Access\t         AD, ADP,MDB,MDE\nShockwave\t                 DCR,DXR,DIR,SPL, SWF\nFlash\t                         FLS\nShell Scrap Object\t         SHS, SHB\t\t\nWordPerfect Macro\t         WCM\nWindows Script Component\t WSC, SCT\nWindows Script File\t         WSF\nWindows Script Host Settings File\tWSH\nVBScript\t                 VBE, VBS\nMicrosoft PowerPoint Presentation\tPPT\n\nNOTE: The File Type strings (e.g., “LotusScript Library”) may vary according to the specific software release. The key element for the check is the Extension value.\n\nCriteria:  If a file type is not defined, this is not a Finding.\na) If the Confirm open after download option in Windows NT/2000/2003/XP is not enabled for each file type, then this is a Finding. In Windows 7/8/2008/2008R2, this is Not Applicable.\nb) If the Always show extension option in Windows NT/2000/2003/XP is not enabled for each file type, then this is a Finding.\nc) If the Hide extensions for know file types in Windows 7/8/2008/2008R2 is selected, then this is a Finding.\n \n*Note: this check does not apply to Windows Vista'\n  desc 'fix', 'For each of the filetypes in question, verify the Confirm after download option and the always show extension option are checked.'\n  impact 0.5\n  ref 'DPMS Target Desktop Application - General'\n  tag check_id: 'C-3193r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-6879'\n  tag rid: 'SV-7146r2_rule'\n  tag stig_id: 'DTGW005'\n  tag gtitle: 'DTGW005-Open_restricted File Type Properties'\n  tag fix_id: 'F-6567r1_fix'\n  tag 'documentable'\n  tag responsibility: 'System Administrator'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Desktop_Apps_General_STIG_V4R5/controls/SV-7146.rb"},"title":"Open-restricted File Type Properties","desc":"For some file types, providing the user an opportunity to cancel the opening of the file provides adequate protection for most environments.  Files that are opened with applications that include internal controls on code execution are good candidates for this technique.\n\nThe Open Confirmation property, enabled through the Confirm open after download setting, provides a notice to the user that allows them to open the file, save the file to disk, or cancel the file open task.  The Always show extension setting adds additional value. This ensures that users can see the file type before attempting to open it.\n\nThe Values of confirm after download and always show extension give the users additional information about a file so a decision can be made as to whether it should be opened.\n\nThe command line tool, ’assoc’, can be used to determine if a given file type definition exists.  For example, on typical Windows systems the command ’assoc.bat’ returns ’.bat=batfile’ indicating that the extension .bat is defined and that the properties are stored in the Windows Registry under the key batfile.\n\nWindows Explorer can be used to manually display and configure the Actions, Always Show Extension, and Open Confirmation properties.  In Windows 2000 and XP use the File Types tab of the Tools | Folder Options dialog in Windows Explorer.\n\nIt must be recognized that performing these changes does not eliminate the danger from malicious code.  Such code could come from a number of sources and use trigger techniques other than the Windows file type open action.  Thus the changes documented here are not a substitute for an anti-virus tool with current definitions.\n\nNOTE:\tThe application of this change affects the behavior of all Windows applications that utilize the affected Registry settings.","descriptions":{"default":"For some file types, providing the user an opportunity to cancel the opening of the file provides adequate protection for most environments.  Files that are opened with applications that include internal controls on code execution are good candidates for this technique.\n\nThe Open Confirmation property, enabled through the Confirm open after download setting, provides a notice to the user that allows them to open the file, save the file to disk, or cancel the file open task.  The Always show extension setting adds additional value. This ensures that users can see the file type before attempting to open it.\n\nThe Values of confirm after download and always show extension give the users additional information about a file so a decision can be made as to whether it should be opened.\n\nThe command line tool, ’assoc’, can be used to determine if a given file type definition exists.  For example, on typical Windows systems the command ’assoc.bat’ returns ’.bat=batfile’ indicating that the extension .bat is defined and that the properties are stored in the Windows Registry under the key batfile.\n\nWindows Explorer can be used to manually display and configure the Actions, Always Show Extension, and Open Confirmation properties.  In Windows 2000 and XP use the File Types tab of the Tools | Folder Options dialog in Windows Explorer.\n\nIt must be recognized that performing these changes does not eliminate the danger from malicious code.  Such code could come from a number of sources and use trigger techniques other than the Windows file type open action.  Thus the changes documented here are not a substitute for an anti-virus tool with current definitions.\n\nNOTE:\tThe application of this change affects the behavior of all Windows applications that utilize the affected Registry settings.","check":"On Windows NT/2000/2003/XP--\nStart the Windows Explorer application. On the Tools menu, select the Folder Options… item. On the Folder Options window, select the File Types tab. For each of the file types in the table below, select the Edit… button for Windows NT or the Advanced button for Windows 2000/2003/XP. On the Edit File Type window:\na) Determine the value of the Confirm open after download option.\nb) Determine the value of the Always show extension option.\n\nOn Windows 7/8/2008/2008R2--\nStart the Windows Explorer application. Click on the drop-down arrow of the Organize option and select Folder and Search Options. In the Folder Options dialog box, click on the View TAB.\na) Ensure the \"Hide extensions for known file types\" is not selected.\n\nFile Type\tExtensions\t\t\nAdobe Acrobat Document\t         PDF\t\t\nMicrosoft PowerPoint Slide Show\t PPS\nLotusScript Library\t         LSL\t\t\nMicrosoft PowerPoint Template\t POT\nLotusScript Object\t         LSO\t\t\nMicrosoft Word Backup Document\t WBK\nJscript\t                         JS,JSE\t\t\nHTML Applications\t         HTA\nLotusScript Source\t         LSS\t\t\nMicrosoft Word Document\t         DOC\nMicrosoft Excel Backup File      XLK\t\t\nMicrosoft Word Template\t         DOT\nMicrosoft Excel OLE DB Query Files\tRQY\t\t\nMS-DOS Batch File\t         BAT\nMicrosoft Excel Web Query File\t IQY\t\t\nPostScript\t                 PS,EPS\nMicrosoft Excel Template\t XLT\t\t\nRich Text Format\t         RTF\nMicrosoft Excel Worksheet\t XLS,XLB\t\t\nWordPerfect Coach\t         WCH\nVISIO\t                         VSS,VST,VSD,VSW\nMicrosoft Access\t         AD, ADP,MDB,MDE\nShockwave\t                 DCR,DXR,DIR,SPL, SWF\nFlash\t                         FLS\nShell Scrap Object\t         SHS, SHB\t\t\nWordPerfect Macro\t         WCM\nWindows Script Component\t WSC, SCT\nWindows Script File\t         WSF\nWindows Script Host Settings File\tWSH\nVBScript\t                 VBE, VBS\nMicrosoft PowerPoint Presentation\tPPT\n\nNOTE: The File Type strings (e.g., “LotusScript Library”) may vary according to the specific software release. The key element for the check is the Extension value.\n\nCriteria:  If a file type is not defined, this is not a Finding.\na) If the Confirm open after download option in Windows NT/2000/2003/XP is not enabled for each file type, then this is a Finding. In Windows 7/8/2008/2008R2, this is Not Applicable.\nb) If the Always show extension option in Windows NT/2000/2003/XP is not enabled for each file type, then this is a Finding.\nc) If the Hide extensions for know file types in Windows 7/8/2008/2008R2 is selected, then this is a Finding.\n \n*Note: this check does not apply to Windows Vista","fix":"For each of the filetypes in question, verify the Confirm after download option and the always show extension option are checked."},"impact":0.5,"refs":[{"ref":"DPMS Target Desktop Application - General"}],"tags":{"check_id":"C-3193r5_chk","severity":"medium","gid":"V-6879","rid":"SV-7146r2_rule","stig_id":"DTGW005","gtitle":"DTGW005-Open_restricted File Type Properties","fix_id":"F-6567r1_fix","documentable":null,"responsibility":"System Administrator"}}],"groups":[{"id":"controls/SV-6428.rb","title":null,"controls":["SV-6428"]},{"id":"controls/SV-6429.rb","title":null,"controls":["SV-6429"]},{"id":"controls/SV-6430.rb","title":null,"controls":["SV-6430"]},{"id":"controls/SV-7145.rb","title":null,"controls":["SV-7145"]},{"id":"controls/SV-7146.rb","title":null,"controls":["SV-7146"]}],"name":"Desktop_Application_General","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"c4868502783ab641ed6c4c6431d47363a726ac3f8c4f7dc771f7f39607fe8fdb","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
