{"controls":[{"id":"SV-29338","code":"control 'SV-29338' do\n  title 'Systems must be maintained at a supported version of an operating system.'\n  desc 'Systems at unsupported versions or releases of an operating system will not receive security updates for new vulnerabilities, which leaves them subject to exploitation. Systems must be maintained at a version of the operating system supported by the vendor with new security updates.'\n  desc 'check', 'Support for Windows 2008/2008 R2 ended 14 January 2020. After this date, systems must have Windows 2012 or greater installed.\n\nRun \"winver.exe\".\n\nIf the \"About Windows\" dialog box does not display:\n\"Microsoft Windows\nVersion 6.3 (Build 9600)\"\nor greater, this is a finding.'\n  desc 'fix', 'Update the system to a version of the operating system supported by the vendor.\n\nSupport for Windows 2008/2008 R2 ended 14 January 2020. After this date, systems must have Windows 2012 or greater installed.'\n  impact 0.7\n  ref 'DPMS Target Windows 2008 DNS'\n  tag check_id: 'C-94141r3_chk'\n  tag severity: 'high'\n  tag gid: 'V-1073'\n  tag rid: 'SV-29338r3_rule'\n  tag gtitle: 'Unsupported Service Packs'\n  tag fix_id: 'F-30098r4_fix'\n  tag 'documentable'\n  tag third_party_tools: 'HK'\n  tag responsibility: 'System Administrator'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-29338.rb"},"title":"Systems must be maintained at a supported version of an operating system.","desc":"Systems at unsupported versions or releases of an operating system will not receive security updates for new vulnerabilities, which leaves them subject to exploitation. Systems must be maintained at a version of the operating system supported by the vendor with new security updates.","descriptions":{"default":"Systems at unsupported versions or releases of an operating system will not receive security updates for new vulnerabilities, which leaves them subject to exploitation. Systems must be maintained at a version of the operating system supported by the vendor with new security updates.","check":"Support for Windows 2008/2008 R2 ended 14 January 2020. After this date, systems must have Windows 2012 or greater installed.\n\nRun \"winver.exe\".\n\nIf the \"About Windows\" dialog box does not display:\n\"Microsoft Windows\nVersion 6.3 (Build 9600)\"\nor greater, this is a finding.","fix":"Update the system to a version of the operating system supported by the vendor.\n\nSupport for Windows 2008/2008 R2 ended 14 January 2020. After this date, systems must have Windows 2012 or greater installed."},"impact":0.7,"refs":[{"ref":"DPMS Target Windows 2008 DNS"}],"tags":{"check_id":"C-94141r3_chk","severity":"high","gid":"V-1073","rid":"SV-29338r3_rule","gtitle":"Unsupported Service Packs","fix_id":"F-30098r4_fix","documentable":null,"third_party_tools":"HK","responsibility":"System Administrator","cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83197","code":"control 'SV-83197' do\n  title 'The Windows DNS primary server must only send zone transfers to a specific list of secondary name servers.'\n  desc 'Primary name servers also make outbound connection to secondary name servers to provide zone transfers and accept inbound connection requests from clients wishing to provide a dynamic update. Primary name servers should explicitly limit zone transfers to only be made to designated secondary name servers. Because zone transfers involve the transfer of entire zones and use TCP connections, they place substantial demands on network resources relative to normal DNS queries. Errant or malicious frequent zone transfer requests on the name servers of the enterprise can overload the master zone server and result in DoS to legitimate users.\n\nAD-integrated DNS servers replicate zone information via AD replication. Non-AD-integrated DNS servers replicate zone information via zone transfers.'\n  desc 'check', %q(If the DNS server only hosts AD-integrated zones and there are not any non-AD-integrated DNS servers acting as secondary DNS servers for the zones, this check is not applicable.\n\nFor a non-AD-integrated DNS server:\n\nLog on to the DNS server using an Administrator account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select, and then right-click the zone name.\n\nFrom the displayed context menu, click the “Properties” option.\n\nOn the opened zone's properties box, go to the “Zone Transfers” tab.\n\nOn the displayed interface, verify if the \"Allow zone transfers\" check box is selected.\n\nIf the \"Allow zone transfers\" check box is not selected, this is not a finding.\n\nIf the \"Allow zone transfers\" check box is selected, verify that either the \"Only to servers listed on the Name Servers tab\" radio button is selected or the \"Only to the following servers\" radio button is selected.\n\nIf the \"To any server\" radio button is selected, this is a finding.)\n  desc 'fix', %q(Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nFrom the displayed context menu, click the “Properties” option.\n\nOn the opened zone's properties box, go to the “Zone Transfers” tab.\n\nOn the displayed interface, select the \"Allow zone transfers\" check box.\n\nSelect the \"Only to servers listed on the Name Servers tab\" radio button OR select the \"Only to the following servers\" radio button.\n\nClick on “Apply”.\n\nClick on “OK”.)\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59509r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58637'\n  tag rid: 'SV-83197r1_rule'\n  tag stig_id: 'WDNS-IA-000004'\n  tag gtitle: 'SRG-APP-000001-DNS-000001'\n  tag fix_id: 'F-64021r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001958']\n  tag nist: ['IA-3']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83197.rb"},"title":"The Windows DNS primary server must only send zone transfers to a specific list of secondary name servers.","desc":"Primary name servers also make outbound connection to secondary name servers to provide zone transfers and accept inbound connection requests from clients wishing to provide a dynamic update. Primary name servers should explicitly limit zone transfers to only be made to designated secondary name servers. Because zone transfers involve the transfer of entire zones and use TCP connections, they place substantial demands on network resources relative to normal DNS queries. Errant or malicious frequent zone transfer requests on the name servers of the enterprise can overload the master zone server and result in DoS to legitimate users.\n\nAD-integrated DNS servers replicate zone information via AD replication. Non-AD-integrated DNS servers replicate zone information via zone transfers.","descriptions":{"default":"Primary name servers also make outbound connection to secondary name servers to provide zone transfers and accept inbound connection requests from clients wishing to provide a dynamic update. Primary name servers should explicitly limit zone transfers to only be made to designated secondary name servers. Because zone transfers involve the transfer of entire zones and use TCP connections, they place substantial demands on network resources relative to normal DNS queries. Errant or malicious frequent zone transfer requests on the name servers of the enterprise can overload the master zone server and result in DoS to legitimate users.\n\nAD-integrated DNS servers replicate zone information via AD replication. Non-AD-integrated DNS servers replicate zone information via zone transfers.","check":"If the DNS server only hosts AD-integrated zones and there are not any non-AD-integrated DNS servers acting as secondary DNS servers for the zones, this check is not applicable.\n\nFor a non-AD-integrated DNS server:\n\nLog on to the DNS server using an Administrator account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select, and then right-click the zone name.\n\nFrom the displayed context menu, click the “Properties” option.\n\nOn the opened zone's properties box, go to the “Zone Transfers” tab.\n\nOn the displayed interface, verify if the \"Allow zone transfers\" check box is selected.\n\nIf the \"Allow zone transfers\" check box is not selected, this is not a finding.\n\nIf the \"Allow zone transfers\" check box is selected, verify that either the \"Only to servers listed on the Name Servers tab\" radio button is selected or the \"Only to the following servers\" radio button is selected.\n\nIf the \"To any server\" radio button is selected, this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nFrom the displayed context menu, click the “Properties” option.\n\nOn the opened zone's properties box, go to the “Zone Transfers” tab.\n\nOn the displayed interface, select the \"Allow zone transfers\" check box.\n\nSelect the \"Only to servers listed on the Name Servers tab\" radio button OR select the \"Only to the following servers\" radio button.\n\nClick on “Apply”.\n\nClick on “OK”."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59509r5_chk","severity":"medium","gid":"V-58637","rid":"SV-83197r1_rule","stig_id":"WDNS-IA-000004","gtitle":"SRG-APP-000001-DNS-000001","fix_id":"F-64021r3_fix","documentable":null,"cci":["CCI-001958"],"nist":["IA-3"]}},{"id":"SV-83199","code":"control 'SV-83199' do\n  title 'The Windows 2008 DNS Server must restrict incoming dynamic update requests to known clients.'\n  desc \"Limiting the number of concurrent sessions reduces the risk of Denial of Service (DoS) on any system.\n\nA DNS server's function requires it to be able to handle multiple sessions at a time so limiting concurrent sessions could potentially cause an impact to availability.  Primary name servers need to be configured to limit the actual hosts from which they will accept dynamic updates and from which they will accept zone transfer requests, and all name servers should be configured to limit the hosts from/to which they receive/send zone transfers. Restricting sessions to known hosts will mitigate the DoS vulnerability.\"\n  desc 'check', %q(Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nOnce selected, right-click the name of the zone.\n\nFrom the displayed context menu, click the “Properties” option.\n\nOn the opened domain's properties box, click the “General” tab.\n\nVerify the Type: is Active Directory-Integrated.\n\nVerify the Dynamic updates has \"Secure only\" selected.\n\nIf the zone is Active Directory-Integrated and the Dynamic updates are not configured for \"Secure only\", this is a finding.)\n  desc 'fix', %q(Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nOnce selected, right-click the name of the zone.\n\nFrom the displayed context menu, click the “Properties” option.\n\nOn the opened domain's properties box, click the “General” tab.\n\nIf the Type: is not Active Directory-Integrated, configure the zone for AD-integration.\n\nSelect \"Secure only\" from the Dynamic updates: drop-down list.)\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-58987r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58237'\n  tag rid: 'SV-83199r1_rule'\n  tag stig_id: 'WDNS-AC-000001'\n  tag gtitle: 'SRG-APP-000001-DNS-000115'\n  tag fix_id: 'F-63465r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83199.rb"},"title":"The Windows 2008 DNS Server must restrict incoming dynamic update requests to known clients.","desc":"Limiting the number of concurrent sessions reduces the risk of Denial of Service (DoS) on any system.\n\nA DNS server's function requires it to be able to handle multiple sessions at a time so limiting concurrent sessions could potentially cause an impact to availability.  Primary name servers need to be configured to limit the actual hosts from which they will accept dynamic updates and from which they will accept zone transfer requests, and all name servers should be configured to limit the hosts from/to which they receive/send zone transfers. Restricting sessions to known hosts will mitigate the DoS vulnerability.","descriptions":{"default":"Limiting the number of concurrent sessions reduces the risk of Denial of Service (DoS) on any system.\n\nA DNS server's function requires it to be able to handle multiple sessions at a time so limiting concurrent sessions could potentially cause an impact to availability.  Primary name servers need to be configured to limit the actual hosts from which they will accept dynamic updates and from which they will accept zone transfer requests, and all name servers should be configured to limit the hosts from/to which they receive/send zone transfers. Restricting sessions to known hosts will mitigate the DoS vulnerability.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nOnce selected, right-click the name of the zone.\n\nFrom the displayed context menu, click the “Properties” option.\n\nOn the opened domain's properties box, click the “General” tab.\n\nVerify the Type: is Active Directory-Integrated.\n\nVerify the Dynamic updates has \"Secure only\" selected.\n\nIf the zone is Active Directory-Integrated and the Dynamic updates are not configured for \"Secure only\", this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nOnce selected, right-click the name of the zone.\n\nFrom the displayed context menu, click the “Properties” option.\n\nOn the opened domain's properties box, click the “General” tab.\n\nIf the Type: is not Active Directory-Integrated, configure the zone for AD-integration.\n\nSelect \"Secure only\" from the Dynamic updates: drop-down list."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-58987r3_chk","severity":"medium","gid":"V-58237","rid":"SV-83199r1_rule","stig_id":"WDNS-AC-000001","gtitle":"SRG-APP-000001-DNS-000115","fix_id":"F-63465r3_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-83201","code":"control 'SV-83201' do\n  title 'The Windows 2008 DNS Server log must be enabled.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one. The actual auditing is performed by the OS/NDM, but the configuration to trigger the auditing is controlled by the DNS server.'\n  desc 'check', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nRight-click the DNS server, select “Properties”.\n\nClick on the “Event Logging” tab. By default, all events are logged.\n\nVerify \"Errors and warnings\" or \"All events\" is selected.\n\nIf any option other than \"Errors and warnings\" or \"All events\" is selected, this is a finding.'\n  desc 'fix', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nRight-click the DNS server, select “Properties”.\n\nClick on the “Event Logging” tab. By default, all events are logged.\n\nSelect the \"Errors and warnings\" or \"All events\" option.\n\nClick on “Apply”.\n\nClick “OK”.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59421r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58549'\n  tag rid: 'SV-83201r1_rule'\n  tag stig_id: 'WDNS-AU-000005'\n  tag gtitle: 'SRG-APP-000089-DNS-000004'\n  tag fix_id: 'F-63933r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000169']\n  tag nist: ['AU-12 a']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83201.rb"},"title":"The Windows 2008 DNS Server log must be enabled.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one. The actual auditing is performed by the OS/NDM, but the configuration to trigger the auditing is controlled by the DNS server.","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one. The actual auditing is performed by the OS/NDM, but the configuration to trigger the auditing is controlled by the DNS server.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nRight-click the DNS server, select “Properties”.\n\nClick on the “Event Logging” tab. By default, all events are logged.\n\nVerify \"Errors and warnings\" or \"All events\" is selected.\n\nIf any option other than \"Errors and warnings\" or \"All events\" is selected, this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nRight-click the DNS server, select “Properties”.\n\nClick on the “Event Logging” tab. By default, all events are logged.\n\nSelect the \"Errors and warnings\" or \"All events\" option.\n\nClick on “Apply”.\n\nClick “OK”."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59421r2_chk","severity":"medium","gid":"V-58549","rid":"SV-83201r1_rule","stig_id":"WDNS-AU-000005","gtitle":"SRG-APP-000089-DNS-000004","fix_id":"F-63933r2_fix","documentable":null,"cci":["CCI-000169"],"nist":["AU-12 a"]}},{"id":"SV-83203","code":"control 'SV-83203' do\n  title 'The Windows 2008 DNS Server logging criteria must only be configured by the ISSM or individuals appointed by the ISSM.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. The actual auditing is performed by the OS/NDM, but the configuration to trigger the auditing is controlled by the DNS server.\n\nSince the configuration of the audit logs on the DNS server dictates which events are logged for the purposes of correlating events, the permissions for configuring the audit logs must be restricted to only those with the role of ISSM or those appointed by the ISSM.'\n  desc 'check', 'Verify the effective setting in Local Group Policy Editor.\n\nRun \"gpedit.msc\".\n\nNavigate to Local Computer Policy >> Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment.\n\nIf any accounts or groups other than the following are granted the \"Manage auditing and security log\" user right, this is a finding:\n\nAdministrators \nAuditors (if the site has an Auditors group that further limits this privilege.)\n\nIf an application requires this user right, this would not be a finding. \nVendor documentation must support the requirement for having the user right. \nThe requirement must be documented with the ISSO. \nThe application account must meet requirements for application account passwords.\n\nVerify the permissions on the DNS logs.\n\nStandard user accounts or groups must not have greater than READ access.\n\nThe default locations are:\n\nDNS Server %SystemRoot%\\\\System32\\\\Winevt\\\\Logs\\\\DNS Server.evtx\n\nUsing the file explorer tool navigate to the DNS Server log file.\n\nRight click on the log file, select the “Security” tab.\n\nThe default permissions listed below satisfy this requirement:\n\nEventlog - Full Control\nSYSTEM - Full Control\nAdministrators - Full Control\n\nIf the permissions for these files are not as restrictive as the ACLs listed, this is a finding.'\n  desc 'fix', 'Configure the permissions on the DNS logs.\n\nStandard user accounts or groups must not have greater than READ access.\n\nThe default permissions listed below satisfy this requirement:\n\nEventlog - Full Control\nSYSTEM - Full Control\nAdministrators - Full Control\n\nThe default locations are:\n\nDNS Server %SystemRoot%\\\\System32\\\\Winevt\\\\Logs\\\\DNS Server.evtx'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59425r6_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58553'\n  tag rid: 'SV-83203r2_rule'\n  tag stig_id: 'WDNS-AU-000007'\n  tag gtitle: 'SRG-APP-000090-DNS-000005'\n  tag fix_id: 'F-63937r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000171']\n  tag nist: ['AU-12 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83203.rb"},"title":"The Windows 2008 DNS Server logging criteria must only be configured by the ISSM or individuals appointed by the ISSM.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. The actual auditing is performed by the OS/NDM, but the configuration to trigger the auditing is controlled by the DNS server.\n\nSince the configuration of the audit logs on the DNS server dictates which events are logged for the purposes of correlating events, the permissions for configuring the audit logs must be restricted to only those with the role of ISSM or those appointed by the ISSM.","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. The actual auditing is performed by the OS/NDM, but the configuration to trigger the auditing is controlled by the DNS server.\n\nSince the configuration of the audit logs on the DNS server dictates which events are logged for the purposes of correlating events, the permissions for configuring the audit logs must be restricted to only those with the role of ISSM or those appointed by the ISSM.","check":"Verify the effective setting in Local Group Policy Editor.\n\nRun \"gpedit.msc\".\n\nNavigate to Local Computer Policy >> Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment.\n\nIf any accounts or groups other than the following are granted the \"Manage auditing and security log\" user right, this is a finding:\n\nAdministrators \nAuditors (if the site has an Auditors group that further limits this privilege.)\n\nIf an application requires this user right, this would not be a finding. \nVendor documentation must support the requirement for having the user right. \nThe requirement must be documented with the ISSO. \nThe application account must meet requirements for application account passwords.\n\nVerify the permissions on the DNS logs.\n\nStandard user accounts or groups must not have greater than READ access.\n\nThe default locations are:\n\nDNS Server %SystemRoot%\\System32\\Winevt\\Logs\\DNS Server.evtx\n\nUsing the file explorer tool navigate to the DNS Server log file.\n\nRight click on the log file, select the “Security” tab.\n\nThe default permissions listed below satisfy this requirement:\n\nEventlog - Full Control\nSYSTEM - Full Control\nAdministrators - Full Control\n\nIf the permissions for these files are not as restrictive as the ACLs listed, this is a finding.","fix":"Configure the permissions on the DNS logs.\n\nStandard user accounts or groups must not have greater than READ access.\n\nThe default permissions listed below satisfy this requirement:\n\nEventlog - Full Control\nSYSTEM - Full Control\nAdministrators - Full Control\n\nThe default locations are:\n\nDNS Server %SystemRoot%\\System32\\Winevt\\Logs\\DNS Server.evtx"},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59425r6_chk","severity":"medium","gid":"V-58553","rid":"SV-83203r2_rule","stig_id":"WDNS-AU-000007","gtitle":"SRG-APP-000090-DNS-000005","fix_id":"F-63937r2_fix","documentable":null,"cci":["CCI-000171"],"nist":["AU-12 b"]}},{"id":"SV-83205","code":"control 'SV-83205' do\n  title 'The Windows 2008 DNS Servers audit records must be backed up at least every seven days onto a different system or system component than the system or component being audited.'\n  desc 'Protection of log data includes assuring log data is not accidentally lost or deleted. Backing up audit records to a different system or onto separate media than the system being audited on a defined frequency helps to assure, in the event of a catastrophic system failure, the audit records will be retained. \n\nThis helps to ensure a compromise of the information system being audited does not also result in a compromise of the audit records.\n\nThis requirement only applies to applications that have a native backup capability for audit records. Operating system backup requirements cover applications that do not provide native backup functions.'\n  desc 'check', \"Consult with the System Administrator to determine the backup policy in place for Windows DNS Server.\n\nReview the backup methods used and determine if the backup's methods have been successful at backing up the audit records at least every seven days.\n\nIf the organization does not have a backup policy in place for backing up the Windows DNS Server's audit records and/or the backup methods have not been successful at backing up the audit records at least every seven days, this is a finding.\"\n  desc 'fix', \"Document and implement a backup policy to back up the DNS Server's audit records at least every seven days.\"\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59445r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58573'\n  tag rid: 'SV-83205r1_rule'\n  tag stig_id: 'WDNS-AU-000016'\n  tag gtitle: 'SRG-APP-000125-DNS-000012'\n  tag fix_id: 'F-63957r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001348']\n  tag nist: ['AU-9 (2)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83205.rb"},"title":"The Windows 2008 DNS Servers audit records must be backed up at least every seven days onto a different system or system component than the system or component being audited.","desc":"Protection of log data includes assuring log data is not accidentally lost or deleted. Backing up audit records to a different system or onto separate media than the system being audited on a defined frequency helps to assure, in the event of a catastrophic system failure, the audit records will be retained. \n\nThis helps to ensure a compromise of the information system being audited does not also result in a compromise of the audit records.\n\nThis requirement only applies to applications that have a native backup capability for audit records. Operating system backup requirements cover applications that do not provide native backup functions.","descriptions":{"default":"Protection of log data includes assuring log data is not accidentally lost or deleted. Backing up audit records to a different system or onto separate media than the system being audited on a defined frequency helps to assure, in the event of a catastrophic system failure, the audit records will be retained. \n\nThis helps to ensure a compromise of the information system being audited does not also result in a compromise of the audit records.\n\nThis requirement only applies to applications that have a native backup capability for audit records. Operating system backup requirements cover applications that do not provide native backup functions.","check":"Consult with the System Administrator to determine the backup policy in place for Windows DNS Server.\n\nReview the backup methods used and determine if the backup's methods have been successful at backing up the audit records at least every seven days.\n\nIf the organization does not have a backup policy in place for backing up the Windows DNS Server's audit records and/or the backup methods have not been successful at backing up the audit records at least every seven days, this is a finding.","fix":"Document and implement a backup policy to back up the DNS Server's audit records at least every seven days."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59445r3_chk","severity":"medium","gid":"V-58573","rid":"SV-83205r1_rule","stig_id":"WDNS-AU-000016","gtitle":"SRG-APP-000125-DNS-000012","fix_id":"F-63957r2_fix","documentable":null,"cci":["CCI-001348"],"nist":["AU-9 (2)"]}},{"id":"SV-83207","code":"control 'SV-83207' do\n  title 'The Windows 2008 DNS Server must be configured to enforce authorized access to the corresponding private key.'\n  desc 'The cornerstone of the PKI is the private key used to encrypt or digitally sign information. If the private key is stolen, this will lead to the compromise of the authentication and non-repudiation gained through PKI because the attacker can use the private key to digitally sign documents and pretend to be the authorized user. Both the holders of a digital certificate and the issuing authority must protect the computers, storage devices, or whatever they use to keep the private keys.\n\nSIG(0) is used for server-to-server authentication for DNS transactions, and it uses PKI-based authentication. So, in cases where SIG(0) is being used instead of TSIG (which uses a shared key, not PKI-based authentication), this requirement is applicable.'\n  desc 'check', \"Access Windows Explorer.\n\nNavigate to the following location:\n\n%ALLUSERSPROFILE%\\\\Microsoft\\\\Crypto\nNote: If the %ALLUSERSPROFILE%\\\\Microsoft\\\\Crypto folder doesn't exist, this is not applicable.\n\nVerify the permissions on the keys folder, sub-folders, and files are limited to SYSTEM and Administrators FULL CONTROL.\n\nIf any other user or group has greater than READ privileges to the %ALLUSERSPROFILE%\\\\Microsoft\\\\Crypto folder, sub-folders and files, this is a finding.\"\n  desc 'fix', 'Access Windows Explorer.\n\nNavigate to the following location:\n\n%ALLUSERSPROFILE%\\\\Microsoft\\\\Crypto\n\nModify permissions on the keys folder, sub-folders, and files to be limited to SYSTEM and Administrators FULL CONTROL and to all other Users/Groups to READ.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59513r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58641'\n  tag rid: 'SV-83207r1_rule'\n  tag stig_id: 'WDNS-IA-000006'\n  tag gtitle: 'SRG-APP-000176-DNS-000017'\n  tag fix_id: 'F-64025r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000186']\n  tag nist: ['IA-5 (2) (a) (1)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83207.rb"},"title":"The Windows 2008 DNS Server must be configured to enforce authorized access to the corresponding private key.","desc":"The cornerstone of the PKI is the private key used to encrypt or digitally sign information. If the private key is stolen, this will lead to the compromise of the authentication and non-repudiation gained through PKI because the attacker can use the private key to digitally sign documents and pretend to be the authorized user. Both the holders of a digital certificate and the issuing authority must protect the computers, storage devices, or whatever they use to keep the private keys.\n\nSIG(0) is used for server-to-server authentication for DNS transactions, and it uses PKI-based authentication. So, in cases where SIG(0) is being used instead of TSIG (which uses a shared key, not PKI-based authentication), this requirement is applicable.","descriptions":{"default":"The cornerstone of the PKI is the private key used to encrypt or digitally sign information. If the private key is stolen, this will lead to the compromise of the authentication and non-repudiation gained through PKI because the attacker can use the private key to digitally sign documents and pretend to be the authorized user. Both the holders of a digital certificate and the issuing authority must protect the computers, storage devices, or whatever they use to keep the private keys.\n\nSIG(0) is used for server-to-server authentication for DNS transactions, and it uses PKI-based authentication. So, in cases where SIG(0) is being used instead of TSIG (which uses a shared key, not PKI-based authentication), this requirement is applicable.","check":"Access Windows Explorer.\n\nNavigate to the following location:\n\n%ALLUSERSPROFILE%\\Microsoft\\Crypto\nNote: If the %ALLUSERSPROFILE%\\Microsoft\\Crypto folder doesn't exist, this is not applicable.\n\nVerify the permissions on the keys folder, sub-folders, and files are limited to SYSTEM and Administrators FULL CONTROL.\n\nIf any other user or group has greater than READ privileges to the %ALLUSERSPROFILE%\\Microsoft\\Crypto folder, sub-folders and files, this is a finding.","fix":"Access Windows Explorer.\n\nNavigate to the following location:\n\n%ALLUSERSPROFILE%\\Microsoft\\Crypto\n\nModify permissions on the keys folder, sub-folders, and files to be limited to SYSTEM and Administrators FULL CONTROL and to all other Users/Groups to READ."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59513r5_chk","severity":"medium","gid":"V-58641","rid":"SV-83207r1_rule","stig_id":"WDNS-IA-000006","gtitle":"SRG-APP-000176-DNS-000017","fix_id":"F-64025r3_fix","documentable":null,"cci":["CCI-000186"],"nist":["IA-5 (2) (a) (1)"]}},{"id":"SV-83209","code":"control 'SV-83209' do\n  title 'The Windows DNS Server key file must be owned by the account under which the Windows  DNS Server service is run.'\n  desc 'To enable dnssec (requests and responses) through authenticated messages, it is necessary to generate a key for every pair of name servers. The key can also be used for securing other transactions, such as dynamic updates, DNS queries, and responses. The binary key string that is generated by the dnscmd key generation utility used with DNSSEC is Base64-encoded.'\n  desc 'check', \"Access Services on the Windows DNS Server and locate the DNS Server Service.\n\nDetermine the account under which the DNS Server Service is running. \n\nAccess Windows Explorer.\n\nNavigate to the following location:\n\n%ALLUSERSPROFILE%\\\\Microsoft\\\\Crypto\nNote: If the %ALLUSERSPROFILE%\\\\Microsoft\\\\Crypto folder doesn't exist, this is not applicable.\n\nRight-click on each sub-folder, choose “Properties”, click on the “Security” tab, and click on the “Advanced” button.\n\nVerify the Owner on the folder, sub-folders, and files are the account under which the DNS Server Service is running.\n\nIf any other user or group is listed as OWNER of the %ALLUSERSPROFILE%\\\\Microsoft\\\\Crypto folder, sub-folders, and files, this is a finding.\"\n  desc 'fix', 'Access Windows Explorer.\n\nNavigate to the following location:\n\n%ALLUSERSPROFILE%\\\\Microsoft\\\\Crypto\n\nRight-click on each sub-folder, choose “Properties”, click on the “Security” tab, and click on the “Advanced” button.\n\nClick on \"Change\" next to the listed Owner and change to be the account under which the DNS Server Service is running.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59515r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58643'\n  tag rid: 'SV-83209r2_rule'\n  tag stig_id: 'WDNS-IA-000007'\n  tag gtitle: 'SRG-APP-000176-DNS-000018'\n  tag fix_id: 'F-64027r5_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000186']\n  tag nist: ['IA-5 (2) (a) (1)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83209.rb"},"title":"The Windows DNS Server key file must be owned by the account under which the Windows  DNS Server service is run.","desc":"To enable dnssec (requests and responses) through authenticated messages, it is necessary to generate a key for every pair of name servers. The key can also be used for securing other transactions, such as dynamic updates, DNS queries, and responses. The binary key string that is generated by the dnscmd key generation utility used with DNSSEC is Base64-encoded.","descriptions":{"default":"To enable dnssec (requests and responses) through authenticated messages, it is necessary to generate a key for every pair of name servers. The key can also be used for securing other transactions, such as dynamic updates, DNS queries, and responses. The binary key string that is generated by the dnscmd key generation utility used with DNSSEC is Base64-encoded.","check":"Access Services on the Windows DNS Server and locate the DNS Server Service.\n\nDetermine the account under which the DNS Server Service is running. \n\nAccess Windows Explorer.\n\nNavigate to the following location:\n\n%ALLUSERSPROFILE%\\Microsoft\\Crypto\nNote: If the %ALLUSERSPROFILE%\\Microsoft\\Crypto folder doesn't exist, this is not applicable.\n\nRight-click on each sub-folder, choose “Properties”, click on the “Security” tab, and click on the “Advanced” button.\n\nVerify the Owner on the folder, sub-folders, and files are the account under which the DNS Server Service is running.\n\nIf any other user or group is listed as OWNER of the %ALLUSERSPROFILE%\\Microsoft\\Crypto folder, sub-folders, and files, this is a finding.","fix":"Access Windows Explorer.\n\nNavigate to the following location:\n\n%ALLUSERSPROFILE%\\Microsoft\\Crypto\n\nRight-click on each sub-folder, choose “Properties”, click on the “Security” tab, and click on the “Advanced” button.\n\nClick on \"Change\" next to the listed Owner and change to be the account under which the DNS Server Service is running."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59515r5_chk","severity":"medium","gid":"V-58643","rid":"SV-83209r2_rule","stig_id":"WDNS-IA-000007","gtitle":"SRG-APP-000176-DNS-000018","fix_id":"F-64027r5_fix","documentable":null,"cci":["CCI-000186"],"nist":["IA-5 (2) (a) (1)"]}},{"id":"SV-83211","code":"control 'SV-83211' do\n  title 'The Windows 2008 DNS Server must uniquely identify the other DNS server before responding to a server-to-server transaction.'\n  desc 'Without identifying devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. This applies to server-to-server (zone transfer) transactions only and is provided by TSIG/SIG(0), which enforces mutual server authentication using a key that is unique to each server pair (TSIG) or using PKI-based authentication (SIG(0)), thus uniquely identifying the other server.\n\nTSIG and SIG(0) are not configurable in Windows 2008 DNS Server.\n\nTo meet the requirement for authentication between Windows DNS servers, IPsec will be implemented between the Windows DNS servers which host any non-AD-integrated zones.\nTSIG and SIG(0) are not configurable in Windows 2012 DNS Server.\n\nTo meet the requirement for authentication between Windows DNS servers, IPsec will be implemented between the Windows DNS servers which host any non-AD-integrated zones.'\n  desc 'check', 'Note: This requirement applies to any Windows DNS Server which host non-AD-integrated zones even if the DNS servers host AD-integrated zones, too.\n\nIf the Windows DNS Servers only host AD-integrated zones, this requirement is not applicable.\n\nLog on to the DNS server which hosts non-AD-integrated zones using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute gpme.msc to open the Group Policy Management feature.\n\nIn the “Browse for Group Policy Object” dialog box, double-click “Domain Controllers.domain.com”.\n\nClick “Default Domain Controllers Policy” and click “OK”.\n\nIn the console tree, open Computer Configuration\\\\Policies\\\\Windows Settings\\\\Security Settings\\\\Windows Firewall with Advanced Security\\\\Windows Firewall with Advanced Security - LDAP.\n\nClick “Connection Security Rules”.\n\nConfirm at least one rule is configured for TCP 53.\n\nDouble-click on each Rule to verify the following: \n\nOn the “Authentication” tab, \"Authentication mode:\" is set to \"Request authentication for inbound and outbound connections\".\n\nConfirm the \"Signing Algorithm\" is set to \"RSA (default)\".\n\nOn the “Remote Computers” tab, Endpoint1 and Endpoint2 are configured with the IP addresses of all DNS servers.\n\nOn the “Protocols and Ports” tab, \"Protocol type:\" is set to either TCP (depending upon which rule is being reviewed) and the \"Endpoint 1 port:\" is set to \"Specific ports\" and \"53\".\n\nIf there are not rules(s) configured with the specified requirements, this is a finding.'\n  desc 'fix', %q(Complete the following procedures twice for each pair of name servers.\n\nFirst create a rule for TCP connections.\n\nRefer to the U_Windows_Domain_Name_Service_2008_Overview.pdf for Microsoft links for this procedure.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute gpme.msc to open the Group Policy Management feature.\n\nIn the Browse for “Group Policy Object” dialog box, double-click “Domain Controllers.domain.com”.\n\nClick “Default Domain Controllers Policy” and click “OK”.\n\nIn the console tree, open Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security - LDAP.\n\nRight-Click “Connection Security Rules” and select “New”.\n\nFor Rule Type, select the \"Server-to-server\" radio button, click “Next”.\n\nFor Endpoint 1 and Endpoint 2, select \"These IP addresses:\" and add the IP addresses of all DNS servers, click “Next”.\n\nFor Requirements, select \"Request authentication for inbound and outbound connections\", click “Next”.\n\nFor Authentication Method, select Computer certificate and from the \"Signing Algorithm:\" drop-down, select \"RSA (default)\".\n\nFrom the \"Certificate store type:\" drop-down, select \"Root CA (default)”.\n\nFrom the \"CA name:\", click “Browse” and select the certificate for the CA, click “Next”.\n\nOn Profile, accept default selections, click “Next”.\n\nOn Name, enter a name applicable to the rule's function, click “Finish”.)\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59505r8_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58633'\n  tag rid: 'SV-83211r2_rule'\n  tag stig_id: 'WDNS-IA-000002'\n  tag gtitle: 'SRG-APP-000158-DNS-000015'\n  tag fix_id: 'F-64017r5_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000778']\n  tag nist: ['IA-3']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83211.rb"},"title":"The Windows 2008 DNS Server must uniquely identify the other DNS server before responding to a server-to-server transaction.","desc":"Without identifying devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. This applies to server-to-server (zone transfer) transactions only and is provided by TSIG/SIG(0), which enforces mutual server authentication using a key that is unique to each server pair (TSIG) or using PKI-based authentication (SIG(0)), thus uniquely identifying the other server.\n\nTSIG and SIG(0) are not configurable in Windows 2008 DNS Server.\n\nTo meet the requirement for authentication between Windows DNS servers, IPsec will be implemented between the Windows DNS servers which host any non-AD-integrated zones.\nTSIG and SIG(0) are not configurable in Windows 2012 DNS Server.\n\nTo meet the requirement for authentication between Windows DNS servers, IPsec will be implemented between the Windows DNS servers which host any non-AD-integrated zones.","descriptions":{"default":"Without identifying devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. This applies to server-to-server (zone transfer) transactions only and is provided by TSIG/SIG(0), which enforces mutual server authentication using a key that is unique to each server pair (TSIG) or using PKI-based authentication (SIG(0)), thus uniquely identifying the other server.\n\nTSIG and SIG(0) are not configurable in Windows 2008 DNS Server.\n\nTo meet the requirement for authentication between Windows DNS servers, IPsec will be implemented between the Windows DNS servers which host any non-AD-integrated zones.\nTSIG and SIG(0) are not configurable in Windows 2012 DNS Server.\n\nTo meet the requirement for authentication between Windows DNS servers, IPsec will be implemented between the Windows DNS servers which host any non-AD-integrated zones.","check":"Note: This requirement applies to any Windows DNS Server which host non-AD-integrated zones even if the DNS servers host AD-integrated zones, too.\n\nIf the Windows DNS Servers only host AD-integrated zones, this requirement is not applicable.\n\nLog on to the DNS server which hosts non-AD-integrated zones using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute gpme.msc to open the Group Policy Management feature.\n\nIn the “Browse for Group Policy Object” dialog box, double-click “Domain Controllers.domain.com”.\n\nClick “Default Domain Controllers Policy” and click “OK”.\n\nIn the console tree, open Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security - LDAP.\n\nClick “Connection Security Rules”.\n\nConfirm at least one rule is configured for TCP 53.\n\nDouble-click on each Rule to verify the following: \n\nOn the “Authentication” tab, \"Authentication mode:\" is set to \"Request authentication for inbound and outbound connections\".\n\nConfirm the \"Signing Algorithm\" is set to \"RSA (default)\".\n\nOn the “Remote Computers” tab, Endpoint1 and Endpoint2 are configured with the IP addresses of all DNS servers.\n\nOn the “Protocols and Ports” tab, \"Protocol type:\" is set to either TCP (depending upon which rule is being reviewed) and the \"Endpoint 1 port:\" is set to \"Specific ports\" and \"53\".\n\nIf there are not rules(s) configured with the specified requirements, this is a finding.","fix":"Complete the following procedures twice for each pair of name servers.\n\nFirst create a rule for TCP connections.\n\nRefer to the U_Windows_Domain_Name_Service_2008_Overview.pdf for Microsoft links for this procedure.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute gpme.msc to open the Group Policy Management feature.\n\nIn the Browse for “Group Policy Object” dialog box, double-click “Domain Controllers.domain.com”.\n\nClick “Default Domain Controllers Policy” and click “OK”.\n\nIn the console tree, open Computer Configuration\\Policies\\Windows Settings\\Security Settings\\Windows Firewall with Advanced Security\\Windows Firewall with Advanced Security - LDAP.\n\nRight-Click “Connection Security Rules” and select “New”.\n\nFor Rule Type, select the \"Server-to-server\" radio button, click “Next”.\n\nFor Endpoint 1 and Endpoint 2, select \"These IP addresses:\" and add the IP addresses of all DNS servers, click “Next”.\n\nFor Requirements, select \"Request authentication for inbound and outbound connections\", click “Next”.\n\nFor Authentication Method, select Computer certificate and from the \"Signing Algorithm:\" drop-down, select \"RSA (default)\".\n\nFrom the \"Certificate store type:\" drop-down, select \"Root CA (default)”.\n\nFrom the \"CA name:\", click “Browse” and select the certificate for the CA, click “Next”.\n\nOn Profile, accept default selections, click “Next”.\n\nOn Name, enter a name applicable to the rule's function, click “Finish”."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59505r8_chk","severity":"medium","gid":"V-58633","rid":"SV-83211r2_rule","stig_id":"WDNS-IA-000002","gtitle":"SRG-APP-000158-DNS-000015","fix_id":"F-64017r5_fix","documentable":null,"cci":["CCI-000778"],"nist":["IA-3"]}},{"id":"SV-83213","code":"control 'SV-83213' do\n  title 'The Windows DNS name servers for a zone must be geographically dispersed.'\n  desc %q(In addition to network-based separation, authoritative name servers should be dispersed geographically as well. In other words, in addition to being located on different network segments, the authoritative name servers should not all be located within the same building. One approach that some organizations follow is to locate some authoritative name servers in their own premises and others in their ISPs' data centers or in partnering organizations.\n\nA network administrator may choose to use a \"hidden\" master authoritative server and only have secondary servers visible on the network. A hidden master authoritative server is an authoritative DNS server whose IP address does not appear in the name server set for a zone.  If the master authoritative name server is \"hidden\", a secondary authoritative name server may reside in the same building as the hidden master.)\n  desc 'check', 'Windows DNS Servers that are Active Directory integrated must be located where required to meet the Active Directory services. \n\nIf all of the Windows DNS Servers are AD integrated, this check is Not Applicable.\n\nIf any or all of the Windows DNS Servers are standalone and non-AD-integrated, verify with the System Administrator their geographic location.\n\nIf any or all of the authoritative name servers are located in the same building as the master authoritative name server, and the master authoritative name server is not \"hidden\", this is a finding.'\n  desc 'fix', 'For non-AD-integrated Windows DNS Servers, distribute secondary authoritative servers to be located in different buildings from the primary authoritative server.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59449r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58577'\n  tag rid: 'SV-83213r2_rule'\n  tag stig_id: 'WDNS-CM-000002'\n  tag gtitle: 'SRG-APP-000218-DNS-000027'\n  tag fix_id: 'F-63961r8_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83213.rb"},"title":"The Windows DNS name servers for a zone must be geographically dispersed.","desc":"In addition to network-based separation, authoritative name servers should be dispersed geographically as well. In other words, in addition to being located on different network segments, the authoritative name servers should not all be located within the same building. One approach that some organizations follow is to locate some authoritative name servers in their own premises and others in their ISPs' data centers or in partnering organizations.\n\nA network administrator may choose to use a \"hidden\" master authoritative server and only have secondary servers visible on the network. A hidden master authoritative server is an authoritative DNS server whose IP address does not appear in the name server set for a zone.  If the master authoritative name server is \"hidden\", a secondary authoritative name server may reside in the same building as the hidden master.","descriptions":{"default":"In addition to network-based separation, authoritative name servers should be dispersed geographically as well. In other words, in addition to being located on different network segments, the authoritative name servers should not all be located within the same building. One approach that some organizations follow is to locate some authoritative name servers in their own premises and others in their ISPs' data centers or in partnering organizations.\n\nA network administrator may choose to use a \"hidden\" master authoritative server and only have secondary servers visible on the network. A hidden master authoritative server is an authoritative DNS server whose IP address does not appear in the name server set for a zone.  If the master authoritative name server is \"hidden\", a secondary authoritative name server may reside in the same building as the hidden master.","check":"Windows DNS Servers that are Active Directory integrated must be located where required to meet the Active Directory services. \n\nIf all of the Windows DNS Servers are AD integrated, this check is Not Applicable.\n\nIf any or all of the Windows DNS Servers are standalone and non-AD-integrated, verify with the System Administrator their geographic location.\n\nIf any or all of the authoritative name servers are located in the same building as the master authoritative name server, and the master authoritative name server is not \"hidden\", this is a finding.","fix":"For non-AD-integrated Windows DNS Servers, distribute secondary authoritative servers to be located in different buildings from the primary authoritative server."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59449r4_chk","severity":"medium","gid":"V-58577","rid":"SV-83213r2_rule","stig_id":"WDNS-CM-000002","gtitle":"SRG-APP-000218-DNS-000027","fix_id":"F-63961r8_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83215","code":"control 'SV-83215' do\n  title 'The Windows 2008 DNS Server must protect secret/private cryptographic keys while at rest.'\n  desc 'Information at rest refers to the state of information when it is located on a secondary storage device within an organizational information system. Mobile devices, laptops, desktops, and storage devices can be either lost or stolen, and the contents of their data storage (e.g., hard drives and non-volatile memory) can be read, copied, or altered. Applications and application users generate information throughout the course of their application use.\n\nThe DNS server must protect the confidentiality and integrity of shared keys (for TSIG) and private keys (for SIG(0)) and must protect the integrity of DNS information. There is no need to protect the confidentiality of DNS information because it is accessible by all devices that can contact the server.'\n  desc 'check', 'To ensure the cryptographic keys are protected after being backed up to another medium (tape, disk, SAN, etc.), consult with the System Administrator to determine the backup policy in place for the DNS Server.\n\nDetermine how and where backed up data is being stored. \n\nVerify the protection of the backup medium is secured to the same level, or higher, as the server itself.\n\nIf a backup policy does not exist or the backup policy does not specify the protection required for backup medium to be at or above the same level as the server, this is a finding.'\n  desc 'fix', 'To ensure the cryptographic keys are protected after being backed up to tape or other medium, develop a backup policy to include the protection of backup date to be at or above the same level as the DNS server itself.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59565r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58693'\n  tag rid: 'SV-83215r1_rule'\n  tag stig_id: 'WDNS-SC-000024'\n  tag gtitle: 'SRG-APP-000231-DNS-000033'\n  tag fix_id: 'F-64077r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001199']\n  tag nist: ['SC-28']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83215.rb"},"title":"The Windows 2008 DNS Server must protect secret/private cryptographic keys while at rest.","desc":"Information at rest refers to the state of information when it is located on a secondary storage device within an organizational information system. Mobile devices, laptops, desktops, and storage devices can be either lost or stolen, and the contents of their data storage (e.g., hard drives and non-volatile memory) can be read, copied, or altered. Applications and application users generate information throughout the course of their application use.\n\nThe DNS server must protect the confidentiality and integrity of shared keys (for TSIG) and private keys (for SIG(0)) and must protect the integrity of DNS information. There is no need to protect the confidentiality of DNS information because it is accessible by all devices that can contact the server.","descriptions":{"default":"Information at rest refers to the state of information when it is located on a secondary storage device within an organizational information system. Mobile devices, laptops, desktops, and storage devices can be either lost or stolen, and the contents of their data storage (e.g., hard drives and non-volatile memory) can be read, copied, or altered. Applications and application users generate information throughout the course of their application use.\n\nThe DNS server must protect the confidentiality and integrity of shared keys (for TSIG) and private keys (for SIG(0)) and must protect the integrity of DNS information. There is no need to protect the confidentiality of DNS information because it is accessible by all devices that can contact the server.","check":"To ensure the cryptographic keys are protected after being backed up to another medium (tape, disk, SAN, etc.), consult with the System Administrator to determine the backup policy in place for the DNS Server.\n\nDetermine how and where backed up data is being stored. \n\nVerify the protection of the backup medium is secured to the same level, or higher, as the server itself.\n\nIf a backup policy does not exist or the backup policy does not specify the protection required for backup medium to be at or above the same level as the server, this is a finding.","fix":"To ensure the cryptographic keys are protected after being backed up to tape or other medium, develop a backup policy to include the protection of backup date to be at or above the same level as the DNS server itself."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59565r3_chk","severity":"medium","gid":"V-58693","rid":"SV-83215r1_rule","stig_id":"WDNS-SC-000024","gtitle":"SRG-APP-000231-DNS-000033","fix_id":"F-64077r3_fix","documentable":null,"cci":["CCI-001199"],"nist":["SC-28"]}},{"id":"SV-83217","code":"control 'SV-83217' do\n  title 'The Windows 2008 DNS Server must restrict individuals from using it for launching Denial of Service (DoS) attacks against other information systems.'\n  desc 'Applications and application developers must take the steps needed to ensure users cannot use an authorized application to launch DoS attacks against other systems and networks. For example, applications may include mechanisms that throttle network traffic so users are not able to generate unlimited network traffic via the application. Limiting system resources that are allocated to any user to a bare minimum may also reduce the ability of users to launch some DoS attacks.'\n  desc 'check', 'Review the DNS server to confirm the server restricts direct and remote console access to users other than Administrators.\n\nVerify the effective setting in Local Group Policy Editor.\n\nRun \"gpedit.msc\".\n\nNavigate to Local Computer Policy >> Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment.\n\nIf any accounts or groups other than the following are granted the \"Allow log on through Remote Desktop Services\" user right, this is a finding: \n\nAdministrators\n\nNavigate to Local Computer Policy >> Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment.\n\nIf the following accounts or groups are not defined for the \"Deny access to this computer from the network\" user right, this is a finding: \n\nGuests Group\n\nNavigate to Local Computer Policy >> Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment.\n\nIf the following accounts or groups are not defined for the \"Deny log on locally\" user right, this is a finding: \n\nGuests Group'\n  desc 'fix', 'Configure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> \"Allow log on through Remote Desktop Services\" to only include the following accounts or groups:\n\nAdministrators\n\nConfigure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> \"Deny access to this computer from the network\" to include the following:\n\nGuests Group\n\nConfigure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> \"Deny log on locally\" to include the following:\n\nGuests Group'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59569r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58697'\n  tag rid: 'SV-83217r1_rule'\n  tag stig_id: 'WDNS-SC-000026'\n  tag gtitle: 'SRG-APP-000246-DNS-000035'\n  tag fix_id: 'F-64081r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001094']\n  tag nist: ['SC-5 (1)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83217.rb"},"title":"The Windows 2008 DNS Server must restrict individuals from using it for launching Denial of Service (DoS) attacks against other information systems.","desc":"Applications and application developers must take the steps needed to ensure users cannot use an authorized application to launch DoS attacks against other systems and networks. For example, applications may include mechanisms that throttle network traffic so users are not able to generate unlimited network traffic via the application. Limiting system resources that are allocated to any user to a bare minimum may also reduce the ability of users to launch some DoS attacks.","descriptions":{"default":"Applications and application developers must take the steps needed to ensure users cannot use an authorized application to launch DoS attacks against other systems and networks. For example, applications may include mechanisms that throttle network traffic so users are not able to generate unlimited network traffic via the application. Limiting system resources that are allocated to any user to a bare minimum may also reduce the ability of users to launch some DoS attacks.","check":"Review the DNS server to confirm the server restricts direct and remote console access to users other than Administrators.\n\nVerify the effective setting in Local Group Policy Editor.\n\nRun \"gpedit.msc\".\n\nNavigate to Local Computer Policy >> Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment.\n\nIf any accounts or groups other than the following are granted the \"Allow log on through Remote Desktop Services\" user right, this is a finding: \n\nAdministrators\n\nNavigate to Local Computer Policy >> Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment.\n\nIf the following accounts or groups are not defined for the \"Deny access to this computer from the network\" user right, this is a finding: \n\nGuests Group\n\nNavigate to Local Computer Policy >> Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment.\n\nIf the following accounts or groups are not defined for the \"Deny log on locally\" user right, this is a finding: \n\nGuests Group","fix":"Configure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> \"Allow log on through Remote Desktop Services\" to only include the following accounts or groups:\n\nAdministrators\n\nConfigure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> \"Deny access to this computer from the network\" to include the following:\n\nGuests Group\n\nConfigure the policy value for Computer Configuration >> Windows Settings >> Security Settings >> Local Policies >> User Rights Assignment >> \"Deny log on locally\" to include the following:\n\nGuests Group"},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59569r2_chk","severity":"medium","gid":"V-58697","rid":"SV-83217r1_rule","stig_id":"WDNS-SC-000026","gtitle":"SRG-APP-000246-DNS-000035","fix_id":"F-64081r2_fix","documentable":null,"cci":["CCI-001094"],"nist":["SC-5 (1)"]}},{"id":"SV-83219","code":"control 'SV-83219' do\n  title 'The Windows 2008 DNS Server must use DNS Notify to prevent denial of service through increase in workload.'\n  desc 'In the case of application DoS attacks, care must be taken when designing the application to ensure the application makes the best use of system resources. SQL queries have the potential to consume large amounts of CPU cycles if they are not tuned for optimal performance. Web services containing complex calculations requiring large amounts of time to complete can bog down if too many requests for the service are encountered within a short period of time.'\n  desc 'check', %q(Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nIn the list of hosts, review the Name Server (NS) records. Determine if any of the hosts listed as NS records are non-AD-integrated servers.\n\nIf the DNS server only hosts AD-integrated zones and there are not any non-AD-integrated DNS servers acting as secondary DNS servers for the zones, this check is not applicable.\n\nFor a non-AD-integrated DNS server, right click on the Forward Lookup zone and select “Properties”.\nOn the opened zone's properties box, go to the “Zone Transfers” tab.\n\nOn the displayed interface, verify if the \"Allow zone transfers\" check box is selected.\n\nIf the \"Allow zone transfers\" check box is selected, click on the “Notify” button and verify “Automatically notify with Servers” is listed on the “Name Servers” tab is selected.\n\nIf the “Notify” button is not enabled for non-AD-integrated DNS servers, this is a finding.)\n  desc 'fix', %q(Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nIn the list of hosts, review the Name Server (NS) records. Determine if any of the hosts listed as NS records are non-AD-integrated servers.\n\nIf the DNS server only hosts AD-integrated zones and there are not any non-AD-integrated DNS servers acting as secondary DNS servers for the zones, this check is Not Applicable.\n\nFor a non-AD-integrated DNS server, log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select and then right-click the zone name.\n\nFrom the displayed context menu, click the “Properties” option.\n\nOn the opened zone's properties box, go to the “Zone Transfers” tab.\n\nOn the displayed interface, verify if the \"Allow zone transfers\" check box is selected.\n\nIf the \"Allow zone transfers\" check box is selected, click on the “Notify” button and enable Notify to the non-AD-integrated DNS servers.)\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59571r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58699'\n  tag rid: 'SV-83219r1_rule'\n  tag stig_id: 'WDNS-SC-000027'\n  tag gtitle: 'SRG-APP-000247-DNS-000036'\n  tag fix_id: 'F-64083r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001095']\n  tag nist: ['SC-5 (2)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83219.rb"},"title":"The Windows 2008 DNS Server must use DNS Notify to prevent denial of service through increase in workload.","desc":"In the case of application DoS attacks, care must be taken when designing the application to ensure the application makes the best use of system resources. SQL queries have the potential to consume large amounts of CPU cycles if they are not tuned for optimal performance. Web services containing complex calculations requiring large amounts of time to complete can bog down if too many requests for the service are encountered within a short period of time.","descriptions":{"default":"In the case of application DoS attacks, care must be taken when designing the application to ensure the application makes the best use of system resources. SQL queries have the potential to consume large amounts of CPU cycles if they are not tuned for optimal performance. Web services containing complex calculations requiring large amounts of time to complete can bog down if too many requests for the service are encountered within a short period of time.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nIn the list of hosts, review the Name Server (NS) records. Determine if any of the hosts listed as NS records are non-AD-integrated servers.\n\nIf the DNS server only hosts AD-integrated zones and there are not any non-AD-integrated DNS servers acting as secondary DNS servers for the zones, this check is not applicable.\n\nFor a non-AD-integrated DNS server, right click on the Forward Lookup zone and select “Properties”.\nOn the opened zone's properties box, go to the “Zone Transfers” tab.\n\nOn the displayed interface, verify if the \"Allow zone transfers\" check box is selected.\n\nIf the \"Allow zone transfers\" check box is selected, click on the “Notify” button and verify “Automatically notify with Servers” is listed on the “Name Servers” tab is selected.\n\nIf the “Notify” button is not enabled for non-AD-integrated DNS servers, this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nIn the list of hosts, review the Name Server (NS) records. Determine if any of the hosts listed as NS records are non-AD-integrated servers.\n\nIf the DNS server only hosts AD-integrated zones and there are not any non-AD-integrated DNS servers acting as secondary DNS servers for the zones, this check is Not Applicable.\n\nFor a non-AD-integrated DNS server, log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select and then right-click the zone name.\n\nFrom the displayed context menu, click the “Properties” option.\n\nOn the opened zone's properties box, go to the “Zone Transfers” tab.\n\nOn the displayed interface, verify if the \"Allow zone transfers\" check box is selected.\n\nIf the \"Allow zone transfers\" check box is selected, click on the “Notify” button and enable Notify to the non-AD-integrated DNS servers."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59571r2_chk","severity":"medium","gid":"V-58699","rid":"SV-83219r1_rule","stig_id":"WDNS-SC-000027","gtitle":"SRG-APP-000247-DNS-000036","fix_id":"F-64083r3_fix","documentable":null,"cci":["CCI-001095"],"nist":["SC-5 (2)"]}},{"id":"SV-83221","code":"control 'SV-83221' do\n  title 'The Windows 2008 DNS Server must be configured to only allow zone information that reflects the environment for which it is authoritative, to include IP ranges and IP versions.'\n  desc 'DNS zone data for which a Windows 2008 DNS server is authoritative should represent the network for which it is responsible. If a Windows 2008 DNS server hosts zone records for other networks or environments, there is the possibility for the records to become invalid or stale or be redundant/conflicting with a DNS server truly authoritative for the other network environment.'\n  desc 'check', 'Consult with the System Administrator to determine the IP ranges for the environment.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nIf not automatically started, initialize the “Server Manager” window by clicking its icon from the bottom left corner of the screen.\n\nOnce the “Server Manager” window is initialized, from the left pane, click to select the DNS category.\n\nFrom the right pane, under the “SERVERS” section, right-click the DNS server.\n\nFrom the context menu that appears, click DNS Manager.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select and then right-click the zone name.\n\nReview the zone information and compare to the IP ranges for the environment.\n\nIf any zone information is for a different IP range or domain, this is a finding.'\n  desc 'fix', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nIf not automatically started, initialize the “Server Manager” window by clicking its icon from the bottom left corner of the screen.\n\nOnce the “Server Manager” window is initialized, from the left pane, click to select the DNS category.\n\nFrom the right pane, under the “SERVERS” section, right-click the DNS server.\n\nFrom the context menu that appears, click DNS Manager.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nRemove any zone information which is not part of the environment.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59581r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58707'\n  tag rid: 'SV-83221r1_rule'\n  tag stig_id: 'WDNS-SI-000001'\n  tag gtitle: 'SRG-APP-000251-DNS-000037'\n  tag fix_id: 'F-64091r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001310']\n  tag nist: ['SI-10']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83221.rb"},"title":"The Windows 2008 DNS Server must be configured to only allow zone information that reflects the environment for which it is authoritative, to include IP ranges and IP versions.","desc":"DNS zone data for which a Windows 2008 DNS server is authoritative should represent the network for which it is responsible. If a Windows 2008 DNS server hosts zone records for other networks or environments, there is the possibility for the records to become invalid or stale or be redundant/conflicting with a DNS server truly authoritative for the other network environment.","descriptions":{"default":"DNS zone data for which a Windows 2008 DNS server is authoritative should represent the network for which it is responsible. If a Windows 2008 DNS server hosts zone records for other networks or environments, there is the possibility for the records to become invalid or stale or be redundant/conflicting with a DNS server truly authoritative for the other network environment.","check":"Consult with the System Administrator to determine the IP ranges for the environment.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nIf not automatically started, initialize the “Server Manager” window by clicking its icon from the bottom left corner of the screen.\n\nOnce the “Server Manager” window is initialized, from the left pane, click to select the DNS category.\n\nFrom the right pane, under the “SERVERS” section, right-click the DNS server.\n\nFrom the context menu that appears, click DNS Manager.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select and then right-click the zone name.\n\nReview the zone information and compare to the IP ranges for the environment.\n\nIf any zone information is for a different IP range or domain, this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nIf not automatically started, initialize the “Server Manager” window by clicking its icon from the bottom left corner of the screen.\n\nOnce the “Server Manager” window is initialized, from the left pane, click to select the DNS category.\n\nFrom the right pane, under the “SERVERS” section, right-click the DNS server.\n\nFrom the context menu that appears, click DNS Manager.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name and then expand Forward Lookup Zones.\n\nRemove any zone information which is not part of the environment."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59581r3_chk","severity":"medium","gid":"V-58707","rid":"SV-83221r1_rule","stig_id":"WDNS-SI-000001","gtitle":"SRG-APP-000251-DNS-000037","fix_id":"F-64091r2_fix","documentable":null,"cci":["CCI-001310"],"nist":["SI-10"]}},{"id":"SV-83223","code":"control 'SV-83223' do\n  title 'The Windows 2008 DNS Server must, when a component failure is detected, activate a notification to the system administrator.'\n  desc 'Predictable failure prevention requires organizational planning to address system failure issues. If components key to maintaining systems security fail to function, the system could continue operating in an insecure state. The organization must be prepared, and the application must support requirements that specify if the application must alarm for such conditions and/or automatically shut down the application or the system.\n\nThis can include conducting a graceful application shutdown to avoid losing information. Automatic or manual transfer of components from standby to active mode can occur, for example, upon detection of component failures.'\n  desc 'check', 'Notification to system administrator is not configurable in Windows DNS Server. In order for system administrators to be notified when a component fails, the system administrator would need to implement a third-party monitoring system. At a minimum, the system administrator should have a documented procedure in place to review the diagnostic logs on a routine basis every day.\n\nIf a third-party monitoring system is not in place to detect and notify the system administrator upon component failures and the system administrator does not have a documented procedure in place to review the diagnostic logs on a routine basis every day, this is a finding.'\n  desc 'fix', 'Implement a third-party monitoring system to detect and notify the system administrator upon component failure or, at a minimum, document and implement a procedure to review the diagnostic logs on a routine basis every day.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59585r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58711'\n  tag rid: 'SV-83223r2_rule'\n  tag stig_id: 'WDNS-SI-000005'\n  tag gtitle: 'SRG-APP-000268-DNS-000039'\n  tag fix_id: 'F-64095r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-001328']\n  tag nist: ['CM-6 b', 'SI-13 (4) (b)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83223.rb"},"title":"The Windows 2008 DNS Server must, when a component failure is detected, activate a notification to the system administrator.","desc":"Predictable failure prevention requires organizational planning to address system failure issues. If components key to maintaining systems security fail to function, the system could continue operating in an insecure state. The organization must be prepared, and the application must support requirements that specify if the application must alarm for such conditions and/or automatically shut down the application or the system.\n\nThis can include conducting a graceful application shutdown to avoid losing information. Automatic or manual transfer of components from standby to active mode can occur, for example, upon detection of component failures.","descriptions":{"default":"Predictable failure prevention requires organizational planning to address system failure issues. If components key to maintaining systems security fail to function, the system could continue operating in an insecure state. The organization must be prepared, and the application must support requirements that specify if the application must alarm for such conditions and/or automatically shut down the application or the system.\n\nThis can include conducting a graceful application shutdown to avoid losing information. Automatic or manual transfer of components from standby to active mode can occur, for example, upon detection of component failures.","check":"Notification to system administrator is not configurable in Windows DNS Server. In order for system administrators to be notified when a component fails, the system administrator would need to implement a third-party monitoring system. At a minimum, the system administrator should have a documented procedure in place to review the diagnostic logs on a routine basis every day.\n\nIf a third-party monitoring system is not in place to detect and notify the system administrator upon component failures and the system administrator does not have a documented procedure in place to review the diagnostic logs on a routine basis every day, this is a finding.","fix":"Implement a third-party monitoring system to detect and notify the system administrator upon component failure or, at a minimum, document and implement a procedure to review the diagnostic logs on a routine basis every day."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59585r4_chk","severity":"medium","gid":"V-58711","rid":"SV-83223r2_rule","stig_id":"WDNS-SI-000005","gtitle":"SRG-APP-000268-DNS-000039","fix_id":"F-64095r3_fix","documentable":null,"cci":["CCI-000366","CCI-001328"],"nist":["CM-6 b","SI-13 (4) (b)"]}},{"id":"SV-83225","code":"control 'SV-83225' do\n  title 'The Windows 2008 DNS Server must be configured to notify the ISSO/ISSM/DNS administrator when functionality of Secure Updates has been removed or broken.'\n  desc 'Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters. If personnel are not notified of failed security verification tests, they will not be able to take corrective action and the unsecure condition(s) will remain. Notifications provided by information systems include messages to local computer consoles, and/or hardware indications, such as lights.\n\nThe DNS server should be configured to generate audit records whenever a self-test fails. The OS/NDM is responsible for generating notification messages related to this audit record.'\n  desc 'check', 'Note: This check is Not applicable for Windows 2012 DNS Servers that only host Active Directory integrated zones or for Windows 2012 DNS servers on a Classified network.\n\nNotification to system administrator is not configurable in Windows DNS Server. In order for ISSO/ISSM/DNS administrator to be notified if functionality of Secure Updates has been removed or broken, the ISSO/ISSM/DNS administrator would need to implement a third party monitoring system. At a minimum, the ISSO/ISSM/DNS administrator should have a documented procedure in place to review the diagnostic logs on a routine basis every day.\n\nIf a third party monitoring system is not in place to detect and notify the ISSO/ISSM/DNS administrator if functionality of Secure Updates has been removed or broken and the ISSO/ISSM/DNS administrator does not have a documented procedure in place to review the diagnostic logs on a routine basis every day, this is a finding.'\n  desc 'fix', 'Implement a third-party monitoring system to detect and notify the ISSO/ISSM/DNS administrator if functionality of Secure Updates has been removed or broken or, at a minimum, document and implement a procedure to review the diagnostic logs on a routine basis every day.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59591r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58717'\n  tag rid: 'SV-83225r1_rule'\n  tag stig_id: 'WDNS-SI-000008'\n  tag gtitle: 'SRG-APP-000275-DNS-000040'\n  tag fix_id: 'F-64101r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001294']\n  tag nist: ['SI-6 c']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83225.rb"},"title":"The Windows 2008 DNS Server must be configured to notify the ISSO/ISSM/DNS administrator when functionality of Secure Updates has been removed or broken.","desc":"Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters. If personnel are not notified of failed security verification tests, they will not be able to take corrective action and the unsecure condition(s) will remain. Notifications provided by information systems include messages to local computer consoles, and/or hardware indications, such as lights.\n\nThe DNS server should be configured to generate audit records whenever a self-test fails. The OS/NDM is responsible for generating notification messages related to this audit record.","descriptions":{"default":"Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters. If personnel are not notified of failed security verification tests, they will not be able to take corrective action and the unsecure condition(s) will remain. Notifications provided by information systems include messages to local computer consoles, and/or hardware indications, such as lights.\n\nThe DNS server should be configured to generate audit records whenever a self-test fails. The OS/NDM is responsible for generating notification messages related to this audit record.","check":"Note: This check is Not applicable for Windows 2012 DNS Servers that only host Active Directory integrated zones or for Windows 2012 DNS servers on a Classified network.\n\nNotification to system administrator is not configurable in Windows DNS Server. In order for ISSO/ISSM/DNS administrator to be notified if functionality of Secure Updates has been removed or broken, the ISSO/ISSM/DNS administrator would need to implement a third party monitoring system. At a minimum, the ISSO/ISSM/DNS administrator should have a documented procedure in place to review the diagnostic logs on a routine basis every day.\n\nIf a third party monitoring system is not in place to detect and notify the ISSO/ISSM/DNS administrator if functionality of Secure Updates has been removed or broken and the ISSO/ISSM/DNS administrator does not have a documented procedure in place to review the diagnostic logs on a routine basis every day, this is a finding.","fix":"Implement a third-party monitoring system to detect and notify the ISSO/ISSM/DNS administrator if functionality of Secure Updates has been removed or broken or, at a minimum, document and implement a procedure to review the diagnostic logs on a routine basis every day."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59591r4_chk","severity":"medium","gid":"V-58717","rid":"SV-83225r1_rule","stig_id":"WDNS-SI-000008","gtitle":"SRG-APP-000275-DNS-000040","fix_id":"F-64101r2_fix","documentable":null,"cci":["CCI-001294"],"nist":["SI-6 c"]}},{"id":"SV-83227","code":"control 'SV-83227' do\n  title 'The DNS Name Server software must be configured to refuse queries for its version information.'\n  desc 'Each newer version of the name server software, especially the BIND software, generally is devoid of vulnerabilities found in earlier versions because it has design changes incorporated to take care of those vulnerabilities. Of course, these vulnerabilities have been exploited (i.e., some form of attack was launched), and sufficient information has been generated with respect to the nature of those exploits. Thus, it makes good business sense to run the latest version of name server software because theoretically it is the safest version.\n\nIn some installations, it may not be possible to switch over to the latest version of name server software immediately. If the version of the name server software is revealed in queries, this information may be used by attackers who are looking for a specific version of the software which has a discovered weakness. To prevent information about which version of name server software is running on a system, name servers should be configured to refuse queries for its version information.'\n  desc 'check', 'The \"EnableVersionQuery\" property controls what version information the DNS server will respond with when a DNS query with class set to “CHAOS” and type set to “TXT” is received.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nOpen a command window and execute the command:\n\nnslookup <enter>\nNote: Confirm the Default Server is the DNS Server on which the command is being run.\n\nAt the nslookup prompt, type:\n\nset type=TXT <enter>\nset class=CHAOS <enter>\nversion.bind <enter>\n\nIf the response returns something similar to text = \"Microsoft DNS 6.1.7601 (1DB14556)\", this is a finding.'\n  desc 'fix', 'To disable the version being returned in queries, execute the following command:\n\ndnscmd /config /EnableVersionQuery 0 <enter>'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59609r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58737'\n  tag rid: 'SV-83227r1_rule'\n  tag stig_id: 'WDNS-SI-000003'\n  tag gtitle: 'SRG-APP-000333-DNS-000104'\n  tag fix_id: 'F-64121r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83227.rb"},"title":"The DNS Name Server software must be configured to refuse queries for its version information.","desc":"Each newer version of the name server software, especially the BIND software, generally is devoid of vulnerabilities found in earlier versions because it has design changes incorporated to take care of those vulnerabilities. Of course, these vulnerabilities have been exploited (i.e., some form of attack was launched), and sufficient information has been generated with respect to the nature of those exploits. Thus, it makes good business sense to run the latest version of name server software because theoretically it is the safest version.\n\nIn some installations, it may not be possible to switch over to the latest version of name server software immediately. If the version of the name server software is revealed in queries, this information may be used by attackers who are looking for a specific version of the software which has a discovered weakness. To prevent information about which version of name server software is running on a system, name servers should be configured to refuse queries for its version information.","descriptions":{"default":"Each newer version of the name server software, especially the BIND software, generally is devoid of vulnerabilities found in earlier versions because it has design changes incorporated to take care of those vulnerabilities. Of course, these vulnerabilities have been exploited (i.e., some form of attack was launched), and sufficient information has been generated with respect to the nature of those exploits. Thus, it makes good business sense to run the latest version of name server software because theoretically it is the safest version.\n\nIn some installations, it may not be possible to switch over to the latest version of name server software immediately. If the version of the name server software is revealed in queries, this information may be used by attackers who are looking for a specific version of the software which has a discovered weakness. To prevent information about which version of name server software is running on a system, name servers should be configured to refuse queries for its version information.","check":"The \"EnableVersionQuery\" property controls what version information the DNS server will respond with when a DNS query with class set to “CHAOS” and type set to “TXT” is received.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nOpen a command window and execute the command:\n\nnslookup <enter>\nNote: Confirm the Default Server is the DNS Server on which the command is being run.\n\nAt the nslookup prompt, type:\n\nset type=TXT <enter>\nset class=CHAOS <enter>\nversion.bind <enter>\n\nIf the response returns something similar to text = \"Microsoft DNS 6.1.7601 (1DB14556)\", this is a finding.","fix":"To disable the version being returned in queries, execute the following command:\n\ndnscmd /config /EnableVersionQuery 0 <enter>"},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59609r2_chk","severity":"medium","gid":"V-58737","rid":"SV-83227r1_rule","stig_id":"WDNS-SI-000003","gtitle":"SRG-APP-000333-DNS-000104","fix_id":"F-64121r2_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-83229","code":"control 'SV-83229' do\n  title 'The HINFO, RP, TXT, and LOC RR types must not be used in the zone SOA.'\n  desc \"There are several types of RRs in the DNS that are meant to convey information to humans and applications about the network, hosts, or services. These RRs include the Responsible Person (RP) record, the Host Information (HINFO) record, the Location (LOC) record, and the catch-all text string resource record (TXT) [RFC1035]. Although these record types are meant to provide information to users in good faith, they also allow attackers to gain knowledge about network hosts before attempting to exploit them. For example, an attacker may query for HINFO records, looking for hosts that list an OS or platform known to have exploits.\n\nTherefore, great care should be taken before including these record types in a zone. In fact, they are best left out altogether.\n\nMore careful consideration should be taken with the TXT resource record type. A DNS administrator will have to decide if the data contained in a TXT RR constitutes an information leak or is a necessary piece of information. For example, several authenticated email technologies use TXT RR's to store email sender policy information such as valid email senders for a domain. These judgments will have to be made on a case-by-case basis.\n\nA DNS administrator should take care when including HINFO, RP, TXT, LOC, or other RR types that could divulge information that would be useful to an attacker or the external view of a zone if using split DNS.\n\nRRs such as HINFO and TXT provide information about software name and versions (e.g., for resources such as Web servers and mail servers) that will enable the well-equipped attacker to exploit the known vulnerabilities in those software versions and launch attacks against those resources.\"\n  desc 'check', \"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nReview the zone's Resource Records (RR) and verify HINFO, RP, and LOC RRs are not used. If TXT RRs are used, they must not reveal any information about the organization which could be used for malicious purposes.\n\nIf there are any HINFO, RP, LOC, or revealing TXT RRs in any zone hosted by the DNS Server, this is a finding.\"\n  desc 'fix', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nRemove all HINFO, RP, TXT, and LOC RRs from all zones hosted by the DNS Server.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59611r6_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58739'\n  tag rid: 'SV-83229r1_rule'\n  tag stig_id: 'WDNS-SI-000004'\n  tag gtitle: 'SRG-APP-000333-DNS-000107'\n  tag fix_id: 'F-64123r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83229.rb"},"title":"The HINFO, RP, TXT, and LOC RR types must not be used in the zone SOA.","desc":"There are several types of RRs in the DNS that are meant to convey information to humans and applications about the network, hosts, or services. These RRs include the Responsible Person (RP) record, the Host Information (HINFO) record, the Location (LOC) record, and the catch-all text string resource record (TXT) [RFC1035]. Although these record types are meant to provide information to users in good faith, they also allow attackers to gain knowledge about network hosts before attempting to exploit them. For example, an attacker may query for HINFO records, looking for hosts that list an OS or platform known to have exploits.\n\nTherefore, great care should be taken before including these record types in a zone. In fact, they are best left out altogether.\n\nMore careful consideration should be taken with the TXT resource record type. A DNS administrator will have to decide if the data contained in a TXT RR constitutes an information leak or is a necessary piece of information. For example, several authenticated email technologies use TXT RR's to store email sender policy information such as valid email senders for a domain. These judgments will have to be made on a case-by-case basis.\n\nA DNS administrator should take care when including HINFO, RP, TXT, LOC, or other RR types that could divulge information that would be useful to an attacker or the external view of a zone if using split DNS.\n\nRRs such as HINFO and TXT provide information about software name and versions (e.g., for resources such as Web servers and mail servers) that will enable the well-equipped attacker to exploit the known vulnerabilities in those software versions and launch attacks against those resources.","descriptions":{"default":"There are several types of RRs in the DNS that are meant to convey information to humans and applications about the network, hosts, or services. These RRs include the Responsible Person (RP) record, the Host Information (HINFO) record, the Location (LOC) record, and the catch-all text string resource record (TXT) [RFC1035]. Although these record types are meant to provide information to users in good faith, they also allow attackers to gain knowledge about network hosts before attempting to exploit them. For example, an attacker may query for HINFO records, looking for hosts that list an OS or platform known to have exploits.\n\nTherefore, great care should be taken before including these record types in a zone. In fact, they are best left out altogether.\n\nMore careful consideration should be taken with the TXT resource record type. A DNS administrator will have to decide if the data contained in a TXT RR constitutes an information leak or is a necessary piece of information. For example, several authenticated email technologies use TXT RR's to store email sender policy information such as valid email senders for a domain. These judgments will have to be made on a case-by-case basis.\n\nA DNS administrator should take care when including HINFO, RP, TXT, LOC, or other RR types that could divulge information that would be useful to an attacker or the external view of a zone if using split DNS.\n\nRRs such as HINFO and TXT provide information about software name and versions (e.g., for resources such as Web servers and mail servers) that will enable the well-equipped attacker to exploit the known vulnerabilities in those software versions and launch attacks against those resources.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nReview the zone's Resource Records (RR) and verify HINFO, RP, and LOC RRs are not used. If TXT RRs are used, they must not reveal any information about the organization which could be used for malicious purposes.\n\nIf there are any HINFO, RP, LOC, or revealing TXT RRs in any zone hosted by the DNS Server, this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nRemove all HINFO, RP, TXT, and LOC RRs from all zones hosted by the DNS Server."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59611r6_chk","severity":"medium","gid":"V-58739","rid":"SV-83229r1_rule","stig_id":"WDNS-SI-000004","gtitle":"SRG-APP-000333-DNS-000107","fix_id":"F-64123r2_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-83231","code":"control 'SV-83231' do\n  title 'The Windows 2008 DNS Server must be configured to record, and make available to authorized personnel, who added/modified/deleted DNS zone information.'\n  desc 'Without a means for identifying the individual that produced the information, the information cannot be relied upon. Identifying the validity of information may be delayed or deterred.\n\nThis requirement ensures organizational personnel have a means to identify who produced or changed specific information in transfers, zone information, or DNS configuration changes.'\n  desc 'check', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nRight-click the DNS server, select “Properties”.\n\nClick on the “Event Logging” tab. By default, all events are logged.\n\nVerify \"Errors and warnings\" or \"All events\" is selected.\n\nIf any option other than \"Errors and warnings\" or \"All events\" is selected, this is a finding.'\n  desc 'fix', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nIf not automatically started, initialize the “Server Manager” window by clicking its icon from the bottom left corner of the screen.\n\nOn the opened “Server Manager” window, from the left pane, click to select “DNS”.\n\nFrom the right pane, under the “SERVERS” section, right-click the DNS server.\n\nFrom the displayed context menu, click the “DNS Manager” option.\n\nClick on the “Event Logging” tab.\n\nSelect the \"Errors and warnings\" or \"All events\" option.\n\nClick on “Apply”.\n\nClick on “OK”.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59415r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58543'\n  tag rid: 'SV-83231r1_rule'\n  tag stig_id: 'WDNS-AU-000001'\n  tag gtitle: 'SRG-APP-000348-DNS-000042'\n  tag fix_id: 'F-63927r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-001902']\n  tag nist: ['CM-6 b', 'AU-10 (1) (b)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83231.rb"},"title":"The Windows 2008 DNS Server must be configured to record, and make available to authorized personnel, who added/modified/deleted DNS zone information.","desc":"Without a means for identifying the individual that produced the information, the information cannot be relied upon. Identifying the validity of information may be delayed or deterred.\n\nThis requirement ensures organizational personnel have a means to identify who produced or changed specific information in transfers, zone information, or DNS configuration changes.","descriptions":{"default":"Without a means for identifying the individual that produced the information, the information cannot be relied upon. Identifying the validity of information may be delayed or deterred.\n\nThis requirement ensures organizational personnel have a means to identify who produced or changed specific information in transfers, zone information, or DNS configuration changes.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nRight-click the DNS server, select “Properties”.\n\nClick on the “Event Logging” tab. By default, all events are logged.\n\nVerify \"Errors and warnings\" or \"All events\" is selected.\n\nIf any option other than \"Errors and warnings\" or \"All events\" is selected, this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nIf not automatically started, initialize the “Server Manager” window by clicking its icon from the bottom left corner of the screen.\n\nOn the opened “Server Manager” window, from the left pane, click to select “DNS”.\n\nFrom the right pane, under the “SERVERS” section, right-click the DNS server.\n\nFrom the displayed context menu, click the “DNS Manager” option.\n\nClick on the “Event Logging” tab.\n\nSelect the \"Errors and warnings\" or \"All events\" option.\n\nClick on “Apply”.\n\nClick on “OK”."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59415r3_chk","severity":"medium","gid":"V-58543","rid":"SV-83231r1_rule","stig_id":"WDNS-AU-000001","gtitle":"SRG-APP-000348-DNS-000042","fix_id":"F-63927r2_fix","documentable":null,"cci":["CCI-000366","CCI-001902"],"nist":["CM-6 b","AU-10 (1) (b)"]}},{"id":"SV-83233","code":"control 'SV-83233' do\n  title 'The Windows 2008 DNS Server must, in the event of an error validating another DNS servers identity, send notification to the DNS administrator.'\n  desc \"Failing to act on the validation errors may result in the use of invalid, corrupted, or compromised information. The validation of bindings can be achieved, for example, by the use of cryptographic checksums. Validations must be performed automatically.\n\nAt a minimum, the application must log the validation error. However, more stringent actions can be taken based on the security posture and value of the information. The organization should consider the system's environment and impact of the errors when defining the actions. Additional examples of actions include automated notification to administrators, halting system process, or halting the specific operation.\n\nThe auditing is performed by the OS/NDM, but the configuration to trigger the auditing is controlled by the DNS server.\"\n  desc 'check', 'Windows 2012 DNS servers, hosting Active Directory integrated zones, transfer zone information via AD replication. Windows 2012 DNS servers hosting non-AD-integrated zones as a secondary name server and/or are not hosting AD-integrated zones use zone transfer to sync zone data.\n\nIf the Windows 2012 DNS server only hosts AD-integrated zones and all other name servers for the zones hosted are Active Directory Domain Controllers, this requirement is not applicable.\n\nIf the Windows 2012 DNS server is not an Active Directory Domain Controller, or is a secondary name server for a zone with a non-AD-integrated name server as the master, this requirement is applicable.\n\nAdministrator notification is only possible if a third-party event monitoring system is configured or, at a minimum, there are documented procedures requiring the administrator to review the DNS logs on a routine, daily basis.\n\nIf a third-party event monitoring system is not configured, or a document procedure is not in place requiring the administrator to review the DNS logs on a routine, daily basis, this is a finding.'\n  desc 'fix', 'To detect and notify the administrator, configure a third-party event monitoring system or, at a minimum, document and implement a procedure to require the administrator to check the DNS logs on a routine, daily basis.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59419r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58547'\n  tag rid: 'SV-83233r2_rule'\n  tag stig_id: 'WDNS-AU-000003'\n  tag gtitle: 'SRG-APP-000350-DNS-000044'\n  tag fix_id: 'F-63931r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-001906']\n  tag nist: ['CM-6 b', 'AU-10 (2) (b)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83233.rb"},"title":"The Windows 2008 DNS Server must, in the event of an error validating another DNS servers identity, send notification to the DNS administrator.","desc":"Failing to act on the validation errors may result in the use of invalid, corrupted, or compromised information. The validation of bindings can be achieved, for example, by the use of cryptographic checksums. Validations must be performed automatically.\n\nAt a minimum, the application must log the validation error. However, more stringent actions can be taken based on the security posture and value of the information. The organization should consider the system's environment and impact of the errors when defining the actions. Additional examples of actions include automated notification to administrators, halting system process, or halting the specific operation.\n\nThe auditing is performed by the OS/NDM, but the configuration to trigger the auditing is controlled by the DNS server.","descriptions":{"default":"Failing to act on the validation errors may result in the use of invalid, corrupted, or compromised information. The validation of bindings can be achieved, for example, by the use of cryptographic checksums. Validations must be performed automatically.\n\nAt a minimum, the application must log the validation error. However, more stringent actions can be taken based on the security posture and value of the information. The organization should consider the system's environment and impact of the errors when defining the actions. Additional examples of actions include automated notification to administrators, halting system process, or halting the specific operation.\n\nThe auditing is performed by the OS/NDM, but the configuration to trigger the auditing is controlled by the DNS server.","check":"Windows 2012 DNS servers, hosting Active Directory integrated zones, transfer zone information via AD replication. Windows 2012 DNS servers hosting non-AD-integrated zones as a secondary name server and/or are not hosting AD-integrated zones use zone transfer to sync zone data.\n\nIf the Windows 2012 DNS server only hosts AD-integrated zones and all other name servers for the zones hosted are Active Directory Domain Controllers, this requirement is not applicable.\n\nIf the Windows 2012 DNS server is not an Active Directory Domain Controller, or is a secondary name server for a zone with a non-AD-integrated name server as the master, this requirement is applicable.\n\nAdministrator notification is only possible if a third-party event monitoring system is configured or, at a minimum, there are documented procedures requiring the administrator to review the DNS logs on a routine, daily basis.\n\nIf a third-party event monitoring system is not configured, or a document procedure is not in place requiring the administrator to review the DNS logs on a routine, daily basis, this is a finding.","fix":"To detect and notify the administrator, configure a third-party event monitoring system or, at a minimum, document and implement a procedure to require the administrator to check the DNS logs on a routine, daily basis."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59419r4_chk","severity":"medium","gid":"V-58547","rid":"SV-83233r2_rule","stig_id":"WDNS-AU-000003","gtitle":"SRG-APP-000350-DNS-000044","fix_id":"F-63931r2_fix","documentable":null,"cci":["CCI-000366","CCI-001906"],"nist":["CM-6 b","AU-10 (2) (b)"]}},{"id":"SV-83235","code":"control 'SV-83235' do\n  title 'The Windows 2008 DNS Server must prohibit recursion on authoritative name servers for which forwarders have not been configured for external queries.'\n  desc \"A potential vulnerability of DNS is that an attacker can poison a name server's cache by sending queries that will cause the server to obtain host-to-IP address mappings from bogus name servers that respond with incorrect information. Once a name server has been poisoned, legitimate clients may be directed to non-existent hosts (which constitutes a denial of service), or, worse, hosts that masquerade as legitimate ones to obtain sensitive data or passwords. \n\nTo guard against poisoning, name servers authoritative for .mil domains should be separated functionally from name servers that resolve queries on behalf of internal clients. Organizations may achieve this separation by dedicating machines to each function or, if possible, by running two instances of the name server software on the same machine: one for the authoritative function and the other for the resolving function. In this design, each name server process may be bound to a different IP address or network interface to implement the required segregation.\"\n  desc 'check', 'Note: If the Windows DNS server is in the classified network, this check is Not Applicable.\n\nNote: In Windows DNS Server, if forwarders are configured, the recursion setting must also be enabled since disabling recursion will disable forwarders.\n\nIf forwarders are not used, recursion must be disabled.\n\nIn both cases, the use of root hints must be disabled. The root hints configuration requirement is addressed in WDNS-CM-000004.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, right-click on the server name for the DNS server and select “Properties”.\n\nClick on the “Forwarders” tab.\n\nIf forwarders are enabled and configured, this check is not applicable.\n\nIf forwarders are not enabled, click on the “Advanced” tab and ensure the \"Disable recursion (also disables forwarders)\" check box is selected.\n\nIf forwarders are not enabled and configured, and the \"Disable recursion (also disables forwarders)\" check box in the “Advanced” tab is not selected, this is a finding.'\n  desc 'fix', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, right-click on the server name for the DNS server and select “Properties”.\n\nClick on the “Forwarders” tab.\n\nIf forwarders are not being used, click the “Advanced” tab. \n\nSelect the \"Disable recursion (also disables forwarders)\" check box.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59451r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58579'\n  tag rid: 'SV-83235r1_rule'\n  tag stig_id: 'WDNS-CM-000003'\n  tag gtitle: 'SRG-APP-000383-DNS-000047'\n  tag fix_id: 'F-63963r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83235.rb"},"title":"The Windows 2008 DNS Server must prohibit recursion on authoritative name servers for which forwarders have not been configured for external queries.","desc":"A potential vulnerability of DNS is that an attacker can poison a name server's cache by sending queries that will cause the server to obtain host-to-IP address mappings from bogus name servers that respond with incorrect information. Once a name server has been poisoned, legitimate clients may be directed to non-existent hosts (which constitutes a denial of service), or, worse, hosts that masquerade as legitimate ones to obtain sensitive data or passwords. \n\nTo guard against poisoning, name servers authoritative for .mil domains should be separated functionally from name servers that resolve queries on behalf of internal clients. Organizations may achieve this separation by dedicating machines to each function or, if possible, by running two instances of the name server software on the same machine: one for the authoritative function and the other for the resolving function. In this design, each name server process may be bound to a different IP address or network interface to implement the required segregation.","descriptions":{"default":"A potential vulnerability of DNS is that an attacker can poison a name server's cache by sending queries that will cause the server to obtain host-to-IP address mappings from bogus name servers that respond with incorrect information. Once a name server has been poisoned, legitimate clients may be directed to non-existent hosts (which constitutes a denial of service), or, worse, hosts that masquerade as legitimate ones to obtain sensitive data or passwords. \n\nTo guard against poisoning, name servers authoritative for .mil domains should be separated functionally from name servers that resolve queries on behalf of internal clients. Organizations may achieve this separation by dedicating machines to each function or, if possible, by running two instances of the name server software on the same machine: one for the authoritative function and the other for the resolving function. In this design, each name server process may be bound to a different IP address or network interface to implement the required segregation.","check":"Note: If the Windows DNS server is in the classified network, this check is Not Applicable.\n\nNote: In Windows DNS Server, if forwarders are configured, the recursion setting must also be enabled since disabling recursion will disable forwarders.\n\nIf forwarders are not used, recursion must be disabled.\n\nIn both cases, the use of root hints must be disabled. The root hints configuration requirement is addressed in WDNS-CM-000004.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, right-click on the server name for the DNS server and select “Properties”.\n\nClick on the “Forwarders” tab.\n\nIf forwarders are enabled and configured, this check is not applicable.\n\nIf forwarders are not enabled, click on the “Advanced” tab and ensure the \"Disable recursion (also disables forwarders)\" check box is selected.\n\nIf forwarders are not enabled and configured, and the \"Disable recursion (also disables forwarders)\" check box in the “Advanced” tab is not selected, this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, right-click on the server name for the DNS server and select “Properties”.\n\nClick on the “Forwarders” tab.\n\nIf forwarders are not being used, click the “Advanced” tab. \n\nSelect the \"Disable recursion (also disables forwarders)\" check box."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59451r5_chk","severity":"medium","gid":"V-58579","rid":"SV-83235r1_rule","stig_id":"WDNS-CM-000003","gtitle":"SRG-APP-000383-DNS-000047","fix_id":"F-63963r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83237","code":"control 'SV-83237' do\n  title 'Forwarders on an authoritative Windows 2008 DNS Server, if enabled for external resolution, must only forward to either an internal, non-AD-integrated DNS server or to the DoD Enterprise Recursive Services (ERS).'\n  desc \"A potential vulnerability of DNS is that an attacker can poison a name server's cache by sending queries that will cause the server to obtain host-to-IP address mappings from bogus name servers that respond with incorrect information. Once a name server has been poisoned, legitimate clients may be directed to non-existent hosts (which constitutes a denial of service), or, worse, hosts that masquerade as legitimate ones to obtain sensitive data or passwords. \n\nTo guard against poisoning, name servers authoritative for .mil domains should be separated functionally from name servers that resolve queries on behalf of internal clients. Organizations may achieve this separation by dedicating machines to each function or, if possible, by running two instances of the name server software on the same machine: one for the authoritative function and the other for the resolving function. In this design, each name server process may be bound to a different IP address or network interface to implement the required segregation.\"\n  desc 'check', 'Note: If the Windows DNS server is in the classified network, this check is Not Applicable.\n\nNote: In Windows DNS Server, if forwarders are configured, the recursion setting must also be enabled since disabling recursion will disable forwarders.\n\nIf forwarders are not used, recursion must be disabled. In both cases, the use of root hints must be disabled.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, right-click on the server name for the DNS server and select “Properties”.\n\nClick on the “Forwarders” tab.\n\nIf forwarders are not being used, this is not applicable.\n\nReview the IP address(es) for the forwarder(s) use.\n\nIf the DNS Server does not forward to another DoD-managed DNS server or to the DoD Enterprise Recursive Services (ERS), this is a finding.\n\nIf the \"Use root hints if no forwarders are available\" is selected, this is a finding.'\n  desc 'fix', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, right-click on the server name for the DNS server and select “Properties”.\n\nClick on the “Forwarders” tab.\n\nReplace the forwarders being used with another DoD-managed DNS server or the DoD Enterprise Recursive Services (ERS).\n\nDeselect the \"Use root hints if no forwarders are available\".'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59453r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58581'\n  tag rid: 'SV-83237r1_rule'\n  tag stig_id: 'WDNS-CM-000004'\n  tag gtitle: 'SRG-APP-000383-DNS-000047'\n  tag fix_id: 'F-63965r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83237.rb"},"title":"Forwarders on an authoritative Windows 2008 DNS Server, if enabled for external resolution, must only forward to either an internal, non-AD-integrated DNS server or to the DoD Enterprise Recursive Services (ERS).","desc":"A potential vulnerability of DNS is that an attacker can poison a name server's cache by sending queries that will cause the server to obtain host-to-IP address mappings from bogus name servers that respond with incorrect information. Once a name server has been poisoned, legitimate clients may be directed to non-existent hosts (which constitutes a denial of service), or, worse, hosts that masquerade as legitimate ones to obtain sensitive data or passwords. \n\nTo guard against poisoning, name servers authoritative for .mil domains should be separated functionally from name servers that resolve queries on behalf of internal clients. Organizations may achieve this separation by dedicating machines to each function or, if possible, by running two instances of the name server software on the same machine: one for the authoritative function and the other for the resolving function. In this design, each name server process may be bound to a different IP address or network interface to implement the required segregation.","descriptions":{"default":"A potential vulnerability of DNS is that an attacker can poison a name server's cache by sending queries that will cause the server to obtain host-to-IP address mappings from bogus name servers that respond with incorrect information. Once a name server has been poisoned, legitimate clients may be directed to non-existent hosts (which constitutes a denial of service), or, worse, hosts that masquerade as legitimate ones to obtain sensitive data or passwords. \n\nTo guard against poisoning, name servers authoritative for .mil domains should be separated functionally from name servers that resolve queries on behalf of internal clients. Organizations may achieve this separation by dedicating machines to each function or, if possible, by running two instances of the name server software on the same machine: one for the authoritative function and the other for the resolving function. In this design, each name server process may be bound to a different IP address or network interface to implement the required segregation.","check":"Note: If the Windows DNS server is in the classified network, this check is Not Applicable.\n\nNote: In Windows DNS Server, if forwarders are configured, the recursion setting must also be enabled since disabling recursion will disable forwarders.\n\nIf forwarders are not used, recursion must be disabled. In both cases, the use of root hints must be disabled.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, right-click on the server name for the DNS server and select “Properties”.\n\nClick on the “Forwarders” tab.\n\nIf forwarders are not being used, this is not applicable.\n\nReview the IP address(es) for the forwarder(s) use.\n\nIf the DNS Server does not forward to another DoD-managed DNS server or to the DoD Enterprise Recursive Services (ERS), this is a finding.\n\nIf the \"Use root hints if no forwarders are available\" is selected, this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, right-click on the server name for the DNS server and select “Properties”.\n\nClick on the “Forwarders” tab.\n\nReplace the forwarders being used with another DoD-managed DNS server or the DoD Enterprise Recursive Services (ERS).\n\nDeselect the \"Use root hints if no forwarders are available\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59453r4_chk","severity":"medium","gid":"V-58581","rid":"SV-83237r1_rule","stig_id":"WDNS-CM-000004","gtitle":"SRG-APP-000383-DNS-000047","fix_id":"F-63965r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83239","code":"control 'SV-83239' do\n  title 'The Windows 2008 DNS Server with a caching name server role must restrict recursive query responses to only the IP addresses and IP address ranges of known supported clients.'\n  desc \"A potential vulnerability of DNS is that an attacker can poison a name server's cache by sending queries that will cause the server to obtain host-to-IP address mappings from bogus name servers that respond with incorrect information. Once a name server has been poisoned, legitimate clients may be directed to non-existent hosts (which constitutes a denial of service), or, worse, hosts that masquerade as legitimate ones to obtain sensitive data or passwords.\n\nTo guard against poisoning, name servers specifically fulfilling the role of providing recursive query responses for external zones need to be segregated from name servers authoritative for internal zones.\"\n  desc 'check', 'Note: If Windows DNS server is not serving in a caching role, this check is Not Applicable.\nVerify the Windows DNS Server will only accept TCP and UDP port 53 traffic from specific IP addresses/ranges.\n\nThis can be configured via a local or network firewall.\n\nIf the caching name server is not restricted to answering queries from only specific networks, this is a finding.'\n  desc 'fix', 'Configure a local or network firewall to only allow specific IP addresses/ranges to send inbound TCP and UDP port 53 traffic to a DNS caching server.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59455r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58583'\n  tag rid: 'SV-83239r2_rule'\n  tag stig_id: 'WDNS-CM-000005'\n  tag gtitle: 'SRG-APP-000383-DNS-000047'\n  tag fix_id: 'F-63967r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83239.rb"},"title":"The Windows 2008 DNS Server with a caching name server role must restrict recursive query responses to only the IP addresses and IP address ranges of known supported clients.","desc":"A potential vulnerability of DNS is that an attacker can poison a name server's cache by sending queries that will cause the server to obtain host-to-IP address mappings from bogus name servers that respond with incorrect information. Once a name server has been poisoned, legitimate clients may be directed to non-existent hosts (which constitutes a denial of service), or, worse, hosts that masquerade as legitimate ones to obtain sensitive data or passwords.\n\nTo guard against poisoning, name servers specifically fulfilling the role of providing recursive query responses for external zones need to be segregated from name servers authoritative for internal zones.","descriptions":{"default":"A potential vulnerability of DNS is that an attacker can poison a name server's cache by sending queries that will cause the server to obtain host-to-IP address mappings from bogus name servers that respond with incorrect information. Once a name server has been poisoned, legitimate clients may be directed to non-existent hosts (which constitutes a denial of service), or, worse, hosts that masquerade as legitimate ones to obtain sensitive data or passwords.\n\nTo guard against poisoning, name servers specifically fulfilling the role of providing recursive query responses for external zones need to be segregated from name servers authoritative for internal zones.","check":"Note: If Windows DNS server is not serving in a caching role, this check is Not Applicable.\nVerify the Windows DNS Server will only accept TCP and UDP port 53 traffic from specific IP addresses/ranges.\n\nThis can be configured via a local or network firewall.\n\nIf the caching name server is not restricted to answering queries from only specific networks, this is a finding.","fix":"Configure a local or network firewall to only allow specific IP addresses/ranges to send inbound TCP and UDP port 53 traffic to a DNS caching server."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59455r5_chk","severity":"medium","gid":"V-58583","rid":"SV-83239r2_rule","stig_id":"WDNS-CM-000005","gtitle":"SRG-APP-000383-DNS-000047","fix_id":"F-63967r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83241","code":"control 'SV-83241' do\n  title 'The Windows 2008 DNS Server must implement a local cache of revocation data for PKI authentication in the event revocation information via the network is not accessible.'\n  desc 'Without configuring a local cache of revocation data, there is the potential to allow access to users who are no longer authorized (users with revoked certificates).\n\nSIG(0) is used for server-to-server authentication for DNS transactions, and it uses PKI-based authentication. So, in cases where SIG(0) is being used instead of TSIG (which uses a shared key, not PKI-based authentication), this requirement is applicable.'\n  desc 'check', 'Consult with the SA to determine if there is a third-party CRL server being used for certificate revocation lookup.\n\nIf there is, verify if a documented procedure is in place to store a copy of the CRL locally (local to the site, as an alternative to querying the actual Certificate Authorities). An example would be an OCSP responder installed at the local site.\n\nIf there is no local cache of revocation data, this is a finding.'\n  desc 'fix', 'Configure local revocation data to be used in the event access to Certificate Authorities is hindered.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59521r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58649'\n  tag rid: 'SV-83241r1_rule'\n  tag stig_id: 'WDNS-IA-000011'\n  tag gtitle: 'SRG-APP-000401-DNS-000051'\n  tag fix_id: 'F-64033r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001991']\n  tag nist: ['IA-5 (2) (d)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83241.rb"},"title":"The Windows 2008 DNS Server must implement a local cache of revocation data for PKI authentication in the event revocation information via the network is not accessible.","desc":"Without configuring a local cache of revocation data, there is the potential to allow access to users who are no longer authorized (users with revoked certificates).\n\nSIG(0) is used for server-to-server authentication for DNS transactions, and it uses PKI-based authentication. So, in cases where SIG(0) is being used instead of TSIG (which uses a shared key, not PKI-based authentication), this requirement is applicable.","descriptions":{"default":"Without configuring a local cache of revocation data, there is the potential to allow access to users who are no longer authorized (users with revoked certificates).\n\nSIG(0) is used for server-to-server authentication for DNS transactions, and it uses PKI-based authentication. So, in cases where SIG(0) is being used instead of TSIG (which uses a shared key, not PKI-based authentication), this requirement is applicable.","check":"Consult with the SA to determine if there is a third-party CRL server being used for certificate revocation lookup.\n\nIf there is, verify if a documented procedure is in place to store a copy of the CRL locally (local to the site, as an alternative to querying the actual Certificate Authorities). An example would be an OCSP responder installed at the local site.\n\nIf there is no local cache of revocation data, this is a finding.","fix":"Configure local revocation data to be used in the event access to Certificate Authorities is hindered."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59521r2_chk","severity":"medium","gid":"V-58649","rid":"SV-83241r1_rule","stig_id":"WDNS-IA-000011","gtitle":"SRG-APP-000401-DNS-000051","fix_id":"F-64033r3_fix","documentable":null,"cci":["CCI-001991"],"nist":["IA-5 (2) (d)"]}},{"id":"SV-83243","code":"control 'SV-83243' do\n  title 'The Windows 2008 DNS Servers IP address must be statically defined and configured locally on the server.'\n  desc 'The major threat associated with DNS forged responses or failures are the integrity of the DNS data returned in the response.  By requiring remote clients to obtain origin authentication and integrity verification assurances for the host/service name to network address resolution information obtained through the service, data origin is validated. \n\nEnsuring all name servers have static IP addresses makes it possible to configure restricted DNS communication between the name servers.'\n  desc 'check', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nLocate the “Network Internet Access” icon, right-click on it and select \"Open Network & Sharing Center\".\n\nClick on \"Change adapter settings\".\n\nRight-click on the Ethernet and click “Properties”.\n\nSelect Internet Protocol Version 4 (TCP/IPv4) and click “Properties”.\n\nVerify the “Use the following IP address” is selected, with an IP address, subnet mask, and default gateway assigned.\n\nIf the “Use the following IP address” is not selected with a configured IP address, subnet mask, and default gateway, this is a finding.'\n  desc 'fix', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nLocate the “Network Internet Access” icon, right-click on it and select \"Open Network & Sharing Center\".\n\nClick on \"Change adapter settings\".\n\nRight-click on the Ethernet and click “Properties”.\n\nSelect Internet Protocol Version 4 (TCP/IPv4) and click “Properties”.\n\nSelect the “Use the following IP address” and populate with an IP address, subnet mask, and default gateway.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59527r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58655'\n  tag rid: 'SV-83243r2_rule'\n  tag stig_id: 'WDNS-SC-000003'\n  tag gtitle: 'SRG-APP-000420-DNS-000053'\n  tag fix_id: 'F-64039r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-002463']\n  tag nist: ['CM-6 b', 'SC-20 (2)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83243.rb"},"title":"The Windows 2008 DNS Servers IP address must be statically defined and configured locally on the server.","desc":"The major threat associated with DNS forged responses or failures are the integrity of the DNS data returned in the response.  By requiring remote clients to obtain origin authentication and integrity verification assurances for the host/service name to network address resolution information obtained through the service, data origin is validated. \n\nEnsuring all name servers have static IP addresses makes it possible to configure restricted DNS communication between the name servers.","descriptions":{"default":"The major threat associated with DNS forged responses or failures are the integrity of the DNS data returned in the response.  By requiring remote clients to obtain origin authentication and integrity verification assurances for the host/service name to network address resolution information obtained through the service, data origin is validated. \n\nEnsuring all name servers have static IP addresses makes it possible to configure restricted DNS communication between the name servers.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nLocate the “Network Internet Access” icon, right-click on it and select \"Open Network & Sharing Center\".\n\nClick on \"Change adapter settings\".\n\nRight-click on the Ethernet and click “Properties”.\n\nSelect Internet Protocol Version 4 (TCP/IPv4) and click “Properties”.\n\nVerify the “Use the following IP address” is selected, with an IP address, subnet mask, and default gateway assigned.\n\nIf the “Use the following IP address” is not selected with a configured IP address, subnet mask, and default gateway, this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nLocate the “Network Internet Access” icon, right-click on it and select \"Open Network & Sharing Center\".\n\nClick on \"Change adapter settings\".\n\nRight-click on the Ethernet and click “Properties”.\n\nSelect Internet Protocol Version 4 (TCP/IPv4) and click “Properties”.\n\nSelect the “Use the following IP address” and populate with an IP address, subnet mask, and default gateway."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59527r3_chk","severity":"medium","gid":"V-58655","rid":"SV-83243r2_rule","stig_id":"WDNS-SC-000003","gtitle":"SRG-APP-000420-DNS-000053","fix_id":"F-64039r3_fix","documentable":null,"cci":["CCI-000366","CCI-002463"],"nist":["CM-6 b","SC-20 (2)"]}},{"id":"SV-83245","code":"control 'SV-83245' do\n  title 'WINS lookups must be disabled on the Windows 2008 DNS Server.'\n  desc 'The major threat associated with DNS forged responses or failures is the integrity of the DNS data returned in the response. If/when WINS lookups are enabled, the validity of the data becomes questionable since the WINS data is provided to the requestor, unsigned and invalidated. A DNS server is an example of an information system providing name/address resolution service. Digital signatures and cryptographic keys are examples of additional artifacts. DNS resource records are examples of authoritative data. Applications other than the DNS, to map between host/service names and network addresses, must provide other means to assure the authenticity and integrity of response data.'\n  desc 'check', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, right-click each zone, and then click “Properties”.\n\nIn the “Properties” dialog box for the zone, click the “WINS” tab.\n\nVerify the \"Use WINS forward lookup\" check box is not selected.\n\nIf the \"Use WINS forward lookup\" check box is selected, this is a finding.'\n  desc 'fix', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, right-click each zone, and then click “Properties”.\n\nIn the “Properties” dialog box for the zone, click the “WINS” tab.\n\nUncheck the \"Use WINS forward\" lookup check box.\n\nClick “OK”.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59533r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58661'\n  tag rid: 'SV-83245r2_rule'\n  tag stig_id: 'WDNS-SC-000006'\n  tag gtitle: 'SRG-APP-000422-DNS-000055'\n  tag fix_id: 'F-64045r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002462']\n  tag nist: ['SC-20 a']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83245.rb"},"title":"WINS lookups must be disabled on the Windows 2008 DNS Server.","desc":"The major threat associated with DNS forged responses or failures is the integrity of the DNS data returned in the response. If/when WINS lookups are enabled, the validity of the data becomes questionable since the WINS data is provided to the requestor, unsigned and invalidated. A DNS server is an example of an information system providing name/address resolution service. Digital signatures and cryptographic keys are examples of additional artifacts. DNS resource records are examples of authoritative data. Applications other than the DNS, to map between host/service names and network addresses, must provide other means to assure the authenticity and integrity of response data.","descriptions":{"default":"The major threat associated with DNS forged responses or failures is the integrity of the DNS data returned in the response. If/when WINS lookups are enabled, the validity of the data becomes questionable since the WINS data is provided to the requestor, unsigned and invalidated. A DNS server is an example of an information system providing name/address resolution service. Digital signatures and cryptographic keys are examples of additional artifacts. DNS resource records are examples of authoritative data. Applications other than the DNS, to map between host/service names and network addresses, must provide other means to assure the authenticity and integrity of response data.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, right-click each zone, and then click “Properties”.\n\nIn the “Properties” dialog box for the zone, click the “WINS” tab.\n\nVerify the \"Use WINS forward lookup\" check box is not selected.\n\nIf the \"Use WINS forward lookup\" check box is selected, this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, right-click each zone, and then click “Properties”.\n\nIn the “Properties” dialog box for the zone, click the “WINS” tab.\n\nUncheck the \"Use WINS forward\" lookup check box.\n\nClick “OK”."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59533r3_chk","severity":"medium","gid":"V-58661","rid":"SV-83245r2_rule","stig_id":"WDNS-SC-000006","gtitle":"SRG-APP-000422-DNS-000055","fix_id":"F-64045r3_fix","documentable":null,"cci":["CCI-002462"],"nist":["SC-20 a"]}},{"id":"SV-83247","code":"control 'SV-83247' do\n  title 'The Windows 2008 DNS Server must not contain zone records that have not been validated in over a year.'\n  desc 'If zone information has not been validated in over a year, then there is no assurance that it is still valid.  If invalid records are in a zone, then an adversary could potentially use their existence for improper purposes. An SOP detailing this process can resolve this requirement.'\n  desc 'check', \"This requirement is not applicable for a Windows DNS Server which is only hosting AD-integrated zones.\n\nFor a Windows DNS Server which hosts a mix of AD-integrated zones and manually maintained zones, ask the DNS database administrator if they maintain a separate database with record documentation for the non-AD-integrated zone information. The reviewer should check that the record's last verified date is less than one year prior to the date of the review.\n\nIf a separate database with record documentation is not maintained for the non-AD-integrated zone information, this is a finding.\n\nIf a separate database with record documentation is maintained for the non-AD-integrated zone information, log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nReview the zone records of the non-AD-integrated zones and compare to the separate documentation maintained.\n\nDetermine if any records have not been validated in over a year.\n\nIf zone records exist which have not been validated in over a year, this is a finding.\"\n  desc 'fix', 'Create a separate database to maintain record documentation for non-AD-integrated zones.\n\nDevelop a procedure to validate annually all zone information on the DNS server against the separately maintained database.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nSelect the zone records which have not been validated in over a year and revalidate.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59567r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58695'\n  tag rid: 'SV-83247r1_rule'\n  tag stig_id: 'WDNS-SC-000025'\n  tag gtitle: 'SRG-APP-000428-DNS-000061'\n  tag fix_id: 'F-64079r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002475']\n  tag nist: ['SC-28 (1)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83247.rb"},"title":"The Windows 2008 DNS Server must not contain zone records that have not been validated in over a year.","desc":"If zone information has not been validated in over a year, then there is no assurance that it is still valid.  If invalid records are in a zone, then an adversary could potentially use their existence for improper purposes. An SOP detailing this process can resolve this requirement.","descriptions":{"default":"If zone information has not been validated in over a year, then there is no assurance that it is still valid.  If invalid records are in a zone, then an adversary could potentially use their existence for improper purposes. An SOP detailing this process can resolve this requirement.","check":"This requirement is not applicable for a Windows DNS Server which is only hosting AD-integrated zones.\n\nFor a Windows DNS Server which hosts a mix of AD-integrated zones and manually maintained zones, ask the DNS database administrator if they maintain a separate database with record documentation for the non-AD-integrated zone information. The reviewer should check that the record's last verified date is less than one year prior to the date of the review.\n\nIf a separate database with record documentation is not maintained for the non-AD-integrated zone information, this is a finding.\n\nIf a separate database with record documentation is maintained for the non-AD-integrated zone information, log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nReview the zone records of the non-AD-integrated zones and compare to the separate documentation maintained.\n\nDetermine if any records have not been validated in over a year.\n\nIf zone records exist which have not been validated in over a year, this is a finding.","fix":"Create a separate database to maintain record documentation for non-AD-integrated zones.\n\nDevelop a procedure to validate annually all zone information on the DNS server against the separately maintained database.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nSelect the zone records which have not been validated in over a year and revalidate."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59567r5_chk","severity":"medium","gid":"V-58695","rid":"SV-83247r1_rule","stig_id":"WDNS-SC-000025","gtitle":"SRG-APP-000428-DNS-000061","fix_id":"F-64079r3_fix","documentable":null,"cci":["CCI-002475"],"nist":["SC-28 (1)"]}},{"id":"SV-83249","code":"control 'SV-83249' do\n  title 'The Windows 2008 DNS Server must follow procedures to re-role a secondary name server as the master name server should the master name server permanently lose functionality.'\n  desc 'Failing to an unsecure condition negatively impacts application security and can lead to system compromise. Failure conditions include, for example, loss of communications among critical system components or between system components and operational facilities. Fail-safe procedures include, for example, alerting operator personnel and providing specific instructions on subsequent steps to take (e.g., do nothing, reestablish system settings, shutdown processes, restart the system, or contact designated organizational personnel).\n\nTransactions such as zone transfers would not be able to work correctly anyway in this state.'\n  desc 'check', 'Active Directory integrated DNS servers will handle the promotion of a secondary DNS server whenever a primary DNS server loses functionality.\n\nIf all of the DNS servers are AD-integrated, this is not a finding.\n\nConsult with the System Administrator to determine if there are documented procedures for re-roling a non-AD-integrated secondary name server to a master name server role in the event a master name server loses functionality.\n\nIf there is not any documented procedures for re-roling a non-AD-integrated secondary name server to primary in the event a master name server loses functionality, this is a finding.'\n  desc 'fix', 'Active Directory-integrated DNS servers will handle the promotion of a secondary DNS server whenever a primary DNS server loses functionality.\n\nDevelop, test, and implement documented procedures for re-roling a non-AD-integrated secondary name server to a master name server role in the event a master name server loses functionality.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59583r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58709'\n  tag rid: 'SV-83249r2_rule'\n  tag stig_id: 'WDNS-SI-000002'\n  tag gtitle: 'SRG-APP-000451-DNS-000069'\n  tag fix_id: 'F-64093r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002754']\n  tag nist: ['SI-10 (3)']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83249.rb"},"title":"The Windows 2008 DNS Server must follow procedures to re-role a secondary name server as the master name server should the master name server permanently lose functionality.","desc":"Failing to an unsecure condition negatively impacts application security and can lead to system compromise. Failure conditions include, for example, loss of communications among critical system components or between system components and operational facilities. Fail-safe procedures include, for example, alerting operator personnel and providing specific instructions on subsequent steps to take (e.g., do nothing, reestablish system settings, shutdown processes, restart the system, or contact designated organizational personnel).\n\nTransactions such as zone transfers would not be able to work correctly anyway in this state.","descriptions":{"default":"Failing to an unsecure condition negatively impacts application security and can lead to system compromise. Failure conditions include, for example, loss of communications among critical system components or between system components and operational facilities. Fail-safe procedures include, for example, alerting operator personnel and providing specific instructions on subsequent steps to take (e.g., do nothing, reestablish system settings, shutdown processes, restart the system, or contact designated organizational personnel).\n\nTransactions such as zone transfers would not be able to work correctly anyway in this state.","check":"Active Directory integrated DNS servers will handle the promotion of a secondary DNS server whenever a primary DNS server loses functionality.\n\nIf all of the DNS servers are AD-integrated, this is not a finding.\n\nConsult with the System Administrator to determine if there are documented procedures for re-roling a non-AD-integrated secondary name server to a master name server role in the event a master name server loses functionality.\n\nIf there is not any documented procedures for re-roling a non-AD-integrated secondary name server to primary in the event a master name server loses functionality, this is a finding.","fix":"Active Directory-integrated DNS servers will handle the promotion of a secondary DNS server whenever a primary DNS server loses functionality.\n\nDevelop, test, and implement documented procedures for re-roling a non-AD-integrated secondary name server to a master name server role in the event a master name server loses functionality."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59583r2_chk","severity":"medium","gid":"V-58709","rid":"SV-83249r2_rule","stig_id":"WDNS-SI-000002","gtitle":"SRG-APP-000451-DNS-000069","fix_id":"F-64093r3_fix","documentable":null,"cci":["CCI-002754"],"nist":["SI-10 (3)"]}},{"id":"SV-83251","code":"control 'SV-83251' do\n  title 'The Windows 2008 DNS Server must perform verification of the correct operation of security functions: upon system start-up and/or restart; upon command by a user with privileged access; and/or every 30 days.'\n  desc 'Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters. Without verification, security functions may not operate correctly and this failure may go unnoticed. \n\nNotifications provided by information systems include, for example, electronic alerts to system administrators, messages to local computer consoles, and/or hardware indications, such as lights.\n\nThe DNS server should perform self-tests, such as at server start-up, to confirm that its security functions are working properly.'\n  desc 'check', 'This functionality should be performed by the Host Based Security System (HBSS), mandatory on all DoD systems.\n\nCheck to ensure McAfee HBSS is installed and fully operational on the Windows DNS Server.\n\nIf all required HBSS products are not installed and/or the installed products are not enabled, this is a finding.'\n  desc 'fix', 'Follow the HBSS guidance to install all HBSS products to the Windows DNS Server.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59587r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58713'\n  tag rid: 'SV-83251r1_rule'\n  tag stig_id: 'WDNS-SI-000006'\n  tag gtitle: 'SRG-APP-000473-DNS-000072'\n  tag fix_id: 'F-64097r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-002775']\n  tag nist: ['CM-6 b', 'SI-17']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83251.rb"},"title":"The Windows 2008 DNS Server must perform verification of the correct operation of security functions: upon system start-up and/or restart; upon command by a user with privileged access; and/or every 30 days.","desc":"Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters. Without verification, security functions may not operate correctly and this failure may go unnoticed. \n\nNotifications provided by information systems include, for example, electronic alerts to system administrators, messages to local computer consoles, and/or hardware indications, such as lights.\n\nThe DNS server should perform self-tests, such as at server start-up, to confirm that its security functions are working properly.","descriptions":{"default":"Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters. Without verification, security functions may not operate correctly and this failure may go unnoticed. \n\nNotifications provided by information systems include, for example, electronic alerts to system administrators, messages to local computer consoles, and/or hardware indications, such as lights.\n\nThe DNS server should perform self-tests, such as at server start-up, to confirm that its security functions are working properly.","check":"This functionality should be performed by the Host Based Security System (HBSS), mandatory on all DoD systems.\n\nCheck to ensure McAfee HBSS is installed and fully operational on the Windows DNS Server.\n\nIf all required HBSS products are not installed and/or the installed products are not enabled, this is a finding.","fix":"Follow the HBSS guidance to install all HBSS products to the Windows DNS Server."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59587r3_chk","severity":"medium","gid":"V-58713","rid":"SV-83251r1_rule","stig_id":"WDNS-SI-000006","gtitle":"SRG-APP-000473-DNS-000072","fix_id":"F-64097r3_fix","documentable":null,"cci":["CCI-000366","CCI-002775"],"nist":["CM-6 b","SI-17"]}},{"id":"SV-83255","code":"control 'SV-83255' do\n  title 'The Windows 2008 DNS Servers zone files must have NS records that point to active name servers authoritative for the domain specified in that record.'\n  desc \"Poorly constructed NS records pose a security risk because they create conditions under which an adversary might be able to provide the missing authoritative name services that are improperly specified in the zone file. The adversary could issue bogus responses to queries that clients would accept because they learned of the adversary's name server from a valid authoritative name server, one that need not be compromised for this attack to be successful. The list of slave servers must remain current within 72 hours of any changes to the zone architecture that would affect the list of slaves. If a slave server has been retired or is not operational but remains on the list, then an adversary might have a greater opportunity to impersonate that slave without detection, rather than if the slave was actually online. For example, the adversary may be able to spoof the retired slave's IP address without an IP address conflict, which would not be likely to occur if the true slave were active.\"\n  desc 'check', 'NOTE: This check is Not Applicable if Windows DNS server is only serving as a caching server and does not host any zones authoritatively.\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress “Windows Key + R”, execute “dnsmgmt.msc”.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nReview the NS records for the zone.\n\nVerify each of the name servers, represented by the NS records, is active.\n\nAt a command prompt on any system, type:\n\nnslookup <enter>;\n\nAt the nslookup prompt, type: \n\nserver ###.###.###.### <enter>;\n(where the ###.###.###.### is replaced by the IP of each NS record) \n\nEnter a FQDN for a known host record in the zone.\n\nIf the NS server does not respond at all or responds with a non-authoritative answer, this is a finding.'\n  desc 'fix', 'If DNS servers are AD-integrated, troubleshoot and remedy the replication problem where the non-responsive name server is not getting updated.\n\nIf DNS servers are not AD-integrated, log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone. \n\nReview the NS records for the zone.\n\nSelect the NS record for the non-responsive name server and remove the record.'\n  impact 0.7\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59465r5_chk'\n  tag severity: 'high'\n  tag gid: 'V-58593'\n  tag rid: 'SV-83255r3_rule'\n  tag stig_id: 'WDNS-CM-000010'\n  tag gtitle: 'SRG-APP-000516-DNS-000085'\n  tag fix_id: 'F-63977r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83255.rb"},"title":"The Windows 2008 DNS Servers zone files must have NS records that point to active name servers authoritative for the domain specified in that record.","desc":"Poorly constructed NS records pose a security risk because they create conditions under which an adversary might be able to provide the missing authoritative name services that are improperly specified in the zone file. The adversary could issue bogus responses to queries that clients would accept because they learned of the adversary's name server from a valid authoritative name server, one that need not be compromised for this attack to be successful. The list of slave servers must remain current within 72 hours of any changes to the zone architecture that would affect the list of slaves. If a slave server has been retired or is not operational but remains on the list, then an adversary might have a greater opportunity to impersonate that slave without detection, rather than if the slave was actually online. For example, the adversary may be able to spoof the retired slave's IP address without an IP address conflict, which would not be likely to occur if the true slave were active.","descriptions":{"default":"Poorly constructed NS records pose a security risk because they create conditions under which an adversary might be able to provide the missing authoritative name services that are improperly specified in the zone file. The adversary could issue bogus responses to queries that clients would accept because they learned of the adversary's name server from a valid authoritative name server, one that need not be compromised for this attack to be successful. The list of slave servers must remain current within 72 hours of any changes to the zone architecture that would affect the list of slaves. If a slave server has been retired or is not operational but remains on the list, then an adversary might have a greater opportunity to impersonate that slave without detection, rather than if the slave was actually online. For example, the adversary may be able to spoof the retired slave's IP address without an IP address conflict, which would not be likely to occur if the true slave were active.","check":"NOTE: This check is Not Applicable if Windows DNS server is only serving as a caching server and does not host any zones authoritatively.\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress “Windows Key + R”, execute “dnsmgmt.msc”.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nReview the NS records for the zone.\n\nVerify each of the name servers, represented by the NS records, is active.\n\nAt a command prompt on any system, type:\n\nnslookup <enter>;\n\nAt the nslookup prompt, type: \n\nserver ###.###.###.### <enter>;\n(where the ###.###.###.### is replaced by the IP of each NS record) \n\nEnter a FQDN for a known host record in the zone.\n\nIf the NS server does not respond at all or responds with a non-authoritative answer, this is a finding.","fix":"If DNS servers are AD-integrated, troubleshoot and remedy the replication problem where the non-responsive name server is not getting updated.\n\nIf DNS servers are not AD-integrated, log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone. \n\nReview the NS records for the zone.\n\nSelect the NS record for the non-responsive name server and remove the record."},"impact":0.7,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59465r5_chk","severity":"high","gid":"V-58593","rid":"SV-83255r3_rule","stig_id":"WDNS-CM-000010","gtitle":"SRG-APP-000516-DNS-000085","fix_id":"F-63977r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83271","code":"control 'SV-83271' do\n  title 'All authoritative name servers for a zone must be located on different network segments.'\n  desc 'Most enterprises have an authoritative primary server and a host of authoritative secondary name servers. It is essential that these authoritative name servers for an enterprise be located on different network segments. This dispersion ensures the availability of an authoritative name server not only in situations in which a particular router or switch fails but also during events involving an attack on an entire network segment.\n\nA network administrator may choose to use a \"hidden\" master authoritative server and only have secondary servers visible on the network. A hidden master authoritative server is an authoritative DNS server whose IP address does not appear in the name server set for a zone. If the master authoritative name server is \"hidden\", a secondary authoritative name server may reside on the same network as the hidden master.'\n  desc 'check', 'Windows DNS Servers that are Active Directory-integrated must be located where required to meet the Active Directory services.\n\nIf all of the Windows DNS Servers are AD-integrated, this check is not applicable.\n\nIf any or all of the Windows DNS Servers are stand-alone and non-AD-integrated, verify with the System Administrator their geographic dispersal.\n\nIf all of the authoritative name servers are located on the same network segment, and the master authoritative name server is not \"hidden\", this is a finding.'\n  desc 'fix', 'For non-AD-integrated Windows DNS Servers, distribute secondary authoritative servers on separate network segments from the primary authoritative server.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59467r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58595'\n  tag rid: 'SV-83271r1_rule'\n  tag stig_id: 'WDNS-CM-000012'\n  tag gtitle: 'SRG-APP-000516-DNS-000087'\n  tag fix_id: 'F-63979r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83271.rb"},"title":"All authoritative name servers for a zone must be located on different network segments.","desc":"Most enterprises have an authoritative primary server and a host of authoritative secondary name servers. It is essential that these authoritative name servers for an enterprise be located on different network segments. This dispersion ensures the availability of an authoritative name server not only in situations in which a particular router or switch fails but also during events involving an attack on an entire network segment.\n\nA network administrator may choose to use a \"hidden\" master authoritative server and only have secondary servers visible on the network. A hidden master authoritative server is an authoritative DNS server whose IP address does not appear in the name server set for a zone. If the master authoritative name server is \"hidden\", a secondary authoritative name server may reside on the same network as the hidden master.","descriptions":{"default":"Most enterprises have an authoritative primary server and a host of authoritative secondary name servers. It is essential that these authoritative name servers for an enterprise be located on different network segments. This dispersion ensures the availability of an authoritative name server not only in situations in which a particular router or switch fails but also during events involving an attack on an entire network segment.\n\nA network administrator may choose to use a \"hidden\" master authoritative server and only have secondary servers visible on the network. A hidden master authoritative server is an authoritative DNS server whose IP address does not appear in the name server set for a zone. If the master authoritative name server is \"hidden\", a secondary authoritative name server may reside on the same network as the hidden master.","check":"Windows DNS Servers that are Active Directory-integrated must be located where required to meet the Active Directory services.\n\nIf all of the Windows DNS Servers are AD-integrated, this check is not applicable.\n\nIf any or all of the Windows DNS Servers are stand-alone and non-AD-integrated, verify with the System Administrator their geographic dispersal.\n\nIf all of the authoritative name servers are located on the same network segment, and the master authoritative name server is not \"hidden\", this is a finding.","fix":"For non-AD-integrated Windows DNS Servers, distribute secondary authoritative servers on separate network segments from the primary authoritative server."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59467r3_chk","severity":"medium","gid":"V-58595","rid":"SV-83271r1_rule","stig_id":"WDNS-CM-000012","gtitle":"SRG-APP-000516-DNS-000087","fix_id":"F-63979r3_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83273","code":"control 'SV-83273' do\n  title 'All authoritative name servers for a zone must have the same version of zone information.'\n  desc 'The only protection approach for content control of a DNS zone file is the use of a zone file integrity checker. The effectiveness of integrity checking using a zone file integrity checker depends upon the database of constraints built into the checker. The deployment process consists of developing these constraints with the right logic, and the only determinant of the truth value of these logical predicates is the parameter values for certain key fields in the format of various RRTypes.\n\nThe serial number in the SOA RDATA is used to indicate to secondary name servers that a change to the zone has occurred and a zone transfer should be performed. It should always be increased whenever a change is made to the zone data. DNS NOTIFY must be enabled on the master authoritative name server.'\n  desc 'check', 'Note: Due to the manner in which Active Directory replication increments SOA records for zones when transferring zone information via AD replication, this check is not applicable for AD-integrated zones.\n\nLog on to the DNS server hosting a non-AD-integrated zone using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nReview the SOA information for the zone and obtain the Serial Number.\n\nAccess each secondary name server for the same zone and review the SOA information.\n \nVerify the Serial Number is the same on all authoritative name servers.\n\nIf the Serial Number is not the same on one or more authoritative name servers, this is a finding.'\n  desc 'fix', 'If all DNS servers are AD-integrated, troubleshoot why and mitigate the replication is not taking place to the out-of-sync secondary name servers.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nInitiate a zone transfer to all secondary name servers for the zone.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59469r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58597'\n  tag rid: 'SV-83273r1_rule'\n  tag stig_id: 'WDNS-CM-000013'\n  tag gtitle: 'SRG-APP-000516-DNS-000088'\n  tag fix_id: 'F-63981r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83273.rb"},"title":"All authoritative name servers for a zone must have the same version of zone information.","desc":"The only protection approach for content control of a DNS zone file is the use of a zone file integrity checker. The effectiveness of integrity checking using a zone file integrity checker depends upon the database of constraints built into the checker. The deployment process consists of developing these constraints with the right logic, and the only determinant of the truth value of these logical predicates is the parameter values for certain key fields in the format of various RRTypes.\n\nThe serial number in the SOA RDATA is used to indicate to secondary name servers that a change to the zone has occurred and a zone transfer should be performed. It should always be increased whenever a change is made to the zone data. DNS NOTIFY must be enabled on the master authoritative name server.","descriptions":{"default":"The only protection approach for content control of a DNS zone file is the use of a zone file integrity checker. The effectiveness of integrity checking using a zone file integrity checker depends upon the database of constraints built into the checker. The deployment process consists of developing these constraints with the right logic, and the only determinant of the truth value of these logical predicates is the parameter values for certain key fields in the format of various RRTypes.\n\nThe serial number in the SOA RDATA is used to indicate to secondary name servers that a change to the zone has occurred and a zone transfer should be performed. It should always be increased whenever a change is made to the zone data. DNS NOTIFY must be enabled on the master authoritative name server.","check":"Note: Due to the manner in which Active Directory replication increments SOA records for zones when transferring zone information via AD replication, this check is not applicable for AD-integrated zones.\n\nLog on to the DNS server hosting a non-AD-integrated zone using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nReview the SOA information for the zone and obtain the Serial Number.\n\nAccess each secondary name server for the same zone and review the SOA information.\n \nVerify the Serial Number is the same on all authoritative name servers.\n\nIf the Serial Number is not the same on one or more authoritative name servers, this is a finding.","fix":"If all DNS servers are AD-integrated, troubleshoot why and mitigate the replication is not taking place to the out-of-sync secondary name servers.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nInitiate a zone transfer to all secondary name servers for the zone."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59469r3_chk","severity":"medium","gid":"V-58597","rid":"SV-83273r1_rule","stig_id":"WDNS-CM-000013","gtitle":"SRG-APP-000516-DNS-000088","fix_id":"F-63981r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83275","code":"control 'SV-83275' do\n  title 'For zones split between the external and internal sides of a network, the RRs for the external hosts must be separate from the RRs for the internal hosts.'\n  desc 'Authoritative name servers for an enterprise may be configured to receive requests from both external and internal clients. \n\nExternal clients need to receive RRs that pertain only to public services (public Web server, mail server, etc.) \n\nInternal clients need to receive RRs pertaining to public services as well as internal hosts. \n\nThe zone information that serves the RRs on both the inside and the outside of a firewall should be split into different physical files for these two types of clients (one file for external clients and one file for internal clients).'\n  desc 'check', \"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nFor each zone, review the records.\n\nIf any RRs (Resource Records) on an internal DNS server resolve to IP addresses located outside the internal DNS server's network, this is a finding.\n\nIf any RRs (Resource Records) on an external DNS server resolve to IP addresses located inside the network, this is a finding.\"\n  desc 'fix', 'Remove any RRs from the internal zones for which the resolution is for an external IP address.\n\nRemove any RRs from the external zones for which the resolution is for an internal IP address.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59475r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58603'\n  tag rid: 'SV-83275r1_rule'\n  tag stig_id: 'WDNS-CM-000016'\n  tag gtitle: 'SRG-APP-000516-DNS-000091'\n  tag fix_id: 'F-63987r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83275.rb"},"title":"For zones split between the external and internal sides of a network, the RRs for the external hosts must be separate from the RRs for the internal hosts.","desc":"Authoritative name servers for an enterprise may be configured to receive requests from both external and internal clients. \n\nExternal clients need to receive RRs that pertain only to public services (public Web server, mail server, etc.) \n\nInternal clients need to receive RRs pertaining to public services as well as internal hosts. \n\nThe zone information that serves the RRs on both the inside and the outside of a firewall should be split into different physical files for these two types of clients (one file for external clients and one file for internal clients).","descriptions":{"default":"Authoritative name servers for an enterprise may be configured to receive requests from both external and internal clients. \n\nExternal clients need to receive RRs that pertain only to public services (public Web server, mail server, etc.) \n\nInternal clients need to receive RRs pertaining to public services as well as internal hosts. \n\nThe zone information that serves the RRs on both the inside and the outside of a firewall should be split into different physical files for these two types of clients (one file for external clients and one file for internal clients).","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nFor each zone, review the records.\n\nIf any RRs (Resource Records) on an internal DNS server resolve to IP addresses located outside the internal DNS server's network, this is a finding.\n\nIf any RRs (Resource Records) on an external DNS server resolve to IP addresses located inside the network, this is a finding.","fix":"Remove any RRs from the internal zones for which the resolution is for an external IP address.\n\nRemove any RRs from the external zones for which the resolution is for an internal IP address."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59475r2_chk","severity":"medium","gid":"V-58603","rid":"SV-83275r1_rule","stig_id":"WDNS-CM-000016","gtitle":"SRG-APP-000516-DNS-000091","fix_id":"F-63987r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83277","code":"control 'SV-83277' do\n  title 'In a split DNS configuration, where separate name servers are used between the external and internal networks, the external name server must be configured to not be reachable from inside resolvers.'\n  desc 'Instead of having the same set of authoritative name servers serve different types of clients, an enterprise could have two different sets of authoritative name servers. \n\nOne set, called external name servers, can be located within a DMZ; these would be the only name servers that are accessible to external clients and would serve RRs pertaining to hosts with public services (Web servers that serve external Web pages or provide B2C services, mail servers, etc.) \n\nThe other set, called internal name servers, is to be located within the firewall and should be configured so they are not reachable from outside and hence provide naming services exclusively to internal clients.'\n  desc 'check', \"Consult with the System Administrator to review the external Windows DNS Server's HBSS firewall policy.\n\nThe inbound TCP and UDP ports 53 rule should be configured to only restrict IP addresses from the internal network.\n\nIf the HBSS firewall policy is not configured with the restriction, consult with the network firewall administrator to confirm the restriction on the network firewall.\n\nIf neither the DNS server's HBSS firewall policy nor the network firewall is configured to block internal hosts from querying the external DNS server, this is a finding.\"\n  desc 'fix', \"Configure the external DNS server's firewall policy, or the network firewall, to block queries from internal hosts.\"\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59477r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58605'\n  tag rid: 'SV-83277r1_rule'\n  tag stig_id: 'WDNS-CM-000017'\n  tag gtitle: 'SRG-APP-000516-DNS-000092'\n  tag fix_id: 'F-63989r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83277.rb"},"title":"In a split DNS configuration, where separate name servers are used between the external and internal networks, the external name server must be configured to not be reachable from inside resolvers.","desc":"Instead of having the same set of authoritative name servers serve different types of clients, an enterprise could have two different sets of authoritative name servers. \n\nOne set, called external name servers, can be located within a DMZ; these would be the only name servers that are accessible to external clients and would serve RRs pertaining to hosts with public services (Web servers that serve external Web pages or provide B2C services, mail servers, etc.) \n\nThe other set, called internal name servers, is to be located within the firewall and should be configured so they are not reachable from outside and hence provide naming services exclusively to internal clients.","descriptions":{"default":"Instead of having the same set of authoritative name servers serve different types of clients, an enterprise could have two different sets of authoritative name servers. \n\nOne set, called external name servers, can be located within a DMZ; these would be the only name servers that are accessible to external clients and would serve RRs pertaining to hosts with public services (Web servers that serve external Web pages or provide B2C services, mail servers, etc.) \n\nThe other set, called internal name servers, is to be located within the firewall and should be configured so they are not reachable from outside and hence provide naming services exclusively to internal clients.","check":"Consult with the System Administrator to review the external Windows DNS Server's HBSS firewall policy.\n\nThe inbound TCP and UDP ports 53 rule should be configured to only restrict IP addresses from the internal network.\n\nIf the HBSS firewall policy is not configured with the restriction, consult with the network firewall administrator to confirm the restriction on the network firewall.\n\nIf neither the DNS server's HBSS firewall policy nor the network firewall is configured to block internal hosts from querying the external DNS server, this is a finding.","fix":"Configure the external DNS server's firewall policy, or the network firewall, to block queries from internal hosts."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59477r3_chk","severity":"medium","gid":"V-58605","rid":"SV-83277r1_rule","stig_id":"WDNS-CM-000017","gtitle":"SRG-APP-000516-DNS-000092","fix_id":"F-63989r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83279","code":"control 'SV-83279' do\n  title 'In a split DNS configuration, where separate name servers are used between the external and internal networks, the internal name server must be configured to not be reachable from outside resolvers.'\n  desc 'Instead of having the same set of authoritative name servers serve different types of clients, an enterprise could have two different sets of authoritative name servers.\n\nOne set, called external name servers, can be located within a DMZ; these would be the only name servers that are accessible to external clients and would serve RRs pertaining to hosts with public services (Web servers that serve external Web pages or provide B2C services, mail servers, etc.)\n\nThe other set, called internal name servers, is to be located within the firewall and should be configured so they are not reachable from outside and hence provide naming services exclusively to internal clients.'\n  desc 'check', \"Consult with the System Administrator to review the internal Windows DNS Server's HBSS firewall policy.\n\nThe inbound TCP and UDP ports 53 rule should be configured to only allow hosts from the internal network to query the internal DNS server.\n\nIf the HBSS firewall policy is not configured with the restriction, consult with the network firewall administrator to confirm the restriction on the network firewall.\n\nIf neither the DNS server's HBSS firewall policy nor the network firewall is configured to block external hosts from querying the internal DNS server, this is a finding.\"\n  desc 'fix', \"Configure the internal DNS server's firewall policy, or the network firewall, to block queries from external hosts.\"\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59479r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58607'\n  tag rid: 'SV-83279r1_rule'\n  tag stig_id: 'WDNS-CM-000018'\n  tag gtitle: 'SRG-APP-000516-DNS-000093'\n  tag fix_id: 'F-63991r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83279.rb"},"title":"In a split DNS configuration, where separate name servers are used between the external and internal networks, the internal name server must be configured to not be reachable from outside resolvers.","desc":"Instead of having the same set of authoritative name servers serve different types of clients, an enterprise could have two different sets of authoritative name servers.\n\nOne set, called external name servers, can be located within a DMZ; these would be the only name servers that are accessible to external clients and would serve RRs pertaining to hosts with public services (Web servers that serve external Web pages or provide B2C services, mail servers, etc.)\n\nThe other set, called internal name servers, is to be located within the firewall and should be configured so they are not reachable from outside and hence provide naming services exclusively to internal clients.","descriptions":{"default":"Instead of having the same set of authoritative name servers serve different types of clients, an enterprise could have two different sets of authoritative name servers.\n\nOne set, called external name servers, can be located within a DMZ; these would be the only name servers that are accessible to external clients and would serve RRs pertaining to hosts with public services (Web servers that serve external Web pages or provide B2C services, mail servers, etc.)\n\nThe other set, called internal name servers, is to be located within the firewall and should be configured so they are not reachable from outside and hence provide naming services exclusively to internal clients.","check":"Consult with the System Administrator to review the internal Windows DNS Server's HBSS firewall policy.\n\nThe inbound TCP and UDP ports 53 rule should be configured to only allow hosts from the internal network to query the internal DNS server.\n\nIf the HBSS firewall policy is not configured with the restriction, consult with the network firewall administrator to confirm the restriction on the network firewall.\n\nIf neither the DNS server's HBSS firewall policy nor the network firewall is configured to block external hosts from querying the internal DNS server, this is a finding.","fix":"Configure the internal DNS server's firewall policy, or the network firewall, to block queries from external hosts."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59479r3_chk","severity":"medium","gid":"V-58607","rid":"SV-83279r1_rule","stig_id":"WDNS-CM-000018","gtitle":"SRG-APP-000516-DNS-000093","fix_id":"F-63991r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83281","code":"control 'SV-83281' do\n  title 'Primary authoritative name servers must be configured to only receive zone transfer requests from specified secondary name servers.'\n  desc 'Authoritative name servers (especially primary name servers) should be configured with an allow-transfer access control sub statement designating the list of hosts from which zone transfer requests can be accepted. These restrictions address the denial-of-service threat and potential exploits from unrestricted dissemination of information about internal resources. Based on the need-to-know, the only name servers that need to refresh their zone files periodically are the secondary name servers. Zone transfer from primary name servers should be restricted to secondary name servers. The zone transfer should be completely disabled in the secondary name servers. The address match list argument for the allow-transfer sub statement should consist of IP addresses of secondary name servers and stealth secondary name servers.'\n  desc 'check', 'Verify whether the authoritative primary name server is AD-integrated.\n\nVerify whether all secondary name servers for every zone for which the primary name server is authoritative are all AD-integrated in the same Active Directory.\n\nIf the authoritative primary name server is AD-integrated and all secondary name servers also part of the same AD, this check is not a finding since AD handles the replication of DNS data.\n\nIf one or more of the secondary name servers are non-AD integrated, verify the primary name server is configured to only send zone transfers to a specific list of secondary name servers.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nRight-click the zone and select “Properties”.\n\nSelect the “Zone Transfers” tab.\n\nIf the \"Allow zone transfers:\" check box is not selected, this is not a finding.\n\nIf the \"Allow zone transfers:\" check box is selected, verify either \"Only to servers listed on the Name Server tab\" or \"Only to the following servers\" is selected.\n\nIf the \"To any server\" option is selected, this is a finding.'\n  desc 'fix', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nRight-click the zone and select “Properties”.\n\nSelect the \"Zone Transfers\" tab.\n\nSelect the \"Only to servers listed on the Name Server tab\" or \"Only to the following servers\" check box or deselect the \"Allow zone transfers\" check box.\n\nClick “OK”.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59481r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58609'\n  tag rid: 'SV-83281r1_rule'\n  tag stig_id: 'WDNS-CM-000019'\n  tag gtitle: 'SRG-APP-000516-DNS-000095'\n  tag fix_id: 'F-63993r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83281.rb"},"title":"Primary authoritative name servers must be configured to only receive zone transfer requests from specified secondary name servers.","desc":"Authoritative name servers (especially primary name servers) should be configured with an allow-transfer access control sub statement designating the list of hosts from which zone transfer requests can be accepted. These restrictions address the denial-of-service threat and potential exploits from unrestricted dissemination of information about internal resources. Based on the need-to-know, the only name servers that need to refresh their zone files periodically are the secondary name servers. Zone transfer from primary name servers should be restricted to secondary name servers. The zone transfer should be completely disabled in the secondary name servers. The address match list argument for the allow-transfer sub statement should consist of IP addresses of secondary name servers and stealth secondary name servers.","descriptions":{"default":"Authoritative name servers (especially primary name servers) should be configured with an allow-transfer access control sub statement designating the list of hosts from which zone transfer requests can be accepted. These restrictions address the denial-of-service threat and potential exploits from unrestricted dissemination of information about internal resources. Based on the need-to-know, the only name servers that need to refresh their zone files periodically are the secondary name servers. Zone transfer from primary name servers should be restricted to secondary name servers. The zone transfer should be completely disabled in the secondary name servers. The address match list argument for the allow-transfer sub statement should consist of IP addresses of secondary name servers and stealth secondary name servers.","check":"Verify whether the authoritative primary name server is AD-integrated.\n\nVerify whether all secondary name servers for every zone for which the primary name server is authoritative are all AD-integrated in the same Active Directory.\n\nIf the authoritative primary name server is AD-integrated and all secondary name servers also part of the same AD, this check is not a finding since AD handles the replication of DNS data.\n\nIf one or more of the secondary name servers are non-AD integrated, verify the primary name server is configured to only send zone transfers to a specific list of secondary name servers.\n\nLog on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nRight-click the zone and select “Properties”.\n\nSelect the “Zone Transfers” tab.\n\nIf the \"Allow zone transfers:\" check box is not selected, this is not a finding.\n\nIf the \"Allow zone transfers:\" check box is selected, verify either \"Only to servers listed on the Name Server tab\" or \"Only to the following servers\" is selected.\n\nIf the \"To any server\" option is selected, this is a finding.","fix":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nRight-click the zone and select “Properties”.\n\nSelect the \"Zone Transfers\" tab.\n\nSelect the \"Only to servers listed on the Name Server tab\" or \"Only to the following servers\" check box or deselect the \"Allow zone transfers\" check box.\n\nClick “OK”."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59481r4_chk","severity":"medium","gid":"V-58609","rid":"SV-83281r1_rule","stig_id":"WDNS-CM-000019","gtitle":"SRG-APP-000516-DNS-000095","fix_id":"F-63993r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83283","code":"control 'SV-83283' do\n  title 'The Windows 2008 DNS Servers zone database files must not be accessible for edit/write by users and/or processes other than the Windows 2008 DNS Server service account and/or the DNS database administrator.'\n  desc 'Discretionary Access Control (DAC) is based on the premise that individual users are \"owners\" of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment. In a DNS implementation, DAC should be granted to a minimal number of individuals and objects because DNS does not interact directly with users and users do not store and share data with the DNS application directly.\n\nThe primary objective of DNS authentication and access control is the integrity of DNS records; only authorized personnel must be able to create and modify resource records, and name servers should only accept updates from authoritative master servers for the relevant zones. Integrity is best assured through authentication and access control features within the name server software and the file system the name server resides on. In order to protect the zone files and configuration data, which should only be accessed by the name service or an administrator, access controls need to be implemented on files, and rights should not be easily propagated to other users. Lack of a stringent access control policy places the DNS infrastructure at risk to malicious persons and attackers, in addition to potential denial of service to network resources.\n\nDAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled file permissions. DAC models have the potential for the access controls to propagate without limit, resulting in unauthorized access to said objects.\n\nWhen applications provide a DAC mechanism, the DNS implementation must be able to limit the propagation of those access rights.'\n  desc 'check', 'For an Active Directory-integrated DNS implementation, this is Not Applicable by virtue of being compliant with the Windows 2008/2012 AD STIG, since DNS data within an AD-integrated zone is kept within the Active Directory.\n\nFor a file-based Windows DNS implementation, log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select each zone.\n\nRight-click each zone and select “Properties”.\n\nSelect the “Security” tab.\n\nReview the permissions applied to the zone. No group or user should have greater than READ privileges other than the DNS Admins and the System service account under which the DNS Server Service is running.\n\nIf any other account/group has greater than READ privileges, this is a finding.'\n  desc 'fix', 'For a file-back Windows DNS implementation, log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select each zone.\n\nRight-click each zone and select “Properties”.\n\nSelect the “Security” tab.\n\nDowngrade to READ privileges assigned to any group or user which has greater than READ privileges.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59483r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58611'\n  tag rid: 'SV-83283r1_rule'\n  tag stig_id: 'WDNS-CM-000020'\n  tag gtitle: 'SRG-APP-000516-DNS-000099'\n  tag fix_id: 'F-63995r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83283.rb"},"title":"The Windows 2008 DNS Servers zone database files must not be accessible for edit/write by users and/or processes other than the Windows 2008 DNS Server service account and/or the DNS database administrator.","desc":"Discretionary Access Control (DAC) is based on the premise that individual users are \"owners\" of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment. In a DNS implementation, DAC should be granted to a minimal number of individuals and objects because DNS does not interact directly with users and users do not store and share data with the DNS application directly.\n\nThe primary objective of DNS authentication and access control is the integrity of DNS records; only authorized personnel must be able to create and modify resource records, and name servers should only accept updates from authoritative master servers for the relevant zones. Integrity is best assured through authentication and access control features within the name server software and the file system the name server resides on. In order to protect the zone files and configuration data, which should only be accessed by the name service or an administrator, access controls need to be implemented on files, and rights should not be easily propagated to other users. Lack of a stringent access control policy places the DNS infrastructure at risk to malicious persons and attackers, in addition to potential denial of service to network resources.\n\nDAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled file permissions. DAC models have the potential for the access controls to propagate without limit, resulting in unauthorized access to said objects.\n\nWhen applications provide a DAC mechanism, the DNS implementation must be able to limit the propagation of those access rights.","descriptions":{"default":"Discretionary Access Control (DAC) is based on the premise that individual users are \"owners\" of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment. In a DNS implementation, DAC should be granted to a minimal number of individuals and objects because DNS does not interact directly with users and users do not store and share data with the DNS application directly.\n\nThe primary objective of DNS authentication and access control is the integrity of DNS records; only authorized personnel must be able to create and modify resource records, and name servers should only accept updates from authoritative master servers for the relevant zones. Integrity is best assured through authentication and access control features within the name server software and the file system the name server resides on. In order to protect the zone files and configuration data, which should only be accessed by the name service or an administrator, access controls need to be implemented on files, and rights should not be easily propagated to other users. Lack of a stringent access control policy places the DNS infrastructure at risk to malicious persons and attackers, in addition to potential denial of service to network resources.\n\nDAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled file permissions. DAC models have the potential for the access controls to propagate without limit, resulting in unauthorized access to said objects.\n\nWhen applications provide a DAC mechanism, the DNS implementation must be able to limit the propagation of those access rights.","check":"For an Active Directory-integrated DNS implementation, this is Not Applicable by virtue of being compliant with the Windows 2008/2012 AD STIG, since DNS data within an AD-integrated zone is kept within the Active Directory.\n\nFor a file-based Windows DNS implementation, log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select each zone.\n\nRight-click each zone and select “Properties”.\n\nSelect the “Security” tab.\n\nReview the permissions applied to the zone. No group or user should have greater than READ privileges other than the DNS Admins and the System service account under which the DNS Server Service is running.\n\nIf any other account/group has greater than READ privileges, this is a finding.","fix":"For a file-back Windows DNS implementation, log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select each zone.\n\nRight-click each zone and select “Properties”.\n\nSelect the “Security” tab.\n\nDowngrade to READ privileges assigned to any group or user which has greater than READ privileges."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59483r3_chk","severity":"medium","gid":"V-58611","rid":"SV-83283r1_rule","stig_id":"WDNS-CM-000020","gtitle":"SRG-APP-000516-DNS-000099","fix_id":"F-63995r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83285","code":"control 'SV-83285' do\n  title 'The Windows 2008 DNS Server must implement internal/external role separation.'\n  desc 'DNS servers with an internal role only process name/address resolution requests from within the organization (i.e., internal clients). DNS servers with an external role only process name/address resolution information requests from clients external to the organization (i.e., on the external networks, including the Internet). The set of clients that can access an authoritative DNS server in a particular role is specified by the organization using address ranges, explicit access control lists, etc. In order to protect internal DNS resource information, it is important to isolate the requests to internal DNS servers. Separating internal and external roles in DNS prevents address space that is private (e.g., 10.0.0.0/24) or is otherwise concealed by some form of Network Address Translation from leaking into the public DNS system.'\n  desc 'check', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, review each zone.\n\nConsult with the DNS Admin to determine if any of the zones also have hostnames needing to be resolved from the external network.\n\nIf the zone is split between internal and external networks, verify separate DNS servers have been implemented for each network.\n\nIf internal and external DNS servers have not been implemented for zones which require resolution from both the internal and external networks, this is a finding.'\n  desc 'fix', 'Configure separate DNS servers for each of the external and internal networks.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59485r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58613'\n  tag rid: 'SV-83285r1_rule'\n  tag stig_id: 'WDNS-CM-000021'\n  tag gtitle: 'SRG-APP-000516-DNS-000101'\n  tag fix_id: 'F-63997r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83285.rb"},"title":"The Windows 2008 DNS Server must implement internal/external role separation.","desc":"DNS servers with an internal role only process name/address resolution requests from within the organization (i.e., internal clients). DNS servers with an external role only process name/address resolution information requests from clients external to the organization (i.e., on the external networks, including the Internet). The set of clients that can access an authoritative DNS server in a particular role is specified by the organization using address ranges, explicit access control lists, etc. In order to protect internal DNS resource information, it is important to isolate the requests to internal DNS servers. Separating internal and external roles in DNS prevents address space that is private (e.g., 10.0.0.0/24) or is otherwise concealed by some form of Network Address Translation from leaking into the public DNS system.","descriptions":{"default":"DNS servers with an internal role only process name/address resolution requests from within the organization (i.e., internal clients). DNS servers with an external role only process name/address resolution information requests from clients external to the organization (i.e., on the external networks, including the Internet). The set of clients that can access an authoritative DNS server in a particular role is specified by the organization using address ranges, explicit access control lists, etc. In order to protect internal DNS resource information, it is important to isolate the requests to internal DNS servers. Separating internal and external roles in DNS prevents address space that is private (e.g., 10.0.0.0/24) or is otherwise concealed by some form of Network Address Translation from leaking into the public DNS system.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, review each zone.\n\nConsult with the DNS Admin to determine if any of the zones also have hostnames needing to be resolved from the external network.\n\nIf the zone is split between internal and external networks, verify separate DNS servers have been implemented for each network.\n\nIf internal and external DNS servers have not been implemented for zones which require resolution from both the internal and external networks, this is a finding.","fix":"Configure separate DNS servers for each of the external and internal networks."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59485r2_chk","severity":"medium","gid":"V-58613","rid":"SV-83285r1_rule","stig_id":"WDNS-CM-000021","gtitle":"SRG-APP-000516-DNS-000101","fix_id":"F-63997r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83287","code":"control 'SV-83287' do\n  title 'The Windows 2008 DNS Server authoritative for local zones must only point root hints to the DNS servers that host the internal root domain.'\n  desc \"All caching name servers must be authoritative for the root zone because, without this starting point, they would have no knowledge of the DNS infrastructure and thus would be unable to respond to any queries. The security risk is that an adversary could change the root hints and direct the caching name server to a bogus root server. At that point, every query response from that name server is suspect, which would give the adversary substantial control over the network communication of the name servers' clients. When authoritative servers are sent queries for zones that they are not authoritative for, and they are configured as a non-caching server (as recommended), they can either be configured to return a referral to the root servers or they can be configured to refuse to answer the query. The recommendation is to configure authoritative servers to refuse to answer queries for any zones for which they are not authoritative. This is more efficient for the server and allows it to spend more of its resources doing what its intended purpose is, answering authoritatively for its zone.\"\n  desc 'check', 'Note: If the Windows DNS server is in the classified network, this check is Not Applicable.\nLog on to the authoritative DNS server using the Domain Admin or Enterprise Admin account.\nPress Windows Key + R, execute dnsmgmt.msc.\nRight-click the DNS server, select “Properties”.\nSelect the \"Root Hints\" tab.\nVerify the \"Root Hints\" is either empty or only has entries for internal zones under \"Name servers:\". All Internet root server entries must be removed.\nIf \"Root Hints\" is not empty or entries on the \"Root Hints\" tab under \"Name servers:\" are external to the local network, this is a finding.'\n  desc 'fix', 'Log on to the authoritative DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\nRight-click the DNS server, select \"Properties\".\nSelect the \"Root Hints\" tab.\nRemove the root hints from the DNS Manager, the CACHE.DNS file and from Active Directory for name servers outside of the internal network. \nReplace the existing root hints with new root hints of internal servers. \nIf the DNS server is forwarding, click to select the : \"Do not use recursion for this domain\" check box on the \"Forwarders\" tab in DNS Manager to make sure that the root hints will not be used.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59487r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58615'\n  tag rid: 'SV-83287r1_rule'\n  tag stig_id: 'WDNS-CM-000022'\n  tag gtitle: 'SRG-APP-000516-DNS-000102'\n  tag fix_id: 'F-63999r3_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83287.rb"},"title":"The Windows 2008 DNS Server authoritative for local zones must only point root hints to the DNS servers that host the internal root domain.","desc":"All caching name servers must be authoritative for the root zone because, without this starting point, they would have no knowledge of the DNS infrastructure and thus would be unable to respond to any queries. The security risk is that an adversary could change the root hints and direct the caching name server to a bogus root server. At that point, every query response from that name server is suspect, which would give the adversary substantial control over the network communication of the name servers' clients. When authoritative servers are sent queries for zones that they are not authoritative for, and they are configured as a non-caching server (as recommended), they can either be configured to return a referral to the root servers or they can be configured to refuse to answer the query. The recommendation is to configure authoritative servers to refuse to answer queries for any zones for which they are not authoritative. This is more efficient for the server and allows it to spend more of its resources doing what its intended purpose is, answering authoritatively for its zone.","descriptions":{"default":"All caching name servers must be authoritative for the root zone because, without this starting point, they would have no knowledge of the DNS infrastructure and thus would be unable to respond to any queries. The security risk is that an adversary could change the root hints and direct the caching name server to a bogus root server. At that point, every query response from that name server is suspect, which would give the adversary substantial control over the network communication of the name servers' clients. When authoritative servers are sent queries for zones that they are not authoritative for, and they are configured as a non-caching server (as recommended), they can either be configured to return a referral to the root servers or they can be configured to refuse to answer the query. The recommendation is to configure authoritative servers to refuse to answer queries for any zones for which they are not authoritative. This is more efficient for the server and allows it to spend more of its resources doing what its intended purpose is, answering authoritatively for its zone.","check":"Note: If the Windows DNS server is in the classified network, this check is Not Applicable.\nLog on to the authoritative DNS server using the Domain Admin or Enterprise Admin account.\nPress Windows Key + R, execute dnsmgmt.msc.\nRight-click the DNS server, select “Properties”.\nSelect the \"Root Hints\" tab.\nVerify the \"Root Hints\" is either empty or only has entries for internal zones under \"Name servers:\". All Internet root server entries must be removed.\nIf \"Root Hints\" is not empty or entries on the \"Root Hints\" tab under \"Name servers:\" are external to the local network, this is a finding.","fix":"Log on to the authoritative DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\nRight-click the DNS server, select \"Properties\".\nSelect the \"Root Hints\" tab.\nRemove the root hints from the DNS Manager, the CACHE.DNS file and from Active Directory for name servers outside of the internal network. \nReplace the existing root hints with new root hints of internal servers. \nIf the DNS server is forwarding, click to select the : \"Do not use recursion for this domain\" check box on the \"Forwarders\" tab in DNS Manager to make sure that the root hints will not be used."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59487r4_chk","severity":"medium","gid":"V-58615","rid":"SV-83287r1_rule","stig_id":"WDNS-CM-000022","gtitle":"SRG-APP-000516-DNS-000102","fix_id":"F-63999r3_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83289","code":"control 'SV-83289' do\n  title 'The DNS name server software must be at the latest version.'\n  desc 'Each newer version of the name server software, especially the BIND software, generally is devoid of vulnerabilities found in earlier versions because it has design changes incorporated to take care of those vulnerabilities. These vulnerabilities have been exploited (i.e., some form of attack was launched), and sufficient information has been generated with respect to the nature of those exploits. It makes good business sense to run the latest version of name server software because theoretically it is the safest version. Even if the software is the latest version, it is not safe to run it in default mode. The security administrator should always configure the software to run in the recommended secure mode of operation after becoming familiar with the new security settings for the latest version.'\n  desc 'check', 'Consult with the network IAVM scanner to confirm all Microsoft Operating System IAVMs have been applied to the Windows DNS server.\n\nIf all Microsoft Operating System IAVMs have not been applied to the DNS server, this is a finding.'\n  desc 'fix', 'Apply all related Microsoft Operating System IAVM patches to the DNS server.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59489r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58617'\n  tag rid: 'SV-83289r1_rule'\n  tag stig_id: 'WDNS-CM-000023'\n  tag gtitle: 'SRG-APP-000516-DNS-000103'\n  tag fix_id: 'F-64001r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83289.rb"},"title":"The DNS name server software must be at the latest version.","desc":"Each newer version of the name server software, especially the BIND software, generally is devoid of vulnerabilities found in earlier versions because it has design changes incorporated to take care of those vulnerabilities. These vulnerabilities have been exploited (i.e., some form of attack was launched), and sufficient information has been generated with respect to the nature of those exploits. It makes good business sense to run the latest version of name server software because theoretically it is the safest version. Even if the software is the latest version, it is not safe to run it in default mode. The security administrator should always configure the software to run in the recommended secure mode of operation after becoming familiar with the new security settings for the latest version.","descriptions":{"default":"Each newer version of the name server software, especially the BIND software, generally is devoid of vulnerabilities found in earlier versions because it has design changes incorporated to take care of those vulnerabilities. These vulnerabilities have been exploited (i.e., some form of attack was launched), and sufficient information has been generated with respect to the nature of those exploits. It makes good business sense to run the latest version of name server software because theoretically it is the safest version. Even if the software is the latest version, it is not safe to run it in default mode. The security administrator should always configure the software to run in the recommended secure mode of operation after becoming familiar with the new security settings for the latest version.","check":"Consult with the network IAVM scanner to confirm all Microsoft Operating System IAVMs have been applied to the Windows DNS server.\n\nIf all Microsoft Operating System IAVMs have not been applied to the DNS server, this is a finding.","fix":"Apply all related Microsoft Operating System IAVM patches to the DNS server."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59489r3_chk","severity":"medium","gid":"V-58617","rid":"SV-83289r1_rule","stig_id":"WDNS-CM-000023","gtitle":"SRG-APP-000516-DNS-000103","fix_id":"F-64001r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83291","code":"control 'SV-83291' do\n  title 'The Windows 2008 DNS Servers zone files must not include CNAME records pointing to a zone with lesser security for more than six months.'\n  desc \"The use of CNAME records for exercises, tests, or zone-spanning aliases should be temporary (e.g., to facilitate a migration). When a host name is an alias for a record in another zone, an adversary has two points of attack: the zone in which the alias is defined and the zone authoritative for the alias's canonical name. This configuration also reduces the speed of client resolution because it requires a second lookup after obtaining the canonical name. Furthermore, in the case of an authoritative name server, this information is promulgated throughout the enterprise to caching servers and thus compounds the vulnerability.\"\n  desc 'check', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nReview the RRs to confirm that there are no CNAME records older than 6 months.\n\nThe exceptions are glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms. In the case of third-party CDNs or cloud offerings, an approved mission need must be demonstrated (AO approval of use of a commercial cloud offering would satisfy this requirement). Additional exceptions are CNAME records in a multi-domain Active Directory environment pointing to hosts in other internal domains in the same multi-domain environment.\n\nIf there are zone-spanning CNAME records older than 6 months and the CNAME records resolve to anything other than fully qualified domain names for glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms with an AO-approved and documented mission need, this is a finding.'\n  desc 'fix', 'Remove any zone-spanning CNAME records that have been active for more than six months, which are not supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms.\n\nIn the case of third-party CDNs or cloud offerings, an approved mission need must be demonstrated (AO approval of use of a commercial cloud offering would satisfy this requirement).'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59493r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58621'\n  tag rid: 'SV-83291r1_rule'\n  tag stig_id: 'WDNS-CM-000025'\n  tag gtitle: 'SRG-APP-000516-DNS-000114'\n  tag fix_id: 'F-64005r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83291.rb"},"title":"The Windows 2008 DNS Servers zone files must not include CNAME records pointing to a zone with lesser security for more than six months.","desc":"The use of CNAME records for exercises, tests, or zone-spanning aliases should be temporary (e.g., to facilitate a migration). When a host name is an alias for a record in another zone, an adversary has two points of attack: the zone in which the alias is defined and the zone authoritative for the alias's canonical name. This configuration also reduces the speed of client resolution because it requires a second lookup after obtaining the canonical name. Furthermore, in the case of an authoritative name server, this information is promulgated throughout the enterprise to caching servers and thus compounds the vulnerability.","descriptions":{"default":"The use of CNAME records for exercises, tests, or zone-spanning aliases should be temporary (e.g., to facilitate a migration). When a host name is an alias for a record in another zone, an adversary has two points of attack: the zone in which the alias is defined and the zone authoritative for the alias's canonical name. This configuration also reduces the speed of client resolution because it requires a second lookup after obtaining the canonical name. Furthermore, in the case of an authoritative name server, this information is promulgated throughout the enterprise to caching servers and thus compounds the vulnerability.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nReview the RRs to confirm that there are no CNAME records older than 6 months.\n\nThe exceptions are glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms. In the case of third-party CDNs or cloud offerings, an approved mission need must be demonstrated (AO approval of use of a commercial cloud offering would satisfy this requirement). Additional exceptions are CNAME records in a multi-domain Active Directory environment pointing to hosts in other internal domains in the same multi-domain environment.\n\nIf there are zone-spanning CNAME records older than 6 months and the CNAME records resolve to anything other than fully qualified domain names for glue records supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms with an AO-approved and documented mission need, this is a finding.","fix":"Remove any zone-spanning CNAME records that have been active for more than six months, which are not supporting zone delegations, CNAME records supporting a system migration, or CNAME records that point to third-party Content Delivery Networks (CDN) or cloud computing platforms.\n\nIn the case of third-party CDNs or cloud offerings, an approved mission need must be demonstrated (AO approval of use of a commercial cloud offering would satisfy this requirement)."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59493r2_chk","severity":"medium","gid":"V-58621","rid":"SV-83291r1_rule","stig_id":"WDNS-CM-000025","gtitle":"SRG-APP-000516-DNS-000114","fix_id":"F-64005r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83293","code":"control 'SV-83293' do\n  title 'Non-routable IPv6 link-local scope addresses must not be configured in any zone.'\n  desc 'IPv6 link-local scope addresses are not globally routable and must not be configured in any DNS zone.  Similar to RFC1918 addresses, if a link-local scope address is inserted into a zone provided to clients, most routers will not forward this traffic beyond the local subnet.'\n  desc 'check', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nExpand the Forward Lookup Zones folder.\n\nExpand each zone folder and examine the host record entries. The third column titled “Data” will display the IP.\n\nVerify this column does not contain any IP addresses that begin with the prefixes \"FE8\", \"FE9\", \"FEA\", or \"FEB\".\n\nIf any non-routable IPv6 link-local scope addresses are in any zone, this is a finding.'\n  desc 'fix', 'The SA should remove any link-local addresses and replace with appropriate Site-Local or Global scope addresses.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59495r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58623'\n  tag rid: 'SV-83293r1_rule'\n  tag stig_id: 'WDNS-CM-000026'\n  tag gtitle: 'SRG-APP-000516-DNS-000500'\n  tag fix_id: 'F-64007r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83293.rb"},"title":"Non-routable IPv6 link-local scope addresses must not be configured in any zone.","desc":"IPv6 link-local scope addresses are not globally routable and must not be configured in any DNS zone.  Similar to RFC1918 addresses, if a link-local scope address is inserted into a zone provided to clients, most routers will not forward this traffic beyond the local subnet.","descriptions":{"default":"IPv6 link-local scope addresses are not globally routable and must not be configured in any DNS zone.  Similar to RFC1918 addresses, if a link-local scope address is inserted into a zone provided to clients, most routers will not forward this traffic beyond the local subnet.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, click to select the zone.\n\nExpand the Forward Lookup Zones folder.\n\nExpand each zone folder and examine the host record entries. The third column titled “Data” will display the IP.\n\nVerify this column does not contain any IP addresses that begin with the prefixes \"FE8\", \"FE9\", \"FEA\", or \"FEB\".\n\nIf any non-routable IPv6 link-local scope addresses are in any zone, this is a finding.","fix":"The SA should remove any link-local addresses and replace with appropriate Site-Local or Global scope addresses."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59495r4_chk","severity":"medium","gid":"V-58623","rid":"SV-83293r1_rule","stig_id":"WDNS-CM-000026","gtitle":"SRG-APP-000516-DNS-000500","fix_id":"F-64007r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83295","code":"control 'SV-83295' do\n  title 'AAAA addresses must not be configured in a zone for hosts that are not IPv6-aware.'\n  desc 'DNS is only responsible for resolving a domain name to an IP address.  Applications and operating systems are responsible for processing the IPv6 or IPv4 record that may be returned.  With this in mind, a denial of service could easily be implemented for an application that is not IPv6-aware.  When the application receives an IP address in hexadecimal, it is up to the application/operating system to decide how to handle the response.  Combining both IPv6 and IPv4 records into the same domain can lead to application problems that are beyond the scope of the DNS administrator.'\n  desc 'check', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, select each zone and examine the host record entries. The third column titled “Data” will display the IP.\n\nVerify if any contain both IPv4 and IPv6 addresses.\n\nIf any hostnames contain both IPv4 and IPv6 addresses, confirm with the SA that the actual hosts are IPv6-aware.\n\nIf any zone contains hosts with both IPv4 and IPv6 addresses but are determined to be non-IPv6-aware, this is a finding.'\n  desc 'fix', 'Remove any IPv6 records for hosts which are not IPv6-aware.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59497r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58625'\n  tag rid: 'SV-83295r1_rule'\n  tag stig_id: 'WDNS-CM-000027'\n  tag gtitle: 'SRG-APP-000516-DNS-000500'\n  tag fix_id: 'F-64009r2_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83295.rb"},"title":"AAAA addresses must not be configured in a zone for hosts that are not IPv6-aware.","desc":"DNS is only responsible for resolving a domain name to an IP address.  Applications and operating systems are responsible for processing the IPv6 or IPv4 record that may be returned.  With this in mind, a denial of service could easily be implemented for an application that is not IPv6-aware.  When the application receives an IP address in hexadecimal, it is up to the application/operating system to decide how to handle the response.  Combining both IPv6 and IPv4 records into the same domain can lead to application problems that are beyond the scope of the DNS administrator.","descriptions":{"default":"DNS is only responsible for resolving a domain name to an IP address.  Applications and operating systems are responsible for processing the IPv6 or IPv4 record that may be returned.  With this in mind, a denial of service could easily be implemented for an application that is not IPv6-aware.  When the application receives an IP address in hexadecimal, it is up to the application/operating system to decide how to handle the response.  Combining both IPv6 and IPv4 records into the same domain can lead to application problems that are beyond the scope of the DNS administrator.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nPress Windows Key + R, execute dnsmgmt.msc.\n\nOn the opened DNS Manager snap-in from the left pane, expand the server name for the DNS server, and then expand Forward Lookup Zones.\n\nFrom the expanded list, select each zone and examine the host record entries. The third column titled “Data” will display the IP.\n\nVerify if any contain both IPv4 and IPv6 addresses.\n\nIf any hostnames contain both IPv4 and IPv6 addresses, confirm with the SA that the actual hosts are IPv6-aware.\n\nIf any zone contains hosts with both IPv4 and IPv6 addresses but are determined to be non-IPv6-aware, this is a finding.","fix":"Remove any IPv6 records for hosts which are not IPv6-aware."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59497r2_chk","severity":"medium","gid":"V-58625","rid":"SV-83295r1_rule","stig_id":"WDNS-CM-000027","gtitle":"SRG-APP-000516-DNS-000500","fix_id":"F-64009r2_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-83297","code":"control 'SV-83297' do\n  title 'When IPv6 protocol is installed, the server must also be configured to answer for IPv6 AAAA records.'\n  desc 'To prevent the possibility of a denial of service in relation to an IPv4 DNS server trying to respond to IPv6 requests, the server should be configured not to listen on any of its IPv6 interfaces unless it does contain IPv6 AAAA resource records in one of the zones.'\n  desc 'check', 'Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nFrom a command prompt, run regedit. \nIn the User Account Control dialog box, click Continue. \nIn Registry Editor, locate and then click the following registry subkey: \nHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\Tcpip6\\\\Parameters \\\\\nVerify the value for “DisabledComponents” is “255 (0xff)”.\n\nIf the “DisabledComponents” entry is nonexistent, this is a finding.\n\nIf the “DisabledComponents” exists but is not set to “255 (0xff)”, and the DNS server is not hosting any AAAA records, this is a finding.'\n  desc 'fix', 'Log onto the DNS server.\n\nAccess Group Policy Management.\n\nEdit Default Domain Policy, go to Computer Configuration >> Policies >> Administrative Templates >> Network >> IPv6 Configuration, Open IPv6 Configuration Policy and set on “Disable all IPv6 components”.\n\nAs an alternative to using the GPO setting, the registry setting may also be altered directly to reflect:\nHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\Tcpip6\\\\Parameters \\\\\nSet the value for “DisabledComponents” to “255 (0xff)”.'\n  impact 0.5\n  ref 'DPMS Target Windows 2008 DNS'\n  ref 'DPMS Target Windows 2008 R2 DNS'\n  tag check_id: 'C-59499r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-58627'\n  tag rid: 'SV-83297r3_rule'\n  tag stig_id: 'WDNS-CM-000028'\n  tag gtitle: 'SRG-APP-000516-DNS-000500'\n  tag fix_id: 'F-64011r4_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_Windows_2008_Server_Domain_Name_System_V1R8/controls/SV-83297.rb"},"title":"When IPv6 protocol is installed, the server must also be configured to answer for IPv6 AAAA records.","desc":"To prevent the possibility of a denial of service in relation to an IPv4 DNS server trying to respond to IPv6 requests, the server should be configured not to listen on any of its IPv6 interfaces unless it does contain IPv6 AAAA resource records in one of the zones.","descriptions":{"default":"To prevent the possibility of a denial of service in relation to an IPv4 DNS server trying to respond to IPv6 requests, the server should be configured not to listen on any of its IPv6 interfaces unless it does contain IPv6 AAAA resource records in one of the zones.","check":"Log on to the DNS server using the Domain Admin or Enterprise Admin account.\n\nFrom a command prompt, run regedit. \nIn the User Account Control dialog box, click Continue. \nIn Registry Editor, locate and then click the following registry subkey: \nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters \\\nVerify the value for “DisabledComponents” is “255 (0xff)”.\n\nIf the “DisabledComponents” entry is nonexistent, this is a finding.\n\nIf the “DisabledComponents” exists but is not set to “255 (0xff)”, and the DNS server is not hosting any AAAA records, this is a finding.","fix":"Log onto the DNS server.\n\nAccess Group Policy Management.\n\nEdit Default Domain Policy, go to Computer Configuration >> Policies >> Administrative Templates >> Network >> IPv6 Configuration, Open IPv6 Configuration Policy and set on “Disable all IPv6 components”.\n\nAs an alternative to using the GPO setting, the registry setting may also be altered directly to reflect:\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters \\\nSet the value for “DisabledComponents” to “255 (0xff)”."},"impact":0.5,"refs":[{"ref":"DPMS Target Windows 2008 DNS"},{"ref":"DPMS Target Windows 2008 R2 DNS"}],"tags":{"check_id":"C-59499r4_chk","severity":"medium","gid":"V-58627","rid":"SV-83297r3_rule","stig_id":"WDNS-CM-000028","gtitle":"SRG-APP-000516-DNS-000500","fix_id":"F-64011r4_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}}],"groups":[{"id":"controls/SV-29338.rb","title":null,"controls":["SV-29338"]},{"id":"controls/SV-83197.rb","title":null,"controls":["SV-83197"]},{"id":"controls/SV-83199.rb","title":null,"controls":["SV-83199"]},{"id":"controls/SV-83201.rb","title":null,"controls":["SV-83201"]},{"id":"controls/SV-83203.rb","title":null,"controls":["SV-83203"]},{"id":"controls/SV-83205.rb","title":null,"controls":["SV-83205"]},{"id":"controls/SV-83207.rb","title":null,"controls":["SV-83207"]},{"id":"controls/SV-83209.rb","title":null,"controls":["SV-83209"]},{"id":"controls/SV-83211.rb","title":null,"controls":["SV-83211"]},{"id":"controls/SV-83213.rb","title":null,"controls":["SV-83213"]},{"id":"controls/SV-83215.rb","title":null,"controls":["SV-83215"]},{"id":"controls/SV-83217.rb","title":null,"controls":["SV-83217"]},{"id":"controls/SV-83219.rb","title":null,"controls":["SV-83219"]},{"id":"controls/SV-83221.rb","title":null,"controls":["SV-83221"]},{"id":"controls/SV-83223.rb","title":null,"controls":["SV-83223"]},{"id":"controls/SV-83225.rb","title":null,"controls":["SV-83225"]},{"id":"controls/SV-83227.rb","title":null,"controls":["SV-83227"]},{"id":"controls/SV-83229.rb","title":null,"controls":["SV-83229"]},{"id":"controls/SV-83231.rb","title":null,"controls":["SV-83231"]},{"id":"controls/SV-83233.rb","title":null,"controls":["SV-83233"]},{"id":"controls/SV-83235.rb","title":null,"controls":["SV-83235"]},{"id":"controls/SV-83237.rb","title":null,"controls":["SV-83237"]},{"id":"controls/SV-83239.rb","title":null,"controls":["SV-83239"]},{"id":"controls/SV-83241.rb","title":null,"controls":["SV-83241"]},{"id":"controls/SV-83243.rb","title":null,"controls":["SV-83243"]},{"id":"controls/SV-83245.rb","title":null,"controls":["SV-83245"]},{"id":"controls/SV-83247.rb","title":null,"controls":["SV-83247"]},{"id":"controls/SV-83249.rb","title":null,"controls":["SV-83249"]},{"id":"controls/SV-83251.rb","title":null,"controls":["SV-83251"]},{"id":"controls/SV-83255.rb","title":null,"controls":["SV-83255"]},{"id":"controls/SV-83271.rb","title":null,"controls":["SV-83271"]},{"id":"controls/SV-83273.rb","title":null,"controls":["SV-83273"]},{"id":"controls/SV-83275.rb","title":null,"controls":["SV-83275"]},{"id":"controls/SV-83277.rb","title":null,"controls":["SV-83277"]},{"id":"controls/SV-83279.rb","title":null,"controls":["SV-83279"]},{"id":"controls/SV-83281.rb","title":null,"controls":["SV-83281"]},{"id":"controls/SV-83283.rb","title":null,"controls":["SV-83283"]},{"id":"controls/SV-83285.rb","title":null,"controls":["SV-83285"]},{"id":"controls/SV-83287.rb","title":null,"controls":["SV-83287"]},{"id":"controls/SV-83289.rb","title":null,"controls":["SV-83289"]},{"id":"controls/SV-83291.rb","title":null,"controls":["SV-83291"]},{"id":"controls/SV-83293.rb","title":null,"controls":["SV-83293"]},{"id":"controls/SV-83295.rb","title":null,"controls":["SV-83295"]},{"id":"controls/SV-83297.rb","title":null,"controls":["SV-83297"]}],"name":"Microsoft_Windows_2008_Server_Domain_Name_System_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"762465fe6cb6ccf42dc452462aa655d225dc1fc039b0ba17ec412e1584546bd8","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
