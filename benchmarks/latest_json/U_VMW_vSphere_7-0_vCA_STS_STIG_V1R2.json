{"controls":[{"id":"SV-256745","code":"control 'SV-256745' do\n  title 'The Security Token Service must limit the amount of time that each Transmission Control Protocol (TCP) connection is kept alive.'\n  desc 'Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests.  \n \nIn Tomcat, the \"connectionTimeout\" attribute sets the number of milliseconds the server will wait after accepting a connection for the requested Uniform Resource Identifier (URI) line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.'\n  desc 'check', %q(At the command prompt, run the following command: \n \n#  xmllint --xpath '/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@connectionTimeout' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \nconnectionTimeout=\"60000\" \n \nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to each of the <Connector> nodes. \n \nConfigure each <Connector> node with the value: \n \nconnectionTimeout=\"60000\" \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60420r889203_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256745'\n  tag rid: 'SV-256745r889205_rule'\n  tag stig_id: 'VCST-70-000001'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag fix_id: 'F-60363r889204_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256745.rb"},"title":"The Security Token Service must limit the amount of time that each Transmission Control Protocol (TCP) connection is kept alive.","desc":"Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests.  \n \nIn Tomcat, the \"connectionTimeout\" attribute sets the number of milliseconds the server will wait after accepting a connection for the requested Uniform Resource Identifier (URI) line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.","descriptions":{"default":"Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests.  \n \nIn Tomcat, the \"connectionTimeout\" attribute sets the number of milliseconds the server will wait after accepting a connection for the requested Uniform Resource Identifier (URI) line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.","check":"At the command prompt, run the following command: \n \n#  xmllint --xpath '/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@connectionTimeout' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \nconnectionTimeout=\"60000\" \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to each of the <Connector> nodes. \n \nConfigure each <Connector> node with the value: \n \nconnectionTimeout=\"60000\" \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60420r889203_chk","severity":"medium","gid":"V-256745","rid":"SV-256745r889205_rule","stig_id":"VCST-70-000001","gtitle":"SRG-APP-000001-WSR-000001","fix_id":"F-60363r889204_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-256746","code":"control 'SV-256746' do\n  title 'The Security Token Service must limit the number of concurrent connections permitted.'\n  desc 'Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash. \n \nMitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the \"maxThreads\" attribute.'\n  desc 'check', %q(At the command prompt, run the following command: \n \n# xmllint --xpath '/Server/Service/Executor[@name=\"tomcatThreadPool\"]/@maxThreads' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \nmaxThreads=\"150\" \n \nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to the <Executor> mode with the name of \"tomcatThreadPool\" and configure with the value 'maxThreads=\"150\"' as follows: \n \n<Executor maxThreads=\"150\" minSpareThreads=\"50\" name=\"tomcatThreadPool\" namePrefix=\"tomcat-http--\" /> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts)\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60421r889206_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256746'\n  tag rid: 'SV-256746r889208_rule'\n  tag stig_id: 'VCST-70-000002'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag fix_id: 'F-60364r889207_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256746.rb"},"title":"The Security Token Service must limit the number of concurrent connections permitted.","desc":"Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash. \n \nMitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the \"maxThreads\" attribute.","descriptions":{"default":"Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash. \n \nMitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the \"maxThreads\" attribute.","check":"At the command prompt, run the following command: \n \n# xmllint --xpath '/Server/Service/Executor[@name=\"tomcatThreadPool\"]/@maxThreads' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \nmaxThreads=\"150\" \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to the <Executor> mode with the name of \"tomcatThreadPool\" and configure with the value 'maxThreads=\"150\"' as follows: \n \n<Executor maxThreads=\"150\" minSpareThreads=\"50\" name=\"tomcatThreadPool\" namePrefix=\"tomcat-http--\" /> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60421r889206_chk","severity":"medium","gid":"V-256746","rid":"SV-256746r889208_rule","stig_id":"VCST-70-000002","gtitle":"SRG-APP-000001-WSR-000001","fix_id":"F-60364r889207_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-256747","code":"control 'SV-256747' do\n  title 'The Security Token Service must limit the maximum size of a POST request.'\n  desc 'The \"maxPostSize\" value is the maximum size in bytes of the POST that will be handled by the container FORM URL parameter parsing. Limit its size to reduce exposure to a denial-of-service (DoS) attack. \n \nIf \"maxPostSize\" is not set, the default value of 2097152 (2MB) is used. Security Token Service is configured in its shipping state to not set a value for \"maxPostSize\".'\n  desc 'check', %q(At the command prompt, run the following command: \n \n# xmllint --xpath '/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@maxPostSize' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \nXPath set is empty \n \nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to each of the <Connector> nodes. \n \nRemove any configuration for \"maxPostSize\". \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60422r889209_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256747'\n  tag rid: 'SV-256747r889211_rule'\n  tag stig_id: 'VCST-70-000003'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag fix_id: 'F-60365r889210_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256747.rb"},"title":"The Security Token Service must limit the maximum size of a POST request.","desc":"The \"maxPostSize\" value is the maximum size in bytes of the POST that will be handled by the container FORM URL parameter parsing. Limit its size to reduce exposure to a denial-of-service (DoS) attack. \n \nIf \"maxPostSize\" is not set, the default value of 2097152 (2MB) is used. Security Token Service is configured in its shipping state to not set a value for \"maxPostSize\".","descriptions":{"default":"The \"maxPostSize\" value is the maximum size in bytes of the POST that will be handled by the container FORM URL parameter parsing. Limit its size to reduce exposure to a denial-of-service (DoS) attack. \n \nIf \"maxPostSize\" is not set, the default value of 2097152 (2MB) is used. Security Token Service is configured in its shipping state to not set a value for \"maxPostSize\".","check":"At the command prompt, run the following command: \n \n# xmllint --xpath '/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@maxPostSize' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \nXPath set is empty \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to each of the <Connector> nodes. \n \nRemove any configuration for \"maxPostSize\". \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60422r889209_chk","severity":"medium","gid":"V-256747","rid":"SV-256747r889211_rule","stig_id":"VCST-70-000003","gtitle":"SRG-APP-000001-WSR-000001","fix_id":"F-60365r889210_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-256748","code":"control 'SV-256748' do\n  title 'The Security Token Service must protect cookies from cross-site scripting (XSS).'\n  desc 'Cookies are a common way to save session state over the HTTP(S) protocol. If an attacker can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. \n \nWhen a cookie is tagged with the \"HttpOnly\" flag, it tells the browser that this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.\n\n'\n  desc 'check', %q(At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/http-only' - \n \nExpected result: \n \n<http-only>true</http-only> \n \nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nNavigate to the <session-config> node and configure it as follows: \n \n<session-config> \n        <session-timeout>30</session-timeout> \n        <cookie-config> \n            <http-only>true</http-only> \n            <secure>true</secure> \n       </cookie-config> \n</session-config> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60423r889212_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256748'\n  tag rid: 'SV-256748r889214_rule'\n  tag stig_id: 'VCST-70-000004'\n  tag gtitle: 'SRG-APP-000001-WSR-000002'\n  tag fix_id: 'F-60366r889213_fix'\n  tag satisfies: ['SRG-APP-000001-WSR-000002', 'SRG-APP-000223-WSR-000011', 'SRG-APP-000439-WSR-000154']\n  tag 'documentable'\n  tag cci: ['CCI-000054', 'CCI-001664', 'CCI-002418']\n  tag nist: ['AC-10', 'SC-23 (3)', 'SC-8']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256748.rb"},"title":"The Security Token Service must protect cookies from cross-site scripting (XSS).","desc":"Cookies are a common way to save session state over the HTTP(S) protocol. If an attacker can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. \n \nWhen a cookie is tagged with the \"HttpOnly\" flag, it tells the browser that this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.\n\n","descriptions":{"default":"Cookies are a common way to save session state over the HTTP(S) protocol. If an attacker can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. \n \nWhen a cookie is tagged with the \"HttpOnly\" flag, it tells the browser that this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.\n\n","check":"At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/http-only' - \n \nExpected result: \n \n<http-only>true</http-only> \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nNavigate to the <session-config> node and configure it as follows: \n \n<session-config> \n        <session-timeout>30</session-timeout> \n        <cookie-config> \n            <http-only>true</http-only> \n            <secure>true</secure> \n       </cookie-config> \n</session-config> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60423r889212_chk","severity":"medium","gid":"V-256748","rid":"SV-256748r889214_rule","stig_id":"VCST-70-000004","gtitle":"SRG-APP-000001-WSR-000002","fix_id":"F-60366r889213_fix","satisfies":["SRG-APP-000001-WSR-000002","SRG-APP-000223-WSR-000011","SRG-APP-000439-WSR-000154"],"documentable":null,"cci":["CCI-000054","CCI-001664","CCI-002418"],"nist":["AC-10","SC-23 (3)","SC-8"]}},{"id":"SV-256749","code":"control 'SV-256749' do\n  title 'The Security Token Service must record user access in a format that enables monitoring of remote access.'\n  desc %q(Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success. \n \nTomcat can be configured with an \"AccessLogValve\", a component that can be inserted into the request processing pipeline to provide robust access logging. The \"AccessLogValve\" creates log files in the same format as those created by standard web servers. When \"AccessLogValve\" is properly configured, log files will contain all the forensic information necessary in the case of a security incident.\n\n)\n  desc 'check', %q(At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]/@pattern' - \n \nExpected result: \n \npattern=\"%t %I [RemoteIP] %{X-Forwarded-For}i %u [Request] %h:%{remote}p to local %{local}p - %H %m %U%q    [Response] %s - %b bytes    [Perf] process %Dms / commit %Fms / conn [%X]\" \n \nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nInside the <Host> node, find the \"AccessLogValve\" <Valve> node and replace the \"pattern\" element as follows: \n \npattern=\"%t %I [RemoteIP] %{X-Forwarded-For}i %u [Request] %h:%{remote}p to local %{local}p - %H %m %U%q    [Response] %s - %b bytes    [Perf] process %Dms / commit %Fms / conn [%X]\" \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60424r889215_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256749'\n  tag rid: 'SV-256749r889217_rule'\n  tag stig_id: 'VCST-70-000005'\n  tag gtitle: 'SRG-APP-000016-WSR-000005'\n  tag fix_id: 'F-60367r889216_fix'\n  tag satisfies: ['SRG-APP-000016-WSR-000005', 'SRG-APP-000093-WSR-000053', 'SRG-APP-000095-WSR-000056', 'SRG-APP-000096-WSR-000057', 'SRG-APP-000097-WSR-000058', 'SRG-APP-000098-WSR-000059', 'SRG-APP-000098-WSR-000060', 'SRG-APP-000099-WSR-000061', 'SRG-APP-000100-WSR-000064', 'SRG-APP-000374-WSR-000172', 'SRG-APP-000375-WSR-000171']\n  tag 'documentable'\n  tag cci: ['CCI-000067', 'CCI-000130', 'CCI-000131', 'CCI-000132', 'CCI-000133', 'CCI-000134', 'CCI-001462', 'CCI-001487', 'CCI-001889', 'CCI-001890']\n  tag nist: ['AC-17 (1)', 'AU-3 a', 'AU-3 b', 'AU-3 c', 'AU-3 d', 'AU-3 e', 'AU-14 (2)', 'AU-3 f', 'AU-8 b', 'AU-8 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256749.rb"},"title":"The Security Token Service must record user access in a format that enables monitoring of remote access.","desc":"Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success. \n \nTomcat can be configured with an \"AccessLogValve\", a component that can be inserted into the request processing pipeline to provide robust access logging. The \"AccessLogValve\" creates log files in the same format as those created by standard web servers. When \"AccessLogValve\" is properly configured, log files will contain all the forensic information necessary in the case of a security incident.\n\n","descriptions":{"default":"Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success. \n \nTomcat can be configured with an \"AccessLogValve\", a component that can be inserted into the request processing pipeline to provide robust access logging. The \"AccessLogValve\" creates log files in the same format as those created by standard web servers. When \"AccessLogValve\" is properly configured, log files will contain all the forensic information necessary in the case of a security incident.\n\n","check":"At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/server.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]/@pattern' - \n \nExpected result: \n \npattern=\"%t %I [RemoteIP] %{X-Forwarded-For}i %u [Request] %h:%{remote}p to local %{local}p - %H %m %U%q    [Response] %s - %b bytes    [Perf] process %Dms / commit %Fms / conn [%X]\" \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nInside the <Host> node, find the \"AccessLogValve\" <Valve> node and replace the \"pattern\" element as follows: \n \npattern=\"%t %I [RemoteIP] %{X-Forwarded-For}i %u [Request] %h:%{remote}p to local %{local}p - %H %m %U%q    [Response] %s - %b bytes    [Perf] process %Dms / commit %Fms / conn [%X]\" \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60424r889215_chk","severity":"medium","gid":"V-256749","rid":"SV-256749r889217_rule","stig_id":"VCST-70-000005","gtitle":"SRG-APP-000016-WSR-000005","fix_id":"F-60367r889216_fix","satisfies":["SRG-APP-000016-WSR-000005","SRG-APP-000093-WSR-000053","SRG-APP-000095-WSR-000056","SRG-APP-000096-WSR-000057","SRG-APP-000097-WSR-000058","SRG-APP-000098-WSR-000059","SRG-APP-000098-WSR-000060","SRG-APP-000099-WSR-000061","SRG-APP-000100-WSR-000064","SRG-APP-000374-WSR-000172","SRG-APP-000375-WSR-000171"],"documentable":null,"cci":["CCI-000067","CCI-000130","CCI-000131","CCI-000132","CCI-000133","CCI-000134","CCI-001462","CCI-001487","CCI-001889","CCI-001890"],"nist":["AC-17 (1)","AU-3 a","AU-3 b","AU-3 c","AU-3 d","AU-3 e","AU-14 (2)","AU-3 f","AU-8 b","AU-8 b"]}},{"id":"SV-256750","code":"control 'SV-256750' do\n  title 'The Security Token Service must generate log records during Java startup and shutdown.'\n  desc 'Logging must be started as soon as possible when a service starts and as late as possible when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.\n\n'\n  desc 'check', 'At the command prompt, run the following command:\n\n# grep \"1catalina.org.apache.juli.FileHandler\" /usr/lib/vmware-sso/vmware-sts/conf/logging.properties\n\nExpected result:\n\nhandlers = 1catalina.org.apache.juli.FileHandler, 2localhost.org.apache.juli.FileHandler, 3manager.org.apache.juli.FileHandler, 4host-manager.org.apache.juli.FileHandler\n.handlers = 1catalina.org.apache.juli.FileHandler\n1catalina.org.apache.juli.FileHandler.level = FINE\n1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs/tomcat\n1catalina.org.apache.juli.FileHandler.prefix = catalina.\n1catalina.org.apache.juli.FileHandler.bufferSize = -1\n1catalina.org.apache.juli.FileHandler.formatter = java.util.logging.SimpleFormatter\n1catalina.org.apache.juli.FileHandler.maxDays = 10\norg.apache.catalina.startup.Catalina.handlers = 1catalina.org.apache.juli.FileHandler\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/logging.properties\n\nEnsure that the \"handlers\" and \".handlers\" lines are configured as follows:\n\nhandlers = 1catalina.org.apache.juli.FileHandler, 2localhost.org.apache.juli.FileHandler, 3manager.org.apache.juli.FileHandler, 4host-manager.org.apache.juli.FileHandler\n.handlers = 1catalina.org.apache.juli.FileHandler\n1catalina.org.apache.juli.FileHandler.level = FINE\n1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs/tomcat\n1catalina.org.apache.juli.FileHandler.prefix = catalina.\n1catalina.org.apache.juli.FileHandler.bufferSize = -1\n1catalina.org.apache.juli.FileHandler.formatter = java.util.logging.SimpleFormatter\n1catalina.org.apache.juli.FileHandler.maxDays = 10\norg.apache.catalina.startup.Catalina.handlers = 1catalina.org.apache.juli.FileHandler\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60425r918972_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256750'\n  tag rid: 'SV-256750r918974_rule'\n  tag stig_id: 'VCST-70-000006'\n  tag gtitle: 'SRG-APP-000089-WSR-000047'\n  tag fix_id: 'F-60368r918973_fix'\n  tag satisfies: ['SRG-APP-000089-WSR-000047', 'SRG-APP-000092-WSR-000055']\n  tag 'documentable'\n  tag cci: ['CCI-000169', 'CCI-001464']\n  tag nist: ['AU-12 a', 'AU-14 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256750.rb"},"title":"The Security Token Service must generate log records during Java startup and shutdown.","desc":"Logging must be started as soon as possible when a service starts and as late as possible when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.\n\n","descriptions":{"default":"Logging must be started as soon as possible when a service starts and as late as possible when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.\n\n","check":"At the command prompt, run the following command:\n\n# grep \"1catalina.org.apache.juli.FileHandler\" /usr/lib/vmware-sso/vmware-sts/conf/logging.properties\n\nExpected result:\n\nhandlers = 1catalina.org.apache.juli.FileHandler, 2localhost.org.apache.juli.FileHandler, 3manager.org.apache.juli.FileHandler, 4host-manager.org.apache.juli.FileHandler\n.handlers = 1catalina.org.apache.juli.FileHandler\n1catalina.org.apache.juli.FileHandler.level = FINE\n1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs/tomcat\n1catalina.org.apache.juli.FileHandler.prefix = catalina.\n1catalina.org.apache.juli.FileHandler.bufferSize = -1\n1catalina.org.apache.juli.FileHandler.formatter = java.util.logging.SimpleFormatter\n1catalina.org.apache.juli.FileHandler.maxDays = 10\norg.apache.catalina.startup.Catalina.handlers = 1catalina.org.apache.juli.FileHandler\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/logging.properties\n\nEnsure that the \"handlers\" and \".handlers\" lines are configured as follows:\n\nhandlers = 1catalina.org.apache.juli.FileHandler, 2localhost.org.apache.juli.FileHandler, 3manager.org.apache.juli.FileHandler, 4host-manager.org.apache.juli.FileHandler\n.handlers = 1catalina.org.apache.juli.FileHandler\n1catalina.org.apache.juli.FileHandler.level = FINE\n1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs/tomcat\n1catalina.org.apache.juli.FileHandler.prefix = catalina.\n1catalina.org.apache.juli.FileHandler.bufferSize = -1\n1catalina.org.apache.juli.FileHandler.formatter = java.util.logging.SimpleFormatter\n1catalina.org.apache.juli.FileHandler.maxDays = 10\norg.apache.catalina.startup.Catalina.handlers = 1catalina.org.apache.juli.FileHandler\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60425r918972_chk","severity":"medium","gid":"V-256750","rid":"SV-256750r918974_rule","stig_id":"VCST-70-000006","gtitle":"SRG-APP-000089-WSR-000047","fix_id":"F-60368r918973_fix","satisfies":["SRG-APP-000089-WSR-000047","SRG-APP-000092-WSR-000055"],"documentable":null,"cci":["CCI-000169","CCI-001464"],"nist":["AU-12 a","AU-14 (1)"]}},{"id":"SV-256751","code":"control 'SV-256751' do\n  title 'Security Token Service log files must only be modifiable by privileged users.'\n  desc 'Log data is essential in the investigation of events. The accuracy of the information is always pertinent. One of the first steps an attacker will undertake is the modification or deletion of log records to cover tracks and prolong discovery. \n \nThe web server must protect the log data from unauthorized modification. Security Token Service restricts all modification of log files by default, but this configuration must be verified.\n\n'\n  desc 'check', \"At the command prompt, run the following command: \n \n# find /storage/log/vmware/sso/ -xdev -type f -a '(' -perm -o+w -o -not -user root -o -not -group root ')' -exec ls -ld {} \\\\; \n \nIf any files are returned, this is a finding.\"\n  desc 'fix', 'At the command prompt, run the following commands: \n \n# chmod o-w <file> \n# chown root:root <file> \n \nNote: Substitute <file> with the listed file.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60426r889221_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256751'\n  tag rid: 'SV-256751r889223_rule'\n  tag stig_id: 'VCST-70-000007'\n  tag gtitle: 'SRG-APP-000119-WSR-000069'\n  tag fix_id: 'F-60369r889222_fix'\n  tag satisfies: ['SRG-APP-000119-WSR-000069', 'SRG-APP-000120-WSR-000070']\n  tag 'documentable'\n  tag cci: ['CCI-000163', 'CCI-000164']\n  tag nist: ['AU-9 a', 'AU-9 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256751.rb"},"title":"Security Token Service log files must only be modifiable by privileged users.","desc":"Log data is essential in the investigation of events. The accuracy of the information is always pertinent. One of the first steps an attacker will undertake is the modification or deletion of log records to cover tracks and prolong discovery. \n \nThe web server must protect the log data from unauthorized modification. Security Token Service restricts all modification of log files by default, but this configuration must be verified.\n\n","descriptions":{"default":"Log data is essential in the investigation of events. The accuracy of the information is always pertinent. One of the first steps an attacker will undertake is the modification or deletion of log records to cover tracks and prolong discovery. \n \nThe web server must protect the log data from unauthorized modification. Security Token Service restricts all modification of log files by default, but this configuration must be verified.\n\n","check":"At the command prompt, run the following command: \n \n# find /storage/log/vmware/sso/ -xdev -type f -a '(' -perm -o+w -o -not -user root -o -not -group root ')' -exec ls -ld {} \\; \n \nIf any files are returned, this is a finding.","fix":"At the command prompt, run the following commands: \n \n# chmod o-w <file> \n# chown root:root <file> \n \nNote: Substitute <file> with the listed file."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60426r889221_chk","severity":"medium","gid":"V-256751","rid":"SV-256751r889223_rule","stig_id":"VCST-70-000007","gtitle":"SRG-APP-000119-WSR-000069","fix_id":"F-60369r889222_fix","satisfies":["SRG-APP-000119-WSR-000069","SRG-APP-000120-WSR-000070"],"documentable":null,"cci":["CCI-000163","CCI-000164"],"nist":["AU-9 a","AU-9 a"]}},{"id":"SV-256752","code":"control 'SV-256752' do\n  title 'The Security Token Service application files must be verified for their integrity.'\n  desc 'Verifying the Security Token Service application code is unchanged from its shipping state is essential for file validation and nonrepudiation of the Security Token Service. There is no reason the MD5 hash of the RPM original files should be changed after installation, excluding configuration files.\n\n'\n  desc 'check', 'At the command prompt, run the following command: \n \n# rpm -V vmware-identity-sts|grep \"^..5......\"|grep -v -E \"\\\\.properties|\\\\.xml|\\\\.conf\" \n \nIf there is any output, this is a finding.'\n  desc 'fix', 'Reinstall the vCenter Server Appliance (VCSA) or roll back to a backup. \n \nVMware does not support modifying the Security Token Service installation files manually.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60427r889224_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256752'\n  tag rid: 'SV-256752r889226_rule'\n  tag stig_id: 'VCST-70-000008'\n  tag gtitle: 'SRG-APP-000131-WSR-000051'\n  tag fix_id: 'F-60370r889225_fix'\n  tag satisfies: ['SRG-APP-000131-WSR-000051', 'SRG-APP-000357-WSR-000150']\n  tag 'documentable'\n  tag cci: ['CCI-001749', 'CCI-001849']\n  tag nist: ['CM-5 (3)', 'AU-4']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256752.rb"},"title":"The Security Token Service application files must be verified for their integrity.","desc":"Verifying the Security Token Service application code is unchanged from its shipping state is essential for file validation and nonrepudiation of the Security Token Service. There is no reason the MD5 hash of the RPM original files should be changed after installation, excluding configuration files.\n\n","descriptions":{"default":"Verifying the Security Token Service application code is unchanged from its shipping state is essential for file validation and nonrepudiation of the Security Token Service. There is no reason the MD5 hash of the RPM original files should be changed after installation, excluding configuration files.\n\n","check":"At the command prompt, run the following command: \n \n# rpm -V vmware-identity-sts|grep \"^..5......\"|grep -v -E \"\\.properties|\\.xml|\\.conf\" \n \nIf there is any output, this is a finding.","fix":"Reinstall the vCenter Server Appliance (VCSA) or roll back to a backup. \n \nVMware does not support modifying the Security Token Service installation files manually."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60427r889224_chk","severity":"medium","gid":"V-256752","rid":"SV-256752r889226_rule","stig_id":"VCST-70-000008","gtitle":"SRG-APP-000131-WSR-000051","fix_id":"F-60370r889225_fix","satisfies":["SRG-APP-000131-WSR-000051","SRG-APP-000357-WSR-000150"],"documentable":null,"cci":["CCI-001749","CCI-001849"],"nist":["CM-5 (3)","AU-4"]}},{"id":"SV-256753","code":"control 'SV-256753' do\n  title 'The Security Token Service must only run one webapp.'\n  desc 'VMware ships the Security Token Service on the vCenter Server Appliance (VCSA) with one webapp, in \"ROOT.war\". Any other \".war\" file is potentially malicious and must be removed.\n\n'\n  desc 'check', 'At the command prompt, run the following command: \n \n# ls /usr/lib/vmware-sso/vmware-sts/webapps/*.war \n \nExpected result: \n \n/usr/lib/vmware-sso/vmware-sts/webapps/ROOT.war \n \nIf the result of this command does not match the expected result, this is a finding.'\n  desc 'fix', 'For each unexpected file returned in the check, run the following command: \n \n# rm /usr/lib/vmware-sso/vmware-sts/webapps/<NAME>.war \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60428r889227_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256753'\n  tag rid: 'SV-256753r889229_rule'\n  tag stig_id: 'VCST-70-000009'\n  tag gtitle: 'SRG-APP-000131-WSR-000073'\n  tag fix_id: 'F-60371r889228_fix'\n  tag satisfies: ['SRG-APP-000131-WSR-000073', 'SRG-APP-000141-WSR-000075']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001749']\n  tag nist: ['CM-7 a', 'CM-5 (3)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256753.rb"},"title":"The Security Token Service must only run one webapp.","desc":"VMware ships the Security Token Service on the vCenter Server Appliance (VCSA) with one webapp, in \"ROOT.war\". Any other \".war\" file is potentially malicious and must be removed.\n\n","descriptions":{"default":"VMware ships the Security Token Service on the vCenter Server Appliance (VCSA) with one webapp, in \"ROOT.war\". Any other \".war\" file is potentially malicious and must be removed.\n\n","check":"At the command prompt, run the following command: \n \n# ls /usr/lib/vmware-sso/vmware-sts/webapps/*.war \n \nExpected result: \n \n/usr/lib/vmware-sso/vmware-sts/webapps/ROOT.war \n \nIf the result of this command does not match the expected result, this is a finding.","fix":"For each unexpected file returned in the check, run the following command: \n \n# rm /usr/lib/vmware-sso/vmware-sts/webapps/<NAME>.war \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60428r889227_chk","severity":"medium","gid":"V-256753","rid":"SV-256753r889229_rule","stig_id":"VCST-70-000009","gtitle":"SRG-APP-000131-WSR-000073","fix_id":"F-60371r889228_fix","satisfies":["SRG-APP-000131-WSR-000073","SRG-APP-000141-WSR-000075"],"documentable":null,"cci":["CCI-000381","CCI-001749"],"nist":["CM-7 a","CM-5 (3)"]}},{"id":"SV-256754","code":"control 'SV-256754' do\n  title 'The Security Token Service must not be configured with unused realms.'\n  desc 'The Security Token Service performs user authentication at the application level and not through Tomcat. To eliminate unnecessary features and ensure the Security Token Service remains in its shipping state, the lack of a \"UserDatabaseRealm\" configuration must be confirmed.'\n  desc 'check', 'At the command prompt, run the following command: \n \n# grep UserDatabaseRealm /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nIf the command produces any output, this is a finding.'\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nRemove the <Realm> node returned in the check. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60429r889230_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256754'\n  tag rid: 'SV-256754r889232_rule'\n  tag stig_id: 'VCST-70-000010'\n  tag gtitle: 'SRG-APP-000141-WSR-000015'\n  tag fix_id: 'F-60372r889231_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256754.rb"},"title":"The Security Token Service must not be configured with unused realms.","desc":"The Security Token Service performs user authentication at the application level and not through Tomcat. To eliminate unnecessary features and ensure the Security Token Service remains in its shipping state, the lack of a \"UserDatabaseRealm\" configuration must be confirmed.","descriptions":{"default":"The Security Token Service performs user authentication at the application level and not through Tomcat. To eliminate unnecessary features and ensure the Security Token Service remains in its shipping state, the lack of a \"UserDatabaseRealm\" configuration must be confirmed.","check":"At the command prompt, run the following command: \n \n# grep UserDatabaseRealm /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nIf the command produces any output, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nRemove the <Realm> node returned in the check. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60429r889230_chk","severity":"medium","gid":"V-256754","rid":"SV-256754r889232_rule","stig_id":"VCST-70-000010","gtitle":"SRG-APP-000141-WSR-000015","fix_id":"F-60372r889231_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-256755","code":"control 'SV-256755' do\n  title 'The Security Token Service must be configured to limit access to internal packages.'\n  desc 'The \"package.access\" entry in the \"catalina.properties\" file implements access control at the package level. When properly configured, a Security Exception will be reported if an errant or malicious webapp attempts to access the listed internal classes directly or if a new class is defined under the protected packages. \n \nThe Security Token Service comes preconfigured with the appropriate packages defined in \"package.access\", and this configuration must be maintained.'\n  desc 'check', 'At the command prompt, run the following command: \n \n# grep \"package.access\" /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nExpected result: \n \npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper. \n \nIf the output of the command does not match the expected result, this is a finding.'\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nEnsure the \"package.access\" line is configured as follows: \n \npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60430r889233_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256755'\n  tag rid: 'SV-256755r889235_rule'\n  tag stig_id: 'VCST-70-000011'\n  tag gtitle: 'SRG-APP-000141-WSR-000075'\n  tag fix_id: 'F-60373r889234_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256755.rb"},"title":"The Security Token Service must be configured to limit access to internal packages.","desc":"The \"package.access\" entry in the \"catalina.properties\" file implements access control at the package level. When properly configured, a Security Exception will be reported if an errant or malicious webapp attempts to access the listed internal classes directly or if a new class is defined under the protected packages. \n \nThe Security Token Service comes preconfigured with the appropriate packages defined in \"package.access\", and this configuration must be maintained.","descriptions":{"default":"The \"package.access\" entry in the \"catalina.properties\" file implements access control at the package level. When properly configured, a Security Exception will be reported if an errant or malicious webapp attempts to access the listed internal classes directly or if a new class is defined under the protected packages. \n \nThe Security Token Service comes preconfigured with the appropriate packages defined in \"package.access\", and this configuration must be maintained.","check":"At the command prompt, run the following command: \n \n# grep \"package.access\" /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nExpected result: \n \npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper. \n \nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nEnsure the \"package.access\" line is configured as follows: \n \npackage.access=sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60430r889233_chk","severity":"medium","gid":"V-256755","rid":"SV-256755r889235_rule","stig_id":"VCST-70-000011","gtitle":"SRG-APP-000141-WSR-000075","fix_id":"F-60373r889234_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-256756","code":"control 'SV-256756' do\n  title 'The Security Token Service must have Multipurpose Internet Mail Extensions (MIME) that invoke operating system shell programs disabled.'\n  desc 'MIME mappings tell the Security Token Service what type of program various file types and extensions are and what external utilities or programs are needed to execute the file type. \n \nBy ensuring various shell script MIME types are not included in \"web.xml\", the server is protected against malicious users tricking the server into executing shell command files.'\n  desc 'check', \"At the command prompt, run the following command: \n \n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)' /usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nIf the command produces any output, this is a finding.\"\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nRemove all of the following nodes lines: \n \n<mime-type>application/x-csh</mime-type> \n<mime-type>application/x-shar</mime-type> \n<mime-type>application/x-sh</mime-type> \n<mime-type>application/x-ksh</mime-type> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts \n \nNote: Delete the entire mime-mapping node for the target mime-type. \n \nExample: \n \n<mime-mapping> \n    <extension>sh</extension> \n    <mime-type>application/x-sh</mime-type> \n</mime-mapping>'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60431r889236_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256756'\n  tag rid: 'SV-256756r889238_rule'\n  tag stig_id: 'VCST-70-000012'\n  tag gtitle: 'SRG-APP-000141-WSR-000081'\n  tag fix_id: 'F-60374r889237_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256756.rb"},"title":"The Security Token Service must have Multipurpose Internet Mail Extensions (MIME) that invoke operating system shell programs disabled.","desc":"MIME mappings tell the Security Token Service what type of program various file types and extensions are and what external utilities or programs are needed to execute the file type. \n \nBy ensuring various shell script MIME types are not included in \"web.xml\", the server is protected against malicious users tricking the server into executing shell command files.","descriptions":{"default":"MIME mappings tell the Security Token Service what type of program various file types and extensions are and what external utilities or programs are needed to execute the file type. \n \nBy ensuring various shell script MIME types are not included in \"web.xml\", the server is protected against malicious users tricking the server into executing shell command files.","check":"At the command prompt, run the following command: \n \n# grep -En '(x-csh<)|(x-sh<)|(x-shar<)|(x-ksh<)' /usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nIf the command produces any output, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nRemove all of the following nodes lines: \n \n<mime-type>application/x-csh</mime-type> \n<mime-type>application/x-shar</mime-type> \n<mime-type>application/x-sh</mime-type> \n<mime-type>application/x-ksh</mime-type> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts \n \nNote: Delete the entire mime-mapping node for the target mime-type. \n \nExample: \n \n<mime-mapping> \n    <extension>sh</extension> \n    <mime-type>application/x-sh</mime-type> \n</mime-mapping>"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60431r889236_chk","severity":"medium","gid":"V-256756","rid":"SV-256756r889238_rule","stig_id":"VCST-70-000012","gtitle":"SRG-APP-000141-WSR-000081","fix_id":"F-60374r889237_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-256757","code":"control 'SV-256757' do\n  title 'The Security Token Service must have mappings set for Java servlet pages.'\n  desc 'Resource mapping is the process of tying a particular file type to a process in the web server that can serve that type of file to a requesting client and identify which file types are not to be delivered to a client. \n \nBy not specifying which files can and cannot be served to a user, the web server could deliver to a user web server configuration files, log files, password files, etc.  \n \nAs Tomcat is a Java-based web server, the main file extension used is *.jsp. This check ensures the *.jsp and *.jspx file types have been properly mapped to servlets.'\n  desc 'check', %q(At the command prompt, run the following command:  \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/servlet-mapping/servlet-name[text()=\"jsp\"]/parent::servlet-mapping' - \n \nExpected result: \n \n<servlet-mapping> \n    <servlet-name>jsp</servlet-name> \n    <url-pattern>*.jsp</url-pattern> \n    <url-pattern>*.jspx</url-pattern> \n</servlet-mapping> \n \nIf the output of the command does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nInside the <web-app> parent node, add the following: \n \n<servlet-mapping> \n    <servlet-name>jsp</servlet-name> \n    <url-pattern>*.jsp</url-pattern> \n    <url-pattern>*.jspx</url-pattern> \n</servlet-mapping> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60432r889239_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256757'\n  tag rid: 'SV-256757r889241_rule'\n  tag stig_id: 'VCST-70-000013'\n  tag gtitle: 'SRG-APP-000141-WSR-000083'\n  tag fix_id: 'F-60375r889240_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256757.rb"},"title":"The Security Token Service must have mappings set for Java servlet pages.","desc":"Resource mapping is the process of tying a particular file type to a process in the web server that can serve that type of file to a requesting client and identify which file types are not to be delivered to a client. \n \nBy not specifying which files can and cannot be served to a user, the web server could deliver to a user web server configuration files, log files, password files, etc.  \n \nAs Tomcat is a Java-based web server, the main file extension used is *.jsp. This check ensures the *.jsp and *.jspx file types have been properly mapped to servlets.","descriptions":{"default":"Resource mapping is the process of tying a particular file type to a process in the web server that can serve that type of file to a requesting client and identify which file types are not to be delivered to a client. \n \nBy not specifying which files can and cannot be served to a user, the web server could deliver to a user web server configuration files, log files, password files, etc.  \n \nAs Tomcat is a Java-based web server, the main file extension used is *.jsp. This check ensures the *.jsp and *.jspx file types have been properly mapped to servlets.","check":"At the command prompt, run the following command:  \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/servlet-mapping/servlet-name[text()=\"jsp\"]/parent::servlet-mapping' - \n \nExpected result: \n \n<servlet-mapping> \n    <servlet-name>jsp</servlet-name> \n    <url-pattern>*.jsp</url-pattern> \n    <url-pattern>*.jspx</url-pattern> \n</servlet-mapping> \n \nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nInside the <web-app> parent node, add the following: \n \n<servlet-mapping> \n    <servlet-name>jsp</servlet-name> \n    <url-pattern>*.jsp</url-pattern> \n    <url-pattern>*.jspx</url-pattern> \n</servlet-mapping> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60432r889239_chk","severity":"medium","gid":"V-256757","rid":"SV-256757r889241_rule","stig_id":"VCST-70-000013","gtitle":"SRG-APP-000141-WSR-000083","fix_id":"F-60375r889240_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-256758","code":"control 'SV-256758' do\n  title 'The Security Token Service must not have the Web Distributed Authoring (WebDAV) servlet installed.'\n  desc 'WebDAV is an extension to the HTTP protocol that, when developed, was meant to allow users to create, change, and move documents on a server, typically a web server or web share. WebDAV is not widely used and has serious security concerns because it may allow clients to modify unauthorized files on the web server and must therefore be disabled. \n \nTomcat uses the \"org.apache.catalina.servlets.WebdavServlet\" servlet to provide WebDAV services. Because the WebDAV service has been found to have an excessive number of vulnerabilities, this servlet must not be installed. The Security Token Service does not configure WebDAV by default.'\n  desc 'check', \"At the command prompt, run the following command:  \n \n# grep -n 'webdav' /usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nIf the command produces any output, this is a finding.\"\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent <servlet> block. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60433r889242_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256758'\n  tag rid: 'SV-256758r889244_rule'\n  tag stig_id: 'VCST-70-000014'\n  tag gtitle: 'SRG-APP-000141-WSR-000085'\n  tag fix_id: 'F-60376r889243_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256758.rb"},"title":"The Security Token Service must not have the Web Distributed Authoring (WebDAV) servlet installed.","desc":"WebDAV is an extension to the HTTP protocol that, when developed, was meant to allow users to create, change, and move documents on a server, typically a web server or web share. WebDAV is not widely used and has serious security concerns because it may allow clients to modify unauthorized files on the web server and must therefore be disabled. \n \nTomcat uses the \"org.apache.catalina.servlets.WebdavServlet\" servlet to provide WebDAV services. Because the WebDAV service has been found to have an excessive number of vulnerabilities, this servlet must not be installed. The Security Token Service does not configure WebDAV by default.","descriptions":{"default":"WebDAV is an extension to the HTTP protocol that, when developed, was meant to allow users to create, change, and move documents on a server, typically a web server or web share. WebDAV is not widely used and has serious security concerns because it may allow clients to modify unauthorized files on the web server and must therefore be disabled. \n \nTomcat uses the \"org.apache.catalina.servlets.WebdavServlet\" servlet to provide WebDAV services. Because the WebDAV service has been found to have an excessive number of vulnerabilities, this servlet must not be installed. The Security Token Service does not configure WebDAV by default.","check":"At the command prompt, run the following command:  \n \n# grep -n 'webdav' /usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nIf the command produces any output, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nFind the <servlet-name>webdav</servlet-name> node and remove the entire parent <servlet> block. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60433r889242_chk","severity":"medium","gid":"V-256758","rid":"SV-256758r889244_rule","stig_id":"VCST-70-000014","gtitle":"SRG-APP-000141-WSR-000085","fix_id":"F-60376r889243_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-256759","code":"control 'SV-256759' do\n  title 'The Security Token Service must be configured with memory leak protection.'\n  desc %q(The Java Runtime environment can cause a memory leak or lock files under certain conditions. Without memory leak protection, the Security Token Service can continue to consume system resources which will lead to \"OutOfMemoryErrors\" when reloading web applications. \n \nMemory leaks occur when JRE code uses the context class loader to load a singleton. This this will cause a memory leak if a web application class loader happens to be the context class loader at the time. The \"JreMemoryLeakPreventionListener\" class is designed to initialize these singletons when Tomcat's common class loader is the context class loader. Proper use of JRE memory leak protection will ensure the hosted application does not consume system resources and cause an unstable environment.)\n  desc 'check', 'At the command prompt, run the following command:  \n \n# grep JreMemoryLeakPreventionListener /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \n<Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/> \n \nIf the output of the command does not match the expected result, this is a finding.'\n  desc 'fix', %q(Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to the <Server> node. \n \nAdd '<Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>' to the <Server> node. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts)\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60434r889245_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256759'\n  tag rid: 'SV-256759r889247_rule'\n  tag stig_id: 'VCST-70-000015'\n  tag gtitle: 'SRG-APP-000141-WSR-000086'\n  tag fix_id: 'F-60377r889246_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256759.rb"},"title":"The Security Token Service must be configured with memory leak protection.","desc":"The Java Runtime environment can cause a memory leak or lock files under certain conditions. Without memory leak protection, the Security Token Service can continue to consume system resources which will lead to \"OutOfMemoryErrors\" when reloading web applications. \n \nMemory leaks occur when JRE code uses the context class loader to load a singleton. This this will cause a memory leak if a web application class loader happens to be the context class loader at the time. The \"JreMemoryLeakPreventionListener\" class is designed to initialize these singletons when Tomcat's common class loader is the context class loader. Proper use of JRE memory leak protection will ensure the hosted application does not consume system resources and cause an unstable environment.","descriptions":{"default":"The Java Runtime environment can cause a memory leak or lock files under certain conditions. Without memory leak protection, the Security Token Service can continue to consume system resources which will lead to \"OutOfMemoryErrors\" when reloading web applications. \n \nMemory leaks occur when JRE code uses the context class loader to load a singleton. This this will cause a memory leak if a web application class loader happens to be the context class loader at the time. The \"JreMemoryLeakPreventionListener\" class is designed to initialize these singletons when Tomcat's common class loader is the context class loader. Proper use of JRE memory leak protection will ensure the hosted application does not consume system resources and cause an unstable environment.","check":"At the command prompt, run the following command:  \n \n# grep JreMemoryLeakPreventionListener /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \n<Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/> \n \nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to the <Server> node. \n \nAdd '<Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\"/>' to the <Server> node. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60434r889245_chk","severity":"medium","gid":"V-256759","rid":"SV-256759r889247_rule","stig_id":"VCST-70-000015","gtitle":"SRG-APP-000141-WSR-000086","fix_id":"F-60377r889246_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-256760","code":"control 'SV-256760' do\n  title 'The Security Token Service must not have any symbolic links in the web content directory tree.'\n  desc \"A web server is designed to deliver content and execute scripts or applications on the request of a client or user. Containing user requests to files in the directory tree of the hosted web application and limiting the execution of scripts and applications guarantees the user is not accessing information protected outside the application's realm. \n \nBy checking that no symbolic links exist in the document root, the web server is protected from users jumping outside the hosted application directory tree and gaining access to the other directories, including the system root.\"\n  desc 'check', 'At the command prompt, run the following command: \n \n# find /usr/lib/vmware-sso/vmware-sts/webapps/ -type l -ls \n \nIf the command produces any output, this is a finding.'\n  desc 'fix', 'At the command prompt, run the following command: \n \nNote: Replace <file_name> for the name of any files that were returned. \n \n# unlink <file_name> \n \nRepeat the command for each file that was returned.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60435r889248_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256760'\n  tag rid: 'SV-256760r889250_rule'\n  tag stig_id: 'VCST-70-000016'\n  tag gtitle: 'SRG-APP-000141-WSR-000087'\n  tag fix_id: 'F-60378r889249_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256760.rb"},"title":"The Security Token Service must not have any symbolic links in the web content directory tree.","desc":"A web server is designed to deliver content and execute scripts or applications on the request of a client or user. Containing user requests to files in the directory tree of the hosted web application and limiting the execution of scripts and applications guarantees the user is not accessing information protected outside the application's realm. \n \nBy checking that no symbolic links exist in the document root, the web server is protected from users jumping outside the hosted application directory tree and gaining access to the other directories, including the system root.","descriptions":{"default":"A web server is designed to deliver content and execute scripts or applications on the request of a client or user. Containing user requests to files in the directory tree of the hosted web application and limiting the execution of scripts and applications guarantees the user is not accessing information protected outside the application's realm. \n \nBy checking that no symbolic links exist in the document root, the web server is protected from users jumping outside the hosted application directory tree and gaining access to the other directories, including the system root.","check":"At the command prompt, run the following command: \n \n# find /usr/lib/vmware-sso/vmware-sts/webapps/ -type l -ls \n \nIf the command produces any output, this is a finding.","fix":"At the command prompt, run the following command: \n \nNote: Replace <file_name> for the name of any files that were returned. \n \n# unlink <file_name> \n \nRepeat the command for each file that was returned."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60435r889248_chk","severity":"medium","gid":"V-256760","rid":"SV-256760r889250_rule","stig_id":"VCST-70-000016","gtitle":"SRG-APP-000141-WSR-000087","fix_id":"F-60378r889249_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-256761","code":"control 'SV-256761' do\n  title 'The Security Token Service directory tree must have permissions in an out-of-the-box state.'\n  desc 'As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled. The Security Token Service files must be adequately protected with correct permissions as applied out of the box.\n\n'\n  desc 'check', \"At the command prompt, run the following command: \n \n# find /usr/lib/vmware-sso/vmware-sts/ -xdev -type f -a '(' -not -user root -o -not -group root ')' -exec ls -ld {} \\\\; \n \nIf the command produces any output, this is a finding.\"\n  desc 'fix', 'At the command prompt, run the following command: \n \n# chown root:root <file_name> \n \nRepeat the command for each file that was returned. \n \nNote: Replace <file_name> for the name of the file that was returned.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60436r889251_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256761'\n  tag rid: 'SV-256761r889253_rule'\n  tag stig_id: 'VCST-70-000017'\n  tag gtitle: 'SRG-APP-000211-WSR-000030'\n  tag fix_id: 'F-60379r889252_fix'\n  tag satisfies: ['SRG-APP-000211-WSR-000030', 'SRG-APP-000380-WSR-000072']\n  tag 'documentable'\n  tag cci: ['CCI-001082', 'CCI-001813']\n  tag nist: ['SC-2', 'CM-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256761.rb"},"title":"The Security Token Service directory tree must have permissions in an out-of-the-box state.","desc":"As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled. The Security Token Service files must be adequately protected with correct permissions as applied out of the box.\n\n","descriptions":{"default":"As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled. The Security Token Service files must be adequately protected with correct permissions as applied out of the box.\n\n","check":"At the command prompt, run the following command: \n \n# find /usr/lib/vmware-sso/vmware-sts/ -xdev -type f -a '(' -not -user root -o -not -group root ')' -exec ls -ld {} \\; \n \nIf the command produces any output, this is a finding.","fix":"At the command prompt, run the following command: \n \n# chown root:root <file_name> \n \nRepeat the command for each file that was returned. \n \nNote: Replace <file_name> for the name of the file that was returned."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60436r889251_chk","severity":"medium","gid":"V-256761","rid":"SV-256761r889253_rule","stig_id":"VCST-70-000017","gtitle":"SRG-APP-000211-WSR-000030","fix_id":"F-60379r889252_fix","satisfies":["SRG-APP-000211-WSR-000030","SRG-APP-000380-WSR-000072"],"documentable":null,"cci":["CCI-001082","CCI-001813"],"nist":["SC-2","CM-5 (1) (a)"]}},{"id":"SV-256762","code":"control 'SV-256762' do\n  title 'The Security Token Service must fail to a known safe state if system initialization fails, shutdown fails, or aborts fail.'\n  desc 'Determining a safe state for failure and weighing that against a potential denial of service for users depends on what type of application the web server is hosting. For the Security Token Service, it is preferable that the service abort startup on any initialization failure rather than continuing in a degraded, and potentially insecure, state.'\n  desc 'check', 'At the command line, run the following command: \n \n# grep EXIT_ON_INIT_FAILURE /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nExpected result: \n \norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true \n \nIf the output of the command does not match the expected result, this is a finding.'\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nAdd or change the following line: \n \norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60437r889254_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256762'\n  tag rid: 'SV-256762r889256_rule'\n  tag stig_id: 'VCST-70-000018'\n  tag gtitle: 'SRG-APP-000225-WSR-000140'\n  tag fix_id: 'F-60380r889255_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001190']\n  tag nist: ['SC-24']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256762.rb"},"title":"The Security Token Service must fail to a known safe state if system initialization fails, shutdown fails, or aborts fail.","desc":"Determining a safe state for failure and weighing that against a potential denial of service for users depends on what type of application the web server is hosting. For the Security Token Service, it is preferable that the service abort startup on any initialization failure rather than continuing in a degraded, and potentially insecure, state.","descriptions":{"default":"Determining a safe state for failure and weighing that against a potential denial of service for users depends on what type of application the web server is hosting. For the Security Token Service, it is preferable that the service abort startup on any initialization failure rather than continuing in a degraded, and potentially insecure, state.","check":"At the command line, run the following command: \n \n# grep EXIT_ON_INIT_FAILURE /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nExpected result: \n \norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true \n \nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nAdd or change the following line: \n \norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60437r889254_chk","severity":"medium","gid":"V-256762","rid":"SV-256762r889256_rule","stig_id":"VCST-70-000018","gtitle":"SRG-APP-000225-WSR-000140","fix_id":"F-60380r889255_fix","documentable":null,"cci":["CCI-001190"],"nist":["SC-24"]}},{"id":"SV-256763","code":"control 'SV-256763' do\n  title 'The Security Token Service must limit the number of allowed connections.'\n  desc 'Limiting the number of established connections to the Security Token Service is a basic denial-of-service protection. Servers where the limit is too high or unlimited can potentially run out of system resources and negatively affect system availability.'\n  desc 'check', %q(At the command prompt, run the following command: \n \n# xmllint --xpath '/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@acceptCount' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \nacceptCount=\"100\" \n \nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to the <Connector> configured with port=\"${bio-custom.http.port}\". \n \nAdd or change the following value: \n \nacceptCount=\"100\" \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60438r889257_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256763'\n  tag rid: 'SV-256763r889259_rule'\n  tag stig_id: 'VCST-70-000019'\n  tag gtitle: 'SRG-APP-000246-WSR-000149'\n  tag fix_id: 'F-60381r889258_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001094']\n  tag nist: ['SC-5 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256763.rb"},"title":"The Security Token Service must limit the number of allowed connections.","desc":"Limiting the number of established connections to the Security Token Service is a basic denial-of-service protection. Servers where the limit is too high or unlimited can potentially run out of system resources and negatively affect system availability.","descriptions":{"default":"Limiting the number of established connections to the Security Token Service is a basic denial-of-service protection. Servers where the limit is too high or unlimited can potentially run out of system resources and negatively affect system availability.","check":"At the command prompt, run the following command: \n \n# xmllint --xpath '/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@acceptCount' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \nacceptCount=\"100\" \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to the <Connector> configured with port=\"${bio-custom.http.port}\". \n \nAdd or change the following value: \n \nacceptCount=\"100\" \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60438r889257_chk","severity":"medium","gid":"V-256763","rid":"SV-256763r889259_rule","stig_id":"VCST-70-000019","gtitle":"SRG-APP-000246-WSR-000149","fix_id":"F-60381r889258_fix","documentable":null,"cci":["CCI-001094"],"nist":["SC-5 (1)"]}},{"id":"SV-256764","code":"control 'SV-256764' do\n  title 'The Security Token Service must set \"URIEncoding\" to UTF-8.'\n  desc %q(Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.  \n \nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or bypass security checks. The Security Token Service must be configured to use a consistent character set via the \"URIEncoding\" attribute on the Connector nodes.)\n  desc 'check', %q(At the command prompt, run the following command: \n \n# xmllint --xpath '/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@URIEncoding' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \nURIEncoding=\"UTF-8\" \n \nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to each of the <Connector> nodes. \n \nConfigure each <Connector> node with the value 'URIEncoding=\"UTF-8\"'. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts)\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60439r889260_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256764'\n  tag rid: 'SV-256764r889262_rule'\n  tag stig_id: 'VCST-70-000020'\n  tag gtitle: 'SRG-APP-000251-WSR-000157'\n  tag fix_id: 'F-60382r889261_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001310']\n  tag nist: ['SI-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256764.rb"},"title":"The Security Token Service must set \"URIEncoding\" to UTF-8.","desc":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.  \n \nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or bypass security checks. The Security Token Service must be configured to use a consistent character set via the \"URIEncoding\" attribute on the Connector nodes.","descriptions":{"default":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.  \n \nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or bypass security checks. The Security Token Service must be configured to use a consistent character set via the \"URIEncoding\" attribute on the Connector nodes.","check":"At the command prompt, run the following command: \n \n# xmllint --xpath '/Server/Service/Connector[@port=\"${bio-custom.http.port}\"]/@URIEncoding' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \nURIEncoding=\"UTF-8\" \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nNavigate to each of the <Connector> nodes. \n \nConfigure each <Connector> node with the value 'URIEncoding=\"UTF-8\"'. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60439r889260_chk","severity":"medium","gid":"V-256764","rid":"SV-256764r889262_rule","stig_id":"VCST-70-000020","gtitle":"SRG-APP-000251-WSR-000157","fix_id":"F-60382r889261_fix","documentable":null,"cci":["CCI-001310"],"nist":["SI-10"]}},{"id":"SV-256765","code":"control 'SV-256765' do\n  title 'The Security Token Service must use the \"setCharacterEncodingFilter\" filter.'\n  desc %q(Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.  \n \nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. VMware uses the standard Tomcat \"SetCharacterEncodingFilter\" to provide a layer of defense against character encoding attacks. Filters are Java objects that perform filtering tasks on the request to a resource (a servlet or static content), on the response from a resource, or both.)\n  desc 'check', %q(At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/filter-mapping/filter-name[text()=\"setCharacterEncodingFilter\"]/parent::filter-mapping' - \n \nExpected result: \n \n<filter-mapping> \n    <filter-name>setCharacterEncodingFilter</filter-name> \n    <url-pattern>/*</url-pattern> \n</filter-mapping> \n \nIf the output is does not match the expected result, this is a finding. \n \nAt the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/filter/filter-name[text()=\"setCharacterEncodingFilter\"]/parent::filter' - \n \nExpected result: \n \n   <filter> \n      <filter-name>setCharacterEncodingFilter</filter-name> \n      <filter-class> \n         org.apache.catalina.filters.SetCharacterEncodingFilter \n      </filter-class> \n      <init-param> \n         <param-name>encoding</param-name> \n         <param-value>UTF-8</param-value> \n      </init-param> \n      <init-param> \n         <param-name>ignore</param-name> \n         <param-value>true</param-value> \n      </init-param> \n      <async-supported>true</async-supported> \n   </filter> \n \nIf the output is does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nConfigure the <web-app> node with the child nodes listed below: \n \n<filter-mapping> \n    <filter-name>setCharacterEncodingFilter</filter-name> \n    <url-pattern>/*</url-pattern> \n</filter-mapping> \n \n   <filter> \n      <filter-name>setCharacterEncodingFilter</filter-name> \n      <filter-class> \n         org.apache.catalina.filters.SetCharacterEncodingFilter \n      </filter-class> \n      <init-param> \n         <param-name>encoding</param-name> \n         <param-value>UTF-8</param-value> \n      </init-param> \n      <init-param> \n         <param-name>ignore</param-name> \n         <param-value>true</param-value> \n      </init-param> \n      <async-supported>true</async-supported> \n   </filter> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60440r889263_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256765'\n  tag rid: 'SV-256765r889265_rule'\n  tag stig_id: 'VCST-70-000021'\n  tag gtitle: 'SRG-APP-000251-WSR-000157'\n  tag fix_id: 'F-60383r889264_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001310']\n  tag nist: ['SI-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256765.rb"},"title":"The Security Token Service must use the \"setCharacterEncodingFilter\" filter.","desc":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.  \n \nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. VMware uses the standard Tomcat \"SetCharacterEncodingFilter\" to provide a layer of defense against character encoding attacks. Filters are Java objects that perform filtering tasks on the request to a resource (a servlet or static content), on the response from a resource, or both.","descriptions":{"default":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.  \n \nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. VMware uses the standard Tomcat \"SetCharacterEncodingFilter\" to provide a layer of defense against character encoding attacks. Filters are Java objects that perform filtering tasks on the request to a resource (a servlet or static content), on the response from a resource, or both.","check":"At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/filter-mapping/filter-name[text()=\"setCharacterEncodingFilter\"]/parent::filter-mapping' - \n \nExpected result: \n \n<filter-mapping> \n    <filter-name>setCharacterEncodingFilter</filter-name> \n    <url-pattern>/*</url-pattern> \n</filter-mapping> \n \nIf the output is does not match the expected result, this is a finding. \n \nAt the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/filter/filter-name[text()=\"setCharacterEncodingFilter\"]/parent::filter' - \n \nExpected result: \n \n   <filter> \n      <filter-name>setCharacterEncodingFilter</filter-name> \n      <filter-class> \n         org.apache.catalina.filters.SetCharacterEncodingFilter \n      </filter-class> \n      <init-param> \n         <param-name>encoding</param-name> \n         <param-value>UTF-8</param-value> \n      </init-param> \n      <init-param> \n         <param-name>ignore</param-name> \n         <param-value>true</param-value> \n      </init-param> \n      <async-supported>true</async-supported> \n   </filter> \n \nIf the output is does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nConfigure the <web-app> node with the child nodes listed below: \n \n<filter-mapping> \n    <filter-name>setCharacterEncodingFilter</filter-name> \n    <url-pattern>/*</url-pattern> \n</filter-mapping> \n \n   <filter> \n      <filter-name>setCharacterEncodingFilter</filter-name> \n      <filter-class> \n         org.apache.catalina.filters.SetCharacterEncodingFilter \n      </filter-class> \n      <init-param> \n         <param-name>encoding</param-name> \n         <param-value>UTF-8</param-value> \n      </init-param> \n      <init-param> \n         <param-name>ignore</param-name> \n         <param-value>true</param-value> \n      </init-param> \n      <async-supported>true</async-supported> \n   </filter> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60440r889263_chk","severity":"medium","gid":"V-256765","rid":"SV-256765r889265_rule","stig_id":"VCST-70-000021","gtitle":"SRG-APP-000251-WSR-000157","fix_id":"F-60383r889264_fix","documentable":null,"cci":["CCI-001310"],"nist":["SI-10"]}},{"id":"SV-256766","code":"control 'SV-256766' do\n  title 'The Security Token Service must set the welcome-file node to a default web page.'\n  desc %q(Enumeration techniques, such as Uniform Resource Locator (URL) parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed.  \n \nBy having a default hosted application web page, the anonymous web user will not obtain directory browsing information or an error message that reveals the server type and version. Ensuring every document directory has an \"index.jsp\" (or equivalent) file is one approach to mitigating the vulnerability.)\n  desc 'check', %q(At the command prompt, run the following command: \n  \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/welcome-file-list' - \n \nExpected result: \n \n<welcome-file-list> \n    <welcome-file>index.html</welcome-file> \n    <welcome-file>index.htm</welcome-file> \n    <welcome-file>index.jsp</welcome-file> \n</welcome-file-list> \n \nIf the output of the command does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nAdd the following section under the <web-apps> node: \n \n<welcome-file-list> \n    <welcome-file>index.html</welcome-file> \n    <welcome-file>index.htm</welcome-file> \n    <welcome-file>index.jsp</welcome-file> \n</welcome-file-list> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60441r889266_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256766'\n  tag rid: 'SV-256766r889268_rule'\n  tag stig_id: 'VCST-70-000022'\n  tag gtitle: 'SRG-APP-000266-WSR-000142'\n  tag fix_id: 'F-60384r889267_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256766.rb"},"title":"The Security Token Service must set the welcome-file node to a default web page.","desc":"Enumeration techniques, such as Uniform Resource Locator (URL) parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed.  \n \nBy having a default hosted application web page, the anonymous web user will not obtain directory browsing information or an error message that reveals the server type and version. Ensuring every document directory has an \"index.jsp\" (or equivalent) file is one approach to mitigating the vulnerability.","descriptions":{"default":"Enumeration techniques, such as Uniform Resource Locator (URL) parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed.  \n \nBy having a default hosted application web page, the anonymous web user will not obtain directory browsing information or an error message that reveals the server type and version. Ensuring every document directory has an \"index.jsp\" (or equivalent) file is one approach to mitigating the vulnerability.","check":"At the command prompt, run the following command: \n  \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/welcome-file-list' - \n \nExpected result: \n \n<welcome-file-list> \n    <welcome-file>index.html</welcome-file> \n    <welcome-file>index.htm</welcome-file> \n    <welcome-file>index.jsp</welcome-file> \n</welcome-file-list> \n \nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nAdd the following section under the <web-apps> node: \n \n<welcome-file-list> \n    <welcome-file>index.html</welcome-file> \n    <welcome-file>index.htm</welcome-file> \n    <welcome-file>index.jsp</welcome-file> \n</welcome-file-list> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60441r889266_chk","severity":"medium","gid":"V-256766","rid":"SV-256766r889268_rule","stig_id":"VCST-70-000022","gtitle":"SRG-APP-000266-WSR-000142","fix_id":"F-60384r889267_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-256767","code":"control 'SV-256767' do\n  title 'The Security Token Service must not show directory listings.'\n  desc \"Enumeration techniques, such as Uniform Resource Locator (URL) parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring directory listing is disabled is one approach to mitigating the vulnerability.\"\n  desc 'check', %q(At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"listings\"]/parent::init-param' - \n \nExpected result: \n \n<init-param> \n      <param-name>listings</param-name> \n      <param-value>false</param-value> \n</init-param> \n \nIf the output of the command does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nSet the <param-value> to \"false\" in all <param-name>listing</param-name> nodes. \n \nNote: The setting should look like the following: \n \n<init-param> \n      <param-name>listings</param-name> \n      <param-value>false</param-value> \n</init-param> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60442r889269_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256767'\n  tag rid: 'SV-256767r889271_rule'\n  tag stig_id: 'VCST-70-000023'\n  tag gtitle: 'SRG-APP-000266-WSR-000142'\n  tag fix_id: 'F-60385r889270_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256767.rb"},"title":"The Security Token Service must not show directory listings.","desc":"Enumeration techniques, such as Uniform Resource Locator (URL) parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring directory listing is disabled is one approach to mitigating the vulnerability.","descriptions":{"default":"Enumeration techniques, such as Uniform Resource Locator (URL) parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring directory listing is disabled is one approach to mitigating the vulnerability.","check":"At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"listings\"]/parent::init-param' - \n \nExpected result: \n \n<init-param> \n      <param-name>listings</param-name> \n      <param-value>false</param-value> \n</init-param> \n \nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nSet the <param-value> to \"false\" in all <param-name>listing</param-name> nodes. \n \nNote: The setting should look like the following: \n \n<init-param> \n      <param-name>listings</param-name> \n      <param-value>false</param-value> \n</init-param> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60442r889269_chk","severity":"medium","gid":"V-256767","rid":"SV-256767r889271_rule","stig_id":"VCST-70-000023","gtitle":"SRG-APP-000266-WSR-000142","fix_id":"F-60385r889270_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-256768","code":"control 'SV-256768' do\n  title 'The Security Token Service must be configured to not show error reports.'\n  desc 'Web servers will often display error messages to client users, displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage. \n \nThis information could be used by an attacker to blueprint what type of attacks might be successful. Therefore, the Security Token Service must be configured to not show server version information in error messages.'\n  desc 'check', %q(At the command prompt, run the following command: \n \n# xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.ErrorReportValve\"]' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showReport=\"false\" showServerInfo=\"false\"/> \n \nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nLocate the following Host block: \n \n<Host ...> \n... \n</Host> \n \nInside this block, remove any existing Valve with className=\"org.apache.catalina.valves.ErrorReportValve\" and add the following: \n \n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showServerInfo=\"false\" showReport=\"false\"/> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60443r889272_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256768'\n  tag rid: 'SV-256768r889274_rule'\n  tag stig_id: 'VCST-70-000024'\n  tag gtitle: 'SRG-APP-000266-WSR-000159'\n  tag fix_id: 'F-60386r889273_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256768.rb"},"title":"The Security Token Service must be configured to not show error reports.","desc":"Web servers will often display error messages to client users, displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage. \n \nThis information could be used by an attacker to blueprint what type of attacks might be successful. Therefore, the Security Token Service must be configured to not show server version information in error messages.","descriptions":{"default":"Web servers will often display error messages to client users, displaying enough information to aid in the debugging of the error. The information given back in error messages may display the web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage. \n \nThis information could be used by an attacker to blueprint what type of attacks might be successful. Therefore, the Security Token Service must be configured to not show server version information in error messages.","check":"At the command prompt, run the following command: \n \n# xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.ErrorReportValve\"]' /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nExpected result: \n \n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showReport=\"false\" showServerInfo=\"false\"/> \n \nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nLocate the following Host block: \n \n<Host ...> \n... \n</Host> \n \nInside this block, remove any existing Valve with className=\"org.apache.catalina.valves.ErrorReportValve\" and add the following: \n \n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showServerInfo=\"false\" showReport=\"false\"/> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60443r889272_chk","severity":"medium","gid":"V-256768","rid":"SV-256768r889274_rule","stig_id":"VCST-70-000024","gtitle":"SRG-APP-000266-WSR-000159","fix_id":"F-60386r889273_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-256769","code":"control 'SV-256769' do\n  title 'The Security Token Service must not enable support for TRACE requests.'\n  desc '\"TRACE\" is a technique for a user to request internal information about Tomcat. This is useful during product development but should not be enabled in production. Allowing an attacker to conduct a TRACE operation against the Security Token Service will expose information that would be useful to perform a more targeted attack. \n \nThe Security Token Service provides the \"allowTrace\" parameter as means to disable responding to TRACE requests.'\n  desc 'check', 'At the command prompt, run the following command: \n \n# grep allowTrace /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nIf \"allowTrace\" is set to \"true\", this is a finding. \n \nIf no line is returned, this is not a finding.'\n  desc 'fix', %q(Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nLocate and remove the 'allowTrace=\"true\"' setting. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts)\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60444r889275_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256769'\n  tag rid: 'SV-256769r889277_rule'\n  tag stig_id: 'VCST-70-000025'\n  tag gtitle: 'SRG-APP-000266-WSR-000160'\n  tag fix_id: 'F-60387r889276_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256769.rb"},"title":"The Security Token Service must not enable support for TRACE requests.","desc":"\"TRACE\" is a technique for a user to request internal information about Tomcat. This is useful during product development but should not be enabled in production. Allowing an attacker to conduct a TRACE operation against the Security Token Service will expose information that would be useful to perform a more targeted attack. \n \nThe Security Token Service provides the \"allowTrace\" parameter as means to disable responding to TRACE requests.","descriptions":{"default":"\"TRACE\" is a technique for a user to request internal information about Tomcat. This is useful during product development but should not be enabled in production. Allowing an attacker to conduct a TRACE operation against the Security Token Service will expose information that would be useful to perform a more targeted attack. \n \nThe Security Token Service provides the \"allowTrace\" parameter as means to disable responding to TRACE requests.","check":"At the command prompt, run the following command: \n \n# grep allowTrace /usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nIf \"allowTrace\" is set to \"true\", this is a finding. \n \nIf no line is returned, this is not a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/server.xml \n \nLocate and remove the 'allowTrace=\"true\"' setting. \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60444r889275_chk","severity":"medium","gid":"V-256769","rid":"SV-256769r889277_rule","stig_id":"VCST-70-000025","gtitle":"SRG-APP-000266-WSR-000160","fix_id":"F-60387r889276_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-256770","code":"control 'SV-256770' do\n  title 'The Security Token Service must have the debug option disabled.'\n  desc 'Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage may be displayed. \n \nBecause this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information. \n \nThe Security Token Service can be configured to set the debugging level. By setting the debugging level to zero, no debugging information will be provided to a malicious user.'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"debug\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n    <param-name>debug</param-name>\n    <param-value>0</param-value>\n</init-param>\n\nIf the output of the command does not match the expected result, this is a finding.\n\nIf no lines are returned, this is not a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nNavigate to all <debug> nodes that are not set to \"0\". \n \nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes. \n \nNote: The debug setting should look like the following: \n \n<init-param> \n    <param-name>debug</param-name> \n    <param-value>0</param-value> \n</init-param> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60445r918975_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256770'\n  tag rid: 'SV-256770r918976_rule'\n  tag stig_id: 'VCST-70-000026'\n  tag gtitle: 'SRG-APP-000266-WSR-000160'\n  tag fix_id: 'F-60388r889279_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256770.rb"},"title":"The Security Token Service must have the debug option disabled.","desc":"Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage may be displayed. \n \nBecause this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information. \n \nThe Security Token Service can be configured to set the debugging level. By setting the debugging level to zero, no debugging information will be provided to a malicious user.","descriptions":{"default":"Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage may be displayed. \n \nBecause this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information. \n \nThe Security Token Service can be configured to set the debugging level. By setting the debugging level to zero, no debugging information will be provided to a malicious user.","check":"At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"debug\"]/parent::init-param' -\n\nExpected result:\n\n<init-param>\n    <param-name>debug</param-name>\n    <param-value>0</param-value>\n</init-param>\n\nIf the output of the command does not match the expected result, this is a finding.\n\nIf no lines are returned, this is not a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nNavigate to all <debug> nodes that are not set to \"0\". \n \nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes. \n \nNote: The debug setting should look like the following: \n \n<init-param> \n    <param-name>debug</param-name> \n    <param-value>0</param-value> \n</init-param> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60445r918975_chk","severity":"medium","gid":"V-256770","rid":"SV-256770r918976_rule","stig_id":"VCST-70-000026","gtitle":"SRG-APP-000266-WSR-000160","fix_id":"F-60388r889279_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-256771","code":"control 'SV-256771' do\n  title 'The Security Token Service must be configured with the appropriate ports.'\n  desc 'Web servers provide numerous processes, features, and functionalities that use TCP/IP ports. Some of these processes may be deemed unnecessary or too unsecure to run on a production system. The ports that the Security Token Service listens on are configured in the \"catalina.properties\" file and must be verified as accurate to their shipping state.'\n  desc 'check', \"At the command prompt, run the following command:\n\n# grep 'bio' /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExpected result:\n\nbio-custom.http.port=7080\nbio-custom.https.port=8443\nbio-ssl-clientauth.https.port=3128\nbio-ssl-localhost.https.port=7444\n\nIf the output of the command does not match the expected result, this is a finding.\n\nNote: Port 3128 will not be shown in the output prior to 7.0 U3i.\"\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nNavigate to the ports specification section.\n\nSet the Security Token Service port specifications according to the following list:\n\nbio-custom.http.port=7080\nbio-custom.https.port=8443\nbio-ssl-clientauth.https.port=3128\nbio-ssl-localhost.https.port=7444\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60446r918977_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256771'\n  tag rid: 'SV-256771r918979_rule'\n  tag stig_id: 'VCST-70-000028'\n  tag gtitle: 'SRG-APP-000383-WSR-000175'\n  tag fix_id: 'F-60389r918978_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001762']\n  tag nist: ['CM-7 (1) (b)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256771.rb"},"title":"The Security Token Service must be configured with the appropriate ports.","desc":"Web servers provide numerous processes, features, and functionalities that use TCP/IP ports. Some of these processes may be deemed unnecessary or too unsecure to run on a production system. The ports that the Security Token Service listens on are configured in the \"catalina.properties\" file and must be verified as accurate to their shipping state.","descriptions":{"default":"Web servers provide numerous processes, features, and functionalities that use TCP/IP ports. Some of these processes may be deemed unnecessary or too unsecure to run on a production system. The ports that the Security Token Service listens on are configured in the \"catalina.properties\" file and must be verified as accurate to their shipping state.","check":"At the command prompt, run the following command:\n\n# grep 'bio' /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExpected result:\n\nbio-custom.http.port=7080\nbio-custom.https.port=8443\nbio-ssl-clientauth.https.port=3128\nbio-ssl-localhost.https.port=7444\n\nIf the output of the command does not match the expected result, this is a finding.\n\nNote: Port 3128 will not be shown in the output prior to 7.0 U3i.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nNavigate to the ports specification section.\n\nSet the Security Token Service port specifications according to the following list:\n\nbio-custom.http.port=7080\nbio-custom.https.port=8443\nbio-ssl-clientauth.https.port=3128\nbio-ssl-localhost.https.port=7444\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60446r918977_chk","severity":"medium","gid":"V-256771","rid":"SV-256771r918979_rule","stig_id":"VCST-70-000028","gtitle":"SRG-APP-000383-WSR-000175","fix_id":"F-60389r918978_fix","documentable":null,"cci":["CCI-001762"],"nist":["CM-7 (1) (b)"]}},{"id":"SV-256772","code":"control 'SV-256772' do\n  title 'The Security Token Service must disable the shutdown port.'\n  desc 'An attacker has at least two reasons to stop a web server. The first is to cause a denial of service, and the second is to put in place changes the attacker made to the web server configuration. \n \nIf the Tomcat shutdown port feature is enabled, a shutdown signal can be sent to the Security Token Service through this port. To ensure availability, the shutdown port must be disabled.'\n  desc 'check', \"At the command prompt, run the following command: \n \n# grep 'base.shutdown.port' /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nExpected result: \n \nbase.shutdown.port=-1 \n \nIf the output of the command does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nAdd or modify the following setting: \n \nbase.shutdown.port=-1 \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60447r889284_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256772'\n  tag rid: 'SV-256772r889286_rule'\n  tag stig_id: 'VCST-70-000029'\n  tag gtitle: 'SRG-APP-000435-WSR-000147'\n  tag fix_id: 'F-60390r889285_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002385']\n  tag nist: ['SC-5 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256772.rb"},"title":"The Security Token Service must disable the shutdown port.","desc":"An attacker has at least two reasons to stop a web server. The first is to cause a denial of service, and the second is to put in place changes the attacker made to the web server configuration. \n \nIf the Tomcat shutdown port feature is enabled, a shutdown signal can be sent to the Security Token Service through this port. To ensure availability, the shutdown port must be disabled.","descriptions":{"default":"An attacker has at least two reasons to stop a web server. The first is to cause a denial of service, and the second is to put in place changes the attacker made to the web server configuration. \n \nIf the Tomcat shutdown port feature is enabled, a shutdown signal can be sent to the Security Token Service through this port. To ensure availability, the shutdown port must be disabled.","check":"At the command prompt, run the following command: \n \n# grep 'base.shutdown.port' /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nExpected result: \n \nbase.shutdown.port=-1 \n \nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties \n \nAdd or modify the following setting: \n \nbase.shutdown.port=-1 \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60447r889284_chk","severity":"medium","gid":"V-256772","rid":"SV-256772r889286_rule","stig_id":"VCST-70-000029","gtitle":"SRG-APP-000435-WSR-000147","fix_id":"F-60390r889285_fix","documentable":null,"cci":["CCI-002385"],"nist":["SC-5 a"]}},{"id":"SV-256773","code":"control 'SV-256773' do\n  title 'The Security Token Service must set the secure flag for cookies.'\n  desc 'The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of the cookie in clear text. \n \nBy setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel. The Security Token Service is configured to only be accessible over a Transport Layer Security (TLS) tunnel, but this cookie flag is still a recommended best practice.'\n  desc 'check', %q(At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/secure' - \n \nExpected result: \n \n<secure>true</secure> \n \nIf the output of the command does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure it as follows: \n \n    <cookie-config> \n      <http-only>true</http-only> \n      <secure>true</secure> \n    </cookie-config> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60448r889287_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256773'\n  tag rid: 'SV-256773r889289_rule'\n  tag stig_id: 'VCST-70-000030'\n  tag gtitle: 'SRG-APP-000439-WSR-000155'\n  tag fix_id: 'F-60391r889288_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002418']\n  tag nist: ['SC-8']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256773.rb"},"title":"The Security Token Service must set the secure flag for cookies.","desc":"The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of the cookie in clear text. \n \nBy setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel. The Security Token Service is configured to only be accessible over a Transport Layer Security (TLS) tunnel, but this cookie flag is still a recommended best practice.","descriptions":{"default":"The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of the cookie in clear text. \n \nBy setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel. The Security Token Service is configured to only be accessible over a Transport Layer Security (TLS) tunnel, but this cookie flag is still a recommended best practice.","check":"At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/secure' - \n \nExpected result: \n \n<secure>true</secure> \n \nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nNavigate to the /<web-apps>/<session-config>/<cookie-config> node and configure it as follows: \n \n    <cookie-config> \n      <http-only>true</http-only> \n      <secure>true</secure> \n    </cookie-config> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60448r889287_chk","severity":"medium","gid":"V-256773","rid":"SV-256773r889289_rule","stig_id":"VCST-70-000030","gtitle":"SRG-APP-000439-WSR-000155","fix_id":"F-60391r889288_fix","documentable":null,"cci":["CCI-002418"],"nist":["SC-8"]}},{"id":"SV-256774","code":"control 'SV-256774' do\n  title 'The Security Token Service default servlet must be set to \"readonly\".'\n  desc 'The default servlet (or DefaultServlet) is a special servlet provided with Tomcat that is called when no other suitable page is found in a particular folder. The DefaultServlet serves static resources as well as directory listings. \n \nThe DefaultServlet is configured by default with the \"readonly\" parameter set to \"true\" where HTTP commands such as PUT and DELETE are rejected. Changing this to \"false\" allows clients to delete or modify static resources on the server and to upload new resources.  \n \nDefaultServlet readonly must be set to \"true\", either literally or by absence (default).'\n  desc 'check', %q(At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/servlet/servlet-name[text()=\"default\"]/../init-param/param-name[text()=\"readonly\"]/../param-value[text()=\"false\"]' - \n \nExpected result: \n \nXPath set is empty \n \nIf the output of the command does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nNavigate to the /<web-apps>/<servlet>/<servlet-name>default</servlet-name>/ node and remove the following node: \n \n<init-param> \n      <param-name>readonly</param-name> \n      <param-value>false</param-value> \n</init-param> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60449r889290_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256774'\n  tag rid: 'SV-256774r889292_rule'\n  tag stig_id: 'VCST-70-000031'\n  tag gtitle: 'SRG-APP-000516-WSR-000174'\n  tag fix_id: 'F-60392r889291_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256774.rb"},"title":"The Security Token Service default servlet must be set to \"readonly\".","desc":"The default servlet (or DefaultServlet) is a special servlet provided with Tomcat that is called when no other suitable page is found in a particular folder. The DefaultServlet serves static resources as well as directory listings. \n \nThe DefaultServlet is configured by default with the \"readonly\" parameter set to \"true\" where HTTP commands such as PUT and DELETE are rejected. Changing this to \"false\" allows clients to delete or modify static resources on the server and to upload new resources.  \n \nDefaultServlet readonly must be set to \"true\", either literally or by absence (default).","descriptions":{"default":"The default servlet (or DefaultServlet) is a special servlet provided with Tomcat that is called when no other suitable page is found in a particular folder. The DefaultServlet serves static resources as well as directory listings. \n \nThe DefaultServlet is configured by default with the \"readonly\" parameter set to \"true\" where HTTP commands such as PUT and DELETE are rejected. Changing this to \"false\" allows clients to delete or modify static resources on the server and to upload new resources.  \n \nDefaultServlet readonly must be set to \"true\", either literally or by absence (default).","check":"At the command prompt, run the following command: \n \n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed '2 s/xmlns=\".*\"//g' | xmllint --xpath '/web-app/servlet/servlet-name[text()=\"default\"]/../init-param/param-name[text()=\"readonly\"]/../param-value[text()=\"false\"]' - \n \nExpected result: \n \nXPath set is empty \n \nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open: \n \n/usr/lib/vmware-sso/vmware-sts/conf/web.xml \n \nNavigate to the /<web-apps>/<servlet>/<servlet-name>default</servlet-name>/ node and remove the following node: \n \n<init-param> \n      <param-name>readonly</param-name> \n      <param-value>false</param-value> \n</init-param> \n \nRestart the service with the following command: \n \n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60449r889290_chk","severity":"medium","gid":"V-256774","rid":"SV-256774r889292_rule","stig_id":"VCST-70-000031","gtitle":"SRG-APP-000516-WSR-000174","fix_id":"F-60392r889291_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256775","code":"control 'SV-256775' do\n  title 'Security Token Service log data and records must be backed up onto a different system or media.'\n  desc 'Protection of Security Token Service log data includes ensuring log data is not accidentally lost or deleted. Backing up Security Token Service log records to an unrelated system or onto separate media than the system the web server is running on helps to ensure that, in the event of a catastrophic system failure, the log records will be retained.\n\n'\n  desc 'check', 'At the command prompt, run the following command: \n \n# rpm -V VMware-visl-integration|grep vmware-services-sso-services.conf|grep \"^..5......\" \n \nIf the command returns any output, this is a finding.'\n  desc 'fix', 'Navigate to and open: \n \n/etc/vmware-syslog/vmware-services-sso-services.conf \n \nCreate the file if it does not exist. \n \nSet the contents of the file as follows: \n \n#vmidentity logs \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/activedirectoryservice.log\" \n      Tag=\"activedirectoryservice\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/lookupsvc-init.log\" \n      Tag=\"ssolookupsvc-init\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/openidconnect.log\" \n      Tag=\"openidconnect\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/ssoAdminServer.log\" \n      Tag=\"ssoadminserver\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/svcaccountmgmt.log\" \n      Tag=\"svcaccountmgmt\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/tokenservice.log\" \n      Tag=\"tokenservice\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \n#sts health log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/sts-health-status.log.*\" \n      Tag=\"sts-health-status\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2} [[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2},[[:digit:]]{0,4}\" \n      Facility=\"local0\") \n#sts runtime log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/sts-runtime.log.*\" \n      Tag=\"sts-runtime\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      Facility=\"local0\") \n#gclogFile.0.current log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/gclogFile.*.current\" \n      Tag=\"gclog\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}+[[:digit:]]{0,4}\" \n      Facility=\"local0\") \n#tomcat log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/tomcat/localhost_access.log\" \n      Tag=\"sso-tomcat\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      Facility=\"local0\") \n#vmdir log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/vmdir/*.log\" \n      Tag=\"vmdir\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      Facility=\"local0\") \n#vmafd log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/vmafd/*.log\" \n      Tag=\"vmafd\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      Facility=\"local0\")'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCA STS'\n  tag check_id: 'C-60450r889293_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256775'\n  tag rid: 'SV-256775r889295_rule'\n  tag stig_id: 'VCST-70-000050'\n  tag gtitle: 'SRG-APP-000125-WSR-000071'\n  tag fix_id: 'F-60393r889294_fix'\n  tag satisfies: ['SRG-APP-000125-WSR-000071', 'SRG-APP-000358-WSR-000163']\n  tag 'documentable'\n  tag cci: ['CCI-001348', 'CCI-001851']\n  tag nist: ['AU-9 (2)', 'AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCA_STS_STIG_V1R2/controls/SV-256775.rb"},"title":"Security Token Service log data and records must be backed up onto a different system or media.","desc":"Protection of Security Token Service log data includes ensuring log data is not accidentally lost or deleted. Backing up Security Token Service log records to an unrelated system or onto separate media than the system the web server is running on helps to ensure that, in the event of a catastrophic system failure, the log records will be retained.\n\n","descriptions":{"default":"Protection of Security Token Service log data includes ensuring log data is not accidentally lost or deleted. Backing up Security Token Service log records to an unrelated system or onto separate media than the system the web server is running on helps to ensure that, in the event of a catastrophic system failure, the log records will be retained.\n\n","check":"At the command prompt, run the following command: \n \n# rpm -V VMware-visl-integration|grep vmware-services-sso-services.conf|grep \"^..5......\" \n \nIf the command returns any output, this is a finding.","fix":"Navigate to and open: \n \n/etc/vmware-syslog/vmware-services-sso-services.conf \n \nCreate the file if it does not exist. \n \nSet the contents of the file as follows: \n \n#vmidentity logs \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/activedirectoryservice.log\" \n      Tag=\"activedirectoryservice\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/lookupsvc-init.log\" \n      Tag=\"ssolookupsvc-init\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/openidconnect.log\" \n      Tag=\"openidconnect\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/ssoAdminServer.log\" \n      Tag=\"ssoadminserver\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/svcaccountmgmt.log\" \n      Tag=\"svcaccountmgmt\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/tokenservice.log\" \n      Tag=\"tokenservice\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\" \n      Facility=\"local0\") \n#sts health log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/sts-health-status.log.*\" \n      Tag=\"sts-health-status\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2} [[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2},[[:digit:]]{0,4}\" \n      Facility=\"local0\") \n#sts runtime log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/sts-runtime.log.*\" \n      Tag=\"sts-runtime\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      Facility=\"local0\") \n#gclogFile.0.current log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/gclogFile.*.current\" \n      Tag=\"gclog\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}+[[:digit:]]{0,4}\" \n      Facility=\"local0\") \n#tomcat log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/sso/tomcat/localhost_access.log\" \n      Tag=\"sso-tomcat\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      Facility=\"local0\") \n#vmdir log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/vmdir/*.log\" \n      Tag=\"vmdir\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      Facility=\"local0\") \n#vmafd log \ninput(type=\"imfile\" \n      File=\"/var/log/vmware/vmafd/*.log\" \n      Tag=\"vmafd\" \n      PersistStateInterval=\"200\" \n      Severity=\"info\" \n      Facility=\"local0\")"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCA STS"}],"tags":{"check_id":"C-60450r889293_chk","severity":"medium","gid":"V-256775","rid":"SV-256775r889295_rule","stig_id":"VCST-70-000050","gtitle":"SRG-APP-000125-WSR-000071","fix_id":"F-60393r889294_fix","satisfies":["SRG-APP-000125-WSR-000071","SRG-APP-000358-WSR-000163"],"documentable":null,"cci":["CCI-001348","CCI-001851"],"nist":["AU-9 (2)","AU-4 (1)"]}}],"groups":[{"id":"controls/SV-256745.rb","title":null,"controls":["SV-256745"]},{"id":"controls/SV-256746.rb","title":null,"controls":["SV-256746"]},{"id":"controls/SV-256747.rb","title":null,"controls":["SV-256747"]},{"id":"controls/SV-256748.rb","title":null,"controls":["SV-256748"]},{"id":"controls/SV-256749.rb","title":null,"controls":["SV-256749"]},{"id":"controls/SV-256750.rb","title":null,"controls":["SV-256750"]},{"id":"controls/SV-256751.rb","title":null,"controls":["SV-256751"]},{"id":"controls/SV-256752.rb","title":null,"controls":["SV-256752"]},{"id":"controls/SV-256753.rb","title":null,"controls":["SV-256753"]},{"id":"controls/SV-256754.rb","title":null,"controls":["SV-256754"]},{"id":"controls/SV-256755.rb","title":null,"controls":["SV-256755"]},{"id":"controls/SV-256756.rb","title":null,"controls":["SV-256756"]},{"id":"controls/SV-256757.rb","title":null,"controls":["SV-256757"]},{"id":"controls/SV-256758.rb","title":null,"controls":["SV-256758"]},{"id":"controls/SV-256759.rb","title":null,"controls":["SV-256759"]},{"id":"controls/SV-256760.rb","title":null,"controls":["SV-256760"]},{"id":"controls/SV-256761.rb","title":null,"controls":["SV-256761"]},{"id":"controls/SV-256762.rb","title":null,"controls":["SV-256762"]},{"id":"controls/SV-256763.rb","title":null,"controls":["SV-256763"]},{"id":"controls/SV-256764.rb","title":null,"controls":["SV-256764"]},{"id":"controls/SV-256765.rb","title":null,"controls":["SV-256765"]},{"id":"controls/SV-256766.rb","title":null,"controls":["SV-256766"]},{"id":"controls/SV-256767.rb","title":null,"controls":["SV-256767"]},{"id":"controls/SV-256768.rb","title":null,"controls":["SV-256768"]},{"id":"controls/SV-256769.rb","title":null,"controls":["SV-256769"]},{"id":"controls/SV-256770.rb","title":null,"controls":["SV-256770"]},{"id":"controls/SV-256771.rb","title":null,"controls":["SV-256771"]},{"id":"controls/SV-256772.rb","title":null,"controls":["SV-256772"]},{"id":"controls/SV-256773.rb","title":null,"controls":["SV-256773"]},{"id":"controls/SV-256774.rb","title":null,"controls":["SV-256774"]},{"id":"controls/SV-256775.rb","title":null,"controls":["SV-256775"]}],"name":"VMW_vSphere_7-0_vCA_STS_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"2e30109d131309af50a4e45bff3eb2c217c81596c1ea949b80d66361a817ff18","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
