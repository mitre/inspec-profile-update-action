control 'SV-214333' do
  title 'The Apache web server must accept only system-generated session identifiers.'
  desc 'Communication between a client and the web server is done using the HTTP protocol, but HTTP is a stateless protocol. To maintain a connection or session, a web server will generate a session identifier (ID) for each client session when the session is initiated. The session ID allows the web server to track a user session and, in many cases, the user, if the user previously logged on to a hosted application.

When a web server accepts session identifiers that are not generated by the web server, the web server creates an environment where session hijacking, such as session fixation, could be used to access hosted applications through session IDs that have already been authenticated. Forcing the web server to only accept web server-generated session IDs and to create new session IDs once a user is authenticated will limit session hijacking.

'
  desc 'check', %q(Review the <'INSTALL PATH'>\conf\httpd.conf file.

Verify the "mod_unique_id" is loaded.

If it does not exist, this is a finding.)
  desc 'fix', %q(Edit the <'INSTALL PATH'>\conf\httpd.conf file and load the "mod_unique_id" module.

Restart the Apache service.)
  impact 0.5
  ref 'DPMS Target Apache Server 2.4 Windows Server'
  tag check_id: 'C-15545r277502_chk'
  tag severity: 'medium'
  tag gid: 'V-214333'
  tag rid: 'SV-214333r879638_rule'
  tag stig_id: 'AS24-W1-000480'
  tag gtitle: 'SRG-APP-000223-WSR-000145'
  tag fix_id: 'F-15543r277503_fix'
  tag satisfies: ['SRG-APP-000223-WSR-000145', 'SRG-APP-000224-WSR-000135', 'SRG-APP-000224-WSR-000137', 'SRG-APP-000224-WSR-000138']
  tag 'documentable'
  tag legacy: ['SV-102497', 'V-92409']
  tag cci: ['CCI-001188', 'CCI-001664']
  tag nist: ['SC-23 (3)', 'SC-23 (3)']
end
