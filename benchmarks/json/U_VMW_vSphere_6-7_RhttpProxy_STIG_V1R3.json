{"controls":[{"id":"SV-240716","code":"control 'SV-240716' do\n  title 'The rhttpproxy must drop connections to disconnected clients.'\n  desc 'The rhttpproxy client connections that are established but no longer connected can consume resources that might otherwise be required by active connections. It is a best practice to terminate connections that are no longer connected to an active client.'\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/tcpKeepAlive/clientSocket/idleTimeSec' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<idleTimeSec>900</idleTimeSec>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<vmacore>/<tcpKeepAlive>/<clientSocket> block and configure <idleTimeSec> as follows:\n\n<idleTimeSec>900</idleTimeSec>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 RhttpProxy'\n  tag check_id: 'C-43949r679659_chk'\n  tag severity: 'medium'\n  tag gid: 'V-240716'\n  tag rid: 'SV-240716r879511_rule'\n  tag stig_id: 'VCRP-67-000001'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag fix_id: 'F-43908r679660_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_RhttpProxy_STIG_V1R3/controls/SV-240716.rb"},"title":"The rhttpproxy must drop connections to disconnected clients.","desc":"The rhttpproxy client connections that are established but no longer connected can consume resources that might otherwise be required by active connections. It is a best practice to terminate connections that are no longer connected to an active client.","descriptions":{"default":"The rhttpproxy client connections that are established but no longer connected can consume resources that might otherwise be required by active connections. It is a best practice to terminate connections that are no longer connected to an active client.","check":"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/tcpKeepAlive/clientSocket/idleTimeSec' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<idleTimeSec>900</idleTimeSec>\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<vmacore>/<tcpKeepAlive>/<clientSocket> block and configure <idleTimeSec> as follows:\n\n<idleTimeSec>900</idleTimeSec>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 RhttpProxy"}],"tags":{"check_id":"C-43949r679659_chk","severity":"medium","gid":"V-240716","rid":"SV-240716r879511_rule","stig_id":"VCRP-67-000001","gtitle":"SRG-APP-000001-WSR-000001","fix_id":"F-43908r679660_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-240717","code":"control 'SV-240717' do\n  title 'The rhttpproxy must set a limit on established connections.'\n  desc 'The rhttpproxy client connections must be limited to preserve system resources and continue servicing connections without interruption. Without a limit set, the system would be vulnerable to a trivial denial-of-service attack where connections are created en masse and vCenter resources are entirely consumed. The rhttproxy comes configured with a tested and supported value that must be maintained.'\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/http/maxConnections' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<maxConnections> 2048 </maxConnections>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<vmacore>/<http> block and configure <maxConnections> as follows:\n\n<maxConnections> 2048 </maxConnections>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 RhttpProxy'\n  tag check_id: 'C-43950r679662_chk'\n  tag severity: 'medium'\n  tag gid: 'V-240717'\n  tag rid: 'SV-240717r879511_rule'\n  tag stig_id: 'VCRP-67-000002'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag fix_id: 'F-43909r679663_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_RhttpProxy_STIG_V1R3/controls/SV-240717.rb"},"title":"The rhttpproxy must set a limit on established connections.","desc":"The rhttpproxy client connections must be limited to preserve system resources and continue servicing connections without interruption. Without a limit set, the system would be vulnerable to a trivial denial-of-service attack where connections are created en masse and vCenter resources are entirely consumed. The rhttproxy comes configured with a tested and supported value that must be maintained.","descriptions":{"default":"The rhttpproxy client connections must be limited to preserve system resources and continue servicing connections without interruption. Without a limit set, the system would be vulnerable to a trivial denial-of-service attack where connections are created en masse and vCenter resources are entirely consumed. The rhttproxy comes configured with a tested and supported value that must be maintained.","check":"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/http/maxConnections' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<maxConnections> 2048 </maxConnections>\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<vmacore>/<http> block and configure <maxConnections> as follows:\n\n<maxConnections> 2048 </maxConnections>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 RhttpProxy"}],"tags":{"check_id":"C-43950r679662_chk","severity":"medium","gid":"V-240717","rid":"SV-240717r879511_rule","stig_id":"VCRP-67-000002","gtitle":"SRG-APP-000001-WSR-000001","fix_id":"F-43909r679663_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-240718","code":"control 'SV-240718' do\n  title 'The rhttpproxy must be configured to operate solely with FIPS ciphers.'\n  desc 'The rhttpproxy ships with FIPS 140-2 validated OpenSSL cryptographic libraries and is configured by default to run in FIPS mode. This module is used for all crypto operations performed by rhttproxy, including protection of data-in-transit over the client TLS connection.'\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/ssl/fips' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<fips>true</fips>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<vmacore>/<ssl> block and configure <fips> as follows:\n\n<fips>true</fips>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 RhttpProxy'\n  tag check_id: 'C-43951r679665_chk'\n  tag severity: 'medium'\n  tag gid: 'V-240718'\n  tag rid: 'SV-240718r879519_rule'\n  tag stig_id: 'VCRP-67-000003'\n  tag gtitle: 'SRG-APP-000014-WSR-000006'\n  tag fix_id: 'F-43910r679666_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000068']\n  tag nist: ['AC-17 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_RhttpProxy_STIG_V1R3/controls/SV-240718.rb"},"title":"The rhttpproxy must be configured to operate solely with FIPS ciphers.","desc":"The rhttpproxy ships with FIPS 140-2 validated OpenSSL cryptographic libraries and is configured by default to run in FIPS mode. This module is used for all crypto operations performed by rhttproxy, including protection of data-in-transit over the client TLS connection.","descriptions":{"default":"The rhttpproxy ships with FIPS 140-2 validated OpenSSL cryptographic libraries and is configured by default to run in FIPS mode. This module is used for all crypto operations performed by rhttproxy, including protection of data-in-transit over the client TLS connection.","check":"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/ssl/fips' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<fips>true</fips>\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<vmacore>/<ssl> block and configure <fips> as follows:\n\n<fips>true</fips>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 RhttpProxy"}],"tags":{"check_id":"C-43951r679665_chk","severity":"medium","gid":"V-240718","rid":"SV-240718r879519_rule","stig_id":"VCRP-67-000003","gtitle":"SRG-APP-000014-WSR-000006","fix_id":"F-43910r679666_fix","documentable":null,"cci":["CCI-000068"],"nist":["AC-17 (2)"]}},{"id":"SV-240719","code":"control 'SV-240719' do\n  title 'The rhttpproxy must use cryptography to protect the integrity of remote sessions.'\n  desc '<0> [object Object]'\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/ssl/protocols' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<protocols>tls1.2</protocols>\n\nOR\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<vmacore>/<ssl> block and configure <protocols> as follows:\n\n<protocols>tls1.2</protocols>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 RhttpProxy'\n  tag check_id: 'C-43952r816677_chk'\n  tag severity: 'medium'\n  tag gid: 'V-240719'\n  tag rid: 'SV-240719r879520_rule'\n  tag stig_id: 'VCRP-67-000004'\n  tag gtitle: 'SRG-APP-000015-WSR-000014'\n  tag fix_id: 'F-43911r679669_fix'\n  tag cci: ['CCI-001453']\n  tag nist: ['AC-17 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_RhttpProxy_STIG_V1R3/controls/SV-240719.rb"},"title":"The rhttpproxy must use cryptography to protect the integrity of remote sessions.","desc":"<0> [object Object]","descriptions":{"default":"<0> [object Object]","check":"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/vmacore/ssl/protocols' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<protocols>tls1.2</protocols>\n\nOR\n\nXPath set is empty\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<vmacore>/<ssl> block and configure <protocols> as follows:\n\n<protocols>tls1.2</protocols>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 RhttpProxy"}],"tags":{"check_id":"C-43952r816677_chk","severity":"medium","gid":"V-240719","rid":"SV-240719r879520_rule","stig_id":"VCRP-67-000004","gtitle":"SRG-APP-000015-WSR-000014","fix_id":"F-43911r679669_fix","cci":["CCI-001453"],"nist":["AC-17 (2)"]}},{"id":"SV-240720","code":"control 'SV-240720' do\n  title 'The rhttpproxy must produce log records containing sufficient information to establish the source of events.'\n  desc 'After a security incident has occurred, investigators will often review log files to determine what happened, and determining the source of an event is crucial for forensics. The rhttpproxy must be configured for verbose logging to capture client IP addresses and the associated actions.'\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/log/level' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<level>verbose</level>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<log> block and configure <level> as follows:\n\n<level>verbose</level>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 RhttpProxy'\n  tag check_id: 'C-43953r679671_chk'\n  tag severity: 'medium'\n  tag gid: 'V-240720'\n  tag rid: 'SV-240720r879521_rule'\n  tag stig_id: 'VCRP-67-000005'\n  tag gtitle: 'SRG-APP-000016-WSR-000005'\n  tag fix_id: 'F-43912r679672_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000067']\n  tag nist: ['AC-17 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_RhttpProxy_STIG_V1R3/controls/SV-240720.rb"},"title":"The rhttpproxy must produce log records containing sufficient information to establish the source of events.","desc":"After a security incident has occurred, investigators will often review log files to determine what happened, and determining the source of an event is crucial for forensics. The rhttpproxy must be configured for verbose logging to capture client IP addresses and the associated actions.","descriptions":{"default":"After a security incident has occurred, investigators will often review log files to determine what happened, and determining the source of an event is crucial for forensics. The rhttpproxy must be configured for verbose logging to capture client IP addresses and the associated actions.","check":"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/log/level' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<level>verbose</level>\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<log> block and configure <level> as follows:\n\n<level>verbose</level>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 RhttpProxy"}],"tags":{"check_id":"C-43953r679671_chk","severity":"medium","gid":"V-240720","rid":"SV-240720r879521_rule","stig_id":"VCRP-67-000005","gtitle":"SRG-APP-000016-WSR-000005","fix_id":"F-43912r679672_fix","documentable":null,"cci":["CCI-000067"],"nist":["AC-17 (1)"]}},{"id":"SV-240721","code":"control 'SV-240721' do\n  title 'The rhttpproxy must have logging enabled.'\n  desc 'After a security incident has occurred, investigators will often review log files to determine what happened. The rhttpproxy must create logs upon service startup to capture information relevant to investigations.'\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/log/outputToFiles' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<outputToFiles>true</outputToFiles>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<log> block and configure <outputToFiles> as follows:\n\n<outputToFiles>true</outputToFiles>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 RhttpProxy'\n  tag check_id: 'C-43954r679674_chk'\n  tag severity: 'medium'\n  tag gid: 'V-240721'\n  tag rid: 'SV-240721r879562_rule'\n  tag stig_id: 'VCRP-67-000006'\n  tag gtitle: 'SRG-APP-000092-WSR-000055'\n  tag fix_id: 'F-43913r679675_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001464']\n  tag nist: ['AU-14 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_RhttpProxy_STIG_V1R3/controls/SV-240721.rb"},"title":"The rhttpproxy must have logging enabled.","desc":"After a security incident has occurred, investigators will often review log files to determine what happened. The rhttpproxy must create logs upon service startup to capture information relevant to investigations.","descriptions":{"default":"After a security incident has occurred, investigators will often review log files to determine what happened. The rhttpproxy must create logs upon service startup to capture information relevant to investigations.","check":"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/log/outputToFiles' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<outputToFiles>true</outputToFiles>\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the <config>/<log> block and configure <outputToFiles> as follows:\n\n<outputToFiles>true</outputToFiles>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 RhttpProxy"}],"tags":{"check_id":"C-43954r679674_chk","severity":"medium","gid":"V-240721","rid":"SV-240721r879562_rule","stig_id":"VCRP-67-000006","gtitle":"SRG-APP-000092-WSR-000055","fix_id":"F-43913r679675_fix","documentable":null,"cci":["CCI-001464"],"nist":["AU-14 (1)"]}},{"id":"SV-240722","code":"control 'SV-240722' do\n  title 'The rhttpproxy private key file must be protected from unauthorized access.'\n  desc \"The rhttpproxy's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients.\n\nBy gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the TLS traffic between a client and the web server.\"\n  desc 'check', 'At the command prompt, execute the following command:\n\n# stat -c \"%n permissions are %a, is owned by %U and group owned by %G\" /etc/vmware-rhttpproxy/ssl/rui.key\n\nExpected result:\n\n/etc/vmware-rhttpproxy/ssl/rui.key permissions are 600, is owned by root and group owned by root\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'At the command prompt, execute the following commands:\n\n# chmod 600 /etc/vmware-rhttpproxy/ssl/rui.key\n# chown root:root /etc/vmware-rhttpproxy/ssl/rui.key'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 RhttpProxy'\n  tag check_id: 'C-43955r679677_chk'\n  tag severity: 'medium'\n  tag gid: 'V-240722'\n  tag rid: 'SV-240722r879613_rule'\n  tag stig_id: 'VCRP-67-000007'\n  tag gtitle: 'SRG-APP-000176-WSR-000096'\n  tag fix_id: 'F-43914r679678_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000186']\n  tag nist: ['IA-5 (2) (a) (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_RhttpProxy_STIG_V1R3/controls/SV-240722.rb"},"title":"The rhttpproxy private key file must be protected from unauthorized access.","desc":"The rhttpproxy's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients.\n\nBy gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the TLS traffic between a client and the web server.","descriptions":{"default":"The rhttpproxy's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients.\n\nBy gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the TLS traffic between a client and the web server.","check":"At the command prompt, execute the following command:\n\n# stat -c \"%n permissions are %a, is owned by %U and group owned by %G\" /etc/vmware-rhttpproxy/ssl/rui.key\n\nExpected result:\n\n/etc/vmware-rhttpproxy/ssl/rui.key permissions are 600, is owned by root and group owned by root\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# chmod 600 /etc/vmware-rhttpproxy/ssl/rui.key\n# chown root:root /etc/vmware-rhttpproxy/ssl/rui.key"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 RhttpProxy"}],"tags":{"check_id":"C-43955r679677_chk","severity":"medium","gid":"V-240722","rid":"SV-240722r879613_rule","stig_id":"VCRP-67-000007","gtitle":"SRG-APP-000176-WSR-000096","fix_id":"F-43914r679678_fix","documentable":null,"cci":["CCI-000186"],"nist":["IA-5 (2) (a) (1)"]}},{"id":"SV-240723","code":"control 'SV-240723' do\n  title 'The rhttproxy must exclusively use the HTTPS protocol for client connections.'\n  desc 'Remotely accessing vCenter via the rhttpproxy involves sensitive information going over the wire. To protect the confidentiality and integrity of these communications, the rhttpproxy must be configured to use an encrypted session of HTTPS rather than plain-text HTTP. The SSL configuration block inside the rhttproxy configuration must be present and configured correctly to safely enable TLS.'\n  desc 'check', \"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/ssl' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<ssl>\n    <!-- The server private key file -->\n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey>\n    <!-- The server side certificate file -->\n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate>\n    <!-- vecs server name. Currently vecs runs on all node types. -->\n    <vecsServerName>localhost</vecsServerName>\n  </ssl>\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the first <ssl> block and set its content to the following:\n\n<ssl>\n    <!-- The server private key file -->\n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey>\n    <!-- The server side certificate file -->\n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate>\n    <!-- vecs server name. Currently vecs runs on all node types. -->\n    <vecsServerName>localhost</vecsServerName>\n</ssl>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 RhttpProxy'\n  tag check_id: 'C-43956r679680_chk'\n  tag severity: 'medium'\n  tag gid: 'V-240723'\n  tag rid: 'SV-240723r879692_rule'\n  tag stig_id: 'VCRP-67-000008'\n  tag gtitle: 'SRG-APP-000315-WSR-000003'\n  tag fix_id: 'F-43915r679681_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002314']\n  tag nist: ['AC-17 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_RhttpProxy_STIG_V1R3/controls/SV-240723.rb"},"title":"The rhttproxy must exclusively use the HTTPS protocol for client connections.","desc":"Remotely accessing vCenter via the rhttpproxy involves sensitive information going over the wire. To protect the confidentiality and integrity of these communications, the rhttpproxy must be configured to use an encrypted session of HTTPS rather than plain-text HTTP. The SSL configuration block inside the rhttproxy configuration must be present and configured correctly to safely enable TLS.","descriptions":{"default":"Remotely accessing vCenter via the rhttpproxy involves sensitive information going over the wire. To protect the confidentiality and integrity of these communications, the rhttpproxy must be configured to use an encrypted session of HTTPS rather than plain-text HTTP. The SSL configuration block inside the rhttproxy configuration must be present and configured correctly to safely enable TLS.","check":"At the command prompt, execute the following command:\n\n# xmllint --xpath '/config/ssl' /etc/vmware-rhttpproxy/config.xml\n\nExpected result:\n\n<ssl>\n    <!-- The server private key file -->\n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey>\n    <!-- The server side certificate file -->\n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate>\n    <!-- vecs server name. Currently vecs runs on all node types. -->\n    <vecsServerName>localhost</vecsServerName>\n  </ssl>\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open /etc/vmware-rhttpproxy/config.xml.\n\nLocate the first <ssl> block and set its content to the following:\n\n<ssl>\n    <!-- The server private key file -->\n    <privateKey>/etc/vmware-rhttpproxy/ssl/rui.key</privateKey>\n    <!-- The server side certificate file -->\n    <certificate>/etc/vmware-rhttpproxy/ssl/rui.crt</certificate>\n    <!-- vecs server name. Currently vecs runs on all node types. -->\n    <vecsServerName>localhost</vecsServerName>\n</ssl>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 RhttpProxy"}],"tags":{"check_id":"C-43956r679680_chk","severity":"medium","gid":"V-240723","rid":"SV-240723r879692_rule","stig_id":"VCRP-67-000008","gtitle":"SRG-APP-000315-WSR-000003","fix_id":"F-43915r679681_fix","documentable":null,"cci":["CCI-002314"],"nist":["AC-17 (1)"]}},{"id":"SV-240724","code":"control 'SV-240724' do\n  title 'The rhttpproxy log files must be moved to a permanent repository in accordance with site policy.'\n  desc 'The rhttpproxy produces a handful of logs that must be offloaded from the originating system. This information can then be used for diagnostic, forensic, or other purposes relevant to ensuring the availability and integrity of the hosted application.'\n  desc 'check', 'At the command prompt, execute the following command:\n\n# grep -v \"^#\" /etc/vmware-syslog/stig-services-rhttpproxy.conf\n\nExpected result:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\"\n      Tag=\"rhttpproxy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a finding.'\n  desc 'fix', 'Navigate to and open /etc/vmware-syslog/stig-services-rhttpproxy.conf.\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\"\n      Tag=\"rhttpproxy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 RhttpProxy'\n  tag check_id: 'C-43957r679683_chk'\n  tag severity: 'medium'\n  tag gid: 'V-240724'\n  tag rid: 'SV-240724r879731_rule'\n  tag stig_id: 'VCRP-67-000009'\n  tag gtitle: 'SRG-APP-000358-WSR-000063'\n  tag fix_id: 'F-43916r679684_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_RhttpProxy_STIG_V1R3/controls/SV-240724.rb"},"title":"The rhttpproxy log files must be moved to a permanent repository in accordance with site policy.","desc":"The rhttpproxy produces a handful of logs that must be offloaded from the originating system. This information can then be used for diagnostic, forensic, or other purposes relevant to ensuring the availability and integrity of the hosted application.","descriptions":{"default":"The rhttpproxy produces a handful of logs that must be offloaded from the originating system. This information can then be used for diagnostic, forensic, or other purposes relevant to ensuring the availability and integrity of the hosted application.","check":"At the command prompt, execute the following command:\n\n# grep -v \"^#\" /etc/vmware-syslog/stig-services-rhttpproxy.conf\n\nExpected result:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\"\n      Tag=\"rhttpproxy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open /etc/vmware-syslog/stig-services-rhttpproxy.conf.\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\"\n      Tag=\"rhttpproxy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 RhttpProxy"}],"tags":{"check_id":"C-43957r679683_chk","severity":"medium","gid":"V-240724","rid":"SV-240724r879731_rule","stig_id":"VCRP-67-000009","gtitle":"SRG-APP-000358-WSR-000063","fix_id":"F-43916r679684_fix","documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}},{"id":"SV-257282","code":"control 'SV-257282' do\n  title 'The version of RhttpProxy running on the system must be a supported version.'\n  desc 'Security flaws with software applications are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.\n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).\n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and to applications that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).'\n  desc 'check', 'RhttpProxy 6.7 is no longer supported by the vendor. If the system is running RhttpProxy 6.7, this is a finding.'\n  desc 'fix', 'Upgrade to a supported version.'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 6.7 RhttpProxy'\n  tag check_id: 'C-60966r918885_chk'\n  tag severity: 'high'\n  tag gid: 'V-257282'\n  tag rid: 'SV-257282r919261_rule'\n  tag stig_id: 'VCRP-67-000999'\n  tag gtitle: 'SRG-APP-000456-WSR-000187'\n  tag fix_id: 'F-53958r798705_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002605']\n  tag nist: ['SI-2 c']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_RhttpProxy_STIG_V1R3/controls/SV-257282.rb"},"title":"The version of RhttpProxy running on the system must be a supported version.","desc":"Security flaws with software applications are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.\n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).\n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and to applications that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).","descriptions":{"default":"Security flaws with software applications are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.\n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).\n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and to applications that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).","check":"RhttpProxy 6.7 is no longer supported by the vendor. If the system is running RhttpProxy 6.7, this is a finding.","fix":"Upgrade to a supported version."},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 RhttpProxy"}],"tags":{"check_id":"C-60966r918885_chk","severity":"high","gid":"V-257282","rid":"SV-257282r919261_rule","stig_id":"VCRP-67-000999","gtitle":"SRG-APP-000456-WSR-000187","fix_id":"F-53958r798705_fix","documentable":null,"cci":["CCI-002605"],"nist":["SI-2 c"]}}],"groups":[{"id":"controls/SV-240716.rb","title":null,"controls":["SV-240716"]},{"id":"controls/SV-240717.rb","title":null,"controls":["SV-240717"]},{"id":"controls/SV-240718.rb","title":null,"controls":["SV-240718"]},{"id":"controls/SV-240719.rb","title":null,"controls":["SV-240719"]},{"id":"controls/SV-240720.rb","title":null,"controls":["SV-240720"]},{"id":"controls/SV-240721.rb","title":null,"controls":["SV-240721"]},{"id":"controls/SV-240722.rb","title":null,"controls":["SV-240722"]},{"id":"controls/SV-240723.rb","title":null,"controls":["SV-240723"]},{"id":"controls/SV-240724.rb","title":null,"controls":["SV-240724"]},{"id":"controls/SV-257282.rb","title":null,"controls":["SV-257282"]}],"name":"VMW_vSphere_6-7_RhttpProxy_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"376d6b1e449984c74354f029a0f13cd55bd9c001685738ba6e05cebcd194ec1e","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
