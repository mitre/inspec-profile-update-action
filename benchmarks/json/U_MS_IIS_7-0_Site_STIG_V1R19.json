{"controls":[{"id":"SV-108119","code":"control 'SV-108119' do\n  title 'The installed version of IIS must be a supported version.'\n  desc 'Unsupported versions of the operating system do not contain new security-related features and security patches that address known vulnerabilities. Software or hardware no longer supported by the manufacturer or vendor are not maintained or updated for current vulnerabilities, leaving them open to potential attack.'\n  desc 'check', 'Procedure: Open IIS Manager, Select Help, Select About IIS.\n\nMicrosoft support for Internet Information Services (IIS) 7 ended 2020 January. If IIS 7 is installed on a system, this is a finding.'\n  desc 'fix', 'Upgrade IIS to a supported software version.'\n  impact 0.7\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-97855r1_chk'\n  tag severity: 'high'\n  tag gid: 'V-99015'\n  tag rid: 'SV-108119r1_rule'\n  tag stig_id: 'WG500'\n  tag gtitle: 'WG500-Installed version of IIS is unsupported.'\n  tag fix_id: 'F-104691r1_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000370']\n  tag nist: ['CM-6 (1)']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-108119.rb"},"title":"The installed version of IIS must be a supported version.","desc":"Unsupported versions of the operating system do not contain new security-related features and security patches that address known vulnerabilities. Software or hardware no longer supported by the manufacturer or vendor are not maintained or updated for current vulnerabilities, leaving them open to potential attack.","descriptions":{"default":"Unsupported versions of the operating system do not contain new security-related features and security patches that address known vulnerabilities. Software or hardware no longer supported by the manufacturer or vendor are not maintained or updated for current vulnerabilities, leaving them open to potential attack.","check":"Procedure: Open IIS Manager, Select Help, Select About IIS.\n\nMicrosoft support for Internet Information Services (IIS) 7 ended 2020 January. If IIS 7 is installed on a system, this is a finding.","fix":"Upgrade IIS to a supported software version."},"impact":0.7,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-97855r1_chk","severity":"high","gid":"V-99015","rid":"SV-108119r1_rule","stig_id":"WG500","gtitle":"WG500-Installed version of IIS is unsupported.","fix_id":"F-104691r1_fix","documentable":null,"cci":["CCI-000370"],"nist":["CM-6 (1)"]}},{"id":"SV-14278","code":"control 'SV-14278' do\n  title 'Remote authors or content providers will only use secure encrypted logons and connections to upload files to the Document Root directory.'\n  desc 'Logging in to a web server via a telnet session or using HTTP or FTP in order to upload documents to the web site is a risk if proper encryption is not utilized to protect the data being transmitted. A secure shell service or HTTPS needs to be installed and in use for these purposes.'\n  desc 'check', 'Query the SA to determine if there is a process for the uploading of files to the web site. \n\nThis process should include the requirement for the use of a secure encrypted logon and secure encrypted connection.\n\nIf the remote users are uploading files without utilizing approved encryption methods, this is a finding.'\n  desc 'fix', 'Use only secure encrypted logons and connections for uploading files to the web site.'\n  impact 0.7\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-30006r1_chk'\n  tag severity: 'high'\n  tag gid: 'V-13686'\n  tag rid: 'SV-14278r2_rule'\n  tag stig_id: 'WG235'\n  tag gtitle: 'WG235'\n  tag fix_id: 'F-26857r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-14278.rb"},"title":"Remote authors or content providers will only use secure encrypted logons and connections to upload files to the Document Root directory.","desc":"Logging in to a web server via a telnet session or using HTTP or FTP in order to upload documents to the web site is a risk if proper encryption is not utilized to protect the data being transmitted. A secure shell service or HTTPS needs to be installed and in use for these purposes.","descriptions":{"default":"Logging in to a web server via a telnet session or using HTTP or FTP in order to upload documents to the web site is a risk if proper encryption is not utilized to protect the data being transmitted. A secure shell service or HTTPS needs to be installed and in use for these purposes.","check":"Query the SA to determine if there is a process for the uploading of files to the web site. \n\nThis process should include the requirement for the use of a secure encrypted logon and secure encrypted connection.\n\nIf the remote users are uploading files without utilizing approved encryption methods, this is a finding.","fix":"Use only secure encrypted logons and connections for uploading files to the web site."},"impact":0.7,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-30006r1_chk","severity":"high","gid":"V-13686","rid":"SV-14278r2_rule","stig_id":"WG235","gtitle":"WG235","fix_id":"F-26857r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-2254","code":"control 'SV-2254' do\n  title 'Only web sites that have been fully reviewed and tested will exist on a production web server.'\n  desc 'In the case of a production web server, areas for content development and testing will not exist, as this type of content is only permissible on a development web site. The process of developing on a functional production web site entails a degree of trial and error and repeated testing. This process is often accomplished in an environment where debugging, sequencing, and formatting of content are the main goals. The opportunity for a malicious user to obtain files that reveal business logic and login schemes is high in this situation. The existence of such immature content on a web server represents a significant security risk that is totally avoidable.'\n  desc 'check', 'Query the ISSO, the SA, and the web administrator to find out if development web sites are being housed on production web servers. \n\nProposed Questions:\nDo you have development sites on your production web server?\nWhat is your process to get development web sites / content posted to the production server?\nDo you use under construction notices on production web pages?\n\nThe reviewer can also do a manual check or perform a navigation of the web site via a browser could be used to confirm the information provided from interviewing the web staff. Graphics or texts which proclaim Under Construction or Under Development are frequently used to mark folders or directories in that status.\n\nIf Under Construction or Under Development web content is discovered on the production web server, this is a finding.'\n  desc 'fix', 'The presences of portions of the web site that proclaim Under Construction or Under Development are clear indications that a production web server is being used for development. The web administrator will ensure that all pages that are in development are not installed on a production web server.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-29942r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-2254'\n  tag rid: 'SV-2254r3_rule'\n  tag stig_id: 'WG260'\n  tag gtitle: 'WG260'\n  tag fix_id: 'F-26813r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-2254.rb"},"title":"Only web sites that have been fully reviewed and tested will exist on a production web server.","desc":"In the case of a production web server, areas for content development and testing will not exist, as this type of content is only permissible on a development web site. The process of developing on a functional production web site entails a degree of trial and error and repeated testing. This process is often accomplished in an environment where debugging, sequencing, and formatting of content are the main goals. The opportunity for a malicious user to obtain files that reveal business logic and login schemes is high in this situation. The existence of such immature content on a web server represents a significant security risk that is totally avoidable.","descriptions":{"default":"In the case of a production web server, areas for content development and testing will not exist, as this type of content is only permissible on a development web site. The process of developing on a functional production web site entails a degree of trial and error and repeated testing. This process is often accomplished in an environment where debugging, sequencing, and formatting of content are the main goals. The opportunity for a malicious user to obtain files that reveal business logic and login schemes is high in this situation. The existence of such immature content on a web server represents a significant security risk that is totally avoidable.","check":"Query the ISSO, the SA, and the web administrator to find out if development web sites are being housed on production web servers. \n\nProposed Questions:\nDo you have development sites on your production web server?\nWhat is your process to get development web sites / content posted to the production server?\nDo you use under construction notices on production web pages?\n\nThe reviewer can also do a manual check or perform a navigation of the web site via a browser could be used to confirm the information provided from interviewing the web staff. Graphics or texts which proclaim Under Construction or Under Development are frequently used to mark folders or directories in that status.\n\nIf Under Construction or Under Development web content is discovered on the production web server, this is a finding.","fix":"The presences of portions of the web site that proclaim Under Construction or Under Development are clear indications that a production web server is being used for development. The web administrator will ensure that all pages that are in development are not installed on a production web server."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-29942r4_chk","severity":"medium","gid":"V-2254","rid":"SV-2254r3_rule","stig_id":"WG260","gtitle":"WG260","fix_id":"F-26813r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32323","code":"control 'SV-32323' do\n  title 'Web sites must limit the number of simultaneous requests.'\n  desc 'Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a web-site, facilitating a Denial of Service attack. Mitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests per IP address and may include, where feasible, limiting parameter values associated with keepalive (i.e., a parameter used to limit the amount of time a connection may be inactive).'\n  desc 'check', '1. Open an administrator command prompt.\n2. CD \\\\Windows\\\\system32\\\\inetsrv\n3. Enter the command:\nappcmd list config /section:system.applicationHost/sites > out.txt (opens output in Notepad).\n4. Review the results and verify each website has a value greater than zero listed for maxconnections parameter.\n\nIf not, this is a finding.\n\nIf nothing is listed, this is also a finding.'\n  desc 'fix', %q(For the site under review, determine the maximum number of connections needed.\n\n1. Open an administrator command prompt.\n2. CD \\Windows\\system32\\inetserv\n3. Enter the command:\nappcmd set config -section:system.applicationHost/sites \"/[name='Default Web Site'].limits.maxConnections:X\" /commit:apphost\n\nNote: Replace SITENAME with the site under review and X with the maximum number of connections allowable.\n\n4. Enter the command to verify changes:\nappcmd list config –section:system.applicationHost/sites>out.txt (opens output in Notepad).)\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32730r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-2240'\n  tag rid: 'SV-32323r6_rule'\n  tag stig_id: 'WG110 IIS7'\n  tag gtitle: 'WG110'\n  tag fix_id: 'F-29195r6_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32323.rb"},"title":"Web sites must limit the number of simultaneous requests.","desc":"Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a web-site, facilitating a Denial of Service attack. Mitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests per IP address and may include, where feasible, limiting parameter values associated with keepalive (i.e., a parameter used to limit the amount of time a connection may be inactive).","descriptions":{"default":"Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a web-site, facilitating a Denial of Service attack. Mitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests per IP address and may include, where feasible, limiting parameter values associated with keepalive (i.e., a parameter used to limit the amount of time a connection may be inactive).","check":"1. Open an administrator command prompt.\n2. CD \\Windows\\system32\\inetsrv\n3. Enter the command:\nappcmd list config /section:system.applicationHost/sites > out.txt (opens output in Notepad).\n4. Review the results and verify each website has a value greater than zero listed for maxconnections parameter.\n\nIf not, this is a finding.\n\nIf nothing is listed, this is also a finding.","fix":"For the site under review, determine the maximum number of connections needed.\n\n1. Open an administrator command prompt.\n2. CD \\Windows\\system32\\inetserv\n3. Enter the command:\nappcmd set config -section:system.applicationHost/sites \"/[name='Default Web Site'].limits.maxConnections:X\" /commit:apphost\n\nNote: Replace SITENAME with the site under review and X with the maximum number of connections allowable.\n\n4. Enter the command to verify changes:\nappcmd list config –section:system.applicationHost/sites>out.txt (opens output in Notepad)."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32730r4_chk","severity":"medium","gid":"V-2240","rid":"SV-32323r6_rule","stig_id":"WG110 IIS7","gtitle":"WG110","fix_id":"F-29195r6_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32324","code":"control 'SV-32324' do\n  title 'Each readable web document directory must contain a default, home, index, or equivalent document.'\n  desc 'The goal is to control the web users experience in navigating any portion of the web document root directories. Ensuring all web content directories have at least the equivalent of an index.html file is a significant factor to accomplish this end. Also, enumeration techniques, such as URL parameter manipulation, rely upon being able to obtain information about the web server’s directory structure by locating directories with default pages. This practice helps ensure the anonymous web user will not obtain directory browsing information or an error message revealing the server type and version.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click Default Document.\n4. In the Actions Pane, verify the Default Document feature is enabled. If not, this is a finding.\n5. Review the document types. \n6. Click the Content View tab and ensure there is a document of that type in the directory. If not, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click Default Document.\n4. In the Action pane select Enable.\n5. Click the Content View tab and ensure there is a document of that type in the directory.'\n  impact 0.3\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32731r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-2245'\n  tag rid: 'SV-32324r2_rule'\n  tag stig_id: 'WG170 IIS7'\n  tag gtitle: 'WG170'\n  tag fix_id: 'F-29061r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32324.rb"},"title":"Each readable web document directory must contain a default, home, index, or equivalent document.","desc":"The goal is to control the web users experience in navigating any portion of the web document root directories. Ensuring all web content directories have at least the equivalent of an index.html file is a significant factor to accomplish this end. Also, enumeration techniques, such as URL parameter manipulation, rely upon being able to obtain information about the web server’s directory structure by locating directories with default pages. This practice helps ensure the anonymous web user will not obtain directory browsing information or an error message revealing the server type and version.","descriptions":{"default":"The goal is to control the web users experience in navigating any portion of the web document root directories. Ensuring all web content directories have at least the equivalent of an index.html file is a significant factor to accomplish this end. Also, enumeration techniques, such as URL parameter manipulation, rely upon being able to obtain information about the web server’s directory structure by locating directories with default pages. This practice helps ensure the anonymous web user will not obtain directory browsing information or an error message revealing the server type and version.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click Default Document.\n4. In the Actions Pane, verify the Default Document feature is enabled. If not, this is a finding.\n5. Review the document types. \n6. Click the Content View tab and ensure there is a document of that type in the directory. If not, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click Default Document.\n4. In the Action pane select Enable.\n5. Click the Content View tab and ensure there is a document of that type in the directory."},"impact":0.3,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32731r1_chk","severity":"low","gid":"V-2245","rid":"SV-32324r2_rule","stig_id":"WG170 IIS7","gtitle":"WG170","fix_id":"F-29061r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32326","code":"control 'SV-32326' do\n  title 'All interactive programs must have restrictive access controls.'\n  desc 'CGI is a programming standard for interfacing external applications with information servers, such as HTTP or web servers. CGI, represented by all upper case letters, should not be confused with the .cgi file extension. The .cgi file extension does represent a CGI script, but CGI scripts may be written in a number of programming languages (e.g., PERL, C, PHP, and JavaScript), each having their own unique file extension.\n\nThe use of CGI scripts represent one of the most common and exploitable means of compromising a web server. By definition, CGI scripts are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not limited unless the SA or the Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs, and use the network.'\n  desc 'check', 'Determine whether scripts are used on the web server for the subject website. Common file extensions include, but are not limited to: .cgi, .pl, .vb, .class, .c, .php, .asp, and .aspx. If the web site does not utilize CGI, this finding is N/A.\n\nAll interactive programs must have restrictive permissions.\n1. Open the IIS Manager.\n2. Right-click on the Site name and select Explore.\n3. Search for the listed script extensions.\n4. Set the permissions to the CGI scripts as follows:\n     Administrators: FULL\n     TrustedInstaller: FULL\n     SYSTEM: FULL\n     ApplicationPoolId: READ\n     Custom Service Account: READ\n     Users: READ\nIf the permissions listed above are less restrictive, this is a finding.'\n  desc 'fix', 'All interactive programs must have restrictive permissions.\n1. Open the IIS Manager.\n2. Right-click on the Site name and select Explore.\n4. Search for the listed script extensions.\n5. Set the permissions to the CGI scripts as follows:\n     Administrators: FULL\n     TrustedInstaller: FULL\n     SYSTEM: FULL\n     ApplicationPoolId: READ\n     Custom Service Account: READ\n     Users: READ'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32732r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-2229'\n  tag rid: 'SV-32326r2_rule'\n  tag stig_id: 'WG410 IIS7'\n  tag gtitle: 'WG410'\n  tag fix_id: 'F-29058r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32326.rb"},"title":"All interactive programs must have restrictive access controls.","desc":"CGI is a programming standard for interfacing external applications with information servers, such as HTTP or web servers. CGI, represented by all upper case letters, should not be confused with the .cgi file extension. The .cgi file extension does represent a CGI script, but CGI scripts may be written in a number of programming languages (e.g., PERL, C, PHP, and JavaScript), each having their own unique file extension.\n\nThe use of CGI scripts represent one of the most common and exploitable means of compromising a web server. By definition, CGI scripts are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not limited unless the SA or the Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs, and use the network.","descriptions":{"default":"CGI is a programming standard for interfacing external applications with information servers, such as HTTP or web servers. CGI, represented by all upper case letters, should not be confused with the .cgi file extension. The .cgi file extension does represent a CGI script, but CGI scripts may be written in a number of programming languages (e.g., PERL, C, PHP, and JavaScript), each having their own unique file extension.\n\nThe use of CGI scripts represent one of the most common and exploitable means of compromising a web server. By definition, CGI scripts are executable by the operating system of the host server. While access control is provided via the web service, the execution of CGI programs is not limited unless the SA or the Web Manager takes specific measures. CGI programs can access and alter data files, launch other programs, and use the network.","check":"Determine whether scripts are used on the web server for the subject website. Common file extensions include, but are not limited to: .cgi, .pl, .vb, .class, .c, .php, .asp, and .aspx. If the web site does not utilize CGI, this finding is N/A.\n\nAll interactive programs must have restrictive permissions.\n1. Open the IIS Manager.\n2. Right-click on the Site name and select Explore.\n3. Search for the listed script extensions.\n4. Set the permissions to the CGI scripts as follows:\n     Administrators: FULL\n     TrustedInstaller: FULL\n     SYSTEM: FULL\n     ApplicationPoolId: READ\n     Custom Service Account: READ\n     Users: READ\nIf the permissions listed above are less restrictive, this is a finding.","fix":"All interactive programs must have restrictive permissions.\n1. Open the IIS Manager.\n2. Right-click on the Site name and select Explore.\n4. Search for the listed script extensions.\n5. Set the permissions to the CGI scripts as follows:\n     Administrators: FULL\n     TrustedInstaller: FULL\n     SYSTEM: FULL\n     ApplicationPoolId: READ\n     Custom Service Account: READ\n     Users: READ"},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32732r1_chk","severity":"medium","gid":"V-2229","rid":"SV-32326r2_rule","stig_id":"WG410 IIS7","gtitle":"WG410","fix_id":"F-29058r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32327","code":"control 'SV-32327' do\n  title 'All interactive programs must be placed in unique designated folders.'\n  desc 'CGI & ASP scripts represent one of the most common and exploitable means of compromising a web server.  All CGI & ASP program files must be segregated into their own unique folder to simplify the protection of these files. ASP scripts must be placed into a unique folder only containing other ASP scripts. JAVA and other technology-specific scripts must also be placed into their own unique folders. The placement of CGI, ASP, or equivalent scripts to special folders gives the Web Manager or the SA control over what goes into those folders and to facilitate access control at the folder level.'\n  desc 'check', 'Determine whether scripts are used on the web server for the target website. Common file extensions include, but are not limited to: .cgi, .pl, .vb, .class, .c, .php, .asp, and .aspx.  If the web site does not utilize CGI or ASP, this finding is N/A.\n\nAll interactive programs must be placed in unique designated folders based on CGI or ASP script type.\n\n1. Open the IIS Manager.\n2. Right-click on the Site name and select Explore.\n3. Search for the listed script extensions.\n4. Each script type must be in its unique designated folder. If scripts are not segregated from web content and in their own unique folders, then this is a finding.'\n  desc 'fix', 'All interactive programs must be placed in unique designated folders based on CGI or ASP script type.\n\n1. Open the IIS Manager.\n2. Right-click on the Site name and select Explore.\n3. Search for the listed script extensions.\n4. Move each script type to its unique designated folder.\n5. Set the permissions to the scripts folders as follows:\n     Administrators: FULL\n     TrustedInstaller: FULL\n     SYSTEM: FULL\n     ApplicationPoolId: READ\n     Custom Service Account: READ\n     Users: READ'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32733r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-2228'\n  tag rid: 'SV-32327r2_rule'\n  tag stig_id: 'WG400 IIS7'\n  tag gtitle: 'WG400'\n  tag fix_id: 'F-29057r1_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32327.rb"},"title":"All interactive programs must be placed in unique designated folders.","desc":"CGI & ASP scripts represent one of the most common and exploitable means of compromising a web server.  All CGI & ASP program files must be segregated into their own unique folder to simplify the protection of these files. ASP scripts must be placed into a unique folder only containing other ASP scripts. JAVA and other technology-specific scripts must also be placed into their own unique folders. The placement of CGI, ASP, or equivalent scripts to special folders gives the Web Manager or the SA control over what goes into those folders and to facilitate access control at the folder level.","descriptions":{"default":"CGI & ASP scripts represent one of the most common and exploitable means of compromising a web server.  All CGI & ASP program files must be segregated into their own unique folder to simplify the protection of these files. ASP scripts must be placed into a unique folder only containing other ASP scripts. JAVA and other technology-specific scripts must also be placed into their own unique folders. The placement of CGI, ASP, or equivalent scripts to special folders gives the Web Manager or the SA control over what goes into those folders and to facilitate access control at the folder level.","check":"Determine whether scripts are used on the web server for the target website. Common file extensions include, but are not limited to: .cgi, .pl, .vb, .class, .c, .php, .asp, and .aspx.  If the web site does not utilize CGI or ASP, this finding is N/A.\n\nAll interactive programs must be placed in unique designated folders based on CGI or ASP script type.\n\n1. Open the IIS Manager.\n2. Right-click on the Site name and select Explore.\n3. Search for the listed script extensions.\n4. Each script type must be in its unique designated folder. If scripts are not segregated from web content and in their own unique folders, then this is a finding.","fix":"All interactive programs must be placed in unique designated folders based on CGI or ASP script type.\n\n1. Open the IIS Manager.\n2. Right-click on the Site name and select Explore.\n3. Search for the listed script extensions.\n4. Move each script type to its unique designated folder.\n5. Set the permissions to the scripts folders as follows:\n     Administrators: FULL\n     TrustedInstaller: FULL\n     SYSTEM: FULL\n     ApplicationPoolId: READ\n     Custom Service Account: READ\n     Users: READ"},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32733r1_chk","severity":"medium","gid":"V-2228","rid":"SV-32327r2_rule","stig_id":"WG400 IIS7","gtitle":"WG400","fix_id":"F-29057r1_fix","documentable":null,"responsibility":["System Administrator","Web Administrator"]}},{"id":"SV-32329","code":"control 'SV-32329' do\n  title 'Web server/site administration must be performed over a secure path.'\n  desc 'Logging into a web server remotely using an unencrypted protocol or service when performing updates and maintenance is a major risk.  Data, such as user account, is transmitted in plaintext and can easily be compromised.  When performing remote administrative tasks, a protocol or service that encrypts the communication channel must be used.\n\nAn alternative to remote administration of the web server is to perform web server administration locally at the console.  Local administration at the console implies physical access to the server.'\n  desc 'check', 'If web administration is performed at the console, this check is NA.\n\nIf web administration is performed remotely the following checks will apply:\n\nIf administration of the server is performed remotely, it will only be performed securely by system administrators.\n\nIf web site administration or web application administration has been delegated, those users will be documented and approved by the ISSO.\n\nRemote administration must be in compliance with any requirements contained within the Windows Server STIGs, and any applicable network STIGs.\n\nRemote administration of any kind will be restricted to documented and authorized personnel.\n\nAll users performing remote administration must be authenticated.\n\nAll remote sessions will be encrypted and they will utilize FIPS 140-2 approved protocols.\n\nFIPS 140-2 approved TLS versions include TLS V1.0 or greater.\n\nReview with site management how remote administration, if applicable, is configured on the web site.\n\nIf remote management meets the criteria listed above, this is not a finding.\n\nIf remote management is utilized and does not meet the criteria listed above, this is a finding.'\n  desc 'fix', 'Ensure the web server administration is only performed over a secure path.'\n  impact 0.7\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32735r2_chk'\n  tag severity: 'high'\n  tag gid: 'V-2249'\n  tag rid: 'SV-32329r3_rule'\n  tag stig_id: 'WG230 IIS7'\n  tag gtitle: 'WG230'\n  tag fix_id: 'F-29062r2_fix'\n  tag 'documentable'\n  tag responsibility: 'System Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32329.rb"},"title":"Web server/site administration must be performed over a secure path.","desc":"Logging into a web server remotely using an unencrypted protocol or service when performing updates and maintenance is a major risk.  Data, such as user account, is transmitted in plaintext and can easily be compromised.  When performing remote administrative tasks, a protocol or service that encrypts the communication channel must be used.\n\nAn alternative to remote administration of the web server is to perform web server administration locally at the console.  Local administration at the console implies physical access to the server.","descriptions":{"default":"Logging into a web server remotely using an unencrypted protocol or service when performing updates and maintenance is a major risk.  Data, such as user account, is transmitted in plaintext and can easily be compromised.  When performing remote administrative tasks, a protocol or service that encrypts the communication channel must be used.\n\nAn alternative to remote administration of the web server is to perform web server administration locally at the console.  Local administration at the console implies physical access to the server.","check":"If web administration is performed at the console, this check is NA.\n\nIf web administration is performed remotely the following checks will apply:\n\nIf administration of the server is performed remotely, it will only be performed securely by system administrators.\n\nIf web site administration or web application administration has been delegated, those users will be documented and approved by the ISSO.\n\nRemote administration must be in compliance with any requirements contained within the Windows Server STIGs, and any applicable network STIGs.\n\nRemote administration of any kind will be restricted to documented and authorized personnel.\n\nAll users performing remote administration must be authenticated.\n\nAll remote sessions will be encrypted and they will utilize FIPS 140-2 approved protocols.\n\nFIPS 140-2 approved TLS versions include TLS V1.0 or greater.\n\nReview with site management how remote administration, if applicable, is configured on the web site.\n\nIf remote management meets the criteria listed above, this is not a finding.\n\nIf remote management is utilized and does not meet the criteria listed above, this is a finding.","fix":"Ensure the web server administration is only performed over a secure path."},"impact":0.7,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32735r2_chk","severity":"high","gid":"V-2249","rid":"SV-32329r3_rule","stig_id":"WG230 IIS7","gtitle":"WG230","fix_id":"F-29062r2_fix","documentable":null,"responsibility":"System Administrator"}},{"id":"SV-32331","code":"control 'SV-32331' do\n  title 'Access to the web content and script directories must be restricted.'\n  desc 'Excessive permission for the anonymous web user account is a common fault contributing to the compromise of a web server. If this account is able to upload and execute files on the web server, the organization or owner of the server will no longer have control of the asset.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. In the Action Pane select Edit Permissions.\n4. Select the Security tab.\n5. Review the permissions for the accounts. If the IUSR or Everyone Account permission is greater than read, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. In the Action Pane select Edit Permissions.\n4. Select the Security tab.\n5. Set the permissions for the accounts IUSR and Everyone to read.'\n  impact 0.7\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32737r1_chk'\n  tag severity: 'high'\n  tag gid: 'V-2258'\n  tag rid: 'SV-32331r2_rule'\n  tag stig_id: 'WG290 IIS7'\n  tag gtitle: 'WG290'\n  tag fix_id: 'F-29064r1_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32331.rb"},"title":"Access to the web content and script directories must be restricted.","desc":"Excessive permission for the anonymous web user account is a common fault contributing to the compromise of a web server. If this account is able to upload and execute files on the web server, the organization or owner of the server will no longer have control of the asset.","descriptions":{"default":"Excessive permission for the anonymous web user account is a common fault contributing to the compromise of a web server. If this account is able to upload and execute files on the web server, the organization or owner of the server will no longer have control of the asset.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. In the Action Pane select Edit Permissions.\n4. Select the Security tab.\n5. Review the permissions for the accounts. If the IUSR or Everyone Account permission is greater than read, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. In the Action Pane select Edit Permissions.\n4. Select the Security tab.\n5. Set the permissions for the accounts IUSR and Everyone to read."},"impact":0.7,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32737r1_chk","severity":"high","gid":"V-2258","rid":"SV-32331r2_rule","stig_id":"WG290 IIS7","gtitle":"WG290","fix_id":"F-29064r1_fix","documentable":null,"responsibility":["System Administrator","Web Administrator"]}},{"id":"SV-32333","code":"control 'SV-32333' do\n  title 'A web site must not contain a robots.txt file.'\n  desc 'Search engines are constantly at work on the Internet.  Search engines are augmented by agents, often referred to as spiders or bots, which endeavor to capture and catalog web-site content.  In turn, these search engines make the content they obtain and catalog available to any public web user. \n\nTo request that a well behaved search engine not crawl and catalog a site, the web site may contain a file called robots.txt.  This file contains directories and files that the web server SA desires not be crawled or cataloged, but this file can also be used, by an attacker or poorly coded search engine, as a directory and file index to a site.  This information may be used to reduce an attacker’s time searching and traversing the web site to find files that might be relevant.  If information on the web site needs to be protected from search engines and public view, other methods must be used.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click the Content View tab.\n4. If the robots.txt file does exist, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Under the Actions pane, click Explore.\n4. Delete the robots.txt file.\n\nNOTE: If there is information on the web site that needs protection from search engines and public view, then other methods must be used to safeguard the data.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32739r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-2260'\n  tag rid: 'SV-32333r4_rule'\n  tag stig_id: 'WG310 IIS7'\n  tag gtitle: 'WG310'\n  tag fix_id: 'F-29066r5_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32333.rb"},"title":"A web site must not contain a robots.txt file.","desc":"Search engines are constantly at work on the Internet.  Search engines are augmented by agents, often referred to as spiders or bots, which endeavor to capture and catalog web-site content.  In turn, these search engines make the content they obtain and catalog available to any public web user. \n\nTo request that a well behaved search engine not crawl and catalog a site, the web site may contain a file called robots.txt.  This file contains directories and files that the web server SA desires not be crawled or cataloged, but this file can also be used, by an attacker or poorly coded search engine, as a directory and file index to a site.  This information may be used to reduce an attacker’s time searching and traversing the web site to find files that might be relevant.  If information on the web site needs to be protected from search engines and public view, other methods must be used.","descriptions":{"default":"Search engines are constantly at work on the Internet.  Search engines are augmented by agents, often referred to as spiders or bots, which endeavor to capture and catalog web-site content.  In turn, these search engines make the content they obtain and catalog available to any public web user. \n\nTo request that a well behaved search engine not crawl and catalog a site, the web site may contain a file called robots.txt.  This file contains directories and files that the web server SA desires not be crawled or cataloged, but this file can also be used, by an attacker or poorly coded search engine, as a directory and file index to a site.  This information may be used to reduce an attacker’s time searching and traversing the web site to find files that might be relevant.  If information on the web site needs to be protected from search engines and public view, other methods must be used.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click the Content View tab.\n4. If the robots.txt file does exist, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Under the Actions pane, click Explore.\n4. Delete the robots.txt file.\n\nNOTE: If there is information on the web site that needs protection from search engines and public view, then other methods must be used to safeguard the data."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32739r4_chk","severity":"medium","gid":"V-2260","rid":"SV-32333r4_rule","stig_id":"WG310 IIS7","gtitle":"WG310","fix_id":"F-29066r5_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32334","code":"control 'SV-32334' do\n  title 'A private web server must utilize an approved TLS version.'\n  desc 'Transport Layer Security (TLS) encryption is a required security setting for a private web server. Encryption of private information is essential to ensuring data confidentiality. If private information is not encrypted, it can be intercepted and easily read by an unauthorized party. A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double click the SSL Settings Icon.\n4. Ensure Require SSL and Require SSL 128-Bit are checked.\n\nNote: If the Required SSL 128-Bit setting is not visible, the setting can be viewed by clicking the site under review and then opening the Configuration Editor. Switch to the section, the dropdown at the top of the configuration editor, system.webServer/security/access. The value for sslFlags should be ssl128.\n\nIf not, this is a finding.\n\nIf the site requires SSL and 128-bit encryption, then the version of SSL\\\\TLS also needs to be verified. \n\nThe following registry keys need to exist and be set to not allow anything lower than TLS. This can be accomplished by ensuring the following value exists in each of the keys: \n\nEnabled REG_DWORD 0 \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\PCT 1.0\\\\Client \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\PCT 1.0\\\\Server \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 2.0\\\\Client \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 2.0\\\\Server \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 3.0\\\\Client \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 3.0\\\\Server \n\nIf these keys are not set to a DWORD value of 0, this is a finding. \n\nIf the keys do not contain the value \"Enabled\", this would also be a finding. \n\nThe keys for TLS 1.0 do not require the \"Enabled\" value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS. If the \"Enabled\" value is present and set to 0, this is a finding.\n\nTLS 1.1 and 1.2 are not supported in versions prior to IIS 7.5. If the version of IIS is prior to 7.5, the check for TLS 1.1 and 1.2 is NA.\n\nTLS 1.1 and 1.2 are not enabled by default, therefore the following registry keys must exist and contain the the following values to enable TLS 1.1 and 1.2.\n\nDisabledByDefault REG_DWORD 0\nEnabled REG_DWORD 1 \n\nHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\TLS 1.1\\\\Client\n\nHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\TLS 1.1\\\\Server\n\nHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\TLS 1.2\\\\Client\n\nHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\TLS 1.2\\\\Server\n\nIf any of the registry keys for TLS 1.1 or TLS 1.2 are not present or are not set correctly, this is a finding.\n\nNOTE: In some cases the web servers are configured in an environment to support load balancing. This configuration most likely utilizes a content switch to control traffic to the various web servers. In this situation, the SSL certificate for the web sites may be installed on the content switch vs. the individual web sites. This solution is acceptable as long as the web servers are isolated from the general population LAN. We do not want users to have the ability to bypass the content switch to access the web sites.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double click the SSL Settings Icon.\n4. Click the Require SSL and Require SSL 128-Bit check boxes.\n\nNote: If the Required SSL 128-Bit setting is not visible, the setting can be set by clicking the site node and then opening the Configuration Editor. Switch to the section, the dropdown at the top of the configuration editor, system.webServer/security/access. Click the value beside the sslFlags and select ssl128 in the dropdown list.\n\n5. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS. Ensure the following value exists in each of the keys: \n\nEnabled REG_DWORD 0 \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\PCT 1.0\\\\Client \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\PCT 1.0\\\\Server \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 2.0\\\\Client \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 2.0\\\\Server \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 3.0\\\\Client \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 3.0\\\\Server \n\nThe keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32740r8_chk'\n  tag severity: 'medium'\n  tag gid: 'V-2262'\n  tag rid: 'SV-32334r5_rule'\n  tag stig_id: 'WG340 IIS7'\n  tag gtitle: 'WG340'\n  tag fix_id: 'F-29067r5_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32334.rb"},"title":"A private web server must utilize an approved TLS version.","desc":"Transport Layer Security (TLS) encryption is a required security setting for a private web server. Encryption of private information is essential to ensuring data confidentiality. If private information is not encrypted, it can be intercepted and easily read by an unauthorized party. A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.","descriptions":{"default":"Transport Layer Security (TLS) encryption is a required security setting for a private web server. Encryption of private information is essential to ensuring data confidentiality. If private information is not encrypted, it can be intercepted and easily read by an unauthorized party. A private web server must use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions must be disabled.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double click the SSL Settings Icon.\n4. Ensure Require SSL and Require SSL 128-Bit are checked.\n\nNote: If the Required SSL 128-Bit setting is not visible, the setting can be viewed by clicking the site under review and then opening the Configuration Editor. Switch to the section, the dropdown at the top of the configuration editor, system.webServer/security/access. The value for sslFlags should be ssl128.\n\nIf not, this is a finding.\n\nIf the site requires SSL and 128-bit encryption, then the version of SSL\\TLS also needs to be verified. \n\nThe following registry keys need to exist and be set to not allow anything lower than TLS. This can be accomplished by ensuring the following value exists in each of the keys: \n\nEnabled REG_DWORD 0 \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\PCT 1.0\\Client \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\PCT 1.0\\Server \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 2.0\\Client \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 2.0\\Server \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 3.0\\Client \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 3.0\\Server \n\nIf these keys are not set to a DWORD value of 0, this is a finding. \n\nIf the keys do not contain the value \"Enabled\", this would also be a finding. \n\nThe keys for TLS 1.0 do not require the \"Enabled\" value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS. If the \"Enabled\" value is present and set to 0, this is a finding.\n\nTLS 1.1 and 1.2 are not supported in versions prior to IIS 7.5. If the version of IIS is prior to 7.5, the check for TLS 1.1 and 1.2 is NA.\n\nTLS 1.1 and 1.2 are not enabled by default, therefore the following registry keys must exist and contain the the following values to enable TLS 1.1 and 1.2.\n\nDisabledByDefault REG_DWORD 0\nEnabled REG_DWORD 1 \n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.1\\Client\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.1\\Server\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Client\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Server\n\nIf any of the registry keys for TLS 1.1 or TLS 1.2 are not present or are not set correctly, this is a finding.\n\nNOTE: In some cases the web servers are configured in an environment to support load balancing. This configuration most likely utilizes a content switch to control traffic to the various web servers. In this situation, the SSL certificate for the web sites may be installed on the content switch vs. the individual web sites. This solution is acceptable as long as the web servers are isolated from the general population LAN. We do not want users to have the ability to bypass the content switch to access the web sites.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double click the SSL Settings Icon.\n4. Click the Require SSL and Require SSL 128-Bit check boxes.\n\nNote: If the Required SSL 128-Bit setting is not visible, the setting can be set by clicking the site node and then opening the Configuration Editor. Switch to the section, the dropdown at the top of the configuration editor, system.webServer/security/access. Click the value beside the sslFlags and select ssl128 in the dropdown list.\n\n5. Set the version of SSL/TLS by creating and setting the following registry to not allow anything lower than TLS. Ensure the following value exists in each of the keys: \n\nEnabled REG_DWORD 0 \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\PCT 1.0\\Client \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\PCT 1.0\\Server \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 2.0\\Client \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 2.0\\Server \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 3.0\\Client \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 3.0\\Server \n\nThe keys for TLS 1.0 do not require the Enabled value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32740r8_chk","severity":"medium","gid":"V-2262","rid":"SV-32334r5_rule","stig_id":"WG340 IIS7","gtitle":"WG340","fix_id":"F-29067r5_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32335","code":"control 'SV-32335' do\n  title 'Unapproved script mappings in IIS 7 must be removed.'\n  desc 'IIS 7 will either allow or deny script execution based on file extension. The ability to control script execution is controlled through two features with IIS 7, Request Filtering and Handler Mappings.\n\nFor Handler Mappings, the ISSO must document and approve all allowable file extensions the web site allows (white list) and denies (black list) by the web-site. The white list and black list will be compared to the Handler Mappings in IIS 7. Handler Mappings at the site level take precedence over Handler Mappings at the server level.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click on Handler Mappings.\n\nIf any file extensions on the black list are configured with a Handler Mapping, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click on Handler Mappings.\n4. Remove any file extensions which are listed on the black list and for which a Handler Mapping has been configured.'\n  impact 0.7\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32741r2_chk'\n  tag severity: 'high'\n  tag gid: 'V-2267'\n  tag rid: 'SV-32335r4_rule'\n  tag stig_id: 'WA000-WI050 IIS7'\n  tag gtitle: 'WA000-WI050'\n  tag fix_id: 'F-28820r2_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32335.rb"},"title":"Unapproved script mappings in IIS 7 must be removed.","desc":"IIS 7 will either allow or deny script execution based on file extension. The ability to control script execution is controlled through two features with IIS 7, Request Filtering and Handler Mappings.\n\nFor Handler Mappings, the ISSO must document and approve all allowable file extensions the web site allows (white list) and denies (black list) by the web-site. The white list and black list will be compared to the Handler Mappings in IIS 7. Handler Mappings at the site level take precedence over Handler Mappings at the server level.","descriptions":{"default":"IIS 7 will either allow or deny script execution based on file extension. The ability to control script execution is controlled through two features with IIS 7, Request Filtering and Handler Mappings.\n\nFor Handler Mappings, the ISSO must document and approve all allowable file extensions the web site allows (white list) and denies (black list) by the web-site. The white list and black list will be compared to the Handler Mappings in IIS 7. Handler Mappings at the site level take precedence over Handler Mappings at the server level.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click on Handler Mappings.\n\nIf any file extensions on the black list are configured with a Handler Mapping, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click on Handler Mappings.\n4. Remove any file extensions which are listed on the black list and for which a Handler Mapping has been configured."},"impact":0.7,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32741r2_chk","severity":"high","gid":"V-2267","rid":"SV-32335r4_rule","stig_id":"WA000-WI050 IIS7","gtitle":"WA000-WI050","fix_id":"F-28820r2_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32378","code":"control 'SV-32378' do\n  title 'The web document (home) directory must be in a separate partition from the web server’s system files.'\n  desc 'The web document (home) directory is accessed by multiple anonymous users when the web server is in production.  By locating the web document (home) directory on the same partition as the web server system file the risk for unauthorized access to these protected files is increased.  Additionally, having the web document (home) directory path on the same drive as the system folders also increases the potential for a drive space exhaustion attack.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click the Advanced Settings from the \"Actions\" Pane.\n4. Review the Physical Path.\n\nIf the Path is on the same partition as the OS, this is a finding.\n\nNote: If the ISSO has accepted the risk of not configuring this setting due to hosted application operability issues or failures, this is not a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click the Advanced Settings from the Actions Pane.\n4. Change the Physical Path to the new partition and directory location.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32768r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-3333'\n  tag rid: 'SV-32378r3_rule'\n  tag stig_id: 'WG205 IIS7'\n  tag gtitle: 'WG205'\n  tag fix_id: 'F-29069r1_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32378.rb"},"title":"The web document (home) directory must be in a separate partition from the web server’s system files.","desc":"The web document (home) directory is accessed by multiple anonymous users when the web server is in production.  By locating the web document (home) directory on the same partition as the web server system file the risk for unauthorized access to these protected files is increased.  Additionally, having the web document (home) directory path on the same drive as the system folders also increases the potential for a drive space exhaustion attack.","descriptions":{"default":"The web document (home) directory is accessed by multiple anonymous users when the web server is in production.  By locating the web document (home) directory on the same partition as the web server system file the risk for unauthorized access to these protected files is increased.  Additionally, having the web document (home) directory path on the same drive as the system folders also increases the potential for a drive space exhaustion attack.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click the Advanced Settings from the \"Actions\" Pane.\n4. Review the Physical Path.\n\nIf the Path is on the same partition as the OS, this is a finding.\n\nNote: If the ISSO has accepted the risk of not configuring this setting due to hosted application operability issues or failures, this is not a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click the Advanced Settings from the Actions Pane.\n4. Change the Physical Path to the new partition and directory location."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32768r2_chk","severity":"medium","gid":"V-3333","rid":"SV-32378r3_rule","stig_id":"WG205 IIS7","gtitle":"WG205","fix_id":"F-29069r1_fix","documentable":null,"responsibility":["System Administrator","Web Administrator"]}},{"id":"SV-32379","code":"control 'SV-32379' do\n  title 'Indexing Services must only index web content.'\n  desc 'The indexing service can be used to facilitate a search function for web-sites. Enabling indexing may facilitate a directory traversal exploit and reveal unwanted information to a malicious user. Indexing must be limited to web document directories only.'\n  desc 'check', '1. Start regedit.\n2. Navigate to KEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\ContentIndex\\\\Catalogs\\\\.\n3. If this key exists then indexing is enabled; if the key does not exist then this check is N/A.\n4. Review the Catalogs keys to determine if directories other than web document directories are being indexed. If so, this is a finding.'\n  desc 'fix', '1. Run MMC.\n2. Add the Indexing Service snap-in.\n3. Edit the indexed directories to only include web document directories.'\n  impact 0.3\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32769r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-3963'\n  tag rid: 'SV-32379r2_rule'\n  tag stig_id: 'WA000-WI070 IIS7'\n  tag gtitle: 'WA000-WI070'\n  tag fix_id: 'F-29020r1_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32379.rb"},"title":"Indexing Services must only index web content.","desc":"The indexing service can be used to facilitate a search function for web-sites. Enabling indexing may facilitate a directory traversal exploit and reveal unwanted information to a malicious user. Indexing must be limited to web document directories only.","descriptions":{"default":"The indexing service can be used to facilitate a search function for web-sites. Enabling indexing may facilitate a directory traversal exploit and reveal unwanted information to a malicious user. Indexing must be limited to web document directories only.","check":"1. Start regedit.\n2. Navigate to KEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\ContentIndex\\Catalogs\\.\n3. If this key exists then indexing is enabled; if the key does not exist then this check is N/A.\n4. Review the Catalogs keys to determine if directories other than web document directories are being indexed. If so, this is a finding.","fix":"1. Run MMC.\n2. Add the Indexing Service snap-in.\n3. Edit the indexed directories to only include web document directories."},"impact":0.3,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32769r1_chk","severity":"low","gid":"V-3963","rid":"SV-32379r2_rule","stig_id":"WA000-WI070 IIS7","gtitle":"WA000-WI070","fix_id":"F-29020r1_fix","documentable":null,"responsibility":["System Administrator","Web Administrator"]}},{"id":"SV-32380","code":"control 'SV-32380' do\n  title 'A private web-sites authentication mechanism must use client certificates.'\n  desc 'A DoD private web-site must utilize PKI as an authentication mechanism for web users. Information systems residing behind web servers requiring authorization based on individual identity shall use the identity provided by certificate-based authentication to support access control decisions. Not using client certificates allows an attacker unauthenticated access to private web-sites.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double click the SSL Settings icon.\n4. Ensure Clients Certificate Required is checked. If not, this is a finding.\n\nNOTE: If the site has operational reasons to set Clients Certificate Required to unchecked, this vulnerability can be documented locally by the ISSM/ISSO.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double click the SSL Settings icon.\n4. Click Clients Certificate Required button.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32933r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-6531'\n  tag rid: 'SV-32380r4_rule'\n  tag stig_id: 'WG140 IIS7'\n  tag gtitle: 'WG140'\n  tag fix_id: 'F-28970r2_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32380.rb"},"title":"A private web-sites authentication mechanism must use client certificates.","desc":"A DoD private web-site must utilize PKI as an authentication mechanism for web users. Information systems residing behind web servers requiring authorization based on individual identity shall use the identity provided by certificate-based authentication to support access control decisions. Not using client certificates allows an attacker unauthenticated access to private web-sites.","descriptions":{"default":"A DoD private web-site must utilize PKI as an authentication mechanism for web users. Information systems residing behind web servers requiring authorization based on individual identity shall use the identity provided by certificate-based authentication to support access control decisions. Not using client certificates allows an attacker unauthenticated access to private web-sites.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double click the SSL Settings icon.\n4. Ensure Clients Certificate Required is checked. If not, this is a finding.\n\nNOTE: If the site has operational reasons to set Clients Certificate Required to unchecked, this vulnerability can be documented locally by the ISSM/ISSO.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double click the SSL Settings icon.\n4. Click Clients Certificate Required button."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32933r3_chk","severity":"medium","gid":"V-6531","rid":"SV-32380r4_rule","stig_id":"WG140 IIS7","gtitle":"WG140","fix_id":"F-28970r2_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32466","code":"control 'SV-32466' do\n  title 'Directory Browsing must be disabled.'\n  desc 'The Directory Browsing feature can be used to facilitate a directory traversal exploit. Directory browsing must be disabled.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click Directory browsing icon.\n4. In the Actions Pane ensure Directory Browsing is disabled. If not, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click Directory browsing icon.\n4. Click Disable in the Actions Pane to disable Directory Browsing.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32785r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-6755'\n  tag rid: 'SV-32466r3_rule'\n  tag stig_id: 'WA000-WI090 IIS7'\n  tag gtitle: 'WA000-WI090'\n  tag fix_id: 'F-28974r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32466.rb"},"title":"Directory Browsing must be disabled.","desc":"The Directory Browsing feature can be used to facilitate a directory traversal exploit. Directory browsing must be disabled.","descriptions":{"default":"The Directory Browsing feature can be used to facilitate a directory traversal exploit. Directory browsing must be disabled.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click Directory browsing icon.\n4. In the Actions Pane ensure Directory Browsing is disabled. If not, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click Directory browsing icon.\n4. Click Disable in the Actions Pane to disable Directory Browsing."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32785r3_chk","severity":"medium","gid":"V-6755","rid":"SV-32466r3_rule","stig_id":"WA000-WI090 IIS7","gtitle":"WA000-WI090","fix_id":"F-28974r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32473","code":"control 'SV-32473' do\n  title 'A private web-site must utilize certificates from a trusted DoD CA.'\n  desc 'The use of a DoD PKI certificate ensures clients the private web site they are connecting to is legitimate, and is an essential part of the DoD defense-in-depth strategy.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click Bindings in the Action Pane.\n4. Click the HTTPS type from the box.\n5. Click Edit.\n6. Click View, review and verify the certificate path. If the list of CAs in the trust hierarchy does not lead to the DoD PKI Root CA, DoD-approved external certificate authority (ECA), or DoD-approved external partner, this is a finding.  If HTTPS is not an available type under site bindings, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the Server name.\n3. Double-Click Server Certificates.\n4. Click Import under the Actions Pane.\n5. Browse to the DoD certificate location, select it, and click OK.\n6. Remove any non-DoD certificates if present.\n7. Click on the site needing the certificate.\n8. Select Bindings under the Actions Pane.\n9. Click on the binding needing a certificate and select edit, or add a site binding for HTTPS and execute step 10.\n10. Assign the certificate to the web site by choosing it under the SSL Certificate drop down and clicking OK.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32790r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13620'\n  tag rid: 'SV-32473r2_rule'\n  tag stig_id: 'WG355 IIS7'\n  tag gtitle: 'WG355'\n  tag fix_id: 'F-29071r1_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Information Assurance Officer', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32473.rb"},"title":"A private web-site must utilize certificates from a trusted DoD CA.","desc":"The use of a DoD PKI certificate ensures clients the private web site they are connecting to is legitimate, and is an essential part of the DoD defense-in-depth strategy.","descriptions":{"default":"The use of a DoD PKI certificate ensures clients the private web site they are connecting to is legitimate, and is an essential part of the DoD defense-in-depth strategy.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click Bindings in the Action Pane.\n4. Click the HTTPS type from the box.\n5. Click Edit.\n6. Click View, review and verify the certificate path. If the list of CAs in the trust hierarchy does not lead to the DoD PKI Root CA, DoD-approved external certificate authority (ECA), or DoD-approved external partner, this is a finding.  If HTTPS is not an available type under site bindings, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the Server name.\n3. Double-Click Server Certificates.\n4. Click Import under the Actions Pane.\n5. Browse to the DoD certificate location, select it, and click OK.\n6. Remove any non-DoD certificates if present.\n7. Click on the site needing the certificate.\n8. Select Bindings under the Actions Pane.\n9. Click on the binding needing a certificate and select edit, or add a site binding for HTTPS and execute step 10.\n10. Assign the certificate to the web site by choosing it under the SSL Certificate drop down and clicking OK."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32790r1_chk","severity":"medium","gid":"V-13620","rid":"SV-32473r2_rule","stig_id":"WG355 IIS7","gtitle":"WG355","fix_id":"F-29071r1_fix","documentable":null,"responsibility":["System Administrator","Information Assurance Officer","Web Administrator"]}},{"id":"SV-32480","code":"control 'SV-32480' do\n  title 'Log files must consist of the required data fields.'\n  desc 'Log files are a critical component to the successful management of an IS used within the DoD.  By generating log files with useful information web administrators can leverage them in the event of a disaster, malicious attack, or other site specific needs.'\n  desc 'check', 'Follow the procedures below for each site under review:\n\n1. Open the IIS Manager.\n2. Click the site name.\n3. Click the Logging icon.\n4. Under Format select W3C.\n5. Click Select Fields, ensure at a minimum the following fields are checked: Date, Time, Client IP Address, User Name, Method, URI Query, Protocol Status, and Referrer. If logging is not enabled, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name.\n3. Click the Logging icon.\n4. Under Format select W3C.\n5. Select the following fields: Date, Time, Client IP Address, User Name, Method, URI Query, Protocol Status, and Referrer.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32795r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13688'\n  tag rid: 'SV-32480r3_rule'\n  tag stig_id: 'WG242 IIS7'\n  tag gtitle: 'WG242'\n  tag fix_id: 'F-29074r1_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32480.rb"},"title":"Log files must consist of the required data fields.","desc":"Log files are a critical component to the successful management of an IS used within the DoD.  By generating log files with useful information web administrators can leverage them in the event of a disaster, malicious attack, or other site specific needs.","descriptions":{"default":"Log files are a critical component to the successful management of an IS used within the DoD.  By generating log files with useful information web administrators can leverage them in the event of a disaster, malicious attack, or other site specific needs.","check":"Follow the procedures below for each site under review:\n\n1. Open the IIS Manager.\n2. Click the site name.\n3. Click the Logging icon.\n4. Under Format select W3C.\n5. Click Select Fields, ensure at a minimum the following fields are checked: Date, Time, Client IP Address, User Name, Method, URI Query, Protocol Status, and Referrer. If logging is not enabled, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name.\n3. Click the Logging icon.\n4. Under Format select W3C.\n5. Select the following fields: Date, Time, Client IP Address, User Name, Method, URI Query, Protocol Status, and Referrer."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32795r2_chk","severity":"medium","gid":"V-13688","rid":"SV-32480r3_rule","stig_id":"WG242 IIS7","gtitle":"WG242","fix_id":"F-29074r1_fix","documentable":null,"responsibility":["System Administrator","Web Administrator"]}},{"id":"SV-32483","code":"control 'SV-32483' do\n  title 'Public web servers must use TLS if authentication is required.'\n  desc 'Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.\n\nWithout the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.\n\nFIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click SSL icon.\n4. Ensure Require SSL and Require 128-bit SSL are checked. \n\nNote:  If the Require SSL 128-Bit setting is not visible, the setting can be viewed by clicking the site under review and then opening the Configuration Editor.  Switch to the section, the dropdown at the top of the configuration editor, system.webServer/security/access.  The value for sslFlags should be ssl128.\n\nIf not, this is a finding.\n\nIf the site requires SSL and 128-bit encryption, then the version of SSL\\\\TLS also needs to be verified. \n\nThe following registry keys need to exist and be set to not allow anything lower than TLS. This can be accomplished by ensuring the following value exists in each of the keys: \n\nEnabled REG_DWORD 0 \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\PCT 1.0\\\\Client \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\PCT 1.0\\\\Server \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 2.0\\\\Client \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 2.0\\\\Server \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 3.0\\\\Client \n\nHKey_Local_Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\SecurityProviders \\\\SCHANNEL\\\\Protocols\\\\SSL 3.0\\\\Server \n\nIf these keys are not set to a DWORD value of 0, this is a finding. \n\nIf the keys do not contain the value \"Enabled\", this would also be a finding. \n\nThe keys for TLS 1.0 do not require the \"Enabled\" value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS.  If the \"Enabled\" value is present and set to 0, this is a finding.\n\nTLS 1.1 and 1.2 are not supported in versions prior to IIS 7.5.  If the version of IIS is prior to 7.5, the check for TLS 1.1 and 1.2 is NA.\n\nTLS 1.1 and 1.2 are not enabled by default, therefore the following registry keys must exist and contain the the following values to enable TLS 1.1 and 1.2.\n\nDisabledByDefault REG_DWORD 0\nEnabled REG_DWORD 1 \n\nHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\TLS 1.1\\\\Client\n\nHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\TLS 1.1\\\\Server\n\nHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\TLS 1.2\\\\Client\n\nHKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols\\\\TLS 1.2\\\\Server\n\nIf any of the registry keys for TLS 1.1 or TLS 1.2 are not present or are not set correctly, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click SSL icon.\n4. Check the Require SSL and Require 128-bit SSL check box.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32799r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13694'\n  tag rid: 'SV-32483r3_rule'\n  tag stig_id: 'WG342 IIS7'\n  tag gtitle: 'WG342'\n  tag fix_id: 'F-29075r1_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32483.rb"},"title":"Public web servers must use TLS if authentication is required.","desc":"Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.\n\nWithout the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.\n\nFIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems.","descriptions":{"default":"Transport Layer Security (TLS) is optional for a public web server.  However, if authentication is being performed, then the use of the TLS protocol is required.\n\nWithout the use of TLS, the authentication data would be transmitted unencrypted and would become vulnerable to disclosure.  Using TLS along with DoD PKI certificates for encryption of the authentication data protects the information from being accessed by all parties on the network.  To further protect the authentication data, the web server must use a FIPS 140-2 approved TLS version and all non-FIPS-approved SSL versions must be disabled.\n\nFIPS 140-2 approved TLS versions include TLS V1.0 or greater.  NIST SP 800-52 specifies the preferred configurations for government systems.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click SSL icon.\n4. Ensure Require SSL and Require 128-bit SSL are checked. \n\nNote:  If the Require SSL 128-Bit setting is not visible, the setting can be viewed by clicking the site under review and then opening the Configuration Editor.  Switch to the section, the dropdown at the top of the configuration editor, system.webServer/security/access.  The value for sslFlags should be ssl128.\n\nIf not, this is a finding.\n\nIf the site requires SSL and 128-bit encryption, then the version of SSL\\TLS also needs to be verified. \n\nThe following registry keys need to exist and be set to not allow anything lower than TLS. This can be accomplished by ensuring the following value exists in each of the keys: \n\nEnabled REG_DWORD 0 \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\PCT 1.0\\Client \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\PCT 1.0\\Server \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 2.0\\Client \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 2.0\\Server \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 3.0\\Client \n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders \\SCHANNEL\\Protocols\\SSL 3.0\\Server \n\nIf these keys are not set to a DWORD value of 0, this is a finding. \n\nIf the keys do not contain the value \"Enabled\", this would also be a finding. \n\nThe keys for TLS 1.0 do not require the \"Enabled\" value to be present, but if it is, it needs to be set to REG_DWORD 1, to enable TLS.  If the \"Enabled\" value is present and set to 0, this is a finding.\n\nTLS 1.1 and 1.2 are not supported in versions prior to IIS 7.5.  If the version of IIS is prior to 7.5, the check for TLS 1.1 and 1.2 is NA.\n\nTLS 1.1 and 1.2 are not enabled by default, therefore the following registry keys must exist and contain the the following values to enable TLS 1.1 and 1.2.\n\nDisabledByDefault REG_DWORD 0\nEnabled REG_DWORD 1 \n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.1\\Client\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.1\\Server\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Client\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\TLS 1.2\\Server\n\nIf any of the registry keys for TLS 1.1 or TLS 1.2 are not present or are not set correctly, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click SSL icon.\n4. Check the Require SSL and Require 128-bit SSL check box."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32799r5_chk","severity":"medium","gid":"V-13694","rid":"SV-32483r3_rule","stig_id":"WG342 IIS7","gtitle":"WG342","fix_id":"F-29075r1_fix","documentable":null,"responsibility":["System Administrator","Web Administrator"]}},{"id":"SV-32514","code":"control 'SV-32514' do\n  title 'The Content Location header must not contain proprietary IP addresses.'\n  desc 'When using static HTML pages, a Content-Location header is added to the response.  The Internet Information Server (IIS) Content-Location may reference the IP address of the server, rather than the Fully Qualified Domain Name (FQDN) or Hostname. This header may expose internal IP addresses that are usually hidden or masked behind a Network Address Translation (NAT) firewall or proxy server. There is a value that can be modified in the IIS metabase to change the default behavior from exposing IP addresses, to sending the FQDN instead.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click Configuration Editor.\n4. From the drop-down box select system.webserver serverRuntime.\n\nIf alternateHostName has no assigned value, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click Configuration Editor.\n4. Click the drop-down box located at the top of the Configuration Editor Pane.\n5. Scroll until you find system.webserver/serverRuntime, double-click the element, and add the appropriate value.'\n  impact 0.3\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32823r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-13702'\n  tag rid: 'SV-32514r2_rule'\n  tag stig_id: 'WA000-WI120 IIS7'\n  tag gtitle: 'WA000-WI120'\n  tag fix_id: 'F-28934r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32514.rb"},"title":"The Content Location header must not contain proprietary IP addresses.","desc":"When using static HTML pages, a Content-Location header is added to the response.  The Internet Information Server (IIS) Content-Location may reference the IP address of the server, rather than the Fully Qualified Domain Name (FQDN) or Hostname. This header may expose internal IP addresses that are usually hidden or masked behind a Network Address Translation (NAT) firewall or proxy server. There is a value that can be modified in the IIS metabase to change the default behavior from exposing IP addresses, to sending the FQDN instead.","descriptions":{"default":"When using static HTML pages, a Content-Location header is added to the response.  The Internet Information Server (IIS) Content-Location may reference the IP address of the server, rather than the Fully Qualified Domain Name (FQDN) or Hostname. This header may expose internal IP addresses that are usually hidden or masked behind a Network Address Translation (NAT) firewall or proxy server. There is a value that can be modified in the IIS metabase to change the default behavior from exposing IP addresses, to sending the FQDN instead.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click Configuration Editor.\n4. From the drop-down box select system.webserver serverRuntime.\n\nIf alternateHostName has no assigned value, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click Configuration Editor.\n4. Click the drop-down box located at the top of the Configuration Editor Pane.\n5. Scroll until you find system.webserver/serverRuntime, double-click the element, and add the appropriate value."},"impact":0.3,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32823r1_chk","severity":"low","gid":"V-13702","rid":"SV-32514r2_rule","stig_id":"WA000-WI120 IIS7","gtitle":"WA000-WI120","fix_id":"F-28934r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32515","code":"control 'SV-32515' do\n  title 'The website must have a unique application pool.'\n  desc 'Application pools isolate sites and applications to address reliability, availability, and security issues. Sites and applications may be grouped according to configurations, although each site will be associated with a unique application pool.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click the Advanced Settings in the Action Pane.\n4. Under the General section review the application pool name.\n5. If any websites share an application pool, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click the Advanced Settings in the Action Pane.\n4. Under the General section click on the application pool name, then click on the application pool selection button.\n5. Select the desired application pool in the application pool dialogue box.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32824r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13703'\n  tag rid: 'SV-32515r2_rule'\n  tag stig_id: 'WA000-WI6010 IIS7'\n  tag gtitle: 'WA000-WI6010'\n  tag fix_id: 'F-28935r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32515.rb"},"title":"The website must have a unique application pool.","desc":"Application pools isolate sites and applications to address reliability, availability, and security issues. Sites and applications may be grouped according to configurations, although each site will be associated with a unique application pool.","descriptions":{"default":"Application pools isolate sites and applications to address reliability, availability, and security issues. Sites and applications may be grouped according to configurations, although each site will be associated with a unique application pool.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click the Advanced Settings in the Action Pane.\n4. Under the General section review the application pool name.\n5. If any websites share an application pool, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click the Advanced Settings in the Action Pane.\n4. Under the General section click on the application pool name, then click on the application pool selection button.\n5. Select the desired application pool in the application pool dialogue box."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32824r1_chk","severity":"medium","gid":"V-13703","rid":"SV-32515r2_rule","stig_id":"WA000-WI6010 IIS7","gtitle":"WA000-WI6010","fix_id":"F-28935r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32529","code":"control 'SV-32529' do\n  title 'Web content directories must not be anonymously shared.'\n  desc 'Anonymously shared directories are exposed to unnecessary risk. Any unnecessary exposure increases the risk that an intruder could exploit this access and compromise the web content or cause web server performance problems.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click Edit Permissions on the Actions Pane.\n4. Click the Sharing tab.\n5. If there are any anonymous shares under Network File and Folder sharing, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click Edit Permissions on the Actions Pane.\n4. Select the Sharing button.\n5. Click Share and then click stop sharing.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32831r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-2226'\n  tag rid: 'SV-32529r2_rule'\n  tag stig_id: 'WG210 IIS7'\n  tag gtitle: 'WG210'\n  tag fix_id: 'F-29056r1_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32529.rb"},"title":"Web content directories must not be anonymously shared.","desc":"Anonymously shared directories are exposed to unnecessary risk. Any unnecessary exposure increases the risk that an intruder could exploit this access and compromise the web content or cause web server performance problems.","descriptions":{"default":"Anonymously shared directories are exposed to unnecessary risk. Any unnecessary exposure increases the risk that an intruder could exploit this access and compromise the web content or cause web server performance problems.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click Edit Permissions on the Actions Pane.\n4. Click the Sharing tab.\n5. If there are any anonymous shares under Network File and Folder sharing, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Click Edit Permissions on the Actions Pane.\n4. Select the Sharing button.\n5. Click Share and then click stop sharing."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32831r1_chk","severity":"medium","gid":"V-2226","rid":"SV-32529r2_rule","stig_id":"WG210 IIS7","gtitle":"WG210","fix_id":"F-29056r1_fix","documentable":null,"responsibility":["System Administrator","Web Administrator"]}},{"id":"SV-32531","code":"control 'SV-32531' do\n  title 'A private web server must have a valid server certificate.'\n  desc 'This check verifies the server certificate is actually a DoD-issued certificate used by the organization being reviewed. This is used to verify the authenticity of the web site to the user. If the certificate is not issued by the DoD or if the certificate has expired, then there is no assurance the use of the certificate is valid. The entire purpose of using a certificate is, therefore, compromised.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click on the Server name.\n3. Double-Click the Server Certificate icon.\n4. Double-Click each certificate and verify the certificate path is to a DoD root CA.  If not, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager. \n2. Click on the Server name. \n3. Double-Click the Server Certificate icon.\n4. Import a valid DoD certificate and remove any non-DoD certificates.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-33498r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-2263'\n  tag rid: 'SV-32531r2_rule'\n  tag stig_id: 'WG350 IIS7'\n  tag gtitle: 'WG350'\n  tag fix_id: 'F-29200r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32531.rb"},"title":"A private web server must have a valid server certificate.","desc":"This check verifies the server certificate is actually a DoD-issued certificate used by the organization being reviewed. This is used to verify the authenticity of the web site to the user. If the certificate is not issued by the DoD or if the certificate has expired, then there is no assurance the use of the certificate is valid. The entire purpose of using a certificate is, therefore, compromised.","descriptions":{"default":"This check verifies the server certificate is actually a DoD-issued certificate used by the organization being reviewed. This is used to verify the authenticity of the web site to the user. If the certificate is not issued by the DoD or if the certificate has expired, then there is no assurance the use of the certificate is valid. The entire purpose of using a certificate is, therefore, compromised.","check":"1. Open the IIS Manager.\n2. Click on the Server name.\n3. Double-Click the Server Certificate icon.\n4. Double-Click each certificate and verify the certificate path is to a DoD root CA.  If not, this is a finding.","fix":"1. Open the IIS Manager. \n2. Click on the Server name. \n3. Double-Click the Server Certificate icon.\n4. Import a valid DoD certificate and remove any non-DoD certificates."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-33498r1_chk","severity":"medium","gid":"V-2263","rid":"SV-32531r2_rule","stig_id":"WG350 IIS7","gtitle":"WG350","fix_id":"F-29200r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32572","code":"control 'SV-32572' do\n  title 'The Idle Timeout monitor must be enabled.'\n  desc 'The idle time-out attribute controls the amount of time a worker process will remain idle before it shuts down. A worker process is idle if it is not processing requests and no new requests are received.\n\nThe purpose of this attribute is to conserve system resources; the default value for idle time-out is 20 minutes.\n\nBy default, the World Wide Web (WWW) service establishes an overlapped recycle, in which the worker process to be shut down is kept running until after a new worker process is started.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and ensure the value for Idle Time out is set to 20. If not, this is a finding.\n\nNOTE: If the site has operational reasons to set Idle Time out to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and set the value for Idle Time-out to 20.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32857r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13708'\n  tag rid: 'SV-32572r3_rule'\n  tag stig_id: 'WA000-WI6028 IIS7'\n  tag gtitle: 'WA000-WI6028'\n  tag fix_id: 'F-28992r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32572.rb"},"title":"The Idle Timeout monitor must be enabled.","desc":"The idle time-out attribute controls the amount of time a worker process will remain idle before it shuts down. A worker process is idle if it is not processing requests and no new requests are received.\n\nThe purpose of this attribute is to conserve system resources; the default value for idle time-out is 20 minutes.\n\nBy default, the World Wide Web (WWW) service establishes an overlapped recycle, in which the worker process to be shut down is kept running until after a new worker process is started.","descriptions":{"default":"The idle time-out attribute controls the amount of time a worker process will remain idle before it shuts down. A worker process is idle if it is not processing requests and no new requests are received.\n\nThe purpose of this attribute is to conserve system resources; the default value for idle time-out is 20 minutes.\n\nBy default, the World Wide Web (WWW) service establishes an overlapped recycle, in which the worker process to be shut down is kept running until after a new worker process is started.","check":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and ensure the value for Idle Time out is set to 20. If not, this is a finding.\n\nNOTE: If the site has operational reasons to set Idle Time out to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.","fix":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and set the value for Idle Time-out to 20."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32857r2_chk","severity":"medium","gid":"V-13708","rid":"SV-32572r3_rule","stig_id":"WA000-WI6028 IIS7","gtitle":"WA000-WI6028","fix_id":"F-28992r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32573","code":"control 'SV-32573' do\n  title 'The maximum queue length for HTTP.sys must be managed.'\n  desc 'In order to determine the possible causes of client connection errors and to conserve system resources, it is important to both log errors and manage those settings controlling requests to the application pool.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the General section and ensure the value for Queue Length is set to 1000. If not, this is a finding.\n\nNOTE: If the site has operational reasons to set Queue Length to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the General section and set the value for Queue Length to 1000.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32858r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13709'\n  tag rid: 'SV-32573r3_rule'\n  tag stig_id: 'WA000-WI6030 IIS7'\n  tag gtitle: 'WA000-WI6030'\n  tag fix_id: 'F-28993r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32573.rb"},"title":"The maximum queue length for HTTP.sys must be managed.","desc":"In order to determine the possible causes of client connection errors and to conserve system resources, it is important to both log errors and manage those settings controlling requests to the application pool.","descriptions":{"default":"In order to determine the possible causes of client connection errors and to conserve system resources, it is important to both log errors and manage those settings controlling requests to the application pool.","check":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the General section and ensure the value for Queue Length is set to 1000. If not, this is a finding.\n\nNOTE: If the site has operational reasons to set Queue Length to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.","fix":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the General section and set the value for Queue Length to 1000."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32858r2_chk","severity":"medium","gid":"V-13709","rid":"SV-32573r3_rule","stig_id":"WA000-WI6030 IIS7","gtitle":"WA000-WI6030","fix_id":"F-28993r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32574","code":"control 'SV-32574' do\n  title 'An application pool’s pinging monitor must be enabled.'\n  desc 'Windows Process Activation Service (WAS) manages application pool configurations and may flag a worker process as unhealthy and shut it down. An application pool’s pinging monitor must be enabled to confirm worker processes are functional. A lack of response from the worker process might mean the worker process does not have a thread to respond to the ping request, or it is hanging for some other reason. The ping interval and ping response time may need adjustment to gain access to timely information about application pool health without triggering false, unhealthy conditions; for example, instability caused by an application.'\n  desc 'check', '1. Open the Internet Information Services (IIS) Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and ensure the value for Ping Enabled is set to True. If not, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and set the value for Ping Enabled to True.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32859r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13710'\n  tag rid: 'SV-32574r2_rule'\n  tag stig_id: 'WA000-WI6032 IIS7'\n  tag gtitle: 'WA000-WI6032'\n  tag fix_id: 'F-28994r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32574.rb"},"title":"An application pool’s pinging monitor must be enabled.","desc":"Windows Process Activation Service (WAS) manages application pool configurations and may flag a worker process as unhealthy and shut it down. An application pool’s pinging monitor must be enabled to confirm worker processes are functional. A lack of response from the worker process might mean the worker process does not have a thread to respond to the ping request, or it is hanging for some other reason. The ping interval and ping response time may need adjustment to gain access to timely information about application pool health without triggering false, unhealthy conditions; for example, instability caused by an application.","descriptions":{"default":"Windows Process Activation Service (WAS) manages application pool configurations and may flag a worker process as unhealthy and shut it down. An application pool’s pinging monitor must be enabled to confirm worker processes are functional. A lack of response from the worker process might mean the worker process does not have a thread to respond to the ping request, or it is hanging for some other reason. The ping interval and ping response time may need adjustment to gain access to timely information about application pool health without triggering false, unhealthy conditions; for example, instability caused by an application.","check":"1. Open the Internet Information Services (IIS) Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and ensure the value for Ping Enabled is set to True. If not, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and set the value for Ping Enabled to True."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32859r1_chk","severity":"medium","gid":"V-13710","rid":"SV-32574r2_rule","stig_id":"WA000-WI6032 IIS7","gtitle":"WA000-WI6032","fix_id":"F-28994r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32603","code":"control 'SV-32603' do\n  title 'An application pool’s rapid fail protection must be enabled.'\n  desc 'Rapid fail protection is a feature that interrogates the health of worker processes associated with web sites and web applications. It can be configured to perform a number of actions such as shutting down and restarting worker processes that have reached failure thresholds.  By not setting rapid fail protection the web server could become unstable in the event of a worker process crash potentially leaving the web server unusable.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Rapid Fail Protection section and ensure the value for Enabled is set to True. If not, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Rapid Fail Protection section and set the value for Enabled to True.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32864r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13711'\n  tag rid: 'SV-32603r2_rule'\n  tag stig_id: 'WA000-WI6034 IIS7'\n  tag gtitle: 'WA000-WI6034'\n  tag fix_id: 'F-29008r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32603.rb"},"title":"An application pool’s rapid fail protection must be enabled.","desc":"Rapid fail protection is a feature that interrogates the health of worker processes associated with web sites and web applications. It can be configured to perform a number of actions such as shutting down and restarting worker processes that have reached failure thresholds.  By not setting rapid fail protection the web server could become unstable in the event of a worker process crash potentially leaving the web server unusable.","descriptions":{"default":"Rapid fail protection is a feature that interrogates the health of worker processes associated with web sites and web applications. It can be configured to perform a number of actions such as shutting down and restarting worker processes that have reached failure thresholds.  By not setting rapid fail protection the web server could become unstable in the event of a worker process crash potentially leaving the web server unusable.","check":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Rapid Fail Protection section and ensure the value for Enabled is set to True. If not, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Rapid Fail Protection section and set the value for Enabled to True."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32864r1_chk","severity":"medium","gid":"V-13711","rid":"SV-32603r2_rule","stig_id":"WA000-WI6034 IIS7","gtitle":"WA000-WI6034","fix_id":"F-29008r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32605","code":"control 'SV-32605' do\n  title 'An application pool’s rapid fail protection settings must be managed.'\n  desc 'Windows Process Activation Service (WAS) manages application pool configuration and may flag a worker process as unhealthy and shut it down.  The rapid fail protection must be set to a suitable value.  A lack of response from the worker process might mean the worker process does not have a thread to respond to the ping request, or that it is hanging for some other reason. The ping interval and ping response time may need adjustment to gain access to timely information about application pool health without triggering false, unhealthy conditions.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Rapid Fail Protection section and ensure the value for Failure Interval is set to 5. If not, this is a finding.\n\nNOTE: If the site has operational reasons to set Failure Interval to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Rapid Fail Protection section and set the value for Failure Interval to 5.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32865r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13712'\n  tag rid: 'SV-32605r3_rule'\n  tag stig_id: 'WA000-WI6036 IIS7'\n  tag gtitle: 'WA000-WI6036'\n  tag fix_id: 'F-29009r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32605.rb"},"title":"An application pool’s rapid fail protection settings must be managed.","desc":"Windows Process Activation Service (WAS) manages application pool configuration and may flag a worker process as unhealthy and shut it down.  The rapid fail protection must be set to a suitable value.  A lack of response from the worker process might mean the worker process does not have a thread to respond to the ping request, or that it is hanging for some other reason. The ping interval and ping response time may need adjustment to gain access to timely information about application pool health without triggering false, unhealthy conditions.","descriptions":{"default":"Windows Process Activation Service (WAS) manages application pool configuration and may flag a worker process as unhealthy and shut it down.  The rapid fail protection must be set to a suitable value.  A lack of response from the worker process might mean the worker process does not have a thread to respond to the ping request, or that it is hanging for some other reason. The ping interval and ping response time may need adjustment to gain access to timely information about application pool health without triggering false, unhealthy conditions.","check":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Rapid Fail Protection section and ensure the value for Failure Interval is set to 5. If not, this is a finding.\n\nNOTE: If the site has operational reasons to set Failure Interval to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.","fix":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Rapid Fail Protection section and set the value for Failure Interval to 5."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32865r2_chk","severity":"medium","gid":"V-13712","rid":"SV-32605r3_rule","stig_id":"WA000-WI6036 IIS7","gtitle":"WA000-WI6036","fix_id":"F-29009r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32630","code":"control 'SV-32630' do\n  title 'Backup interactive scripts must be removed from the web site.'\n  desc 'Copies of backup files will not execute on the server, but they can be read by the anonymous user if special precautions are not taken. Such backup copies contain the same sensitive information as the actual script being executed and, as such, are useful to malicious users. Techniques and systems exist today to search web servers for such files and are able to exploit the information contained in them.'\n  desc 'check', 'This check is limited to CGI/interactive content and not static HTML.\n\nSearch the IIS Root and Site Directories for the following files: *.bak, *.old, *.temp, *.tmp, *.backup, or ‘copy of...’.\n\nIf files with these extensions are found, this is a finding.'\n  desc 'fix', 'Remove the backup files from the production web site.'\n  impact 0.3\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-30361r2_chk'\n  tag severity: 'low'\n  tag gid: 'V-2230'\n  tag rid: 'SV-32630r3_rule'\n  tag stig_id: 'WG420 IIS7'\n  tag gtitle: 'WG420'\n  tag fix_id: 'F-29059r1_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32630.rb"},"title":"Backup interactive scripts must be removed from the web site.","desc":"Copies of backup files will not execute on the server, but they can be read by the anonymous user if special precautions are not taken. Such backup copies contain the same sensitive information as the actual script being executed and, as such, are useful to malicious users. Techniques and systems exist today to search web servers for such files and are able to exploit the information contained in them.","descriptions":{"default":"Copies of backup files will not execute on the server, but they can be read by the anonymous user if special precautions are not taken. Such backup copies contain the same sensitive information as the actual script being executed and, as such, are useful to malicious users. Techniques and systems exist today to search web servers for such files and are able to exploit the information contained in them.","check":"This check is limited to CGI/interactive content and not static HTML.\n\nSearch the IIS Root and Site Directories for the following files: *.bak, *.old, *.temp, *.tmp, *.backup, or ‘copy of...’.\n\nIf files with these extensions are found, this is a finding.","fix":"Remove the backup files from the production web site."},"impact":0.3,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-30361r2_chk","severity":"low","gid":"V-2230","rid":"SV-32630r3_rule","stig_id":"WG420 IIS7","gtitle":"WG420","fix_id":"F-29059r1_fix","documentable":null,"responsibility":["System Administrator","Web Administrator"]}},{"id":"SV-32636","code":"control 'SV-32636' do\n  title 'Web-site logging must be enabled.'\n  desc 'A major tool in exploring the web site use, attempted use, unusual conditions, and problems are reported in the access and error logs. In the event of a security incident, these logs can provide the SA and the web manager with valuable information.'\n  desc 'check', '1. Open the IIS Manager. \n2. Click the site name.\n3. Double-click Logging \n4. Ensure logging is enabled. \n\nIf logging is not enabled, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name.\n3. Double-click Logging.\n4. Click the Enable option from the Action Pane, click apply.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-33496r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-2250'\n  tag rid: 'SV-32636r2_rule'\n  tag stig_id: 'WG240 IIS7'\n  tag gtitle: 'WG240'\n  tag fix_id: 'F-29196r1_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32636.rb"},"title":"Web-site logging must be enabled.","desc":"A major tool in exploring the web site use, attempted use, unusual conditions, and problems are reported in the access and error logs. In the event of a security incident, these logs can provide the SA and the web manager with valuable information.","descriptions":{"default":"A major tool in exploring the web site use, attempted use, unusual conditions, and problems are reported in the access and error logs. In the event of a security incident, these logs can provide the SA and the web manager with valuable information.","check":"1. Open the IIS Manager. \n2. Click the site name.\n3. Double-click Logging \n4. Ensure logging is enabled. \n\nIf logging is not enabled, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name.\n3. Double-click Logging.\n4. Click the Enable option from the Action Pane, click apply."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-33496r1_chk","severity":"medium","gid":"V-2250","rid":"SV-32636r2_rule","stig_id":"WG240 IIS7","gtitle":"WG240","fix_id":"F-29196r1_fix","documentable":null,"responsibility":["System Administrator","Web Administrator"]}},{"id":"SV-32642","code":"control 'SV-32642' do\n  title 'The required DoD banner page must be displayed to authenticated users accessing a DoD private website.'\n  desc 'A consent banner will be in place to make prospective entrants aware that the website they are about to enter is a DoD web site and their activity is subject to monitoring. The document, DoDI 8500.01, establishes the policy on the use of DoD information systems. It requires the use of a standard Notice and Consent Banner and standard text to be included in user agreements. The requirement for the banner is for websites with security and access controls. These are restricted and not publicly accessible. If the website does not require authentication/authorization for use, then the banner does not need to be present. A manual check of the document root directory for a banner page file (such as banner.html) or navigation to the website via a browser can be used to confirm the information provided from interviewing the web staff.'\n  desc 'check', %q(The document, DoDI 8500.01, establishes the policy on the use of DoD information systems. It requires the use of a standard Notice and Consent Banner and standard text to be included in user agreements. \n\nThe requirement for the banner is for websites with security and access controls. These are restricted and not publicly accessible. If the website does not require authentication/authorization for use, then the banner does not need to be present.\n\nIf a banner is required, the following banner page must be in place:\n\n“You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n- At any time, the USG may inspect and seize data stored on this IS.\n\n- Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n- This IS includes security measures (e.g., authentication and access controls) to protect USG interests—not for your personal benefit or privacy.\n\n- Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.”\n\nOR\n\nIf your system cannot meet the character limits to store this amount of text in the banner, the following is another option for the warning banner:\n\n\"I've read & consent to terms in IS user agreem't.\"\n\nNOTE: While DoDI 8500.01 does not contain a copy of the banner to be used, it does point to the RMF Knowledge Service for a copy of the required text.  It is also noted that the banner is to be displayed only once when the individual enters the site and not for each page.\n\nIf the access-controlled website does not display this banner page before entry, this is a finding.)\n  desc 'fix', 'Configure a DoD private website to display the required DoD banner page when authentication is required for user access.'\n  impact 0.3\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-33497r3_chk'\n  tag severity: 'low'\n  tag gid: 'V-6373'\n  tag rid: 'SV-32642r3_rule'\n  tag stig_id: 'WG265 IIS7'\n  tag gtitle: 'WG265'\n  tag fix_id: 'F-29197r2_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32642.rb"},"title":"The required DoD banner page must be displayed to authenticated users accessing a DoD private website.","desc":"A consent banner will be in place to make prospective entrants aware that the website they are about to enter is a DoD web site and their activity is subject to monitoring. The document, DoDI 8500.01, establishes the policy on the use of DoD information systems. It requires the use of a standard Notice and Consent Banner and standard text to be included in user agreements. The requirement for the banner is for websites with security and access controls. These are restricted and not publicly accessible. If the website does not require authentication/authorization for use, then the banner does not need to be present. A manual check of the document root directory for a banner page file (such as banner.html) or navigation to the website via a browser can be used to confirm the information provided from interviewing the web staff.","descriptions":{"default":"A consent banner will be in place to make prospective entrants aware that the website they are about to enter is a DoD web site and their activity is subject to monitoring. The document, DoDI 8500.01, establishes the policy on the use of DoD information systems. It requires the use of a standard Notice and Consent Banner and standard text to be included in user agreements. The requirement for the banner is for websites with security and access controls. These are restricted and not publicly accessible. If the website does not require authentication/authorization for use, then the banner does not need to be present. A manual check of the document root directory for a banner page file (such as banner.html) or navigation to the website via a browser can be used to confirm the information provided from interviewing the web staff.","check":"The document, DoDI 8500.01, establishes the policy on the use of DoD information systems. It requires the use of a standard Notice and Consent Banner and standard text to be included in user agreements. \n\nThe requirement for the banner is for websites with security and access controls. These are restricted and not publicly accessible. If the website does not require authentication/authorization for use, then the banner does not need to be present.\n\nIf a banner is required, the following banner page must be in place:\n\n“You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n- At any time, the USG may inspect and seize data stored on this IS.\n\n- Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n- This IS includes security measures (e.g., authentication and access controls) to protect USG interests—not for your personal benefit or privacy.\n\n- Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.”\n\nOR\n\nIf your system cannot meet the character limits to store this amount of text in the banner, the following is another option for the warning banner:\n\n\"I've read & consent to terms in IS user agreem't.\"\n\nNOTE: While DoDI 8500.01 does not contain a copy of the banner to be used, it does point to the RMF Knowledge Service for a copy of the required text.  It is also noted that the banner is to be displayed only once when the individual enters the site and not for each page.\n\nIf the access-controlled website does not display this banner page before entry, this is a finding.","fix":"Configure a DoD private website to display the required DoD banner page when authentication is required for user access."},"impact":0.3,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-33497r3_chk","severity":"low","gid":"V-6373","rid":"SV-32642r3_rule","stig_id":"WG265 IIS7","gtitle":"WG265","fix_id":"F-29197r2_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32644","code":"control 'SV-32644' do\n  title 'All web-sites must be assigned a default Host header.'\n  desc 'In order to reduce the possibility of DNS rebinding attacks and IP-based scans, all web-sites allowing HTTP/HTTPS over ports 80/443 will be assigned default Host headers.'\n  desc 'check', '1. Open the IIS Manager.\n2. In the “Connections” pane, expand the “Sites” node in the tree. Select the site name under review.\n3. In the “Actions” pane, select “Bindings”.\n4. Each site should have a hostname entry (at a minimum) and specific IP addresses assigned to port 80 for HTTP and port 443 for HTTPS. If not, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. In the “Connections” pane, expand the “Sites” node in the tree. Select the site name under review.\n3. In the “Actions” pane, select “Bindings”.\n4. In the “Site Bindings” dialog box, select the binding to add a host header and then click “Edit” or “Add”.\n5. In the “Host” name box, type a host header for the site for both port 80 for HTTP and port 443 for HTTPS.\n6. Click “OK”.'\n  impact 0.3\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32868r3_chk'\n  tag severity: 'low'\n  tag gid: 'V-6724'\n  tag rid: 'SV-32644r4_rule'\n  tag stig_id: 'WG520 IIS7'\n  tag gtitle: 'WG520'\n  tag fix_id: 'F-29019r2_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32644.rb"},"title":"All web-sites must be assigned a default Host header.","desc":"In order to reduce the possibility of DNS rebinding attacks and IP-based scans, all web-sites allowing HTTP/HTTPS over ports 80/443 will be assigned default Host headers.","descriptions":{"default":"In order to reduce the possibility of DNS rebinding attacks and IP-based scans, all web-sites allowing HTTP/HTTPS over ports 80/443 will be assigned default Host headers.","check":"1. Open the IIS Manager.\n2. In the “Connections” pane, expand the “Sites” node in the tree. Select the site name under review.\n3. In the “Actions” pane, select “Bindings”.\n4. Each site should have a hostname entry (at a minimum) and specific IP addresses assigned to port 80 for HTTP and port 443 for HTTPS. If not, this is a finding.","fix":"1. Open the IIS Manager.\n2. In the “Connections” pane, expand the “Sites” node in the tree. Select the site name under review.\n3. In the “Actions” pane, select “Bindings”.\n4. In the “Site Bindings” dialog box, select the binding to add a host header and then click “Edit” or “Add”.\n5. In the “Host” name box, type a host header for the site for both port 80 for HTTP and port 443 for HTTPS.\n6. Click “OK”."},"impact":0.3,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32868r3_chk","severity":"low","gid":"V-6724","rid":"SV-32644r4_rule","stig_id":"WG520 IIS7","gtitle":"WG520","fix_id":"F-29019r2_fix","documentable":null,"responsibility":["System Administrator","Web Administrator"]}},{"id":"SV-32662","code":"control 'SV-32662' do\n  title 'Debug must be turned off on a production website.'\n  desc 'Setting compilation debug to false ensures detailed error information does not inadvertently display during live application usage, mitigating the risk of application information being display to users.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click .NET Compilation.\n4. Scroll down to the Behavior section and ensure the value for Debug is set to False. If not, this is a finding.\n\nNOTE: If the .NET feature is not installed, this check is not applicable.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click .NET Compilation\n4. Scroll down to the Behavior section and set the value for Debug to False.'\n  impact 0.3\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32876r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-26011'\n  tag rid: 'SV-32662r2_rule'\n  tag stig_id: 'WA000-WI6140 IIS7'\n  tag gtitle: 'WA000-WI6140'\n  tag fix_id: 'F-29027r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32662.rb"},"title":"Debug must be turned off on a production website.","desc":"Setting compilation debug to false ensures detailed error information does not inadvertently display during live application usage, mitigating the risk of application information being display to users.","descriptions":{"default":"Setting compilation debug to false ensures detailed error information does not inadvertently display during live application usage, mitigating the risk of application information being display to users.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click .NET Compilation.\n4. Scroll down to the Behavior section and ensure the value for Debug is set to False. If not, this is a finding.\n\nNOTE: If the .NET feature is not installed, this check is not applicable.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click .NET Compilation\n4. Scroll down to the Behavior section and set the value for Debug to False."},"impact":0.3,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32876r1_chk","severity":"low","gid":"V-26011","rid":"SV-32662r2_rule","stig_id":"WA000-WI6140 IIS7","gtitle":"WA000-WI6140","fix_id":"F-29027r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32682","code":"control 'SV-32682' do\n  title 'The production web-site must be configured to prevent detailed HTTP error pages from being sent to remote clients.'\n  desc 'HTTP error pages contain information that could enable an attacker to gain access to an information system. Failure to prevent the sending of HTTP error pages with full information to remote requesters exposes internal configuration information to potential attackers.'\n  desc 'check', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Error Pages icon.\n4. Click each error message and click Edit Feature Setting from the Actions Pane. If any error message is not set to “Detailed errors for local requests and custom error pages for remote requests”, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Error Pages icon.\n4. Click each error message and click Edit Feature Setting from the Actions Pane; set each error message to “Detailed errors for local requests and custom error pages for remote requests”.'\n  impact 0.3\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32885r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-26031'\n  tag rid: 'SV-32682r2_rule'\n  tag stig_id: 'WA000-WI6165'\n  tag gtitle: 'WA000-WI6165 IIS7'\n  tag fix_id: 'F-29033r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32682.rb"},"title":"The production web-site must be configured to prevent detailed HTTP error pages from being sent to remote clients.","desc":"HTTP error pages contain information that could enable an attacker to gain access to an information system. Failure to prevent the sending of HTTP error pages with full information to remote requesters exposes internal configuration information to potential attackers.","descriptions":{"default":"HTTP error pages contain information that could enable an attacker to gain access to an information system. Failure to prevent the sending of HTTP error pages with full information to remote requesters exposes internal configuration information to potential attackers.","check":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Error Pages icon.\n4. Click each error message and click Edit Feature Setting from the Actions Pane. If any error message is not set to “Detailed errors for local requests and custom error pages for remote requests”, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Error Pages icon.\n4. Click each error message and click Edit Feature Setting from the Actions Pane; set each error message to “Detailed errors for local requests and custom error pages for remote requests”."},"impact":0.3,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32885r1_chk","severity":"low","gid":"V-26031","rid":"SV-32682r2_rule","stig_id":"WA000-WI6165","gtitle":"WA000-WI6165 IIS7","fix_id":"F-29033r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32692","code":"control 'SV-32692' do\n  title 'The web-site must limit the number of bytes accepted in a request.'\n  desc 'By setting limits on web requests, it ensures availability of web services and mitigates the risk of buffer overflow type attacks.  The maxAllowedContentLength Request Filter limits the number of bytes the server will accept in a request.'\n  desc 'check', 'For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n\nIf the maxAllowedContentLength value is not set to 30000000, this is a finding.\n\nNOTE: If the site has operational reasons to set maxAllowedContentLength to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Set the maxAllowedContentLength value to 30000000.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32889r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-26041'\n  tag rid: 'SV-32692r3_rule'\n  tag stig_id: 'WA000-WI6210'\n  tag gtitle: 'WA000-WI6210'\n  tag fix_id: 'F-29035r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32692.rb"},"title":"The web-site must limit the number of bytes accepted in a request.","desc":"By setting limits on web requests, it ensures availability of web services and mitigates the risk of buffer overflow type attacks.  The maxAllowedContentLength Request Filter limits the number of bytes the server will accept in a request.","descriptions":{"default":"By setting limits on web requests, it ensures availability of web services and mitigates the risk of buffer overflow type attacks.  The maxAllowedContentLength Request Filter limits the number of bytes the server will accept in a request.","check":"For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n\nIf the maxAllowedContentLength value is not set to 30000000, this is a finding.\n\nNOTE: If the site has operational reasons to set maxAllowedContentLength to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Set the maxAllowedContentLength value to 30000000."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32889r2_chk","severity":"medium","gid":"V-26041","rid":"SV-32692r3_rule","stig_id":"WA000-WI6210","gtitle":"WA000-WI6210","fix_id":"F-29035r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32693","code":"control 'SV-32693' do\n  title 'The production web-site must limit the MaxURL.'\n  desc 'Request filtering replaces URLScan in IIS, enabling administrators to create a more granular rule set with which to allow or reject inbound web content.   By setting limits on web requests, it helps to ensure availability of web services and may also help mitigate the risk of buffer overflow type attacks.  The MaxURL Request Filter limits the number of bytes the server will accept in a URL.'\n  desc 'check', 'For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n\nIf the maxURL value is not set to 4096, this is a finding.\n\nNOTE: If the site has operational reasons to set maxURL to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Set the maxURL value to 4096.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32890r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-26042'\n  tag rid: 'SV-32693r3_rule'\n  tag stig_id: 'WA000-WI6220'\n  tag gtitle: 'WA000-WI6220'\n  tag fix_id: 'F-29036r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32693.rb"},"title":"The production web-site must limit the MaxURL.","desc":"Request filtering replaces URLScan in IIS, enabling administrators to create a more granular rule set with which to allow or reject inbound web content.   By setting limits on web requests, it helps to ensure availability of web services and may also help mitigate the risk of buffer overflow type attacks.  The MaxURL Request Filter limits the number of bytes the server will accept in a URL.","descriptions":{"default":"Request filtering replaces URLScan in IIS, enabling administrators to create a more granular rule set with which to allow or reject inbound web content.   By setting limits on web requests, it helps to ensure availability of web services and may also help mitigate the risk of buffer overflow type attacks.  The MaxURL Request Filter limits the number of bytes the server will accept in a URL.","check":"For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n\nIf the maxURL value is not set to 4096, this is a finding.\n\nNOTE: If the site has operational reasons to set maxURL to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Set the maxURL value to 4096."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32890r2_chk","severity":"medium","gid":"V-26042","rid":"SV-32693r3_rule","stig_id":"WA000-WI6220","gtitle":"WA000-WI6220","fix_id":"F-29036r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32694","code":"control 'SV-32694' do\n  title 'The production web-site must configure the Maximum Query String limit.'\n  desc 'By setting limits on web requests, it helps to ensure availability of web services and may also help mitigate the risk of buffer overflow type attacks.  The Maximum Query String Request Filter describes the upper limit on allowable query string lengths.  Upon exceeding the configured value, IIS will generate a Status Code 404.15.'\n  desc 'check', 'For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n\nIf the Maximum Query String value is not set to 2048, this is a finding.\n\nNOTE: If the site has operational reasons to set Maximum Query String to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Set the Maximum Query String value to 2048.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32891r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-26043'\n  tag rid: 'SV-32694r3_rule'\n  tag stig_id: 'WA000-WI6230'\n  tag gtitle: 'WA000-WI6230'\n  tag fix_id: 'F-29037r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32694.rb"},"title":"The production web-site must configure the Maximum Query String limit.","desc":"By setting limits on web requests, it helps to ensure availability of web services and may also help mitigate the risk of buffer overflow type attacks.  The Maximum Query String Request Filter describes the upper limit on allowable query string lengths.  Upon exceeding the configured value, IIS will generate a Status Code 404.15.","descriptions":{"default":"By setting limits on web requests, it helps to ensure availability of web services and may also help mitigate the risk of buffer overflow type attacks.  The Maximum Query String Request Filter describes the upper limit on allowable query string lengths.  Upon exceeding the configured value, IIS will generate a Status Code 404.15.","check":"For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n\nIf the Maximum Query String value is not set to 2048, this is a finding.\n\nNOTE: If the site has operational reasons to set Maximum Query String to an alternate value, and has supporting documentation signed by the ISSO, this is not a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Set the Maximum Query String value to 2048."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32891r2_chk","severity":"medium","gid":"V-26043","rid":"SV-32694r3_rule","stig_id":"WA000-WI6230","gtitle":"WA000-WI6230","fix_id":"F-29037r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32695","code":"control 'SV-32695' do\n  title 'The web-site must not allow non-ASCII characters in URLs.'\n  desc 'By setting limits on web requests, it ensures availability of web services and mitigates the risk of buffer overflow type attacks.  The allow high-bit characters Request Filter enables rejection of requests containing non-ASCII characters.'\n  desc 'check', 'For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n\nIf the allow high-bit characters checkbox is checked, this is a finding.\n\nNOTE:  If the site has operational reasons to set allow high-bit characters to checked, this vulnerability can be documented locally by the ISSM/ISSO.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Uncheck the allow high-bit characters checkbox.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32892r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-26044'\n  tag rid: 'SV-32695r4_rule'\n  tag stig_id: 'WA000-WI6240'\n  tag gtitle: 'WA000-WI6240'\n  tag fix_id: 'F-29038r2_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32695.rb"},"title":"The web-site must not allow non-ASCII characters in URLs.","desc":"By setting limits on web requests, it ensures availability of web services and mitigates the risk of buffer overflow type attacks.  The allow high-bit characters Request Filter enables rejection of requests containing non-ASCII characters.","descriptions":{"default":"By setting limits on web requests, it ensures availability of web services and mitigates the risk of buffer overflow type attacks.  The allow high-bit characters Request Filter enables rejection of requests containing non-ASCII characters.","check":"For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n\nIf the allow high-bit characters checkbox is checked, this is a finding.\n\nNOTE:  If the site has operational reasons to set allow high-bit characters to checked, this vulnerability can be documented locally by the ISSM/ISSO.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Uncheck the allow high-bit characters checkbox."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32892r3_chk","severity":"medium","gid":"V-26044","rid":"SV-32695r4_rule","stig_id":"WA000-WI6240","gtitle":"WA000-WI6240","fix_id":"F-29038r2_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32696","code":"control 'SV-32696' do\n  title 'The web-site must not allow double encoded URL requests.'\n  desc 'Request filtering enables administrators to create a more granular rule set with which to allow or reject inbound web content.   By setting limits on web requests, it ensures availability of web services and mitigates the risk of buffer overflow type attacks.  When the allow double escaping option is disabled it prevents attacks that rely on double-encoded requests.'\n  desc 'check', 'For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\nIf the allow double escaping checkbox is checked, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Uncheck the allow double escaping checkbox.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32893r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-26045'\n  tag rid: 'SV-32696r2_rule'\n  tag stig_id: 'WA000-WI6250'\n  tag gtitle: 'WA000-WI6250'\n  tag fix_id: 'F-29039r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32696.rb"},"title":"The web-site must not allow double encoded URL requests.","desc":"Request filtering enables administrators to create a more granular rule set with which to allow or reject inbound web content.   By setting limits on web requests, it ensures availability of web services and mitigates the risk of buffer overflow type attacks.  When the allow double escaping option is disabled it prevents attacks that rely on double-encoded requests.","descriptions":{"default":"Request filtering enables administrators to create a more granular rule set with which to allow or reject inbound web content.   By setting limits on web requests, it ensures availability of web services and mitigates the risk of buffer overflow type attacks.  When the allow double escaping option is disabled it prevents attacks that rely on double-encoded requests.","check":"For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\nIf the allow double escaping checkbox is checked, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Uncheck the allow double escaping checkbox."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32893r1_chk","severity":"medium","gid":"V-26045","rid":"SV-32696r2_rule","stig_id":"WA000-WI6250","gtitle":"WA000-WI6250","fix_id":"F-29039r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-32697","code":"control 'SV-32697' do\n  title 'The production web-site must filter unlisted file extensions in URL requests.'\n  desc 'Request filtering enables administrators to create a more granular rule set to allow or reject inbound web content.   By setting limits on web requests it helps to ensure availability of web services and may also help mitigate the risk of buffer overflow type attacks.  The allow unlisted property of the File Extensions Request Filter enables rejection of requests containing specific file extensions not defined in the File Extensions filter.  Tripping this filter will cause IIS to generate a Status Code 404.7.'\n  desc 'check', 'For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n\nIf allow unlisted file extensions checkbox is checked, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Uncheck the allow unlisted file extensions checkbox.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32894r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-26046'\n  tag rid: 'SV-32697r2_rule'\n  tag stig_id: 'WA000-WI6260'\n  tag gtitle: 'WA000-WI6260'\n  tag fix_id: 'F-29040r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-32697.rb"},"title":"The production web-site must filter unlisted file extensions in URL requests.","desc":"Request filtering enables administrators to create a more granular rule set to allow or reject inbound web content.   By setting limits on web requests it helps to ensure availability of web services and may also help mitigate the risk of buffer overflow type attacks.  The allow unlisted property of the File Extensions Request Filter enables rejection of requests containing specific file extensions not defined in the File Extensions filter.  Tripping this filter will cause IIS to generate a Status Code 404.7.","descriptions":{"default":"Request filtering enables administrators to create a more granular rule set to allow or reject inbound web content.   By setting limits on web requests it helps to ensure availability of web services and may also help mitigate the risk of buffer overflow type attacks.  The allow unlisted property of the File Extensions Request Filter enables rejection of requests containing specific file extensions not defined in the File Extensions filter.  Tripping this filter will cause IIS to generate a Status Code 404.7.","check":"For each site reviewed: \n1. Open the IIS Manager.\n2. Click on the site name.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n\nIf allow unlisted file extensions checkbox is checked, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the Request Filtering icon.\n4. Click Edit Feature Settings in the Actions Pane.\n5. Uncheck the allow unlisted file extensions checkbox."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32894r1_chk","severity":"medium","gid":"V-26046","rid":"SV-32697r2_rule","stig_id":"WA000-WI6260","gtitle":"WA000-WI6260","fix_id":"F-29040r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-33314","code":"control 'SV-33314' do\n  title 'The production website must utilize SHA1 encryption for Machine Key.'\n  desc 'The Machine Key element of the ASP.NET web.config specifies the algorithm and keys that\nASP.NET will use for encryption.  The Machine Key feature can be managed to specify hashing and encryption settings for application services such as view state, forms authentication, membership and roles, and anonymous identification. Ensuring a strong encryption method can mitigate the risk of data tampering in crucial functional areas such as forms authentication cookies or view state.'\n  desc 'check', '1. Open the \"IIS Manager\".\n2. Click the site name under review.\n3. Double-click the \"Machine Key\" in the website \"Home Pane\".\n4. Ensure \"SHA1\" is selected for the \"Validation method\".\n\nIf not, this is a finding.'\n  desc 'fix', '1. Open the \"IIS Manager\".\n2. Click the site name under review.\n3. Double-click the \"Machine Key\" in the website \"Home Pane\".\n4. Set the \"Validation method\" to \"SHA1\".'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32882r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-26026'\n  tag rid: 'SV-33314r4_rule'\n  tag stig_id: 'WA000-WI6180 IIS7'\n  tag gtitle: 'WA000-WI6180'\n  tag fix_id: 'F-29031r4_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-33314.rb"},"title":"The production website must utilize SHA1 encryption for Machine Key.","desc":"The Machine Key element of the ASP.NET web.config specifies the algorithm and keys that\nASP.NET will use for encryption.  The Machine Key feature can be managed to specify hashing and encryption settings for application services such as view state, forms authentication, membership and roles, and anonymous identification. Ensuring a strong encryption method can mitigate the risk of data tampering in crucial functional areas such as forms authentication cookies or view state.","descriptions":{"default":"The Machine Key element of the ASP.NET web.config specifies the algorithm and keys that\nASP.NET will use for encryption.  The Machine Key feature can be managed to specify hashing and encryption settings for application services such as view state, forms authentication, membership and roles, and anonymous identification. Ensuring a strong encryption method can mitigate the risk of data tampering in crucial functional areas such as forms authentication cookies or view state.","check":"1. Open the \"IIS Manager\".\n2. Click the site name under review.\n3. Double-click the \"Machine Key\" in the website \"Home Pane\".\n4. Ensure \"SHA1\" is selected for the \"Validation method\".\n\nIf not, this is a finding.","fix":"1. Open the \"IIS Manager\".\n2. Click the site name under review.\n3. Double-click the \"Machine Key\" in the website \"Home Pane\".\n4. Set the \"Validation method\" to \"SHA1\"."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32882r5_chk","severity":"medium","gid":"V-26026","rid":"SV-33314r4_rule","stig_id":"WA000-WI6180 IIS7","gtitle":"WA000-WI6180","fix_id":"F-29031r4_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-33822","code":"control 'SV-33822' do\n  title 'Web sites must utilize ports, protocols, and services according to PPSM guidelines.'\n  desc 'Failure to comply with DoD ports, protocols, and services (PPS) requirements can result\nin compromise of enclave boundary protections and/or functionality of the AIS.\n\nThe IAM will ensure web servers are configured to use only authorized PPS in accordance with the Network Infrastructure STIG, DoD Instruction 8551.1, Ports, Protocols, and Services Management (PPSM), and the associated Ports, Protocols, and Services (PPS) Assurance Category Assignments List.'\n  desc 'check', 'Review the web site to determine if HTTP and HTTPs (e.g., 80 and 443) are used in accordance with those ports and services registered and approved for use by the DoD PPSM. Any variation in PPS will be documented, registered, and approved by the PPSM.\n\n1. Open the IIS Manager.\n2. Click the site name under review.\n3. In the Action Pane, click Bindings.\n4. Review the ports and protocols. If unknown ports or protocols are used, then this is a finding.'\n  desc 'fix', 'Ensure the web site enforces the use of HTTP and HTTPS in accordance with PPSM guidance.\n\n1. Open the IIS Manager.\n2. Click the site name under review.\n3. In the Action Pane, click Bindings.\n4. Edit to change an existing binding and set the correct ports and protocol.'\n  impact 0.3\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-33501r2_chk'\n  tag severity: 'low'\n  tag gid: 'V-15334'\n  tag rid: 'SV-33822r2_rule'\n  tag stig_id: 'WG610 IIS7'\n  tag gtitle: 'WG610'\n  tag fix_id: 'F-29201r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Information Assurance Officer'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-33822.rb"},"title":"Web sites must utilize ports, protocols, and services according to PPSM guidelines.","desc":"Failure to comply with DoD ports, protocols, and services (PPS) requirements can result\nin compromise of enclave boundary protections and/or functionality of the AIS.\n\nThe IAM will ensure web servers are configured to use only authorized PPS in accordance with the Network Infrastructure STIG, DoD Instruction 8551.1, Ports, Protocols, and Services Management (PPSM), and the associated Ports, Protocols, and Services (PPS) Assurance Category Assignments List.","descriptions":{"default":"Failure to comply with DoD ports, protocols, and services (PPS) requirements can result\nin compromise of enclave boundary protections and/or functionality of the AIS.\n\nThe IAM will ensure web servers are configured to use only authorized PPS in accordance with the Network Infrastructure STIG, DoD Instruction 8551.1, Ports, Protocols, and Services Management (PPSM), and the associated Ports, Protocols, and Services (PPS) Assurance Category Assignments List.","check":"Review the web site to determine if HTTP and HTTPs (e.g., 80 and 443) are used in accordance with those ports and services registered and approved for use by the DoD PPSM. Any variation in PPS will be documented, registered, and approved by the PPSM.\n\n1. Open the IIS Manager.\n2. Click the site name under review.\n3. In the Action Pane, click Bindings.\n4. Review the ports and protocols. If unknown ports or protocols are used, then this is a finding.","fix":"Ensure the web site enforces the use of HTTP and HTTPS in accordance with PPSM guidance.\n\n1. Open the IIS Manager.\n2. Click the site name under review.\n3. In the Action Pane, click Bindings.\n4. Edit to change an existing binding and set the correct ports and protocol."},"impact":0.3,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-33501r2_chk","severity":"low","gid":"V-15334","rid":"SV-33822r2_rule","stig_id":"WG610 IIS7","gtitle":"WG610","fix_id":"F-29201r1_fix","documentable":null,"responsibility":"Information Assurance Officer"}},{"id":"SV-46344","code":"control 'SV-46344' do\n  title 'The application pool must have a recycle time set.'\n  desc 'Application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks.'\n  desc 'check', 'Note: Recycling Application Pools can create an unstable environment in a 64-bit Sharepoint environment. If operational issues arise, with supporting documentation from the ISSO this check can be downgraded to a Cat III.\n\n1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight the desired application pool and click Recycling... in the Action Pane.\n4. Review the Fixed Intervals section. If both Regular time intervals and Specific time(s) are unchecked, this is a finding. If only Regular Time Intervals is checked and the value is set to 0, this is a finding.\nNOTE: Do not click Recycle!'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an application pool and click Recycling... in the Action Pane.\n4. Choose a fixed interval type of fixed time and/or specific time. If regular time interval is the only type chosen, then the value entered must be greater than 0.\nNOTE: Do not click Recycle!'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32828r10_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13704'\n  tag rid: 'SV-46344r4_rule'\n  tag stig_id: 'WA000-WI6020 IIS7'\n  tag gtitle: 'WA000-WI6020'\n  tag fix_id: 'F-28939r4_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-46344.rb"},"title":"The application pool must have a recycle time set.","desc":"Application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks.","descriptions":{"default":"Application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks.","check":"Note: Recycling Application Pools can create an unstable environment in a 64-bit Sharepoint environment. If operational issues arise, with supporting documentation from the ISSO this check can be downgraded to a Cat III.\n\n1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight the desired application pool and click Recycling... in the Action Pane.\n4. Review the Fixed Intervals section. If both Regular time intervals and Specific time(s) are unchecked, this is a finding. If only Regular Time Intervals is checked and the value is set to 0, this is a finding.\nNOTE: Do not click Recycle!","fix":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an application pool and click Recycling... in the Action Pane.\n4. Choose a fixed interval type of fixed time and/or specific time. If regular time interval is the only type chosen, then the value entered must be greater than 0.\nNOTE: Do not click Recycle!"},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32828r10_chk","severity":"medium","gid":"V-13704","rid":"SV-46344r4_rule","stig_id":"WA000-WI6020 IIS7","gtitle":"WA000-WI6020","fix_id":"F-28939r4_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-46345","code":"control 'SV-46345' do\n  title 'The maximum number of requests an application pool can process must be set.'\n  desc 'IIS application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks. By default, application pool recycling is overlapped, which means the worker process to be shut down is kept running until after a new worker process is started. After a new worker process starts, new requests are passed to it. The old worker process shuts down after it finishes processing its existing requests, or after a configured time-out, whichever comes first. This way of recycling ensures uninterrupted service to clients.'\n  desc 'check', 'Note: Recycling Application Pools can create an unstable environment in a 64-bit Sharepoint environment. If operational issues arise, with supporting documentation from the ISSO this check can be downgraded to a Cat III.\n\n1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. Scroll down to the recycling section and ensure the value for Request Limit is set to a value other than 0.  If not, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. Scroll down to the recycling section and set the value for Request Limit to a value other than 0.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32854r8_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13705'\n  tag rid: 'SV-46345r3_rule'\n  tag stig_id: 'WA000-WI6022 IIS7'\n  tag gtitle: 'WA000-WI6022'\n  tag fix_id: 'F-28989r2_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-46345.rb"},"title":"The maximum number of requests an application pool can process must be set.","desc":"IIS application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks. By default, application pool recycling is overlapped, which means the worker process to be shut down is kept running until after a new worker process is started. After a new worker process starts, new requests are passed to it. The old worker process shuts down after it finishes processing its existing requests, or after a configured time-out, whichever comes first. This way of recycling ensures uninterrupted service to clients.","descriptions":{"default":"IIS application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks. By default, application pool recycling is overlapped, which means the worker process to be shut down is kept running until after a new worker process is started. After a new worker process starts, new requests are passed to it. The old worker process shuts down after it finishes processing its existing requests, or after a configured time-out, whichever comes first. This way of recycling ensures uninterrupted service to clients.","check":"Note: Recycling Application Pools can create an unstable environment in a 64-bit Sharepoint environment. If operational issues arise, with supporting documentation from the ISSO this check can be downgraded to a Cat III.\n\n1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. Scroll down to the recycling section and ensure the value for Request Limit is set to a value other than 0.  If not, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. Scroll down to the recycling section and set the value for Request Limit to a value other than 0."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32854r8_chk","severity":"medium","gid":"V-13705","rid":"SV-46345r3_rule","stig_id":"WA000-WI6022 IIS7","gtitle":"WA000-WI6022","fix_id":"F-28989r2_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-46347","code":"control 'SV-46347' do\n  title 'The amount of virtual memory an application pool uses must be set.'\n  desc 'IIS application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks. By default, application pool recycling is overlapped, which means the worker process to be shut down is kept running until after a new worker process is started. After a new worker process starts, new requests are passed to it. The old worker process shuts down after it finishes processing its existing requests, or after a configured time-out, whichever comes first. This way of recycling ensures uninterrupted service to clients.'\n  desc 'check', 'Note: Recycling Application Pools can create an unstable environment in a 64-bit Sharepoint environment. If operational issues arise, with supporting documentation from the ISSO this check can be downgraded to a Cat III.\n\n1. Open the IIS Manager.\n2. Click on Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. In the advanced settings dialog box scroll down to the recycling section and ensure the value for Virtual Memory Limit is not set to 0. If it is, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. In the advanced settings dialog box scroll down to the recycling section and set the value for Virtual Memory Limit to a value other than 0.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32855r6_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13706'\n  tag rid: 'SV-46347r3_rule'\n  tag stig_id: 'WA000-WI6024 IIS7'\n  tag gtitle: 'WA000-WI6024'\n  tag fix_id: 'F-28990r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-46347.rb"},"title":"The amount of virtual memory an application pool uses must be set.","desc":"IIS application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks. By default, application pool recycling is overlapped, which means the worker process to be shut down is kept running until after a new worker process is started. After a new worker process starts, new requests are passed to it. The old worker process shuts down after it finishes processing its existing requests, or after a configured time-out, whichever comes first. This way of recycling ensures uninterrupted service to clients.","descriptions":{"default":"IIS application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks. By default, application pool recycling is overlapped, which means the worker process to be shut down is kept running until after a new worker process is started. After a new worker process starts, new requests are passed to it. The old worker process shuts down after it finishes processing its existing requests, or after a configured time-out, whichever comes first. This way of recycling ensures uninterrupted service to clients.","check":"Note: Recycling Application Pools can create an unstable environment in a 64-bit Sharepoint environment. If operational issues arise, with supporting documentation from the ISSO this check can be downgraded to a Cat III.\n\n1. Open the IIS Manager.\n2. Click on Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. In the advanced settings dialog box scroll down to the recycling section and ensure the value for Virtual Memory Limit is not set to 0. If it is, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. In the advanced settings dialog box scroll down to the recycling section and set the value for Virtual Memory Limit to a value other than 0."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32855r6_chk","severity":"medium","gid":"V-13706","rid":"SV-46347r3_rule","stig_id":"WA000-WI6024 IIS7","gtitle":"WA000-WI6024","fix_id":"F-28990r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-46349","code":"control 'SV-46349' do\n  title 'The amount of private memory an application pool uses must be set.'\n  desc 'IIS application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks. By default, application pool recycling is overlapped, which means the worker process to be shut down is kept running until after a new worker process is started. After a new worker process starts, new requests are passed to it. The old worker process shuts down after it finishes processing its existing requests, or after a configured time-out, whichever comes first. This way of recycling ensures uninterrupted service to clients.'\n  desc 'check', 'Note: Recycling Application Pools can create an unstable environment in a 64-bit Sharepoint environment. If operational issues arise, with supporting documentation from the ISSO this check can be downgraded to a Cat III.\n\n1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. Scroll down to the recycling section and ensure the value for Private Memory Limit is set to a value other than 0. If not, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. Scroll down to the recycling section and set the value for Private Memory Limit to a value other than 0.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32856r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13707'\n  tag rid: 'SV-46349r3_rule'\n  tag stig_id: 'WA000-WI6026 IIS7'\n  tag gtitle: 'WA000-WI6026'\n  tag fix_id: 'F-28991r1_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-46349.rb"},"title":"The amount of private memory an application pool uses must be set.","desc":"IIS application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks. By default, application pool recycling is overlapped, which means the worker process to be shut down is kept running until after a new worker process is started. After a new worker process starts, new requests are passed to it. The old worker process shuts down after it finishes processing its existing requests, or after a configured time-out, whichever comes first. This way of recycling ensures uninterrupted service to clients.","descriptions":{"default":"IIS application pools can be periodically recycled to avoid unstable states possibly leading to application crashes, hangs, or memory leaks. By default, application pool recycling is overlapped, which means the worker process to be shut down is kept running until after a new worker process is started. After a new worker process starts, new requests are passed to it. The old worker process shuts down after it finishes processing its existing requests, or after a configured time-out, whichever comes first. This way of recycling ensures uninterrupted service to clients.","check":"Note: Recycling Application Pools can create an unstable environment in a 64-bit Sharepoint environment. If operational issues arise, with supporting documentation from the ISSO this check can be downgraded to a Cat III.\n\n1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. Scroll down to the recycling section and ensure the value for Private Memory Limit is set to a value other than 0. If not, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool and click Advanced Settings in the Action Pane.\n4. Scroll down to the recycling section and set the value for Private Memory Limit to a value other than 0."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32856r5_chk","severity":"medium","gid":"V-13707","rid":"SV-46349r3_rule","stig_id":"WA000-WI6026 IIS7","gtitle":"WA000-WI6026","fix_id":"F-28991r1_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-46353","code":"control 'SV-46353' do\n  title 'Access to the web-site log files must be restricted.'\n  desc \"A major tool in exploring the web-site use, attempted use, unusual conditions, and problems are the access and error logs. In the event of a security incident, these logs can provide the SA and the web manager with valuable information. Failure to protect log files could enable an attacker to modify the log file data or falsify events to mask an attacker's activity.\"\n  desc 'check', 'Follow the procedures below for each site under review:\n1. Open the IIS Manager.\n2. Click the site name.\n3. Click the Logging icon.\n4. Beside Directory, Click Browse.\n5. Right-click the log file name to review and click Properties.\n6. Click the Security tab; ensure only authorized groups are listed, if others are listed, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name.\n3. Click the Logging icon.\n4. Beside Directory, Click Browse.\n5. Right-click the log file name to review and click Properties.\n6. Click the Security tab.\n7. Set the log file permissions for the appropriate group.'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32797r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-13689'\n  tag rid: 'SV-46353r5_rule'\n  tag stig_id: 'WG255 IIS7'\n  tag gtitle: 'WG255'\n  tag fix_id: 'F-28988r2_fix'\n  tag 'documentable'\n  tag responsibility: ['System Administrator', 'Web Administrator']\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-46353.rb"},"title":"Access to the web-site log files must be restricted.","desc":"A major tool in exploring the web-site use, attempted use, unusual conditions, and problems are the access and error logs. In the event of a security incident, these logs can provide the SA and the web manager with valuable information. Failure to protect log files could enable an attacker to modify the log file data or falsify events to mask an attacker's activity.","descriptions":{"default":"A major tool in exploring the web-site use, attempted use, unusual conditions, and problems are the access and error logs. In the event of a security incident, these logs can provide the SA and the web manager with valuable information. Failure to protect log files could enable an attacker to modify the log file data or falsify events to mask an attacker's activity.","check":"Follow the procedures below for each site under review:\n1. Open the IIS Manager.\n2. Click the site name.\n3. Click the Logging icon.\n4. Beside Directory, Click Browse.\n5. Right-click the log file name to review and click Properties.\n6. Click the Security tab; ensure only authorized groups are listed, if others are listed, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name.\n3. Click the Logging icon.\n4. Beside Directory, Click Browse.\n5. Right-click the log file name to review and click Properties.\n6. Click the Security tab.\n7. Set the log file permissions for the appropriate group."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32797r5_chk","severity":"medium","gid":"V-13689","rid":"SV-46353r5_rule","stig_id":"WG255 IIS7","gtitle":"WG255","fix_id":"F-28988r2_fix","documentable":null,"responsibility":["System Administrator","Web Administrator"]}},{"id":"SV-46354","code":"control 'SV-46354' do\n  title 'The production web-site must configure the Global .NET Trust Level.'\n  desc \"An application's trust level determines the permissions granted by the ASP.NET Code Access Security (CAS) policy.  An application with full trust permissions may access all resource types on a server and perform privileged operations, while applications running with partial trust have varying levels of operating permissions and access to resources. The CAS determines the permissions granted to the application on the server. Setting a level of trust compatible with the applications will limit the potential harm a compromised application could cause to a system.\"\n  desc 'check', 'Note: If the server being reviewed is a non-production website, this is Not Applicable.\nNote: Setting a web application Trust Level to MEDIUM may deny some application permissions. If compatibility issues with applications require trust level to be less than \"Medium\", this check can be downgraded to a Cat III with supporting documentation from the Authorizing Official (AO).\n\n1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the \".NET Trust Level\" icon.\n4. If the .NET Trust level is not set to \"Medium\" or less, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the \".NET Trust Level\" icon.\n4. Set the .NET Trust level to \"Medium\" or less and click \"Apply\".'\n  impact 0.5\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32886r7_chk'\n  tag severity: 'medium'\n  tag gid: 'V-26034'\n  tag rid: 'SV-46354r3_rule'\n  tag stig_id: 'WA000-WI6200'\n  tag gtitle: 'WA000-WI6200'\n  tag fix_id: 'F-29034r2_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-46354.rb"},"title":"The production web-site must configure the Global .NET Trust Level.","desc":"An application's trust level determines the permissions granted by the ASP.NET Code Access Security (CAS) policy.  An application with full trust permissions may access all resource types on a server and perform privileged operations, while applications running with partial trust have varying levels of operating permissions and access to resources. The CAS determines the permissions granted to the application on the server. Setting a level of trust compatible with the applications will limit the potential harm a compromised application could cause to a system.","descriptions":{"default":"An application's trust level determines the permissions granted by the ASP.NET Code Access Security (CAS) policy.  An application with full trust permissions may access all resource types on a server and perform privileged operations, while applications running with partial trust have varying levels of operating permissions and access to resources. The CAS determines the permissions granted to the application on the server. Setting a level of trust compatible with the applications will limit the potential harm a compromised application could cause to a system.","check":"Note: If the server being reviewed is a non-production website, this is Not Applicable.\nNote: Setting a web application Trust Level to MEDIUM may deny some application permissions. If compatibility issues with applications require trust level to be less than \"Medium\", this check can be downgraded to a Cat III with supporting documentation from the Authorizing Official (AO).\n\n1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the \".NET Trust Level\" icon.\n4. If the .NET Trust level is not set to \"Medium\" or less, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the site name under review.\n3. Double-click the \".NET Trust Level\" icon.\n4. Set the .NET Trust level to \"Medium\" or less and click \"Apply\"."},"impact":0.5,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32886r7_chk","severity":"medium","gid":"V-26034","rid":"SV-46354r3_rule","stig_id":"WA000-WI6200","gtitle":"WA000-WI6200","fix_id":"F-29034r2_fix","documentable":null,"responsibility":"Web Administrator"}},{"id":"SV-46365","code":"control 'SV-46365' do\n  title 'The application pool identity must be defined for each web-site.'\n  desc 'The Worker Process Identity is the user defined to run an application pool. The IIS 7 worker processes, by default runs under the NetworkService account. Creating a custom identity for each application pool will better track issues occurring within each web-site. When a custom identity is used, the rights and privileges must not exceed those associated with the NetworkService security principal.'\n  desc 'check', 'This check is only applicable when IIS is running on Windows Server 2008 SP2 or Windows Server 2008 R2.\n\n1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and ensure the value for Identity is set to ApplicationPoolIdentity, Network Service or a custom identity. If not, this is a finding.'\n  desc 'fix', '1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and set the value for Identity to ApplicationPoolIdentity, Network Service or a custom identity with rights and privileges equal to or less than the built-in security principle.'\n  impact 0.7\n  ref 'DPMS Target IIS Web Site 7'\n  tag check_id: 'C-32866r3_chk'\n  tag severity: 'high'\n  tag gid: 'V-13713'\n  tag rid: 'SV-46365r2_rule'\n  tag stig_id: 'WA000-WI6040 IIS7'\n  tag gtitle: 'WA000-WI6040'\n  tag fix_id: 'F-29010r2_fix'\n  tag 'documentable'\n  tag responsibility: 'Web Administrator'\nend","source_location":{"line":1,"ref":"U_MS_IIS_7-0_Site_STIG_V1R19/controls/SV-46365.rb"},"title":"The application pool identity must be defined for each web-site.","desc":"The Worker Process Identity is the user defined to run an application pool. The IIS 7 worker processes, by default runs under the NetworkService account. Creating a custom identity for each application pool will better track issues occurring within each web-site. When a custom identity is used, the rights and privileges must not exceed those associated with the NetworkService security principal.","descriptions":{"default":"The Worker Process Identity is the user defined to run an application pool. The IIS 7 worker processes, by default runs under the NetworkService account. Creating a custom identity for each application pool will better track issues occurring within each web-site. When a custom identity is used, the rights and privileges must not exceed those associated with the NetworkService security principal.","check":"This check is only applicable when IIS is running on Windows Server 2008 SP2 or Windows Server 2008 R2.\n\n1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and ensure the value for Identity is set to ApplicationPoolIdentity, Network Service or a custom identity. If not, this is a finding.","fix":"1. Open the IIS Manager.\n2. Click the Application Pools.\n3. Highlight an Application Pool to review and click Advanced Settings in the Actions Pane.\n4. Scroll down to the Process Model section and set the value for Identity to ApplicationPoolIdentity, Network Service or a custom identity with rights and privileges equal to or less than the built-in security principle."},"impact":0.7,"refs":[{"ref":"DPMS Target IIS Web Site 7"}],"tags":{"check_id":"C-32866r3_chk","severity":"high","gid":"V-13713","rid":"SV-46365r2_rule","stig_id":"WA000-WI6040 IIS7","gtitle":"WA000-WI6040","fix_id":"F-29010r2_fix","documentable":null,"responsibility":"Web Administrator"}}],"groups":[{"id":"controls/SV-108119.rb","title":null,"controls":["SV-108119"]},{"id":"controls/SV-14278.rb","title":null,"controls":["SV-14278"]},{"id":"controls/SV-2254.rb","title":null,"controls":["SV-2254"]},{"id":"controls/SV-32323.rb","title":null,"controls":["SV-32323"]},{"id":"controls/SV-32324.rb","title":null,"controls":["SV-32324"]},{"id":"controls/SV-32326.rb","title":null,"controls":["SV-32326"]},{"id":"controls/SV-32327.rb","title":null,"controls":["SV-32327"]},{"id":"controls/SV-32329.rb","title":null,"controls":["SV-32329"]},{"id":"controls/SV-32331.rb","title":null,"controls":["SV-32331"]},{"id":"controls/SV-32333.rb","title":null,"controls":["SV-32333"]},{"id":"controls/SV-32334.rb","title":null,"controls":["SV-32334"]},{"id":"controls/SV-32335.rb","title":null,"controls":["SV-32335"]},{"id":"controls/SV-32378.rb","title":null,"controls":["SV-32378"]},{"id":"controls/SV-32379.rb","title":null,"controls":["SV-32379"]},{"id":"controls/SV-32380.rb","title":null,"controls":["SV-32380"]},{"id":"controls/SV-32466.rb","title":null,"controls":["SV-32466"]},{"id":"controls/SV-32473.rb","title":null,"controls":["SV-32473"]},{"id":"controls/SV-32480.rb","title":null,"controls":["SV-32480"]},{"id":"controls/SV-32483.rb","title":null,"controls":["SV-32483"]},{"id":"controls/SV-32514.rb","title":null,"controls":["SV-32514"]},{"id":"controls/SV-32515.rb","title":null,"controls":["SV-32515"]},{"id":"controls/SV-32529.rb","title":null,"controls":["SV-32529"]},{"id":"controls/SV-32531.rb","title":null,"controls":["SV-32531"]},{"id":"controls/SV-32572.rb","title":null,"controls":["SV-32572"]},{"id":"controls/SV-32573.rb","title":null,"controls":["SV-32573"]},{"id":"controls/SV-32574.rb","title":null,"controls":["SV-32574"]},{"id":"controls/SV-32603.rb","title":null,"controls":["SV-32603"]},{"id":"controls/SV-32605.rb","title":null,"controls":["SV-32605"]},{"id":"controls/SV-32630.rb","title":null,"controls":["SV-32630"]},{"id":"controls/SV-32636.rb","title":null,"controls":["SV-32636"]},{"id":"controls/SV-32642.rb","title":null,"controls":["SV-32642"]},{"id":"controls/SV-32644.rb","title":null,"controls":["SV-32644"]},{"id":"controls/SV-32662.rb","title":null,"controls":["SV-32662"]},{"id":"controls/SV-32682.rb","title":null,"controls":["SV-32682"]},{"id":"controls/SV-32692.rb","title":null,"controls":["SV-32692"]},{"id":"controls/SV-32693.rb","title":null,"controls":["SV-32693"]},{"id":"controls/SV-32694.rb","title":null,"controls":["SV-32694"]},{"id":"controls/SV-32695.rb","title":null,"controls":["SV-32695"]},{"id":"controls/SV-32696.rb","title":null,"controls":["SV-32696"]},{"id":"controls/SV-32697.rb","title":null,"controls":["SV-32697"]},{"id":"controls/SV-33314.rb","title":null,"controls":["SV-33314"]},{"id":"controls/SV-33822.rb","title":null,"controls":["SV-33822"]},{"id":"controls/SV-46344.rb","title":null,"controls":["SV-46344"]},{"id":"controls/SV-46345.rb","title":null,"controls":["SV-46345"]},{"id":"controls/SV-46347.rb","title":null,"controls":["SV-46347"]},{"id":"controls/SV-46349.rb","title":null,"controls":["SV-46349"]},{"id":"controls/SV-46353.rb","title":null,"controls":["SV-46353"]},{"id":"controls/SV-46354.rb","title":null,"controls":["SV-46354"]},{"id":"controls/SV-46365.rb","title":null,"controls":["SV-46365"]}],"name":"IIS_7.0_WEB_SITE_BENCHMARK","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"71b7e5839875a0b19fcc6361786dedb8738c1a7a5360ea549b8180704eb91c97","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
