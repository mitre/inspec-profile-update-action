{"controls":[{"id":"SV-259166","code":"control 'SV-259166' do\n  title 'The vCenter PostgreSQL service must limit the number of concurrent sessions.'\n  desc 'Database management includes the ability to control the number of users and user sessions utilizing a database management system (DBMS). Unlimited concurrent connections to the DBMS could allow a successful denial-of-service (DoS) attack by exhausting connection resources, and a system can also fail or be degraded by an overload of legitimate users. Limiting the number of concurrent sessions per user is helpful in reducing these risks.\n\nVMware Postgres as deployed on the vCenter Service Appliance (VCSA) comes preconfigured with a \"max_connections\" limit that is appropriate for all tested, supported scenarios. The out-of-the-box configuration is dynamic, based on a lower limit plus allowances for the resources assigned to VCSA and the deployment size. However, this number will always be between 100 and 1000 (inclusive).'\n  desc 'check', 'At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW max_connections;\"\n\nIf the returned number is not greater than or equal to 100 and less than or equal to 1000, this is a finding.'\n  desc 'fix', 'At the command prompt, run the following command:\n\n# vmon-cli --restart vmware-vpostgres\n\nNote: Restarting the service runs the \"pg_tuning\" script that will configure \"max_connections\" to the appropriate value based on the allocated memory for vCenter.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62906r935400_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259166'\n  tag rid: 'SV-259166r935402_rule'\n  tag stig_id: 'VCPG-80-000001'\n  tag gtitle: 'SRG-APP-000001-DB-000031'\n  tag fix_id: 'F-62815r935401_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259166.rb"},"title":"The vCenter PostgreSQL service must limit the number of concurrent sessions.","desc":"Database management includes the ability to control the number of users and user sessions utilizing a database management system (DBMS). Unlimited concurrent connections to the DBMS could allow a successful denial-of-service (DoS) attack by exhausting connection resources, and a system can also fail or be degraded by an overload of legitimate users. Limiting the number of concurrent sessions per user is helpful in reducing these risks.\n\nVMware Postgres as deployed on the vCenter Service Appliance (VCSA) comes preconfigured with a \"max_connections\" limit that is appropriate for all tested, supported scenarios. The out-of-the-box configuration is dynamic, based on a lower limit plus allowances for the resources assigned to VCSA and the deployment size. However, this number will always be between 100 and 1000 (inclusive).","descriptions":{"default":"Database management includes the ability to control the number of users and user sessions utilizing a database management system (DBMS). Unlimited concurrent connections to the DBMS could allow a successful denial-of-service (DoS) attack by exhausting connection resources, and a system can also fail or be degraded by an overload of legitimate users. Limiting the number of concurrent sessions per user is helpful in reducing these risks.\n\nVMware Postgres as deployed on the vCenter Service Appliance (VCSA) comes preconfigured with a \"max_connections\" limit that is appropriate for all tested, supported scenarios. The out-of-the-box configuration is dynamic, based on a lower limit plus allowances for the resources assigned to VCSA and the deployment size. However, this number will always be between 100 and 1000 (inclusive).","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW max_connections;\"\n\nIf the returned number is not greater than or equal to 100 and less than or equal to 1000, this is a finding.","fix":"At the command prompt, run the following command:\n\n# vmon-cli --restart vmware-vpostgres\n\nNote: Restarting the service runs the \"pg_tuning\" script that will configure \"max_connections\" to the appropriate value based on the allocated memory for vCenter."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62906r935400_chk","severity":"medium","gid":"V-259166","rid":"SV-259166r935402_rule","stig_id":"VCPG-80-000001","gtitle":"SRG-APP-000001-DB-000031","fix_id":"F-62815r935401_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-259167","code":"control 'SV-259167' do\n  title 'The vCenter PostgreSQL service must enable \"pgaudit\" to provide audit record generation capabilities.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the database management system (DBMS) (e.g., process, module). Certain specific application functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDOD has defined the list of events for which the DBMS will provide an audit record generation capability as the following:\n\n(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);\n\n(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities, or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and\n\n(iii) All account creation, modification, disabling, and termination actions.\n\nOrganizations may define additional events requiring continuous or ad hoc auditing.'\n  desc 'check', 'At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW shared_preload_libraries;\"\n\nExample result:\n\nhealth_status_worker,pg_stat_statements,pgaudit\n\nIf the output from the command does not include pgaudit, this is a finding.'\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62907r935403_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259167'\n  tag rid: 'SV-259167r935405_rule'\n  tag stig_id: 'VCPG-80-000005'\n  tag gtitle: 'SRG-APP-000089-DB-000064'\n  tag fix_id: 'F-62816r935404_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000169']\n  tag nist: ['AU-12 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259167.rb"},"title":"The vCenter PostgreSQL service must enable \"pgaudit\" to provide audit record generation capabilities.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the database management system (DBMS) (e.g., process, module). Certain specific application functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDOD has defined the list of events for which the DBMS will provide an audit record generation capability as the following:\n\n(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);\n\n(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities, or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and\n\n(iii) All account creation, modification, disabling, and termination actions.\n\nOrganizations may define additional events requiring continuous or ad hoc auditing.","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the database management system (DBMS) (e.g., process, module). Certain specific application functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDOD has defined the list of events for which the DBMS will provide an audit record generation capability as the following:\n\n(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);\n\n(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities, or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and\n\n(iii) All account creation, modification, disabling, and termination actions.\n\nOrganizations may define additional events requiring continuous or ad hoc auditing.","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW shared_preload_libraries;\"\n\nExample result:\n\nhealth_status_worker,pg_stat_statements,pgaudit\n\nIf the output from the command does not include pgaudit, this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62907r935403_chk","severity":"medium","gid":"V-259167","rid":"SV-259167r935405_rule","stig_id":"VCPG-80-000005","gtitle":"SRG-APP-000089-DB-000064","fix_id":"F-62816r935404_fix","documentable":null,"cci":["CCI-000169"],"nist":["AU-12 a"]}},{"id":"SV-259168","code":"control 'SV-259168' do\n  title 'The vCenter PostgreSQL service configuration files must not be accessible by unauthorized users.'\n  desc \"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events.\n\nSuppression of auditing could permit an adversary to evade detection.\n\nMisconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\n\"\n  desc 'check', \"At the command prompt, run the following command:\n\n# find /storage/db/vpostgres/*conf* -xdev -type f -a '(' -not -perm 600 -o -not -user vpostgres -o -not -group vpgmongrp ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', 'At the command prompt, run the following commands:\n\n# chmod 600 <file>\n# chown vpostgres:vpgmongrp <file>\n\nNote: Replace <file> with the file that has incorrect permissions.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62908r935406_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259168'\n  tag rid: 'SV-259168r935408_rule'\n  tag stig_id: 'VCPG-80-000006'\n  tag gtitle: 'SRG-APP-000090-DB-000065'\n  tag fix_id: 'F-62817r935407_fix'\n  tag satisfies: ['SRG-APP-000090-DB-000065', 'SRG-APP-000121-DB-000202', 'SRG-APP-000122-DB-000203', 'SRG-APP-000123-DB-000204', 'SRG-APP-000380-DB-000360']\n  tag 'documentable'\n  tag cci: ['CCI-000171', 'CCI-001493', 'CCI-001494', 'CCI-001495', 'CCI-001813']\n  tag nist: ['AU-12 b', 'AU-9 a', 'AU-9', 'AU-9', 'CM-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259168.rb"},"title":"The vCenter PostgreSQL service configuration files must not be accessible by unauthorized users.","desc":"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events.\n\nSuppression of auditing could permit an adversary to evade detection.\n\nMisconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\n","descriptions":{"default":"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events.\n\nSuppression of auditing could permit an adversary to evade detection.\n\nMisconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\n","check":"At the command prompt, run the following command:\n\n# find /storage/db/vpostgres/*conf* -xdev -type f -a '(' -not -perm 600 -o -not -user vpostgres -o -not -group vpgmongrp ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.","fix":"At the command prompt, run the following commands:\n\n# chmod 600 <file>\n# chown vpostgres:vpgmongrp <file>\n\nNote: Replace <file> with the file that has incorrect permissions."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62908r935406_chk","severity":"medium","gid":"V-259168","rid":"SV-259168r935408_rule","stig_id":"VCPG-80-000006","gtitle":"SRG-APP-000090-DB-000065","fix_id":"F-62817r935407_fix","satisfies":["SRG-APP-000090-DB-000065","SRG-APP-000121-DB-000202","SRG-APP-000122-DB-000203","SRG-APP-000123-DB-000204","SRG-APP-000380-DB-000360"],"documentable":null,"cci":["CCI-000171","CCI-001493","CCI-001494","CCI-001495","CCI-001813"],"nist":["AU-12 b","AU-9 a","AU-9","AU-9","CM-5 (1) (a)"]}},{"id":"SV-259169","code":"control 'SV-259169' do\n  title 'The vCenter PostgreSQL service must generate audit records.'\n  desc 'Under some circumstances, it may be useful to monitor who/what is reading privilege/permission/role information. Therefore, it must be possible to configure auditing to do this. Database management systems (DBMS) typically make such information available through views or functions.\n\nThis requirement addresses explicit requests for privilege/permission/role membership information. It does not refer to the implicit retrieval of privileges/permissions/role memberships that PostgreSQL continually performs to determine if any and every action on the database is permitted.\n\n'\n  desc 'check', 'At the command prompt, run the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW pgaudit.log_catalog;\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW pgaudit.log;\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW pgaudit.log_parameter;\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW pgaudit.log_statement_once;\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW pgaudit.log_level;\"\n\nIf \"pgaudit.log_catalog\" is not set to \"on\", this is a finding.\n\nIf \"pgaudit.log\" is not set to \"all, -misc\", this is a finding.\n\nIf \"pgaudit.log_parameter\" is not set to \"on\", this is a finding.\n\nIf \"pgaudit.log_statement_once\" is not set to \"off\", this is a finding.\n\nIf \"pgaudit.log_level\" is not set to \"log\", this is a finding.'\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62909r935409_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259169'\n  tag rid: 'SV-259169r935411_rule'\n  tag stig_id: 'VCPG-80-000007'\n  tag gtitle: 'SRG-APP-000091-DB-000066'\n  tag fix_id: 'F-62818r935410_fix'\n  tag satisfies: ['SRG-APP-000091-DB-000066', 'SRG-APP-000091-DB-000325', 'SRG-APP-000492-DB-000332', 'SRG-APP-000492-DB-000333', 'SRG-APP-000495-DB-000326', 'SRG-APP-000495-DB-000327', 'SRG-APP-000495-DB-000328', 'SRG-APP-000495-DB-000329', 'SRG-APP-000496-DB-000334', 'SRG-APP-000496-DB-000335', 'SRG-APP-000499-DB-000330', 'SRG-APP-000499-DB-000331', 'SRG-APP-000501-DB-000336', 'SRG-APP-000501-DB-000337', 'SRG-APP-000504-DB-000354', 'SRG-APP-000504-DB-000355', 'SRG-APP-000507-DB-000356', 'SRG-APP-000507-DB-000357']\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259169.rb"},"title":"The vCenter PostgreSQL service must generate audit records.","desc":"Under some circumstances, it may be useful to monitor who/what is reading privilege/permission/role information. Therefore, it must be possible to configure auditing to do this. Database management systems (DBMS) typically make such information available through views or functions.\n\nThis requirement addresses explicit requests for privilege/permission/role membership information. It does not refer to the implicit retrieval of privileges/permissions/role memberships that PostgreSQL continually performs to determine if any and every action on the database is permitted.\n\n","descriptions":{"default":"Under some circumstances, it may be useful to monitor who/what is reading privilege/permission/role information. Therefore, it must be possible to configure auditing to do this. Database management systems (DBMS) typically make such information available through views or functions.\n\nThis requirement addresses explicit requests for privilege/permission/role membership information. It does not refer to the implicit retrieval of privileges/permissions/role memberships that PostgreSQL continually performs to determine if any and every action on the database is permitted.\n\n","check":"At the command prompt, run the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW pgaudit.log_catalog;\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW pgaudit.log;\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW pgaudit.log_parameter;\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW pgaudit.log_statement_once;\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW pgaudit.log_level;\"\n\nIf \"pgaudit.log_catalog\" is not set to \"on\", this is a finding.\n\nIf \"pgaudit.log\" is not set to \"all, -misc\", this is a finding.\n\nIf \"pgaudit.log_parameter\" is not set to \"on\", this is a finding.\n\nIf \"pgaudit.log_statement_once\" is not set to \"off\", this is a finding.\n\nIf \"pgaudit.log_level\" is not set to \"log\", this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62909r935409_chk","severity":"medium","gid":"V-259169","rid":"SV-259169r935411_rule","stig_id":"VCPG-80-000007","gtitle":"SRG-APP-000091-DB-000066","fix_id":"F-62818r935410_fix","satisfies":["SRG-APP-000091-DB-000066","SRG-APP-000091-DB-000325","SRG-APP-000492-DB-000332","SRG-APP-000492-DB-000333","SRG-APP-000495-DB-000326","SRG-APP-000495-DB-000327","SRG-APP-000495-DB-000328","SRG-APP-000495-DB-000329","SRG-APP-000496-DB-000334","SRG-APP-000496-DB-000335","SRG-APP-000499-DB-000330","SRG-APP-000499-DB-000331","SRG-APP-000501-DB-000336","SRG-APP-000501-DB-000337","SRG-APP-000504-DB-000354","SRG-APP-000504-DB-000355","SRG-APP-000507-DB-000356","SRG-APP-000507-DB-000357"],"documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-259170","code":"control 'SV-259170' do\n  title 'The vCenter PostgreSQL service must initiate session auditing upon startup.'\n  desc \"Session auditing is for use when a user's activities are under investigation. To be sure of capturing all activity during those periods when session auditing is in use, it needs to be in operation for the whole time the database management system (DBMS) is running.\"\n  desc 'check', 'At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_destination;\"\n\nExample result:\n\nstderr\n\nIf \"log_destination\" is not set to \"stderr\" or \"syslog\", this is a finding.'\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62910r935412_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259170'\n  tag rid: 'SV-259170r935414_rule'\n  tag stig_id: 'VCPG-80-000009'\n  tag gtitle: 'SRG-APP-000092-DB-000208'\n  tag fix_id: 'F-62819r935413_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001464']\n  tag nist: ['AU-14 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259170.rb"},"title":"The vCenter PostgreSQL service must initiate session auditing upon startup.","desc":"Session auditing is for use when a user's activities are under investigation. To be sure of capturing all activity during those periods when session auditing is in use, it needs to be in operation for the whole time the database management system (DBMS) is running.","descriptions":{"default":"Session auditing is for use when a user's activities are under investigation. To be sure of capturing all activity during those periods when session auditing is in use, it needs to be in operation for the whole time the database management system (DBMS) is running.","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_destination;\"\n\nExample result:\n\nstderr\n\nIf \"log_destination\" is not set to \"stderr\" or \"syslog\", this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62910r935412_chk","severity":"medium","gid":"V-259170","rid":"SV-259170r935414_rule","stig_id":"VCPG-80-000009","gtitle":"SRG-APP-000092-DB-000208","fix_id":"F-62819r935413_fix","documentable":null,"cci":["CCI-001464"],"nist":["AU-14 (1)"]}},{"id":"SV-259171","code":"control 'SV-259171' do\n  title 'The vCenter PostgreSQL service must produce logs containing sufficient information to establish what type of events occurred.'\n  desc 'Information system auditing capability is critical for accurate forensic analysis. Without establishing what type of event occurred, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit record content that may be necessary to satisfy the requirement of this policy includes, for example, time stamps, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the application and audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured application.\n\nDatabase software is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly what actions were performed. This requires specific information regarding the event type an audit record is referring to. If event type information is not recorded and stored with the audit record, the record itself is of very limited use.\n\n'\n  desc 'check', 'At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_line_prefix;\"\n\nExpected result:\n\n%m %c %x %d %u %r %p %l\n\nIf the output does not include each option in the expected result, this is a finding.'\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62911r935415_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259171'\n  tag rid: 'SV-259171r935417_rule'\n  tag stig_id: 'VCPG-80-000010'\n  tag gtitle: 'SRG-APP-000095-DB-000039'\n  tag fix_id: 'F-62820r935416_fix'\n  tag satisfies: ['SRG-APP-000095-DB-000039', 'SRG-APP-000096-DB-000040', 'SRG-APP-000097-DB-000041', 'SRG-APP-000098-DB-000042', 'SRG-APP-000099-DB-000043', 'SRG-APP-000100-DB-000201', 'SRG-APP-000101-DB-000044', 'SRG-APP-000375-DB-000323']\n  tag 'documentable'\n  tag cci: ['CCI-000130', 'CCI-000131', 'CCI-000132', 'CCI-000133', 'CCI-000134', 'CCI-000135', 'CCI-001487', 'CCI-001889']\n  tag nist: ['AU-3 a', 'AU-3 b', 'AU-3 c', 'AU-3 d', 'AU-3 e', 'AU-3 (1)', 'AU-3 f', 'AU-8 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259171.rb"},"title":"The vCenter PostgreSQL service must produce logs containing sufficient information to establish what type of events occurred.","desc":"Information system auditing capability is critical for accurate forensic analysis. Without establishing what type of event occurred, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit record content that may be necessary to satisfy the requirement of this policy includes, for example, time stamps, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the application and audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured application.\n\nDatabase software is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly what actions were performed. This requires specific information regarding the event type an audit record is referring to. If event type information is not recorded and stored with the audit record, the record itself is of very limited use.\n\n","descriptions":{"default":"Information system auditing capability is critical for accurate forensic analysis. Without establishing what type of event occurred, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit record content that may be necessary to satisfy the requirement of this policy includes, for example, time stamps, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the application and audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured application.\n\nDatabase software is capable of a range of actions on data stored within the database. It is important, for accurate forensic analysis, to know exactly what actions were performed. This requires specific information regarding the event type an audit record is referring to. If event type information is not recorded and stored with the audit record, the record itself is of very limited use.\n\n","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_line_prefix;\"\n\nExpected result:\n\n%m %c %x %d %u %r %p %l\n\nIf the output does not include each option in the expected result, this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62911r935415_chk","severity":"medium","gid":"V-259171","rid":"SV-259171r935417_rule","stig_id":"VCPG-80-000010","gtitle":"SRG-APP-000095-DB-000039","fix_id":"F-62820r935416_fix","satisfies":["SRG-APP-000095-DB-000039","SRG-APP-000096-DB-000040","SRG-APP-000097-DB-000041","SRG-APP-000098-DB-000042","SRG-APP-000099-DB-000043","SRG-APP-000100-DB-000201","SRG-APP-000101-DB-000044","SRG-APP-000375-DB-000323"],"documentable":null,"cci":["CCI-000130","CCI-000131","CCI-000132","CCI-000133","CCI-000134","CCI-000135","CCI-001487","CCI-001889"],"nist":["AU-3 a","AU-3 b","AU-3 c","AU-3 d","AU-3 e","AU-3 (1)","AU-3 f","AU-8 b"]}},{"id":"SV-259172","code":"control 'SV-259172' do\n  title 'The vCenter PostgreSQL service must be configured to protect log files from unauthorized access.'\n  desc 'If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, copy, etc.\n\n'\n  desc 'check', %q(Verify the default log file permissions and permissions on existing log files.\n\nAt the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_file_mode;\"\n\nExpected result:\n\n0600\n\nIf \"log_file_mode\" is not set to \"0600\", this is a finding.\n\nAt the command prompt, run the following command:\n\n# find /var/log/vmware/vpostgres/* -xdev -type f -a '(' -not -perm 600 -o -not -user vpostgres -o -not -group vpgmongrp ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.)\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres\n\nAt the command prompt, run the following commands:\n\n# chmod 600 <file>\n# chown vpostgres:vpgmongrp <file>\n\nNote: Replace <file> with the file that has incorrect permissions.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62912r935418_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259172'\n  tag rid: 'SV-259172r935420_rule'\n  tag stig_id: 'VCPG-80-000020'\n  tag gtitle: 'SRG-APP-000118-DB-000059'\n  tag fix_id: 'F-62821r935419_fix'\n  tag satisfies: ['SRG-APP-000118-DB-000059', 'SRG-APP-000119-DB-000060', 'SRG-APP-000120-DB-000061']\n  tag 'documentable'\n  tag cci: ['CCI-000162', 'CCI-000163', 'CCI-000164']\n  tag nist: ['AU-9 a', 'AU-9 a', 'AU-9 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259172.rb"},"title":"The vCenter PostgreSQL service must be configured to protect log files from unauthorized access.","desc":"If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, copy, etc.\n\n","descriptions":{"default":"If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, copy, etc.\n\n","check":"Verify the default log file permissions and permissions on existing log files.\n\nAt the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_file_mode;\"\n\nExpected result:\n\n0600\n\nIf \"log_file_mode\" is not set to \"0600\", this is a finding.\n\nAt the command prompt, run the following command:\n\n# find /var/log/vmware/vpostgres/* -xdev -type f -a '(' -not -perm 600 -o -not -user vpostgres -o -not -group vpgmongrp ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres\n\nAt the command prompt, run the following commands:\n\n# chmod 600 <file>\n# chown vpostgres:vpgmongrp <file>\n\nNote: Replace <file> with the file that has incorrect permissions."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62912r935418_chk","severity":"medium","gid":"V-259172","rid":"SV-259172r935420_rule","stig_id":"VCPG-80-000020","gtitle":"SRG-APP-000118-DB-000059","fix_id":"F-62821r935419_fix","satisfies":["SRG-APP-000118-DB-000059","SRG-APP-000119-DB-000060","SRG-APP-000120-DB-000061"],"documentable":null,"cci":["CCI-000162","CCI-000163","CCI-000164"],"nist":["AU-9 a","AU-9 a","AU-9 a"]}},{"id":"SV-259173","code":"control 'SV-259173' do\n  title 'The vCenter PostgreSQL service must not load unused database components, software, and database objects.'\n  desc 'Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nIt is detrimental for software products to provide, or install by default, functionality exceeding requirements or mission objectives.\n\nDatabase management systems (DBMS) must adhere to the principles of least functionality by providing only essential capabilities.\n\n'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"select * from pg_extension where extname != 'plpgsql'\"\n\nIf any extensions are output, this is a finding.)\n  desc 'fix', 'At the command prompt, run the following command:\n\n$ /opt/vmware/vpostgres/current/bin/psql -U postgres -c  \"DROP EXTENSION <extension name>\"\n\nNote: It is recommended that plpgsql not be removed.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62913r935421_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259173'\n  tag rid: 'SV-259173r935423_rule'\n  tag stig_id: 'VCPG-80-000032'\n  tag gtitle: 'SRG-APP-000141-DB-000091'\n  tag fix_id: 'F-62822r935422_fix'\n  tag satisfies: ['SRG-APP-000141-DB-000091', 'SRG-APP-000141-DB-000093']\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259173.rb"},"title":"The vCenter PostgreSQL service must not load unused database components, software, and database objects.","desc":"Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nIt is detrimental for software products to provide, or install by default, functionality exceeding requirements or mission objectives.\n\nDatabase management systems (DBMS) must adhere to the principles of least functionality by providing only essential capabilities.\n\n","descriptions":{"default":"Information systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nIt is detrimental for software products to provide, or install by default, functionality exceeding requirements or mission objectives.\n\nDatabase management systems (DBMS) must adhere to the principles of least functionality by providing only essential capabilities.\n\n","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"select * from pg_extension where extname != 'plpgsql'\"\n\nIf any extensions are output, this is a finding.","fix":"At the command prompt, run the following command:\n\n$ /opt/vmware/vpostgres/current/bin/psql -U postgres -c  \"DROP EXTENSION <extension name>\"\n\nNote: It is recommended that plpgsql not be removed."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62913r935421_chk","severity":"medium","gid":"V-259173","rid":"SV-259173r935423_rule","stig_id":"VCPG-80-000032","gtitle":"SRG-APP-000141-DB-000091","fix_id":"F-62822r935422_fix","satisfies":["SRG-APP-000141-DB-000091","SRG-APP-000141-DB-000093"],"documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-259174","code":"control 'SV-259174' do\n  title 'The vCenter PostgreSQL service must be configured to use an authorized port.'\n  desc 'In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols/services on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.\n\nDatabase Management Systems using ports, protocols, and services deemed unsafe are open to attack through those ports, protocols, and services. This can allow unauthorized access to the database and through the database to other components of the information system.\n\n'\n  desc 'check', 'At the command prompt, run the following command:\n\n$ /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW port;\"\n\nExpected result:\n\n5432\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62914r935424_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259174'\n  tag rid: 'SV-259174r935426_rule'\n  tag stig_id: 'VCPG-80-000035'\n  tag gtitle: 'SRG-APP-000142-DB-000094'\n  tag fix_id: 'F-62823r935425_fix'\n  tag satisfies: ['SRG-APP-000142-DB-000094', 'SRG-APP-000383-DB-000364']\n  tag 'documentable'\n  tag cci: ['CCI-000382', 'CCI-001762']\n  tag nist: ['CM-7 b', 'CM-7 (1) (b)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259174.rb"},"title":"The vCenter PostgreSQL service must be configured to use an authorized port.","desc":"In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols/services on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.\n\nDatabase Management Systems using ports, protocols, and services deemed unsafe are open to attack through those ports, protocols, and services. This can allow unauthorized access to the database and through the database to other components of the information system.\n\n","descriptions":{"default":"In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols/services on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.\n\nDatabase Management Systems using ports, protocols, and services deemed unsafe are open to attack through those ports, protocols, and services. This can allow unauthorized access to the database and through the database to other components of the information system.\n\n","check":"At the command prompt, run the following command:\n\n$ /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW port;\"\n\nExpected result:\n\n5432\n\nIf the output does not match the expected result, this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62914r935424_chk","severity":"medium","gid":"V-259174","rid":"SV-259174r935426_rule","stig_id":"VCPG-80-000035","gtitle":"SRG-APP-000142-DB-000094","fix_id":"F-62823r935425_fix","satisfies":["SRG-APP-000142-DB-000094","SRG-APP-000383-DB-000364"],"documentable":null,"cci":["CCI-000382","CCI-001762"],"nist":["CM-7 b","CM-7 (1) (b)"]}},{"id":"SV-259175","code":"control 'SV-259175' do\n  title 'The vCenter PostgreSQL service must require authentication on all connections.'\n  desc 'To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system.\n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses, except the following:\n\n(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; and\n(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals using shared accounts, for detailed accountability of individual activity.\n\n'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# grep -v \"^#\" /storage/db/vpostgres/pg_hba.conf |grep '\\S'\n\nIf any lines are returned contain \"trust\" or \"password\" as an auth-method, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/storage/db/vpostgres/pg_hba.conf\n\nFind and update any line that has a method of \"trust\" or \"password\" in the far-right column.\n\nA correct, typical line will look like the below:\n\n# TYPE  DATABASE        USER            ADDRESS                 METHOD\nlocal       VCDB               vpxd                                            peer map=vcdb\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62915r935427_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259175'\n  tag rid: 'SV-259175r935429_rule'\n  tag stig_id: 'VCPG-80-000036'\n  tag gtitle: 'SRG-APP-000148-DB-000103'\n  tag fix_id: 'F-62824r935428_fix'\n  tag satisfies: ['SRG-APP-000148-DB-000103', 'SRG-APP-000172-DB-000075']\n  tag 'documentable'\n  tag cci: ['CCI-000197', 'CCI-000764']\n  tag nist: ['IA-5 (1) (c)', 'IA-2']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259175.rb"},"title":"The vCenter PostgreSQL service must require authentication on all connections.","desc":"To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system.\n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses, except the following:\n\n(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; and\n(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals using shared accounts, for detailed accountability of individual activity.\n\n","descriptions":{"default":"To assure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system.\n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses, except the following:\n\n(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; and\n(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals using shared accounts, for detailed accountability of individual activity.\n\n","check":"At the command prompt, run the following command:\n\n# grep -v \"^#\" /storage/db/vpostgres/pg_hba.conf |grep '\\S'\n\nIf any lines are returned contain \"trust\" or \"password\" as an auth-method, this is a finding.","fix":"Navigate to and open:\n\n/storage/db/vpostgres/pg_hba.conf\n\nFind and update any line that has a method of \"trust\" or \"password\" in the far-right column.\n\nA correct, typical line will look like the below:\n\n# TYPE  DATABASE        USER            ADDRESS                 METHOD\nlocal       VCDB               vpxd                                            peer map=vcdb\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62915r935427_chk","severity":"medium","gid":"V-259175","rid":"SV-259175r935429_rule","stig_id":"VCPG-80-000036","gtitle":"SRG-APP-000148-DB-000103","fix_id":"F-62824r935428_fix","satisfies":["SRG-APP-000148-DB-000103","SRG-APP-000172-DB-000075"],"documentable":null,"cci":["CCI-000197","CCI-000764"],"nist":["IA-5 (1) (c)","IA-2"]}},{"id":"SV-259176","code":"control 'SV-259176' do\n  title 'The vCenter PostgreSQL service must encrypt passwords for user authentication.'\n  desc 'The DOD standard for authentication is DOD-approved PKI certificates.\n\nAuthentication based on User ID and Password may be used only when it is not possible to employ a PKI certificate and requires AO approval.\n\nIn such cases, database passwords stored in clear text, using reversible encryption, or using unsalted hashes would be vulnerable to unauthorized disclosure. Database passwords must always be in the form of one-way, salted hashes when stored internally or externally to the database management system (DBMS).'\n  desc 'check', 'At the command prompt, run the following command:\n\n$ /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW password_encryption;\"\n\nExpected result:\n\nscram-sha-256\n\nIf the output does not match the expected result, this is a finding.\n\nNote: Prior to Update 2, \"md5\" is the expected result.'\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62916r935430_chk'\n  tag severity: 'high'\n  tag gid: 'V-259176'\n  tag rid: 'SV-259176r935432_rule'\n  tag stig_id: 'VCPG-80-000038'\n  tag gtitle: 'SRG-APP-000171-DB-000074'\n  tag fix_id: 'F-62825r935431_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000196']\n  tag nist: ['IA-5 (1) (c)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259176.rb"},"title":"The vCenter PostgreSQL service must encrypt passwords for user authentication.","desc":"The DOD standard for authentication is DOD-approved PKI certificates.\n\nAuthentication based on User ID and Password may be used only when it is not possible to employ a PKI certificate and requires AO approval.\n\nIn such cases, database passwords stored in clear text, using reversible encryption, or using unsalted hashes would be vulnerable to unauthorized disclosure. Database passwords must always be in the form of one-way, salted hashes when stored internally or externally to the database management system (DBMS).","descriptions":{"default":"The DOD standard for authentication is DOD-approved PKI certificates.\n\nAuthentication based on User ID and Password may be used only when it is not possible to employ a PKI certificate and requires AO approval.\n\nIn such cases, database passwords stored in clear text, using reversible encryption, or using unsalted hashes would be vulnerable to unauthorized disclosure. Database passwords must always be in the form of one-way, salted hashes when stored internally or externally to the database management system (DBMS).","check":"At the command prompt, run the following command:\n\n$ /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW password_encryption;\"\n\nExpected result:\n\nscram-sha-256\n\nIf the output does not match the expected result, this is a finding.\n\nNote: Prior to Update 2, \"md5\" is the expected result.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62916r935430_chk","severity":"high","gid":"V-259176","rid":"SV-259176r935432_rule","stig_id":"VCPG-80-000038","gtitle":"SRG-APP-000171-DB-000074","fix_id":"F-62825r935431_fix","documentable":null,"cci":["CCI-000196"],"nist":["IA-5 (1) (c)"]}},{"id":"SV-259177","code":"control 'SV-259177' do\n  title 'The vCenter PostgreSQL service must enforce authorized access to all PKI private keys stored/utilized by PostgreSQL.'\n  desc \"The DOD standard for authentication is DOD-approved PKI certificates. PKI certificate-based authentication is performed by requiring the certificate holder to cryptographically prove possession of the corresponding private key.\n\nIf the private key is stolen, an attacker can use the private key(s) to impersonate the certificate holder. In cases where the database management system (DBMS)-stored private keys are used to authenticate the DBMS to the system’s clients, loss of the corresponding private keys would allow an attacker to successfully perform undetected man in the middle attacks against the DBMS system and its clients.\n\nBoth the holder of a digital certificate and the issuing authority must take careful measures to protect the corresponding private key. Private keys should always be generated and protected in FIPS 140-2 validated cryptographic modules.\n\nAll access to the private key(s) of the DBMS must be restricted to authorized and authenticated users. If unauthorized users have access to one or more of the DBMS's private keys, an attacker could gain access to the key(s) and use them to impersonate the database on the network or otherwise perform unauthorized actions.\"\n  desc 'check', 'At the command prompt, run the following command:\n\n# stat -c \"%n is owned by %U:%G with permissions of %a\" /storage/db/vpostgres_ssl/server.key\n\nExample output:\n\n/storage/db/vpostgres_ssl/server.key is owned by vpostgres:vpgmongrp with permissions of 600\n\nIf the SSL key file is not owned by the user vpostgres and group vpgmongrp, this is a finding.\n\nIf the SSL key file has permissions more permissive than 0600, this is a finding.'\n  desc 'fix', 'At the command prompt, enter the following commands:\n\n# chmod 600 /storage/db/vpostgres_ssl/server.key\n# chown vpostgres:vpgmongrp /storage/db/vpostgres_ssl/server.key'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62917r935433_chk'\n  tag severity: 'high'\n  tag gid: 'V-259177'\n  tag rid: 'SV-259177r935435_rule'\n  tag stig_id: 'VCPG-80-000041'\n  tag gtitle: 'SRG-APP-000176-DB-000068'\n  tag fix_id: 'F-62826r935434_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000186']\n  tag nist: ['IA-5 (2) (a) (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259177.rb"},"title":"The vCenter PostgreSQL service must enforce authorized access to all PKI private keys stored/utilized by PostgreSQL.","desc":"The DOD standard for authentication is DOD-approved PKI certificates. PKI certificate-based authentication is performed by requiring the certificate holder to cryptographically prove possession of the corresponding private key.\n\nIf the private key is stolen, an attacker can use the private key(s) to impersonate the certificate holder. In cases where the database management system (DBMS)-stored private keys are used to authenticate the DBMS to the system’s clients, loss of the corresponding private keys would allow an attacker to successfully perform undetected man in the middle attacks against the DBMS system and its clients.\n\nBoth the holder of a digital certificate and the issuing authority must take careful measures to protect the corresponding private key. Private keys should always be generated and protected in FIPS 140-2 validated cryptographic modules.\n\nAll access to the private key(s) of the DBMS must be restricted to authorized and authenticated users. If unauthorized users have access to one or more of the DBMS's private keys, an attacker could gain access to the key(s) and use them to impersonate the database on the network or otherwise perform unauthorized actions.","descriptions":{"default":"The DOD standard for authentication is DOD-approved PKI certificates. PKI certificate-based authentication is performed by requiring the certificate holder to cryptographically prove possession of the corresponding private key.\n\nIf the private key is stolen, an attacker can use the private key(s) to impersonate the certificate holder. In cases where the database management system (DBMS)-stored private keys are used to authenticate the DBMS to the system’s clients, loss of the corresponding private keys would allow an attacker to successfully perform undetected man in the middle attacks against the DBMS system and its clients.\n\nBoth the holder of a digital certificate and the issuing authority must take careful measures to protect the corresponding private key. Private keys should always be generated and protected in FIPS 140-2 validated cryptographic modules.\n\nAll access to the private key(s) of the DBMS must be restricted to authorized and authenticated users. If unauthorized users have access to one or more of the DBMS's private keys, an attacker could gain access to the key(s) and use them to impersonate the database on the network or otherwise perform unauthorized actions.","check":"At the command prompt, run the following command:\n\n# stat -c \"%n is owned by %U:%G with permissions of %a\" /storage/db/vpostgres_ssl/server.key\n\nExample output:\n\n/storage/db/vpostgres_ssl/server.key is owned by vpostgres:vpgmongrp with permissions of 600\n\nIf the SSL key file is not owned by the user vpostgres and group vpgmongrp, this is a finding.\n\nIf the SSL key file has permissions more permissive than 0600, this is a finding.","fix":"At the command prompt, enter the following commands:\n\n# chmod 600 /storage/db/vpostgres_ssl/server.key\n# chown vpostgres:vpgmongrp /storage/db/vpostgres_ssl/server.key"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62917r935433_chk","severity":"high","gid":"V-259177","rid":"SV-259177r935435_rule","stig_id":"VCPG-80-000041","gtitle":"SRG-APP-000176-DB-000068","fix_id":"F-62826r935434_fix","documentable":null,"cci":["CCI-000186"],"nist":["IA-5 (2) (a) (1)"]}},{"id":"SV-259178","code":"control 'SV-259178' do\n  title 'The vCenter PostgreSQL service must maintain the authenticity of communications sessions by guarding against man-in-the-middle attacks that guess at Session ID values.'\n  desc 'One class of man-in-the-middle, or session hijacking, attack involves the adversary guessing at valid session identifiers based on patterns in identifiers already known.\n\nThe preferred technique for thwarting guesses at Session IDs is the generation of unique session identifiers using a FIPS 140-2 approved random number generator.\n\nHowever, it is recognized that available database management system (DBMS) products do not all implement the preferred technique yet may have other protections against session hijacking. Therefore, other techniques are acceptable, provided they are demonstrated to be effective.\n\n'\n  desc 'check', 'At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW ssl;\"\n\nIf \"ssl\" is not set to \"on\", this is a finding.'\n  desc 'fix', %q(At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl = 'on';\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl_cert_file = '/storage/db/vpostgres_ssl/server.crt';\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl_key_file = '/storage/db/vpostgres_ssl/server.key';\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl_ca_file = '/storage/db/vpostgres_ssl/root_ca.pem';\"\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres)\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62918r935436_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259178'\n  tag rid: 'SV-259178r935438_rule'\n  tag stig_id: 'VCPG-80-000049'\n  tag gtitle: 'SRG-APP-000224-DB-000384'\n  tag fix_id: 'F-62827r935437_fix'\n  tag satisfies: ['SRG-APP-000224-DB-000384', 'SRG-APP-000441-DB-000378', 'SRG-APP-000442-DB-000379']\n  tag 'documentable'\n  tag cci: ['CCI-001188', 'CCI-002420', 'CCI-002422']\n  tag nist: ['SC-23 (3)', 'SC-8 (2)', 'SC-8 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259178.rb"},"title":"The vCenter PostgreSQL service must maintain the authenticity of communications sessions by guarding against man-in-the-middle attacks that guess at Session ID values.","desc":"One class of man-in-the-middle, or session hijacking, attack involves the adversary guessing at valid session identifiers based on patterns in identifiers already known.\n\nThe preferred technique for thwarting guesses at Session IDs is the generation of unique session identifiers using a FIPS 140-2 approved random number generator.\n\nHowever, it is recognized that available database management system (DBMS) products do not all implement the preferred technique yet may have other protections against session hijacking. Therefore, other techniques are acceptable, provided they are demonstrated to be effective.\n\n","descriptions":{"default":"One class of man-in-the-middle, or session hijacking, attack involves the adversary guessing at valid session identifiers based on patterns in identifiers already known.\n\nThe preferred technique for thwarting guesses at Session IDs is the generation of unique session identifiers using a FIPS 140-2 approved random number generator.\n\nHowever, it is recognized that available database management system (DBMS) products do not all implement the preferred technique yet may have other protections against session hijacking. Therefore, other techniques are acceptable, provided they are demonstrated to be effective.\n\n","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW ssl;\"\n\nIf \"ssl\" is not set to \"on\", this is a finding.","fix":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl = 'on';\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl_cert_file = '/storage/db/vpostgres_ssl/server.crt';\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl_key_file = '/storage/db/vpostgres_ssl/server.key';\"\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl_ca_file = '/storage/db/vpostgres_ssl/root_ca.pem';\"\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62918r935436_chk","severity":"medium","gid":"V-259178","rid":"SV-259178r935438_rule","stig_id":"VCPG-80-000049","gtitle":"SRG-APP-000224-DB-000384","fix_id":"F-62827r935437_fix","satisfies":["SRG-APP-000224-DB-000384","SRG-APP-000441-DB-000378","SRG-APP-000442-DB-000379"],"documentable":null,"cci":["CCI-001188","CCI-002420","CCI-002422"],"nist":["SC-23 (3)","SC-8 (2)","SC-8 (2)"]}},{"id":"SV-259179","code":"control 'SV-259179' do\n  title 'The vCenter PostgreSQL service must write log entries to disk prior to returning operation success or failure.'\n  desc 'Failure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. Preserving system state information helps to facilitate system restart and return to the operational mode of the organization with less disruption of mission/business processes.\n\nAggregating log writes saves on performance but leaves a window for log data loss. The logging system inside PostgreSQL is capable of writing logs to disk, fully and completely before the associated operation is returned to the client. This ensures that database activity is always captured, even in the event of a system crash during or immediately after a given operation.'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SELECT name,setting FROM pg_settings WHERE name IN ('fsync','full_page_writes','synchronous_commit');\"\n\nExpected result:\n\nfsync              | on\nfull_page_writes   | on\nsynchronous_commit | on\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62919r935439_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259179'\n  tag rid: 'SV-259179r935441_rule'\n  tag stig_id: 'VCPG-80-000051'\n  tag gtitle: 'SRG-APP-000226-DB-000147'\n  tag fix_id: 'F-62828r935440_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001665']\n  tag nist: ['SC-24']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259179.rb"},"title":"The vCenter PostgreSQL service must write log entries to disk prior to returning operation success or failure.","desc":"Failure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. Preserving system state information helps to facilitate system restart and return to the operational mode of the organization with less disruption of mission/business processes.\n\nAggregating log writes saves on performance but leaves a window for log data loss. The logging system inside PostgreSQL is capable of writing logs to disk, fully and completely before the associated operation is returned to the client. This ensures that database activity is always captured, even in the event of a system crash during or immediately after a given operation.","descriptions":{"default":"Failure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. Preserving system state information helps to facilitate system restart and return to the operational mode of the organization with less disruption of mission/business processes.\n\nAggregating log writes saves on performance but leaves a window for log data loss. The logging system inside PostgreSQL is capable of writing logs to disk, fully and completely before the associated operation is returned to the client. This ensures that database activity is always captured, even in the event of a system crash during or immediately after a given operation.","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SELECT name,setting FROM pg_settings WHERE name IN ('fsync','full_page_writes','synchronous_commit');\"\n\nExpected result:\n\nfsync              | on\nfull_page_writes   | on\nsynchronous_commit | on\n\nIf the output does not match the expected result, this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62919r935439_chk","severity":"medium","gid":"V-259179","rid":"SV-259179r935441_rule","stig_id":"VCPG-80-000051","gtitle":"SRG-APP-000226-DB-000147","fix_id":"F-62828r935440_fix","documentable":null,"cci":["CCI-001665"],"nist":["SC-24"]}},{"id":"SV-259180","code":"control 'SV-259180' do\n  title 'The vCenter PostgreSQL service must provide nonprivileged users with minimal error information.'\n  desc 'Any DBMS or associated application providing too much information in error messages on the screen or printout risks compromising the data and security of the system. The structure and content of error messages need to contain the minimal amount of information.\n\nDatabases can inadvertently provide a wealth of information to an attacker through improperly handled error messages. In addition to sensitive business or personal information, database errors can provide host names, IP addresses, usernames, and other system information not required for troubleshooting but very useful to someone targeting the system.\n\n'\n  desc 'check', 'At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW client_min_messages;\"\n\nExpected result:\n\nerror\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62920r935442_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259180'\n  tag rid: 'SV-259180r935444_rule'\n  tag stig_id: 'VCPG-80-000060'\n  tag gtitle: 'SRG-APP-000266-DB-000162'\n  tag fix_id: 'F-62829r935443_fix'\n  tag satisfies: ['SRG-APP-000266-DB-000162', 'SRG-APP-000267-DB-000163']\n  tag 'documentable'\n  tag cci: ['CCI-001312', 'CCI-001314']\n  tag nist: ['SI-11 a', 'SI-11 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259180.rb"},"title":"The vCenter PostgreSQL service must provide nonprivileged users with minimal error information.","desc":"Any DBMS or associated application providing too much information in error messages on the screen or printout risks compromising the data and security of the system. The structure and content of error messages need to contain the minimal amount of information.\n\nDatabases can inadvertently provide a wealth of information to an attacker through improperly handled error messages. In addition to sensitive business or personal information, database errors can provide host names, IP addresses, usernames, and other system information not required for troubleshooting but very useful to someone targeting the system.\n\n","descriptions":{"default":"Any DBMS or associated application providing too much information in error messages on the screen or printout risks compromising the data and security of the system. The structure and content of error messages need to contain the minimal amount of information.\n\nDatabases can inadvertently provide a wealth of information to an attacker through improperly handled error messages. In addition to sensitive business or personal information, database errors can provide host names, IP addresses, usernames, and other system information not required for troubleshooting but very useful to someone targeting the system.\n\n","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW client_min_messages;\"\n\nExpected result:\n\nerror\n\nIf the output does not match the expected result, this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62920r935442_chk","severity":"medium","gid":"V-259180","rid":"SV-259180r935444_rule","stig_id":"VCPG-80-000060","gtitle":"SRG-APP-000266-DB-000162","fix_id":"F-62829r935443_fix","satisfies":["SRG-APP-000266-DB-000162","SRG-APP-000267-DB-000163"],"documentable":null,"cci":["CCI-001312","CCI-001314"],"nist":["SI-11 a","SI-11 b"]}},{"id":"SV-259181","code":"control 'SV-259181' do\n  title 'The vCenter PostgreSQL service must have log collection enabled.'\n  desc 'Without the ability to centrally manage the content captured in the audit records, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack.\n\nThe content captured in audit records must be managed from a central location (necessitating automation). Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records.\n\n'\n  desc 'check', 'At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW logging_collector;\"\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62921r935445_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259181'\n  tag rid: 'SV-259181r935447_rule'\n  tag stig_id: 'VCPG-80-000070'\n  tag gtitle: 'SRG-APP-000356-DB-000314'\n  tag fix_id: 'F-62830r935446_fix'\n  tag satisfies: ['SRG-APP-000356-DB-000314', 'SRG-APP-000381-DB-000361']\n  tag 'documentable'\n  tag cci: ['CCI-001814', 'CCI-001844']\n  tag nist: ['CM-5 (1)', 'AU-3 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259181.rb"},"title":"The vCenter PostgreSQL service must have log collection enabled.","desc":"Without the ability to centrally manage the content captured in the audit records, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack.\n\nThe content captured in audit records must be managed from a central location (necessitating automation). Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records.\n\n","descriptions":{"default":"Without the ability to centrally manage the content captured in the audit records, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack.\n\nThe content captured in audit records must be managed from a central location (necessitating automation). Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records.\n\n","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW logging_collector;\"\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62921r935445_chk","severity":"medium","gid":"V-259181","rid":"SV-259181r935447_rule","stig_id":"VCPG-80-000070","gtitle":"SRG-APP-000356-DB-000314","fix_id":"F-62830r935446_fix","satisfies":["SRG-APP-000356-DB-000314","SRG-APP-000381-DB-000361"],"documentable":null,"cci":["CCI-001814","CCI-001844"],"nist":["CM-5 (1)","AU-3 (2)"]}},{"id":"SV-259182","code":"control 'SV-259182' do\n  title 'The vCenter PostgreSQL service must use Coordinated Universal Time (UTC) for log timestamps.'\n  desc 'If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by PostgreSQL must include date and time. Time is commonly expressed in UTC, a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.'\n  desc 'check', 'At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_timezone;\"\n\nExpected result:\n\nUTC\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62922r935448_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259182'\n  tag rid: 'SV-259182r935450_rule'\n  tag stig_id: 'VCPG-80-000075'\n  tag gtitle: 'SRG-APP-000374-DB-000322'\n  tag fix_id: 'F-62831r935449_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001890']\n  tag nist: ['AU-8 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259182.rb"},"title":"The vCenter PostgreSQL service must use Coordinated Universal Time (UTC) for log timestamps.","desc":"If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by PostgreSQL must include date and time. Time is commonly expressed in UTC, a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.","descriptions":{"default":"If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by PostgreSQL must include date and time. Time is commonly expressed in UTC, a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_timezone;\"\n\nExpected result:\n\nUTC\n\nIf the output does not match the expected result, this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62922r935448_chk","severity":"medium","gid":"V-259182","rid":"SV-259182r935450_rule","stig_id":"VCPG-80-000075","gtitle":"SRG-APP-000374-DB-000322","fix_id":"F-62831r935449_fix","documentable":null,"cci":["CCI-001890"],"nist":["AU-8 b"]}},{"id":"SV-259183","code":"control 'SV-259183' do\n  title 'The vCenter PostgreSQL service must log all connection attempts.'\n  desc 'For completeness of forensic analysis, it is necessary to track successful and failed attempts to log on to PostgreSQL. Setting \"log_connections\" to \"on\" will cause each attempted connection to the server to be logged, as well as successful completion of client authentication.\n\n'\n  desc 'check', 'At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_connections;\"\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62923r935451_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259183'\n  tag rid: 'SV-259183r935453_rule'\n  tag stig_id: 'VCPG-80-000110'\n  tag gtitle: 'SRG-APP-000503-DB-000350'\n  tag fix_id: 'F-62832r935452_fix'\n  tag satisfies: ['SRG-APP-000503-DB-000350', 'SRG-APP-000503-DB-000351', 'SRG-APP-000506-DB-000353', 'SRG-APP-000508-DB-000358']\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259183.rb"},"title":"The vCenter PostgreSQL service must log all connection attempts.","desc":"For completeness of forensic analysis, it is necessary to track successful and failed attempts to log on to PostgreSQL. Setting \"log_connections\" to \"on\" will cause each attempted connection to the server to be logged, as well as successful completion of client authentication.\n\n","descriptions":{"default":"For completeness of forensic analysis, it is necessary to track successful and failed attempts to log on to PostgreSQL. Setting \"log_connections\" to \"on\" will cause each attempted connection to the server to be logged, as well as successful completion of client authentication.\n\n","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_connections;\"\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62923r935451_chk","severity":"medium","gid":"V-259183","rid":"SV-259183r935453_rule","stig_id":"VCPG-80-000110","gtitle":"SRG-APP-000503-DB-000350","fix_id":"F-62832r935452_fix","satisfies":["SRG-APP-000503-DB-000350","SRG-APP-000503-DB-000351","SRG-APP-000506-DB-000353","SRG-APP-000508-DB-000358"],"documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-259184","code":"control 'SV-259184' do\n  title 'The vCenter PostgreSQL service must log all client disconnections.'\n  desc \"Disconnection may be initiated by the user or forced by the system (as in a timeout) or result from a system or network failure. To the greatest extent possible, all disconnections must be logged.\n\nFor completeness of forensic analysis, it is necessary to know how long a user's (or other principal's) connection to PostgreSQL lasts. This can be achieved by recording disconnections, in addition to logons/connections, in the audit logs.\"\n  desc 'check', 'At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_disconnections;\"\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62924r935454_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259184'\n  tag rid: 'SV-259184r935456_rule'\n  tag stig_id: 'VCPG-80-000114'\n  tag gtitle: 'SRG-APP-000505-DB-000352'\n  tag fix_id: 'F-62833r935455_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259184.rb"},"title":"The vCenter PostgreSQL service must log all client disconnections.","desc":"Disconnection may be initiated by the user or forced by the system (as in a timeout) or result from a system or network failure. To the greatest extent possible, all disconnections must be logged.\n\nFor completeness of forensic analysis, it is necessary to know how long a user's (or other principal's) connection to PostgreSQL lasts. This can be achieved by recording disconnections, in addition to logons/connections, in the audit logs.","descriptions":{"default":"Disconnection may be initiated by the user or forced by the system (as in a timeout) or result from a system or network failure. To the greatest extent possible, all disconnections must be logged.\n\nFor completeness of forensic analysis, it is necessary to know how long a user's (or other principal's) connection to PostgreSQL lasts. This can be achieved by recording disconnections, in addition to logons/connections, in the audit logs.","check":"At the command prompt, run the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -A -t -c \"SHOW log_disconnections;\"\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.","fix":"A script is included with vCenter to generate a PostgreSQL STIG configuration.\n\nAt the command prompt, run the following commands:\n\n# chmod +x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n# /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py --action stig_enable --pg-data-dir /storage/db/vpostgres\n# chmod -x /opt/vmware/vpostgres/current/bin/vmw_vpg_config/vmw_vpg_config.py\n\nRestart the PostgreSQL service by running the following command:\n\n# vmon-cli --restart vmware-vpostgres"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62924r935454_chk","severity":"medium","gid":"V-259184","rid":"SV-259184r935456_rule","stig_id":"VCPG-80-000114","gtitle":"SRG-APP-000505-DB-000352","fix_id":"F-62833r935455_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-259185","code":"control 'SV-259185' do\n  title 'The vCenter PostgreSQL service must off-load audit data to a separate log management facility.'\n  desc 'Information stored in one location is vulnerable to accidental or incidental deletion or alteration.\n\nOff-loading is a common process in information systems with limited audit storage capacity.\n\nThe database management system (DBMS) may write audit records to database tables, to files in the file system, to other kinds of local repository, or directly to a centralized log management system. Whatever the method used, it must be compatible with off-loading the records to the centralized system.'\n  desc 'check', 'By default there is a vmware-services-vmware-vpostgres.conf rsyslog and vmware-services-vmware-postgres-archiver.conf configuration file that includes the service logs when syslog is configured on vCenter but it must be verified.\n\nAt the command prompt, run the following command:\n\n# cat /etc/vmware-syslog/vmware-services-vmware-vpostgres.conf\n\nExpected result:\n\n# vmware-vpostgres first logs stdout, before loading configuration\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/serverlog.stdout\"\n      Tag=\"vpostgres-first\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-vpostgres first logs stderr, before loading configuration\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/serverlog.stderr\"\n      Tag=\"vpostgres-first\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-vpostgres logs\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/postgresql-*.log\"\n      Tag=\"vpostgres\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the output does not match the expected result, this is a finding.\n\nAt the command prompt, run the following command:\n\n# cat /etc/vmware-syslog/vmware-services-vmware-postgres-archiver.conf\n\nExpected result:\n\n# vmware-postgres-archiver stdout log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/pg_archiver.log.stdout\"\n      Tag=\"postgres-archiver\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-postgres-archiver stderr log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/pg_archiver.log.stderr\"\n      Tag=\"postgres-archiver\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/vmware-syslog/vmware-services-vmware-vpostgres.conf\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\n# vmware-vpostgres first logs stdout, before loading configuration\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/serverlog.stdout\"\n      Tag=\"vpostgres-first\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-vpostgres first logs stderr, before loading configuration\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/serverlog.stderr\"\n      Tag=\"vpostgres-first\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-vpostgres logs\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/postgresql-*.log\"\n      Tag=\"vpostgres\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nNavigate to and open:\n\n/etc/vmware-syslog/vmware-services-vmware-postgres-archiver.conf\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\n# vmware-postgres-archiver stdout log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/pg_archiver.log.stdout\"\n      Tag=\"postgres-archiver\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-postgres-archiver stderr log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/pg_archiver.log.stderr\"\n      Tag=\"postgres-archiver\"\n      Severity=\"info\"\n      Facility=\"local0\")'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA PostgreSQL'\n  tag check_id: 'C-62925r935457_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259185'\n  tag rid: 'SV-259185r935459_rule'\n  tag stig_id: 'VCPG-80-000122'\n  tag gtitle: 'SRG-APP-000515-DB-000318'\n  tag fix_id: 'F-62834r935458_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_PostgreSQL_STIG_V1R1/controls/SV-259185.rb"},"title":"The vCenter PostgreSQL service must off-load audit data to a separate log management facility.","desc":"Information stored in one location is vulnerable to accidental or incidental deletion or alteration.\n\nOff-loading is a common process in information systems with limited audit storage capacity.\n\nThe database management system (DBMS) may write audit records to database tables, to files in the file system, to other kinds of local repository, or directly to a centralized log management system. Whatever the method used, it must be compatible with off-loading the records to the centralized system.","descriptions":{"default":"Information stored in one location is vulnerable to accidental or incidental deletion or alteration.\n\nOff-loading is a common process in information systems with limited audit storage capacity.\n\nThe database management system (DBMS) may write audit records to database tables, to files in the file system, to other kinds of local repository, or directly to a centralized log management system. Whatever the method used, it must be compatible with off-loading the records to the centralized system.","check":"By default there is a vmware-services-vmware-vpostgres.conf rsyslog and vmware-services-vmware-postgres-archiver.conf configuration file that includes the service logs when syslog is configured on vCenter but it must be verified.\n\nAt the command prompt, run the following command:\n\n# cat /etc/vmware-syslog/vmware-services-vmware-vpostgres.conf\n\nExpected result:\n\n# vmware-vpostgres first logs stdout, before loading configuration\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/serverlog.stdout\"\n      Tag=\"vpostgres-first\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-vpostgres first logs stderr, before loading configuration\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/serverlog.stderr\"\n      Tag=\"vpostgres-first\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-vpostgres logs\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/postgresql-*.log\"\n      Tag=\"vpostgres\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the output does not match the expected result, this is a finding.\n\nAt the command prompt, run the following command:\n\n# cat /etc/vmware-syslog/vmware-services-vmware-postgres-archiver.conf\n\nExpected result:\n\n# vmware-postgres-archiver stdout log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/pg_archiver.log.stdout\"\n      Tag=\"postgres-archiver\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-postgres-archiver stderr log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/pg_archiver.log.stderr\"\n      Tag=\"postgres-archiver\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open:\n\n/etc/vmware-syslog/vmware-services-vmware-vpostgres.conf\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\n# vmware-vpostgres first logs stdout, before loading configuration\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/serverlog.stdout\"\n      Tag=\"vpostgres-first\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-vpostgres first logs stderr, before loading configuration\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/serverlog.stderr\"\n      Tag=\"vpostgres-first\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-vpostgres logs\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/postgresql-*.log\"\n      Tag=\"vpostgres\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nNavigate to and open:\n\n/etc/vmware-syslog/vmware-services-vmware-postgres-archiver.conf\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\n# vmware-postgres-archiver stdout log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/pg_archiver.log.stdout\"\n      Tag=\"postgres-archiver\"\n      Severity=\"info\"\n      Facility=\"local0\")\n# vmware-postgres-archiver stderr log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vpostgres/pg_archiver.log.stderr\"\n      Tag=\"postgres-archiver\"\n      Severity=\"info\"\n      Facility=\"local0\")"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA PostgreSQL"}],"tags":{"check_id":"C-62925r935457_chk","severity":"medium","gid":"V-259185","rid":"SV-259185r935459_rule","stig_id":"VCPG-80-000122","gtitle":"SRG-APP-000515-DB-000318","fix_id":"F-62834r935458_fix","documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}}],"groups":[{"id":"controls/SV-259166.rb","title":null,"controls":["SV-259166"]},{"id":"controls/SV-259167.rb","title":null,"controls":["SV-259167"]},{"id":"controls/SV-259168.rb","title":null,"controls":["SV-259168"]},{"id":"controls/SV-259169.rb","title":null,"controls":["SV-259169"]},{"id":"controls/SV-259170.rb","title":null,"controls":["SV-259170"]},{"id":"controls/SV-259171.rb","title":null,"controls":["SV-259171"]},{"id":"controls/SV-259172.rb","title":null,"controls":["SV-259172"]},{"id":"controls/SV-259173.rb","title":null,"controls":["SV-259173"]},{"id":"controls/SV-259174.rb","title":null,"controls":["SV-259174"]},{"id":"controls/SV-259175.rb","title":null,"controls":["SV-259175"]},{"id":"controls/SV-259176.rb","title":null,"controls":["SV-259176"]},{"id":"controls/SV-259177.rb","title":null,"controls":["SV-259177"]},{"id":"controls/SV-259178.rb","title":null,"controls":["SV-259178"]},{"id":"controls/SV-259179.rb","title":null,"controls":["SV-259179"]},{"id":"controls/SV-259180.rb","title":null,"controls":["SV-259180"]},{"id":"controls/SV-259181.rb","title":null,"controls":["SV-259181"]},{"id":"controls/SV-259182.rb","title":null,"controls":["SV-259182"]},{"id":"controls/SV-259183.rb","title":null,"controls":["SV-259183"]},{"id":"controls/SV-259184.rb","title":null,"controls":["SV-259184"]},{"id":"controls/SV-259185.rb","title":null,"controls":["SV-259185"]}],"name":"VMW_vSphere_8-0_VCSA_PostgreSQL_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"1b929d407204f5dca2d81759c6e869c4936626e0eefcf9549651974556f6a7e1","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
