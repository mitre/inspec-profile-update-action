{"controls":[{"id":"SV-239196","code":"control 'SV-239196' do\n  title 'VMware Postgres must limit the number of connections.'\n  desc 'Database management includes the ability to control the number of users and user sessions utilizing a DBMS. Unlimited concurrent connections to the DBMS could allow a successful denial-of-service (DoS) attack by exhausting connection resources, and a system could fail or be degraded by an overload of legitimate users. Limiting the number of concurrent sessions per user is helpful in reducing these risks.\n\nThis requirement addresses concurrent session control for a single account. It does not address concurrent sessions by a single user via multiple system accounts and does not deal with the total number of sessions across all accounts.\n\nThe capability to limit the number of concurrent sessions per user must be configured in or added to the DBMS (for example, by use of a logon trigger) when this is technically feasible. Note that it is not sufficient to limit sessions via a web server or application server alone because legitimate users and adversaries can potentially connect to the DBMS by other means.\n\nThe organization will need to define the maximum number of concurrent sessions by account type, by account, or a combination thereof. In deciding on the appropriate number, it is important to consider the work requirements of the various types of users. For example, two might be an acceptable limit for general users accessing the database via an application, but 10 might be too few for a database administrator using a database management GUI tool, where each query tab and navigation pane may count as a separate session.\n\nSessions may also be referred to as connections or logons, which for the purposes of this requirement are synonyms.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW max_connections;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\n345\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET max_connections TO '345';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42429r678959_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239196'\n  tag rid: 'SV-239196r678961_rule'\n  tag stig_id: 'VCPG-67-000001'\n  tag gtitle: 'SRG-APP-000001-DB-000031'\n  tag fix_id: 'F-42388r678960_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239196.rb"},"title":"VMware Postgres must limit the number of connections.","desc":"Database management includes the ability to control the number of users and user sessions utilizing a DBMS. Unlimited concurrent connections to the DBMS could allow a successful denial-of-service (DoS) attack by exhausting connection resources, and a system could fail or be degraded by an overload of legitimate users. Limiting the number of concurrent sessions per user is helpful in reducing these risks.\n\nThis requirement addresses concurrent session control for a single account. It does not address concurrent sessions by a single user via multiple system accounts and does not deal with the total number of sessions across all accounts.\n\nThe capability to limit the number of concurrent sessions per user must be configured in or added to the DBMS (for example, by use of a logon trigger) when this is technically feasible. Note that it is not sufficient to limit sessions via a web server or application server alone because legitimate users and adversaries can potentially connect to the DBMS by other means.\n\nThe organization will need to define the maximum number of concurrent sessions by account type, by account, or a combination thereof. In deciding on the appropriate number, it is important to consider the work requirements of the various types of users. For example, two might be an acceptable limit for general users accessing the database via an application, but 10 might be too few for a database administrator using a database management GUI tool, where each query tab and navigation pane may count as a separate session.\n\nSessions may also be referred to as connections or logons, which for the purposes of this requirement are synonyms.","descriptions":{"default":"Database management includes the ability to control the number of users and user sessions utilizing a DBMS. Unlimited concurrent connections to the DBMS could allow a successful denial-of-service (DoS) attack by exhausting connection resources, and a system could fail or be degraded by an overload of legitimate users. Limiting the number of concurrent sessions per user is helpful in reducing these risks.\n\nThis requirement addresses concurrent session control for a single account. It does not address concurrent sessions by a single user via multiple system accounts and does not deal with the total number of sessions across all accounts.\n\nThe capability to limit the number of concurrent sessions per user must be configured in or added to the DBMS (for example, by use of a logon trigger) when this is technically feasible. Note that it is not sufficient to limit sessions via a web server or application server alone because legitimate users and adversaries can potentially connect to the DBMS by other means.\n\nThe organization will need to define the maximum number of concurrent sessions by account type, by account, or a combination thereof. In deciding on the appropriate number, it is important to consider the work requirements of the various types of users. For example, two might be an acceptable limit for general users accessing the database via an application, but 10 might be too few for a database administrator using a database management GUI tool, where each query tab and navigation pane may count as a separate session.\n\nSessions may also be referred to as connections or logons, which for the purposes of this requirement are synonyms.","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW max_connections;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\n345\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET max_connections TO '345';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42429r678959_chk","severity":"medium","gid":"V-239196","rid":"SV-239196r678961_rule","stig_id":"VCPG-67-000001","gtitle":"SRG-APP-000001-DB-000031","fix_id":"F-42388r678960_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-239197","code":"control 'SV-239197' do\n  title 'VMware Postgres log files must contain required fields.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. \n\nAudit records can be generated from various components within the DBMS (e.g., process, module). Certain specific application functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the DBMS will provide an audit record generation capability as the following: \n\n(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);\n\n(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities, or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and\n\n(iii) All account creation, modification, disabling, and termination actions.\n\nOrganizations may define additional events requiring continuous or ad hoc auditing.\n\n'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW log_line_prefix;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\n%m %c %x %d %u %r %p %l\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET log_line_prefix TO '%m %c %x %d %u %r %p %l ';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42430r678962_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239197'\n  tag rid: 'SV-239197r678964_rule'\n  tag stig_id: 'VCPG-67-000002'\n  tag gtitle: 'SRG-APP-000089-DB-000064'\n  tag fix_id: 'F-42389r678963_fix'\n  tag satisfies: ['SRG-APP-000089-DB-000064', 'SRG-APP-000095-DB-000039', 'SRG-APP-000096-DB-000040', 'SRG-APP-000097-DB-000041', 'SRG-APP-000098-DB-000042', 'SRG-APP-000099-DB-000043', 'SRG-APP-000100-DB-000201', 'SRG-APP-000101-DB-000044', 'SRG-APP-000375-DB-000323']\n  tag 'documentable'\n  tag cci: ['CCI-000169']\n  tag nist: ['AU-12 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239197.rb"},"title":"VMware Postgres log files must contain required fields.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. \n\nAudit records can be generated from various components within the DBMS (e.g., process, module). Certain specific application functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the DBMS will provide an audit record generation capability as the following: \n\n(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);\n\n(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities, or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and\n\n(iii) All account creation, modification, disabling, and termination actions.\n\nOrganizations may define additional events requiring continuous or ad hoc auditing.\n\n","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. \n\nAudit records can be generated from various components within the DBMS (e.g., process, module). Certain specific application functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the DBMS will provide an audit record generation capability as the following: \n\n(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);\n\n(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities, or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and\n\n(iii) All account creation, modification, disabling, and termination actions.\n\nOrganizations may define additional events requiring continuous or ad hoc auditing.\n\n","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW log_line_prefix;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\n%m %c %x %d %u %r %p %l\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET log_line_prefix TO '%m %c %x %d %u %r %p %l ';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42430r678962_chk","severity":"medium","gid":"V-239197","rid":"SV-239197r678964_rule","stig_id":"VCPG-67-000002","gtitle":"SRG-APP-000089-DB-000064","fix_id":"F-42389r678963_fix","satisfies":["SRG-APP-000089-DB-000064","SRG-APP-000095-DB-000039","SRG-APP-000096-DB-000040","SRG-APP-000097-DB-000041","SRG-APP-000098-DB-000042","SRG-APP-000099-DB-000043","SRG-APP-000100-DB-000201","SRG-APP-000101-DB-000044","SRG-APP-000375-DB-000323"],"documentable":null,"cci":["CCI-000169"],"nist":["AU-12 a"]}},{"id":"SV-239198","code":"control 'SV-239198' do\n  title 'VMware Postgres configuration files must not be accessible by unauthorized users.'\n  desc \"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events.\n\nSuppression of auditing could permit an adversary to evade detection.\n\nMisconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\n\"\n  desc 'check', \"At the command prompt, enter the following command:\n\n# find /storage/db/vpostgres/*conf* -xdev -type f -a '(' -not -perm 600 -o -not -user vpostgres -o -not -group users ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', 'At the command prompt, enter the following command:\n\n# chmod 600 <file>\n# chown vpostgres:users <file>\n\nNote: Replace <file> with the file with incorrect permissions.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42431r678965_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239198'\n  tag rid: 'SV-239198r678967_rule'\n  tag stig_id: 'VCPG-67-000003'\n  tag gtitle: 'SRG-APP-000090-DB-000065'\n  tag fix_id: 'F-42390r678966_fix'\n  tag satisfies: ['SRG-APP-000090-DB-000065', 'SRG-APP-000121-DB-000202', 'SRG-APP-000122-DB-000203', 'SRG-APP-000123-DB-000204', 'SRG-APP-000380-DB-000360']\n  tag 'documentable'\n  tag cci: ['CCI-000171']\n  tag nist: ['AU-12 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239198.rb"},"title":"VMware Postgres configuration files must not be accessible by unauthorized users.","desc":"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events.\n\nSuppression of auditing could permit an adversary to evade detection.\n\nMisconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\n","descriptions":{"default":"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events.\n\nSuppression of auditing could permit an adversary to evade detection.\n\nMisconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\n","check":"At the command prompt, enter the following command:\n\n# find /storage/db/vpostgres/*conf* -xdev -type f -a '(' -not -perm 600 -o -not -user vpostgres -o -not -group users ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.","fix":"At the command prompt, enter the following command:\n\n# chmod 600 <file>\n# chown vpostgres:users <file>\n\nNote: Replace <file> with the file with incorrect permissions."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42431r678965_chk","severity":"medium","gid":"V-239198","rid":"SV-239198r678967_rule","stig_id":"VCPG-67-000003","gtitle":"SRG-APP-000090-DB-000065","fix_id":"F-42390r678966_fix","satisfies":["SRG-APP-000090-DB-000065","SRG-APP-000121-DB-000202","SRG-APP-000122-DB-000203","SRG-APP-000123-DB-000204","SRG-APP-000380-DB-000360"],"documentable":null,"cci":["CCI-000171"],"nist":["AU-12 b"]}},{"id":"SV-239199","code":"control 'SV-239199' do\n  title 'VMware Postgres must be configured to overwrite older logs when necessary.'\n  desc 'It is critical that when the DBMS is at risk of failing to process audit logs as required, it take action to mitigate the failure. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Responses to audit failure depend on the nature of the failure mode. \n\nWhen availability is an overriding concern, approved actions in response to an audit failure are as follows: \n\n(i) If the failure was caused by the lack of audit record storage capacity, the DBMS must continue generating audit records, if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.\n\n(ii) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the DBMS must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.\n\nSystems where availability is paramount will most likely be MAC I; the final determination is the prerogative of the application owner, subject to Authorizing Official concurrence. In any case, sufficient auditing resources must be allocated to avoid audit data loss in all but the most extreme situations.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW log_truncate_on_rotation;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET log_truncate_on_rotation TO 'on';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42432r678968_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239199'\n  tag rid: 'SV-239199r678970_rule'\n  tag stig_id: 'VCPG-67-000004'\n  tag gtitle: 'SRG-APP-000109-DB-000321'\n  tag fix_id: 'F-42391r678969_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000140']\n  tag nist: ['AU-5 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239199.rb"},"title":"VMware Postgres must be configured to overwrite older logs when necessary.","desc":"It is critical that when the DBMS is at risk of failing to process audit logs as required, it take action to mitigate the failure. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Responses to audit failure depend on the nature of the failure mode. \n\nWhen availability is an overriding concern, approved actions in response to an audit failure are as follows: \n\n(i) If the failure was caused by the lack of audit record storage capacity, the DBMS must continue generating audit records, if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.\n\n(ii) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the DBMS must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.\n\nSystems where availability is paramount will most likely be MAC I; the final determination is the prerogative of the application owner, subject to Authorizing Official concurrence. In any case, sufficient auditing resources must be allocated to avoid audit data loss in all but the most extreme situations.","descriptions":{"default":"It is critical that when the DBMS is at risk of failing to process audit logs as required, it take action to mitigate the failure. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Responses to audit failure depend on the nature of the failure mode. \n\nWhen availability is an overriding concern, approved actions in response to an audit failure are as follows: \n\n(i) If the failure was caused by the lack of audit record storage capacity, the DBMS must continue generating audit records, if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.\n\n(ii) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the DBMS must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.\n\nSystems where availability is paramount will most likely be MAC I; the final determination is the prerogative of the application owner, subject to Authorizing Official concurrence. In any case, sufficient auditing resources must be allocated to avoid audit data loss in all but the most extreme situations.","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW log_truncate_on_rotation;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET log_truncate_on_rotation TO 'on';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42432r678968_chk","severity":"medium","gid":"V-239199","rid":"SV-239199r678970_rule","stig_id":"VCPG-67-000004","gtitle":"SRG-APP-000109-DB-000321","fix_id":"F-42391r678969_fix","documentable":null,"cci":["CCI-000140"],"nist":["AU-5 b"]}},{"id":"SV-239200","code":"control 'SV-239200' do\n  title 'VMware Postgres database must protect log files from unauthorized access and modification.'\n  desc 'If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, copy, etc.\n\nThis requirement can be achieved through multiple methods, which will depend on system architecture and design. Some commonly employed methods include ensuring log files have the proper file system permissions, using file system protections, and limiting log data location. \n\nAdditionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring that audit information is protected from unauthorized access.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\n'\n  desc 'check', \"At the command prompt, enter the following command:\n\n# find /var/log/vmware/vpostgres/* -xdev -type f -a '(' -not -perm 600 -o -not -user vpostgres -o -not -group users ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', %q(At the command prompt, enter the following command:\n\n# chmod 600 <file>\n# chown vpostgres:users <file>\n\nNote: Replace <file> with the file with incorrect permissions.\n\nAt the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET log_file_mode TO '0600';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42433r678971_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239200'\n  tag rid: 'SV-239200r678973_rule'\n  tag stig_id: 'VCPG-67-000005'\n  tag gtitle: 'SRG-APP-000118-DB-000059'\n  tag fix_id: 'F-42392r678972_fix'\n  tag satisfies: ['SRG-APP-000118-DB-000059', 'SRG-APP-000119-DB-000060', 'SRG-APP-000120-DB-000061']\n  tag 'documentable'\n  tag cci: ['CCI-000162']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239200.rb"},"title":"VMware Postgres database must protect log files from unauthorized access and modification.","desc":"If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, copy, etc.\n\nThis requirement can be achieved through multiple methods, which will depend on system architecture and design. Some commonly employed methods include ensuring log files have the proper file system permissions, using file system protections, and limiting log data location. \n\nAdditionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring that audit information is protected from unauthorized access.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\n","descriptions":{"default":"If audit data were to become compromised, competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, copy, etc.\n\nThis requirement can be achieved through multiple methods, which will depend on system architecture and design. Some commonly employed methods include ensuring log files have the proper file system permissions, using file system protections, and limiting log data location. \n\nAdditionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring that audit information is protected from unauthorized access.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\n","check":"At the command prompt, enter the following command:\n\n# find /var/log/vmware/vpostgres/* -xdev -type f -a '(' -not -perm 600 -o -not -user vpostgres -o -not -group users ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.","fix":"At the command prompt, enter the following command:\n\n# chmod 600 <file>\n# chown vpostgres:users <file>\n\nNote: Replace <file> with the file with incorrect permissions.\n\nAt the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET log_file_mode TO '0600';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42433r678971_chk","severity":"medium","gid":"V-239200","rid":"SV-239200r678973_rule","stig_id":"VCPG-67-000005","gtitle":"SRG-APP-000118-DB-000059","fix_id":"F-42392r678972_fix","satisfies":["SRG-APP-000118-DB-000059","SRG-APP-000119-DB-000060","SRG-APP-000120-DB-000061"],"documentable":null,"cci":["CCI-000162"],"nist":["AU-9 a"]}},{"id":"SV-239201","code":"control 'SV-239201' do\n  title 'All VCDB tables must be owned by the \"vc\" user account.'\n  desc \"Within the database, object ownership implies full privileges to the owned object, including the privilege to assign access to the owned objects to other subjects. Database functions and procedures can be coded using definer's rights. This allows anyone who uses the object to perform the actions if they were the owner. If not properly managed, this can lead to privileged actions being taken by unauthorized individuals.\n\nConversely, if critical tables or other objects rely on unauthorized owner accounts, these objects may be lost when an account is removed.\"\n  desc 'check', 'At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -d VCDB -x -U postgres -c \"\\\\dt;\"|grep Owner|grep -v vc\n\nIf any tables are returned, this is a finding.'\n  desc 'fix', 'At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER TABLE <tablename> OWNER TO vc;\"\n\nReplace <tablename> with the name of the table discovered during the check.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42434r678974_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239201'\n  tag rid: 'SV-239201r678976_rule'\n  tag stig_id: 'VCPG-67-000008'\n  tag gtitle: 'SRG-APP-000133-DB-000200'\n  tag fix_id: 'F-42393r678975_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001499']\n  tag nist: ['CM-5 (6)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239201.rb"},"title":"All VCDB tables must be owned by the \"vc\" user account.","desc":"Within the database, object ownership implies full privileges to the owned object, including the privilege to assign access to the owned objects to other subjects. Database functions and procedures can be coded using definer's rights. This allows anyone who uses the object to perform the actions if they were the owner. If not properly managed, this can lead to privileged actions being taken by unauthorized individuals.\n\nConversely, if critical tables or other objects rely on unauthorized owner accounts, these objects may be lost when an account is removed.","descriptions":{"default":"Within the database, object ownership implies full privileges to the owned object, including the privilege to assign access to the owned objects to other subjects. Database functions and procedures can be coded using definer's rights. This allows anyone who uses the object to perform the actions if they were the owner. If not properly managed, this can lead to privileged actions being taken by unauthorized individuals.\n\nConversely, if critical tables or other objects rely on unauthorized owner accounts, these objects may be lost when an account is removed.","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -d VCDB -x -U postgres -c \"\\dt;\"|grep Owner|grep -v vc\n\nIf any tables are returned, this is a finding.","fix":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER TABLE <tablename> OWNER TO vc;\"\n\nReplace <tablename> with the name of the table discovered during the check."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42434r678974_chk","severity":"medium","gid":"V-239201","rid":"SV-239201r678976_rule","stig_id":"VCPG-67-000008","gtitle":"SRG-APP-000133-DB-000200","fix_id":"F-42393r678975_fix","documentable":null,"cci":["CCI-001499"],"nist":["CM-5 (6)"]}},{"id":"SV-239202","code":"control 'SV-239202' do\n  title 'VMware Postgres must limit modify privileges to authorized accounts.'\n  desc 'If the DBMS were to allow any user to make changes to database structure or logic, those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to information system components to initiate changes, including upgrades and modifications.\n\nUnmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.'\n  desc 'check', 'At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"\\\\du;\"|grep \"Create\"\n\nExpected result:\n\n postgres   | Superuser, Create role, Create DB, Replication, Bypass RLS | {}\n vc         | Create DB                                                  | {}\n\nIf the accounts other than \"postgres\" and \"vc\" have any \"Create\" privileges, this is a finding.'\n  desc 'fix', 'At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"REVOKE ALL PRIVILEGES FROM <user>;\"\n\nReplace <user> with the account discovered during the check.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42435r678977_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239202'\n  tag rid: 'SV-239202r678979_rule'\n  tag stig_id: 'VCPG-67-000009'\n  tag gtitle: 'SRG-APP-000133-DB-000362'\n  tag fix_id: 'F-42394r678978_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001499']\n  tag nist: ['CM-5 (6)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239202.rb"},"title":"VMware Postgres must limit modify privileges to authorized accounts.","desc":"If the DBMS were to allow any user to make changes to database structure or logic, those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to information system components to initiate changes, including upgrades and modifications.\n\nUnmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.","descriptions":{"default":"If the DBMS were to allow any user to make changes to database structure or logic, those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to information system components to initiate changes, including upgrades and modifications.\n\nUnmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"\\du;\"|grep \"Create\"\n\nExpected result:\n\n postgres   | Superuser, Create role, Create DB, Replication, Bypass RLS | {}\n vc         | Create DB                                                  | {}\n\nIf the accounts other than \"postgres\" and \"vc\" have any \"Create\" privileges, this is a finding.","fix":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"REVOKE ALL PRIVILEGES FROM <user>;\"\n\nReplace <user> with the account discovered during the check."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42435r678977_chk","severity":"medium","gid":"V-239202","rid":"SV-239202r678979_rule","stig_id":"VCPG-67-000009","gtitle":"SRG-APP-000133-DB-000362","fix_id":"F-42394r678978_fix","documentable":null,"cci":["CCI-001499"],"nist":["CM-5 (6)"]}},{"id":"SV-239203","code":"control 'SV-239203' do\n  title 'VMware Postgres must be configured to use the correct port.'\n  desc 'To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols/services on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nDatabase management systems using ports, protocols, and services deemed unsafe are open to attack through those ports, protocols, and services. This can allow unauthorized access to the database and through the database to other components of the information system.\n\n'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW port;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\n5432\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET port TO '5432';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42436r678980_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239203'\n  tag rid: 'SV-239203r678982_rule'\n  tag stig_id: 'VCPG-67-000011'\n  tag gtitle: 'SRG-APP-000142-DB-000094'\n  tag fix_id: 'F-42395r678981_fix'\n  tag satisfies: ['SRG-APP-000142-DB-000094', 'SRG-APP-000383-DB-000364']\n  tag 'documentable'\n  tag cci: ['CCI-000382']\n  tag nist: ['CM-7 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239203.rb"},"title":"VMware Postgres must be configured to use the correct port.","desc":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols/services on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nDatabase management systems using ports, protocols, and services deemed unsafe are open to attack through those ports, protocols, and services. This can allow unauthorized access to the database and through the database to other components of the information system.\n\n","descriptions":{"default":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols/services on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nDatabase management systems using ports, protocols, and services deemed unsafe are open to attack through those ports, protocols, and services. This can allow unauthorized access to the database and through the database to other components of the information system.\n\n","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW port;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\n5432\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET port TO '5432';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42436r678980_chk","severity":"medium","gid":"V-239203","rid":"SV-239203r678982_rule","stig_id":"VCPG-67-000011","gtitle":"SRG-APP-000142-DB-000094","fix_id":"F-42395r678981_fix","satisfies":["SRG-APP-000142-DB-000094","SRG-APP-000383-DB-000364"],"documentable":null,"cci":["CCI-000382"],"nist":["CM-7 b"]}},{"id":"SV-239204","code":"control 'SV-239204' do\n  title 'VMware Postgres must require authentication on all connections.'\n  desc 'To ensure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system. \n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses, except the following:\n\n(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; \n\n(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals using shared accounts for detailed accountability of individual activity.\n\n'\n  desc 'check', 'At the command prompt, execute the following command:\n\n# grep -v \"^#\" /storage/db/vpostgres/pg_hba.conf|grep -z --color=always \"trust\"\n\nIf any lines are returned, this is a finding.'\n  desc 'fix', 'Navigate to and open /storage/db/pgdata/pg_hba.conf. \n\nFind and remove the line that has a method of \"trust\" in the far right column.\n\nA correct, typical line will look like the following:\n# TYPE  DATABASE        USER            ADDRESS                 METHOD\nhost       all                        all                 127.0.0.1/32           md5'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42437r678983_chk'\n  tag severity: 'high'\n  tag gid: 'V-239204'\n  tag rid: 'SV-239204r678985_rule'\n  tag stig_id: 'VCPG-67-000012'\n  tag gtitle: 'SRG-APP-000148-DB-000103'\n  tag fix_id: 'F-42396r678984_fix'\n  tag satisfies: ['SRG-APP-000148-DB-000103', 'SRG-APP-000171-DB-000074']\n  tag 'documentable'\n  tag cci: ['CCI-000764']\n  tag nist: ['IA-2']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239204.rb"},"title":"VMware Postgres must require authentication on all connections.","desc":"To ensure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system. \n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses, except the following:\n\n(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; \n\n(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals using shared accounts for detailed accountability of individual activity.\n\n","descriptions":{"default":"To ensure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system. \n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses, except the following:\n\n(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; \n\n(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals using shared accounts for detailed accountability of individual activity.\n\n","check":"At the command prompt, execute the following command:\n\n# grep -v \"^#\" /storage/db/vpostgres/pg_hba.conf|grep -z --color=always \"trust\"\n\nIf any lines are returned, this is a finding.","fix":"Navigate to and open /storage/db/pgdata/pg_hba.conf. \n\nFind and remove the line that has a method of \"trust\" in the far right column.\n\nA correct, typical line will look like the following:\n# TYPE  DATABASE        USER            ADDRESS                 METHOD\nhost       all                        all                 127.0.0.1/32           md5"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42437r678983_chk","severity":"high","gid":"V-239204","rid":"SV-239204r678985_rule","stig_id":"VCPG-67-000012","gtitle":"SRG-APP-000148-DB-000103","fix_id":"F-42396r678984_fix","satisfies":["SRG-APP-000148-DB-000103","SRG-APP-000171-DB-000074"],"documentable":null,"cci":["CCI-000764"],"nist":["IA-2"]}},{"id":"SV-239205","code":"control 'SV-239205' do\n  title 'VMware Postgres must be configured to use TLS.'\n  desc 'The DoD standard for authentication is DoD-approved PKI certificates.\n\nAuthentication based on user ID and password may be used only when it is not possible to employ a PKI certificate and requires AO approval.\n\nIn such cases, passwords need to be protected at all times, and encryption is the standard method for protecting passwords during transmission.\n\nDBMS passwords sent in clear-text format across the network are vulnerable to discovery by unauthorized users. Disclosure of passwords may easily lead to unauthorized access to the database.\n\n'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW ssl;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl TO 'on';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42438r678986_chk'\n  tag severity: 'high'\n  tag gid: 'V-239205'\n  tag rid: 'SV-239205r678988_rule'\n  tag stig_id: 'VCPG-67-000013'\n  tag gtitle: 'SRG-APP-000172-DB-000075'\n  tag fix_id: 'F-42397r678987_fix'\n  tag satisfies: ['SRG-APP-000172-DB-000075', 'SRG-APP-000442-DB-000379']\n  tag 'documentable'\n  tag cci: ['CCI-000197']\n  tag nist: ['IA-5 (1) (c)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239205.rb"},"title":"VMware Postgres must be configured to use TLS.","desc":"The DoD standard for authentication is DoD-approved PKI certificates.\n\nAuthentication based on user ID and password may be used only when it is not possible to employ a PKI certificate and requires AO approval.\n\nIn such cases, passwords need to be protected at all times, and encryption is the standard method for protecting passwords during transmission.\n\nDBMS passwords sent in clear-text format across the network are vulnerable to discovery by unauthorized users. Disclosure of passwords may easily lead to unauthorized access to the database.\n\n","descriptions":{"default":"The DoD standard for authentication is DoD-approved PKI certificates.\n\nAuthentication based on user ID and password may be used only when it is not possible to employ a PKI certificate and requires AO approval.\n\nIn such cases, passwords need to be protected at all times, and encryption is the standard method for protecting passwords during transmission.\n\nDBMS passwords sent in clear-text format across the network are vulnerable to discovery by unauthorized users. Disclosure of passwords may easily lead to unauthorized access to the database.\n\n","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW ssl;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl TO 'on';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42438r678986_chk","severity":"high","gid":"V-239205","rid":"SV-239205r678988_rule","stig_id":"VCPG-67-000013","gtitle":"SRG-APP-000172-DB-000075","fix_id":"F-42397r678987_fix","satisfies":["SRG-APP-000172-DB-000075","SRG-APP-000442-DB-000379"],"documentable":null,"cci":["CCI-000197"],"nist":["IA-5 (1) (c)"]}},{"id":"SV-239206","code":"control 'SV-239206' do\n  title 'VMware Postgres must enforce authorized access to all PKI private keys.'\n  desc \"The DoD standard for authentication is DoD-approved PKI certificates. PKI certificate-based authentication is performed by requiring the certificate holder to cryptographically prove possession of the corresponding private key.\n\nIf the private key is stolen, an attacker can use the private key(s) to impersonate the certificate holder. In cases where the DBMS-stored private keys are used to authenticate the DBMS to the system’s clients, loss of the corresponding private keys would allow an attacker to successfully carry out undetected man-in-the-middle attacks against the DBMS system and its clients.\n\nBoth the holder of a digital certificate and the issuing authority must take careful measures to protect the corresponding private key. Private keys should always be generated and protected in FIPS 140-2 validated cryptographic modules.\n\nAll access to the private key(s) of the DBMS must be restricted to authorized and authenticated users. If unauthorized users have access to one or more of the DBMS's private keys, an attacker could gain access to the key(s) and use them to impersonate the database on the network or otherwise perform unauthorized actions.\"\n  desc 'check', 'At the command prompt, execute the following command:\n\n# stat -c \"%a:%U:%G\" /storage/db/vpostgres_ssl/server.key\n\nExpected result:\n\n600:vpostgres:users\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'At the command prompt, execute the following commands:\n\n# chmod 600 /storage/db/vpostgres_ssl/server.key\n# chown vpostgres:users /storage/db/vpostgres_ssl/server.key'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42439r678989_chk'\n  tag severity: 'high'\n  tag gid: 'V-239206'\n  tag rid: 'SV-239206r678991_rule'\n  tag stig_id: 'VCPG-67-000014'\n  tag gtitle: 'SRG-APP-000176-DB-000068'\n  tag fix_id: 'F-42398r678990_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000186']\n  tag nist: ['IA-5 (2) (a) (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239206.rb"},"title":"VMware Postgres must enforce authorized access to all PKI private keys.","desc":"The DoD standard for authentication is DoD-approved PKI certificates. PKI certificate-based authentication is performed by requiring the certificate holder to cryptographically prove possession of the corresponding private key.\n\nIf the private key is stolen, an attacker can use the private key(s) to impersonate the certificate holder. In cases where the DBMS-stored private keys are used to authenticate the DBMS to the system’s clients, loss of the corresponding private keys would allow an attacker to successfully carry out undetected man-in-the-middle attacks against the DBMS system and its clients.\n\nBoth the holder of a digital certificate and the issuing authority must take careful measures to protect the corresponding private key. Private keys should always be generated and protected in FIPS 140-2 validated cryptographic modules.\n\nAll access to the private key(s) of the DBMS must be restricted to authorized and authenticated users. If unauthorized users have access to one or more of the DBMS's private keys, an attacker could gain access to the key(s) and use them to impersonate the database on the network or otherwise perform unauthorized actions.","descriptions":{"default":"The DoD standard for authentication is DoD-approved PKI certificates. PKI certificate-based authentication is performed by requiring the certificate holder to cryptographically prove possession of the corresponding private key.\n\nIf the private key is stolen, an attacker can use the private key(s) to impersonate the certificate holder. In cases where the DBMS-stored private keys are used to authenticate the DBMS to the system’s clients, loss of the corresponding private keys would allow an attacker to successfully carry out undetected man-in-the-middle attacks against the DBMS system and its clients.\n\nBoth the holder of a digital certificate and the issuing authority must take careful measures to protect the corresponding private key. Private keys should always be generated and protected in FIPS 140-2 validated cryptographic modules.\n\nAll access to the private key(s) of the DBMS must be restricted to authorized and authenticated users. If unauthorized users have access to one or more of the DBMS's private keys, an attacker could gain access to the key(s) and use them to impersonate the database on the network or otherwise perform unauthorized actions.","check":"At the command prompt, execute the following command:\n\n# stat -c \"%a:%U:%G\" /storage/db/vpostgres_ssl/server.key\n\nExpected result:\n\n600:vpostgres:users\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# chmod 600 /storage/db/vpostgres_ssl/server.key\n# chown vpostgres:users /storage/db/vpostgres_ssl/server.key"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42439r678989_chk","severity":"high","gid":"V-239206","rid":"SV-239206r678991_rule","stig_id":"VCPG-67-000014","gtitle":"SRG-APP-000176-DB-000068","fix_id":"F-42398r678990_fix","documentable":null,"cci":["CCI-000186"],"nist":["IA-5 (2) (a) (1)"]}},{"id":"SV-239207","code":"control 'SV-239207' do\n  title 'VMware Postgres must use FIPS 140-2 approved TLS ciphers.'\n  desc 'Use of weak or not validated cryptographic algorithms undermines the purposes of using encryption and digital signatures to protect data. Weak algorithms can be easily broken, and not validated cryptographic modules may not implement algorithms correctly. Unapproved cryptographic modules or algorithms should not be relied on for authentication, confidentiality or integrity. Weak cryptography could allow an attacker to gain access to and modify data stored in the database as well as the administration settings of the DBMS.\n\nApplications, including DBMSs, using cryptography are required to use approved NIST FIPS 140-2 validated cryptographic modules that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nThe security functions validated as part of FIPS 140-2 for cryptographic modules are described in FIPS 140-2 Annex A.\n\nNSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.\n\n'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW ssl_ciphers;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\n!aNULL:kECDH+AES:ECDH+AES:RSA+AES:@STRENGTH\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl_ciphers TO '!aNULL:kECDH+AES:ECDH+AES:RSA+AES:@STRENGTH';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42440r678992_chk'\n  tag severity: 'high'\n  tag gid: 'V-239207'\n  tag rid: 'SV-239207r678994_rule'\n  tag stig_id: 'VCPG-67-000015'\n  tag gtitle: 'SRG-APP-000179-DB-000114'\n  tag fix_id: 'F-42399r678993_fix'\n  tag satisfies: ['SRG-APP-000179-DB-000114', 'SRG-APP-000514-DB-000381', 'SRG-APP-000514-DB-000382', 'SRG-APP-000514-DB-000383']\n  tag 'documentable'\n  tag cci: ['CCI-000803']\n  tag nist: ['IA-7']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239207.rb"},"title":"VMware Postgres must use FIPS 140-2 approved TLS ciphers.","desc":"Use of weak or not validated cryptographic algorithms undermines the purposes of using encryption and digital signatures to protect data. Weak algorithms can be easily broken, and not validated cryptographic modules may not implement algorithms correctly. Unapproved cryptographic modules or algorithms should not be relied on for authentication, confidentiality or integrity. Weak cryptography could allow an attacker to gain access to and modify data stored in the database as well as the administration settings of the DBMS.\n\nApplications, including DBMSs, using cryptography are required to use approved NIST FIPS 140-2 validated cryptographic modules that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nThe security functions validated as part of FIPS 140-2 for cryptographic modules are described in FIPS 140-2 Annex A.\n\nNSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.\n\n","descriptions":{"default":"Use of weak or not validated cryptographic algorithms undermines the purposes of using encryption and digital signatures to protect data. Weak algorithms can be easily broken, and not validated cryptographic modules may not implement algorithms correctly. Unapproved cryptographic modules or algorithms should not be relied on for authentication, confidentiality or integrity. Weak cryptography could allow an attacker to gain access to and modify data stored in the database as well as the administration settings of the DBMS.\n\nApplications, including DBMSs, using cryptography are required to use approved NIST FIPS 140-2 validated cryptographic modules that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nThe security functions validated as part of FIPS 140-2 for cryptographic modules are described in FIPS 140-2 Annex A.\n\nNSA Type-X (where X=1, 2, 3, 4) products are NSA-certified, hardware-based encryption modules.\n\n","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW ssl_ciphers;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\n!aNULL:kECDH+AES:ECDH+AES:RSA+AES:@STRENGTH\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET ssl_ciphers TO '!aNULL:kECDH+AES:ECDH+AES:RSA+AES:@STRENGTH';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42440r678992_chk","severity":"high","gid":"V-239207","rid":"SV-239207r678994_rule","stig_id":"VCPG-67-000015","gtitle":"SRG-APP-000179-DB-000114","fix_id":"F-42399r678993_fix","satisfies":["SRG-APP-000179-DB-000114","SRG-APP-000514-DB-000381","SRG-APP-000514-DB-000382","SRG-APP-000514-DB-000383"],"documentable":null,"cci":["CCI-000803"],"nist":["IA-7"]}},{"id":"SV-239208","code":"control 'SV-239208' do\n  title 'VMware Postgres must write log entries to disk prior to returning operation success or failure.'\n  desc 'Failure to a known state can address safety or security in accordance with the mission/business needs of the organization.\n\nFailure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. \n\nPreserving information system state information helps to facilitate system restart and return to the operational mode of the organization with less disruption of mission/business processes. \n\nBecause it is usually not possible to test this capability in a production environment, systems should be validated either in a testing environment or prior to installation. This is usually a function of the design of the IDPS component. Compliance can be verified by acceptance/validation processes or vendor attestation.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT name,setting FROM pg_settings WHERE name IN ('fsync','full_page_writes','synchronous_commit');\"|sed -n '3,5p'|sed -e 's/^[ ]*//'\n\nExpected result:\n\nfsync              | on\nfull_page_writes   | on\nsynchronous_commit | on\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET <name> TO 'on';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\"\n\nNote: Substitute <name> with the incorrectly set parameter (fsync, full_page_writes, synchronous_commit))\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42441r678995_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239208'\n  tag rid: 'SV-239208r678997_rule'\n  tag stig_id: 'VCPG-67-000016'\n  tag gtitle: 'SRG-APP-000226-DB-000147'\n  tag fix_id: 'F-42400r678996_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001665']\n  tag nist: ['SC-24']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239208.rb"},"title":"VMware Postgres must write log entries to disk prior to returning operation success or failure.","desc":"Failure to a known state can address safety or security in accordance with the mission/business needs of the organization.\n\nFailure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. \n\nPreserving information system state information helps to facilitate system restart and return to the operational mode of the organization with less disruption of mission/business processes. \n\nBecause it is usually not possible to test this capability in a production environment, systems should be validated either in a testing environment or prior to installation. This is usually a function of the design of the IDPS component. Compliance can be verified by acceptance/validation processes or vendor attestation.","descriptions":{"default":"Failure to a known state can address safety or security in accordance with the mission/business needs of the organization.\n\nFailure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. \n\nPreserving information system state information helps to facilitate system restart and return to the operational mode of the organization with less disruption of mission/business processes. \n\nBecause it is usually not possible to test this capability in a production environment, systems should be validated either in a testing environment or prior to installation. This is usually a function of the design of the IDPS component. Compliance can be verified by acceptance/validation processes or vendor attestation.","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT name,setting FROM pg_settings WHERE name IN ('fsync','full_page_writes','synchronous_commit');\"|sed -n '3,5p'|sed -e 's/^[ ]*//'\n\nExpected result:\n\nfsync              | on\nfull_page_writes   | on\nsynchronous_commit | on\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET <name> TO 'on';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\"\n\nNote: Substitute <name> with the incorrectly set parameter (fsync, full_page_writes, synchronous_commit)"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42441r678995_chk","severity":"medium","gid":"V-239208","rid":"SV-239208r678997_rule","stig_id":"VCPG-67-000016","gtitle":"SRG-APP-000226-DB-000147","fix_id":"F-42400r678996_fix","documentable":null,"cci":["CCI-001665"],"nist":["SC-24"]}},{"id":"SV-239209","code":"control 'SV-239209' do\n  title 'VMware Postgres must not allow schema access to unauthorized accounts.'\n  desc 'An isolation boundary provides access control and protects the integrity of the hardware, software, and firmware that perform security functions. \n\nSecurity functions are the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based.\n\nDevelopers and implementers can increase the assurance in security functions by employing well-defined security policy models; structured, disciplined, and rigorous hardware and software development techniques; and sound system/security engineering principles. \n\nDatabase management systems typically separate security functionality from non-security functionality via separate databases or schemas. Database objects or code implementing security functionality should not be commingled with objects or code implementing application logic. When security and non-security functionality are commingled, users who have access to non-security functionality may be able to access security functionality.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"\\dp .*.;\"/opt/vmware/vpostgres/current/bin/psql -U postgres -c \"\\dp .*.;\"|grep -E \"information_schema|pg_catalog\"|awk -F '|' '{print $4}'|awk -F '/' '{print $1}'|grep -v \"=r\"|grep -v \"postgres\"|grep -v \"  \"\n\nIf any lines are returned, this is a finding.)\n  desc 'fix', 'At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"REVOKE ALL PRIVILEGES ON <name> FROM <user>;\"\n\nReplace <name> and <user> with the Access Privilege name and account, respectively, discovered during the check.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42442r678998_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239209'\n  tag rid: 'SV-239209r679000_rule'\n  tag stig_id: 'VCPG-67-000017'\n  tag gtitle: 'SRG-APP-000233-DB-000124'\n  tag fix_id: 'F-42401r678999_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001084']\n  tag nist: ['SC-3']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239209.rb"},"title":"VMware Postgres must not allow schema access to unauthorized accounts.","desc":"An isolation boundary provides access control and protects the integrity of the hardware, software, and firmware that perform security functions. \n\nSecurity functions are the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based.\n\nDevelopers and implementers can increase the assurance in security functions by employing well-defined security policy models; structured, disciplined, and rigorous hardware and software development techniques; and sound system/security engineering principles. \n\nDatabase management systems typically separate security functionality from non-security functionality via separate databases or schemas. Database objects or code implementing security functionality should not be commingled with objects or code implementing application logic. When security and non-security functionality are commingled, users who have access to non-security functionality may be able to access security functionality.","descriptions":{"default":"An isolation boundary provides access control and protects the integrity of the hardware, software, and firmware that perform security functions. \n\nSecurity functions are the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based.\n\nDevelopers and implementers can increase the assurance in security functions by employing well-defined security policy models; structured, disciplined, and rigorous hardware and software development techniques; and sound system/security engineering principles. \n\nDatabase management systems typically separate security functionality from non-security functionality via separate databases or schemas. Database objects or code implementing security functionality should not be commingled with objects or code implementing application logic. When security and non-security functionality are commingled, users who have access to non-security functionality may be able to access security functionality.","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"\\dp .*.;\"/opt/vmware/vpostgres/current/bin/psql -U postgres -c \"\\dp .*.;\"|grep -E \"information_schema|pg_catalog\"|awk -F '|' '{print $4}'|awk -F '/' '{print $1}'|grep -v \"=r\"|grep -v \"postgres\"|grep -v \"  \"\n\nIf any lines are returned, this is a finding.","fix":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"REVOKE ALL PRIVILEGES ON <name> FROM <user>;\"\n\nReplace <name> and <user> with the Access Privilege name and account, respectively, discovered during the check."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42442r678998_chk","severity":"medium","gid":"V-239209","rid":"SV-239209r679000_rule","stig_id":"VCPG-67-000017","gtitle":"SRG-APP-000233-DB-000124","fix_id":"F-42401r678999_fix","documentable":null,"cci":["CCI-001084"],"nist":["SC-3"]}},{"id":"SV-239210","code":"control 'SV-239210' do\n  title 'Data from the vPostgres database must be protected from unauthorized transfer.'\n  desc 'Applications, including DBMSs, must prevent unauthorized and unintended information transfer via shared system resources. \n\nData used for the development and testing of applications often involves copying data from production. It is important that specific procedures exist for this process, including the conditions under which such transfer may take place, where the copies may reside, and the rules for ensuring sensitive data is not exposed.\n\nCopies of sensitive data must not be misplaced or left in a temporary location without the proper controls.'\n  desc 'check', 'Obtain the site data-transfer policy from the ISSO.\n\nReview the policies and procedures used to ensure that all vRA data is being protected from unauthorized and unintended information transformation in accordance with site policy.\n\nIf the site data-transfer policy is not followed, this is a finding.'\n  desc 'fix', 'Modify any code used for moving data from production to development/test systems to comply with the organization-defined data transfer policy and to ensure that copies of production data are not left in unsecured locations.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42443r679001_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239210'\n  tag rid: 'SV-239210r679003_rule'\n  tag stig_id: 'VCPG-67-000018'\n  tag gtitle: 'SRG-APP-000243-DB-000128'\n  tag fix_id: 'F-42402r679002_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001090']\n  tag nist: ['SC-4']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239210.rb"},"title":"Data from the vPostgres database must be protected from unauthorized transfer.","desc":"Applications, including DBMSs, must prevent unauthorized and unintended information transfer via shared system resources. \n\nData used for the development and testing of applications often involves copying data from production. It is important that specific procedures exist for this process, including the conditions under which such transfer may take place, where the copies may reside, and the rules for ensuring sensitive data is not exposed.\n\nCopies of sensitive data must not be misplaced or left in a temporary location without the proper controls.","descriptions":{"default":"Applications, including DBMSs, must prevent unauthorized and unintended information transfer via shared system resources. \n\nData used for the development and testing of applications often involves copying data from production. It is important that specific procedures exist for this process, including the conditions under which such transfer may take place, where the copies may reside, and the rules for ensuring sensitive data is not exposed.\n\nCopies of sensitive data must not be misplaced or left in a temporary location without the proper controls.","check":"Obtain the site data-transfer policy from the ISSO.\n\nReview the policies and procedures used to ensure that all vRA data is being protected from unauthorized and unintended information transformation in accordance with site policy.\n\nIf the site data-transfer policy is not followed, this is a finding.","fix":"Modify any code used for moving data from production to development/test systems to comply with the organization-defined data transfer policy and to ensure that copies of production data are not left in unsecured locations."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42443r679001_chk","severity":"medium","gid":"V-239210","rid":"SV-239210r679003_rule","stig_id":"VCPG-67-000018","gtitle":"SRG-APP-000243-DB-000128","fix_id":"F-42402r679002_fix","documentable":null,"cci":["CCI-001090"],"nist":["SC-4"]}},{"id":"SV-239211","code":"control 'SV-239211' do\n  title 'VMware Postgres must provide non-privileged users with minimal error information.'\n  desc 'Any DBMS or associated application providing too much information in error messages on the screen or printout risks compromising the data and security of the system. The structure and content of error messages need to be carefully considered by the organization and development team.\n\nDatabases can inadvertently provide a wealth of information to an attacker through improperly handled error messages. In addition to sensitive business or personal information, database errors can provide host names, IP addresses, user names, and other system information not required for troubleshooting but very useful to someone targeting the system.\n\nCarefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, Social Security numbers, and credit card numbers.\n\nThis calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers, and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.\n\n'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW client_min_messages;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\nnotice\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET client_min_messages TO 'notice';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42444r679004_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239211'\n  tag rid: 'SV-239211r679006_rule'\n  tag stig_id: 'VCPG-67-000019'\n  tag gtitle: 'SRG-APP-000266-DB-000162'\n  tag fix_id: 'F-42403r679005_fix'\n  tag satisfies: ['SRG-APP-000266-DB-000162', 'SRG-APP-000267-DB-000163']\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239211.rb"},"title":"VMware Postgres must provide non-privileged users with minimal error information.","desc":"Any DBMS or associated application providing too much information in error messages on the screen or printout risks compromising the data and security of the system. The structure and content of error messages need to be carefully considered by the organization and development team.\n\nDatabases can inadvertently provide a wealth of information to an attacker through improperly handled error messages. In addition to sensitive business or personal information, database errors can provide host names, IP addresses, user names, and other system information not required for troubleshooting but very useful to someone targeting the system.\n\nCarefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, Social Security numbers, and credit card numbers.\n\nThis calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers, and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.\n\n","descriptions":{"default":"Any DBMS or associated application providing too much information in error messages on the screen or printout risks compromising the data and security of the system. The structure and content of error messages need to be carefully considered by the organization and development team.\n\nDatabases can inadvertently provide a wealth of information to an attacker through improperly handled error messages. In addition to sensitive business or personal information, database errors can provide host names, IP addresses, user names, and other system information not required for troubleshooting but very useful to someone targeting the system.\n\nCarefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, Social Security numbers, and credit card numbers.\n\nThis calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers, and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.\n\n","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW client_min_messages;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\nnotice\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET client_min_messages TO 'notice';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42444r679004_chk","severity":"medium","gid":"V-239211","rid":"SV-239211r679006_rule","stig_id":"VCPG-67-000019","gtitle":"SRG-APP-000266-DB-000162","fix_id":"F-42403r679005_fix","satisfies":["SRG-APP-000266-DB-000162","SRG-APP-000267-DB-000163"],"documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-239212","code":"control 'SV-239212' do\n  title 'VMware Postgres must have log collection enabled.'\n  desc 'Without the ability to centrally manage the content captured in the audit records, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack.\n\nThe content captured in audit records must be managed from a central location (necessitating automation). Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. \n\nThe DBMS may write audit records to database tables, to files in the file system, to other kinds of local repository, or directly to a centralized log management system. Whatever the method used, it must be compatible with offloading the records to the centralized system.\n\n'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW logging_collector;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET logging_collector TO 'on';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42445r679007_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239212'\n  tag rid: 'SV-239212r679009_rule'\n  tag stig_id: 'VCPG-67-000020'\n  tag gtitle: 'SRG-APP-000356-DB-000314'\n  tag fix_id: 'F-42404r679008_fix'\n  tag satisfies: ['SRG-APP-000356-DB-000314', 'SRG-APP-000356-DB-000315', 'SRG-APP-000381-DB-000361', 'SRG-APP-000492-DB-000333', 'SRG-APP-000495-DB-000326', 'SRG-APP-000495-DB-000327', 'SRG-APP-000495-DB-000328', 'SRG-APP-000495-DB-000329', 'SRG-APP-000496-DB-000334', 'SRG-APP-000496-DB-000335', 'SRG-APP-000499-DB-000330', 'SRG-APP-000499-DB-000331', 'SRG-APP-000501-DB-000336', 'SRG-APP-000501-DB-000337', 'SRG-APP-000504-DB-000354', 'SRG-APP-000504-DB-000355', 'SRG-APP-000507-DB-000356', 'SRG-APP-000507-DB-000357', 'SRG-APP-000508-DB-000358', 'SRG-APP-000492-DB-000332', 'SRG-APP-000503-DB-000351', 'SRG-APP-000506-DB-000353']\n  tag 'documentable'\n  tag cci: ['CCI-001844']\n  tag nist: ['AU-3 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239212.rb"},"title":"VMware Postgres must have log collection enabled.","desc":"Without the ability to centrally manage the content captured in the audit records, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack.\n\nThe content captured in audit records must be managed from a central location (necessitating automation). Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. \n\nThe DBMS may write audit records to database tables, to files in the file system, to other kinds of local repository, or directly to a centralized log management system. Whatever the method used, it must be compatible with offloading the records to the centralized system.\n\n","descriptions":{"default":"Without the ability to centrally manage the content captured in the audit records, identification, troubleshooting, and correlation of suspicious behavior would be difficult and could lead to a delayed or incomplete analysis of an ongoing attack.\n\nThe content captured in audit records must be managed from a central location (necessitating automation). Centralized management of audit records and logs provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. \n\nThe DBMS may write audit records to database tables, to files in the file system, to other kinds of local repository, or directly to a centralized log management system. Whatever the method used, it must be compatible with offloading the records to the centralized system.\n\n","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW logging_collector;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\non\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET logging_collector TO 'on';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42445r679007_chk","severity":"medium","gid":"V-239212","rid":"SV-239212r679009_rule","stig_id":"VCPG-67-000020","gtitle":"SRG-APP-000356-DB-000314","fix_id":"F-42404r679008_fix","satisfies":["SRG-APP-000356-DB-000314","SRG-APP-000356-DB-000315","SRG-APP-000381-DB-000361","SRG-APP-000492-DB-000333","SRG-APP-000495-DB-000326","SRG-APP-000495-DB-000327","SRG-APP-000495-DB-000328","SRG-APP-000495-DB-000329","SRG-APP-000496-DB-000334","SRG-APP-000496-DB-000335","SRG-APP-000499-DB-000330","SRG-APP-000499-DB-000331","SRG-APP-000501-DB-000336","SRG-APP-000501-DB-000337","SRG-APP-000504-DB-000354","SRG-APP-000504-DB-000355","SRG-APP-000507-DB-000356","SRG-APP-000507-DB-000357","SRG-APP-000508-DB-000358","SRG-APP-000492-DB-000332","SRG-APP-000503-DB-000351","SRG-APP-000506-DB-000353"],"documentable":null,"cci":["CCI-001844"],"nist":["AU-3 (2)"]}},{"id":"SV-239213","code":"control 'SV-239213' do\n  title 'VMware Postgres must be configured to log to stderr.'\n  desc 'Organizations are required to use a central log management system so, under normal conditions, the audit space allocated to the DBMS on its own server will not be an issue. However, space will still be required on the DBMS server for audit records in transit, and, under abnormal conditions, this could fill up. Because a requirement exists to halt processing upon audit failure, a service outage would result.\n\nIf support personnel are not notified immediately upon storage volume utilization reaching 75%, they are unable to plan for storage capacity expansion. \n\nThe appropriate support staff include, at a minimum, the ISSO and the DBA/SA.\n\n'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW log_destination;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\nstderr\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET log_destination TO 'stderr';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42446r679010_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239213'\n  tag rid: 'SV-239213r679012_rule'\n  tag stig_id: 'VCPG-67-000021'\n  tag gtitle: 'SRG-APP-000359-DB-000319'\n  tag fix_id: 'F-42405r679011_fix'\n  tag satisfies: ['SRG-APP-000359-DB-000319', 'SRG-APP-000515-DB-000318']\n  tag 'documentable'\n  tag cci: ['CCI-001855']\n  tag nist: ['AU-5 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239213.rb"},"title":"VMware Postgres must be configured to log to stderr.","desc":"Organizations are required to use a central log management system so, under normal conditions, the audit space allocated to the DBMS on its own server will not be an issue. However, space will still be required on the DBMS server for audit records in transit, and, under abnormal conditions, this could fill up. Because a requirement exists to halt processing upon audit failure, a service outage would result.\n\nIf support personnel are not notified immediately upon storage volume utilization reaching 75%, they are unable to plan for storage capacity expansion. \n\nThe appropriate support staff include, at a minimum, the ISSO and the DBA/SA.\n\n","descriptions":{"default":"Organizations are required to use a central log management system so, under normal conditions, the audit space allocated to the DBMS on its own server will not be an issue. However, space will still be required on the DBMS server for audit records in transit, and, under abnormal conditions, this could fill up. Because a requirement exists to halt processing upon audit failure, a service outage would result.\n\nIf support personnel are not notified immediately upon storage volume utilization reaching 75%, they are unable to plan for storage capacity expansion. \n\nThe appropriate support staff include, at a minimum, the ISSO and the DBA/SA.\n\n","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW log_destination;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\nstderr\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET log_destination TO 'stderr';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42446r679010_chk","severity":"medium","gid":"V-239213","rid":"SV-239213r679012_rule","stig_id":"VCPG-67-000021","gtitle":"SRG-APP-000359-DB-000319","fix_id":"F-42405r679011_fix","satisfies":["SRG-APP-000359-DB-000319","SRG-APP-000515-DB-000318"],"documentable":null,"cci":["CCI-001855"],"nist":["AU-5 (1)"]}},{"id":"SV-239214","code":"control 'SV-239214' do\n  title 'Rsyslog must be configured to monitor VMware Postgres logs.'\n  desc 'Organizations are required to use a central log management system, so, under normal conditions, the audit space allocated to the DBMS on its own server will not be an issue. However, space will still be required on the DBMS server for audit records in transit, and, under abnormal conditions, this could fill up. Because a requirement exists to halt processing upon audit failure, a service outage would result.\n\nIf support personnel are not notified immediately upon storage volume utilization reaching 75%, they are unable to plan for storage capacity expansion. \n\nThe appropriate support staff include, at a minimum, the ISSO and the DBA/SA.\n\n'\n  desc 'check', 'At the command prompt, execute the following command:\n\n# cat /etc/vmware-syslog/stig-services-vpostgres.conf\n\nExpected result:\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/serverlog.std*\"\nTag=\"vpostgres-first\"\nSeverity=\"info\"\nFacility=\"local0\")\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/postgresql-*.log\"\nTag=\"vpostgres\"\nSeverity=\"info\"\nFacility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result above, this is a finding.\n\nIf there is no output from the command, vPostgres will default to \"stderr\", and this is not a finding.'\n  desc 'fix', 'Navigate to and open /etc/vmware-syslog/stig-services-vpostgres.conf.\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/serverlog.std*\"\nTag=\"vpostgres-first\"\nSeverity=\"info\"\nFacility=\"local0\")\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/postgresql-*.log\"\nTag=\"vpostgres\"\nSeverity=\"info\"\nFacility=\"local0\")'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42447r679013_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239214'\n  tag rid: 'SV-239214r679015_rule'\n  tag stig_id: 'VCPG-67-000022'\n  tag gtitle: 'SRG-APP-000359-DB-000319'\n  tag fix_id: 'F-42406r679014_fix'\n  tag satisfies: ['SRG-APP-000359-DB-000319', 'SRG-APP-000360-DB-000320', 'SRG-APP-000092-DB-000208']\n  tag 'documentable'\n  tag cci: ['CCI-001855']\n  tag nist: ['AU-5 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239214.rb"},"title":"Rsyslog must be configured to monitor VMware Postgres logs.","desc":"Organizations are required to use a central log management system, so, under normal conditions, the audit space allocated to the DBMS on its own server will not be an issue. However, space will still be required on the DBMS server for audit records in transit, and, under abnormal conditions, this could fill up. Because a requirement exists to halt processing upon audit failure, a service outage would result.\n\nIf support personnel are not notified immediately upon storage volume utilization reaching 75%, they are unable to plan for storage capacity expansion. \n\nThe appropriate support staff include, at a minimum, the ISSO and the DBA/SA.\n\n","descriptions":{"default":"Organizations are required to use a central log management system, so, under normal conditions, the audit space allocated to the DBMS on its own server will not be an issue. However, space will still be required on the DBMS server for audit records in transit, and, under abnormal conditions, this could fill up. Because a requirement exists to halt processing upon audit failure, a service outage would result.\n\nIf support personnel are not notified immediately upon storage volume utilization reaching 75%, they are unable to plan for storage capacity expansion. \n\nThe appropriate support staff include, at a minimum, the ISSO and the DBA/SA.\n\n","check":"At the command prompt, execute the following command:\n\n# cat /etc/vmware-syslog/stig-services-vpostgres.conf\n\nExpected result:\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/serverlog.std*\"\nTag=\"vpostgres-first\"\nSeverity=\"info\"\nFacility=\"local0\")\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/postgresql-*.log\"\nTag=\"vpostgres\"\nSeverity=\"info\"\nFacility=\"local0\")\n\nIf the file does not exist, this is a finding.\n\nIf the output of the command does not match the expected result above, this is a finding.\n\nIf there is no output from the command, vPostgres will default to \"stderr\", and this is not a finding.","fix":"Navigate to and open /etc/vmware-syslog/stig-services-vpostgres.conf.\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/serverlog.std*\"\nTag=\"vpostgres-first\"\nSeverity=\"info\"\nFacility=\"local0\")\n\ninput(type=\"imfile\"\nFile=\"/var/log/vmware/vpostgres/postgresql-*.log\"\nTag=\"vpostgres\"\nSeverity=\"info\"\nFacility=\"local0\")"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42447r679013_chk","severity":"medium","gid":"V-239214","rid":"SV-239214r679015_rule","stig_id":"VCPG-67-000022","gtitle":"SRG-APP-000359-DB-000319","fix_id":"F-42406r679014_fix","satisfies":["SRG-APP-000359-DB-000319","SRG-APP-000360-DB-000320","SRG-APP-000092-DB-000208"],"documentable":null,"cci":["CCI-001855"],"nist":["AU-5 (1)"]}},{"id":"SV-239215","code":"control 'SV-239215' do\n  title 'VMware Postgres must use Coordinated Universal Time (UTC) for log timestamps.'\n  desc 'If time stamps are not applied consistently and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by the DBMS must include date and time. Time is commonly expressed in UTC, a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC. \n\nSome DBMS products offer a data type called TIMESTAMP that is not a representation of date and time. Rather, it is a database state counter and does not correspond to calendar and clock time. This requirement does not refer to that meaning of TIMESTAMP.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW log_timezone;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\nEtc/UTC\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET log_timezone TO 'Etc/UTC';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42448r679016_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239215'\n  tag rid: 'SV-239215r679018_rule'\n  tag stig_id: 'VCPG-67-000023'\n  tag gtitle: 'SRG-APP-000374-DB-000322'\n  tag fix_id: 'F-42407r679017_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001890']\n  tag nist: ['AU-8 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239215.rb"},"title":"VMware Postgres must use Coordinated Universal Time (UTC) for log timestamps.","desc":"If time stamps are not applied consistently and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by the DBMS must include date and time. Time is commonly expressed in UTC, a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC. \n\nSome DBMS products offer a data type called TIMESTAMP that is not a representation of date and time. Rather, it is a database state counter and does not correspond to calendar and clock time. This requirement does not refer to that meaning of TIMESTAMP.","descriptions":{"default":"If time stamps are not applied consistently and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by the DBMS must include date and time. Time is commonly expressed in UTC, a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC. \n\nSome DBMS products offer a data type called TIMESTAMP that is not a representation of date and time. Rather, it is a database state counter and does not correspond to calendar and clock time. This requirement does not refer to that meaning of TIMESTAMP.","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW log_timezone;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\nEtc/UTC\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET log_timezone TO 'Etc/UTC';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42448r679016_chk","severity":"medium","gid":"V-239215","rid":"SV-239215r679018_rule","stig_id":"VCPG-67-000023","gtitle":"SRG-APP-000374-DB-000322","fix_id":"F-42407r679017_fix","documentable":null,"cci":["CCI-001890"],"nist":["AU-8 b"]}},{"id":"SV-239216","code":"control 'SV-239216' do\n  title 'VMware Postgres must set client-side character encoding to UTF-8.'\n  desc 'A common vulnerability is unplanned behavior when invalid inputs are received. This requirement guards against adverse or unintended system behavior caused by invalid inputs, where information system responses to the invalid input may be disruptive or cause the system to fail to an unsafe state.\n\nThe behavior will be derived from the organizational and system requirements and includes but is not limited to notifying the appropriate personnel, creating an audit record, and rejecting invalid input.\n\nThis calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the DBA is organizationally separate from the application developer, and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.'\n  desc 'check', %q(At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW client_encoding;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\nUTF8\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', %q(At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET client_encoding TO 'UTF8';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\")\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42449r679019_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239216'\n  tag rid: 'SV-239216r679021_rule'\n  tag stig_id: 'VCPG-67-000024'\n  tag gtitle: 'SRG-APP-000447-DB-000393'\n  tag fix_id: 'F-42408r679020_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002754']\n  tag nist: ['SI-10 (3)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239216.rb"},"title":"VMware Postgres must set client-side character encoding to UTF-8.","desc":"A common vulnerability is unplanned behavior when invalid inputs are received. This requirement guards against adverse or unintended system behavior caused by invalid inputs, where information system responses to the invalid input may be disruptive or cause the system to fail to an unsafe state.\n\nThe behavior will be derived from the organizational and system requirements and includes but is not limited to notifying the appropriate personnel, creating an audit record, and rejecting invalid input.\n\nThis calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the DBA is organizationally separate from the application developer, and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.","descriptions":{"default":"A common vulnerability is unplanned behavior when invalid inputs are received. This requirement guards against adverse or unintended system behavior caused by invalid inputs, where information system responses to the invalid input may be disruptive or cause the system to fail to an unsafe state.\n\nThe behavior will be derived from the organizational and system requirements and includes but is not limited to notifying the appropriate personnel, creating an audit record, and rejecting invalid input.\n\nThis calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the DBA is organizationally separate from the application developer, and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed and must document what has been discovered.","check":"At the command prompt, execute the following command:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SHOW client_encoding;\"|sed -n 3p|sed -e 's/^[ ]*//'\n\nExpected result:\n\nUTF8\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, execute the following commands:\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"ALTER SYSTEM SET client_encoding TO 'UTF8';\"\n\n# /opt/vmware/vpostgres/current/bin/psql -U postgres -c \"SELECT pg_reload_conf();\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42449r679019_chk","severity":"medium","gid":"V-239216","rid":"SV-239216r679021_rule","stig_id":"VCPG-67-000024","gtitle":"SRG-APP-000447-DB-000393","fix_id":"F-42408r679020_fix","documentable":null,"cci":["CCI-002754"],"nist":["SI-10 (3)"]}},{"id":"SV-239217","code":"control 'SV-239217' do\n  title 'The vPostgres database security updates and patches must be installed in a timely manner in accordance with site policy.'\n  desc 'Security flaws with software applications, including database management systems, are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously. \n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw). \n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and also to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may depend on the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).'\n  desc 'check', 'Obtain supporting documentation from the ISSO.\n\nReview the policies and procedures used to ensure that all security-related upgrades are being installed within the configured time period directed by an authoritative source.\n\nIf all security-related upgrades are not being installed within the configured time period directed by an authoritative source, this is a finding.'\n  desc 'fix', 'Ensure that patches and updates from an authoritative source are applied within 24 hours after they have been received.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 6.7 PostgreSQL'\n  tag check_id: 'C-42450r679022_chk'\n  tag severity: 'medium'\n  tag gid: 'V-239217'\n  tag rid: 'SV-239217r679024_rule'\n  tag stig_id: 'VCPG-67-000025'\n  tag gtitle: 'SRG-APP-000456-DB-000390'\n  tag fix_id: 'F-42409r679023_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002605']\n  tag nist: ['SI-2 c']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_6-7_PostgreSQL_STIG_V1R1/controls/SV-239217.rb"},"title":"The vPostgres database security updates and patches must be installed in a timely manner in accordance with site policy.","desc":"Security flaws with software applications, including database management systems, are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously. \n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw). \n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and also to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may depend on the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).","descriptions":{"default":"Security flaws with software applications, including database management systems, are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously. \n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw). \n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and also to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality, will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may depend on the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).","check":"Obtain supporting documentation from the ISSO.\n\nReview the policies and procedures used to ensure that all security-related upgrades are being installed within the configured time period directed by an authoritative source.\n\nIf all security-related upgrades are not being installed within the configured time period directed by an authoritative source, this is a finding.","fix":"Ensure that patches and updates from an authoritative source are applied within 24 hours after they have been received."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 6.7 PostgreSQL"}],"tags":{"check_id":"C-42450r679022_chk","severity":"medium","gid":"V-239217","rid":"SV-239217r679024_rule","stig_id":"VCPG-67-000025","gtitle":"SRG-APP-000456-DB-000390","fix_id":"F-42409r679023_fix","documentable":null,"cci":["CCI-002605"],"nist":["SI-2 c"]}}],"groups":[{"id":"controls/SV-239196.rb","title":null,"controls":["SV-239196"]},{"id":"controls/SV-239197.rb","title":null,"controls":["SV-239197"]},{"id":"controls/SV-239198.rb","title":null,"controls":["SV-239198"]},{"id":"controls/SV-239199.rb","title":null,"controls":["SV-239199"]},{"id":"controls/SV-239200.rb","title":null,"controls":["SV-239200"]},{"id":"controls/SV-239201.rb","title":null,"controls":["SV-239201"]},{"id":"controls/SV-239202.rb","title":null,"controls":["SV-239202"]},{"id":"controls/SV-239203.rb","title":null,"controls":["SV-239203"]},{"id":"controls/SV-239204.rb","title":null,"controls":["SV-239204"]},{"id":"controls/SV-239205.rb","title":null,"controls":["SV-239205"]},{"id":"controls/SV-239206.rb","title":null,"controls":["SV-239206"]},{"id":"controls/SV-239207.rb","title":null,"controls":["SV-239207"]},{"id":"controls/SV-239208.rb","title":null,"controls":["SV-239208"]},{"id":"controls/SV-239209.rb","title":null,"controls":["SV-239209"]},{"id":"controls/SV-239210.rb","title":null,"controls":["SV-239210"]},{"id":"controls/SV-239211.rb","title":null,"controls":["SV-239211"]},{"id":"controls/SV-239212.rb","title":null,"controls":["SV-239212"]},{"id":"controls/SV-239213.rb","title":null,"controls":["SV-239213"]},{"id":"controls/SV-239214.rb","title":null,"controls":["SV-239214"]},{"id":"controls/SV-239215.rb","title":null,"controls":["SV-239215"]},{"id":"controls/SV-239216.rb","title":null,"controls":["SV-239216"]},{"id":"controls/SV-239217.rb","title":null,"controls":["SV-239217"]}],"name":"VMW_vSphere_6-7_PostgreSQL_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"ca46e27d016097197e6ef5ec6fe1ac02c388e3d13eaf5f84caf2f16ca1668189","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
