{"controls":[{"id":"SV-237320","code":"control 'SV-237320' do\n  title 'The ArcGIS Server must protect the integrity of remote access sessions by enabling HTTPS with DoD-approved certificates.'\n  desc 'Without cryptographic integrity protections, information can be altered by unauthorized users without detection. \n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. \n\nCryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash.'\n  desc 'check', 'Review the ArcGIS for Server configuration to ensure the application implements cryptographic mechanisms to protect the integrity of remote access sessions. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to IIS Manager >> [Default Website] >> Open “Bindings...”\nVerify “https” is listed as a binding.\nIf “https” is not identified as a binding, this is a finding.\n\nNavigate to IIS Manager >> [Default Website] >> “SSL Settings”\nVerify that “Require SSL” is checked.\nIf “Require SSL” is not checked, this is a finding.\n\nThis control is not applicable for ArcGIS Servers which are deployed as part of a solution which ensures user web service traffic flows through third-party DoD compliant transport encryption devices (such as a load balancer that supports TLS encryption using DoD-approved certificates.)\n\nThis control is not applicable for ArcGIS Servers which are not deployed with the ArcGIS Web Adaptor component.'\n  desc 'fix', 'Configure the ArcGIS Server to ensure the application implements cryptographic mechanisms to protect the integrity of remote access sessions. Substitute the target environment’s values for [bracketed] variables. \n\nNavigate to IIS Manager >> [Default Website] >> Open \"Bindings...\". Click \"Add...\"\n\nUnder \"Type:\", select \"https\". Select an organizationally approved SSL certificate to associate with the https binding. (If no SSL Certificate is available, refer to http://technet.microsoft.com/en-us/library/cc731977(v=ws.10).aspx for guidance on requesting and installing an Internet Server Certificate [IIS 7]).\n\nNavigate to IIS Manager >> [Default Website] >> SSL Settings. Check \"Require SSL\".'\n  impact 0.7\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40539r642777_chk'\n  tag severity: 'high'\n  tag gid: 'V-237320'\n  tag rid: 'SV-237320r879520_rule'\n  tag stig_id: 'AGIS-00-000007'\n  tag gtitle: 'SRG-APP-000015'\n  tag fix_id: 'F-40502r642778_fix'\n  tag 'documentable'\n  tag legacy: ['SV-79809', 'V-65319']\n  tag cci: ['CCI-001453']\n  tag nist: ['AC-17 (2)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237320.rb"},"title":"The ArcGIS Server must protect the integrity of remote access sessions by enabling HTTPS with DoD-approved certificates.","desc":"Without cryptographic integrity protections, information can be altered by unauthorized users without detection. \n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. \n\nCryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash.","descriptions":{"default":"Without cryptographic integrity protections, information can be altered by unauthorized users without detection. \n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, non-organization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. \n\nCryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash.","check":"Review the ArcGIS for Server configuration to ensure the application implements cryptographic mechanisms to protect the integrity of remote access sessions. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to IIS Manager >> [Default Website] >> Open “Bindings...”\nVerify “https” is listed as a binding.\nIf “https” is not identified as a binding, this is a finding.\n\nNavigate to IIS Manager >> [Default Website] >> “SSL Settings”\nVerify that “Require SSL” is checked.\nIf “Require SSL” is not checked, this is a finding.\n\nThis control is not applicable for ArcGIS Servers which are deployed as part of a solution which ensures user web service traffic flows through third-party DoD compliant transport encryption devices (such as a load balancer that supports TLS encryption using DoD-approved certificates.)\n\nThis control is not applicable for ArcGIS Servers which are not deployed with the ArcGIS Web Adaptor component.","fix":"Configure the ArcGIS Server to ensure the application implements cryptographic mechanisms to protect the integrity of remote access sessions. Substitute the target environment’s values for [bracketed] variables. \n\nNavigate to IIS Manager >> [Default Website] >> Open \"Bindings...\". Click \"Add...\"\n\nUnder \"Type:\", select \"https\". Select an organizationally approved SSL certificate to associate with the https binding. (If no SSL Certificate is available, refer to http://technet.microsoft.com/en-us/library/cc731977(v=ws.10).aspx for guidance on requesting and installing an Internet Server Certificate [IIS 7]).\n\nNavigate to IIS Manager >> [Default Website] >> SSL Settings. Check \"Require SSL\"."},"impact":0.7,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40539r642777_chk","severity":"high","gid":"V-237320","rid":"SV-237320r879520_rule","stig_id":"AGIS-00-000007","gtitle":"SRG-APP-000015","fix_id":"F-40502r642778_fix","documentable":null,"legacy":["SV-79809","V-65319"],"cci":["CCI-001453"],"nist":["AC-17 (2)"]}},{"id":"SV-237321","code":"control 'SV-237321' do\n  title 'The ArcGIS Server must use Windows authentication for supporting account management functions.'\n  desc \"Enterprise environments make application account management challenging and complex. A manual process for account management functions adds the risk of a potential oversight or other error. \n\nA comprehensive application account management process that includes automation helps to ensure accounts designated as requiring attention are consistently and promptly addressed. Examples include, but are not limited to, using automation to take action on multiple accounts designated as inactive, suspended or terminated or by disabling accounts located in non-centralized account stores such as multiple servers. This requirement applies to all account types, including individual/user, shared, group, system, guest/anonymous, emergency, developer/manufacturer/vendor, temporary, and service.\n\nThe application must be configured to automatically provide account management functions and these functions must immediately enforce the organization's current account policy. The automated mechanisms may reside within the application itself or may be offered by the operating system or other infrastructure providing automated account management capabilities. Automated mechanisms may be comprised of differing technologies that when placed together contain an overall automated mechanism supporting an organization's automated account management requirements. \n\nAccount management functions include: assignment of group or role membership; identifying account type; specifying user access authorizations (i.e., privileges); account removal, update, or termination; and administrative alerts. The use of automated mechanisms can include, for example: using email or text messaging to automatically notify account managers when users are terminated or transferred; using the information system to monitor account usage; and using automated telephonic notification to report atypical system account usage.\n\n\"\n  desc 'check', 'Review the ArcGIS for Server configuration to ensure mechanisms for supporting account management functions are provided. Substitute the target environment’s values for [bracketed] variables.\n\nVerify ArcGIS for Server is utilizing Windows Users & Roles as its security store.\n\nNavigate to [https://server.domain.com/arcgis]/admin/security/config (logon when prompted.)\nVerify the “User Store Configuration” value = “Type: Windows”.\nIf the “User Store Configuration” value is set to “Type: Built-In”, this is a finding.\n\nVerify the “Role Store Configuration” value = “Type: Windows”.\nIf the “Role store Configuration” value is set to “Type: Built-In”, this is a finding.\n\nIf the \"Type\" parameter of the \"User Store Configuration\" or \"Role Store Configuration\" is set to \"Built-In\", this is a finding.\n\nThis test requires the account performing the check to have \"Administrator\" privilege to the ArcGIS for Server site. This check can be performed remotely via HTTPS. This configuration is only valid when ArcGIS for Server has been deployed onto a Windows 2008 or later operating system that is a member of an Active Directory domain.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.'\n  desc 'fix', 'Configure ArcGIS for Server to provide mechanisms for supporting account management functions. Substitute the target environment’s values for [bracketed] variables.\n\nConfigure ArcGIS for Server to utilize a Windows Domain for User and Role Management. Note: This procedure will disrupt existing systems connected to ArcGIS for Server:\n\nIdentify a system that will serve as the service endpoint for the ArcGIS for Server environment. This must be an Active Directory joined Windows 2008 R2 system with IIS 7.5 or later installed. If a Web Application Firewall (WAF), and/or Load Balancer serves as the user-connection endpoint, this system must be deployed on a trusted network behind these front-end technologies.\n\nOn this system (locally), perform the following steps:\nInstall the “ArcGIS Web Adaptor”.\nConfigure the “ArcGIS Web Adaptor” such that “Administration” is enabled via the Web Adaptor.\n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\"\n\nConfigure ArcGIS for Server to utilize Windows Users and Roles:\n\nNavigate to ArcGIS Server Manager ([https://server.domain.com/arcgis]/manager). (logon when prompted.)\nNavigate to the “Security” tab.\nNavigate to the “Settings” sub-tab.\nEdit “Configuration Settings” by clicking on the pencil icon.\n\nSelect “Users and roles from an existing enterprise system (LDAP or Windows Domain)”, then click “Next”.\nSelect “Windows Domain”, then click “Next”.\nSupply Active Directory credentials with privileges “Logon To” the system on which ArcGIS for Server is deployed, then click “Next”.\nSelect “Web Tier” as the “Authentication Tier”, then click “Next” >> “Finish”.'\n  impact 0.7\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40540r642780_chk'\n  tag severity: 'high'\n  tag gid: 'V-237321'\n  tag rid: 'SV-237321r879522_rule'\n  tag stig_id: 'AGIS-00-000009'\n  tag gtitle: 'SRG-APP-000023'\n  tag fix_id: 'F-40503r642781_fix'\n  tag satisfies: ['SRG-APP-000023', 'SRG-APP-000025', 'SRG-APP-000026', 'SRG-APP-000065', 'SRG-APP-000164', 'SRG-APP-000165', 'SRG-APP-000166', 'SRG-APP-000167', 'SRG-APP-000168', 'SRG-APP-000169', 'SRG-APP-000170', 'SRG-APP-000171', 'SRG-APP-000173', 'SRG-APP-000174']\n  tag 'documentable'\n  tag legacy: ['SV-79813', 'V-65323']\n  tag cci: ['CCI-000015', 'CCI-000017', 'CCI-000018', 'CCI-000044', 'CCI-000192', 'CCI-000193', 'CCI-000194', 'CCI-000195', 'CCI-000196', 'CCI-000198', 'CCI-000199', 'CCI-000200', 'CCI-000205', 'CCI-001619']\n  tag nist: ['AC-2 (1)', 'AC-2 (3) (d)', 'AC-2 (4)', 'AC-7 a', 'IA-5 (1) (a)', 'IA-5 (1) (a)', 'IA-5 (1) (a)', 'IA-5 (1) (b)', 'IA-5 (1) (c)', 'IA-5 (1) (d)', 'IA-5 (1) (d)', 'IA-5 (1) (e)', 'IA-5 (1) (a)', 'IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237321.rb"},"title":"The ArcGIS Server must use Windows authentication for supporting account management functions.","desc":"Enterprise environments make application account management challenging and complex. A manual process for account management functions adds the risk of a potential oversight or other error. \n\nA comprehensive application account management process that includes automation helps to ensure accounts designated as requiring attention are consistently and promptly addressed. Examples include, but are not limited to, using automation to take action on multiple accounts designated as inactive, suspended or terminated or by disabling accounts located in non-centralized account stores such as multiple servers. This requirement applies to all account types, including individual/user, shared, group, system, guest/anonymous, emergency, developer/manufacturer/vendor, temporary, and service.\n\nThe application must be configured to automatically provide account management functions and these functions must immediately enforce the organization's current account policy. The automated mechanisms may reside within the application itself or may be offered by the operating system or other infrastructure providing automated account management capabilities. Automated mechanisms may be comprised of differing technologies that when placed together contain an overall automated mechanism supporting an organization's automated account management requirements. \n\nAccount management functions include: assignment of group or role membership; identifying account type; specifying user access authorizations (i.e., privileges); account removal, update, or termination; and administrative alerts. The use of automated mechanisms can include, for example: using email or text messaging to automatically notify account managers when users are terminated or transferred; using the information system to monitor account usage; and using automated telephonic notification to report atypical system account usage.\n\n","descriptions":{"default":"Enterprise environments make application account management challenging and complex. A manual process for account management functions adds the risk of a potential oversight or other error. \n\nA comprehensive application account management process that includes automation helps to ensure accounts designated as requiring attention are consistently and promptly addressed. Examples include, but are not limited to, using automation to take action on multiple accounts designated as inactive, suspended or terminated or by disabling accounts located in non-centralized account stores such as multiple servers. This requirement applies to all account types, including individual/user, shared, group, system, guest/anonymous, emergency, developer/manufacturer/vendor, temporary, and service.\n\nThe application must be configured to automatically provide account management functions and these functions must immediately enforce the organization's current account policy. The automated mechanisms may reside within the application itself or may be offered by the operating system or other infrastructure providing automated account management capabilities. Automated mechanisms may be comprised of differing technologies that when placed together contain an overall automated mechanism supporting an organization's automated account management requirements. \n\nAccount management functions include: assignment of group or role membership; identifying account type; specifying user access authorizations (i.e., privileges); account removal, update, or termination; and administrative alerts. The use of automated mechanisms can include, for example: using email or text messaging to automatically notify account managers when users are terminated or transferred; using the information system to monitor account usage; and using automated telephonic notification to report atypical system account usage.\n\n","check":"Review the ArcGIS for Server configuration to ensure mechanisms for supporting account management functions are provided. Substitute the target environment’s values for [bracketed] variables.\n\nVerify ArcGIS for Server is utilizing Windows Users & Roles as its security store.\n\nNavigate to [https://server.domain.com/arcgis]/admin/security/config (logon when prompted.)\nVerify the “User Store Configuration” value = “Type: Windows”.\nIf the “User Store Configuration” value is set to “Type: Built-In”, this is a finding.\n\nVerify the “Role Store Configuration” value = “Type: Windows”.\nIf the “Role store Configuration” value is set to “Type: Built-In”, this is a finding.\n\nIf the \"Type\" parameter of the \"User Store Configuration\" or \"Role Store Configuration\" is set to \"Built-In\", this is a finding.\n\nThis test requires the account performing the check to have \"Administrator\" privilege to the ArcGIS for Server site. This check can be performed remotely via HTTPS. This configuration is only valid when ArcGIS for Server has been deployed onto a Windows 2008 or later operating system that is a member of an Active Directory domain.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.","fix":"Configure ArcGIS for Server to provide mechanisms for supporting account management functions. Substitute the target environment’s values for [bracketed] variables.\n\nConfigure ArcGIS for Server to utilize a Windows Domain for User and Role Management. Note: This procedure will disrupt existing systems connected to ArcGIS for Server:\n\nIdentify a system that will serve as the service endpoint for the ArcGIS for Server environment. This must be an Active Directory joined Windows 2008 R2 system with IIS 7.5 or later installed. If a Web Application Firewall (WAF), and/or Load Balancer serves as the user-connection endpoint, this system must be deployed on a trusted network behind these front-end technologies.\n\nOn this system (locally), perform the following steps:\nInstall the “ArcGIS Web Adaptor”.\nConfigure the “ArcGIS Web Adaptor” such that “Administration” is enabled via the Web Adaptor.\n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\"\n\nConfigure ArcGIS for Server to utilize Windows Users and Roles:\n\nNavigate to ArcGIS Server Manager ([https://server.domain.com/arcgis]/manager). (logon when prompted.)\nNavigate to the “Security” tab.\nNavigate to the “Settings” sub-tab.\nEdit “Configuration Settings” by clicking on the pencil icon.\n\nSelect “Users and roles from an existing enterprise system (LDAP or Windows Domain)”, then click “Next”.\nSelect “Windows Domain”, then click “Next”.\nSupply Active Directory credentials with privileges “Logon To” the system on which ArcGIS for Server is deployed, then click “Next”.\nSelect “Web Tier” as the “Authentication Tier”, then click “Next” >> “Finish”."},"impact":0.7,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40540r642780_chk","severity":"high","gid":"V-237321","rid":"SV-237321r879522_rule","stig_id":"AGIS-00-000009","gtitle":"SRG-APP-000023","fix_id":"F-40503r642781_fix","satisfies":["SRG-APP-000023","SRG-APP-000025","SRG-APP-000026","SRG-APP-000065","SRG-APP-000164","SRG-APP-000165","SRG-APP-000166","SRG-APP-000167","SRG-APP-000168","SRG-APP-000169","SRG-APP-000170","SRG-APP-000171","SRG-APP-000173","SRG-APP-000174"],"documentable":null,"legacy":["SV-79813","V-65323"],"cci":["CCI-000015","CCI-000017","CCI-000018","CCI-000044","CCI-000192","CCI-000193","CCI-000194","CCI-000195","CCI-000196","CCI-000198","CCI-000199","CCI-000200","CCI-000205","CCI-001619"],"nist":["AC-2 (1)","AC-2 (3) (d)","AC-2 (4)","AC-7 a","IA-5 (1) (a)","IA-5 (1) (a)","IA-5 (1) (a)","IA-5 (1) (b)","IA-5 (1) (c)","IA-5 (1) (d)","IA-5 (1) (d)","IA-5 (1) (e)","IA-5 (1) (a)","IA-5 (1) (a)"]}},{"id":"SV-237322","code":"control 'SV-237322' do\n  title 'The ArcGIS Server must use Windows authentication to enforce approved authorizations for logical access to information and system resources in accordance with applicable access control policies.'\n  desc 'To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems (e.g., networks, web servers, and web portals) must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. \n\nAccess control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system. \n\nThis requirement is applicable to access control enforcement applications (e.g., authentication servers) and other applications that perform information and system access control functions.\n\n'\n  desc 'check', 'Review the ArcGIS for Server configuration to ensure that the application enforces approved authorizations for logical access to information system resources.\n\nSubstitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]/admin/security/config (logon when prompted.)\n\nVerify the \"User Store Configuration\" value = \"Type: Windows\".\nIf the \"User Store Configuration\" value is set to \"Type: Built-In\", this is a finding.\n\nVerify the \"Role Store Configuration\" value = \"Type: Windows\".\n\nIf the \"Role store Configuration\" value is set to \"Type: Built-In\", this is a finding.\n\nVerify the \"Authentication Tier\" value is set to \"WEB_ADAPTOR\".\nIf the \"Authentication Tier\" value is set to \"GIS_SERVER\", this is a finding.\n\nOpen IIS Manager on the system that hosts the ArcGIS Web Adaptor.\nSelect the \"[arcgis]\" application.\nOpen \"SSL Settings\".\nVerify the \"Client Certificates\" property is set to \"Require\".\n\nIf the \"Client Certificates\" property is not set to \"Require\", this is a finding.\n\nThis test requires the account performing the check to have \"Administrator\" privilege to the ArcGIS for Server site. This check can be performed remotely via HTTPS. This configuration is only valid when ArcGIS for Server has been deployed onto a Windows 2008 or later operating system that is a member of an Active Directory domain.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD-compliant certificate authentication solutions.'\n  desc 'fix', %q(Configure ArcGIS for Server to ensure that the application enforces approved authorizations for logical access to information system resources.  Substitute the target environment’s values for [bracketed] variables.\n\nIdentify a system that will serve as the service endpoint for the ArcGIS for Server environment. This must be an Active Directory joined Windows 2008 R2 system with IIS 7.5 or later installed. If a Web Application Firewall (WAF), and/or Load Balancer serves as the user-connection endpoint, this system must be deployed on a trusted network behind these front-end technologies. On this system (locally), perform the following steps:\n\nInstall the “ArcGIS Web Adaptor”.'\nConfigure the “ArcGIS Web Adaptor” such that “Administration” is enabled via the Web Adaptor. \n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\"\n\nConfigure ArcGIS for Server to utilize Windows Users and Roles:\n\nNavigate to ArcGIS Server Manager ([https://server.domain.com/arcgis]/manager). (logon when prompted.)\nNavigate to the “Security” tab.\nNavigate to the “Settings” sub-tab.\nEdit “Configuration Settings” by clicking on the pencil icon.\n\nSelect “Users and roles from an existing enterprise system (LDAP or Windows Domain)”, then click “Next”.\nSelect “Windows Domain”, then click “Next”.\n\nSupply Active Directory credentials with privileges “Logon To” the system on which ArcGIS for Server is deployed, then click “Next”.\n\nSelect “Web Tier” as the “Authentication Tier”, then click “Next” >> “Finish”.\n\nOn the system that hosts the ArcGIS Web Adaptor, open IIS Manager.\n\nSelect “[arcgis]” application >> SSL Settings >> Check “Require SSL” and “Require Client Certificates” >> Apply.)\n  impact 0.7\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40541r642783_chk'\n  tag severity: 'high'\n  tag gid: 'V-237322'\n  tag rid: 'SV-237322r879530_rule'\n  tag stig_id: 'AGIS-00-000016'\n  tag gtitle: 'SRG-APP-000033'\n  tag fix_id: 'F-40504r642784_fix'\n  tag satisfies: ['SRG-APP-000033', 'SRG-APP-000038', 'SRG-APP-000080', 'SRG-APP-000148', 'SRG-APP-000149', 'SRG-APP-000150', 'SRG-APP-000151', 'SRG-APP-000152', 'SRG-APP-000153', 'SRG-APP-000158', 'SRG-APP-000163', 'SRG-APP-000172', 'SRG-APP-000176', 'SRG-APP-000177', 'SRG-APP-000178', 'SRG-APP-000180', 'SRG-APP-000190', 'SRG-APP-000220']\n  tag 'documentable'\n  tag legacy: ['SV-79875', 'V-65385']\n  tag cci: ['CCI-000166', 'CCI-000186', 'CCI-000187', 'CCI-000197', 'CCI-000206', 'CCI-000213', 'CCI-000764', 'CCI-000765', 'CCI-000766', 'CCI-000767', 'CCI-000768', 'CCI-000770', 'CCI-000778', 'CCI-000795', 'CCI-000804', 'CCI-001133', 'CCI-001185', 'CCI-001368']\n  tag nist: ['AU-10', 'IA-5 (2) (a) (1)', 'IA-5 (2) (a) (2)', 'IA-5 (1) (c)', 'IA-6', 'AC-3', 'IA-2', 'IA-2 (1)', 'IA-2 (2)', 'IA-2 (3)', 'IA-2 (4)', 'IA-2 (5)', 'IA-3', 'IA-4 e', 'IA-8', 'SC-10', 'SC-23 (1)', 'AC-4']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237322.rb"},"title":"The ArcGIS Server must use Windows authentication to enforce approved authorizations for logical access to information and system resources in accordance with applicable access control policies.","desc":"To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems (e.g., networks, web servers, and web portals) must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. \n\nAccess control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system. \n\nThis requirement is applicable to access control enforcement applications (e.g., authentication servers) and other applications that perform information and system access control functions.\n\n","descriptions":{"default":"To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems (e.g., networks, web servers, and web portals) must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. \n\nAccess control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system. \n\nThis requirement is applicable to access control enforcement applications (e.g., authentication servers) and other applications that perform information and system access control functions.\n\n","check":"Review the ArcGIS for Server configuration to ensure that the application enforces approved authorizations for logical access to information system resources.\n\nSubstitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]/admin/security/config (logon when prompted.)\n\nVerify the \"User Store Configuration\" value = \"Type: Windows\".\nIf the \"User Store Configuration\" value is set to \"Type: Built-In\", this is a finding.\n\nVerify the \"Role Store Configuration\" value = \"Type: Windows\".\n\nIf the \"Role store Configuration\" value is set to \"Type: Built-In\", this is a finding.\n\nVerify the \"Authentication Tier\" value is set to \"WEB_ADAPTOR\".\nIf the \"Authentication Tier\" value is set to \"GIS_SERVER\", this is a finding.\n\nOpen IIS Manager on the system that hosts the ArcGIS Web Adaptor.\nSelect the \"[arcgis]\" application.\nOpen \"SSL Settings\".\nVerify the \"Client Certificates\" property is set to \"Require\".\n\nIf the \"Client Certificates\" property is not set to \"Require\", this is a finding.\n\nThis test requires the account performing the check to have \"Administrator\" privilege to the ArcGIS for Server site. This check can be performed remotely via HTTPS. This configuration is only valid when ArcGIS for Server has been deployed onto a Windows 2008 or later operating system that is a member of an Active Directory domain.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD-compliant certificate authentication solutions.","fix":"Configure ArcGIS for Server to ensure that the application enforces approved authorizations for logical access to information system resources.  Substitute the target environment’s values for [bracketed] variables.\n\nIdentify a system that will serve as the service endpoint for the ArcGIS for Server environment. This must be an Active Directory joined Windows 2008 R2 system with IIS 7.5 or later installed. If a Web Application Firewall (WAF), and/or Load Balancer serves as the user-connection endpoint, this system must be deployed on a trusted network behind these front-end technologies. On this system (locally), perform the following steps:\n\nInstall the “ArcGIS Web Adaptor”.'\nConfigure the “ArcGIS Web Adaptor” such that “Administration” is enabled via the Web Adaptor. \n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\"\n\nConfigure ArcGIS for Server to utilize Windows Users and Roles:\n\nNavigate to ArcGIS Server Manager ([https://server.domain.com/arcgis]/manager). (logon when prompted.)\nNavigate to the “Security” tab.\nNavigate to the “Settings” sub-tab.\nEdit “Configuration Settings” by clicking on the pencil icon.\n\nSelect “Users and roles from an existing enterprise system (LDAP or Windows Domain)”, then click “Next”.\nSelect “Windows Domain”, then click “Next”.\n\nSupply Active Directory credentials with privileges “Logon To” the system on which ArcGIS for Server is deployed, then click “Next”.\n\nSelect “Web Tier” as the “Authentication Tier”, then click “Next” >> “Finish”.\n\nOn the system that hosts the ArcGIS Web Adaptor, open IIS Manager.\n\nSelect “[arcgis]” application >> SSL Settings >> Check “Require SSL” and “Require Client Certificates” >> Apply."},"impact":0.7,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40541r642783_chk","severity":"high","gid":"V-237322","rid":"SV-237322r879530_rule","stig_id":"AGIS-00-000016","gtitle":"SRG-APP-000033","fix_id":"F-40504r642784_fix","satisfies":["SRG-APP-000033","SRG-APP-000038","SRG-APP-000080","SRG-APP-000148","SRG-APP-000149","SRG-APP-000150","SRG-APP-000151","SRG-APP-000152","SRG-APP-000153","SRG-APP-000158","SRG-APP-000163","SRG-APP-000172","SRG-APP-000176","SRG-APP-000177","SRG-APP-000178","SRG-APP-000180","SRG-APP-000190","SRG-APP-000220"],"documentable":null,"legacy":["SV-79875","V-65385"],"cci":["CCI-000166","CCI-000186","CCI-000187","CCI-000197","CCI-000206","CCI-000213","CCI-000764","CCI-000765","CCI-000766","CCI-000767","CCI-000768","CCI-000770","CCI-000778","CCI-000795","CCI-000804","CCI-001133","CCI-001185","CCI-001368"],"nist":["AU-10","IA-5 (2) (a) (1)","IA-5 (2) (a) (2)","IA-5 (1) (c)","IA-6","AC-3","IA-2","IA-2 (1)","IA-2 (2)","IA-2 (3)","IA-2 (4)","IA-2 (5)","IA-3","IA-4 e","IA-8","SC-10","SC-23 (1)","AC-4"]}},{"id":"SV-237323","code":"control 'SV-237323' do\n  title 'The ArcGIS Server must provide audit record generation capability for DoD-defined auditable events within all application components.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one. \n\nAudit records can be generated from various components within the application (e.g., process, module). Certain specific application functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the application will provide an audit record generation capability as the following: \n\n(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);\n\n(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and\n\n(iii) All account creation, modification, disabling, and termination actions.\n\n'\n  desc 'check', 'Review the ArcGIS Server configuration to ensure mechanisms for providing audit record generation capability for DoD-defined auditable events within application components are provided. Substitute the target environment’s values for [bracketed] variables. \n\nNavigate to [https://server.domain.com/arcgis]/admin/logs/settings (log on when prompted).\n\nVerify the \"Log Level\" value is set to \"VERBOSE\".\n\nIf this value is set to any value other than \"VERBOSE\", this is a finding.'\n  desc 'fix', 'Configure the ArcGIS Server to ensure mechanisms for providing audit record generation capability for DoD-defined auditable events within application components are provided. Substitute the target environment’s values for [bracketed] variables. \n\nOpen \"ArcGIS Server Manager\" ([https://server.domain.com/arcgis]/manager) (log on when prompted).\n\nNavigate to the \"Logs\" tab. Open \"Settings\". Change the \"Log Level\" value to \"VERBOSE\", then click \"Save\".'\n  impact 0.7\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40542r642786_chk'\n  tag severity: 'high'\n  tag gid: 'V-237323'\n  tag rid: 'SV-237323r879559_rule'\n  tag stig_id: 'AGIS-00-000026'\n  tag gtitle: 'SRG-APP-000089'\n  tag fix_id: 'F-40505r642787_fix'\n  tag satisfies: ['SRG-APP-000089', 'SRG-APP-000016', 'SRG-APP-000027', 'SRG-APP-000028', 'SRG-APP-000029', 'SRG-APP-000091', 'SRG-APP-000095', 'SRG-APP-000097', 'SRG-APP-000098', 'SRG-APP-000099', 'SRG-APP-000100', 'SRG-APP-000226', 'SRG-APP-000319', 'SRG-APP-000343', 'SRG-APP-000381', 'SRG-APP-000492', 'SRG-APP-000493', 'SRG-APP-000494', 'SRG-APP-000495', 'SRG-APP-000496', 'SRG-APP-000497', 'SRG-APP-000498', 'SRG-APP-000499', 'SRG-APP-000500', 'SRG-APP-000501', 'SRG-APP-000502', 'SRG-APP-000503', 'SRG-APP-000504', 'SRG-APP-000505', 'SRG-APP-000507', 'SRG-APP-000508', 'SRG-APP-000509', 'SRG-APP-000510']\n  tag 'documentable'\n  tag legacy: ['SV-79883', 'V-65393']\n  tag cci: ['CCI-000067', 'CCI-000130', 'CCI-000132', 'CCI-000133', 'CCI-000134', 'CCI-000169', 'CCI-000172', 'CCI-001403', 'CCI-001404', 'CCI-001405', 'CCI-001487', 'CCI-001665', 'CCI-001814', 'CCI-002130', 'CCI-002234']\n  tag nist: ['AC-17 (1)', 'AU-3 a', 'AU-3 c', 'AU-3 d', 'AU-3 e', 'AU-12 a', 'AU-12 c', 'AC-2 (4)', 'AC-2 (4)', 'AC-2 (4)', 'AU-3 f', 'SC-24', 'CM-5 (1)', 'AC-2 (4)', 'AC-6 (9)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237323.rb"},"title":"The ArcGIS Server must provide audit record generation capability for DoD-defined auditable events within all application components.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one. \n\nAudit records can be generated from various components within the application (e.g., process, module). Certain specific application functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the application will provide an audit record generation capability as the following: \n\n(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);\n\n(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and\n\n(iii) All account creation, modification, disabling, and termination actions.\n\n","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident, or identify those responsible for one. \n\nAudit records can be generated from various components within the application (e.g., process, module). Certain specific application functionalities may be audited as well. The list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the application will provide an audit record generation capability as the following: \n\n(i) Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels);\n\n(ii) Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system; and\n\n(iii) All account creation, modification, disabling, and termination actions.\n\n","check":"Review the ArcGIS Server configuration to ensure mechanisms for providing audit record generation capability for DoD-defined auditable events within application components are provided. Substitute the target environment’s values for [bracketed] variables. \n\nNavigate to [https://server.domain.com/arcgis]/admin/logs/settings (log on when prompted).\n\nVerify the \"Log Level\" value is set to \"VERBOSE\".\n\nIf this value is set to any value other than \"VERBOSE\", this is a finding.","fix":"Configure the ArcGIS Server to ensure mechanisms for providing audit record generation capability for DoD-defined auditable events within application components are provided. Substitute the target environment’s values for [bracketed] variables. \n\nOpen \"ArcGIS Server Manager\" ([https://server.domain.com/arcgis]/manager) (log on when prompted).\n\nNavigate to the \"Logs\" tab. Open \"Settings\". Change the \"Log Level\" value to \"VERBOSE\", then click \"Save\"."},"impact":0.7,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40542r642786_chk","severity":"high","gid":"V-237323","rid":"SV-237323r879559_rule","stig_id":"AGIS-00-000026","gtitle":"SRG-APP-000089","fix_id":"F-40505r642787_fix","satisfies":["SRG-APP-000089","SRG-APP-000016","SRG-APP-000027","SRG-APP-000028","SRG-APP-000029","SRG-APP-000091","SRG-APP-000095","SRG-APP-000097","SRG-APP-000098","SRG-APP-000099","SRG-APP-000100","SRG-APP-000226","SRG-APP-000319","SRG-APP-000343","SRG-APP-000381","SRG-APP-000492","SRG-APP-000493","SRG-APP-000494","SRG-APP-000495","SRG-APP-000496","SRG-APP-000497","SRG-APP-000498","SRG-APP-000499","SRG-APP-000500","SRG-APP-000501","SRG-APP-000502","SRG-APP-000503","SRG-APP-000504","SRG-APP-000505","SRG-APP-000507","SRG-APP-000508","SRG-APP-000509","SRG-APP-000510"],"documentable":null,"legacy":["SV-79883","V-65393"],"cci":["CCI-000067","CCI-000130","CCI-000132","CCI-000133","CCI-000134","CCI-000169","CCI-000172","CCI-001403","CCI-001404","CCI-001405","CCI-001487","CCI-001665","CCI-001814","CCI-002130","CCI-002234"],"nist":["AC-17 (1)","AU-3 a","AU-3 c","AU-3 d","AU-3 e","AU-12 a","AU-12 c","AC-2 (4)","AC-2 (4)","AC-2 (4)","AU-3 f","SC-24","CM-5 (1)","AC-2 (4)","AC-6 (9)"]}},{"id":"SV-237324","code":"control 'SV-237324' do\n  title 'The ArcGIS Server must protect audit information from any type of unauthorized read access, modification or deletion.'\n  desc 'If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.\n\nThis requirement can be achieved through multiple methods which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.\n\nAdditionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\n'\n  desc 'check', 'Review the ArcGIS Server configuration to ensure mechanisms are provided that protect audit information from any type of unauthorized read access, modification or deletion. Substitute the target environment’s values for [bracketed] variables. \n\nWithin Windows Explorer, access the \"Security\" (tab) property of the \"[C:\\\\arcgisserver]\\\\logs\" folder.\n\nVerify only the \"ArcGIS Server Account\" has full control of this folder. Verify any other accounts that have read or other rights to this folder are authorized and documented.\n\nIf unauthorized accounts have read or other rights to this folder, this is a finding.'\n  desc 'fix', 'Configure the ArcGIS Server to ensure mechanisms are provided that protect audit information from any type of unauthorized read access, modification or deletion. Substitute the target environment’s values for [bracketed] variables. \n\nWithin Windows Explorer, access the \"Security\" (tab) property of the \"[C:\\\\arcgisserver]\\\\logs\" folder. Grant the \"ArcGIS Server Account\" full control of this folder.\n\nRemove any unauthorized accounts or groups from this folder.'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40543r642789_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237324'\n  tag rid: 'SV-237324r879576_rule'\n  tag stig_id: 'AGIS-00-000044'\n  tag gtitle: 'SRG-APP-000118'\n  tag fix_id: 'F-40506r642790_fix'\n  tag satisfies: ['SRG-APP-000118', 'SRG-APP-000119', 'SRG-APP-000120']\n  tag 'documentable'\n  tag legacy: ['SV-79897', 'V-65407']\n  tag cci: ['CCI-000162', 'CCI-000163', 'CCI-000164']\n  tag nist: ['AU-9 a', 'AU-9 a', 'AU-9 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237324.rb"},"title":"The ArcGIS Server must protect audit information from any type of unauthorized read access, modification or deletion.","desc":"If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.\n\nThis requirement can be achieved through multiple methods which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.\n\nAdditionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\n","descriptions":{"default":"If audit data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity is difficult if not impossible to achieve. In addition, access to audit records provides information an attacker could potentially use to his or her advantage.\n\nTo ensure the veracity of audit data, the information system and/or the application must protect audit information from any and all unauthorized access. This includes read, write, and copy access.\n\nThis requirement can be achieved through multiple methods which will depend upon system architecture and design. Commonly employed methods for protecting audit information include least privilege permissions as well as restricting the location and number of log file repositories.\n\nAdditionally, applications with user interfaces to audit records should not allow for the unfettered manipulation of or access to those records via the application. If the application provides access to the audit data, the application becomes accountable for ensuring audit information is protected from unauthorized access.\n\nAudit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\n","check":"Review the ArcGIS Server configuration to ensure mechanisms are provided that protect audit information from any type of unauthorized read access, modification or deletion. Substitute the target environment’s values for [bracketed] variables. \n\nWithin Windows Explorer, access the \"Security\" (tab) property of the \"[C:\\arcgisserver]\\logs\" folder.\n\nVerify only the \"ArcGIS Server Account\" has full control of this folder. Verify any other accounts that have read or other rights to this folder are authorized and documented.\n\nIf unauthorized accounts have read or other rights to this folder, this is a finding.","fix":"Configure the ArcGIS Server to ensure mechanisms are provided that protect audit information from any type of unauthorized read access, modification or deletion. Substitute the target environment’s values for [bracketed] variables. \n\nWithin Windows Explorer, access the \"Security\" (tab) property of the \"[C:\\arcgisserver]\\logs\" folder. Grant the \"ArcGIS Server Account\" full control of this folder.\n\nRemove any unauthorized accounts or groups from this folder."},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40543r642789_chk","severity":"medium","gid":"V-237324","rid":"SV-237324r879576_rule","stig_id":"AGIS-00-000044","gtitle":"SRG-APP-000118","fix_id":"F-40506r642790_fix","satisfies":["SRG-APP-000118","SRG-APP-000119","SRG-APP-000120"],"documentable":null,"legacy":["SV-79897","V-65407"],"cci":["CCI-000162","CCI-000163","CCI-000164"],"nist":["AU-9 a","AU-9 a","AU-9 a"]}},{"id":"SV-237325","code":"control 'SV-237325' do\n  title 'The ArcGIS Server must be configured to disable non-essential capabilities.'\n  desc 'It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions). \n\nExamples of non-essential capabilities include, but are not limited to, advertising software or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, but cannot be disabled.'\n  desc 'check', 'Review the ArcGIS Server configuration to ensure that non-essential capabilities are disabled. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]admin/system/handlers/rest/servicesdirectory (log on when prompted).\n\nVerify that the \"Services Directory\" property is set to \"Disabled\".\n\nIf the \"Services Directory\" property is set to \"Enabled\", this is a finding.'\n  desc 'fix', 'Configure the ArcGIS Server to ensure non-essential capabilities are disabled. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]admin/system/handlers/rest/servicesdirectory (log on when prompted).\n\nUncheck the value for \"Services Directory Enabled\". Click \"Save\".'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40544r642792_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237325'\n  tag rid: 'SV-237325r879587_rule'\n  tag stig_id: 'AGIS-00-000054'\n  tag gtitle: 'SRG-APP-000141'\n  tag fix_id: 'F-40507r642793_fix'\n  tag 'documentable'\n  tag legacy: ['SV-79903', 'V-65413']\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237325.rb"},"title":"The ArcGIS Server must be configured to disable non-essential capabilities.","desc":"It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions). \n\nExamples of non-essential capabilities include, but are not limited to, advertising software or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, but cannot be disabled.","descriptions":{"default":"It is detrimental for applications to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions). \n\nExamples of non-essential capabilities include, but are not limited to, advertising software or browser plug-ins not related to requirements or providing a wide array of functionality not required for every mission, but cannot be disabled.","check":"Review the ArcGIS Server configuration to ensure that non-essential capabilities are disabled. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]admin/system/handlers/rest/servicesdirectory (log on when prompted).\n\nVerify that the \"Services Directory\" property is set to \"Disabled\".\n\nIf the \"Services Directory\" property is set to \"Enabled\", this is a finding.","fix":"Configure the ArcGIS Server to ensure non-essential capabilities are disabled. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]admin/system/handlers/rest/servicesdirectory (log on when prompted).\n\nUncheck the value for \"Services Directory Enabled\". Click \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40544r642792_chk","severity":"medium","gid":"V-237325","rid":"SV-237325r879587_rule","stig_id":"AGIS-00-000054","gtitle":"SRG-APP-000141","fix_id":"F-40507r642793_fix","documentable":null,"legacy":["SV-79903","V-65413"],"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-237326","code":"control 'SV-237326' do\n  title 'The ArcGIS Server must be configured to prohibit or restrict the use of organization-defined functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.'\n  desc 'In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services; however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.'\n  desc 'check', 'Review the ArcGIS Server configuration to ensure the application prohibits or restricts the use of PPSM CAL defined ports, protocols, and/or services. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]admin/security/config (log on when prompted).\n\nVerify the \"Protocol\" parameter is not set to \"HTTP Only\".\n\nIf the \"Protocol\" parameter is set to \"HTTP Only\", this is a finding.'\n  desc 'fix', 'Configure the ArcGIS Server to ensure the application prohibits or restricts the use of PPSM CAL defined ports, protocols, and/or services. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]admin/security/config (log on when prompted).\n \nBrowse to Update. Update the Protocol parameter to \"HTTPS Only\".\n\nClick \"Save\"/\"Apply\".'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40545r642795_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237326'\n  tag rid: 'SV-237326r879588_rule'\n  tag stig_id: 'AGIS-00-000055'\n  tag gtitle: 'SRG-APP-000142'\n  tag fix_id: 'F-40508r642796_fix'\n  tag 'documentable'\n  tag legacy: ['SV-79905', 'V-65415']\n  tag cci: ['CCI-000382']\n  tag nist: ['CM-7 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237326.rb"},"title":"The ArcGIS Server must be configured to prohibit or restrict the use of organization-defined functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.","desc":"In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services; however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.","descriptions":{"default":"In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services; however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.","check":"Review the ArcGIS Server configuration to ensure the application prohibits or restricts the use of PPSM CAL defined ports, protocols, and/or services. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]admin/security/config (log on when prompted).\n\nVerify the \"Protocol\" parameter is not set to \"HTTP Only\".\n\nIf the \"Protocol\" parameter is set to \"HTTP Only\", this is a finding.","fix":"Configure the ArcGIS Server to ensure the application prohibits or restricts the use of PPSM CAL defined ports, protocols, and/or services. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]admin/security/config (log on when prompted).\n \nBrowse to Update. Update the Protocol parameter to \"HTTPS Only\".\n\nClick \"Save\"/\"Apply\"."},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40545r642795_chk","severity":"medium","gid":"V-237326","rid":"SV-237326r879588_rule","stig_id":"AGIS-00-000055","gtitle":"SRG-APP-000142","fix_id":"F-40508r642796_fix","documentable":null,"legacy":["SV-79905","V-65415"],"cci":["CCI-000382"],"nist":["CM-7 b"]}},{"id":"SV-237327","code":"control 'SV-237327' do\n  title 'The ArcGIS Server must implement replay-resistant authentication mechanisms for network access to privileged accounts and non-privileged accounts.'\n  desc 'A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. \n\nA privileged account is any information system account with authorizations of a privileged user.\n\nA non-privileged account is any operating system account with authorizations of a non-privileged user.\n\n'\n  desc 'check', 'Review the ArcGIS for Server configuration to ensure that the application implements replay-resistant authentication mechanisms for network access to privileged accounts. Substitute the target environment’s values for [bracketed] variables.\n\nWithin IIS >> within the [“arcgis”] application >> Authentication >> Verify that “Windows Authentication” is “Enabled”.\nVerify that “Anonymous Authentication” is “Disabled”.\nIf “Windows Authentication” is not enabled, or “Anonymous Authentication” is enabled, this is a finding.\n\nWithin IIS >> within the [“arcgis”] application >> Authentication >> Select “Windows Authentication” >> “Providers”.\nVerify “Negotiate” or “Negotate:Kerberos” are at the top of the list, with NTLM at the bottom of the list.\nIf “NTLM” is at the top of the “Providers” list, this is a finding.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.'\n  desc 'fix', 'Configure ArcGIS for Server to utilize replay-resistant authentication mechanisms for network access to privileged accounts. Substitute the target environment’s values for [bracketed] variables.\n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\"'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40546r642798_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237327'\n  tag rid: 'SV-237327r879597_rule'\n  tag stig_id: 'AGIS-00-000062'\n  tag gtitle: 'SRG-APP-000156'\n  tag fix_id: 'F-40509r642799_fix'\n  tag satisfies: ['SRG-APP-000156', 'SRG-APP-000157', 'SRG-APP-000295']\n  tag 'documentable'\n  tag legacy: ['SV-79919', 'V-65429']\n  tag cci: ['CCI-001941', 'CCI-001942', 'CCI-002361']\n  tag nist: ['IA-2 (8)', 'IA-2 (9)', 'AC-12']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237327.rb"},"title":"The ArcGIS Server must implement replay-resistant authentication mechanisms for network access to privileged accounts and non-privileged accounts.","desc":"A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. \n\nA privileged account is any information system account with authorizations of a privileged user.\n\nA non-privileged account is any operating system account with authorizations of a non-privileged user.\n\n","descriptions":{"default":"A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. \n\nA privileged account is any information system account with authorizations of a privileged user.\n\nA non-privileged account is any operating system account with authorizations of a non-privileged user.\n\n","check":"Review the ArcGIS for Server configuration to ensure that the application implements replay-resistant authentication mechanisms for network access to privileged accounts. Substitute the target environment’s values for [bracketed] variables.\n\nWithin IIS >> within the [“arcgis”] application >> Authentication >> Verify that “Windows Authentication” is “Enabled”.\nVerify that “Anonymous Authentication” is “Disabled”.\nIf “Windows Authentication” is not enabled, or “Anonymous Authentication” is enabled, this is a finding.\n\nWithin IIS >> within the [“arcgis”] application >> Authentication >> Select “Windows Authentication” >> “Providers”.\nVerify “Negotiate” or “Negotate:Kerberos” are at the top of the list, with NTLM at the bottom of the list.\nIf “NTLM” is at the top of the “Providers” list, this is a finding.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.","fix":"Configure ArcGIS for Server to utilize replay-resistant authentication mechanisms for network access to privileged accounts. Substitute the target environment’s values for [bracketed] variables.\n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\""},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40546r642798_chk","severity":"medium","gid":"V-237327","rid":"SV-237327r879597_rule","stig_id":"AGIS-00-000062","gtitle":"SRG-APP-000156","fix_id":"F-40509r642799_fix","satisfies":["SRG-APP-000156","SRG-APP-000157","SRG-APP-000295"],"documentable":null,"legacy":["SV-79919","V-65429"],"cci":["CCI-001941","CCI-001942","CCI-002361"],"nist":["IA-2 (8)","IA-2 (9)","AC-12"]}},{"id":"SV-237328","code":"control 'SV-237328' do\n  title 'The ArcGIS Server, when using PKI-based authentication, must validate certificates by constructing a certification path (which includes status information) to an accepted trust anchor.'\n  desc 'Without path validation, an informed trust decision by the relying party cannot be made when presented with any certificate not already explicitly trusted.\n\nA trust anchor is an authoritative entity represented via a public key and associated data. It is used in the context of public key infrastructures, X.509 digital certificates, and DNSSEC. \n\nWhen there is a chain of trust, usually the top entity to be trusted becomes the trust anchor; it can be, for example, a Certification Authority (CA). A certification path starts with the subject certificate and proceeds through a number of intermediate certificates up to a trusted root certificate, typically issued by a trusted CA. \n\nThis requirement verifies that a certification path to an accepted trust anchor is used to for certificate validation and that the path includes status information. Path validation is necessary for a relying party to make an informed trust decision when presented with any certificate not already explicitly trusted. Status information for certification paths includes certificate revocation lists or online certificate status protocol responses. Validation of the certificate status information is out of scope for this requirement.'\n  desc 'check', %q(Review the ArcGIS Server configuration to ensure PKI-based authenticated endpoints validate certificates by constructing a certification path. Substitute the target environment’s values for [bracketed] variables. \n\n1. On each GIS Server in the ArcGIS Server Site, left-shift + right-click on Internet Explorer >> Run as a different user >> log on using the \"[ArcGIS Server]\" account.\n\nWithin Internet Explorer, click Tools >> Internet Options.\n\nOpen the \"Advanced\" tab. Within the \"Security\" section, verify \"Check for publisher's certificate revocation\" is checked.\n\nIf \"Check for publisher's certificate revocation\" is not checked, this is a finding.\n\n2. Within the \"Security\" section, verify \"Check for server certificate revocation\" is checked.\n\nIf \"Check for server certificate revocation\" is not checked, this is a finding.\n\nAccess to the \"[ArcGIS Server]\" account is required to perform this check.)\n  desc 'fix', %q(Configure the ArcGIS Server to ensure PKI-based authenticated endpoints validate certificates by constructing a certification path. Substitute the target environment’s values for [bracketed] variables. \n\nOn each GIS Server in the ArcGIS Server Site, left-shift + right-click on Internet Explorer >> Run as a different user >> log on using the \"[ArcGIS Server]\" account.\n\nWithin Internet Explorer, click Tools >> Internet Options.\n\nOpen the \"Advanced\" tab. Within the \"Security\" section, check \"Check for publisher's certificate revocation\".\n\nWithin the \"Security\" section, check \"Check for server certificate revocation\".\n\nRestart the server.\n\nAccess to the \"[ArcGIS Server]\" account is required to make this change.)\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40547r642801_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237328'\n  tag rid: 'SV-237328r879612_rule'\n  tag stig_id: 'AGIS-00-000077'\n  tag gtitle: 'SRG-APP-000175'\n  tag fix_id: 'F-40510r642802_fix'\n  tag 'documentable'\n  tag legacy: ['SV-79949', 'V-65459']\n  tag cci: ['CCI-000185']\n  tag nist: ['IA-5 (2) (b) (1)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237328.rb"},"title":"The ArcGIS Server, when using PKI-based authentication, must validate certificates by constructing a certification path (which includes status information) to an accepted trust anchor.","desc":"Without path validation, an informed trust decision by the relying party cannot be made when presented with any certificate not already explicitly trusted.\n\nA trust anchor is an authoritative entity represented via a public key and associated data. It is used in the context of public key infrastructures, X.509 digital certificates, and DNSSEC. \n\nWhen there is a chain of trust, usually the top entity to be trusted becomes the trust anchor; it can be, for example, a Certification Authority (CA). A certification path starts with the subject certificate and proceeds through a number of intermediate certificates up to a trusted root certificate, typically issued by a trusted CA. \n\nThis requirement verifies that a certification path to an accepted trust anchor is used to for certificate validation and that the path includes status information. Path validation is necessary for a relying party to make an informed trust decision when presented with any certificate not already explicitly trusted. Status information for certification paths includes certificate revocation lists or online certificate status protocol responses. Validation of the certificate status information is out of scope for this requirement.","descriptions":{"default":"Without path validation, an informed trust decision by the relying party cannot be made when presented with any certificate not already explicitly trusted.\n\nA trust anchor is an authoritative entity represented via a public key and associated data. It is used in the context of public key infrastructures, X.509 digital certificates, and DNSSEC. \n\nWhen there is a chain of trust, usually the top entity to be trusted becomes the trust anchor; it can be, for example, a Certification Authority (CA). A certification path starts with the subject certificate and proceeds through a number of intermediate certificates up to a trusted root certificate, typically issued by a trusted CA. \n\nThis requirement verifies that a certification path to an accepted trust anchor is used to for certificate validation and that the path includes status information. Path validation is necessary for a relying party to make an informed trust decision when presented with any certificate not already explicitly trusted. Status information for certification paths includes certificate revocation lists or online certificate status protocol responses. Validation of the certificate status information is out of scope for this requirement.","check":"Review the ArcGIS Server configuration to ensure PKI-based authenticated endpoints validate certificates by constructing a certification path. Substitute the target environment’s values for [bracketed] variables. \n\n1. On each GIS Server in the ArcGIS Server Site, left-shift + right-click on Internet Explorer >> Run as a different user >> log on using the \"[ArcGIS Server]\" account.\n\nWithin Internet Explorer, click Tools >> Internet Options.\n\nOpen the \"Advanced\" tab. Within the \"Security\" section, verify \"Check for publisher's certificate revocation\" is checked.\n\nIf \"Check for publisher's certificate revocation\" is not checked, this is a finding.\n\n2. Within the \"Security\" section, verify \"Check for server certificate revocation\" is checked.\n\nIf \"Check for server certificate revocation\" is not checked, this is a finding.\n\nAccess to the \"[ArcGIS Server]\" account is required to perform this check.","fix":"Configure the ArcGIS Server to ensure PKI-based authenticated endpoints validate certificates by constructing a certification path. Substitute the target environment’s values for [bracketed] variables. \n\nOn each GIS Server in the ArcGIS Server Site, left-shift + right-click on Internet Explorer >> Run as a different user >> log on using the \"[ArcGIS Server]\" account.\n\nWithin Internet Explorer, click Tools >> Internet Options.\n\nOpen the \"Advanced\" tab. Within the \"Security\" section, check \"Check for publisher's certificate revocation\".\n\nWithin the \"Security\" section, check \"Check for server certificate revocation\".\n\nRestart the server.\n\nAccess to the \"[ArcGIS Server]\" account is required to make this change."},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40547r642801_chk","severity":"medium","gid":"V-237328","rid":"SV-237328r879612_rule","stig_id":"AGIS-00-000077","gtitle":"SRG-APP-000175","fix_id":"F-40510r642802_fix","documentable":null,"legacy":["SV-79949","V-65459"],"cci":["CCI-000185"],"nist":["IA-5 (2) (b) (1)"]}},{"id":"SV-237329","code":"control 'SV-237329' do\n  title 'The ArcGIS Server must use mechanisms meeting the requirements of applicable federal laws, Executive orders, directives, policies, regulations, standards, and guidance for authentication to a cryptographic module.'\n  desc 'Unapproved mechanisms that are used for authentication to the cryptographic module are not verified, and therefore cannot be relied upon to provide confidentiality or integrity and DoD data may be compromised.\n\nApplications utilizing encryption are required to use FIPS compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements.\n\nEncryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection thereby providing a degree of confidentiality. \n\nAuthenticity protection provides protection against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\n'\n  desc 'check', 'Review the ArcGIS for Server configuration to ensure the application uses mechanisms that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for authentication to a cryptographic module. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]admin/system/handlers/rest/servicesdirectory (logon when prompted.)\nBrowse to “machines” >> [machine name] >> Click “edit”.\nVerify that the name of the SSL certificate listed in the box for “Web server SSL Certificate” is not set to “SelfSignedCertificate”.\n\nIf the name of the SSL certificate listed in the box for “Web server SSL Certificate” is set to “SelfSignedCertificate”, this is a finding.\n\nBrowse to “security” >> “config”.\nVerify “Protocol” parameter is not set to “HTTP Only”.\nIf the “Protocol” parameter is set to “HTTP Only”, this is a finding.\n\nOn the local system where the GIS Server is installed, open the “[C:\\\\Program Files\\\\]ArcGIS\\\\Server\\\\framework\\\\runtime\\\\tomcat\\\\conf\\\\server.xml” file.\nSearch for the parameter “ciphers=”.\n\nVerify the property of the “ciphers=” parameter is set DoD-approved cipher suite value(s). A list of all possible values is located here: http://www.openssl.org/docs/apps/ciphers.html#CIPHER_SUITE_NAMES. An example of a valid configuration is provided below:\n\n<Connector SSLEnabled=\"true\" clientAuth=\"false\" keyAlias=[\"MyValidCertificate\"] keystoreFile=[\"C:\\\\arcgisserver\\\\config-store\\\\machines\\\\SERVER.DOMAIN.COM\\\\arcgis.keystore\"] keystorePass=\"password\" maxThreads=\"150\" port=\"6443\" protocol=\"org.apache.coyote.http11.Http11Protocol\" scheme=\"https\" secure=\"true\" sslProtocol=\"TLS\" ciphers=\"TLS_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA\"/>\n\nIf the “ciphers” parameter is not found, this is a finding.\nIf the “ciphers” parameter contains any non-DoD-approved ciphers, this is a finding.\n\nOn each GIS Server system and on each Web Adaptor system, Run the command “rsop” as Administrator on the Windows Command line.\nWithin the “Resultant Set of Policy” results, verify “Computer Configuration” >> “Windows Settings” >> “Security Settings” >> “Local Policies” >> “Security Options” >> “System cryptography: Use FIPS 140 compliant cryptographic algorithms, including encryption, hashing and signing algorithms” is set to “Enabled”.\nIf “System cryptography: Use FIPS 140 compliant cryptographic algorithms, including encryption, hashing and signing algorithms” not set to “Enabled”, this is a finding.\n\nThis control is not applicable for ArcGIS Servers which are deployed as part of a solution which ensures user web service traffic flows through third-party DoD compliant transport encryption devices (such as a load balancer that supports TLS encryption using DoD-approved certificates.)'\n  desc 'fix', 'Configure the ArcGIS Server to use DoD-approved encryption certificates. Substitute the target environment’s values for [bracketed] variables. \n\nUsing the Primary Site Administrator account, log on to the ArcGIS Server Administrator Directory at https://[server.domain.com]:6443/arcgis/admin. \n\nNavigate to machines >> [machine name] >> sslcertificates. Click \"importRootOrIntermediate\", then import a DoD-approved/provided root certificate file.\n\nClick \"importRootOrIntermediate\", then import a DoD-approved/provided intermediate certificate file (if applicable.)\n\nClick \"importExistingServerCertificate\", then import the SSL server certificate (public key) and private key pair.\n\nIn the \"Certificate password\" field, enter the password to unlock the file containing the SSL certificate.\n\nIn the \"Alias\" field, enter a unique name that easily identifies the certificate.\n\nClick \"Browse\" to choose the .p12 or .pfx file that contains the SSL certificate and its private key.\n\nClick \"Import\" to import the SSL certificate.\n\nBrowse to machines >> [machine name]. Click \"edit\".\n\nEnter the alias of the SSL certificate (public/private key pair) that was chosen above in the box for \"Web server SSL Certificate\". Click \"Save Edits\" to apply the change.\n\nBrowse to security >> config >> update. Update the Protocol parameter to \"HTTPS Only\".\n\nOn the ArcGIS Server, open the \"[C:\\\\Program Files\\\\]ArcGIS\\\\Server\\\\framework\\\\runtime\\\\tomcat\\\\conf\\\\server.xml\" file.\n\nSearch the string <Connector SSLEnabled=\"true\".\n\nWithin the \"Connector\" tag, add the following parameters (substitute DoD-approved ciphers for [bracketed] variables):\n\nsslProtocol=\"TLS\" ciphers=\"[DoD-approved cipher], [DoD-approved cipher], [DoD-approved cipher...]\"\n\nA list of all possible cipher values is located here: http://www.openssl.org/docs/apps/ciphers.html#CIPHER_SUITE_NAMES \n\nAn example of a valid configuration is provided below:\n\n<Connector SSLEnabled=\"true\" \nclientAuth=\"false\" \nkeyAlias=\"MyValidCertificate\" keystoreFile=\"C:\\\\arcgisserver\\\\config-store\\\\machines\\\\SERVER.DOMAIN.COM\\\\arcgis.keystore\" keystorePass=\"password\" \nmaxThreads=\"150\" port=\"6443\" protocol=\"org.apache.coyote.http11.Http11Protocol\" scheme=\"https\" \nsecure=\"true\" \nsslProtocol=\"TLS\" ciphers=\"TLS_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA\"/>\n\nFor each GIS Server system and each Web Adaptor system, apply the Local Policy or Group Policy:\n\nComputer Configuration >> Windows Settings >> Security Settings >> Local Policies >> Security Options >> \"System cryptography: Use FIPS 140 compliant cryptographic algorithms, including encryption, hashing and signing algorithms\" is set to \"Enabled\".'\n  impact 0.7\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40548r642804_chk'\n  tag severity: 'high'\n  tag gid: 'V-237329'\n  tag rid: 'SV-237329r879616_rule'\n  tag stig_id: 'AGIS-00-000081'\n  tag gtitle: 'SRG-APP-000179'\n  tag fix_id: 'F-40511r642805_fix'\n  tag satisfies: ['SRG-APP-000179', 'SRG-APP-000014', 'SRG-APP-000219', 'SRG-APP-000224']\n  tag 'documentable'\n  tag legacy: ['SV-79957', 'V-65467']\n  tag cci: ['CCI-000068', 'CCI-000803', 'CCI-001184', 'CCI-001188']\n  tag nist: ['AC-17 (2)', 'IA-7', 'SC-23', 'SC-23 (3)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237329.rb"},"title":"The ArcGIS Server must use mechanisms meeting the requirements of applicable federal laws, Executive orders, directives, policies, regulations, standards, and guidance for authentication to a cryptographic module.","desc":"Unapproved mechanisms that are used for authentication to the cryptographic module are not verified, and therefore cannot be relied upon to provide confidentiality or integrity and DoD data may be compromised.\n\nApplications utilizing encryption are required to use FIPS compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements.\n\nEncryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection thereby providing a degree of confidentiality. \n\nAuthenticity protection provides protection against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\n","descriptions":{"default":"Unapproved mechanisms that are used for authentication to the cryptographic module are not verified, and therefore cannot be relied upon to provide confidentiality or integrity and DoD data may be compromised.\n\nApplications utilizing encryption are required to use FIPS compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements.\n\nEncryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection thereby providing a degree of confidentiality. \n\nAuthenticity protection provides protection against man-in-the-middle attacks/session hijacking and the insertion of false information into sessions.\n\n","check":"Review the ArcGIS for Server configuration to ensure the application uses mechanisms that meet the requirements of applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for authentication to a cryptographic module. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]admin/system/handlers/rest/servicesdirectory (logon when prompted.)\nBrowse to “machines” >> [machine name] >> Click “edit”.\nVerify that the name of the SSL certificate listed in the box for “Web server SSL Certificate” is not set to “SelfSignedCertificate”.\n\nIf the name of the SSL certificate listed in the box for “Web server SSL Certificate” is set to “SelfSignedCertificate”, this is a finding.\n\nBrowse to “security” >> “config”.\nVerify “Protocol” parameter is not set to “HTTP Only”.\nIf the “Protocol” parameter is set to “HTTP Only”, this is a finding.\n\nOn the local system where the GIS Server is installed, open the “[C:\\Program Files\\]ArcGIS\\Server\\framework\\runtime\\tomcat\\conf\\server.xml” file.\nSearch for the parameter “ciphers=”.\n\nVerify the property of the “ciphers=” parameter is set DoD-approved cipher suite value(s). A list of all possible values is located here: http://www.openssl.org/docs/apps/ciphers.html#CIPHER_SUITE_NAMES. An example of a valid configuration is provided below:\n\n<Connector SSLEnabled=\"true\" clientAuth=\"false\" keyAlias=[\"MyValidCertificate\"] keystoreFile=[\"C:\\arcgisserver\\config-store\\machines\\SERVER.DOMAIN.COM\\arcgis.keystore\"] keystorePass=\"password\" maxThreads=\"150\" port=\"6443\" protocol=\"org.apache.coyote.http11.Http11Protocol\" scheme=\"https\" secure=\"true\" sslProtocol=\"TLS\" ciphers=\"TLS_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA\"/>\n\nIf the “ciphers” parameter is not found, this is a finding.\nIf the “ciphers” parameter contains any non-DoD-approved ciphers, this is a finding.\n\nOn each GIS Server system and on each Web Adaptor system, Run the command “rsop” as Administrator on the Windows Command line.\nWithin the “Resultant Set of Policy” results, verify “Computer Configuration” >> “Windows Settings” >> “Security Settings” >> “Local Policies” >> “Security Options” >> “System cryptography: Use FIPS 140 compliant cryptographic algorithms, including encryption, hashing and signing algorithms” is set to “Enabled”.\nIf “System cryptography: Use FIPS 140 compliant cryptographic algorithms, including encryption, hashing and signing algorithms” not set to “Enabled”, this is a finding.\n\nThis control is not applicable for ArcGIS Servers which are deployed as part of a solution which ensures user web service traffic flows through third-party DoD compliant transport encryption devices (such as a load balancer that supports TLS encryption using DoD-approved certificates.)","fix":"Configure the ArcGIS Server to use DoD-approved encryption certificates. Substitute the target environment’s values for [bracketed] variables. \n\nUsing the Primary Site Administrator account, log on to the ArcGIS Server Administrator Directory at https://[server.domain.com]:6443/arcgis/admin. \n\nNavigate to machines >> [machine name] >> sslcertificates. Click \"importRootOrIntermediate\", then import a DoD-approved/provided root certificate file.\n\nClick \"importRootOrIntermediate\", then import a DoD-approved/provided intermediate certificate file (if applicable.)\n\nClick \"importExistingServerCertificate\", then import the SSL server certificate (public key) and private key pair.\n\nIn the \"Certificate password\" field, enter the password to unlock the file containing the SSL certificate.\n\nIn the \"Alias\" field, enter a unique name that easily identifies the certificate.\n\nClick \"Browse\" to choose the .p12 or .pfx file that contains the SSL certificate and its private key.\n\nClick \"Import\" to import the SSL certificate.\n\nBrowse to machines >> [machine name]. Click \"edit\".\n\nEnter the alias of the SSL certificate (public/private key pair) that was chosen above in the box for \"Web server SSL Certificate\". Click \"Save Edits\" to apply the change.\n\nBrowse to security >> config >> update. Update the Protocol parameter to \"HTTPS Only\".\n\nOn the ArcGIS Server, open the \"[C:\\Program Files\\]ArcGIS\\Server\\framework\\runtime\\tomcat\\conf\\server.xml\" file.\n\nSearch the string <Connector SSLEnabled=\"true\".\n\nWithin the \"Connector\" tag, add the following parameters (substitute DoD-approved ciphers for [bracketed] variables):\n\nsslProtocol=\"TLS\" ciphers=\"[DoD-approved cipher], [DoD-approved cipher], [DoD-approved cipher...]\"\n\nA list of all possible cipher values is located here: http://www.openssl.org/docs/apps/ciphers.html#CIPHER_SUITE_NAMES \n\nAn example of a valid configuration is provided below:\n\n<Connector SSLEnabled=\"true\" \nclientAuth=\"false\" \nkeyAlias=\"MyValidCertificate\" keystoreFile=\"C:\\arcgisserver\\config-store\\machines\\SERVER.DOMAIN.COM\\arcgis.keystore\" keystorePass=\"password\" \nmaxThreads=\"150\" port=\"6443\" protocol=\"org.apache.coyote.http11.Http11Protocol\" scheme=\"https\" \nsecure=\"true\" \nsslProtocol=\"TLS\" ciphers=\"TLS_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA\"/>\n\nFor each GIS Server system and each Web Adaptor system, apply the Local Policy or Group Policy:\n\nComputer Configuration >> Windows Settings >> Security Settings >> Local Policies >> Security Options >> \"System cryptography: Use FIPS 140 compliant cryptographic algorithms, including encryption, hashing and signing algorithms\" is set to \"Enabled\"."},"impact":0.7,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40548r642804_chk","severity":"high","gid":"V-237329","rid":"SV-237329r879616_rule","stig_id":"AGIS-00-000081","gtitle":"SRG-APP-000179","fix_id":"F-40511r642805_fix","satisfies":["SRG-APP-000179","SRG-APP-000014","SRG-APP-000219","SRG-APP-000224"],"documentable":null,"legacy":["SV-79957","V-65467"],"cci":["CCI-000068","CCI-000803","CCI-001184","CCI-001188"],"nist":["AC-17 (2)","IA-7","SC-23","SC-23 (3)"]}},{"id":"SV-237330","code":"control 'SV-237330' do\n  title 'The ArcGIS Server must recognize only system-generated session identifiers.'\n  desc 'Applications utilize sessions and session identifiers to control application behavior and user access. If an attacker can guess the session identifier, or can inject or manually insert session information, the session may be compromised.\n\nUnique session IDs address man-in-the-middle attacks, including session hijacking or insertion of false information into a session. If the attacker is unable to identify or guess the session information related to pending application traffic, they will have more difficulty in hijacking the session or otherwise manipulating valid sessions.\n\nThis requirement focuses on communications protection for the application session rather than for the network packet. This requirement applies to applications that utilize communications sessions. This includes, but is not limited to, web-based applications and Service-Oriented Architectures (SOA).'\n  desc 'check', 'Review the ArcGIS for Server configuration to ensure the application recognizes only system generated session identifiers. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]/admin/security/config (logon when prompted.)\n\nVerify the “User Store Configuration” value = “Type: Windows”.\nIf the “User Store Configuration” value is set to “Type: Built-In”, this is a finding.\n\nVerify the “Role Store Configuration” value = “Type: Windows”.\nIf the “Role store Configuration” value is set to “Type: Built-In”, this is a finding.\n\nVerify the “Authentication Tier” value is set to “WEB_ADAPTOR”.\nIf the “Authentication Tier” value is set to “GIS_SERVER”, this is a finding.\n\nThis test requires the account performing the check to have \"Administrator\" privilege to the ArcGIS for Server site. This check can be performed remotely via HTTPS. This configuration is only valid when ArcGIS for Server has been deployed onto a Windows 2008 or later operating system that is a member of an Active Directory domain that disables identifiers that show more than 35 days of inactivity.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.'\n  desc 'fix', 'Configure ArcGIS for Server to ensure the application recognizes only system generated session identifiers. Substitute the target environment’s values for [bracketed] variables.\n\nIdentify a system that will serve as the service endpoint for the ArcGIS for Server environment. This must be an Active Directory joined Windows 2008 R2 system with IIS 7.5 or later installed.\n\nIf a Web Application Firewall (WAF), and/or Load Balancer serves as the user-connection endpoint, this system must be deployed on a trusted network behind these front-end technologies. On this system (locally), perform the following steps:\n\nInstall the “ArcGIS Web Adaptor”\nConfigure the “ArcGIS Web Adaptor” such that “Administration” is enabled via the Web Adaptor.\n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\"\n\nConfigure ArcGIS for Server to utilize Windows Users and Roles:\n\nNavigate to ArcGIS Server Manager ([https://server.domain.com/arcgis]/manager). (logon when prompted.)\nNavigate to the “Security” tab.\nNavigate to the “Settings” sub-tab.\nEdit “Configuration Settings” by clicking on the pencil icon.\nSelect “Users and roles from an existing enterprise system (LDAP or Windows Domain)”, then click “Next”.\nSelect “Windows Domain”, then click “Next”.\nSupply Active Directory credentials with privileges “Logon To” the system on which ArcGIS for Server is deployed, then click “Next”.\nSelect “Web Tier” as the “Authentication Tier”, then click “Next” >> “Finish”.'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40549r642807_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237330'\n  tag rid: 'SV-237330r879638_rule'\n  tag stig_id: 'AGIS-00-000098'\n  tag gtitle: 'SRG-APP-000223'\n  tag fix_id: 'F-40512r642808_fix'\n  tag 'documentable'\n  tag legacy: ['SV-79967', 'V-65477']\n  tag cci: ['CCI-001664']\n  tag nist: ['SC-23 (3)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237330.rb"},"title":"The ArcGIS Server must recognize only system-generated session identifiers.","desc":"Applications utilize sessions and session identifiers to control application behavior and user access. If an attacker can guess the session identifier, or can inject or manually insert session information, the session may be compromised.\n\nUnique session IDs address man-in-the-middle attacks, including session hijacking or insertion of false information into a session. If the attacker is unable to identify or guess the session information related to pending application traffic, they will have more difficulty in hijacking the session or otherwise manipulating valid sessions.\n\nThis requirement focuses on communications protection for the application session rather than for the network packet. This requirement applies to applications that utilize communications sessions. This includes, but is not limited to, web-based applications and Service-Oriented Architectures (SOA).","descriptions":{"default":"Applications utilize sessions and session identifiers to control application behavior and user access. If an attacker can guess the session identifier, or can inject or manually insert session information, the session may be compromised.\n\nUnique session IDs address man-in-the-middle attacks, including session hijacking or insertion of false information into a session. If the attacker is unable to identify or guess the session information related to pending application traffic, they will have more difficulty in hijacking the session or otherwise manipulating valid sessions.\n\nThis requirement focuses on communications protection for the application session rather than for the network packet. This requirement applies to applications that utilize communications sessions. This includes, but is not limited to, web-based applications and Service-Oriented Architectures (SOA).","check":"Review the ArcGIS for Server configuration to ensure the application recognizes only system generated session identifiers. Substitute the target environment’s values for [bracketed] variables.\n\nNavigate to [https://server.domain.com/arcgis]/admin/security/config (logon when prompted.)\n\nVerify the “User Store Configuration” value = “Type: Windows”.\nIf the “User Store Configuration” value is set to “Type: Built-In”, this is a finding.\n\nVerify the “Role Store Configuration” value = “Type: Windows”.\nIf the “Role store Configuration” value is set to “Type: Built-In”, this is a finding.\n\nVerify the “Authentication Tier” value is set to “WEB_ADAPTOR”.\nIf the “Authentication Tier” value is set to “GIS_SERVER”, this is a finding.\n\nThis test requires the account performing the check to have \"Administrator\" privilege to the ArcGIS for Server site. This check can be performed remotely via HTTPS. This configuration is only valid when ArcGIS for Server has been deployed onto a Windows 2008 or later operating system that is a member of an Active Directory domain that disables identifiers that show more than 35 days of inactivity.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.","fix":"Configure ArcGIS for Server to ensure the application recognizes only system generated session identifiers. Substitute the target environment’s values for [bracketed] variables.\n\nIdentify a system that will serve as the service endpoint for the ArcGIS for Server environment. This must be an Active Directory joined Windows 2008 R2 system with IIS 7.5 or later installed.\n\nIf a Web Application Firewall (WAF), and/or Load Balancer serves as the user-connection endpoint, this system must be deployed on a trusted network behind these front-end technologies. On this system (locally), perform the following steps:\n\nInstall the “ArcGIS Web Adaptor”\nConfigure the “ArcGIS Web Adaptor” such that “Administration” is enabled via the Web Adaptor.\n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\"\n\nConfigure ArcGIS for Server to utilize Windows Users and Roles:\n\nNavigate to ArcGIS Server Manager ([https://server.domain.com/arcgis]/manager). (logon when prompted.)\nNavigate to the “Security” tab.\nNavigate to the “Settings” sub-tab.\nEdit “Configuration Settings” by clicking on the pencil icon.\nSelect “Users and roles from an existing enterprise system (LDAP or Windows Domain)”, then click “Next”.\nSelect “Windows Domain”, then click “Next”.\nSupply Active Directory credentials with privileges “Logon To” the system on which ArcGIS for Server is deployed, then click “Next”.\nSelect “Web Tier” as the “Authentication Tier”, then click “Next” >> “Finish”."},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40549r642807_chk","severity":"medium","gid":"V-237330","rid":"SV-237330r879638_rule","stig_id":"AGIS-00-000098","gtitle":"SRG-APP-000223","fix_id":"F-40512r642808_fix","documentable":null,"legacy":["SV-79967","V-65477"],"cci":["CCI-001664"],"nist":["SC-23 (3)"]}},{"id":"SV-237331","code":"control 'SV-237331' do\n  title 'The ArcGIS Server must use a full disk encryption solution to protect the confidentiality and integrity of all information.'\n  desc 'Information at rest refers to the state of information when it is located on a secondary storage device (e.g., disk drive and tape drive) within an organizational information system. Mobile devices, laptops, desktops, and storage devices can be either lost or stolen, and the contents of their data storage (e.g., hard drives and non-volatile memory) can be read, copied, or altered. Applications and application users generate information throughout the course of their application use.\n\nThis requirement addresses protection of user-generated data, as well as, operating system-specific configuration data. Organizations may choose to employ different mechanisms to achieve confidentiality and integrity protections, as appropriate, in accordance with the security category and/or classification of the information.'\n  desc 'check', %q(Review the ArcGIS Server configuration to ensure mechanisms that protect the confidentiality and integrity of all information at rest are provided. Substitute the target environment’s values for [bracketed] variables. \n\n1. Log on to https://[server.domain.com]:6443/arcgis/admin/data/items/fileShares (\"Primary Site Administrator\" account access is required.)\n\nOpen each \"Child Items\" entry >> click \"Edit\".\n\nNote the \"path\" value. For example, \"path\": \"\\\\[server.domain.com\\share\".\n\nVerify the infrastructure system(s) that supply each path implement FIPS 140-2 compliant encryption at rest, such as through the use of BitLocker full disk encryption.\n\nIf any infrastructure system(s) that supply each path do not implement FIPS 140-2 compliant encryption at rest, such as through the use of BitLocker full disk encryption, this is a finding.\n\n2. Log on to https://[server.domain.com]:6443/arcgis/admin/data/items/enterpriseDatabases (\"Primary Site Administrator\" account access is required.)\n\nOpen each \"Child Items\" entry >> click \"Edit\".\n\nNote the \"info\" values \"SERVER\", \"DBCLIENT\", and \"DATABASE\", for example: 'SERVER=dbserver', 'DBCLIENT=sqlserver', 'DATABASE=vtest';\n\nVerify on each \"SERVER\", \"DBCLIENT\", and \"DATABASE\", that these systems implement FIPS 140-2 compliant encryption at rest, such as through the use of SQL Server TDE (Transparent Data Encryption).\n\nIf any \"SERVER\", \"DBCLIENT\", and \"DATABASE\" do not implement FIPS 140-2 compliant encryption at rest, such as through the use of SQL Server TDE (Transparent Data Encryption), this is a finding.)\n  desc 'fix', %q(Configure the ArcGIS Server to ensure mechanisms that protect the confidentiality and integrity of all information at rest are provided. Substitute the target environment’s values for [bracketed] variables. \n\nLog on to https://[server.domain.com]:6443/arcgis/admin/data/items/fileShares (\"Primary Site Administrator\" account access is required.)\n\nOpen each \"Child Items\" entry >> click \"Edit\".\n\nNote the \"path\" value. For example, \"path\": \"\\\\[server.domain.com\\share\".\n\nImplement FIPS 140-2 compliant encryption at rest (such as BitLocker full disk encryption) on each infrastructure system that supplies each file path.\n\nLog on to https://[server.domain.com]:6443/arcgis/admin/data/items/enterpriseDatabases (\"Primary Site Administrator\" account access is required.)\n\nOpen each \"Child Items\" entry >> click \"Edit\".\n\nNote the \"info\" values \"SERVER\", \"DBCLIENT\", and \"DATABASE\", for example: \n'SERVER=dbserver', 'DBCLIENT=sqlserver', 'DATABASE=vtest';\n\nImplement FIPS 140-2 compliant encryption at rest such as through the use of SQL Server TDE (Transparent Data Encryption) on each \"SERVER\", \"DBCLIENT\", and \"DATABASE\" entry identified above.)\n  impact 0.7\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40550r642810_chk'\n  tag severity: 'high'\n  tag gid: 'V-237331'\n  tag rid: 'SV-237331r879642_rule'\n  tag stig_id: 'AGIS-00-000102'\n  tag gtitle: 'SRG-APP-000231'\n  tag fix_id: 'F-40513r642811_fix'\n  tag 'documentable'\n  tag legacy: ['SV-79973', 'V-65483']\n  tag cci: ['CCI-001199']\n  tag nist: ['SC-28']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237331.rb"},"title":"The ArcGIS Server must use a full disk encryption solution to protect the confidentiality and integrity of all information.","desc":"Information at rest refers to the state of information when it is located on a secondary storage device (e.g., disk drive and tape drive) within an organizational information system. Mobile devices, laptops, desktops, and storage devices can be either lost or stolen, and the contents of their data storage (e.g., hard drives and non-volatile memory) can be read, copied, or altered. Applications and application users generate information throughout the course of their application use.\n\nThis requirement addresses protection of user-generated data, as well as, operating system-specific configuration data. Organizations may choose to employ different mechanisms to achieve confidentiality and integrity protections, as appropriate, in accordance with the security category and/or classification of the information.","descriptions":{"default":"Information at rest refers to the state of information when it is located on a secondary storage device (e.g., disk drive and tape drive) within an organizational information system. Mobile devices, laptops, desktops, and storage devices can be either lost or stolen, and the contents of their data storage (e.g., hard drives and non-volatile memory) can be read, copied, or altered. Applications and application users generate information throughout the course of their application use.\n\nThis requirement addresses protection of user-generated data, as well as, operating system-specific configuration data. Organizations may choose to employ different mechanisms to achieve confidentiality and integrity protections, as appropriate, in accordance with the security category and/or classification of the information.","check":"Review the ArcGIS Server configuration to ensure mechanisms that protect the confidentiality and integrity of all information at rest are provided. Substitute the target environment’s values for [bracketed] variables. \n\n1. Log on to https://[server.domain.com]:6443/arcgis/admin/data/items/fileShares (\"Primary Site Administrator\" account access is required.)\n\nOpen each \"Child Items\" entry >> click \"Edit\".\n\nNote the \"path\" value. For example, \"path\": \"\\[server.domain.com\\share\".\n\nVerify the infrastructure system(s) that supply each path implement FIPS 140-2 compliant encryption at rest, such as through the use of BitLocker full disk encryption.\n\nIf any infrastructure system(s) that supply each path do not implement FIPS 140-2 compliant encryption at rest, such as through the use of BitLocker full disk encryption, this is a finding.\n\n2. Log on to https://[server.domain.com]:6443/arcgis/admin/data/items/enterpriseDatabases (\"Primary Site Administrator\" account access is required.)\n\nOpen each \"Child Items\" entry >> click \"Edit\".\n\nNote the \"info\" values \"SERVER\", \"DBCLIENT\", and \"DATABASE\", for example: 'SERVER=dbserver', 'DBCLIENT=sqlserver', 'DATABASE=vtest';\n\nVerify on each \"SERVER\", \"DBCLIENT\", and \"DATABASE\", that these systems implement FIPS 140-2 compliant encryption at rest, such as through the use of SQL Server TDE (Transparent Data Encryption).\n\nIf any \"SERVER\", \"DBCLIENT\", and \"DATABASE\" do not implement FIPS 140-2 compliant encryption at rest, such as through the use of SQL Server TDE (Transparent Data Encryption), this is a finding.","fix":"Configure the ArcGIS Server to ensure mechanisms that protect the confidentiality and integrity of all information at rest are provided. Substitute the target environment’s values for [bracketed] variables. \n\nLog on to https://[server.domain.com]:6443/arcgis/admin/data/items/fileShares (\"Primary Site Administrator\" account access is required.)\n\nOpen each \"Child Items\" entry >> click \"Edit\".\n\nNote the \"path\" value. For example, \"path\": \"\\[server.domain.com\\share\".\n\nImplement FIPS 140-2 compliant encryption at rest (such as BitLocker full disk encryption) on each infrastructure system that supplies each file path.\n\nLog on to https://[server.domain.com]:6443/arcgis/admin/data/items/enterpriseDatabases (\"Primary Site Administrator\" account access is required.)\n\nOpen each \"Child Items\" entry >> click \"Edit\".\n\nNote the \"info\" values \"SERVER\", \"DBCLIENT\", and \"DATABASE\", for example: \n'SERVER=dbserver', 'DBCLIENT=sqlserver', 'DATABASE=vtest';\n\nImplement FIPS 140-2 compliant encryption at rest such as through the use of SQL Server TDE (Transparent Data Encryption) on each \"SERVER\", \"DBCLIENT\", and \"DATABASE\" entry identified above."},"impact":0.7,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40550r642810_chk","severity":"high","gid":"V-237331","rid":"SV-237331r879642_rule","stig_id":"AGIS-00-000102","gtitle":"SRG-APP-000231","fix_id":"F-40513r642811_fix","documentable":null,"legacy":["SV-79973","V-65483"],"cci":["CCI-001199"],"nist":["SC-28"]}},{"id":"SV-237332","code":"control 'SV-237332' do\n  title 'The ArcGIS Server must be configured such that emergency accounts are never automatically removed or disabled.'\n  desc 'Emergency accounts are administrator accounts which are established in response to crisis situations where the need for rapid account activation is required. Therefore, emergency account activation may bypass normal account authorization processes. If these accounts are automatically disabled, system maintenance during emergencies may not be possible, thus adversely affecting system availability. \n\nEmergency accounts are different from infrequently used accounts (i.e., local logon accounts used by system administrators when network or normal logon/access is not available). Infrequently used accounts also remain available and are not subject to automatic termination dates. However, an emergency account is normally a different account which is created for use by vendors or system maintainers.\n\nTo address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.'\n  desc 'check', 'Review the ArcGIS Server configuration to ensure emergency accounts are never automatically removed or disabled. Substitute the target environment’s values for [bracketed] variables. \n\nLog on to the ArcGIS Server Administrator Directory ([https://[server.domain.com])/arcgis/admin) (log on when promoted) with an account that has administrative access.\n\nNavigate to security >> psa. Verify that the Primary Site Administrator account has not been disabled.\n\nIf the \"Primary Site Administrator\" account has been disabled, this is a finding.'\n  desc 'fix', 'Configure the ArcGIS Server to ensure emergency accounts are never automatically removed or disabled. Substitute the target environment’s values for [bracketed] variables. \n\nLog on to the ArcGIS Server Administrator Directory ([https://[server.domain.com])/arcgis/admin) with an account that has administrative access.\n\nNavigate to security >> psa >> enable to enable the \"Primary Site Administrator\" account.'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40551r642813_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237332'\n  tag rid: 'SV-237332r879644_rule'\n  tag stig_id: 'AGIS-00-000104'\n  tag gtitle: 'SRG-APP-000234'\n  tag fix_id: 'F-40514r642814_fix'\n  tag 'documentable'\n  tag legacy: ['SV-79975', 'V-65485']\n  tag cci: ['CCI-001682']\n  tag nist: ['AC-2 (2)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237332.rb"},"title":"The ArcGIS Server must be configured such that emergency accounts are never automatically removed or disabled.","desc":"Emergency accounts are administrator accounts which are established in response to crisis situations where the need for rapid account activation is required. Therefore, emergency account activation may bypass normal account authorization processes. If these accounts are automatically disabled, system maintenance during emergencies may not be possible, thus adversely affecting system availability. \n\nEmergency accounts are different from infrequently used accounts (i.e., local logon accounts used by system administrators when network or normal logon/access is not available). Infrequently used accounts also remain available and are not subject to automatic termination dates. However, an emergency account is normally a different account which is created for use by vendors or system maintainers.\n\nTo address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.","descriptions":{"default":"Emergency accounts are administrator accounts which are established in response to crisis situations where the need for rapid account activation is required. Therefore, emergency account activation may bypass normal account authorization processes. If these accounts are automatically disabled, system maintenance during emergencies may not be possible, thus adversely affecting system availability. \n\nEmergency accounts are different from infrequently used accounts (i.e., local logon accounts used by system administrators when network or normal logon/access is not available). Infrequently used accounts also remain available and are not subject to automatic termination dates. However, an emergency account is normally a different account which is created for use by vendors or system maintainers.\n\nTo address access requirements, many application developers choose to integrate their applications with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements. Such integration allows the application developer to off-load those access control functions and focus on core application features and functionality.","check":"Review the ArcGIS Server configuration to ensure emergency accounts are never automatically removed or disabled. Substitute the target environment’s values for [bracketed] variables. \n\nLog on to the ArcGIS Server Administrator Directory ([https://[server.domain.com])/arcgis/admin) (log on when promoted) with an account that has administrative access.\n\nNavigate to security >> psa. Verify that the Primary Site Administrator account has not been disabled.\n\nIf the \"Primary Site Administrator\" account has been disabled, this is a finding.","fix":"Configure the ArcGIS Server to ensure emergency accounts are never automatically removed or disabled. Substitute the target environment’s values for [bracketed] variables. \n\nLog on to the ArcGIS Server Administrator Directory ([https://[server.domain.com])/arcgis/admin) with an account that has administrative access.\n\nNavigate to security >> psa >> enable to enable the \"Primary Site Administrator\" account."},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40551r642813_chk","severity":"medium","gid":"V-237332","rid":"SV-237332r879644_rule","stig_id":"AGIS-00-000104","gtitle":"SRG-APP-000234","fix_id":"F-40514r642814_fix","documentable":null,"legacy":["SV-79975","V-65485"],"cci":["CCI-001682"],"nist":["AC-2 (2)"]}},{"id":"SV-237333","code":"control 'SV-237333' do\n  title 'The ArcGIS Server must reveal error messages only to the ISSO, ISSM, and SA.'\n  desc \"Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the application. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.\n\nThe structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.\"\n  desc 'check', 'Review the ArcGIS Server configuration to ensure the application reveals error messages only to authorized personnel. Substitute the target environment’s values for [bracketed] variables. \n\n1. Inspect the Security Properties of the [C:\\\\arcgisserver\\\\logs] folder. Verify that the [ArcGIS Server] account has full control of the folder and only authorized personnel have access to the folder.\n \n2. Log on to ArcGIS Server Manager >> Security >> Roles >> Publisher. Verify that only [authorized personnel accounts] are granted this role. \n\n3. Log on to ArcGIS Server Manager >> Security >> Roles >> Administrator (log on when prompted.) Verify that only [authorized personnel accounts] are granted this role.\n\nVerify any other accounts that have read or other rights to this folder are authorized and documented.\n\nIf unauthorized accounts have read or other rights to this folder, this is a finding.'\n  desc 'fix', 'Configure the ArcGIS Server to ensure the application reveals error messages only to authorized personnel. Substitute the target environment’s values for [bracketed] variables. \n\nEdit the file system Security Properties of [C:\\\\arcgisserver\\\\logs].\n\nRemove unauthorized user accounts and groups.\n\nDo not remove the SYSTEM account, [ArcGIS Server] account, or log agent accounts that support SIEM operations.\n\nRevoke \"Publisher\" and \"Administrator ArcGIS Server\" roles from unauthorized accounts.\n\nLog on to ArcGIS Server Manager >> navigate to Security >> Roles >> locate and edit the \"Publisher\" role.\n\nRemove any unauthorized users from the \"Publisher\" role.\n\nLog on to ArcGIS Server Manager >> navigate to Security >> Roles >> locate and edit the \"Administrator\" role.\n\nRemove any unauthorized users from the \"Administrator\" role.'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40552r642816_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237333'\n  tag rid: 'SV-237333r879656_rule'\n  tag stig_id: 'AGIS-00-000111'\n  tag gtitle: 'SRG-APP-000267'\n  tag fix_id: 'F-40515r642817_fix'\n  tag 'documentable'\n  tag legacy: ['SV-79977', 'V-65487']\n  tag cci: ['CCI-001314']\n  tag nist: ['SI-11 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237333.rb"},"title":"The ArcGIS Server must reveal error messages only to the ISSO, ISSM, and SA.","desc":"Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the application. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.\n\nThe structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.","descriptions":{"default":"Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the application. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.\n\nThe structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.","check":"Review the ArcGIS Server configuration to ensure the application reveals error messages only to authorized personnel. Substitute the target environment’s values for [bracketed] variables. \n\n1. Inspect the Security Properties of the [C:\\arcgisserver\\logs] folder. Verify that the [ArcGIS Server] account has full control of the folder and only authorized personnel have access to the folder.\n \n2. Log on to ArcGIS Server Manager >> Security >> Roles >> Publisher. Verify that only [authorized personnel accounts] are granted this role. \n\n3. Log on to ArcGIS Server Manager >> Security >> Roles >> Administrator (log on when prompted.) Verify that only [authorized personnel accounts] are granted this role.\n\nVerify any other accounts that have read or other rights to this folder are authorized and documented.\n\nIf unauthorized accounts have read or other rights to this folder, this is a finding.","fix":"Configure the ArcGIS Server to ensure the application reveals error messages only to authorized personnel. Substitute the target environment’s values for [bracketed] variables. \n\nEdit the file system Security Properties of [C:\\arcgisserver\\logs].\n\nRemove unauthorized user accounts and groups.\n\nDo not remove the SYSTEM account, [ArcGIS Server] account, or log agent accounts that support SIEM operations.\n\nRevoke \"Publisher\" and \"Administrator ArcGIS Server\" roles from unauthorized accounts.\n\nLog on to ArcGIS Server Manager >> navigate to Security >> Roles >> locate and edit the \"Publisher\" role.\n\nRemove any unauthorized users from the \"Publisher\" role.\n\nLog on to ArcGIS Server Manager >> navigate to Security >> Roles >> locate and edit the \"Administrator\" role.\n\nRemove any unauthorized users from the \"Administrator\" role."},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40552r642816_chk","severity":"medium","gid":"V-237333","rid":"SV-237333r879656_rule","stig_id":"AGIS-00-000111","gtitle":"SRG-APP-000267","fix_id":"F-40515r642817_fix","documentable":null,"legacy":["SV-79977","V-65487"],"cci":["CCI-001314"],"nist":["SI-11 b"]}},{"id":"SV-237334","code":"control 'SV-237334' do\n  title 'The ArcGIS Server must enforce access restrictions associated with changes to application configuration.'\n  desc 'Failure to provide logical access restrictions associated with changes to application configuration may have significant effects on the overall security of the system. \n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system. \n\nAccordingly, only qualified and authorized individuals should be allowed to obtain access to application components for the purposes of initiating changes, including upgrades and modifications. \n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).'\n  desc 'check', 'Review the ArcGIS for Server configuration to ensure that the application enforces access restrictions associated with changes to application configuration. Substitute the target environment’s values for [bracketed] variables.\n\nLogon to ArcGIS Server Manager ([https://server.domain.com/arcgis]/manager]) (logon when prompted) >> “Security” >> “Roles” >> “Administrator” role.\n\nVerify that only authorized personnel are listed as members of the “Administrator” role. \n\nIf unauthorized personnel are members of the “Administrator” role, this is a finding.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.'\n  desc 'fix', 'Configure the ArcGIS Server to enforce access restrictions associated with changes to application configuration. Substitute the target environment’s values for [bracketed] variables. \n\nLog on to ArcGIS Server Manager ([https://server.domain.com/arcgis]/manager]) (log on when prompted) >> Security >> Roles >> \"Administrator\" role.\n\nRemove unauthorized personnel from the \"Administrator\" role.'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40553r642819_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237334'\n  tag rid: 'SV-237334r879753_rule'\n  tag stig_id: 'AGIS-00-000164'\n  tag gtitle: 'SRG-APP-000380'\n  tag fix_id: 'F-40516r642820_fix'\n  tag 'documentable'\n  tag legacy: ['SV-79989', 'V-65499']\n  tag cci: ['CCI-001813']\n  tag nist: ['CM-5 (1) (a)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237334.rb"},"title":"The ArcGIS Server must enforce access restrictions associated with changes to application configuration.","desc":"Failure to provide logical access restrictions associated with changes to application configuration may have significant effects on the overall security of the system. \n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system. \n\nAccordingly, only qualified and authorized individuals should be allowed to obtain access to application components for the purposes of initiating changes, including upgrades and modifications. \n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","descriptions":{"default":"Failure to provide logical access restrictions associated with changes to application configuration may have significant effects on the overall security of the system. \n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system. \n\nAccordingly, only qualified and authorized individuals should be allowed to obtain access to application components for the purposes of initiating changes, including upgrades and modifications. \n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","check":"Review the ArcGIS for Server configuration to ensure that the application enforces access restrictions associated with changes to application configuration. Substitute the target environment’s values for [bracketed] variables.\n\nLogon to ArcGIS Server Manager ([https://server.domain.com/arcgis]/manager]) (logon when prompted) >> “Security” >> “Roles” >> “Administrator” role.\n\nVerify that only authorized personnel are listed as members of the “Administrator” role. \n\nIf unauthorized personnel are members of the “Administrator” role, this is a finding.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.","fix":"Configure the ArcGIS Server to enforce access restrictions associated with changes to application configuration. Substitute the target environment’s values for [bracketed] variables. \n\nLog on to ArcGIS Server Manager ([https://server.domain.com/arcgis]/manager]) (log on when prompted) >> Security >> Roles >> \"Administrator\" role.\n\nRemove unauthorized personnel from the \"Administrator\" role."},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40553r642819_chk","severity":"medium","gid":"V-237334","rid":"SV-237334r879753_rule","stig_id":"AGIS-00-000164","gtitle":"SRG-APP-000380","fix_id":"F-40516r642820_fix","documentable":null,"legacy":["SV-79989","V-65499"],"cci":["CCI-001813"],"nist":["CM-5 (1) (a)"]}},{"id":"SV-237335","code":"control 'SV-237335' do\n  title 'The organization must disable organization-defined functions, ports, protocols, and services within the ArcGIS Server deemed to be unnecessary and/or nonsecure.'\n  desc 'In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services; however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.'\n  desc 'check', 'Review the ArcGIS for Server configuration to ensure that organization-defined unnecessary or insecure ports, functions, and services are disabled. Substitute the target environment’s values for [bracketed] variables.\n\nUsing an ArcGIS Server account that is a member of the ArcGIS Server Administrator role, logon to the ArcGIS Server Administrator Directory at https://[server.domain.com:6443]/arcgis/admin.\nBrowse to “security” >> “config”.\nVerify “Protocol” parameter is not set to “HTTP Only”.\nIf the “Protocol” parameter is set to “HTTP Only”, this is a finding.\n\nThis control is not applicable for ArcGIS Servers which are deployed as part of a solution which ensures user web service traffic flows through third-party DoD compliant transport encryption devices (such as a load balancer that supports TLS encryption using DoD-approved certificates.)'\n  desc 'fix', 'Configure the ArcGIS Server to ensure organization-defined unnecessary or insecure ports, functions, and services are disabled. Substitute the target environment’s values for [bracketed] variables. \n\nNavigate to [https://server.domain.com/arcgis]admin/security/config (log on when prompted).\n \nBrowse to Update. Update the Protocol parameter to \"HTTPS Only\".\n\nClick \"Save\"/\"Apply\".'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40554r642822_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237335'\n  tag rid: 'SV-237335r879756_rule'\n  tag stig_id: 'AGIS-00-000166'\n  tag gtitle: 'SRG-APP-000383'\n  tag fix_id: 'F-40517r642823_fix'\n  tag 'documentable'\n  tag legacy: ['SV-79993', 'V-65503']\n  tag cci: ['CCI-001762']\n  tag nist: ['CM-7 (1) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237335.rb"},"title":"The organization must disable organization-defined functions, ports, protocols, and services within the ArcGIS Server deemed to be unnecessary and/or nonsecure.","desc":"In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services; however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.","descriptions":{"default":"In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nApplications are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services; however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the application must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.","check":"Review the ArcGIS for Server configuration to ensure that organization-defined unnecessary or insecure ports, functions, and services are disabled. Substitute the target environment’s values for [bracketed] variables.\n\nUsing an ArcGIS Server account that is a member of the ArcGIS Server Administrator role, logon to the ArcGIS Server Administrator Directory at https://[server.domain.com:6443]/arcgis/admin.\nBrowse to “security” >> “config”.\nVerify “Protocol” parameter is not set to “HTTP Only”.\nIf the “Protocol” parameter is set to “HTTP Only”, this is a finding.\n\nThis control is not applicable for ArcGIS Servers which are deployed as part of a solution which ensures user web service traffic flows through third-party DoD compliant transport encryption devices (such as a load balancer that supports TLS encryption using DoD-approved certificates.)","fix":"Configure the ArcGIS Server to ensure organization-defined unnecessary or insecure ports, functions, and services are disabled. Substitute the target environment’s values for [bracketed] variables. \n\nNavigate to [https://server.domain.com/arcgis]admin/security/config (log on when prompted).\n \nBrowse to Update. Update the Protocol parameter to \"HTTPS Only\".\n\nClick \"Save\"/\"Apply\"."},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40554r642822_chk","severity":"medium","gid":"V-237335","rid":"SV-237335r879756_rule","stig_id":"AGIS-00-000166","gtitle":"SRG-APP-000383","fix_id":"F-40517r642823_fix","documentable":null,"legacy":["SV-79993","V-65503"],"cci":["CCI-001762"],"nist":["CM-7 (1) (b)"]}},{"id":"SV-237336","code":"control 'SV-237336' do\n  title 'The ArcGIS Server must accept and electronically verify Personal Identity Verification (PIV) credentials.'\n  desc 'The use of PIV credentials facilitates standardization and reduces the risk of unauthorized access.\n\nDoD has mandated the use of the CAC to support identity management and personal authentication for systems covered under HSPD 12, as well as a primary component of layered protection for national security systems.\n\n'\n  desc 'check', 'Review the ArcGIS for Server configuration to ensure that the application accepts Personal Identity Verification (PIV) credentials. Substitute the target environment’s values for [bracketed] variables.\n\nWithin IIS >> within the [“arcgis”] application >> Authentication >> Verify that “Windows Authentication” is “Enabled”.\nVerify that “Anonymous Authentication” is “Disabled”.\nIf “Windows Authentication” is not enabled, or “Anonymous Authentication” is enabled, this is a finding.\n\nWithin IIS >> within the [“arcgis”] application >> SSL Settings >> Verify the setting “Client Certificates:” is set to “Accept” or “Require”\nIf “Client Certificates:” is set to “Ignore” this is a finding.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.'\n  desc 'fix', 'Configure ArcGIS for Server to accept Personal Identity Verification (PIV) credentials. Substitute the target environment’s values for [bracketed] variables.\n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\"'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40555r642825_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237336'\n  tag rid: 'SV-237336r879764_rule'\n  tag stig_id: 'AGIS-00-000171'\n  tag gtitle: 'SRG-APP-000391'\n  tag fix_id: 'F-40518r642826_fix'\n  tag satisfies: ['SRG-APP-000391', 'SRG-APP-000392']\n  tag 'documentable'\n  tag legacy: ['SV-79999', 'V-65509']\n  tag cci: ['CCI-001953', 'CCI-001954']\n  tag nist: ['IA-2 (12)', 'IA-2 (12)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237336.rb"},"title":"The ArcGIS Server must accept and electronically verify Personal Identity Verification (PIV) credentials.","desc":"The use of PIV credentials facilitates standardization and reduces the risk of unauthorized access.\n\nDoD has mandated the use of the CAC to support identity management and personal authentication for systems covered under HSPD 12, as well as a primary component of layered protection for national security systems.\n\n","descriptions":{"default":"The use of PIV credentials facilitates standardization and reduces the risk of unauthorized access.\n\nDoD has mandated the use of the CAC to support identity management and personal authentication for systems covered under HSPD 12, as well as a primary component of layered protection for national security systems.\n\n","check":"Review the ArcGIS for Server configuration to ensure that the application accepts Personal Identity Verification (PIV) credentials. Substitute the target environment’s values for [bracketed] variables.\n\nWithin IIS >> within the [“arcgis”] application >> Authentication >> Verify that “Windows Authentication” is “Enabled”.\nVerify that “Anonymous Authentication” is “Disabled”.\nIf “Windows Authentication” is not enabled, or “Anonymous Authentication” is enabled, this is a finding.\n\nWithin IIS >> within the [“arcgis”] application >> SSL Settings >> Verify the setting “Client Certificates:” is set to “Accept” or “Require”\nIf “Client Certificates:” is set to “Ignore” this is a finding.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.","fix":"Configure ArcGIS for Server to accept Personal Identity Verification (PIV) credentials. Substitute the target environment’s values for [bracketed] variables.\n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\""},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40555r642825_chk","severity":"medium","gid":"V-237336","rid":"SV-237336r879764_rule","stig_id":"AGIS-00-000171","gtitle":"SRG-APP-000391","fix_id":"F-40518r642826_fix","satisfies":["SRG-APP-000391","SRG-APP-000392"],"documentable":null,"legacy":["SV-79999","V-65509"],"cci":["CCI-001953","CCI-001954"],"nist":["IA-2 (12)","IA-2 (12)"]}},{"id":"SV-237337","code":"control 'SV-237337' do\n  title 'The ArcGIS Server Windows authentication must authenticate all endpoint devices before establishing a local, remote, and/or network connection using bidirectional authentication that is cryptographically based.'\n  desc 'Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.\n\nFor distributed architectures (e.g., service-oriented architectures), the decisions regarding the validation of authentication claims may be made by services separate from the services acting on those decisions. In such situations, it is necessary to provide authentication decisions (as opposed to the actual authenticators) to the services that need to act on those decisions.\n\nA local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, Internet). A remote connection is any connection with a device communicating through an external network (e.g., the Internet).\n\nBecause of the challenges of applying this requirement of a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability.\n\n'\n  desc 'check', 'Review the ArcGIS for Server configuration to ensure that the application authenticates all network connected endpoint devices before establishing any connection. Substitute the target environment’s values for [bracketed] variables.\n\nWithin IIS >> within the [“arcgis”] application >> Authentication >> Verify that “Windows Authentication” is “Enabled”.\nVerify that “Anonymous Authentication” is “Disabled”.\nIf “Windows Authentication” is not enabled, or “Anonymous Authentication” is enabled, this is a finding.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.'\n  desc 'fix', 'Configure ArcGIS for Server to accept Personal Identity Verification (PIV) credentials. Substitute the target environment’s values for [bracketed] variables.\n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\"'\n  impact 0.7\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40556r642828_chk'\n  tag severity: 'high'\n  tag gid: 'V-237337'\n  tag rid: 'SV-237337r879768_rule'\n  tag stig_id: 'AGIS-00-000174'\n  tag gtitle: 'SRG-APP-000395'\n  tag fix_id: 'F-40519r642829_fix'\n  tag satisfies: ['SRG-APP-000395', 'SRG-APP-000317', 'SRG-APP-000345', 'SRG-APP-000389', 'SRG-APP-000390', 'SRG-APP-000394']\n  tag 'documentable'\n  tag legacy: ['SV-80005', 'V-65515']\n  tag cci: ['CCI-001958', 'CCI-001967', 'CCI-002038', 'CCI-002039', 'CCI-002142', 'CCI-002238']\n  tag nist: ['IA-3', 'IA-3 (1)', 'IA-11', 'IA-11', 'AC-2 (10)', 'AC-7 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237337.rb"},"title":"The ArcGIS Server Windows authentication must authenticate all endpoint devices before establishing a local, remote, and/or network connection using bidirectional authentication that is cryptographically based.","desc":"Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.\n\nFor distributed architectures (e.g., service-oriented architectures), the decisions regarding the validation of authentication claims may be made by services separate from the services acting on those decisions. In such situations, it is necessary to provide authentication decisions (as opposed to the actual authenticators) to the services that need to act on those decisions.\n\nA local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, Internet). A remote connection is any connection with a device communicating through an external network (e.g., the Internet).\n\nBecause of the challenges of applying this requirement of a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability.\n\n","descriptions":{"default":"Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.\n\nFor distributed architectures (e.g., service-oriented architectures), the decisions regarding the validation of authentication claims may be made by services separate from the services acting on those decisions. In such situations, it is necessary to provide authentication decisions (as opposed to the actual authenticators) to the services that need to act on those decisions.\n\nA local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, Internet). A remote connection is any connection with a device communicating through an external network (e.g., the Internet).\n\nBecause of the challenges of applying this requirement of a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability.\n\n","check":"Review the ArcGIS for Server configuration to ensure that the application authenticates all network connected endpoint devices before establishing any connection. Substitute the target environment’s values for [bracketed] variables.\n\nWithin IIS >> within the [“arcgis”] application >> Authentication >> Verify that “Windows Authentication” is “Enabled”.\nVerify that “Anonymous Authentication” is “Disabled”.\nIf “Windows Authentication” is not enabled, or “Anonymous Authentication” is enabled, this is a finding.\n\nThis control is not applicable for ArcGIS Server deployments configured to allow anonymous access.\n\nThis control is not applicable for ArcGIS Server deployments which are integrated with and protected by one or more third party DoD compliant certificate authentication solutions.","fix":"Configure ArcGIS for Server to accept Personal Identity Verification (PIV) credentials. Substitute the target environment’s values for [bracketed] variables.\n\nEnable Active Directory Client Certificate Authentication \"To map client certificates by using Active Directory mapping.\""},"impact":0.7,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40556r642828_chk","severity":"high","gid":"V-237337","rid":"SV-237337r879768_rule","stig_id":"AGIS-00-000174","gtitle":"SRG-APP-000395","fix_id":"F-40519r642829_fix","satisfies":["SRG-APP-000395","SRG-APP-000317","SRG-APP-000345","SRG-APP-000389","SRG-APP-000390","SRG-APP-000394"],"documentable":null,"legacy":["SV-80005","V-65515"],"cci":["CCI-001958","CCI-001967","CCI-002038","CCI-002039","CCI-002142","CCI-002238"],"nist":["IA-3","IA-3 (1)","IA-11","IA-11","AC-2 (10)","AC-7 b"]}},{"id":"SV-237338","code":"control 'SV-237338' do\n  title 'The ArcGIS Server SSL settings must use NSA-approved cryptography to protect classified information in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards.'\n  desc 'Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n'\n  desc 'check', 'Review the ArcGIS Server configuration to ensure the application implements NSA-approved cryptography to protect classified information in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards. Substitute the target environment’s values for [bracketed] variables.\n\nWithin IIS >> within the [“arcgis”] application >> SSL Settings >> Verify that “Require SSL” is checked.\nIf “Require SSL” is not checked, this is a finding.\n\nNote: To comply with this control, the Active Directory domain on which the ArcGIS Server and the IIS system are deployed must implement policies which enforce FIPS 140-2 compliance.\n\nThis control is not applicable for ArcGIS Servers which are deployed as part of a solution which ensures user web service traffic flows through third-party DoD compliant transport encryption devices (such as a load balancer that supports TLS encryption using DoD-approved certificates.)\n\nThis control is not applicable for ArcGIS Servers which are not deployed with the ArcGIS Web Adapter component.'\n  desc 'fix', 'Configure the ArcGIS Server to implement NSA-approved cryptography to protect classified information in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards. Substitute the target environment’s values for [bracketed] variables.\n\nWithin IIS >> within the \"[arcgis]\" application >> SSL Settings >> check \"Require SSL\".'\n  impact 0.7\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40557r642831_chk'\n  tag severity: 'high'\n  tag gid: 'V-237338'\n  tag rid: 'SV-237338r879944_rule'\n  tag stig_id: 'AGIS-00-000187'\n  tag gtitle: 'SRG-APP-000416'\n  tag fix_id: 'F-40520r642832_fix'\n  tag satisfies: ['SRG-APP-000416', 'SRG-APP-000439', 'SRG-APP-000440', 'SRG-APP-000441', 'SRG-APP-000442', 'SRG-APP-000514']\n  tag 'documentable'\n  tag legacy: ['SV-80007', 'V-65517']\n  tag cci: ['CCI-002418', 'CCI-002420', 'CCI-002421', 'CCI-002422', 'CCI-002450']\n  tag nist: ['SC-8', 'SC-8 (2)', 'SC-8 (1)', 'SC-8 (2)', 'SC-13 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237338.rb"},"title":"The ArcGIS Server SSL settings must use NSA-approved cryptography to protect classified information in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards.","desc":"Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n","descriptions":{"default":"Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n","check":"Review the ArcGIS Server configuration to ensure the application implements NSA-approved cryptography to protect classified information in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards. Substitute the target environment’s values for [bracketed] variables.\n\nWithin IIS >> within the [“arcgis”] application >> SSL Settings >> Verify that “Require SSL” is checked.\nIf “Require SSL” is not checked, this is a finding.\n\nNote: To comply with this control, the Active Directory domain on which the ArcGIS Server and the IIS system are deployed must implement policies which enforce FIPS 140-2 compliance.\n\nThis control is not applicable for ArcGIS Servers which are deployed as part of a solution which ensures user web service traffic flows through third-party DoD compliant transport encryption devices (such as a load balancer that supports TLS encryption using DoD-approved certificates.)\n\nThis control is not applicable for ArcGIS Servers which are not deployed with the ArcGIS Web Adapter component.","fix":"Configure the ArcGIS Server to implement NSA-approved cryptography to protect classified information in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards. Substitute the target environment’s values for [bracketed] variables.\n\nWithin IIS >> within the \"[arcgis]\" application >> SSL Settings >> check \"Require SSL\"."},"impact":0.7,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40557r642831_chk","severity":"high","gid":"V-237338","rid":"SV-237338r879944_rule","stig_id":"AGIS-00-000187","gtitle":"SRG-APP-000416","fix_id":"F-40520r642832_fix","satisfies":["SRG-APP-000416","SRG-APP-000439","SRG-APP-000440","SRG-APP-000441","SRG-APP-000442","SRG-APP-000514"],"documentable":null,"legacy":["SV-80007","V-65517"],"cci":["CCI-002418","CCI-002420","CCI-002421","CCI-002422","CCI-002450"],"nist":["SC-8","SC-8 (2)","SC-8 (1)","SC-8 (2)","SC-13 b"]}},{"id":"SV-237339","code":"control 'SV-237339' do\n  title 'The ArcGIS Server keystores must only contain certificates of PKI established certificate authorities for verification of protected sessions.'\n  desc 'Untrusted Certificate Authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DoD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DoD-approved CA, trust of this CA has not been established.\n\nThe DoD will only accept PKI certificates obtained from a DoD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of SSL/TLS certificates. \n\nThis requirement focuses on communications protection for the application session rather than for the network packet.\n\nThis requirement applies to applications that utilize communications sessions. This includes, but is not limited to, web-based applications and Service-Oriented Architectures (SOA).'\n  desc 'check', 'Review the ArcGIS Server configuration to ensure the application only allows the use of DoD PKI established certificate authorities for verification of the establishment of protected sessions. Substitute the target environment’s values for [bracketed] variables.\n\n1. Use a Java-compatible tool to access the java keystore at [C:\\\\Program Files\\\\ArcGIS\\\\Server\\\\framework\\\\runtime\\\\jre\\\\lib\\\\security\\\\cacerts].\n\nThe password for the keystore is \"changeit\".\n\nVerify that the Java Keystore [C:\\\\Program Files\\\\ArcGIS\\\\Server\\\\framework\\\\runtime\\\\jre\\\\lib\\\\security\\\\cacerts] does not contain any non-DoD-approved certificates. \n\nIf any non-DoD-approved certificate authorities are listed as trusted, this is a finding.\n\n2. Log on to the machine hosting ArcGIS Server. Open Certificate Manager. (You can do this by clicking the \"Start\" button, typing \"certmgr.msc\" into the \"Search\" box, and pressing the \"ENTER\" key.)\n\nIn the \"Certificate Manager\" window, click \"Trusted Root Certificate Authorities\", then click\" Certificates\".\n\nVerify that the Windows Keystore does not contain any non-DoD-approved certificates.\n\nIf any non-DoD-approved certificate authorities are listed as trusted, this is a finding.\n\n3. Use a Java-compatible tool to access the Java Keystore at [C:\\\\arcgisserver\\\\config-store\\\\machines\\\\machine_name\\\\arcgis.keystore].\n\nThe password is the value of the \"password\" field within the [C:\\\\arcgisserver\\\\config-store\\\\security\\\\super\\\\super.json] file.\n\nVerify that the Java Keystore [C:\\\\arcgisserver\\\\config-store\\\\machines\\\\machine_name\\\\arcgis.keystore] does not contain any non-DoD-approved certificates. \n\nIf any non-DoD-approved certificate authorities are listed as trusted, this is a finding.'\n  desc 'fix', 'Configure the ArcGIS Server to only allow the use of DoD PKI established certificate authorities for verification of the establishment of protected sessions. Substitute the target environment’s values for [bracketed] variables.\n\nUse a Java-compatible tool to access the Java keystore at [C:\\\\Program Files\\\\ArcGIS\\\\Server\\\\framework\\\\runtime\\\\jre\\\\lib\\\\security\\\\cacerts].\n\nThe password for the keystore is \"changeit\".\n\nRemove any non-DoD-approved certificates.\n\nLog on to the machine hosting ArcGIS Server. Open Certificate Manager. (You can do this by clicking the \"Start\" button, then typing \"certmgr.msc\" into the \"Search\" box, and pressing the \"ENTER\" key.)\n\nIn the \"Certificate Manager\" window, click \"Trusted Root Certificate Authorities\", then click \"Certificates\".\n\nRemove any non-DoD-approved certificates.\n\nUse a Java-compatible tool to access the Java Keystore at [C:\\\\arcgisserver\\\\config-store\\\\machines\\\\machine_name\\\\arcgis.keystore].\n\nThe password is the value of the \"password\" field within the [C:\\\\arcgisserver\\\\config-store\\\\security\\\\super\\\\super.json] file.\n\nRemove any non-DoD-approved certificates.'\n  impact 0.7\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40558r642834_chk'\n  tag severity: 'high'\n  tag gid: 'V-237339'\n  tag rid: 'SV-237339r879798_rule'\n  tag stig_id: 'AGIS-00-000194'\n  tag gtitle: 'SRG-APP-000427'\n  tag fix_id: 'F-40521r642835_fix'\n  tag 'documentable'\n  tag legacy: ['SV-80009', 'V-65519']\n  tag cci: ['CCI-002470']\n  tag nist: ['SC-23 (5)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237339.rb"},"title":"The ArcGIS Server keystores must only contain certificates of PKI established certificate authorities for verification of protected sessions.","desc":"Untrusted Certificate Authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DoD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DoD-approved CA, trust of this CA has not been established.\n\nThe DoD will only accept PKI certificates obtained from a DoD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of SSL/TLS certificates. \n\nThis requirement focuses on communications protection for the application session rather than for the network packet.\n\nThis requirement applies to applications that utilize communications sessions. This includes, but is not limited to, web-based applications and Service-Oriented Architectures (SOA).","descriptions":{"default":"Untrusted Certificate Authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DoD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DoD-approved CA, trust of this CA has not been established.\n\nThe DoD will only accept PKI certificates obtained from a DoD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of SSL/TLS certificates. \n\nThis requirement focuses on communications protection for the application session rather than for the network packet.\n\nThis requirement applies to applications that utilize communications sessions. This includes, but is not limited to, web-based applications and Service-Oriented Architectures (SOA).","check":"Review the ArcGIS Server configuration to ensure the application only allows the use of DoD PKI established certificate authorities for verification of the establishment of protected sessions. Substitute the target environment’s values for [bracketed] variables.\n\n1. Use a Java-compatible tool to access the java keystore at [C:\\Program Files\\ArcGIS\\Server\\framework\\runtime\\jre\\lib\\security\\cacerts].\n\nThe password for the keystore is \"changeit\".\n\nVerify that the Java Keystore [C:\\Program Files\\ArcGIS\\Server\\framework\\runtime\\jre\\lib\\security\\cacerts] does not contain any non-DoD-approved certificates. \n\nIf any non-DoD-approved certificate authorities are listed as trusted, this is a finding.\n\n2. Log on to the machine hosting ArcGIS Server. Open Certificate Manager. (You can do this by clicking the \"Start\" button, typing \"certmgr.msc\" into the \"Search\" box, and pressing the \"ENTER\" key.)\n\nIn the \"Certificate Manager\" window, click \"Trusted Root Certificate Authorities\", then click\" Certificates\".\n\nVerify that the Windows Keystore does not contain any non-DoD-approved certificates.\n\nIf any non-DoD-approved certificate authorities are listed as trusted, this is a finding.\n\n3. Use a Java-compatible tool to access the Java Keystore at [C:\\arcgisserver\\config-store\\machines\\machine_name\\arcgis.keystore].\n\nThe password is the value of the \"password\" field within the [C:\\arcgisserver\\config-store\\security\\super\\super.json] file.\n\nVerify that the Java Keystore [C:\\arcgisserver\\config-store\\machines\\machine_name\\arcgis.keystore] does not contain any non-DoD-approved certificates. \n\nIf any non-DoD-approved certificate authorities are listed as trusted, this is a finding.","fix":"Configure the ArcGIS Server to only allow the use of DoD PKI established certificate authorities for verification of the establishment of protected sessions. Substitute the target environment’s values for [bracketed] variables.\n\nUse a Java-compatible tool to access the Java keystore at [C:\\Program Files\\ArcGIS\\Server\\framework\\runtime\\jre\\lib\\security\\cacerts].\n\nThe password for the keystore is \"changeit\".\n\nRemove any non-DoD-approved certificates.\n\nLog on to the machine hosting ArcGIS Server. Open Certificate Manager. (You can do this by clicking the \"Start\" button, then typing \"certmgr.msc\" into the \"Search\" box, and pressing the \"ENTER\" key.)\n\nIn the \"Certificate Manager\" window, click \"Trusted Root Certificate Authorities\", then click \"Certificates\".\n\nRemove any non-DoD-approved certificates.\n\nUse a Java-compatible tool to access the Java Keystore at [C:\\arcgisserver\\config-store\\machines\\machine_name\\arcgis.keystore].\n\nThe password is the value of the \"password\" field within the [C:\\arcgisserver\\config-store\\security\\super\\super.json] file.\n\nRemove any non-DoD-approved certificates."},"impact":0.7,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40558r642834_chk","severity":"high","gid":"V-237339","rid":"SV-237339r879798_rule","stig_id":"AGIS-00-000194","gtitle":"SRG-APP-000427","fix_id":"F-40521r642835_fix","documentable":null,"legacy":["SV-80009","V-65519"],"cci":["CCI-002470"],"nist":["SC-23 (5)"]}},{"id":"SV-237340","code":"control 'SV-237340' do\n  title 'The ArcGIS Server must maintain a separate execution domain for each executing process.'\n  desc 'Applications can maintain separate execution domains for each executing process by assigning each process a separate address space. Each process has a distinct address space so that communication between processes is performed in a manner controlled through the security functions, and one process cannot modify the executing code of another process. Maintaining separate execution domains for executing processes can be achieved, for example, by implementing separate address spaces.\n\nAn example is a web browser with process isolation that provides tabs that are separate processes using separate address spaces to prevent one tab crashing the entire browser.'\n  desc 'check', 'Review the ArcGIS Server configuration to ensure all published services maintain a separate execution domain for each process. Substitute the target environment’s values for [bracketed] variables. \n\nIn PowerShell, run the following command, replacing the [bracketed] values with the path of the ArcGIS Server Site \"config-store\":\n\nGet-ChildItem -recurse [C:\\\\arcgisserver\\\\]config-store\\\\services\\\\*.json | Select-String -pattern \"`\"isolationLevel`\": `\"LOW`\"\"\n\nIf any values are returned, this is a finding.'\n  desc 'fix', 'Configure the ArcGIS Server to ensure all published services maintain a separate execution domain for each process. Substitute the target environment’s values for [bracketed] variables. \n\nIn PowerShell, run the following command, replacing the [bracketed] values with the path of the ArcGIS Server Site \"config-store\":\n\nGet-ChildItem -recurse [C:\\\\arcgisserver\\\\]config-store\\\\services\\\\*.json | Select-String -pattern \"`\"isolationLevel`\": `\"LOW`\"\"\n\nStop ArcGIS Server, then replace the \"LOW\" with \"HIGH\" in all found files.'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40559r642837_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237340'\n  tag rid: 'SV-237340r879802_rule'\n  tag stig_id: 'AGIS-00-000197'\n  tag gtitle: 'SRG-APP-000431'\n  tag fix_id: 'F-40522r642838_fix'\n  tag 'documentable'\n  tag legacy: ['SV-80011', 'V-65521']\n  tag cci: ['CCI-002530']\n  tag nist: ['SC-39']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237340.rb"},"title":"The ArcGIS Server must maintain a separate execution domain for each executing process.","desc":"Applications can maintain separate execution domains for each executing process by assigning each process a separate address space. Each process has a distinct address space so that communication between processes is performed in a manner controlled through the security functions, and one process cannot modify the executing code of another process. Maintaining separate execution domains for executing processes can be achieved, for example, by implementing separate address spaces.\n\nAn example is a web browser with process isolation that provides tabs that are separate processes using separate address spaces to prevent one tab crashing the entire browser.","descriptions":{"default":"Applications can maintain separate execution domains for each executing process by assigning each process a separate address space. Each process has a distinct address space so that communication between processes is performed in a manner controlled through the security functions, and one process cannot modify the executing code of another process. Maintaining separate execution domains for executing processes can be achieved, for example, by implementing separate address spaces.\n\nAn example is a web browser with process isolation that provides tabs that are separate processes using separate address spaces to prevent one tab crashing the entire browser.","check":"Review the ArcGIS Server configuration to ensure all published services maintain a separate execution domain for each process. Substitute the target environment’s values for [bracketed] variables. \n\nIn PowerShell, run the following command, replacing the [bracketed] values with the path of the ArcGIS Server Site \"config-store\":\n\nGet-ChildItem -recurse [C:\\arcgisserver\\]config-store\\services\\*.json | Select-String -pattern \"`\"isolationLevel`\": `\"LOW`\"\"\n\nIf any values are returned, this is a finding.","fix":"Configure the ArcGIS Server to ensure all published services maintain a separate execution domain for each process. Substitute the target environment’s values for [bracketed] variables. \n\nIn PowerShell, run the following command, replacing the [bracketed] values with the path of the ArcGIS Server Site \"config-store\":\n\nGet-ChildItem -recurse [C:\\arcgisserver\\]config-store\\services\\*.json | Select-String -pattern \"`\"isolationLevel`\": `\"LOW`\"\"\n\nStop ArcGIS Server, then replace the \"LOW\" with \"HIGH\" in all found files."},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40559r642837_chk","severity":"medium","gid":"V-237340","rid":"SV-237340r879802_rule","stig_id":"AGIS-00-000197","gtitle":"SRG-APP-000431","fix_id":"F-40522r642838_fix","documentable":null,"legacy":["SV-80011","V-65521"],"cci":["CCI-002530"],"nist":["SC-39"]}},{"id":"SV-237341","code":"control 'SV-237341' do\n  title 'The ArcGIS Server must be configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.'\n  desc 'Configuring the application to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements. \n\nConfiguration settings are the set of parameters that can be changed that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the application, including the parameters required to satisfy other security control requirements.'\n  desc 'check', 'Review the ArcGIS Server configuration to ensure it is deployed onto a Windows 2008 R2 or Windows 2012 R2 Active Directory Member server upon which the Windows Server 2012/2012 R2 Member Server Security Technical Implementation Guide or Windows Server 2008 R2 Member Server Security Technical Implementation Guide has been applied (respectively).\n\nIf the server on which ArcGIS Server is deployed is not a Windows 2008 R2 or Windows 2012 R2 Active Directory member server which has the Windows Server 2012/2012 R2 Member Server Security Technical Implementation Guide or Windows Server 2008 R2 Member Server Security Technical Implementation Guide has been applied (respectively), this is a finding.'\n  desc 'fix', 'Deploy ArcGIS Server onto a Windows 2008 R2 or Windows 2012 R2 Active Directory Member server that aligns to the Windows Server 2012/2012 R2 Member Server Security Technical Implementation Guide or Windows Server 2008 R2 Member Server Security Technical Implementation Guide (respectively).'\n  impact 0.5\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-40560r642840_chk'\n  tag severity: 'medium'\n  tag gid: 'V-237341'\n  tag rid: 'SV-237341r879887_rule'\n  tag stig_id: 'AGIS-00-000247'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-40523r642841_fix'\n  tag 'documentable'\n  tag legacy: ['SV-80059', 'V-65569']\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-237341.rb"},"title":"The ArcGIS Server must be configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.","desc":"Configuring the application to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements. \n\nConfiguration settings are the set of parameters that can be changed that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the application, including the parameters required to satisfy other security control requirements.","descriptions":{"default":"Configuring the application to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements. \n\nConfiguration settings are the set of parameters that can be changed that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the application, including the parameters required to satisfy other security control requirements.","check":"Review the ArcGIS Server configuration to ensure it is deployed onto a Windows 2008 R2 or Windows 2012 R2 Active Directory Member server upon which the Windows Server 2012/2012 R2 Member Server Security Technical Implementation Guide or Windows Server 2008 R2 Member Server Security Technical Implementation Guide has been applied (respectively).\n\nIf the server on which ArcGIS Server is deployed is not a Windows 2008 R2 or Windows 2012 R2 Active Directory member server which has the Windows Server 2012/2012 R2 Member Server Security Technical Implementation Guide or Windows Server 2008 R2 Member Server Security Technical Implementation Guide has been applied (respectively), this is a finding.","fix":"Deploy ArcGIS Server onto a Windows 2008 R2 or Windows 2012 R2 Active Directory Member server that aligns to the Windows Server 2012/2012 R2 Member Server Security Technical Implementation Guide or Windows Server 2008 R2 Member Server Security Technical Implementation Guide (respectively)."},"impact":0.5,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-40560r642840_chk","severity":"medium","gid":"V-237341","rid":"SV-237341r879887_rule","stig_id":"AGIS-00-000247","gtitle":"SRG-APP-000516","fix_id":"F-40523r642841_fix","documentable":null,"legacy":["SV-80059","V-65569"],"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257297","code":"control 'SV-257297' do\n  title 'The version of ArcGIS running on the system must be a supported version.'\n  desc 'Security flaws with software applications are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.\n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).\n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and also to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).'\n  desc 'check', 'ArcGIS 10.3 is no longer supported by the vendor. If the server is running ArcGIS 10.3, this is a finding.'\n  desc 'fix', 'Upgrade to a supported version.'\n  impact 0.7\n  ref 'DPMS Target ArcGIS for Server 10-3'\n  tag check_id: 'C-60984r919428_chk'\n  tag severity: 'high'\n  tag gid: 'V-257297'\n  tag rid: 'SV-257297r919430_rule'\n  tag stig_id: 'AGIS-00-000999'\n  tag gtitle: 'SRG-APP-000456'\n  tag fix_id: 'F-53958r798705_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002605']\n  tag nist: ['SI-2 c']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_ArcGIS_Server_10-3_STIG_V2R1/controls/SV-257297.rb"},"title":"The version of ArcGIS running on the system must be a supported version.","desc":"Security flaws with software applications are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.\n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).\n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and also to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).","descriptions":{"default":"Security flaws with software applications are discovered daily. Vendors are constantly updating and patching their products to address newly discovered security vulnerabilities. Organizations (including any contractor to the organization) are required to promptly install security-relevant software updates (e.g., patches, service packs, and hot fixes). Flaws discovered during security assessments, continuous monitoring, incident response activities, or information system error handling must also be addressed expeditiously.\n\nOrganization-defined time periods for updating security-relevant software may vary based on a variety of factors including, for example, the security category of the information system or the criticality of the update (i.e., severity of the vulnerability related to the discovered flaw).\n\nThis requirement will apply to software patch management solutions that are used to install patches across the enclave and also to applications themselves that are not part of that patch management solution. For example, many browsers today provide the capability to install their own patch software. Patch criticality, as well as system criticality will vary. Therefore, the tactical situations regarding the patch management process will also vary. This means that the time period used must be a configurable parameter. Time frames for application of security-relevant software updates may be dependent upon the Information Assurance Vulnerability Management (IAVM) process.\n\nThe application will be configured to check for and install security-relevant software updates within an identified time period from the availability of the update. The specific time period will be defined by an authoritative source (e.g., IAVM, CTOs, DTMs, and STIGs).","check":"ArcGIS 10.3 is no longer supported by the vendor. If the server is running ArcGIS 10.3, this is a finding.","fix":"Upgrade to a supported version."},"impact":0.7,"refs":[{"ref":"DPMS Target ArcGIS for Server 10-3"}],"tags":{"check_id":"C-60984r919428_chk","severity":"high","gid":"V-257297","rid":"SV-257297r919430_rule","stig_id":"AGIS-00-000999","gtitle":"SRG-APP-000456","fix_id":"F-53958r798705_fix","documentable":null,"cci":["CCI-002605"],"nist":["SI-2 c"]}}],"groups":[{"id":"controls/SV-237320.rb","title":null,"controls":["SV-237320"]},{"id":"controls/SV-237321.rb","title":null,"controls":["SV-237321"]},{"id":"controls/SV-237322.rb","title":null,"controls":["SV-237322"]},{"id":"controls/SV-237323.rb","title":null,"controls":["SV-237323"]},{"id":"controls/SV-237324.rb","title":null,"controls":["SV-237324"]},{"id":"controls/SV-237325.rb","title":null,"controls":["SV-237325"]},{"id":"controls/SV-237326.rb","title":null,"controls":["SV-237326"]},{"id":"controls/SV-237327.rb","title":null,"controls":["SV-237327"]},{"id":"controls/SV-237328.rb","title":null,"controls":["SV-237328"]},{"id":"controls/SV-237329.rb","title":null,"controls":["SV-237329"]},{"id":"controls/SV-237330.rb","title":null,"controls":["SV-237330"]},{"id":"controls/SV-237331.rb","title":null,"controls":["SV-237331"]},{"id":"controls/SV-237332.rb","title":null,"controls":["SV-237332"]},{"id":"controls/SV-237333.rb","title":null,"controls":["SV-237333"]},{"id":"controls/SV-237334.rb","title":null,"controls":["SV-237334"]},{"id":"controls/SV-237335.rb","title":null,"controls":["SV-237335"]},{"id":"controls/SV-237336.rb","title":null,"controls":["SV-237336"]},{"id":"controls/SV-237337.rb","title":null,"controls":["SV-237337"]},{"id":"controls/SV-237338.rb","title":null,"controls":["SV-237338"]},{"id":"controls/SV-237339.rb","title":null,"controls":["SV-237339"]},{"id":"controls/SV-237340.rb","title":null,"controls":["SV-237340"]},{"id":"controls/SV-237341.rb","title":null,"controls":["SV-237341"]},{"id":"controls/SV-257297.rb","title":null,"controls":["SV-257297"]}],"name":"ArcGIS_Server_10-3_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"c022b92d130d0ad3262445ab0627fc462c21f2185770408d0b913af4ad22e1b1","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
