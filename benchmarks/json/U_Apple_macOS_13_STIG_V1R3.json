{"controls":[{"id":"SV-257142","code":"control 'SV-257142' do\n  title 'The macOS system must be configured to prevent Apple Watch from terminating a session lock.'\n  desc \"Users must be prompted to enter their passwords when unlocking the screen saver. The screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.\"\n  desc 'check', 'Verify the macOS system is configured to prevent Apple Watch from terminating a session lock with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowAutoUnlock\"\n\nallowAutoUnlock = 0;\n\nIf there is no result or \"allowAutoUnlock\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to prevent Apple Watch from terminating a session lock by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60827r905057_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257142'\n  tag rid: 'SV-257142r905059_rule'\n  tag stig_id: 'APPL-13-000001'\n  tag gtitle: 'SRG-OS-000028-GPOS-00009'\n  tag fix_id: 'F-60768r905058_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000056']\n  tag nist: ['AC-11 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257142.rb"},"title":"The macOS system must be configured to prevent Apple Watch from terminating a session lock.","desc":"Users must be prompted to enter their passwords when unlocking the screen saver. The screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.","descriptions":{"default":"Users must be prompted to enter their passwords when unlocking the screen saver. The screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.","check":"Verify the macOS system is configured to prevent Apple Watch from terminating a session lock with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowAutoUnlock\"\n\nallowAutoUnlock = 0;\n\nIf there is no result or \"allowAutoUnlock\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to prevent Apple Watch from terminating a session lock by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60827r905057_chk","severity":"medium","gid":"V-257142","rid":"SV-257142r905059_rule","stig_id":"APPL-13-000001","gtitle":"SRG-OS-000028-GPOS-00009","fix_id":"F-60768r905058_fix","documentable":null,"cci":["CCI-000056"],"nist":["AC-11 b"]}},{"id":"SV-257143","code":"control 'SV-257143' do\n  title 'The macOS system must retain the session lock until the user reestablishes access using established identification and authentication procedures.'\n  desc \"Users must be prompted to enter their passwords when unlocking the screen saver. The screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.\"\n  desc 'check', 'Verify the macOS system is configured to prompt users to enter a password to unlock the screen saver with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -w \"askForPassword\"\n\naskForPassword = 1;\n\nIf there is no result, or if \"askForPassword\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to prompt users to enter a password to unlock the screen saver by installing the \"Login Window Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60828r905060_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257143'\n  tag rid: 'SV-257143r905062_rule'\n  tag stig_id: 'APPL-13-000002'\n  tag gtitle: 'SRG-OS-000028-GPOS-00009'\n  tag fix_id: 'F-60769r905061_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000056']\n  tag nist: ['AC-11 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257143.rb"},"title":"The macOS system must retain the session lock until the user reestablishes access using established identification and authentication procedures.","desc":"Users must be prompted to enter their passwords when unlocking the screen saver. The screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.","descriptions":{"default":"Users must be prompted to enter their passwords when unlocking the screen saver. The screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.","check":"Verify the macOS system is configured to prompt users to enter a password to unlock the screen saver with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -w \"askForPassword\"\n\naskForPassword = 1;\n\nIf there is no result, or if \"askForPassword\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to prompt users to enter a password to unlock the screen saver by installing the \"Login Window Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60828r905060_chk","severity":"medium","gid":"V-257143","rid":"SV-257143r905062_rule","stig_id":"APPL-13-000002","gtitle":"SRG-OS-000028-GPOS-00009","fix_id":"F-60769r905061_fix","documentable":null,"cci":["CCI-000056"],"nist":["AC-11 b"]}},{"id":"SV-257144","code":"control 'SV-257144' do\n  title 'The macOS system must initiate the session lock no more than five seconds after a screen saver is started.'\n  desc 'A screen saver must be enabled and set to require a password to unlock. An excessive grace period impacts the ability for a session to be truly locked, requiring authentication to unlock.'\n  desc 'check', 'Verify the macOS system is configured to initiate a session lock within five seconds of the screen saver starting with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"askForPasswordDelay\"\n\naskForPasswordDelay = 5;\n\nIf there is no result, or if \"askForPasswordDelay\" is not set to \"5\" or less, this is a finding.'\n  desc 'fix', 'Configure the macOS system to initiate a session lock within five seconds of the screen saver starting by installing the \"Login Window Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60829r905063_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257144'\n  tag rid: 'SV-257144r905065_rule'\n  tag stig_id: 'APPL-13-000003'\n  tag gtitle: 'SRG-OS-000028-GPOS-00009'\n  tag fix_id: 'F-60770r905064_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000056']\n  tag nist: ['AC-11 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257144.rb"},"title":"The macOS system must initiate the session lock no more than five seconds after a screen saver is started.","desc":"A screen saver must be enabled and set to require a password to unlock. An excessive grace period impacts the ability for a session to be truly locked, requiring authentication to unlock.","descriptions":{"default":"A screen saver must be enabled and set to require a password to unlock. An excessive grace period impacts the ability for a session to be truly locked, requiring authentication to unlock.","check":"Verify the macOS system is configured to initiate a session lock within five seconds of the screen saver starting with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"askForPasswordDelay\"\n\naskForPasswordDelay = 5;\n\nIf there is no result, or if \"askForPasswordDelay\" is not set to \"5\" or less, this is a finding.","fix":"Configure the macOS system to initiate a session lock within five seconds of the screen saver starting by installing the \"Login Window Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60829r905063_chk","severity":"medium","gid":"V-257144","rid":"SV-257144r905065_rule","stig_id":"APPL-13-000003","gtitle":"SRG-OS-000028-GPOS-00009","fix_id":"F-60770r905064_fix","documentable":null,"cci":["CCI-000056"],"nist":["AC-11 b"]}},{"id":"SV-257145","code":"control 'SV-257145' do\n  title 'The macOS system must initiate a session lock after a 15-minute period of inactivity.'\n  desc \"A screen saver must be enabled and set to require a password to unlock. The timeout must be set to 15 minutes of inactivity. This mitigates the risk that a user might forget to manually lock the screen before stepping away from the computer.\n\nA session timeout lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock.\"\n  desc 'check', 'Verify the macOS system is configured to initiate the screen saver after 15 minutes of inactivity with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"loginWindowIdleTime\"\n\nloginWindowIdleTime = 900;\n\nIf there is no result, or if \"idleTime\" is not set to \"900\" seconds or less, this is a finding.'\n  desc 'fix', 'Configure the macOS system to initiate the screen saver after 15 minutes of inactivity by installing the \"Login Window Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60830r905066_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257145'\n  tag rid: 'SV-257145r905068_rule'\n  tag stig_id: 'APPL-13-000004'\n  tag gtitle: 'SRG-OS-000029-GPOS-00010'\n  tag fix_id: 'F-60771r905067_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000057']\n  tag nist: ['AC-11 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257145.rb"},"title":"The macOS system must initiate a session lock after a 15-minute period of inactivity.","desc":"A screen saver must be enabled and set to require a password to unlock. The timeout must be set to 15 minutes of inactivity. This mitigates the risk that a user might forget to manually lock the screen before stepping away from the computer.\n\nA session timeout lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock.","descriptions":{"default":"A screen saver must be enabled and set to require a password to unlock. The timeout must be set to 15 minutes of inactivity. This mitigates the risk that a user might forget to manually lock the screen before stepping away from the computer.\n\nA session timeout lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence. Rather than relying on the user to manually lock their operating system session prior to vacating the vicinity, operating systems need to be able to identify when a user's session has idled and take action to initiate the session lock.","check":"Verify the macOS system is configured to initiate the screen saver after 15 minutes of inactivity with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"loginWindowIdleTime\"\n\nloginWindowIdleTime = 900;\n\nIf there is no result, or if \"idleTime\" is not set to \"900\" seconds or less, this is a finding.","fix":"Configure the macOS system to initiate the screen saver after 15 minutes of inactivity by installing the \"Login Window Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60830r905066_chk","severity":"medium","gid":"V-257145","rid":"SV-257145r905068_rule","stig_id":"APPL-13-000004","gtitle":"SRG-OS-000029-GPOS-00010","fix_id":"F-60771r905067_fix","documentable":null,"cci":["CCI-000057"],"nist":["AC-11 a"]}},{"id":"SV-257146","code":"control 'SV-257146' do\n  title 'The macOS system must be configured to lock the user session when a smart token is removed.'\n  desc 'A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not want to log out because of the temporary nature of the absence.\n\nThe session lock is implemented at the point where session activity can be determined. Rather than be forced to wait for a period of time to expire before the user session can be locked, operating systems must provide users with the ability to manually invoke a session lock so users may secure their session should they need to temporarily vacate the immediate physical vicinity.'\n  desc 'check', 'Verify the macOS system is configured to lock the user session when a smart token is removed with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"tokenRemovalAction\"\n\ntokenRemovalAction = 1;\n\nIf there is no result, or if \"tokenRemovalAction\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to lock the user session when a smart token is removed by installing the \"Smart Card Policy\" configuration profile.\n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the \"Smart Card Policy\".'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60831r905069_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257146'\n  tag rid: 'SV-257146r905071_rule'\n  tag stig_id: 'APPL-13-000005'\n  tag gtitle: 'SRG-OS-000030-GPOS-00011'\n  tag fix_id: 'F-60772r905070_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000058']\n  tag nist: ['AC-11 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257146.rb"},"title":"The macOS system must be configured to lock the user session when a smart token is removed.","desc":"A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not want to log out because of the temporary nature of the absence.\n\nThe session lock is implemented at the point where session activity can be determined. Rather than be forced to wait for a period of time to expire before the user session can be locked, operating systems must provide users with the ability to manually invoke a session lock so users may secure their session should they need to temporarily vacate the immediate physical vicinity.","descriptions":{"default":"A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not want to log out because of the temporary nature of the absence.\n\nThe session lock is implemented at the point where session activity can be determined. Rather than be forced to wait for a period of time to expire before the user session can be locked, operating systems must provide users with the ability to manually invoke a session lock so users may secure their session should they need to temporarily vacate the immediate physical vicinity.","check":"Verify the macOS system is configured to lock the user session when a smart token is removed with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"tokenRemovalAction\"\n\ntokenRemovalAction = 1;\n\nIf there is no result, or if \"tokenRemovalAction\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to lock the user session when a smart token is removed by installing the \"Smart Card Policy\" configuration profile.\n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the \"Smart Card Policy\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60831r905069_chk","severity":"medium","gid":"V-257146","rid":"SV-257146r905071_rule","stig_id":"APPL-13-000005","gtitle":"SRG-OS-000030-GPOS-00011","fix_id":"F-60772r905070_fix","documentable":null,"cci":["CCI-000058"],"nist":["AC-11 a"]}},{"id":"SV-257147","code":"control 'SV-257147' do\n  title 'The macOS system must conceal, via the session lock, information previously visible on the display with a publicly viewable image.'\n  desc 'A default screen saver must be configured for all users, as the screen saver will act as a session timeout lock for the system and must conceal the contents of the screen from unauthorized users. The screen saver must not display any sensitive information or reveal the contents of the locked session screen. Publicly viewable images can include static or dynamic images such as patterns used with screen savers, photographic images, solid colors, a clock, a battery life indicator, or a blank screen.'\n  desc 'check', 'Verify the macOS system is configured with a screen saver with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"moduleName\"\n\nmoduleName = Ventura;\n\nIf there is no result or the \"moduleName\" is undefined, this is a finding.'\n  desc 'fix', 'Configure the macOS system with a screen saver by installing the \"Login Window Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60832r905072_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257147'\n  tag rid: 'SV-257147r905074_rule'\n  tag stig_id: 'APPL-13-000006'\n  tag gtitle: 'SRG-OS-000031-GPOS-00012'\n  tag fix_id: 'F-60773r905073_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000060']\n  tag nist: ['AC-11 (1)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257147.rb"},"title":"The macOS system must conceal, via the session lock, information previously visible on the display with a publicly viewable image.","desc":"A default screen saver must be configured for all users, as the screen saver will act as a session timeout lock for the system and must conceal the contents of the screen from unauthorized users. The screen saver must not display any sensitive information or reveal the contents of the locked session screen. Publicly viewable images can include static or dynamic images such as patterns used with screen savers, photographic images, solid colors, a clock, a battery life indicator, or a blank screen.","descriptions":{"default":"A default screen saver must be configured for all users, as the screen saver will act as a session timeout lock for the system and must conceal the contents of the screen from unauthorized users. The screen saver must not display any sensitive information or reveal the contents of the locked session screen. Publicly viewable images can include static or dynamic images such as patterns used with screen savers, photographic images, solid colors, a clock, a battery life indicator, or a blank screen.","check":"Verify the macOS system is configured with a screen saver with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"moduleName\"\n\nmoduleName = Ventura;\n\nIf there is no result or the \"moduleName\" is undefined, this is a finding.","fix":"Configure the macOS system with a screen saver by installing the \"Login Window Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60832r905072_chk","severity":"medium","gid":"V-257147","rid":"SV-257147r905074_rule","stig_id":"APPL-13-000006","gtitle":"SRG-OS-000031-GPOS-00012","fix_id":"F-60773r905073_fix","documentable":null,"cci":["CCI-000060"],"nist":["AC-11 (1)"]}},{"id":"SV-257148","code":"control 'SV-257148' do\n  title 'The macOS system must be configured to disable hot corners.'\n  desc 'Although hot corners can be used to initiate a session lock or launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.'\n  desc 'check', 'Verify the macOS system is configured to disable hot corners with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"wvous\"\n\n\"wvous-bl-corner\" = 0;\n\"wvous-br-corner\" = 0;\n\"wvous-tl-corner\" = 0;\n\"wvous-tr-corner\" = 0;\n\nIf the command does not return the following, this is a finding.\n\n\"wvous-bl-corner = 0;\nwvous-br-corner = 0;\nwvous-tl-corner = 0;\nwvous-tr-corner = 0;\"'\n  desc 'fix', 'Configure the macOS system to disable hot corners by installing the \"Custom Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60833r905075_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257148'\n  tag rid: 'SV-257148r905077_rule'\n  tag stig_id: 'APPL-13-000007'\n  tag gtitle: 'SRG-OS-000031-GPOS-00012'\n  tag fix_id: 'F-60774r905076_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000060']\n  tag nist: ['AC-11 (1)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257148.rb"},"title":"The macOS system must be configured to disable hot corners.","desc":"Although hot corners can be used to initiate a session lock or launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.","descriptions":{"default":"Although hot corners can be used to initiate a session lock or launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.","check":"Verify the macOS system is configured to disable hot corners with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"wvous\"\n\n\"wvous-bl-corner\" = 0;\n\"wvous-br-corner\" = 0;\n\"wvous-tl-corner\" = 0;\n\"wvous-tr-corner\" = 0;\n\nIf the command does not return the following, this is a finding.\n\n\"wvous-bl-corner = 0;\nwvous-br-corner = 0;\nwvous-tl-corner = 0;\nwvous-tr-corner = 0;\"","fix":"Configure the macOS system to disable hot corners by installing the \"Custom Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60833r905075_chk","severity":"medium","gid":"V-257148","rid":"SV-257148r905077_rule","stig_id":"APPL-13-000007","gtitle":"SRG-OS-000031-GPOS-00012","fix_id":"F-60774r905076_fix","documentable":null,"cci":["CCI-000060"],"nist":["AC-11 (1)"]}},{"id":"SV-257150","code":"control 'SV-257150' do\n  title 'The macOS system must automatically remove or disable temporary and emergency user accounts after 72 hours.'\n  desc 'If temporary user accounts remain active when no longer needed or for an excessive period, these accounts may be targeted by attackers to gain unauthorized access. To mitigate this risk, automated termination of all temporary accounts must be set upon account creation.\n\nTemporary accounts are established as part of normal account activation procedures when there is a need for short-term accounts without the demand for immediacy in account activation.\n\nIf temporary accounts are used, the operating system must be configured to automatically terminate these types of accounts after a DOD-defined time period of 72 hours.\n\nEmergency administrator accounts are privileged accounts established in response to crisis situations where the need for rapid account activation is required. Therefore, emergency account activation may bypass normal account authorization processes. If these accounts are automatically disabled, system maintenance during emergencies may not be possible, thus adversely affecting system availability.\n\nEmergency administrator accounts are different from infrequently used accounts (i.e., local logon accounts used by system administrators when network or normal logon/access is not available). Infrequently used accounts also remain available and are not subject to automatic termination dates. However, an emergency administrator account is normally a different account created for use by vendors or system maintainers.\n\nTo address access requirements, many operating systems may be integrated with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements.\n\n'\n  desc 'check', 'Verify the macOS system is configured with a policy via directory service to disable temporary or emergency accounts after 72 hours by asking the System Administrator (SA) or Information System Security Officer (ISSO).\n\nIf a policy is not set by a directory service, a password policy must be set with the \"pwpolicy\" utility. The variable names may differ depending on how the policy was set.\n\nIf temporary or emergency accounts are not defined on the macOS system, this is not applicable.\n\nVerify the macOS system is configured with a policy to disable temporary or emergency accounts after 72 hours with the following command:\n\n/usr/bin/sudo /usr/bin/pwpolicy -u username getaccountpolicies | tail -n +2\n\nIf there is no output and password policy is not controlled by a directory service, this is a finding.\n\nOtherwise, look for the line \"<key>policyCategoryAuthentication</key>\".\n\nIn the array that follows, a <dict> section contains a check <string> that allows users to log in if \"policyAttributeCurrentTime\" is less than the result of adding \"policyAttributeCreationTime\" to 72 hours (259299 seconds). The check might use a variable defined in its \"policyParameters\" section.\n\nIf the check does not exist or if the check adds more than 72 hours to \"policyAttributeCreationTime\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable temporary or emergency accounts after 72 hours. This setting may be enforced using local policy or by a directory service.\n\nTo set local policy to disable a temporary or emergency user, create a plain text file containing the following:\n\n   <dict>\n     <key>policyCategoryAuthentication</key>\n     <array>\n       <dict>\n         <key>policyContent</key>\n         <string>policyAttributeCurrentTime &lt; policyAttributeCreationTime+259299</string>\n         <key>policyIdentifier</key>\n         <string>Disable Tmp Accounts </string>\n       </dict>\n     </array>\n   </dict>\n\nAfter saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the correct user name in place of \"username\" and the path to the file in place of \"/path/to/file\".\n\n/usr/bin/sudo /usr/bin/pwpolicy -u username setaccountpolicies /path/to/file'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60835r905081_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257150'\n  tag rid: 'SV-257150r905083_rule'\n  tag stig_id: 'APPL-13-000012'\n  tag gtitle: 'SRG-OS-000002-GPOS-00002'\n  tag fix_id: 'F-60776r905082_fix'\n  tag satisfies: ['SRG-OS-000002-GPOS-00002', 'SRG-OS-000123-GPOS-00064']\n  tag 'documentable'\n  tag cci: ['CCI-000016', 'CCI-001682']\n  tag nist: ['AC-2 (2)', 'AC-2 (2)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257150.rb"},"title":"The macOS system must automatically remove or disable temporary and emergency user accounts after 72 hours.","desc":"If temporary user accounts remain active when no longer needed or for an excessive period, these accounts may be targeted by attackers to gain unauthorized access. To mitigate this risk, automated termination of all temporary accounts must be set upon account creation.\n\nTemporary accounts are established as part of normal account activation procedures when there is a need for short-term accounts without the demand for immediacy in account activation.\n\nIf temporary accounts are used, the operating system must be configured to automatically terminate these types of accounts after a DOD-defined time period of 72 hours.\n\nEmergency administrator accounts are privileged accounts established in response to crisis situations where the need for rapid account activation is required. Therefore, emergency account activation may bypass normal account authorization processes. If these accounts are automatically disabled, system maintenance during emergencies may not be possible, thus adversely affecting system availability.\n\nEmergency administrator accounts are different from infrequently used accounts (i.e., local logon accounts used by system administrators when network or normal logon/access is not available). Infrequently used accounts also remain available and are not subject to automatic termination dates. However, an emergency administrator account is normally a different account created for use by vendors or system maintainers.\n\nTo address access requirements, many operating systems may be integrated with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements.\n\n","descriptions":{"default":"If temporary user accounts remain active when no longer needed or for an excessive period, these accounts may be targeted by attackers to gain unauthorized access. To mitigate this risk, automated termination of all temporary accounts must be set upon account creation.\n\nTemporary accounts are established as part of normal account activation procedures when there is a need for short-term accounts without the demand for immediacy in account activation.\n\nIf temporary accounts are used, the operating system must be configured to automatically terminate these types of accounts after a DOD-defined time period of 72 hours.\n\nEmergency administrator accounts are privileged accounts established in response to crisis situations where the need for rapid account activation is required. Therefore, emergency account activation may bypass normal account authorization processes. If these accounts are automatically disabled, system maintenance during emergencies may not be possible, thus adversely affecting system availability.\n\nEmergency administrator accounts are different from infrequently used accounts (i.e., local logon accounts used by system administrators when network or normal logon/access is not available). Infrequently used accounts also remain available and are not subject to automatic termination dates. However, an emergency administrator account is normally a different account created for use by vendors or system maintainers.\n\nTo address access requirements, many operating systems may be integrated with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements.\n\n","check":"Verify the macOS system is configured with a policy via directory service to disable temporary or emergency accounts after 72 hours by asking the System Administrator (SA) or Information System Security Officer (ISSO).\n\nIf a policy is not set by a directory service, a password policy must be set with the \"pwpolicy\" utility. The variable names may differ depending on how the policy was set.\n\nIf temporary or emergency accounts are not defined on the macOS system, this is not applicable.\n\nVerify the macOS system is configured with a policy to disable temporary or emergency accounts after 72 hours with the following command:\n\n/usr/bin/sudo /usr/bin/pwpolicy -u username getaccountpolicies | tail -n +2\n\nIf there is no output and password policy is not controlled by a directory service, this is a finding.\n\nOtherwise, look for the line \"<key>policyCategoryAuthentication</key>\".\n\nIn the array that follows, a <dict> section contains a check <string> that allows users to log in if \"policyAttributeCurrentTime\" is less than the result of adding \"policyAttributeCreationTime\" to 72 hours (259299 seconds). The check might use a variable defined in its \"policyParameters\" section.\n\nIf the check does not exist or if the check adds more than 72 hours to \"policyAttributeCreationTime\", this is a finding.","fix":"Configure the macOS system to disable temporary or emergency accounts after 72 hours. This setting may be enforced using local policy or by a directory service.\n\nTo set local policy to disable a temporary or emergency user, create a plain text file containing the following:\n\n   <dict>\n     <key>policyCategoryAuthentication</key>\n     <array>\n       <dict>\n         <key>policyContent</key>\n         <string>policyAttributeCurrentTime &lt; policyAttributeCreationTime+259299</string>\n         <key>policyIdentifier</key>\n         <string>Disable Tmp Accounts </string>\n       </dict>\n     </array>\n   </dict>\n\nAfter saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the correct user name in place of \"username\" and the path to the file in place of \"/path/to/file\".\n\n/usr/bin/sudo /usr/bin/pwpolicy -u username setaccountpolicies /path/to/file"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60835r905081_chk","severity":"medium","gid":"V-257150","rid":"SV-257150r905083_rule","stig_id":"APPL-13-000012","gtitle":"SRG-OS-000002-GPOS-00002","fix_id":"F-60776r905082_fix","satisfies":["SRG-OS-000002-GPOS-00002","SRG-OS-000123-GPOS-00064"],"documentable":null,"cci":["CCI-000016","CCI-001682"],"nist":["AC-2 (2)","AC-2 (2)"]}},{"id":"SV-257151","code":"control 'SV-257151' do\n  title 'The macOS system must compare internal information system clocks at least every 24 hours with a server that is synchronized to one of the redundant United States Naval Observatory (USNO) time servers or a time server designated for the appropriate DOD network (NIPRNet/SIPRNet) and/or the Global Positioning System (GPS).'\n  desc 'Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside of the configured acceptable allowance (drift) may be inaccurate.\n\nSynchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network. \n\nOrganizations should consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).\n\n'\n  desc 'check', 'Verify the macOS system is configured with the timed service enabled and an authorized time server with the following commands:\n\n/usr/bin/sudo /usr/sbin/systemsetup -getusingnetworktime\n\nNetwork Time: On\n\nIf \"Network Time\" is not set to \"On\", this is a finding.\n\n/usr/bin/sudo /usr/sbin/systemsetup -getnetworktimeserver\n\nIf no time server is configured, or if an unapproved time server is in use, this is a finding.'\n  desc 'fix', 'Configure the macOS system to enable the timed service and set an authorized time server with the following commands:\n\n/usr/bin/sudo /usr/sbin/systemsetup -setusingnetworktime on\n\n/usr/bin/sudo /usr/sbin/systemsetup -setnetworktimeserver \"server\"'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60836r922871_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257151'\n  tag rid: 'SV-257151r922872_rule'\n  tag stig_id: 'APPL-13-000014'\n  tag gtitle: 'SRG-OS-000355-GPOS-00143'\n  tag fix_id: 'F-60777r905085_fix'\n  tag satisfies: ['SRG-OS-000355-GPOS-00143', 'SRG-OS-000356-GPOS-00144']\n  tag 'documentable'\n  tag cci: ['CCI-001891', 'CCI-002046']\n  tag nist: ['AU-8 (1) (a)', 'AU-8 (1) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257151.rb"},"title":"The macOS system must compare internal information system clocks at least every 24 hours with a server that is synchronized to one of the redundant United States Naval Observatory (USNO) time servers or a time server designated for the appropriate DOD network (NIPRNet/SIPRNet) and/or the Global Positioning System (GPS).","desc":"Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside of the configured acceptable allowance (drift) may be inaccurate.\n\nSynchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network. \n\nOrganizations should consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).\n\n","descriptions":{"default":"Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside of the configured acceptable allowance (drift) may be inaccurate.\n\nSynchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network. \n\nOrganizations should consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).\n\n","check":"Verify the macOS system is configured with the timed service enabled and an authorized time server with the following commands:\n\n/usr/bin/sudo /usr/sbin/systemsetup -getusingnetworktime\n\nNetwork Time: On\n\nIf \"Network Time\" is not set to \"On\", this is a finding.\n\n/usr/bin/sudo /usr/sbin/systemsetup -getnetworktimeserver\n\nIf no time server is configured, or if an unapproved time server is in use, this is a finding.","fix":"Configure the macOS system to enable the timed service and set an authorized time server with the following commands:\n\n/usr/bin/sudo /usr/sbin/systemsetup -setusingnetworktime on\n\n/usr/bin/sudo /usr/sbin/systemsetup -setnetworktimeserver \"server\""},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60836r922871_chk","severity":"medium","gid":"V-257151","rid":"SV-257151r922872_rule","stig_id":"APPL-13-000014","gtitle":"SRG-OS-000355-GPOS-00143","fix_id":"F-60777r905085_fix","satisfies":["SRG-OS-000355-GPOS-00143","SRG-OS-000356-GPOS-00144"],"documentable":null,"cci":["CCI-001891","CCI-002046"],"nist":["AU-8 (1) (a)","AU-8 (1) (b)"]}},{"id":"SV-257152","code":"control 'SV-257152' do\n  title 'The macOS system must use an Endpoint Security Solution (ESS) and implement all DOD required modules.'\n  desc 'The macOS system must employ automated mechanisms to determine the state of system components. The DOD requires the installation and use of an approved ESS solution to be implemented on the operating system. For additional information, reference all applicable ESS OPORDs and FRAGOs on SIPRNet.'\n  desc 'check', 'Verify the macOS system is configured with an approved ESS solution.\n\nIf an approved ESS solution is not installed, this is a finding.\n\nVerify that all installed components of the ESS solution are at the DOD-approved minimal version.\n\nIf the installed components are not at the DOD-approved minimal versions, this is a finding.'\n  desc 'fix', 'Configure the macOS system with an approved ESS solution and ensure that all components are at least updated to their DOD-approved minimal versions.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60837r905087_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257152'\n  tag rid: 'SV-257152r905089_rule'\n  tag stig_id: 'APPL-13-000015'\n  tag gtitle: 'SRG-OS-000191-GPOS-00080'\n  tag fix_id: 'F-60778r905088_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001233']\n  tag nist: ['SI-2 (2)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257152.rb"},"title":"The macOS system must use an Endpoint Security Solution (ESS) and implement all DOD required modules.","desc":"The macOS system must employ automated mechanisms to determine the state of system components. The DOD requires the installation and use of an approved ESS solution to be implemented on the operating system. For additional information, reference all applicable ESS OPORDs and FRAGOs on SIPRNet.","descriptions":{"default":"The macOS system must employ automated mechanisms to determine the state of system components. The DOD requires the installation and use of an approved ESS solution to be implemented on the operating system. For additional information, reference all applicable ESS OPORDs and FRAGOs on SIPRNet.","check":"Verify the macOS system is configured with an approved ESS solution.\n\nIf an approved ESS solution is not installed, this is a finding.\n\nVerify that all installed components of the ESS solution are at the DOD-approved minimal version.\n\nIf the installed components are not at the DOD-approved minimal versions, this is a finding.","fix":"Configure the macOS system with an approved ESS solution and ensure that all components are at least updated to their DOD-approved minimal versions."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60837r905087_chk","severity":"medium","gid":"V-257152","rid":"SV-257152r905089_rule","stig_id":"APPL-13-000015","gtitle":"SRG-OS-000191-GPOS-00080","fix_id":"F-60778r905088_fix","documentable":null,"cci":["CCI-001233"],"nist":["SI-2 (2)"]}},{"id":"SV-257153","code":"control 'SV-257153' do\n  title 'The macOS system must be integrated into a directory services infrastructure.'\n  desc 'Distinct user account databases on each separate system cause problems with username and password policy enforcement. Most approved directory services infrastructure solutions allow centralized management of users and passwords.'\n  desc 'check', 'If the macOS system is using a mandatory Smart Card Policy, this requirement is not applicable.\n\nVerify the macOS system is configured to integrate into a directory service with the following command:\n\n/usr/bin/dscl localhost -list . | /usr/bin/grep \"Active Directory\"\n\nIf no results are returned, this is a finding.'\n  desc 'fix', 'Configure the macOS system to integrate into an existing directory services infrastructure.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60838r905090_chk'\n  tag severity: 'high'\n  tag gid: 'V-257153'\n  tag rid: 'SV-257153r905092_rule'\n  tag stig_id: 'APPL-13-000016'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60779r905091_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257153.rb"},"title":"The macOS system must be integrated into a directory services infrastructure.","desc":"Distinct user account databases on each separate system cause problems with username and password policy enforcement. Most approved directory services infrastructure solutions allow centralized management of users and passwords.","descriptions":{"default":"Distinct user account databases on each separate system cause problems with username and password policy enforcement. Most approved directory services infrastructure solutions allow centralized management of users and passwords.","check":"If the macOS system is using a mandatory Smart Card Policy, this requirement is not applicable.\n\nVerify the macOS system is configured to integrate into a directory service with the following command:\n\n/usr/bin/dscl localhost -list . | /usr/bin/grep \"Active Directory\"\n\nIf no results are returned, this is a finding.","fix":"Configure the macOS system to integrate into an existing directory services infrastructure."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60838r905090_chk","severity":"high","gid":"V-257153","rid":"SV-257153r905092_rule","stig_id":"APPL-13-000016","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60779r905091_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257154","code":"control 'SV-257154' do\n  title 'The macOS system must enforce the limit of three consecutive invalid logon attempts by a user before the user account is locked.'\n  desc 'By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.'\n  desc 'check', 'Verify the macOS system is configured to enforce the limit of three consecutive invalid logon attempts by a user before the user account is locked with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"maxFailedAttempts\\\\|minutesUntilFailedLoginReset\"\n\nmaxFailedAttempts = 3;\nminutesUntilFailedLoginReset = 15;\n\nIf \"maxFailedAttempts\" is not set to \"3\" and \"minutesUntilFailedLoginReset\" is not set to \"15\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to enforce the limit of three consecutive invalid logon attempts by a user before the user account is locked by installing the \"Passcode Policy\" configuration profile or by a directory service.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60839r905093_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257154'\n  tag rid: 'SV-257154r905095_rule'\n  tag stig_id: 'APPL-13-000022'\n  tag gtitle: 'SRG-OS-000329-GPOS-00128'\n  tag fix_id: 'F-60780r905094_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002238']\n  tag nist: ['AC-7 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257154.rb"},"title":"The macOS system must enforce the limit of three consecutive invalid logon attempts by a user before the user account is locked.","desc":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.","descriptions":{"default":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.","check":"Verify the macOS system is configured to enforce the limit of three consecutive invalid logon attempts by a user before the user account is locked with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"maxFailedAttempts\\|minutesUntilFailedLoginReset\"\n\nmaxFailedAttempts = 3;\nminutesUntilFailedLoginReset = 15;\n\nIf \"maxFailedAttempts\" is not set to \"3\" and \"minutesUntilFailedLoginReset\" is not set to \"15\", this is a finding.","fix":"Configure the macOS system to enforce the limit of three consecutive invalid logon attempts by a user before the user account is locked by installing the \"Passcode Policy\" configuration profile or by a directory service."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60839r905093_chk","severity":"medium","gid":"V-257154","rid":"SV-257154r905095_rule","stig_id":"APPL-13-000022","gtitle":"SRG-OS-000329-GPOS-00128","fix_id":"F-60780r905094_fix","documentable":null,"cci":["CCI-002238"],"nist":["AC-7 b"]}},{"id":"SV-257155","code":"control 'SV-257155' do\n  title 'The macOS system must display the Standard Mandatory DOD Notice and Consent Banner before granting remote access to the operating system.'\n  desc 'Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.'\n  desc 'check', 'If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured to display the Standard Mandatory DOD Notice and Consent Banner before granting remote access to the operating system.\n\nCheck to see if the operating system has the correct text listed in the \"/etc/banner\" file with the following command:\n\n/usr/bin/more /etc/banner\n\nThe command must return the following text:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nIf the operating system does not display a logon banner before granting remote access or the banner does not match the Standard Mandatory DOD Notice and Consent Banner, this is a finding.\n\nIf the text in the \"/etc/banner\" file does not match the Standard Mandatory DOD Notice and Consent Banner, this is a finding.'\n  desc 'fix', 'Configure the macOS system to display the Standard Mandatory DOD Notice and Consent Banner before granting remote access to the operating system by creating a text file containing the required DOD text.\n\nName the file \"banner\" and place it in \"/etc/\".'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60840r905096_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257155'\n  tag rid: 'SV-257155r905098_rule'\n  tag stig_id: 'APPL-13-000023'\n  tag gtitle: 'SRG-OS-000023-GPOS-00006'\n  tag fix_id: 'F-60781r905097_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000048']\n  tag nist: ['AC-8 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257155.rb"},"title":"The macOS system must display the Standard Mandatory DOD Notice and Consent Banner before granting remote access to the operating system.","desc":"Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.","descriptions":{"default":"Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.","check":"If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured to display the Standard Mandatory DOD Notice and Consent Banner before granting remote access to the operating system.\n\nCheck to see if the operating system has the correct text listed in the \"/etc/banner\" file with the following command:\n\n/usr/bin/more /etc/banner\n\nThe command must return the following text:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nIf the operating system does not display a logon banner before granting remote access or the banner does not match the Standard Mandatory DOD Notice and Consent Banner, this is a finding.\n\nIf the text in the \"/etc/banner\" file does not match the Standard Mandatory DOD Notice and Consent Banner, this is a finding.","fix":"Configure the macOS system to display the Standard Mandatory DOD Notice and Consent Banner before granting remote access to the operating system by creating a text file containing the required DOD text.\n\nName the file \"banner\" and place it in \"/etc/\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60840r905096_chk","severity":"medium","gid":"V-257155","rid":"SV-257155r905098_rule","stig_id":"APPL-13-000023","gtitle":"SRG-OS-000023-GPOS-00006","fix_id":"F-60781r905097_fix","documentable":null,"cci":["CCI-000048"],"nist":["AC-8 a"]}},{"id":"SV-257156","code":"control 'SV-257156' do\n  title 'The macOS system must display the Standard Mandatory DOD Notice and Consent Banner before granting access to the system via SSH.'\n  desc 'Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\n'\n  desc 'check', 'If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured to display the contents of \"/etc/banner\" before granting access to the system with the following command:\n\n/usr/bin/grep -r Banner /etc/ssh/sshd_config*\n\nBanner /etc/banner\n\nIf the sshd Banner configuration option does not point to \"/etc/banner\", this is a finding.\n\nIf conflicting results are returned, this is a finding.'\n  desc 'fix', %q(Configure the macOS system to display the contents of \"/etc/banner\" before granting access to the system with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/^#Banner.*/Banner \\/etc\\/banner/' /etc/ssh/sshd_config)\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60841r905099_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257156'\n  tag rid: 'SV-257156r905101_rule'\n  tag stig_id: 'APPL-13-000024'\n  tag gtitle: 'SRG-OS-000023-GPOS-00006'\n  tag fix_id: 'F-60782r905100_fix'\n  tag satisfies: ['SRG-OS-000023-GPOS-00006', 'SRG-OS-000024-GPOS-00007']\n  tag 'documentable'\n  tag cci: ['CCI-000048', 'CCI-000050']\n  tag nist: ['AC-8 a', 'AC-8 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257156.rb"},"title":"The macOS system must display the Standard Mandatory DOD Notice and Consent Banner before granting access to the system via SSH.","desc":"Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\n","descriptions":{"default":"Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\n","check":"If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured to display the contents of \"/etc/banner\" before granting access to the system with the following command:\n\n/usr/bin/grep -r Banner /etc/ssh/sshd_config*\n\nBanner /etc/banner\n\nIf the sshd Banner configuration option does not point to \"/etc/banner\", this is a finding.\n\nIf conflicting results are returned, this is a finding.","fix":"Configure the macOS system to display the contents of \"/etc/banner\" before granting access to the system with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/^#Banner.*/Banner \\/etc\\/banner/' /etc/ssh/sshd_config"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60841r905099_chk","severity":"medium","gid":"V-257156","rid":"SV-257156r905101_rule","stig_id":"APPL-13-000024","gtitle":"SRG-OS-000023-GPOS-00006","fix_id":"F-60782r905100_fix","satisfies":["SRG-OS-000023-GPOS-00006","SRG-OS-000024-GPOS-00007"],"documentable":null,"cci":["CCI-000048","CCI-000050"],"nist":["AC-8 a","AC-8 b"]}},{"id":"SV-257157","code":"control 'SV-257157' do\n  title 'The macOS system must be configured so that any connection to the system must display the Standard Mandatory DOD Notice and Consent Banner before granting GUI access to the system.'\n  desc 'Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\n'\n  desc 'check', 'Verify the macOS system is configured to display a policy banner with the following command:\n\n/bin/ls -l /Library/Security/PolicyBanner.rtfd\n\n-rw-r--r--@ 1 admin sheel 37 Jan 27 11:18 /Library/Security/PolicyBanner.rtfd\n\nIf \"PolicyBanner.rtfd\" does not exist, this is a finding.\n\nIf the permissions for \"PolicyBanner.rtfd\" are not \"644\", this is a finding.\n\nThe banner text of the document must read:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nIf the text is not worded exactly this way, this is a finding.'\n  desc 'fix', 'Configure the macOS system to display a policy banner by creating an RTF file containing the required text. Name the file \"PolicyBanner.rtfd\" and place it in \"/Library/Security/\".\n\nUpdate the permissions of the \"/Library/Security/PolicyBanner.rtfd\" file with the following command:\n\n/usr/bin/sudo /bin/chmod 644 /Library/Security/PolicyBanner.rtfd'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60842r905102_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257157'\n  tag rid: 'SV-257157r905104_rule'\n  tag stig_id: 'APPL-13-000025'\n  tag gtitle: 'SRG-OS-000023-GPOS-00006'\n  tag fix_id: 'F-60783r905103_fix'\n  tag satisfies: ['SRG-OS-000023-GPOS-00006', 'SRG-OS-000024-GPOS-00007', 'SRG-OS-000228-GPOS-00088']\n  tag 'documentable'\n  tag cci: ['CCI-000048', 'CCI-000050', 'CCI-001384', 'CCI-001385', 'CCI-001386', 'CCI-001387', 'CCI-001388']\n  tag nist: ['AC-8 a', 'AC-8 b', 'AC-8 c 1', 'AC-8 c 2', 'AC-8 c 2', 'AC-8 c 2', 'AC-8 c 3']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257157.rb"},"title":"The macOS system must be configured so that any connection to the system must display the Standard Mandatory DOD Notice and Consent Banner before granting GUI access to the system.","desc":"Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\n","descriptions":{"default":"Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060.\n\n","check":"Verify the macOS system is configured to display a policy banner with the following command:\n\n/bin/ls -l /Library/Security/PolicyBanner.rtfd\n\n-rw-r--r--@ 1 admin sheel 37 Jan 27 11:18 /Library/Security/PolicyBanner.rtfd\n\nIf \"PolicyBanner.rtfd\" does not exist, this is a finding.\n\nIf the permissions for \"PolicyBanner.rtfd\" are not \"644\", this is a finding.\n\nThe banner text of the document must read:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nIf the text is not worded exactly this way, this is a finding.","fix":"Configure the macOS system to display a policy banner by creating an RTF file containing the required text. Name the file \"PolicyBanner.rtfd\" and place it in \"/Library/Security/\".\n\nUpdate the permissions of the \"/Library/Security/PolicyBanner.rtfd\" file with the following command:\n\n/usr/bin/sudo /bin/chmod 644 /Library/Security/PolicyBanner.rtfd"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60842r905102_chk","severity":"medium","gid":"V-257157","rid":"SV-257157r905104_rule","stig_id":"APPL-13-000025","gtitle":"SRG-OS-000023-GPOS-00006","fix_id":"F-60783r905103_fix","satisfies":["SRG-OS-000023-GPOS-00006","SRG-OS-000024-GPOS-00007","SRG-OS-000228-GPOS-00088"],"documentable":null,"cci":["CCI-000048","CCI-000050","CCI-001384","CCI-001385","CCI-001386","CCI-001387","CCI-001388"],"nist":["AC-8 a","AC-8 b","AC-8 c 1","AC-8 c 2","AC-8 c 2","AC-8 c 2","AC-8 c 3"]}},{"id":"SV-257158","code":"control 'SV-257158' do\n  title 'The macOS system must be configured so that log files do not contain access control lists (ACLs).'\n  desc 'The audit service must be configured to create log files with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.\n\n'\n  desc 'check', %q(Verify the macOS system is configured without ACLs applied to log files with the following command:\n\n/usr/bin/sudo /bin/ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/grep -v current\n\nIn the output from the above command, ACLs will be listed under any file that may contain them (e.g., \"0: group:admin allow list,readattr,readextattr,readsecurity\").\n\nIf any ACLs exists, this is a finding.)\n  desc 'fix', 'Configure the macOS system so that log files do not contain ACLs with the following command:\n\n/usr/bin/sudo /bin/chmod -N [audit log file]'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60843r905105_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257158'\n  tag rid: 'SV-257158r905107_rule'\n  tag stig_id: 'APPL-13-000030'\n  tag gtitle: 'SRG-OS-000057-GPOS-00027'\n  tag fix_id: 'F-60784r905106_fix'\n  tag satisfies: ['SRG-OS-000057-GPOS-00027', 'SRG-OS-000206-GPOS-00084']\n  tag 'documentable'\n  tag cci: ['CCI-000162', 'CCI-001314']\n  tag nist: ['AU-9 a', 'SI-11 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257158.rb"},"title":"The macOS system must be configured so that log files do not contain access control lists (ACLs).","desc":"The audit service must be configured to create log files with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.\n\n","descriptions":{"default":"The audit service must be configured to create log files with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.\n\n","check":"Verify the macOS system is configured without ACLs applied to log files with the following command:\n\n/usr/bin/sudo /bin/ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/grep -v current\n\nIn the output from the above command, ACLs will be listed under any file that may contain them (e.g., \"0: group:admin allow list,readattr,readextattr,readsecurity\").\n\nIf any ACLs exists, this is a finding.","fix":"Configure the macOS system so that log files do not contain ACLs with the following command:\n\n/usr/bin/sudo /bin/chmod -N [audit log file]"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60843r905105_chk","severity":"medium","gid":"V-257158","rid":"SV-257158r905107_rule","stig_id":"APPL-13-000030","gtitle":"SRG-OS-000057-GPOS-00027","fix_id":"F-60784r905106_fix","satisfies":["SRG-OS-000057-GPOS-00027","SRG-OS-000206-GPOS-00084"],"documentable":null,"cci":["CCI-000162","CCI-001314"],"nist":["AU-9 a","SI-11 b"]}},{"id":"SV-257159","code":"control 'SV-257159' do\n  title 'The macOS system must be configured so that log folders do not contain access control lists (ACLs).'\n  desc 'The audit service must be configured to create log folders with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log folders are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.'\n  desc 'check', %q(Verify the macOS system is configured without ACLs applied to log folders with the following command:\n\n/usr/bin/sudo /bin/ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')\n\nIn the output from the above command, ACLs will be listed under any folder that may contain them (e.g., \"0: group:admin allow list,readattr,readextattr,readsecurity\").\n\nIf any ACLs exists, this is a finding.)\n  desc 'fix', 'Configure the macOS system so that log folders do not contain ACLs with the following command:\n\n/usr/bin/sudo /bin/chmod -N [audit log folder]'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60844r905108_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257159'\n  tag rid: 'SV-257159r905110_rule'\n  tag stig_id: 'APPL-13-000031'\n  tag gtitle: 'SRG-OS-000057-GPOS-00027'\n  tag fix_id: 'F-60785r905109_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000162']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257159.rb"},"title":"The macOS system must be configured so that log folders do not contain access control lists (ACLs).","desc":"The audit service must be configured to create log folders with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log folders are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.","descriptions":{"default":"The audit service must be configured to create log folders with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log folders are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.","check":"Verify the macOS system is configured without ACLs applied to log folders with the following command:\n\n/usr/bin/sudo /bin/ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')\n\nIn the output from the above command, ACLs will be listed under any folder that may contain them (e.g., \"0: group:admin allow list,readattr,readextattr,readsecurity\").\n\nIf any ACLs exists, this is a finding.","fix":"Configure the macOS system so that log folders do not contain ACLs with the following command:\n\n/usr/bin/sudo /bin/chmod -N [audit log folder]"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60844r905108_chk","severity":"medium","gid":"V-257159","rid":"SV-257159r905110_rule","stig_id":"APPL-13-000031","gtitle":"SRG-OS-000057-GPOS-00027","fix_id":"F-60785r905109_fix","documentable":null,"cci":["CCI-000162"],"nist":["AU-9 a"]}},{"id":"SV-257160","code":"control 'SV-257160' do\n  title 'The macOS system must be configured with dedicated user accounts to decrypt the hard disk upon startup.'\n  desc 'When \"FileVault\" and Multifactor Authentication are configured on the operating system, a dedicated user must be configured to ensure that the implemented Multifactor Authentication rules are enforced. If a dedicated user is not configured to decrypt the hard disk upon startup, the system will allow a user to bypass Multifactor Authentication rules during initial startup and first login.'\n  desc 'check', %q(Verify the macOS system is configured with dedicated user accounts to decrypt the hard disk upon startup with the following command:\n\n/usr/bin/sudo /usr/bin/fdesetup list\n\nfvuser,85F41F44-22B3-6CB7-85A1-BCC2EA2B887A\n\nIf any unauthorized users are listed, this is a finding.\n\nVerify that the shell for authorized FileVault users is set to \"/usr/bin/false\" to prevent console logons:\n\n/usr/bin/sudo /usr/bin/dscl . read /Users/<FileVault_User> UserShell\n\nUserShell: /usr/bin/false\n\nIf the FileVault users' shell is not set to \"/usr/bin/false\", this is a finding.)\n  desc 'fix', 'Configure the macOS system with a dedicated user account to decrypt the hard disk at startup and disable the logon ability of the newly created user account with the following commands:\n\n/usr/bin/sudo /usr/bin/fdesetup add -user <username>\n\n/usr/bin/sudo /usr/bin/dscl . change /Users/<FileVault_User> UserShell </path/to/current/shell> /usr/bin/false\n\nRemove all FileVault logon access from each user account defined on the system that is not a designated FileVault user:\n\n/usr/bin/sudo /usr/bin/fdesetup remove -user <username>'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60845r905111_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257160'\n  tag rid: 'SV-257160r905113_rule'\n  tag stig_id: 'APPL-13-000032'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60786r905112_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257160.rb"},"title":"The macOS system must be configured with dedicated user accounts to decrypt the hard disk upon startup.","desc":"When \"FileVault\" and Multifactor Authentication are configured on the operating system, a dedicated user must be configured to ensure that the implemented Multifactor Authentication rules are enforced. If a dedicated user is not configured to decrypt the hard disk upon startup, the system will allow a user to bypass Multifactor Authentication rules during initial startup and first login.","descriptions":{"default":"When \"FileVault\" and Multifactor Authentication are configured on the operating system, a dedicated user must be configured to ensure that the implemented Multifactor Authentication rules are enforced. If a dedicated user is not configured to decrypt the hard disk upon startup, the system will allow a user to bypass Multifactor Authentication rules during initial startup and first login.","check":"Verify the macOS system is configured with dedicated user accounts to decrypt the hard disk upon startup with the following command:\n\n/usr/bin/sudo /usr/bin/fdesetup list\n\nfvuser,85F41F44-22B3-6CB7-85A1-BCC2EA2B887A\n\nIf any unauthorized users are listed, this is a finding.\n\nVerify that the shell for authorized FileVault users is set to \"/usr/bin/false\" to prevent console logons:\n\n/usr/bin/sudo /usr/bin/dscl . read /Users/<FileVault_User> UserShell\n\nUserShell: /usr/bin/false\n\nIf the FileVault users' shell is not set to \"/usr/bin/false\", this is a finding.","fix":"Configure the macOS system with a dedicated user account to decrypt the hard disk at startup and disable the logon ability of the newly created user account with the following commands:\n\n/usr/bin/sudo /usr/bin/fdesetup add -user <username>\n\n/usr/bin/sudo /usr/bin/dscl . change /Users/<FileVault_User> UserShell </path/to/current/shell> /usr/bin/false\n\nRemove all FileVault logon access from each user account defined on the system that is not a designated FileVault user:\n\n/usr/bin/sudo /usr/bin/fdesetup remove -user <username>"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60845r905111_chk","severity":"medium","gid":"V-257160","rid":"SV-257160r905113_rule","stig_id":"APPL-13-000032","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60786r905112_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257161","code":"control 'SV-257161' do\n  title 'The macOS system must be configured to disable password forwarding for FileVault.'\n  desc 'When \"FileVault\" and Multifactor Authentication are configured on the operating system, a dedicated user must be configured to ensure that the implemented Multifactor Authentication rules are enforced. If a dedicated user is not configured to decrypt the hard disk upon startup, the system will allow a user to bypass Multifactor Authentication rules during initial startup and first login.'\n  desc 'check', 'Verify the macOS system is configured to disable password forwarding with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"DisableFDEAutoLogin\"\n\nDisableFDEAutoLogin = 1;\n\nIf \"DisableFDEAutoLogin\" is not set to a value of \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable password forwarding by installing the \"Smart Card Policy\" configuration profile.\n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the \"Smart Card Policy\".'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60846r905114_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257161'\n  tag rid: 'SV-257161r905116_rule'\n  tag stig_id: 'APPL-13-000033'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60787r905115_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257161.rb"},"title":"The macOS system must be configured to disable password forwarding for FileVault.","desc":"When \"FileVault\" and Multifactor Authentication are configured on the operating system, a dedicated user must be configured to ensure that the implemented Multifactor Authentication rules are enforced. If a dedicated user is not configured to decrypt the hard disk upon startup, the system will allow a user to bypass Multifactor Authentication rules during initial startup and first login.","descriptions":{"default":"When \"FileVault\" and Multifactor Authentication are configured on the operating system, a dedicated user must be configured to ensure that the implemented Multifactor Authentication rules are enforced. If a dedicated user is not configured to decrypt the hard disk upon startup, the system will allow a user to bypass Multifactor Authentication rules during initial startup and first login.","check":"Verify the macOS system is configured to disable password forwarding with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"DisableFDEAutoLogin\"\n\nDisableFDEAutoLogin = 1;\n\nIf \"DisableFDEAutoLogin\" is not set to a value of \"1\", this is a finding.","fix":"Configure the macOS system to disable password forwarding by installing the \"Smart Card Policy\" configuration profile.\n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the \"Smart Card Policy\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60846r905114_chk","severity":"medium","gid":"V-257161","rid":"SV-257161r905116_rule","stig_id":"APPL-13-000033","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60787r905115_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257162","code":"control 'SV-257162' do\n  title 'The macOS system must be configured with the SSH daemon ClientAliveInterval option set to 900 or less.'\n  desc 'SSH options ClientAliveInterval and ClientAliveCountMax are used in combination to monitor SSH connections. If an SSH client is deemed unresponsive, sshd will terminate the connection. An example would be if a client lost network connectivity the SSH connection to the server would be unresponsive and therefore sshd would terminate the connection after the ClientAliveCountMax and ClientAliveInterval thresholds have been met.\n\nThe ClientAliveInterval is a timeout measured in seconds. After which if no data is received from the client, sshd will request a response through the encrypted tunnel from the client. The default is \"0\", indicating no messages will be sent.\n\nThe ClientAliveCountMax is the number of client alive messages that can be sent from the server without receiving a reply from the client. If this threshold is met, sshd will terminate the session. Setting the ClientAliveCountMax to \"0\" disables connection termination.'\n  desc 'check', 'If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured with the SSH daemon \"ClientAliveInterval\" option set to \"900\" or less with the following command:\n\n/usr/bin/grep -r ^ClientAliveInterval /etc/ssh/sshd_config*\n\nIf \"ClientAliveInterval\" is not configured or has a value of \"0\", this is a finding.\n\nIf \"ClientAliveInterval\" is not \"900\" or less, this is a finding.\n\nIf conflicting results are returned, this is a finding.'\n  desc 'fix', %q(Configure the macOS system to set the SSH daemon \"ClientAliveInterval\" option to \"900\" with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*ClientAliveInterval.*/ClientAliveInterval 900/' /etc/ssh/sshd_config)\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60847r905117_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257162'\n  tag rid: 'SV-257162r922873_rule'\n  tag stig_id: 'APPL-13-000051'\n  tag gtitle: 'SRG-OS-000163-GPOS-00072'\n  tag fix_id: 'F-60788r905118_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001133']\n  tag nist: ['SC-10']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257162.rb"},"title":"The macOS system must be configured with the SSH daemon ClientAliveInterval option set to 900 or less.","desc":"SSH options ClientAliveInterval and ClientAliveCountMax are used in combination to monitor SSH connections. If an SSH client is deemed unresponsive, sshd will terminate the connection. An example would be if a client lost network connectivity the SSH connection to the server would be unresponsive and therefore sshd would terminate the connection after the ClientAliveCountMax and ClientAliveInterval thresholds have been met.\n\nThe ClientAliveInterval is a timeout measured in seconds. After which if no data is received from the client, sshd will request a response through the encrypted tunnel from the client. The default is \"0\", indicating no messages will be sent.\n\nThe ClientAliveCountMax is the number of client alive messages that can be sent from the server without receiving a reply from the client. If this threshold is met, sshd will terminate the session. Setting the ClientAliveCountMax to \"0\" disables connection termination.","descriptions":{"default":"SSH options ClientAliveInterval and ClientAliveCountMax are used in combination to monitor SSH connections. If an SSH client is deemed unresponsive, sshd will terminate the connection. An example would be if a client lost network connectivity the SSH connection to the server would be unresponsive and therefore sshd would terminate the connection after the ClientAliveCountMax and ClientAliveInterval thresholds have been met.\n\nThe ClientAliveInterval is a timeout measured in seconds. After which if no data is received from the client, sshd will request a response through the encrypted tunnel from the client. The default is \"0\", indicating no messages will be sent.\n\nThe ClientAliveCountMax is the number of client alive messages that can be sent from the server without receiving a reply from the client. If this threshold is met, sshd will terminate the session. Setting the ClientAliveCountMax to \"0\" disables connection termination.","check":"If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured with the SSH daemon \"ClientAliveInterval\" option set to \"900\" or less with the following command:\n\n/usr/bin/grep -r ^ClientAliveInterval /etc/ssh/sshd_config*\n\nIf \"ClientAliveInterval\" is not configured or has a value of \"0\", this is a finding.\n\nIf \"ClientAliveInterval\" is not \"900\" or less, this is a finding.\n\nIf conflicting results are returned, this is a finding.","fix":"Configure the macOS system to set the SSH daemon \"ClientAliveInterval\" option to \"900\" with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*ClientAliveInterval.*/ClientAliveInterval 900/' /etc/ssh/sshd_config"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60847r905117_chk","severity":"medium","gid":"V-257162","rid":"SV-257162r922873_rule","stig_id":"APPL-13-000051","gtitle":"SRG-OS-000163-GPOS-00072","fix_id":"F-60788r905118_fix","documentable":null,"cci":["CCI-001133"],"nist":["SC-10"]}},{"id":"SV-257163","code":"control 'SV-257163' do\n  title 'The macOS system must be configured with the SSH daemon ClientAliveCountMax option set to 1.'\n  desc 'Terminating an idle session within a short time reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete logon attempt will also free up resources committed by the managed network element.\n\nSSH options ClientAliveInterval and ClientAliveCountMax are used in combination to monitor SSH connections. If an SSH client is deemed unresponsive, sshd will terminate the connection. An example would be if a client lost network connectivity the SSH connection to the server would be unresponsive and therefore sshd would terminate the connection after the ClientAliveCountMax and ClientAliveInterval thresholds have been met.\n\nThe ClientAliveInterval is a timeout measured in seconds. After which if no data is received from the client, sshd will request a response through the encrypted tunnel from the client. The default is 0, indicating no messages will be sent.\n\nThe ClientAliveCountMax is the number of client alive messages that can be sent from the server without receiving a reply from the client. If this threshold is met, sshd will terminate the session. Setting the ClientAliveCountMax to 0 disables connection termination.'\n  desc 'check', 'If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured with the SSH daemon \"ClientAliveCountMax\" option set to \"1\" with the following command:\n\n/usr/bin/grep -r ^ClientAliveCountMax /etc/ssh/sshd_config*\n\nIf the setting is not \"ClientAliveCountMax 1\", this is a finding.\n\nIf conflicting results are returned, this is a finding.'\n  desc 'fix', %q(Configure the macOS system to set the SSH daemon \"ClientAliveCountMax\" option to \"1\" with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*ClientAliveCountMax.*/ClientAliveCountMax 1/' /etc/ssh/sshd_config)\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60848r905120_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257163'\n  tag rid: 'SV-257163r905122_rule'\n  tag stig_id: 'APPL-13-000052'\n  tag gtitle: 'SRG-OS-000163-GPOS-00072'\n  tag fix_id: 'F-60789r905121_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001133']\n  tag nist: ['SC-10']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257163.rb"},"title":"The macOS system must be configured with the SSH daemon ClientAliveCountMax option set to 1.","desc":"Terminating an idle session within a short time reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete logon attempt will also free up resources committed by the managed network element.\n\nSSH options ClientAliveInterval and ClientAliveCountMax are used in combination to monitor SSH connections. If an SSH client is deemed unresponsive, sshd will terminate the connection. An example would be if a client lost network connectivity the SSH connection to the server would be unresponsive and therefore sshd would terminate the connection after the ClientAliveCountMax and ClientAliveInterval thresholds have been met.\n\nThe ClientAliveInterval is a timeout measured in seconds. After which if no data is received from the client, sshd will request a response through the encrypted tunnel from the client. The default is 0, indicating no messages will be sent.\n\nThe ClientAliveCountMax is the number of client alive messages that can be sent from the server without receiving a reply from the client. If this threshold is met, sshd will terminate the session. Setting the ClientAliveCountMax to 0 disables connection termination.","descriptions":{"default":"Terminating an idle session within a short time reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete logon attempt will also free up resources committed by the managed network element.\n\nSSH options ClientAliveInterval and ClientAliveCountMax are used in combination to monitor SSH connections. If an SSH client is deemed unresponsive, sshd will terminate the connection. An example would be if a client lost network connectivity the SSH connection to the server would be unresponsive and therefore sshd would terminate the connection after the ClientAliveCountMax and ClientAliveInterval thresholds have been met.\n\nThe ClientAliveInterval is a timeout measured in seconds. After which if no data is received from the client, sshd will request a response through the encrypted tunnel from the client. The default is 0, indicating no messages will be sent.\n\nThe ClientAliveCountMax is the number of client alive messages that can be sent from the server without receiving a reply from the client. If this threshold is met, sshd will terminate the session. Setting the ClientAliveCountMax to 0 disables connection termination.","check":"If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured with the SSH daemon \"ClientAliveCountMax\" option set to \"1\" with the following command:\n\n/usr/bin/grep -r ^ClientAliveCountMax /etc/ssh/sshd_config*\n\nIf the setting is not \"ClientAliveCountMax 1\", this is a finding.\n\nIf conflicting results are returned, this is a finding.","fix":"Configure the macOS system to set the SSH daemon \"ClientAliveCountMax\" option to \"1\" with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*ClientAliveCountMax.*/ClientAliveCountMax 1/' /etc/ssh/sshd_config"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60848r905120_chk","severity":"medium","gid":"V-257163","rid":"SV-257163r905122_rule","stig_id":"APPL-13-000052","gtitle":"SRG-OS-000163-GPOS-00072","fix_id":"F-60789r905121_fix","documentable":null,"cci":["CCI-001133"],"nist":["SC-10"]}},{"id":"SV-257164","code":"control 'SV-257164' do\n  title 'The macOS system must be configured with the SSH daemon LoginGraceTime set to 30 or less.'\n  desc 'SSH must be configured to log users out after a 15-minute interval of inactivity and to wait only 30 seconds before timing out logon attempts. Terminating an idle session within a short time reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete logon attempt will also free up resources committed by the managed network element.'\n  desc 'check', 'If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured with the SSH daemon \"LoginGraceTime\" option set to \"30\" or less with the following command:\n\n/usr/bin/grep -r ^LoginGraceTime /etc/ssh/sshd_config*\n\nIf \"LoginGraceTime\" is not configured or has a value of \"0\", this is a finding.\n\nIf \"LoginGraceTime\" is not set to \"30\" or less, this is a finding.\n\nIf conflicting results are returned, this is a finding.'\n  desc 'fix', %q(Configure the macOS system to set the SSH daemon \"LoginGraceTime\" option to \"30\" with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*LoginGraceTime.*/LoginGraceTime 30/' /etc/ssh/sshd_config)\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60849r905123_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257164'\n  tag rid: 'SV-257164r905125_rule'\n  tag stig_id: 'APPL-13-000053'\n  tag gtitle: 'SRG-OS-000163-GPOS-00072'\n  tag fix_id: 'F-60790r905124_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001133']\n  tag nist: ['SC-10']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257164.rb"},"title":"The macOS system must be configured with the SSH daemon LoginGraceTime set to 30 or less.","desc":"SSH must be configured to log users out after a 15-minute interval of inactivity and to wait only 30 seconds before timing out logon attempts. Terminating an idle session within a short time reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete logon attempt will also free up resources committed by the managed network element.","descriptions":{"default":"SSH must be configured to log users out after a 15-minute interval of inactivity and to wait only 30 seconds before timing out logon attempts. Terminating an idle session within a short time reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete logon attempt will also free up resources committed by the managed network element.","check":"If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured with the SSH daemon \"LoginGraceTime\" option set to \"30\" or less with the following command:\n\n/usr/bin/grep -r ^LoginGraceTime /etc/ssh/sshd_config*\n\nIf \"LoginGraceTime\" is not configured or has a value of \"0\", this is a finding.\n\nIf \"LoginGraceTime\" is not set to \"30\" or less, this is a finding.\n\nIf conflicting results are returned, this is a finding.","fix":"Configure the macOS system to set the SSH daemon \"LoginGraceTime\" option to \"30\" with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*LoginGraceTime.*/LoginGraceTime 30/' /etc/ssh/sshd_config"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60849r905123_chk","severity":"medium","gid":"V-257164","rid":"SV-257164r905125_rule","stig_id":"APPL-13-000053","gtitle":"SRG-OS-000163-GPOS-00072","fix_id":"F-60790r905124_fix","documentable":null,"cci":["CCI-001133"],"nist":["SC-10"]}},{"id":"SV-257165","code":"control 'SV-257165' do\n  title 'The macOS system must implement approved ciphers within the SSH server configuration to protect the confidentiality of SSH connections.'\n  desc 'Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n'\n  desc 'check', 'Verify the macOS system is configured to use approved SSH ciphers within the SSH server configuration with the following command:\n\n/usr/bin/sudo /usr/sbin/sshd -T | /usr/bin/grep \"ciphers\"\n\nciphers aes128-gcm@openssh.com\n\nIf any ciphers other than \"aes128-gcm@openssh.com\" are listed, or the \"ciphers\" keyword is missing, this is a finding.'\n  desc 'fix', 'Configure the macOS system to use approved SSH ciphers by creating a plain text file in the /private/etc/ssh/sshd_config.d/ directory containing the following:\n\nCiphers aes128-gcm@openssh.com\n\nThe SSH service must be restarted for changes to take effect.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60850r919350_chk'\n  tag severity: 'high'\n  tag gid: 'V-257165'\n  tag rid: 'SV-257165r919351_rule'\n  tag stig_id: 'APPL-13-000054'\n  tag gtitle: 'SRG-OS-000033-GPOS-00014'\n  tag fix_id: 'F-60791r916570_fix'\n  tag satisfies: ['SRG-OS-000033-GPOS-00014', 'SRG-OS-000120-GPOS-00061', 'SRG-OS-000125-GPOS-00065', 'SRG-OS-000250-GPOS-00093', 'SRG-OS-000393-GPOS-00173', 'SRG-OS-000394-GPOS-00174']\n  tag 'documentable'\n  tag cci: ['CCI-000068', 'CCI-000803', 'CCI-000877', 'CCI-001453', 'CCI-002890', 'CCI-003123']\n  tag nist: ['AC-17 (2)', 'IA-7', 'MA-4 c', 'AC-17 (2)', 'MA-4 (6)', 'MA-4 (6)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257165.rb"},"title":"The macOS system must implement approved ciphers within the SSH server configuration to protect the confidentiality of SSH connections.","desc":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","descriptions":{"default":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","check":"Verify the macOS system is configured to use approved SSH ciphers within the SSH server configuration with the following command:\n\n/usr/bin/sudo /usr/sbin/sshd -T | /usr/bin/grep \"ciphers\"\n\nciphers aes128-gcm@openssh.com\n\nIf any ciphers other than \"aes128-gcm@openssh.com\" are listed, or the \"ciphers\" keyword is missing, this is a finding.","fix":"Configure the macOS system to use approved SSH ciphers by creating a plain text file in the /private/etc/ssh/sshd_config.d/ directory containing the following:\n\nCiphers aes128-gcm@openssh.com\n\nThe SSH service must be restarted for changes to take effect."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60850r919350_chk","severity":"high","gid":"V-257165","rid":"SV-257165r919351_rule","stig_id":"APPL-13-000054","gtitle":"SRG-OS-000033-GPOS-00014","fix_id":"F-60791r916570_fix","satisfies":["SRG-OS-000033-GPOS-00014","SRG-OS-000120-GPOS-00061","SRG-OS-000125-GPOS-00065","SRG-OS-000250-GPOS-00093","SRG-OS-000393-GPOS-00173","SRG-OS-000394-GPOS-00174"],"documentable":null,"cci":["CCI-000068","CCI-000803","CCI-000877","CCI-001453","CCI-002890","CCI-003123"],"nist":["AC-17 (2)","IA-7","MA-4 c","AC-17 (2)","MA-4 (6)","MA-4 (6)"]}},{"id":"SV-257166","code":"control 'SV-257166' do\n  title 'The macOS system must implement approved Message Authentication Codes (MACs) within the SSH server configuration.'\n  desc 'Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n'\n  desc 'check', 'Verify the macOS system is configured to use approved SSH MACs within the SSH server configuration with the following command:\n\n/usr/bin/sudo /usr/sbin/sshd -T | /usr/bin/grep \"macs\"\n\nmacs hmac-sha2-256\n\nIf any hashes other than \"hmac-sha2-256\" are listed, or the \"macs\" keyword is missing, this is a finding.'\n  desc 'fix', 'Configure the macOS system to use approved SSH MACs by creating a plain text file in the /private/etc/ssh/sshd_config.d/ directory containing the following:\n\nMACs hmac-sha2-256\n\nThe SSH service must be restarted for changes to take effect.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60851r919352_chk'\n  tag severity: 'high'\n  tag gid: 'V-257166'\n  tag rid: 'SV-257166r919353_rule'\n  tag stig_id: 'APPL-13-000055'\n  tag gtitle: 'SRG-OS-000033-GPOS-00014'\n  tag fix_id: 'F-60792r916573_fix'\n  tag satisfies: ['SRG-OS-000033-GPOS-00014', 'SRG-OS-000120-GPOS-00061', 'SRG-OS-000125-GPOS-00065', 'SRG-OS-000250-GPOS-00093', 'SRG-OS-000393-GPOS-00173', 'SRG-OS-000394-GPOS-00175']\n  tag 'documentable'\n  tag cci: ['CCI-000068', 'CCI-000803', 'CCI-000877', 'CCI-001453', 'CCI-002890', 'CCI-003123']\n  tag nist: ['AC-17 (2)', 'IA-7', 'MA-4 c', 'AC-17 (2)', 'MA-4 (6)', 'MA-4 (6)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257166.rb"},"title":"The macOS system must implement approved Message Authentication Codes (MACs) within the SSH server configuration.","desc":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","descriptions":{"default":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","check":"Verify the macOS system is configured to use approved SSH MACs within the SSH server configuration with the following command:\n\n/usr/bin/sudo /usr/sbin/sshd -T | /usr/bin/grep \"macs\"\n\nmacs hmac-sha2-256\n\nIf any hashes other than \"hmac-sha2-256\" are listed, or the \"macs\" keyword is missing, this is a finding.","fix":"Configure the macOS system to use approved SSH MACs by creating a plain text file in the /private/etc/ssh/sshd_config.d/ directory containing the following:\n\nMACs hmac-sha2-256\n\nThe SSH service must be restarted for changes to take effect."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60851r919352_chk","severity":"high","gid":"V-257166","rid":"SV-257166r919353_rule","stig_id":"APPL-13-000055","gtitle":"SRG-OS-000033-GPOS-00014","fix_id":"F-60792r916573_fix","satisfies":["SRG-OS-000033-GPOS-00014","SRG-OS-000120-GPOS-00061","SRG-OS-000125-GPOS-00065","SRG-OS-000250-GPOS-00093","SRG-OS-000393-GPOS-00173","SRG-OS-000394-GPOS-00175"],"documentable":null,"cci":["CCI-000068","CCI-000803","CCI-000877","CCI-001453","CCI-002890","CCI-003123"],"nist":["AC-17 (2)","IA-7","MA-4 c","AC-17 (2)","MA-4 (6)","MA-4 (6)"]}},{"id":"SV-257167","code":"control 'SV-257167' do\n  title 'The macOS system must implement approved Key Exchange Algorithms within the SSH server configuration.'\n  desc 'Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n'\n  desc 'check', 'Verify the macOS system is configured to use approved SSH Key Exchange Algorithms within the SSH server configuration with the following command:\n\n/usr/bin/sudo /usr/sbin/sshd -T | /usr/bin/grep \"kexalgorithms\"\n\nkexalgorithms ecdh-sha2-nistp256\n\nIf any algorithms other than \"ecdh-sha2-nistp256\" are listed, or the \"kexalgorithms\" keyword is missing, this is a finding.'\n  desc 'fix', 'Configure the macOS system to use approved SSH Key Exchange Algorithms by creating a plain text file in the /private/etc/ssh/sshd_config.d/ directory containing the following:\n\nKexAlgorithms ecdh-sha2-nistp256\n\nThe SSH service must be restarted for changes to take effect.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60852r919354_chk'\n  tag severity: 'high'\n  tag gid: 'V-257167'\n  tag rid: 'SV-257167r919355_rule'\n  tag stig_id: 'APPL-13-000056'\n  tag gtitle: 'SRG-OS-000033-GPOS-00014'\n  tag fix_id: 'F-60793r916576_fix'\n  tag satisfies: ['SRG-OS-000033-GPOS-00014', 'SRG-OS-000120-GPOS-00061', 'SRG-OS-000125-GPOS-00065', 'SRG-OS-000250-GPOS-00093', 'SRG-OS-000393-GPOS-00173', 'SRG-OS-000394-GPOS-00176']\n  tag 'documentable'\n  tag cci: ['CCI-000068', 'CCI-000803', 'CCI-000877', 'CCI-001453', 'CCI-002890', 'CCI-003123']\n  tag nist: ['AC-17 (2)', 'IA-7', 'MA-4 c', 'AC-17 (2)', 'MA-4 (6)', 'MA-4 (6)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257167.rb"},"title":"The macOS system must implement approved Key Exchange Algorithms within the SSH server configuration.","desc":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","descriptions":{"default":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","check":"Verify the macOS system is configured to use approved SSH Key Exchange Algorithms within the SSH server configuration with the following command:\n\n/usr/bin/sudo /usr/sbin/sshd -T | /usr/bin/grep \"kexalgorithms\"\n\nkexalgorithms ecdh-sha2-nistp256\n\nIf any algorithms other than \"ecdh-sha2-nistp256\" are listed, or the \"kexalgorithms\" keyword is missing, this is a finding.","fix":"Configure the macOS system to use approved SSH Key Exchange Algorithms by creating a plain text file in the /private/etc/ssh/sshd_config.d/ directory containing the following:\n\nKexAlgorithms ecdh-sha2-nistp256\n\nThe SSH service must be restarted for changes to take effect."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60852r919354_chk","severity":"high","gid":"V-257167","rid":"SV-257167r919355_rule","stig_id":"APPL-13-000056","gtitle":"SRG-OS-000033-GPOS-00014","fix_id":"F-60793r916576_fix","satisfies":["SRG-OS-000033-GPOS-00014","SRG-OS-000120-GPOS-00061","SRG-OS-000125-GPOS-00065","SRG-OS-000250-GPOS-00093","SRG-OS-000393-GPOS-00173","SRG-OS-000394-GPOS-00176"],"documentable":null,"cci":["CCI-000068","CCI-000803","CCI-000877","CCI-001453","CCI-002890","CCI-003123"],"nist":["AC-17 (2)","IA-7","MA-4 c","AC-17 (2)","MA-4 (6)","MA-4 (6)"]}},{"id":"SV-257168","code":"control 'SV-257168' do\n  title 'The macOS system must generate audit records for all account creations, modifications, disabling, and termination events; privileged activities or other system-level access; all kernel module load, unload, and restart actions; all program initiations; and organizationally defined events for all nonlocal maintenance and diagnostic sessions.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. Audit records can be generated from various components within the information system (e.g., module or policy filter). If events associated with nonlocal administrative access or diagnostic sessions are not logged, a major tool for assessing and investigating attacks would not be available.\n\nThis requirement addresses auditing-related issues associated with maintenance tools used specifically for diagnostic and repair actions on organizational information systems.\n\nAdministrative and privileged access, including administrative use of the command line tools \"kextload\" and \"kextunload\" and changes to configuration settings, are logged by way of the \"ad\" flag.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection.\n\nThis requirement applies to hardware/software diagnostic test equipment or tools. This requirement does not cover hardware/software components that may support information system maintenance, yet are a part of the system, for example, the software implementing \"ping,\" \"ls,\" \"ipconfig,\" or the hardware and software implementing the monitoring port of an Ethernet switch.\n\n'\n  desc 'check', 'Verify the macOS system is configured to audit privileged access with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control\n\nIf \"ad\" is not listed in the output, this is a finding.'\n  desc 'fix', %q(Configure the macOS system to audit privileged access with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the \"/etc/security/audit_control\" file.)\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60853r905135_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257168'\n  tag rid: 'SV-257168r905137_rule'\n  tag stig_id: 'APPL-13-001001'\n  tag gtitle: 'SRG-OS-000004-GPOS-00004'\n  tag fix_id: 'F-60794r905136_fix'\n  tag satisfies: ['SRG-OS-000004-GPOS-00004', 'SRG-OS-000239-GPOS-00089', 'SRG-OS-000240-GPOS-00090', 'SRG-OS-000241-GPOS-00091', 'SRG-OS-000327-GPOS-00127', 'SRG-OS-000392-GPOS-00172', 'SRG-OS-000471-GPOS-00215', 'SRG-OS-000471-GPOS-00216', 'SRG-OS-000476-GPOS-00221', 'SRG-OS-000477-GPOS-00222']\n  tag 'documentable'\n  tag cci: ['CCI-000018', 'CCI-000172', 'CCI-001403', 'CCI-001404', 'CCI-001405', 'CCI-002234', 'CCI-002884']\n  tag nist: ['AC-2 (4)', 'AU-12 c', 'AC-2 (4)', 'AC-2 (4)', 'AC-2 (4)', 'AC-6 (9)', 'MA-4 (1) (a)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257168.rb"},"title":"The macOS system must generate audit records for all account creations, modifications, disabling, and termination events; privileged activities or other system-level access; all kernel module load, unload, and restart actions; all program initiations; and organizationally defined events for all nonlocal maintenance and diagnostic sessions.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. Audit records can be generated from various components within the information system (e.g., module or policy filter). If events associated with nonlocal administrative access or diagnostic sessions are not logged, a major tool for assessing and investigating attacks would not be available.\n\nThis requirement addresses auditing-related issues associated with maintenance tools used specifically for diagnostic and repair actions on organizational information systems.\n\nAdministrative and privileged access, including administrative use of the command line tools \"kextload\" and \"kextunload\" and changes to configuration settings, are logged by way of the \"ad\" flag.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection.\n\nThis requirement applies to hardware/software diagnostic test equipment or tools. This requirement does not cover hardware/software components that may support information system maintenance, yet are a part of the system, for example, the software implementing \"ping,\" \"ls,\" \"ipconfig,\" or the hardware and software implementing the monitoring port of an Ethernet switch.\n\n","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. Audit records can be generated from various components within the information system (e.g., module or policy filter). If events associated with nonlocal administrative access or diagnostic sessions are not logged, a major tool for assessing and investigating attacks would not be available.\n\nThis requirement addresses auditing-related issues associated with maintenance tools used specifically for diagnostic and repair actions on organizational information systems.\n\nAdministrative and privileged access, including administrative use of the command line tools \"kextload\" and \"kextunload\" and changes to configuration settings, are logged by way of the \"ad\" flag.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection.\n\nThis requirement applies to hardware/software diagnostic test equipment or tools. This requirement does not cover hardware/software components that may support information system maintenance, yet are a part of the system, for example, the software implementing \"ping,\" \"ls,\" \"ipconfig,\" or the hardware and software implementing the monitoring port of an Ethernet switch.\n\n","check":"Verify the macOS system is configured to audit privileged access with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control\n\nIf \"ad\" is not listed in the output, this is a finding.","fix":"Configure the macOS system to audit privileged access with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the \"/etc/security/audit_control\" file."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60853r905135_chk","severity":"medium","gid":"V-257168","rid":"SV-257168r905137_rule","stig_id":"APPL-13-001001","gtitle":"SRG-OS-000004-GPOS-00004","fix_id":"F-60794r905136_fix","satisfies":["SRG-OS-000004-GPOS-00004","SRG-OS-000239-GPOS-00089","SRG-OS-000240-GPOS-00090","SRG-OS-000241-GPOS-00091","SRG-OS-000327-GPOS-00127","SRG-OS-000392-GPOS-00172","SRG-OS-000471-GPOS-00215","SRG-OS-000471-GPOS-00216","SRG-OS-000476-GPOS-00221","SRG-OS-000477-GPOS-00222"],"documentable":null,"cci":["CCI-000018","CCI-000172","CCI-001403","CCI-001404","CCI-001405","CCI-002234","CCI-002884"],"nist":["AC-2 (4)","AU-12 c","AC-2 (4)","AC-2 (4)","AC-2 (4)","AC-6 (9)","MA-4 (1) (a)"]}},{"id":"SV-257169","code":"control 'SV-257169' do\n  title 'The macOS system must monitor remote access methods and generate audit records when successful/unsuccessful attempts to access/modify privileges occur.'\n  desc 'Frequently, an attacker that successfully gains access to a system has only gained access to an account with limited privileges, such as a guest account or a service account. The attacker must attempt to change to another user account with normal or elevated privileges to proceed. Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nAttempts to log in as another user are logged by way of the \"lo\" flag.\n\n'\n  desc 'check', 'Verify the macOS system is configured to audit attempts to access/modify privileges with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control\n\nIf \"lo\" is not listed in the result of the check, this is a finding.'\n  desc 'fix', %q(Configure the macOS system to audit attempts to access/modify privileges with the following command:\n\n/usr/bin/sudo sed -i.bak '/^flags/ s/$/,lo/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the \"/etc/security/audit_control\" file.)\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60854r905138_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257169'\n  tag rid: 'SV-257169r905140_rule'\n  tag stig_id: 'APPL-13-001002'\n  tag gtitle: 'SRG-OS-000032-GPOS-00013'\n  tag fix_id: 'F-60795r905139_fix'\n  tag satisfies: ['SRG-OS-000032-GPOS-00013', 'SRG-OS-000462-GPOS-00206']\n  tag 'documentable'\n  tag cci: ['CCI-000067', 'CCI-000172']\n  tag nist: ['AC-17 (1)', 'AU-12 c']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257169.rb"},"title":"The macOS system must monitor remote access methods and generate audit records when successful/unsuccessful attempts to access/modify privileges occur.","desc":"Frequently, an attacker that successfully gains access to a system has only gained access to an account with limited privileges, such as a guest account or a service account. The attacker must attempt to change to another user account with normal or elevated privileges to proceed. Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nAttempts to log in as another user are logged by way of the \"lo\" flag.\n\n","descriptions":{"default":"Frequently, an attacker that successfully gains access to a system has only gained access to an account with limited privileges, such as a guest account or a service account. The attacker must attempt to change to another user account with normal or elevated privileges to proceed. Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nAttempts to log in as another user are logged by way of the \"lo\" flag.\n\n","check":"Verify the macOS system is configured to audit attempts to access/modify privileges with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control\n\nIf \"lo\" is not listed in the result of the check, this is a finding.","fix":"Configure the macOS system to audit attempts to access/modify privileges with the following command:\n\n/usr/bin/sudo sed -i.bak '/^flags/ s/$/,lo/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the \"/etc/security/audit_control\" file."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60854r905138_chk","severity":"medium","gid":"V-257169","rid":"SV-257169r905140_rule","stig_id":"APPL-13-001002","gtitle":"SRG-OS-000032-GPOS-00013","fix_id":"F-60795r905139_fix","satisfies":["SRG-OS-000032-GPOS-00013","SRG-OS-000462-GPOS-00206"],"documentable":null,"cci":["CCI-000067","CCI-000172"],"nist":["AC-17 (1)","AU-12 c"]}},{"id":"SV-257170","code":"control 'SV-257170' do\n  title 'The macOS system must produce audit records containing information to establish when, where, what type, the source, and the outcome for all DOD-defined auditable events and actions.'\n  desc 'Without establishing what type of events occurred, when they occurred, and by whom, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the operating system audit logs provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured operating system.\n\n'\n  desc 'check', 'Verify the macOS system is configured to enable the auditd service with the following command:\n\n/bin/launchctl print-disabled system| /usr/bin/grep com.apple.auditd\n\n\"com.apple.auditd\" => enabled\n\nIf the results are not \"com.apple.auditd => enabled\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to enable the auditd service with the following command:\n\n/usr/bin/sudo /bin/launchctl enable system/com.apple.auditd\n\nThe system may need to be restarted for the update to take effect.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60855r905141_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257170'\n  tag rid: 'SV-257170r905143_rule'\n  tag stig_id: 'APPL-13-001003'\n  tag gtitle: 'SRG-OS-000037-GPOS-00015'\n  tag fix_id: 'F-60796r905142_fix'\n  tag satisfies: ['SRG-OS-000037-GPOS-00015', 'SRG-OS-000038-GPOS-00016', 'SRG-OS-000039-GPOS-00017', 'SRG-OS-000040-GPOS-00018', 'SRG-OS-000041-GPOS-00019', 'SRG-OS-000042-GPOS-00020', 'SRG-OS-000042-GPOS-00021', 'SRG-OS-000055-GPOS-00026', 'SRG-OS-000254-GPOS-00095', 'SRG-OS-000255-GPOS-00096', 'SRG-OS-000303-GPOS-00120', 'SRG-OS-000337-GPOS-00129', 'SRG-OS-000358-GPOS-00145', 'SRG-OS-000359-GPOS-00146']\n  tag 'documentable'\n  tag cci: ['CCI-000130', 'CCI-000131', 'CCI-000132', 'CCI-000133', 'CCI-000134', 'CCI-000135', 'CCI-000159', 'CCI-001464', 'CCI-001487', 'CCI-001889', 'CCI-001890', 'CCI-001914', 'CCI-002130']\n  tag nist: ['AU-3 a', 'AU-3 b', 'AU-3 c', 'AU-3 d', 'AU-3 e', 'AU-3 (1)', 'AU-8 a', 'AU-14 (1)', 'AU-3 f', 'AU-8 b', 'AU-8 b', 'AU-12 (3)', 'AC-2 (4)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257170.rb"},"title":"The macOS system must produce audit records containing information to establish when, where, what type, the source, and the outcome for all DOD-defined auditable events and actions.","desc":"Without establishing what type of events occurred, when they occurred, and by whom, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the operating system audit logs provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured operating system.\n\n","descriptions":{"default":"Without establishing what type of events occurred, when they occurred, and by whom, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the operating system audit logs provides a means of investigating an attack, recognizing resource utilization or capacity thresholds, or identifying an improperly configured operating system.\n\n","check":"Verify the macOS system is configured to enable the auditd service with the following command:\n\n/bin/launchctl print-disabled system| /usr/bin/grep com.apple.auditd\n\n\"com.apple.auditd\" => enabled\n\nIf the results are not \"com.apple.auditd => enabled\", this is a finding.","fix":"Configure the macOS system to enable the auditd service with the following command:\n\n/usr/bin/sudo /bin/launchctl enable system/com.apple.auditd\n\nThe system may need to be restarted for the update to take effect."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60855r905141_chk","severity":"medium","gid":"V-257170","rid":"SV-257170r905143_rule","stig_id":"APPL-13-001003","gtitle":"SRG-OS-000037-GPOS-00015","fix_id":"F-60796r905142_fix","satisfies":["SRG-OS-000037-GPOS-00015","SRG-OS-000038-GPOS-00016","SRG-OS-000039-GPOS-00017","SRG-OS-000040-GPOS-00018","SRG-OS-000041-GPOS-00019","SRG-OS-000042-GPOS-00020","SRG-OS-000042-GPOS-00021","SRG-OS-000055-GPOS-00026","SRG-OS-000254-GPOS-00095","SRG-OS-000255-GPOS-00096","SRG-OS-000303-GPOS-00120","SRG-OS-000337-GPOS-00129","SRG-OS-000358-GPOS-00145","SRG-OS-000359-GPOS-00146"],"documentable":null,"cci":["CCI-000130","CCI-000131","CCI-000132","CCI-000133","CCI-000134","CCI-000135","CCI-000159","CCI-001464","CCI-001487","CCI-001889","CCI-001890","CCI-001914","CCI-002130"],"nist":["AU-3 a","AU-3 b","AU-3 c","AU-3 d","AU-3 e","AU-3 (1)","AU-8 a","AU-14 (1)","AU-3 f","AU-8 b","AU-8 b","AU-12 (3)","AC-2 (4)"]}},{"id":"SV-257171","code":"control 'SV-257171' do\n  title 'The macOS system must shut down by default upon audit failure (unless availability is an overriding concern).'\n  desc 'The audit service should shut down the computer if it is unable to audit system events. Once audit failure occurs, user and system activity are no longer recorded and malicious activity could go undetected. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Responses to audit failure depend on the nature of the failure mode.\n\nWhen availability is an overriding concern, other approved actions in response to an audit failure are as follows: \n\n(i) If the failure was caused by the lack of audit record storage capacity, the operating system must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.\n\n(ii) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the operating system must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.'\n  desc 'check', 'Verify the macOS system is configured to shut down upon audit failure with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^policy /etc/security/audit_control | /usr/bin/grep ahlt\n\nIf there is no result, this is a finding.'\n  desc 'fix', %q(Configure the macOS system to shut down upon audit failure by editing the \"/etc/security/audit_control\" file and updating the policy value to include \"ahlt\" with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak '/^policy/ s/$/,ahlt/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s)\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60856r905144_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257171'\n  tag rid: 'SV-257171r905146_rule'\n  tag stig_id: 'APPL-13-001010'\n  tag gtitle: 'SRG-OS-000047-GPOS-00023'\n  tag fix_id: 'F-60797r905145_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000140']\n  tag nist: ['AU-5 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257171.rb"},"title":"The macOS system must shut down by default upon audit failure (unless availability is an overriding concern).","desc":"The audit service should shut down the computer if it is unable to audit system events. Once audit failure occurs, user and system activity are no longer recorded and malicious activity could go undetected. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Responses to audit failure depend on the nature of the failure mode.\n\nWhen availability is an overriding concern, other approved actions in response to an audit failure are as follows: \n\n(i) If the failure was caused by the lack of audit record storage capacity, the operating system must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.\n\n(ii) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the operating system must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.","descriptions":{"default":"The audit service should shut down the computer if it is unable to audit system events. Once audit failure occurs, user and system activity are no longer recorded and malicious activity could go undetected. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. Responses to audit failure depend on the nature of the failure mode.\n\nWhen availability is an overriding concern, other approved actions in response to an audit failure are as follows: \n\n(i) If the failure was caused by the lack of audit record storage capacity, the operating system must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.\n\n(ii) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the operating system must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.","check":"Verify the macOS system is configured to shut down upon audit failure with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^policy /etc/security/audit_control | /usr/bin/grep ahlt\n\nIf there is no result, this is a finding.","fix":"Configure the macOS system to shut down upon audit failure by editing the \"/etc/security/audit_control\" file and updating the policy value to include \"ahlt\" with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak '/^policy/ s/$/,ahlt/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60856r905144_chk","severity":"medium","gid":"V-257171","rid":"SV-257171r905146_rule","stig_id":"APPL-13-001010","gtitle":"SRG-OS-000047-GPOS-00023","fix_id":"F-60797r905145_fix","documentable":null,"cci":["CCI-000140"],"nist":["AU-5 b"]}},{"id":"SV-257172","code":"control 'SV-257172' do\n  title 'The macOS system must be configured with audit log files owned by root.'\n  desc 'The audit service must be configured to create log files with the correct ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to only be readable and writable by root or administrative users with sudo, the risk is mitigated.'\n  desc 'check', \"Verify the macOS system is configured with audit log files owned by root with the following command:\n\n/usr/bin/sudo /bin/ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/grep -v current\n\nIf the files are not owned by root, this is a finding.\"\n  desc 'fix', 'Configure the macOS system with audit log files owned by root with the following command:\n\n/usr/bin/sudo chown root [audit log file]'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60857r905147_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257172'\n  tag rid: 'SV-257172r905149_rule'\n  tag stig_id: 'APPL-13-001012'\n  tag gtitle: 'SRG-OS-000057-GPOS-00027'\n  tag fix_id: 'F-60798r905148_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000162']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257172.rb"},"title":"The macOS system must be configured with audit log files owned by root.","desc":"The audit service must be configured to create log files with the correct ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to only be readable and writable by root or administrative users with sudo, the risk is mitigated.","descriptions":{"default":"The audit service must be configured to create log files with the correct ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to only be readable and writable by root or administrative users with sudo, the risk is mitigated.","check":"Verify the macOS system is configured with audit log files owned by root with the following command:\n\n/usr/bin/sudo /bin/ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/grep -v current\n\nIf the files are not owned by root, this is a finding.","fix":"Configure the macOS system with audit log files owned by root with the following command:\n\n/usr/bin/sudo chown root [audit log file]"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60857r905147_chk","severity":"medium","gid":"V-257172","rid":"SV-257172r905149_rule","stig_id":"APPL-13-001012","gtitle":"SRG-OS-000057-GPOS-00027","fix_id":"F-60798r905148_fix","documentable":null,"cci":["CCI-000162"],"nist":["AU-9 a"]}},{"id":"SV-257173","code":"control 'SV-257173' do\n  title 'The macOS system must be configured with audit log folders owned by root.'\n  desc 'The audit service must be configured to create log files with the correct ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.'\n  desc 'check', \"Verify the macOS system is configured with audit log folders owned by root with the following command:\n\n/usr/bin/sudo /bin/ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')\n\nIf the folders are not owned by root, this is a finding.\"\n  desc 'fix', 'Configure the macOS system with audit log folders owned by root with the following command:\n\n/usr/bin/sudo chown root [audit log folder]'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60858r905150_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257173'\n  tag rid: 'SV-257173r905152_rule'\n  tag stig_id: 'APPL-13-001013'\n  tag gtitle: 'SRG-OS-000057-GPOS-00027'\n  tag fix_id: 'F-60799r905151_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000162']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257173.rb"},"title":"The macOS system must be configured with audit log folders owned by root.","desc":"The audit service must be configured to create log files with the correct ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.","descriptions":{"default":"The audit service must be configured to create log files with the correct ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.","check":"Verify the macOS system is configured with audit log folders owned by root with the following command:\n\n/usr/bin/sudo /bin/ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')\n\nIf the folders are not owned by root, this is a finding.","fix":"Configure the macOS system with audit log folders owned by root with the following command:\n\n/usr/bin/sudo chown root [audit log folder]"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60858r905150_chk","severity":"medium","gid":"V-257173","rid":"SV-257173r905152_rule","stig_id":"APPL-13-001013","gtitle":"SRG-OS-000057-GPOS-00027","fix_id":"F-60799r905151_fix","documentable":null,"cci":["CCI-000162"],"nist":["AU-9 a"]}},{"id":"SV-257174","code":"control 'SV-257174' do\n  title 'The macOS system must be configured with audit log files group-owned by wheel.'\n  desc 'The audit service must be configured to create log files with the correct group ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.'\n  desc 'check', \"Verify the macOS system is configured with audit log files group-owned by wheel with the following command:\n\n/usr/bin/sudo /bin/ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/grep -v current\n\nIf the files are not group-owned by wheel, this is a finding.\"\n  desc 'fix', 'Configure the macOS system with audit log files group-owned by wheel with the following command:\n\n/usr/bin/sudo chgrp wheel [audit log file]'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60859r905153_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257174'\n  tag rid: 'SV-257174r905155_rule'\n  tag stig_id: 'APPL-13-001014'\n  tag gtitle: 'SRG-OS-000057-GPOS-00027'\n  tag fix_id: 'F-60800r905154_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000162']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257174.rb"},"title":"The macOS system must be configured with audit log files group-owned by wheel.","desc":"The audit service must be configured to create log files with the correct group ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.","descriptions":{"default":"The audit service must be configured to create log files with the correct group ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.","check":"Verify the macOS system is configured with audit log files group-owned by wheel with the following command:\n\n/usr/bin/sudo /bin/ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/grep -v current\n\nIf the files are not group-owned by wheel, this is a finding.","fix":"Configure the macOS system with audit log files group-owned by wheel with the following command:\n\n/usr/bin/sudo chgrp wheel [audit log file]"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60859r905153_chk","severity":"medium","gid":"V-257174","rid":"SV-257174r905155_rule","stig_id":"APPL-13-001014","gtitle":"SRG-OS-000057-GPOS-00027","fix_id":"F-60800r905154_fix","documentable":null,"cci":["CCI-000162"],"nist":["AU-9 a"]}},{"id":"SV-257175","code":"control 'SV-257175' do\n  title 'The macOS system must be configured with audit log folders group-owned by wheel.'\n  desc 'The audit service must be configured to create log files with the correct group ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.'\n  desc 'check', \"Verify the macOS system is configured with audit log folders group-owned by wheel with the following command:\n\n/usr/bin/sudo /bin/ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')\n\nIf the folders are not group-owned by wheel, this is a finding.\"\n  desc 'fix', 'Configure the macOS system with audit log folders group-owned by wheel with the following command:\n\n/usr/bin/sudo chgrp wheel [audit log folder]'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60860r905156_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257175'\n  tag rid: 'SV-257175r905158_rule'\n  tag stig_id: 'APPL-13-001015'\n  tag gtitle: 'SRG-OS-000057-GPOS-00027'\n  tag fix_id: 'F-60801r905157_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000162']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257175.rb"},"title":"The macOS system must be configured with audit log folders group-owned by wheel.","desc":"The audit service must be configured to create log files with the correct group ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.","descriptions":{"default":"The audit service must be configured to create log files with the correct group ownership to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.","check":"Verify the macOS system is configured with audit log folders group-owned by wheel with the following command:\n\n/usr/bin/sudo /bin/ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')\n\nIf the folders are not group-owned by wheel, this is a finding.","fix":"Configure the macOS system with audit log folders group-owned by wheel with the following command:\n\n/usr/bin/sudo chgrp wheel [audit log folder]"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60860r905156_chk","severity":"medium","gid":"V-257175","rid":"SV-257175r905158_rule","stig_id":"APPL-13-001015","gtitle":"SRG-OS-000057-GPOS-00027","fix_id":"F-60801r905157_fix","documentable":null,"cci":["CCI-000162"],"nist":["AU-9 a"]}},{"id":"SV-257176","code":"control 'SV-257176' do\n  title 'The macOS system must be configured with audit log files set to mode 440 or less permissive.'\n  desc 'The audit service must be configured to create log files with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.'\n  desc 'check', \"Verify the macOS system is configured with audit log files set to mode 440 or less with the following command:\n\n/usr/bin/sudo /bin/ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/grep -v current\n\nIf the files are not mode 440 or less, this is a finding.\"\n  desc 'fix', 'Configure the macOS system with audit log files set to mode 440 with the following command:\n\n/usr/bin/sudo /bin/chmod 440 [audit log file]'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60861r905159_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257176'\n  tag rid: 'SV-257176r905161_rule'\n  tag stig_id: 'APPL-13-001016'\n  tag gtitle: 'SRG-OS-000057-GPOS-00027'\n  tag fix_id: 'F-60802r905160_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000162']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257176.rb"},"title":"The macOS system must be configured with audit log files set to mode 440 or less permissive.","desc":"The audit service must be configured to create log files with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.","descriptions":{"default":"The audit service must be configured to create log files with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and about users. If log files are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.","check":"Verify the macOS system is configured with audit log files set to mode 440 or less with the following command:\n\n/usr/bin/sudo /bin/ls -le $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/grep -v current\n\nIf the files are not mode 440 or less, this is a finding.","fix":"Configure the macOS system with audit log files set to mode 440 with the following command:\n\n/usr/bin/sudo /bin/chmod 440 [audit log file]"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60861r905159_chk","severity":"medium","gid":"V-257176","rid":"SV-257176r905161_rule","stig_id":"APPL-13-001016","gtitle":"SRG-OS-000057-GPOS-00027","fix_id":"F-60802r905160_fix","documentable":null,"cci":["CCI-000162"],"nist":["AU-9 a"]}},{"id":"SV-257177","code":"control 'SV-257177' do\n  title 'The macOS system must be configured with audit log folders set to mode 700 or less permissive.'\n  desc 'The audit service must be configured to create log folders with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log folders are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.\n\n'\n  desc 'check', \"Verify the macOS system is configured with audit log folders set to mode 700 or less with the following command:\n\n/usr/bin/sudo /bin/ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')\n\nIf the folders are not set to mode 700 or less, this is a finding.\"\n  desc 'fix', 'Configure the macOS system with audit log folders set to mode 700 with the following command:\n\n/usr/bin/sudo /bin/chmod 700 [audit log folder]'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60862r905162_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257177'\n  tag rid: 'SV-257177r905164_rule'\n  tag stig_id: 'APPL-13-001017'\n  tag gtitle: 'SRG-OS-000057-GPOS-00027'\n  tag fix_id: 'F-60803r905163_fix'\n  tag satisfies: ['SRG-OS-000057-GPOS-00027', 'SRG-OS-000058-GPOS-00028', 'SRG-OS-000059-GPOS-00029']\n  tag 'documentable'\n  tag cci: ['CCI-000162', 'CCI-000163', 'CCI-000164']\n  tag nist: ['AU-9 a', 'AU-9 a', 'AU-9 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257177.rb"},"title":"The macOS system must be configured with audit log folders set to mode 700 or less permissive.","desc":"The audit service must be configured to create log folders with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log folders are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.\n\n","descriptions":{"default":"The audit service must be configured to create log folders with the correct permissions to prevent normal users from reading audit logs. Audit logs contain sensitive data about the system and users. If log folders are set to be readable and writable only by root or administrative users with sudo, the risk is mitigated.\n\n","check":"Verify the macOS system is configured with audit log folders set to mode 700 or less with the following command:\n\n/usr/bin/sudo /bin/ls -lde $(/usr/bin/sudo /usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')\n\nIf the folders are not set to mode 700 or less, this is a finding.","fix":"Configure the macOS system with audit log folders set to mode 700 with the following command:\n\n/usr/bin/sudo /bin/chmod 700 [audit log folder]"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60862r905162_chk","severity":"medium","gid":"V-257177","rid":"SV-257177r905164_rule","stig_id":"APPL-13-001017","gtitle":"SRG-OS-000057-GPOS-00027","fix_id":"F-60803r905163_fix","satisfies":["SRG-OS-000057-GPOS-00027","SRG-OS-000058-GPOS-00028","SRG-OS-000059-GPOS-00029"],"documentable":null,"cci":["CCI-000162","CCI-000163","CCI-000164"],"nist":["AU-9 a","AU-9 a","AU-9 a"]}},{"id":"SV-257178","code":"control 'SV-257178' do\n  title 'The macOS system must audit the enforcement actions used to restrict access associated with changes to the system.'\n  desc 'By auditing access restriction enforcement, changes to application and OS configuration files can be audited. Without auditing the enforcement of access restrictions, it will be difficult to identify attempted attacks and an audit trail will not be available for forensic investigation.\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. Enforcement action methods may be as simple as denying access to a file based on the application of file permissions (access restriction). Audit items may consist of lists of actions blocked by access restrictions or changes identified after the fact.\n\nEnforcement actions are logged by way of the \"fm\" flag, which audits permission changes; \"-fr\" and \"-fw\", which denote failed attempts to read or write to a file; and \"-fd\", which audits failed file deletion.\n\nWithout generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n'\n  desc 'check', 'Verify the macOS system is configured to audit enforcement actions with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control\n\nIf \"fm\", \"-fr\", \"-fw\", and \"-fd\" are not listed in the result of the check, this is a finding.'\n  desc 'fix', %q(Configure the macOS system to audit enforcement actions with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,fm,-fr,-fw,-fd/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the \"/etc/security/audit_control\" file.)\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60863r905165_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257178'\n  tag rid: 'SV-257178r905167_rule'\n  tag stig_id: 'APPL-13-001020'\n  tag gtitle: 'SRG-OS-000064-GPOS-00033'\n  tag fix_id: 'F-60804r905166_fix'\n  tag satisfies: ['SRG-OS-000064-GPOS-00033', 'SRG-OS-000365-GPOS-00152', 'SRG-OS-000458-GPOS-00203', 'SRG-OS-000461-GPOS-00205', 'SRG-OS-000463-GPOS-00207', 'SRG-OS-000465-GPOS-00209', 'SRG-OS-000466-GPOS-00210', 'SRG-OS-000467-GPOS-00211', 'SRG-OS-000468-GPOS-00212', 'SRG-OS-000474-GPOS-00219']\n  tag 'documentable'\n  tag cci: ['CCI-000172', 'CCI-001814']\n  tag nist: ['AU-12 c', 'CM-5 (1)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257178.rb"},"title":"The macOS system must audit the enforcement actions used to restrict access associated with changes to the system.","desc":"By auditing access restriction enforcement, changes to application and OS configuration files can be audited. Without auditing the enforcement of access restrictions, it will be difficult to identify attempted attacks and an audit trail will not be available for forensic investigation.\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. Enforcement action methods may be as simple as denying access to a file based on the application of file permissions (access restriction). Audit items may consist of lists of actions blocked by access restrictions or changes identified after the fact.\n\nEnforcement actions are logged by way of the \"fm\" flag, which audits permission changes; \"-fr\" and \"-fw\", which denote failed attempts to read or write to a file; and \"-fd\", which audits failed file deletion.\n\nWithout generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n","descriptions":{"default":"By auditing access restriction enforcement, changes to application and OS configuration files can be audited. Without auditing the enforcement of access restrictions, it will be difficult to identify attempted attacks and an audit trail will not be available for forensic investigation.\n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. Enforcement action methods may be as simple as denying access to a file based on the application of file permissions (access restriction). Audit items may consist of lists of actions blocked by access restrictions or changes identified after the fact.\n\nEnforcement actions are logged by way of the \"fm\" flag, which audits permission changes; \"-fr\" and \"-fw\", which denote failed attempts to read or write to a file; and \"-fd\", which audits failed file deletion.\n\nWithout generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n","check":"Verify the macOS system is configured to audit enforcement actions with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control\n\nIf \"fm\", \"-fr\", \"-fw\", and \"-fd\" are not listed in the result of the check, this is a finding.","fix":"Configure the macOS system to audit enforcement actions with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,fm,-fr,-fw,-fd/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the \"/etc/security/audit_control\" file."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60863r905165_chk","severity":"medium","gid":"V-257178","rid":"SV-257178r905167_rule","stig_id":"APPL-13-001020","gtitle":"SRG-OS-000064-GPOS-00033","fix_id":"F-60804r905166_fix","satisfies":["SRG-OS-000064-GPOS-00033","SRG-OS-000365-GPOS-00152","SRG-OS-000458-GPOS-00203","SRG-OS-000461-GPOS-00205","SRG-OS-000463-GPOS-00207","SRG-OS-000465-GPOS-00209","SRG-OS-000466-GPOS-00210","SRG-OS-000467-GPOS-00211","SRG-OS-000468-GPOS-00212","SRG-OS-000474-GPOS-00219"],"documentable":null,"cci":["CCI-000172","CCI-001814"],"nist":["AU-12 c","CM-5 (1)"]}},{"id":"SV-257179","code":"control 'SV-257179' do\n  title 'The macOS system must allocate audit record storage capacity to store at least seven days of audit records when audit records are not immediately sent to a central audit record storage facility.'\n  desc 'The audit service must be configured to require that records are kept for seven days or longer before deletion when there is no central audit record storage facility. When \"expire-after\" is set to \"7d\", the audit service will not delete audit logs until the log data is at least seven days old.'\n  desc 'check', 'Verify the macOS system is configured to store at least seven days of audit records with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^expire-after /etc/security/audit_control\n\nexpire-after:7d\n\nIf \"expire-after\" is not set to \"7d\" or greater, this is a finding.'\n  desc 'fix', %q(Configure the macOS system to store seven days of audit records with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*expire-after.*/expire-after:7d/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nAlternatively, use a text editor to update the \"/etc/security/audit_control\" file.)\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60864r905168_chk'\n  tag severity: 'low'\n  tag gid: 'V-257179'\n  tag rid: 'SV-257179r905170_rule'\n  tag stig_id: 'APPL-13-001029'\n  tag gtitle: 'SRG-OS-000341-GPOS-00132'\n  tag fix_id: 'F-60805r905169_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001849']\n  tag nist: ['AU-4']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257179.rb"},"title":"The macOS system must allocate audit record storage capacity to store at least seven days of audit records when audit records are not immediately sent to a central audit record storage facility.","desc":"The audit service must be configured to require that records are kept for seven days or longer before deletion when there is no central audit record storage facility. When \"expire-after\" is set to \"7d\", the audit service will not delete audit logs until the log data is at least seven days old.","descriptions":{"default":"The audit service must be configured to require that records are kept for seven days or longer before deletion when there is no central audit record storage facility. When \"expire-after\" is set to \"7d\", the audit service will not delete audit logs until the log data is at least seven days old.","check":"Verify the macOS system is configured to store at least seven days of audit records with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^expire-after /etc/security/audit_control\n\nexpire-after:7d\n\nIf \"expire-after\" is not set to \"7d\" or greater, this is a finding.","fix":"Configure the macOS system to store seven days of audit records with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*expire-after.*/expire-after:7d/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nAlternatively, use a text editor to update the \"/etc/security/audit_control\" file."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60864r905168_chk","severity":"low","gid":"V-257179","rid":"SV-257179r905170_rule","stig_id":"APPL-13-001029","gtitle":"SRG-OS-000341-GPOS-00132","fix_id":"F-60805r905169_fix","documentable":null,"cci":["CCI-001849"],"nist":["AU-4"]}},{"id":"SV-257180","code":"control 'SV-257180' do\n  title 'The macOS system must provide an immediate warning to the System Administrator (SA) and Information System Security Officer (ISSO) (at a minimum) when allocated audit record storage volume reaches 75 percent of repository maximum audit record storage capacity.'\n  desc 'The audit service must be configured to require a minimum percentage of free disk space to run. This ensures that audit will notify the administrator that action is required to free up more disk space for audit logs.\n\nWhen \"minfree\" is set to 25 percent, security personnel are notified immediately when the storage volume is 75 percent full and are able to plan for audit record storage capacity expansion.'\n  desc 'check', 'Verify the macOS system is configured to require a minimum of 25 percent free disk space for audit record storage with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^minfree /etc/security/audit_control\n\nminfree:25\n\nIf \"minfree\" is not set to \"25\", this is a finding.'\n  desc 'fix', %q(Configure the macOS system to require 25 percent free disk space for audit record storage with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*minfree.*/minfree:25/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nAlternatively, use a text editor to update the \"/etc/security/audit_control\" file.)\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60865r905171_chk'\n  tag severity: 'low'\n  tag gid: 'V-257180'\n  tag rid: 'SV-257180r905173_rule'\n  tag stig_id: 'APPL-13-001030'\n  tag gtitle: 'SRG-OS-000343-GPOS-00134'\n  tag fix_id: 'F-60806r905172_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001855']\n  tag nist: ['AU-5 (1)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257180.rb"},"title":"The macOS system must provide an immediate warning to the System Administrator (SA) and Information System Security Officer (ISSO) (at a minimum) when allocated audit record storage volume reaches 75 percent of repository maximum audit record storage capacity.","desc":"The audit service must be configured to require a minimum percentage of free disk space to run. This ensures that audit will notify the administrator that action is required to free up more disk space for audit logs.\n\nWhen \"minfree\" is set to 25 percent, security personnel are notified immediately when the storage volume is 75 percent full and are able to plan for audit record storage capacity expansion.","descriptions":{"default":"The audit service must be configured to require a minimum percentage of free disk space to run. This ensures that audit will notify the administrator that action is required to free up more disk space for audit logs.\n\nWhen \"minfree\" is set to 25 percent, security personnel are notified immediately when the storage volume is 75 percent full and are able to plan for audit record storage capacity expansion.","check":"Verify the macOS system is configured to require a minimum of 25 percent free disk space for audit record storage with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^minfree /etc/security/audit_control\n\nminfree:25\n\nIf \"minfree\" is not set to \"25\", this is a finding.","fix":"Configure the macOS system to require 25 percent free disk space for audit record storage with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/.*minfree.*/minfree:25/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nAlternatively, use a text editor to update the \"/etc/security/audit_control\" file."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60865r905171_chk","severity":"low","gid":"V-257180","rid":"SV-257180r905173_rule","stig_id":"APPL-13-001030","gtitle":"SRG-OS-000343-GPOS-00134","fix_id":"F-60806r905172_fix","documentable":null,"cci":["CCI-001855"],"nist":["AU-5 (1)"]}},{"id":"SV-257181","code":"control 'SV-257181' do\n  title 'The macOS system must provide an immediate real-time alert to the System Administrator (SA) and Information System Security Officer (ISSO), at a minimum, of all audit failure events requiring real-time alerts.'\n  desc 'The audit service must be configured to immediately print messages to the console or email administrator users when an auditing failure occurs. It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.'\n  desc 'check', 'Verify the macOS system is configured to print error messages to the console with the following command:\n\n/usr/bin/sudo /usr/bin/grep logger /etc/security/audit_warn\n\nlogger -s -p security.warning \"audit warning: $type $argument\"\n\nIf the argument \"-s\" is missing, or if \"audit_warn\" has not been otherwise modified to print errors to the console or send email alerts to the SA and ISSO, this is a finding.'\n  desc 'fix', %q(Configure the macOS system to print error messages to the console with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/logger -p/logger -s -p/' /etc/security/audit_warn; /usr/bin/sudo /usr/sbin/audit -s\n\nAlternatively, use a text editor to update the \"/etc/security/audit_warn\" file.)\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60866r905174_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257181'\n  tag rid: 'SV-257181r905176_rule'\n  tag stig_id: 'APPL-13-001031'\n  tag gtitle: 'SRG-OS-000344-GPOS-00135'\n  tag fix_id: 'F-60807r905175_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001858']\n  tag nist: ['AU-5 (2)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257181.rb"},"title":"The macOS system must provide an immediate real-time alert to the System Administrator (SA) and Information System Security Officer (ISSO), at a minimum, of all audit failure events requiring real-time alerts.","desc":"The audit service must be configured to immediately print messages to the console or email administrator users when an auditing failure occurs. It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.","descriptions":{"default":"The audit service must be configured to immediately print messages to the console or email administrator users when an auditing failure occurs. It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected.","check":"Verify the macOS system is configured to print error messages to the console with the following command:\n\n/usr/bin/sudo /usr/bin/grep logger /etc/security/audit_warn\n\nlogger -s -p security.warning \"audit warning: $type $argument\"\n\nIf the argument \"-s\" is missing, or if \"audit_warn\" has not been otherwise modified to print errors to the console or send email alerts to the SA and ISSO, this is a finding.","fix":"Configure the macOS system to print error messages to the console with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/logger -p/logger -s -p/' /etc/security/audit_warn; /usr/bin/sudo /usr/sbin/audit -s\n\nAlternatively, use a text editor to update the \"/etc/security/audit_warn\" file."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60866r905174_chk","severity":"medium","gid":"V-257181","rid":"SV-257181r905176_rule","stig_id":"APPL-13-001031","gtitle":"SRG-OS-000344-GPOS-00135","fix_id":"F-60807r905175_fix","documentable":null,"cci":["CCI-001858"],"nist":["AU-5 (2)"]}},{"id":"SV-257182","code":"control 'SV-257182' do\n  title 'The macOS system must generate audit records for DOD-defined events such as successful/unsuccessful logon attempts, successful/unsuccessful direct access attempts, starting and ending time for user access, and concurrent logons to the same account from different sources.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nLogon events are logged by way of the \"aa\" flag.\n\n'\n  desc 'check', 'Verify the macOS system is configured to audit logon events with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control\n\nIf \"aa\" is not listed in the result of the check, this is a finding.'\n  desc 'fix', %q(Configure the macOS system to audit logon events with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,aa/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the \"/etc/security/audit_control\" file.)\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60867r905177_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257182'\n  tag rid: 'SV-257182r905179_rule'\n  tag stig_id: 'APPL-13-001044'\n  tag gtitle: 'SRG-OS-000470-GPOS-00214'\n  tag fix_id: 'F-60808r905178_fix'\n  tag satisfies: ['SRG-OS-000470-GPOS-00214', 'SRG-OS-000472-GPOS-00217', 'SRG-OS-000473-GPOS-00218', 'SRG-OS-000475-GPOS-00220']\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257182.rb"},"title":"The macOS system must generate audit records for DOD-defined events such as successful/unsuccessful logon attempts, successful/unsuccessful direct access attempts, starting and ending time for user access, and concurrent logons to the same account from different sources.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nLogon events are logged by way of the \"aa\" flag.\n\n","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nLogon events are logged by way of the \"aa\" flag.\n\n","check":"Verify the macOS system is configured to audit logon events with the following command:\n\n/usr/bin/sudo /usr/bin/grep ^flags /etc/security/audit_control\n\nIf \"aa\" is not listed in the result of the check, this is a finding.","fix":"Configure the macOS system to audit logon events with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak '/^flags/ s/$/,aa/' /etc/security/audit_control; /usr/bin/sudo /usr/sbin/audit -s\n\nA text editor may also be used to implement the required updates to the \"/etc/security/audit_control\" file."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60867r905177_chk","severity":"medium","gid":"V-257182","rid":"SV-257182r905179_rule","stig_id":"APPL-13-001044","gtitle":"SRG-OS-000470-GPOS-00214","fix_id":"F-60808r905178_fix","satisfies":["SRG-OS-000470-GPOS-00214","SRG-OS-000472-GPOS-00217","SRG-OS-000473-GPOS-00218","SRG-OS-000475-GPOS-00220"],"documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-257183","code":"control 'SV-257183' do\n  title 'The macOS system must accept and verify Personal Identity Verification (PIV) credentials, implement a local cache of revocation data to support path discovery and validation in case of the inability to access revocation information via the network, and only allow the use of DOD PKI-established certificate authorities for verification of the establishment of protected sessions.'\n  desc 'The use of PIV credentials facilitates standardization and reduces the risk of unauthorized access.\n\nWithout configuring a local cache of revocation data, there is the potential to allow access to users who are no longer authorized (users with revoked certificates).\n\nUntrusted Certificate Authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DOD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DOD-approved CA, trust of this CA has not been established.\n\nDOD has mandated the use of the CAC to support identity management and personal authentication for systems covered under Homeland Security Presidential Directive (HSPD) 12, as well as making the CAC a primary component of layered protection for national security systems.\n\nThe DOD will only accept PKI certificates obtained from a DOD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of SSL/TLS certificates.\n\n'\n  desc 'check', 'Verify the macOS system is configured to check the revocation status of user certificates with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"checkCertificateTrust\"\n\ncheckCertificateTrust = 1;\n\nIf there is no result, or if \"checkCertificateTrust\" is not set to \"1\" or greater, this is a finding.'\n  desc 'fix', 'Configure the macOS system to check the revocation status of user certificates by installing the \"Smart Card Policy\" configuration profile. \n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the \"Smart Card Policy\".'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60868r905180_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257183'\n  tag rid: 'SV-257183r905182_rule'\n  tag stig_id: 'APPL-13-001060'\n  tag gtitle: 'SRG-OS-000067-GPOS-00035'\n  tag fix_id: 'F-60809r905181_fix'\n  tag satisfies: ['SRG-OS-000067-GPOS-00035', 'SRG-OS-000376-GPOS-00161', 'SRG-OS-000377-GPOS-00162', 'SRG-OS-000384-GPOS-00167', 'SRG-OS-000403-GPOS-00182']\n  tag 'documentable'\n  tag cci: ['CCI-000186', 'CCI-001953', 'CCI-001954', 'CCI-001991', 'CCI-002470']\n  tag nist: ['IA-5 (2) (a) (1)', 'IA-2 (12)', 'IA-2 (12)', 'IA-5 (2) (d)', 'SC-23 (5)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257183.rb"},"title":"The macOS system must accept and verify Personal Identity Verification (PIV) credentials, implement a local cache of revocation data to support path discovery and validation in case of the inability to access revocation information via the network, and only allow the use of DOD PKI-established certificate authorities for verification of the establishment of protected sessions.","desc":"The use of PIV credentials facilitates standardization and reduces the risk of unauthorized access.\n\nWithout configuring a local cache of revocation data, there is the potential to allow access to users who are no longer authorized (users with revoked certificates).\n\nUntrusted Certificate Authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DOD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DOD-approved CA, trust of this CA has not been established.\n\nDOD has mandated the use of the CAC to support identity management and personal authentication for systems covered under Homeland Security Presidential Directive (HSPD) 12, as well as making the CAC a primary component of layered protection for national security systems.\n\nThe DOD will only accept PKI certificates obtained from a DOD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of SSL/TLS certificates.\n\n","descriptions":{"default":"The use of PIV credentials facilitates standardization and reduces the risk of unauthorized access.\n\nWithout configuring a local cache of revocation data, there is the potential to allow access to users who are no longer authorized (users with revoked certificates).\n\nUntrusted Certificate Authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DOD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DOD-approved CA, trust of this CA has not been established.\n\nDOD has mandated the use of the CAC to support identity management and personal authentication for systems covered under Homeland Security Presidential Directive (HSPD) 12, as well as making the CAC a primary component of layered protection for national security systems.\n\nThe DOD will only accept PKI certificates obtained from a DOD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of SSL/TLS certificates.\n\n","check":"Verify the macOS system is configured to check the revocation status of user certificates with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"checkCertificateTrust\"\n\ncheckCertificateTrust = 1;\n\nIf there is no result, or if \"checkCertificateTrust\" is not set to \"1\" or greater, this is a finding.","fix":"Configure the macOS system to check the revocation status of user certificates by installing the \"Smart Card Policy\" configuration profile. \n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the \"Smart Card Policy\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60868r905180_chk","severity":"medium","gid":"V-257183","rid":"SV-257183r905182_rule","stig_id":"APPL-13-001060","gtitle":"SRG-OS-000067-GPOS-00035","fix_id":"F-60809r905181_fix","satisfies":["SRG-OS-000067-GPOS-00035","SRG-OS-000376-GPOS-00161","SRG-OS-000377-GPOS-00162","SRG-OS-000384-GPOS-00167","SRG-OS-000403-GPOS-00182"],"documentable":null,"cci":["CCI-000186","CCI-001953","CCI-001954","CCI-001991","CCI-002470"],"nist":["IA-5 (2) (a) (1)","IA-2 (12)","IA-2 (12)","IA-5 (2) (d)","SC-23 (5)"]}},{"id":"SV-257184","code":"control 'SV-257184' do\n  title 'The macOS system must require individuals to be authenticated with an individual authenticator prior to using a group authenticator.'\n  desc 'Administrator users must never log in directly as root. To assure individual accountability and prevent unauthorized access, logging in as root over a remote connection must be disabled. Administrators must only run commands as root after first authenticating with their individual usernames and passwords.'\n  desc 'check', 'If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured to disable root logins over SSH with the following command:\n\n/usr/bin/grep -r ^PermitRootLogin /etc/ssh/sshd_config*\n\nIf there is no result, or the result is set to \"yes\", this is a finding.\n\nIf conflicting results are returned, this is a finding.'\n  desc 'fix', \"Configure the macOS system to disable root logins over SSH with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/^[\\\\#]*PermitRootLogin.*/PermitRootLogin no/' /etc/ssh/sshd_config\"\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60869r905183_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257184'\n  tag rid: 'SV-257184r905185_rule'\n  tag stig_id: 'APPL-13-001100'\n  tag gtitle: 'SRG-OS-000109-GPOS-00056'\n  tag fix_id: 'F-60810r905184_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000770']\n  tag nist: ['IA-2 (5)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257184.rb"},"title":"The macOS system must require individuals to be authenticated with an individual authenticator prior to using a group authenticator.","desc":"Administrator users must never log in directly as root. To assure individual accountability and prevent unauthorized access, logging in as root over a remote connection must be disabled. Administrators must only run commands as root after first authenticating with their individual usernames and passwords.","descriptions":{"default":"Administrator users must never log in directly as root. To assure individual accountability and prevent unauthorized access, logging in as root over a remote connection must be disabled. Administrators must only run commands as root after first authenticating with their individual usernames and passwords.","check":"If SSH is not being used, this is not applicable.\n\nVerify the macOS system is configured to disable root logins over SSH with the following command:\n\n/usr/bin/grep -r ^PermitRootLogin /etc/ssh/sshd_config*\n\nIf there is no result, or the result is set to \"yes\", this is a finding.\n\nIf conflicting results are returned, this is a finding.","fix":"Configure the macOS system to disable root logins over SSH with the following command:\n\n/usr/bin/sudo /usr/bin/sed -i.bak 's/^[\\#]*PermitRootLogin.*/PermitRootLogin no/' /etc/ssh/sshd_config"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60869r905183_chk","severity":"medium","gid":"V-257184","rid":"SV-257184r905185_rule","stig_id":"APPL-13-001100","gtitle":"SRG-OS-000109-GPOS-00056","fix_id":"F-60810r905184_fix","documentable":null,"cci":["CCI-000770"],"nist":["IA-2 (5)"]}},{"id":"SV-257185","code":"control 'SV-257185' do\n  title 'The macOS system must be configured to disable SMB File Sharing unless it is required.'\n  desc 'File sharing is usually nonessential and must be disabled if not required. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.'\n  desc 'check', 'Verify the macOS system is configured to disable the SMB File Sharing service with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep com.apple.smbd\n\n\"com.apple.smbd\" => disabled\n\nIf the results are not \"com.apple.smbd => disabled\" or SMB file sharing has not been documented with the ISSO as an operational requirement, this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the SMB File Sharing service with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.smbd\n\nThe system may need to be restarted for the update to take effect.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60870r905186_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257185'\n  tag rid: 'SV-257185r905188_rule'\n  tag stig_id: 'APPL-13-002001'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60811r905187_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257185.rb"},"title":"The macOS system must be configured to disable SMB File Sharing unless it is required.","desc":"File sharing is usually nonessential and must be disabled if not required. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.","descriptions":{"default":"File sharing is usually nonessential and must be disabled if not required. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.","check":"Verify the macOS system is configured to disable the SMB File Sharing service with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep com.apple.smbd\n\n\"com.apple.smbd\" => disabled\n\nIf the results are not \"com.apple.smbd => disabled\" or SMB file sharing has not been documented with the ISSO as an operational requirement, this is a finding.","fix":"Configure the macOS system to disable the SMB File Sharing service with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.smbd\n\nThe system may need to be restarted for the update to take effect."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60870r905186_chk","severity":"medium","gid":"V-257185","rid":"SV-257185r905188_rule","stig_id":"APPL-13-002001","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60811r905187_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257186","code":"control 'SV-257186' do\n  title 'The macOS system must be configured to disable the Network File System (NFS) daemon unless it is required.'\n  desc 'If the system does not require access to NFS file shares or is not acting as an NFS server, support for NFS is nonessential and NFS services must be disabled. NFS is a network file system protocol supported by UNIX-like operating systems. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.'\n  desc 'check', 'Verify the macOS system is configured to disable the NFS daemon with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep com.apple.nfsd\n\n\"com.apple.nfsd\" => disabled\n\nIf the results are not \"com.apple.nfsd => disabled\" or the use of NFS has not been documented with the ISSO as an operational requirement, this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the NFS daemon with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.nfsd\n\nThe system may need to be restarted for the update to take effect.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60871r905189_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257186'\n  tag rid: 'SV-257186r905191_rule'\n  tag stig_id: 'APPL-13-002003'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60812r905190_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257186.rb"},"title":"The macOS system must be configured to disable the Network File System (NFS) daemon unless it is required.","desc":"If the system does not require access to NFS file shares or is not acting as an NFS server, support for NFS is nonessential and NFS services must be disabled. NFS is a network file system protocol supported by UNIX-like operating systems. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.","descriptions":{"default":"If the system does not require access to NFS file shares or is not acting as an NFS server, support for NFS is nonessential and NFS services must be disabled. NFS is a network file system protocol supported by UNIX-like operating systems. Enabling any service increases the attack surface for an intruder. By disabling unnecessary services, the attack surface is minimized.","check":"Verify the macOS system is configured to disable the NFS daemon with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep com.apple.nfsd\n\n\"com.apple.nfsd\" => disabled\n\nIf the results are not \"com.apple.nfsd => disabled\" or the use of NFS has not been documented with the ISSO as an operational requirement, this is a finding.","fix":"Configure the macOS system to disable the NFS daemon with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.nfsd\n\nThe system may need to be restarted for the update to take effect."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60871r905189_chk","severity":"medium","gid":"V-257186","rid":"SV-257186r905191_rule","stig_id":"APPL-13-002003","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60812r905190_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257187","code":"control 'SV-257187' do\n  title 'The macOS system must be configured to disable Location Services.'\n  desc 'To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nLocation Services must be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable Location Services with the following command:\n\n/usr/bin/sudo /usr/bin/defaults read /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd | /usr/bin/grep \"LocationServicesEnabled\"\n\nLocationServicesEnabled = 0;\n\nIf \"LocationServicesEnabled\" is not set to \"0\" and the AO has not authorized the use of location services, this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable Location Services with the following command:\n\n/usr/bin/sudo /usr/bin/defaults write /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd LocationServicesEnabled -bool false\n\nThe system may need to be restarted for the update to take effect.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60872r905192_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257187'\n  tag rid: 'SV-257187r905194_rule'\n  tag stig_id: 'APPL-13-002004'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60813r905193_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257187.rb"},"title":"The macOS system must be configured to disable Location Services.","desc":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nLocation Services must be disabled.","descriptions":{"default":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nLocation Services must be disabled.","check":"Verify the macOS system is configured to disable Location Services with the following command:\n\n/usr/bin/sudo /usr/bin/defaults read /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd | /usr/bin/grep \"LocationServicesEnabled\"\n\nLocationServicesEnabled = 0;\n\nIf \"LocationServicesEnabled\" is not set to \"0\" and the AO has not authorized the use of location services, this is a finding.","fix":"Configure the macOS system to disable Location Services with the following command:\n\n/usr/bin/sudo /usr/bin/defaults write /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd LocationServicesEnabled -bool false\n\nThe system may need to be restarted for the update to take effect."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60872r905192_chk","severity":"medium","gid":"V-257187","rid":"SV-257187r905194_rule","stig_id":"APPL-13-002004","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60813r905193_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257188","code":"control 'SV-257188' do\n  title 'The macOS system must be configured to disable Bonjour multicast advertising.'\n  desc 'To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nBonjour multicast advertising must be disabled on the system.'\n  desc 'check', 'Verify the macOS system is configured to disable Bonjour multicast advertising with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"NoMulticastAdvertisements\"\n\nNoMulticastAdverstisements = 1;\n\nIf there is no result, or if \"NoMulticastAdvertisements\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable Bonjour multicast advertising by installing the \"Custom Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60873r905195_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257188'\n  tag rid: 'SV-257188r905197_rule'\n  tag stig_id: 'APPL-13-002005'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60814r905196_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257188.rb"},"title":"The macOS system must be configured to disable Bonjour multicast advertising.","desc":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nBonjour multicast advertising must be disabled on the system.","descriptions":{"default":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nBonjour multicast advertising must be disabled on the system.","check":"Verify the macOS system is configured to disable Bonjour multicast advertising with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"NoMulticastAdvertisements\"\n\nNoMulticastAdverstisements = 1;\n\nIf there is no result, or if \"NoMulticastAdvertisements\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to disable Bonjour multicast advertising by installing the \"Custom Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60873r905195_chk","severity":"medium","gid":"V-257188","rid":"SV-257188r905197_rule","stig_id":"APPL-13-002005","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60814r905196_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257189","code":"control 'SV-257189' do\n  title 'The macOS system must be configured to disable the UUCP service.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe system must not have the UUCP service active.'\n  desc 'check', 'Verify the macOS system is configured to disable the UUCP service with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep com.apple.uucp\n\n\"com.apple.uucp\" => disabled\n\nIf the results are not \"com.apple.uucp => disabled\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the UUCP service with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.uucp\n\nThe system may need to be restarted for the update to take effect.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60874r905198_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257189'\n  tag rid: 'SV-257189r905200_rule'\n  tag stig_id: 'APPL-13-002006'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60815r905199_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257189.rb"},"title":"The macOS system must be configured to disable the UUCP service.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe system must not have the UUCP service active.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe system must not have the UUCP service active.","check":"Verify the macOS system is configured to disable the UUCP service with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep com.apple.uucp\n\n\"com.apple.uucp\" => disabled\n\nIf the results are not \"com.apple.uucp => disabled\", this is a finding.","fix":"Configure the macOS system to disable the UUCP service with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.uucp\n\nThe system may need to be restarted for the update to take effect."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60874r905198_chk","severity":"medium","gid":"V-257189","rid":"SV-257189r905200_rule","stig_id":"APPL-13-002006","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60815r905199_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257190","code":"control 'SV-257190' do\n  title 'The macOS system must be configured to disable Internet Sharing.'\n  desc 'To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nInternet Sharing is nonessential and must be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable Internet Sharing with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"forceInternetSharingOff\"\n\nforceInternetSharingOff = 1;\n\nIf there is no result, or if \"forceInternetSharingOff\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable Internet Sharing by installing the \"Custom Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60875r905201_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257190'\n  tag rid: 'SV-257190r905203_rule'\n  tag stig_id: 'APPL-13-002007'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60816r905202_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257190.rb"},"title":"The macOS system must be configured to disable Internet Sharing.","desc":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nInternet Sharing is nonessential and must be disabled.","descriptions":{"default":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nInternet Sharing is nonessential and must be disabled.","check":"Verify the macOS system is configured to disable Internet Sharing with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"forceInternetSharingOff\"\n\nforceInternetSharingOff = 1;\n\nIf there is no result, or if \"forceInternetSharingOff\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to disable Internet Sharing by installing the \"Custom Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60875r905201_chk","severity":"medium","gid":"V-257190","rid":"SV-257190r905203_rule","stig_id":"APPL-13-002007","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60816r905202_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257191","code":"control 'SV-257191' do\n  title 'The macOS system must be configured to disable Web Sharing.'\n  desc 'To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nWeb Sharing is nonessential and must be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable Web Sharing with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep org.apache.httpd\n\n\"org.apache.httpd\" => disabled\n\nIf the results are not \"org.apache.httpd => disabled\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable Web Sharing with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/org.apache.httpd\n\nThe system may need to be restarted for the update to take effect.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60876r905204_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257191'\n  tag rid: 'SV-257191r905206_rule'\n  tag stig_id: 'APPL-13-002008'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60817r905205_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257191.rb"},"title":"The macOS system must be configured to disable Web Sharing.","desc":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nWeb Sharing is nonessential and must be disabled.","descriptions":{"default":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nWeb Sharing is nonessential and must be disabled.","check":"Verify the macOS system is configured to disable Web Sharing with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep org.apache.httpd\n\n\"org.apache.httpd\" => disabled\n\nIf the results are not \"org.apache.httpd => disabled\", this is a finding.","fix":"Configure the macOS system to disable Web Sharing with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/org.apache.httpd\n\nThe system may need to be restarted for the update to take effect."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60876r905204_chk","severity":"medium","gid":"V-257191","rid":"SV-257191r905206_rule","stig_id":"APPL-13-002008","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60817r905205_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257192","code":"control 'SV-257192' do\n  title 'The macOS system must be configured to disable AirDrop.'\n  desc 'To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nAirDrop must be disabled.\n\nNote: There is a known bug in the graphical user interface where the user can toggle AirDrop in the UI, which indicates the service has been turned on, but it remains disabled if the Restrictions Profile has been applied.'\n  desc 'check', 'Verify the macOS system is configured to disable AirDrop with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowAirDrop\"\n\nallowAirDrop = 0;\n\nIf there is no result, or if \"allowAirDrop\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable AirDrop by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60877r905207_chk'\n  tag severity: 'low'\n  tag gid: 'V-257192'\n  tag rid: 'SV-257192r905209_rule'\n  tag stig_id: 'APPL-13-002009'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60818r905208_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257192.rb"},"title":"The macOS system must be configured to disable AirDrop.","desc":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nAirDrop must be disabled.\n\nNote: There is a known bug in the graphical user interface where the user can toggle AirDrop in the UI, which indicates the service has been turned on, but it remains disabled if the Restrictions Profile has been applied.","descriptions":{"default":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality-of-life issues.\n\nAirDrop must be disabled.\n\nNote: There is a known bug in the graphical user interface where the user can toggle AirDrop in the UI, which indicates the service has been turned on, but it remains disabled if the Restrictions Profile has been applied.","check":"Verify the macOS system is configured to disable AirDrop with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowAirDrop\"\n\nallowAirDrop = 0;\n\nIf there is no result, or if \"allowAirDrop\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to disable AirDrop by installing the \"Restrictions Policy\" configuration profile."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60877r905207_chk","severity":"low","gid":"V-257192","rid":"SV-257192r905209_rule","stig_id":"APPL-13-002009","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60818r905208_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257193","code":"control 'SV-257193' do\n  title 'The macOS system must be configured to disable the iCloud Calendar services.'\n  desc \"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Calendar application's connections to Apple's iCloud must be disabled.\n\n\"\n  desc 'check', 'Verify the macOS system is configured to disable iCloud Calendar services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudCalendar\"\n\nallowCloudCalendar = 0;\n\nIf there is no result, or if \"allowCloudCalendar\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable iCloud Calendar services by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60878r905210_chk'\n  tag severity: 'low'\n  tag gid: 'V-257193'\n  tag rid: 'SV-257193r905212_rule'\n  tag stig_id: 'APPL-13-002012'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60819r905211_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257193.rb"},"title":"The macOS system must be configured to disable the iCloud Calendar services.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Calendar application's connections to Apple's iCloud must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Calendar application's connections to Apple's iCloud must be disabled.\n\n","check":"Verify the macOS system is configured to disable iCloud Calendar services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudCalendar\"\n\nallowCloudCalendar = 0;\n\nIf there is no result, or if \"allowCloudCalendar\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to disable iCloud Calendar services by installing the \"Restrictions Policy\" configuration profile."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60878r905210_chk","severity":"low","gid":"V-257193","rid":"SV-257193r905212_rule","stig_id":"APPL-13-002012","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60819r905211_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257194","code":"control 'SV-257194' do\n  title 'The macOS system must be configured to disable the iCloud Reminders services.'\n  desc \"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Reminder application's connections to Apple's iCloud must be disabled.\n\n\"\n  desc 'check', 'Verify the macOS system is configured to disable iCloud Reminders services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudReminders\"\n\nallowCloudReminders = 0;\n\nIf there is no result, or if \"allowCloudReminders\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable iCloud Reminders services by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60879r905213_chk'\n  tag severity: 'low'\n  tag gid: 'V-257194'\n  tag rid: 'SV-257194r905215_rule'\n  tag stig_id: 'APPL-13-002013'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60820r905214_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257194.rb"},"title":"The macOS system must be configured to disable the iCloud Reminders services.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Reminder application's connections to Apple's iCloud must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Reminder application's connections to Apple's iCloud must be disabled.\n\n","check":"Verify the macOS system is configured to disable iCloud Reminders services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudReminders\"\n\nallowCloudReminders = 0;\n\nIf there is no result, or if \"allowCloudReminders\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to disable iCloud Reminders services by installing the \"Restrictions Policy\" configuration profile."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60879r905213_chk","severity":"low","gid":"V-257194","rid":"SV-257194r905215_rule","stig_id":"APPL-13-002013","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60820r905214_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257195","code":"control 'SV-257195' do\n  title 'The macOS system must be configured to disable iCloud Address Book services.'\n  desc \"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Address Book(Contacts) application's connections to Apple's iCloud must be disabled.\n\n\"\n  desc 'check', 'Verify the macOS system is configured to disable iCloud Address Book services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudAddressBook\"\n\nallowCloudAddressBook = 0;\n\nIf there is no result, or if \"allowCloudAddressBook\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable iCloud Address Book services by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60880r905216_chk'\n  tag severity: 'low'\n  tag gid: 'V-257195'\n  tag rid: 'SV-257195r905218_rule'\n  tag stig_id: 'APPL-13-002014'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60821r905217_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257195.rb"},"title":"The macOS system must be configured to disable iCloud Address Book services.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Address Book(Contacts) application's connections to Apple's iCloud must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Address Book(Contacts) application's connections to Apple's iCloud must be disabled.\n\n","check":"Verify the macOS system is configured to disable iCloud Address Book services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudAddressBook\"\n\nallowCloudAddressBook = 0;\n\nIf there is no result, or if \"allowCloudAddressBook\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to disable iCloud Address Book services by installing the \"Restrictions Policy\" configuration profile."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60880r905216_chk","severity":"low","gid":"V-257195","rid":"SV-257195r905218_rule","stig_id":"APPL-13-002014","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60821r905217_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257196","code":"control 'SV-257196' do\n  title 'The macOS system must be configured to disable the iCloud Mail services.'\n  desc \"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions). \n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Mail application's connections to Apple's iCloud must be disabled.\n\n\"\n  desc 'check', 'Verify the macOS system is configured to disable iCloud Mail services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudMail\"\n\nallowCloudMail = 0;\n\nIf there is no result, or if \"allowCloudMail\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable iCloud Mail services by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60881r905219_chk'\n  tag severity: 'low'\n  tag gid: 'V-257196'\n  tag rid: 'SV-257196r905221_rule'\n  tag stig_id: 'APPL-13-002015'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60822r905220_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257196.rb"},"title":"The macOS system must be configured to disable the iCloud Mail services.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions). \n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Mail application's connections to Apple's iCloud must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions). \n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Mail application's connections to Apple's iCloud must be disabled.\n\n","check":"Verify the macOS system is configured to disable iCloud Mail services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudMail\"\n\nallowCloudMail = 0;\n\nIf there is no result, or if \"allowCloudMail\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to disable iCloud Mail services by installing the \"Restrictions Policy\" configuration profile."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60881r905219_chk","severity":"low","gid":"V-257196","rid":"SV-257196r905221_rule","stig_id":"APPL-13-002015","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60822r905220_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257197","code":"control 'SV-257197' do\n  title 'The macOS system must be configured to disable the iCloud Notes services.'\n  desc \"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Notes application's connections to Apple's iCloud must be disabled.\n\n\"\n  desc 'check', 'Verify the macOS system is configured to disable iCloud Notes services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudNotes\"\n\nallowCloudNotes = 0;\n\nIf there is no result, or if \"allowCloudNotes\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable iCloud Notes services by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60882r905222_chk'\n  tag severity: 'low'\n  tag gid: 'V-257197'\n  tag rid: 'SV-257197r905224_rule'\n  tag stig_id: 'APPL-13-002016'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60823r905223_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257197.rb"},"title":"The macOS system must be configured to disable the iCloud Notes services.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Notes application's connections to Apple's iCloud must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Notes application's connections to Apple's iCloud must be disabled.\n\n","check":"Verify the macOS system is configured to disable iCloud Notes services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudNotes\"\n\nallowCloudNotes = 0;\n\nIf there is no result, or if \"allowCloudNotes\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to disable iCloud Notes services by installing the \"Restrictions Policy\" configuration profile."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60882r905222_chk","severity":"low","gid":"V-257197","rid":"SV-257197r905224_rule","stig_id":"APPL-13-002016","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60823r905223_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257198","code":"control 'SV-257198' do\n  title 'The macOS system must cover or disable the built-in or attached camera when not in use.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nFailing to disconnect from collaborative computing devices (i.e., cameras) can result in subsequent compromises of organizational information. Providing easy methods to physically disconnect from such devices after a collaborative computing session helps to ensure that participants carry out the disconnect activity without having to go through complex and tedious procedures.\n\n'\n  desc 'check', 'If the device or operating system does not have a camera installed, this requirement is not applicable.\n\nThis requirement is not applicable to mobile devices (smartphones and tablets), where the use of the camera is a local AO decision.\n\nThis requirement is not applicable to dedicated VTC suites located in approved VTC locations that are centrally managed.\n\nFor an external camera, if there is not a method for the operator to manually disconnect camera at the end of collaborative computing sessions, this is a finding.\n\nFor a built-in camera, the camera must be protected by a camera cover (e.g., laptop camera cover slide) when not in use. If the built-in camera is not protected with a camera cover, or is not physically disabled, this is a finding.\n\nIf the camera is not disconnected, covered, or physically disabled, the following configuration is required:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCamera\"\n\nallowCamera = 0;\n\nIf the result is \"allowCamera = 1\" and the collaborative computing device has not been authorized for use, this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the built-in camera by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60883r905225_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257198'\n  tag rid: 'SV-257198r905227_rule'\n  tag stig_id: 'APPL-13-002017'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60824r905226_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257198.rb"},"title":"The macOS system must cover or disable the built-in or attached camera when not in use.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nFailing to disconnect from collaborative computing devices (i.e., cameras) can result in subsequent compromises of organizational information. Providing easy methods to physically disconnect from such devices after a collaborative computing session helps to ensure that participants carry out the disconnect activity without having to go through complex and tedious procedures.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nFailing to disconnect from collaborative computing devices (i.e., cameras) can result in subsequent compromises of organizational information. Providing easy methods to physically disconnect from such devices after a collaborative computing session helps to ensure that participants carry out the disconnect activity without having to go through complex and tedious procedures.\n\n","check":"If the device or operating system does not have a camera installed, this requirement is not applicable.\n\nThis requirement is not applicable to mobile devices (smartphones and tablets), where the use of the camera is a local AO decision.\n\nThis requirement is not applicable to dedicated VTC suites located in approved VTC locations that are centrally managed.\n\nFor an external camera, if there is not a method for the operator to manually disconnect camera at the end of collaborative computing sessions, this is a finding.\n\nFor a built-in camera, the camera must be protected by a camera cover (e.g., laptop camera cover slide) when not in use. If the built-in camera is not protected with a camera cover, or is not physically disabled, this is a finding.\n\nIf the camera is not disconnected, covered, or physically disabled, the following configuration is required:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCamera\"\n\nallowCamera = 0;\n\nIf the result is \"allowCamera = 1\" and the collaborative computing device has not been authorized for use, this is a finding.","fix":"Configure the macOS system to disable the built-in camera by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60883r905225_chk","severity":"medium","gid":"V-257198","rid":"SV-257198r905227_rule","stig_id":"APPL-13-002017","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60824r905226_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257199","code":"control 'SV-257199' do\n  title 'The macOS system must be configured to disable Siri and dictation.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nSiri and dictation must be disabled.\n\n'\n  desc 'check', 'To check if Siri and dictation has been disabled, run the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -e \"Ironwood Allowed\"\n\nIf the output is not:\n\"Ironwood Allowed = 0\",\nthis is a finding.'\n  desc 'fix', 'Configure the macOS system to disable Siri and dictation by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60884r922884_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257199'\n  tag rid: 'SV-257199r922885_rule'\n  tag stig_id: 'APPL-13-002020'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60825r905229_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257199.rb"},"title":"The macOS system must be configured to disable Siri and dictation.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nSiri and dictation must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nSiri and dictation must be disabled.\n\n","check":"To check if Siri and dictation has been disabled, run the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -e \"Ironwood Allowed\"\n\nIf the output is not:\n\"Ironwood Allowed = 0\",\nthis is a finding.","fix":"Configure the macOS system to disable Siri and dictation by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60884r922884_chk","severity":"medium","gid":"V-257199","rid":"SV-257199r922885_rule","stig_id":"APPL-13-002020","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60825r905229_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257200","code":"control 'SV-257200' do\n  title 'The macOS system must be configured to disable sending diagnostic and usage data to Apple.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nSending diagnostic data to Apple must be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable sending diagnostic and usage data to Apple with the following command:\n\n/usr/bin/sudo /usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowDiagnosticSubmission\"\n\nallowDiagnosticSubmission = 0;\n\nIf there is no result, or if \"allowDiagnosticSubmission\" is not set to \"0\", this is a finding.\n\nAlternatively, the settings are found in System Settings >> Privacy & Security >> Privacy >> Analytics & Improvements.\n\nIf the box \"Share Mac Analytics\" is checked, this is a finding.\n\nIf the box \"Improve Siri & Dictation\" is checked, this is a finding.\n\nIf the box \"Share with app developers\" is checked, this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable sending diagnostic and usage data to Apple by installing the \"Restrictions Policy\" configuration profile.\n\nAlternatively, the settings can be configured in System Settings >> Privacy & Security >> Privacy >> Analytics & Improvements by performing the following: \n\n- Uncheck the box, \"Share Mac Analytics\".\n- Uncheck the box \"Improve Siri & Dictation\".\n- Uncheck the box \"Share with app developers\".'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60885r905231_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257200'\n  tag rid: 'SV-257200r905233_rule'\n  tag stig_id: 'APPL-13-002021'\n  tag gtitle: 'SRG-OS-000096-GPOS-00050'\n  tag fix_id: 'F-60826r905232_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000382']\n  tag nist: ['CM-7 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257200.rb"},"title":"The macOS system must be configured to disable sending diagnostic and usage data to Apple.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nSending diagnostic data to Apple must be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nSending diagnostic data to Apple must be disabled.","check":"Verify the macOS system is configured to disable sending diagnostic and usage data to Apple with the following command:\n\n/usr/bin/sudo /usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowDiagnosticSubmission\"\n\nallowDiagnosticSubmission = 0;\n\nIf there is no result, or if \"allowDiagnosticSubmission\" is not set to \"0\", this is a finding.\n\nAlternatively, the settings are found in System Settings >> Privacy & Security >> Privacy >> Analytics & Improvements.\n\nIf the box \"Share Mac Analytics\" is checked, this is a finding.\n\nIf the box \"Improve Siri & Dictation\" is checked, this is a finding.\n\nIf the box \"Share with app developers\" is checked, this is a finding.","fix":"Configure the macOS system to disable sending diagnostic and usage data to Apple by installing the \"Restrictions Policy\" configuration profile.\n\nAlternatively, the settings can be configured in System Settings >> Privacy & Security >> Privacy >> Analytics & Improvements by performing the following: \n\n- Uncheck the box, \"Share Mac Analytics\".\n- Uncheck the box \"Improve Siri & Dictation\".\n- Uncheck the box \"Share with app developers\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60885r905231_chk","severity":"medium","gid":"V-257200","rid":"SV-257200r905233_rule","stig_id":"APPL-13-002021","gtitle":"SRG-OS-000096-GPOS-00050","fix_id":"F-60826r905232_fix","documentable":null,"cci":["CCI-000382"],"nist":["CM-7 b"]}},{"id":"SV-257201","code":"control 'SV-257201' do\n  title 'The macOS system must be configured to disable Remote Apple Events.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nRemote Apple Events must be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable Remote Apple Events with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep com.apple.AEServer\n\n\"com.apple.AEServer\" => disabled\n\nIf the results are not \"com.apple.AEServer => disabled\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable Remote Apple Events with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.AEServer\n\nThe system may need to be restarted for the update to take effect.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60886r905234_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257201'\n  tag rid: 'SV-257201r905236_rule'\n  tag stig_id: 'APPL-13-002022'\n  tag gtitle: 'SRG-OS-000096-GPOS-00050'\n  tag fix_id: 'F-60827r905235_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000382']\n  tag nist: ['CM-7 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257201.rb"},"title":"The macOS system must be configured to disable Remote Apple Events.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nRemote Apple Events must be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nRemote Apple Events must be disabled.","check":"Verify the macOS system is configured to disable Remote Apple Events with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep com.apple.AEServer\n\n\"com.apple.AEServer\" => disabled\n\nIf the results are not \"com.apple.AEServer => disabled\", this is a finding.","fix":"Configure the macOS system to disable Remote Apple Events with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.AEServer\n\nThe system may need to be restarted for the update to take effect."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60886r905234_chk","severity":"medium","gid":"V-257201","rid":"SV-257201r905236_rule","stig_id":"APPL-13-002022","gtitle":"SRG-OS-000096-GPOS-00050","fix_id":"F-60827r905235_fix","documentable":null,"cci":["CCI-000382"],"nist":["CM-7 b"]}},{"id":"SV-257202","code":"control 'SV-257202' do\n  title 'The macOS system must be configured to disable the system preference pane for Apple ID.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked, and thus can remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Apple ID System Preference Pane must be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable access to the Apple ID preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the result is not an array listing \"DisabledPreferencePanes\" containing \"com.apple.preferences.AppleIDPrefPane\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable access to the Apple ID preference pane by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60887r905237_chk'\n  tag severity: 'high'\n  tag gid: 'V-257202'\n  tag rid: 'SV-257202r905239_rule'\n  tag stig_id: 'APPL-13-002031'\n  tag gtitle: 'SRG-OS-000370-GPOS-00155'\n  tag fix_id: 'F-60828r905238_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001774']\n  tag nist: ['CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257202.rb"},"title":"The macOS system must be configured to disable the system preference pane for Apple ID.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked, and thus can remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Apple ID System Preference Pane must be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked, and thus can remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Apple ID System Preference Pane must be disabled.","check":"Verify the macOS system is configured to disable access to the Apple ID preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the result is not an array listing \"DisabledPreferencePanes\" containing \"com.apple.preferences.AppleIDPrefPane\", this is a finding.","fix":"Configure the macOS system to disable access to the Apple ID preference pane by installing the \"Restrictions Policy\" configuration profile."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60887r905237_chk","severity":"high","gid":"V-257202","rid":"SV-257202r905239_rule","stig_id":"APPL-13-002031","gtitle":"SRG-OS-000370-GPOS-00155","fix_id":"F-60828r905238_fix","documentable":null,"cci":["CCI-001774"],"nist":["CM-7 (5) (b)"]}},{"id":"SV-257203","code":"control 'SV-257203' do\n  title 'The macOS system must be configured to disable the system preference pane for Internet Accounts.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Internet Accounts System Preference Pane must be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable access to the Internet Accounts preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the result is not an array listing \"DisabledPreferencePanes\" containing \"com.apple.preferences.internetaccounts\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable access to the Internet Accounts preference pane by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60888r905240_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257203'\n  tag rid: 'SV-257203r905242_rule'\n  tag stig_id: 'APPL-13-002032'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60829r905241_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257203.rb"},"title":"The macOS system must be configured to disable the system preference pane for Internet Accounts.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Internet Accounts System Preference Pane must be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Internet Accounts System Preference Pane must be disabled.","check":"Verify the macOS system is configured to disable access to the Internet Accounts preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the result is not an array listing \"DisabledPreferencePanes\" containing \"com.apple.preferences.internetaccounts\", this is a finding.","fix":"Configure the macOS system to disable access to the Internet Accounts preference pane by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60888r905240_chk","severity":"medium","gid":"V-257203","rid":"SV-257203r905242_rule","stig_id":"APPL-13-002032","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60829r905241_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257204","code":"control 'SV-257204' do\n  title 'The macOS system must be configured to disable the Cloud Setup services.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable the Cloud Setup services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipCloudSetup\"\n\nSkipCloudSetup = 1;\n\nIf there is no result, or if \"SkipCloudSetup\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the Cloud Setup services by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60889r905243_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257204'\n  tag rid: 'SV-257204r905245_rule'\n  tag stig_id: 'APPL-13-002035'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60830r905244_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257204.rb"},"title":"The macOS system must be configured to disable the Cloud Setup services.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","check":"Verify the macOS system is configured to disable the Cloud Setup services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipCloudSetup\"\n\nSkipCloudSetup = 1;\n\nIf there is no result, or if \"SkipCloudSetup\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to disable the Cloud Setup services by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60889r905243_chk","severity":"medium","gid":"V-257204","rid":"SV-257204r905245_rule","stig_id":"APPL-13-002035","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60830r905244_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257205","code":"control 'SV-257205' do\n  title 'The macOS system must be configured to disable the Privacy Setup services.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable the Privacy Setup services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipPrivacySetup\"\n\nSkipPrivacySetup = 1;\n\nIf there is no result, or if \"SkipPrivacySetup\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the Privacy Setup services by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60890r905246_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257205'\n  tag rid: 'SV-257205r905248_rule'\n  tag stig_id: 'APPL-13-002036'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60831r905247_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257205.rb"},"title":"The macOS system must be configured to disable the Privacy Setup services.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","check":"Verify the macOS system is configured to disable the Privacy Setup services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipPrivacySetup\"\n\nSkipPrivacySetup = 1;\n\nIf there is no result, or if \"SkipPrivacySetup\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to disable the Privacy Setup services by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60890r905246_chk","severity":"medium","gid":"V-257205","rid":"SV-257205r905248_rule","stig_id":"APPL-13-002036","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60831r905247_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257206","code":"control 'SV-257206' do\n  title 'The macOS system must be configured to disable the Cloud Storage Setup services.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable the Cloud Storage Setup services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipiCloudStorageSetup\"\n\nSkipiCloudStorageSetup = 1;\n\nIf there is no result, or if \"SkipiCloudStorageSetup\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the Cloud Storage Setup services by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60891r905249_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257206'\n  tag rid: 'SV-257206r905251_rule'\n  tag stig_id: 'APPL-13-002037'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60832r905250_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257206.rb"},"title":"The macOS system must be configured to disable the Cloud Storage Setup services.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","check":"Verify the macOS system is configured to disable the Cloud Storage Setup services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipiCloudStorageSetup\"\n\nSkipiCloudStorageSetup = 1;\n\nIf there is no result, or if \"SkipiCloudStorageSetup\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to disable the Cloud Storage Setup services by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60891r905249_chk","severity":"medium","gid":"V-257206","rid":"SV-257206r905251_rule","stig_id":"APPL-13-002037","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60832r905250_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257207","code":"control 'SV-257207' do\n  title 'The macOS system must be configured to disable the \"tftp\" service.'\n  desc 'The \"tftp\" service must be disabled as it sends all data in a clear-text form that can be easily intercepted and read. The data needs to be protected at all times during transmission, and encryption is the standard method for protecting data in transit.\n\nIf the data is not encrypted during transmission, it can be plainly read (i.e., clear text) and easily compromised. Disabling \"ftp\" is one way to mitigate this risk. Administrators must be instructed to use an alternate service for data transmission that uses encryption, such as SFTP.\n\nAdditionally, the \"tftp\" service uses UDP, which is not secure.'\n  desc 'check', 'Verify the macOS system is configured to disable the tfptd service with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep com.apple.tftpd\n\n\"com.apple.tftpd\" => disabled\n\nIf the results are not \"com.apple.tftpd => disabled\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the \"tftpd\" service with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.tftpd\n\nThe system may need to be restarted for the update to take effect.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60892r905252_chk'\n  tag severity: 'high'\n  tag gid: 'V-257207'\n  tag rid: 'SV-257207r905254_rule'\n  tag stig_id: 'APPL-13-002038'\n  tag gtitle: 'SRG-OS-000074-GPOS-00042'\n  tag fix_id: 'F-60833r905253_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000197']\n  tag nist: ['IA-5 (1) (c)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257207.rb"},"title":"The macOS system must be configured to disable the \"tftp\" service.","desc":"The \"tftp\" service must be disabled as it sends all data in a clear-text form that can be easily intercepted and read. The data needs to be protected at all times during transmission, and encryption is the standard method for protecting data in transit.\n\nIf the data is not encrypted during transmission, it can be plainly read (i.e., clear text) and easily compromised. Disabling \"ftp\" is one way to mitigate this risk. Administrators must be instructed to use an alternate service for data transmission that uses encryption, such as SFTP.\n\nAdditionally, the \"tftp\" service uses UDP, which is not secure.","descriptions":{"default":"The \"tftp\" service must be disabled as it sends all data in a clear-text form that can be easily intercepted and read. The data needs to be protected at all times during transmission, and encryption is the standard method for protecting data in transit.\n\nIf the data is not encrypted during transmission, it can be plainly read (i.e., clear text) and easily compromised. Disabling \"ftp\" is one way to mitigate this risk. Administrators must be instructed to use an alternate service for data transmission that uses encryption, such as SFTP.\n\nAdditionally, the \"tftp\" service uses UDP, which is not secure.","check":"Verify the macOS system is configured to disable the tfptd service with the following command:\n\n/bin/launchctl print-disabled system | /usr/bin/grep com.apple.tftpd\n\n\"com.apple.tftpd\" => disabled\n\nIf the results are not \"com.apple.tftpd => disabled\", this is a finding.","fix":"Configure the macOS system to disable the \"tftpd\" service with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.tftpd\n\nThe system may need to be restarted for the update to take effect."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60892r905252_chk","severity":"high","gid":"V-257207","rid":"SV-257207r905254_rule","stig_id":"APPL-13-002038","gtitle":"SRG-OS-000074-GPOS-00042","fix_id":"F-60833r905253_fix","documentable":null,"cci":["CCI-000197"],"nist":["IA-5 (1) (c)"]}},{"id":"SV-257208","code":"control 'SV-257208' do\n  title 'The macOS system must be configured to disable the Siri Setup services.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Siri setup pop-up must be disabled.\n\n'\n  desc 'check', 'Verify the macOS system is configured to disable the Siri Setup services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipSiriSetup\"\n\nSkipSiriSetup = 1;\n\nIf there is no result, or if \"SkipSiriSetup\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the Siri Setup services by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60893r905255_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257208'\n  tag rid: 'SV-257208r905257_rule'\n  tag stig_id: 'APPL-13-002039'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60834r905256_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257208.rb"},"title":"The macOS system must be configured to disable the Siri Setup services.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Siri setup pop-up must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Siri setup pop-up must be disabled.\n\n","check":"Verify the macOS system is configured to disable the Siri Setup services with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipSiriSetup\"\n\nSkipSiriSetup = 1;\n\nIf there is no result, or if \"SkipSiriSetup\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to disable the Siri Setup services by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60893r905255_chk","severity":"medium","gid":"V-257208","rid":"SV-257208r905257_rule","stig_id":"APPL-13-002039","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60834r905256_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257209","code":"control 'SV-257209' do\n  title 'The macOS system must disable iCloud Keychain synchronization.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nKeychain synchronization must be disabled.\n\n'\n  desc 'check', 'Verify the macOS system is configured to disable iCloud Keychain synchronization with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudKeychainSync\"\n\nallowCloudKeychainSync = 0;\n\nIf there is no result, or if \"allowCloudKeychainSync\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable iCloud Keychain synchronization by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60894r905258_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257209'\n  tag rid: 'SV-257209r905260_rule'\n  tag stig_id: 'APPL-13-002040'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60835r905259_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257209.rb"},"title":"The macOS system must disable iCloud Keychain synchronization.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nKeychain synchronization must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nKeychain synchronization must be disabled.\n\n","check":"Verify the macOS system is configured to disable iCloud Keychain synchronization with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudKeychainSync\"\n\nallowCloudKeychainSync = 0;\n\nIf there is no result, or if \"allowCloudKeychainSync\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to disable iCloud Keychain synchronization by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60894r905258_chk","severity":"medium","gid":"V-257209","rid":"SV-257209r905260_rule","stig_id":"APPL-13-002040","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60835r905259_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257210","code":"control 'SV-257210' do\n  title 'The macOS system must disable iCloud Document synchronization.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\niCloud Document synchronization must be disabled.\n\n'\n  desc 'check', 'Verify the macOS system is configured to disable iCloud Document synchronization with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudDocumentSync\"\n\nallowCloudDocumentSync = 0;\n\nIf there is no result, or if \"allowCloudDocumentSync\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable iCloud Document synchronization by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60895r905261_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257210'\n  tag rid: 'SV-257210r905263_rule'\n  tag stig_id: 'APPL-13-002041'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60836r905262_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257210.rb"},"title":"The macOS system must disable iCloud Document synchronization.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\niCloud Document synchronization must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\niCloud Document synchronization must be disabled.\n\n","check":"Verify the macOS system is configured to disable iCloud Document synchronization with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudDocumentSync\"\n\nallowCloudDocumentSync = 0;\n\nIf there is no result, or if \"allowCloudDocumentSync\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to disable iCloud Document synchronization by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60895r905261_chk","severity":"medium","gid":"V-257210","rid":"SV-257210r905263_rule","stig_id":"APPL-13-002041","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60836r905262_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257211","code":"control 'SV-257211' do\n  title 'The macOS system must disable iCloud Bookmark synchronization.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\niCloud Bookmark syncing must be disabled.\n\n'\n  desc 'check', 'Verify the macOS system is configured to disable iCloud Bookmark synchronization with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudBookmarks\"\n\nallowCloudBookmarks = 0;\n\nIf there is no result, or if \"allowCloudBookmarks\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable iCloud Bookmark synchronization by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60896r905264_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257211'\n  tag rid: 'SV-257211r905266_rule'\n  tag stig_id: 'APPL-13-002042'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60837r905265_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257211.rb"},"title":"The macOS system must disable iCloud Bookmark synchronization.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\niCloud Bookmark syncing must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\niCloud Bookmark syncing must be disabled.\n\n","check":"Verify the macOS system is configured to disable iCloud Bookmark synchronization with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudBookmarks\"\n\nallowCloudBookmarks = 0;\n\nIf there is no result, or if \"allowCloudBookmarks\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to disable iCloud Bookmark synchronization by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60896r905264_chk","severity":"medium","gid":"V-257211","rid":"SV-257211r905266_rule","stig_id":"APPL-13-002042","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60837r905265_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257212","code":"control 'SV-257212' do\n  title 'The macOS system must disable the iCloud Photo Library.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe iCloud Photo Library must be disabled.\n\n'\n  desc 'check', 'Verify the macOS system is configured to disable the iCloud Photo Library with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudPhotoLibrary\"\n\nallowCloudPhotoLibrary = 0;\n\nIf there is no result, or if \"allowCloudPhotoLibrary\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the iCloud Photo Library by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60897r905267_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257212'\n  tag rid: 'SV-257212r905269_rule'\n  tag stig_id: 'APPL-13-002043'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60838r905268_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257212.rb"},"title":"The macOS system must disable the iCloud Photo Library.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe iCloud Photo Library must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe iCloud Photo Library must be disabled.\n\n","check":"Verify the macOS system is configured to disable the iCloud Photo Library with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowCloudPhotoLibrary\"\n\nallowCloudPhotoLibrary = 0;\n\nIf there is no result, or if \"allowCloudPhotoLibrary\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to disable the iCloud Photo Library by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60897r905267_chk","severity":"medium","gid":"V-257212","rid":"SV-257212r905269_rule","stig_id":"APPL-13-002043","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60838r905268_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257213","code":"control 'SV-257213' do\n  title 'The macOS system must disable the Screen Sharing feature.'\n  desc 'The Screen Sharing feature allows remote users to view or control the desktop of the current user. A malicious user can take advantage of screen sharing to gain full access to the system remotely, either with stolen credentials or by guessing the username and password. Disabling Screen Sharing mitigates this risk.'\n  desc 'check', 'Verify the macOS system is configured to disable the Screen Sharing feature with the following command:\n\n/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.screensharing\n\n\"com.apple.screensharing => disabled\"\n\nIf \"com.apple.screensharing\" is not set to \"disabled\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the Screen Sharing service with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.screensharing\n\nThe system may need to be restarted for the update to take effect.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60898r905270_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257213'\n  tag rid: 'SV-257213r905272_rule'\n  tag stig_id: 'APPL-13-002050'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60839r905271_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257213.rb"},"title":"The macOS system must disable the Screen Sharing feature.","desc":"The Screen Sharing feature allows remote users to view or control the desktop of the current user. A malicious user can take advantage of screen sharing to gain full access to the system remotely, either with stolen credentials or by guessing the username and password. Disabling Screen Sharing mitigates this risk.","descriptions":{"default":"The Screen Sharing feature allows remote users to view or control the desktop of the current user. A malicious user can take advantage of screen sharing to gain full access to the system remotely, either with stolen credentials or by guessing the username and password. Disabling Screen Sharing mitigates this risk.","check":"Verify the macOS system is configured to disable the Screen Sharing feature with the following command:\n\n/usr/bin/sudo /bin/launchctl print-disabled system | /usr/bin/grep com.apple.screensharing\n\n\"com.apple.screensharing => disabled\"\n\nIf \"com.apple.screensharing\" is not set to \"disabled\", this is a finding.","fix":"Configure the macOS system to disable the Screen Sharing service with the following command:\n\n/usr/bin/sudo /bin/launchctl disable system/com.apple.screensharing\n\nThe system may need to be restarted for the update to take effect."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60898r905270_chk","severity":"medium","gid":"V-257213","rid":"SV-257213r905272_rule","stig_id":"APPL-13-002050","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60839r905271_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257214","code":"control 'SV-257214' do\n  title 'The macOS system must be configured to disable the system preference pane for TouchID and Password.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe TouchID & Password preference pane must be disabled.\n\n'\n  desc 'check', 'Verify the macOS system is configured to disable access to the TouchID & Password preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the result is not an array listing \"DisabledPreferencePanes\" containing \"com.apple.preferences.password\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable access to the TouchID & Password preference pane by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60899r905273_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257214'\n  tag rid: 'SV-257214r905275_rule'\n  tag stig_id: 'APPL-13-002051'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60840r905274_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257214.rb"},"title":"The macOS system must be configured to disable the system preference pane for TouchID and Password.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe TouchID & Password preference pane must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe TouchID & Password preference pane must be disabled.\n\n","check":"Verify the macOS system is configured to disable access to the TouchID & Password preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the result is not an array listing \"DisabledPreferencePanes\" containing \"com.apple.preferences.password\", this is a finding.","fix":"Configure the macOS system to disable access to the TouchID & Password preference pane by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60899r905273_chk","severity":"medium","gid":"V-257214","rid":"SV-257214r905275_rule","stig_id":"APPL-13-002051","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60840r905274_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257215","code":"control 'SV-257215' do\n  title 'The macOS system must be configured to disable the system preference pane for Wallet and ApplePay.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Wallet & ApplePay preference pane must be disabled.\n\n'\n  desc 'check', 'Verify the macOS system is configured to disable access to the Wallet & ApplePay preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the return is not two arrays \"HiddenPreferencePanes\" and \"DisabledPreferencePanes\", each containing \"com.apple.preferences.wallet\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable access to the Wallet & ApplePay preference pane by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60900r905276_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257215'\n  tag rid: 'SV-257215r905278_rule'\n  tag stig_id: 'APPL-13-002052'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60841r905277_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257215.rb"},"title":"The macOS system must be configured to disable the system preference pane for Wallet and ApplePay.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Wallet & ApplePay preference pane must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Wallet & ApplePay preference pane must be disabled.\n\n","check":"Verify the macOS system is configured to disable access to the Wallet & ApplePay preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the return is not two arrays \"HiddenPreferencePanes\" and \"DisabledPreferencePanes\", each containing \"com.apple.preferences.wallet\", this is a finding.","fix":"Configure the macOS system to disable access to the Wallet & ApplePay preference pane by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60900r905276_chk","severity":"medium","gid":"V-257215","rid":"SV-257215r905278_rule","stig_id":"APPL-13-002052","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60841r905277_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257216","code":"control 'SV-257216' do\n  title 'The macOS system must be configured to disable the system preference pane for Siri.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Siri preference pane must be disabled.\n\n'\n  desc 'check', 'Verify the macOS system is configured to disable access to the Siri preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the result is not an array listing \"DisabledPreferencePanes\" containing \"com.apple.preference.speech\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable access to the Siri preference pane by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60901r905279_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257216'\n  tag rid: 'SV-257216r905281_rule'\n  tag stig_id: 'APPL-13-002053'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60842r905280_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000370-GPOS-00155']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-001774']\n  tag nist: ['CM-7 a', 'CM-7 (5) (b)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257216.rb"},"title":"The macOS system must be configured to disable the system preference pane for Siri.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Siri preference pane must be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include but are not limited to games, software packages, tools, and demonstration software not related to requirements or providing a wide array of functionality not required for every mission but that cannot be disabled.\n\nThe Siri preference pane must be disabled.\n\n","check":"Verify the macOS system is configured to disable access to the Siri preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the result is not an array listing \"DisabledPreferencePanes\" containing \"com.apple.preference.speech\", this is a finding.","fix":"Configure the macOS system to disable access to the Siri preference pane by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60901r905279_chk","severity":"medium","gid":"V-257216","rid":"SV-257216r905281_rule","stig_id":"APPL-13-002053","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60842r905280_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000370-GPOS-00155"],"documentable":null,"cci":["CCI-000381","CCI-001774"],"nist":["CM-7 a","CM-7 (5) (b)"]}},{"id":"SV-257217","code":"control 'SV-257217' do\n  title 'The macOS system must only allow applications with a valid digital signature to run.'\n  desc 'Gatekeeper settings must be configured correctly to only allow the system to run applications signed with a valid Apple Developer ID code. Administrator users will still have the option to override these settings on a per-app basis. Gatekeeper is a security feature that ensures that applications must be digitally signed by an Apple-issued certificate to run. Digital signatures allow the macOS host to verify that the application has not been modified by a malicious third party.'\n  desc 'check', %q(Verify the macOS system is configured to only allow applications with a valid digital signature with the following commands:\n\n/usr/sbin/system_profiler SPApplicationsDataType | /usr/bin/grep -B 3 -A 4 -e \"Obtained from: Unknown\" | /usr/bin/grep -v -e \"Location: /Library/Application Support/Script Editor/Templates\" -e \"Location: /System/Library/\" | /usr/bin/awk -F \"Location: \" '{print $2}' | /usr/bin/sort -u\n\nIf any results are returned and is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.\n\nVerify only applications with a valid digital signature are allowed to run:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -E \"(EnableAssessment | AllowIdentifiedDevelopers)\"\n\nIf the result is not as follows, this is a finding.\n\n\"AllowIdentifiedDevelopers = 1;\nEnableAssessment = 1;\")\n  desc 'fix', 'Configure the macOS system to only allow applications with a valid digital signature by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60902r905282_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257217'\n  tag rid: 'SV-257217r905284_rule'\n  tag stig_id: 'APPL-13-002060'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60843r905283_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257217.rb"},"title":"The macOS system must only allow applications with a valid digital signature to run.","desc":"Gatekeeper settings must be configured correctly to only allow the system to run applications signed with a valid Apple Developer ID code. Administrator users will still have the option to override these settings on a per-app basis. Gatekeeper is a security feature that ensures that applications must be digitally signed by an Apple-issued certificate to run. Digital signatures allow the macOS host to verify that the application has not been modified by a malicious third party.","descriptions":{"default":"Gatekeeper settings must be configured correctly to only allow the system to run applications signed with a valid Apple Developer ID code. Administrator users will still have the option to override these settings on a per-app basis. Gatekeeper is a security feature that ensures that applications must be digitally signed by an Apple-issued certificate to run. Digital signatures allow the macOS host to verify that the application has not been modified by a malicious third party.","check":"Verify the macOS system is configured to only allow applications with a valid digital signature with the following commands:\n\n/usr/sbin/system_profiler SPApplicationsDataType | /usr/bin/grep -B 3 -A 4 -e \"Obtained from: Unknown\" | /usr/bin/grep -v -e \"Location: /Library/Application Support/Script Editor/Templates\" -e \"Location: /System/Library/\" | /usr/bin/awk -F \"Location: \" '{print $2}' | /usr/bin/sort -u\n\nIf any results are returned and is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.\n\nVerify only applications with a valid digital signature are allowed to run:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -E \"(EnableAssessment | AllowIdentifiedDevelopers)\"\n\nIf the result is not as follows, this is a finding.\n\n\"AllowIdentifiedDevelopers = 1;\nEnableAssessment = 1;\"","fix":"Configure the macOS system to only allow applications with a valid digital signature by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60902r905282_chk","severity":"medium","gid":"V-257217","rid":"SV-257217r905284_rule","stig_id":"APPL-13-002060","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60843r905283_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257218","code":"control 'SV-257218' do\n  title 'The macOS system must be configured with Bluetooth turned off unless approved by the organization.'\n  desc 'Without protection of communications with wireless peripherals, confidentiality and integrity may be compromised because unprotected communications can be intercepted and either read, altered, or used to compromise the operating system.\n\nThis requirement applies to wireless peripheral technologies (e.g., wireless mice, keyboards, displays, etc.) used with an operating system. Wireless peripherals (e.g., Wi-Fi/Bluetooth/IR keyboards, mice, and pointing devices and Near Field Communications [NFC]) present a unique challenge by creating an open, unsecured port on a computer. Wireless peripherals must meet DOD requirements for wireless data transmission and be approved for use by the AO. Even though some wireless peripherals, such as mice and pointing devices, do not ordinarily carry information that need to be protected, modification of communications with these wireless peripherals may be used to compromise the operating system. Communication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification.\n\nProtecting the confidentiality and integrity of communications with wireless peripherals can be accomplished by physical means (e.g., employing physical barriers to wireless radio frequencies) or by logical means (e.g., employing cryptographic techniques). If physical means of protection are employed, then logical means (cryptography) do not have to be employed, and vice versa. If the wireless peripheral is only passing telemetry data, encryption of the data may not be required.\n\n'\n  desc 'check', 'Verify the macOS system is configured to disable Bluetooth with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"DisableBluetooth\"\n\nDisableBluetooth = 1;\n\nIf the result is not \"DisableBluetooth = 1\" and the use of Bluetooth has not been documented with the ISSO as an operational requirement, this is a finding.\n\nVerify the macOS system is configured to disable access to the Bluetooth preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the result is not an array listing \"DisabledPreferencePanes\" containing \"com.apple.preferences.Bluetooth\" and the use of Bluetooth has not been documented with the ISSO as an operational requirement, this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable Bluetooth and disable access to the Bluetooth preference pane by installing the \"Custom Policy\" and \"Restrictions Policy\" configuration profiles.'\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60903r905285_chk'\n  tag severity: 'low'\n  tag gid: 'V-257218'\n  tag rid: 'SV-257218r905287_rule'\n  tag stig_id: 'APPL-13-002062'\n  tag gtitle: 'SRG-OS-000379-GPOS-00164'\n  tag fix_id: 'F-60844r905286_fix'\n  tag satisfies: ['SRG-OS-000379-GPOS-00164', 'SRG-OS-000481-GPOS-00481']\n  tag 'documentable'\n  tag cci: ['CCI-001967', 'CCI-002418']\n  tag nist: ['IA-3 (1)', 'SC-8']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257218.rb"},"title":"The macOS system must be configured with Bluetooth turned off unless approved by the organization.","desc":"Without protection of communications with wireless peripherals, confidentiality and integrity may be compromised because unprotected communications can be intercepted and either read, altered, or used to compromise the operating system.\n\nThis requirement applies to wireless peripheral technologies (e.g., wireless mice, keyboards, displays, etc.) used with an operating system. Wireless peripherals (e.g., Wi-Fi/Bluetooth/IR keyboards, mice, and pointing devices and Near Field Communications [NFC]) present a unique challenge by creating an open, unsecured port on a computer. Wireless peripherals must meet DOD requirements for wireless data transmission and be approved for use by the AO. Even though some wireless peripherals, such as mice and pointing devices, do not ordinarily carry information that need to be protected, modification of communications with these wireless peripherals may be used to compromise the operating system. Communication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification.\n\nProtecting the confidentiality and integrity of communications with wireless peripherals can be accomplished by physical means (e.g., employing physical barriers to wireless radio frequencies) or by logical means (e.g., employing cryptographic techniques). If physical means of protection are employed, then logical means (cryptography) do not have to be employed, and vice versa. If the wireless peripheral is only passing telemetry data, encryption of the data may not be required.\n\n","descriptions":{"default":"Without protection of communications with wireless peripherals, confidentiality and integrity may be compromised because unprotected communications can be intercepted and either read, altered, or used to compromise the operating system.\n\nThis requirement applies to wireless peripheral technologies (e.g., wireless mice, keyboards, displays, etc.) used with an operating system. Wireless peripherals (e.g., Wi-Fi/Bluetooth/IR keyboards, mice, and pointing devices and Near Field Communications [NFC]) present a unique challenge by creating an open, unsecured port on a computer. Wireless peripherals must meet DOD requirements for wireless data transmission and be approved for use by the AO. Even though some wireless peripherals, such as mice and pointing devices, do not ordinarily carry information that need to be protected, modification of communications with these wireless peripherals may be used to compromise the operating system. Communication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification.\n\nProtecting the confidentiality and integrity of communications with wireless peripherals can be accomplished by physical means (e.g., employing physical barriers to wireless radio frequencies) or by logical means (e.g., employing cryptographic techniques). If physical means of protection are employed, then logical means (cryptography) do not have to be employed, and vice versa. If the wireless peripheral is only passing telemetry data, encryption of the data may not be required.\n\n","check":"Verify the macOS system is configured to disable Bluetooth with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"DisableBluetooth\"\n\nDisableBluetooth = 1;\n\nIf the result is not \"DisableBluetooth = 1\" and the use of Bluetooth has not been documented with the ISSO as an operational requirement, this is a finding.\n\nVerify the macOS system is configured to disable access to the Bluetooth preference pane with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 6 \"DisabledPreferencePanes\"\n\nIf the result is not an array listing \"DisabledPreferencePanes\" containing \"com.apple.preferences.Bluetooth\" and the use of Bluetooth has not been documented with the ISSO as an operational requirement, this is a finding.","fix":"Configure the macOS system to disable Bluetooth and disable access to the Bluetooth preference pane by installing the \"Custom Policy\" and \"Restrictions Policy\" configuration profiles."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60903r905285_chk","severity":"low","gid":"V-257218","rid":"SV-257218r905287_rule","stig_id":"APPL-13-002062","gtitle":"SRG-OS-000379-GPOS-00164","fix_id":"F-60844r905286_fix","satisfies":["SRG-OS-000379-GPOS-00164","SRG-OS-000481-GPOS-00481"],"documentable":null,"cci":["CCI-001967","CCI-002418"],"nist":["IA-3 (1)","SC-8"]}},{"id":"SV-257219","code":"control 'SV-257219' do\n  title 'The macOS system must disable the guest account.'\n  desc 'Failure to provide logical access restrictions associated with changes to system configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the operating system can have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to operating system components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).'\n  desc 'check', 'Verify the macOS system is configured to disable the guest account with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"GuestAccount\"\n\nDisableGuestAccount = 1;\nEnableGuestAccount = 0;\n\nIf the result are not \"DisableGuestAccount = 1\" and \"EnableGuestAccount = 0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable the guest account by installing the \"Login Window Policy\" configuration profile.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60904r922874_chk'\n  tag severity: 'high'\n  tag gid: 'V-257219'\n  tag rid: 'SV-257219r922875_rule'\n  tag stig_id: 'APPL-13-002063'\n  tag gtitle: 'SRG-OS-000364-GPOS-00151'\n  tag fix_id: 'F-60845r905289_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001813']\n  tag nist: ['CM-5 (1) (a)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257219.rb"},"title":"The macOS system must disable the guest account.","desc":"Failure to provide logical access restrictions associated with changes to system configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the operating system can have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to operating system components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","descriptions":{"default":"Failure to provide logical access restrictions associated with changes to system configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the operating system can have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to operating system components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","check":"Verify the macOS system is configured to disable the guest account with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"GuestAccount\"\n\nDisableGuestAccount = 1;\nEnableGuestAccount = 0;\n\nIf the result are not \"DisableGuestAccount = 1\" and \"EnableGuestAccount = 0\", this is a finding.","fix":"Configure the macOS system to disable the guest account by installing the \"Login Window Policy\" configuration profile."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60904r922874_chk","severity":"high","gid":"V-257219","rid":"SV-257219r922875_rule","stig_id":"APPL-13-002063","gtitle":"SRG-OS-000364-GPOS-00151","fix_id":"F-60845r905289_fix","documentable":null,"cci":["CCI-001813"],"nist":["CM-5 (1) (a)"]}},{"id":"SV-257220","code":"control 'SV-257220' do\n  title 'The macOS system must have the security assessment policy subsystem enabled.'\n  desc 'Any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system.\n\nAccordingly, software defined by the organization as critical must be signed with a certificate that is recognized and approved by the organization.'\n  desc 'check', 'Verify the macOS system is configured with the security assessment policy subsystem enabled with the following command:\n\n/usr/sbin/spctl --status\n\nassessments enabled\n\nIf \"assessments enabled\" is not returned, this is a finding.'\n  desc 'fix', 'Configure the macOS system to enable the security assessment policy subsystem by installing the \"Custom Policy\" configuration profile.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60905r905291_chk'\n  tag severity: 'high'\n  tag gid: 'V-257220'\n  tag rid: 'SV-257220r905293_rule'\n  tag stig_id: 'APPL-13-002064'\n  tag gtitle: 'SRG-OS-000366-GPOS-00153'\n  tag fix_id: 'F-60846r905292_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001749']\n  tag nist: ['CM-5 (3)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257220.rb"},"title":"The macOS system must have the security assessment policy subsystem enabled.","desc":"Any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system.\n\nAccordingly, software defined by the organization as critical must be signed with a certificate that is recognized and approved by the organization.","descriptions":{"default":"Any changes to the hardware, software, and/or firmware components of the information system and/or application can potentially have significant effects on the overall security of the system.\n\nAccordingly, software defined by the organization as critical must be signed with a certificate that is recognized and approved by the organization.","check":"Verify the macOS system is configured with the security assessment policy subsystem enabled with the following command:\n\n/usr/sbin/spctl --status\n\nassessments enabled\n\nIf \"assessments enabled\" is not returned, this is a finding.","fix":"Configure the macOS system to enable the security assessment policy subsystem by installing the \"Custom Policy\" configuration profile."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60905r905291_chk","severity":"high","gid":"V-257220","rid":"SV-257220r905293_rule","stig_id":"APPL-13-002064","gtitle":"SRG-OS-000366-GPOS-00153","fix_id":"F-60846r905292_fix","documentable":null,"cci":["CCI-001749"],"nist":["CM-5 (3)"]}},{"id":"SV-257221","code":"control 'SV-257221' do\n  title 'The macOS system must not allow an unattended or automatic logon to the system.'\n  desc 'Failure to restrict system access to authenticated users negatively impacts operating system security.'\n  desc 'check', 'Verify the macOS system is configured to not allow automatic logon with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"DisableAutoLoginClient\"\n\n\"com.apple.login.mcx.DisableAutoLoginClient\" = 1;\n\nIf \"com.apple.login.mcx.DisableAutoLoginClient\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to not allow automatic login by installing the \"Login Window Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60906r905294_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257221'\n  tag rid: 'SV-257221r905296_rule'\n  tag stig_id: 'APPL-13-002066'\n  tag gtitle: 'SRG-OS-000480-GPOS-00229'\n  tag fix_id: 'F-60847r905295_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257221.rb"},"title":"The macOS system must not allow an unattended or automatic logon to the system.","desc":"Failure to restrict system access to authenticated users negatively impacts operating system security.","descriptions":{"default":"Failure to restrict system access to authenticated users negatively impacts operating system security.","check":"Verify the macOS system is configured to not allow automatic logon with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"DisableAutoLoginClient\"\n\n\"com.apple.login.mcx.DisableAutoLoginClient\" = 1;\n\nIf \"com.apple.login.mcx.DisableAutoLoginClient\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to not allow automatic login by installing the \"Login Window Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60906r905294_chk","severity":"medium","gid":"V-257221","rid":"SV-257221r905296_rule","stig_id":"APPL-13-002066","gtitle":"SRG-OS-000480-GPOS-00229","fix_id":"F-60847r905295_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257222","code":"control 'SV-257222' do\n  title \"The macOS system must set permissions on user home directories to prevent users from having access to read or modify another user's files.\"\n  desc 'Configuring the operating system to use the most restrictive permissions possible for user home directories helps to protect against inadvertent disclosures.\n\n'\n  desc 'check', %q(Verify the macOS system is configured so that permissions are set correctly on user home directories with the following commands:\n\n/bin/ls -le /Users\n\nThis command will return a listing of the permissions of the root of every user account configured on the system. For each of the users, the permissions must be \"drwxr-xr-x+\", with the user listed as the owner and the group listed as \"staff\". The plus(+) sign indicates an associated Access Control List, which must be:\n0: group:everyone deny delete\n\nFor every authorized user account, also run the following command:\n/usr/bin/sudo /bin/ls -le /Users/userid, where userid is an existing user. \n\nThis command will return the permissions of all the objects under the users' home directory. The permissions for each of the subdirectories must be:\ndrwx------+ \n 0: group:everyone deny delete\n\nThe exception is the \"Public\" directory, whose permissions must match the following:\ndrwxr-xr-x+ \n 0: group:everyone deny delete\n\nIf the permissions returned by either of these checks differ from what is shown, this is a finding.)\n  desc 'fix', 'Configure the macOS system to set the appropriate permissions for each user on the system with the following command:\n\n/usr/sbin/diskutil resetUserPermissions / DeviceNode UID, where \"DeviceNode UID\" is the ID number for the user whose home directory permissions need to be repaired.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60907r905297_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257222'\n  tag rid: 'SV-257222r905299_rule'\n  tag stig_id: 'APPL-13-002068'\n  tag gtitle: 'SRG-OS-000480-GPOS-00228'\n  tag fix_id: 'F-60848r905298_fix'\n  tag satisfies: ['SRG-OS-000480-GPOS-00228', 'SRG-OS-000480-GPOS-00230']\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257222.rb"},"title":"The macOS system must set permissions on user home directories to prevent users from having access to read or modify another user's files.","desc":"Configuring the operating system to use the most restrictive permissions possible for user home directories helps to protect against inadvertent disclosures.\n\n","descriptions":{"default":"Configuring the operating system to use the most restrictive permissions possible for user home directories helps to protect against inadvertent disclosures.\n\n","check":"Verify the macOS system is configured so that permissions are set correctly on user home directories with the following commands:\n\n/bin/ls -le /Users\n\nThis command will return a listing of the permissions of the root of every user account configured on the system. For each of the users, the permissions must be \"drwxr-xr-x+\", with the user listed as the owner and the group listed as \"staff\". The plus(+) sign indicates an associated Access Control List, which must be:\n0: group:everyone deny delete\n\nFor every authorized user account, also run the following command:\n/usr/bin/sudo /bin/ls -le /Users/userid, where userid is an existing user. \n\nThis command will return the permissions of all the objects under the users' home directory. The permissions for each of the subdirectories must be:\ndrwx------+ \n 0: group:everyone deny delete\n\nThe exception is the \"Public\" directory, whose permissions must match the following:\ndrwxr-xr-x+ \n 0: group:everyone deny delete\n\nIf the permissions returned by either of these checks differ from what is shown, this is a finding.","fix":"Configure the macOS system to set the appropriate permissions for each user on the system with the following command:\n\n/usr/sbin/diskutil resetUserPermissions / DeviceNode UID, where \"DeviceNode UID\" is the ID number for the user whose home directory permissions need to be repaired."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60907r905297_chk","severity":"medium","gid":"V-257222","rid":"SV-257222r905299_rule","stig_id":"APPL-13-002068","gtitle":"SRG-OS-000480-GPOS-00228","fix_id":"F-60848r905298_fix","satisfies":["SRG-OS-000480-GPOS-00228","SRG-OS-000480-GPOS-00230"],"documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257224","code":"control 'SV-257224' do\n  title 'The macOS system must use an approved antivirus program.'\n  desc 'An approved antivirus product must be installed and configured to run.\n\nMalicious software can establish a base on individual desktops and servers. Employing an automated mechanism to detect this type of software will aid in elimination of the software from the operating system.'\n  desc 'check', 'Verify the macOS system has the XProtect service running with the following command:\n\n/bin/launchctl list | /usr/bin/grep -cE \"(com.apple.XprotectFramework.PluginService$|com.apple.XProtect.daemon.scan$)\"\n\nIf the results show \"2\", the XProtect Service is running.\n\nIf the XProtect service is running, verify that it is configured to update automatically by using the following command:\n\n/usr/bin/defaults read /Library/Preferences/com.apple.SoftwareUpdate.plist | /usr/bin/grep \"ConfigDataInstall\"\n\nConfigDataInstall = 1;\n\nIf the XProtect service is being used and \"ConfigDataInstall\" is not set to \"1\", this is a finding.\n\nIf XProtect is not active on the system, ask the System Administrator (SA) or Information System Security Officer (ISSO) if an approved antivirus solution is loaded on the system. The antivirus solution may be bundled with an approved host-based security solution.\n\nIf there is no local antivirus solution installed on the system, this is a finding.'\n  desc 'fix', 'Configure the macOS system to automatically update XProtect by installing the \"Restrictions Policy\" configuration profile.\n\nIf XProtect is not being used, install an approved antivirus solution on the system.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60909r922876_chk'\n  tag severity: 'high'\n  tag gid: 'V-257224'\n  tag rid: 'SV-257224r922877_rule'\n  tag stig_id: 'APPL-13-002070'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60850r905304_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257224.rb"},"title":"The macOS system must use an approved antivirus program.","desc":"An approved antivirus product must be installed and configured to run.\n\nMalicious software can establish a base on individual desktops and servers. Employing an automated mechanism to detect this type of software will aid in elimination of the software from the operating system.","descriptions":{"default":"An approved antivirus product must be installed and configured to run.\n\nMalicious software can establish a base on individual desktops and servers. Employing an automated mechanism to detect this type of software will aid in elimination of the software from the operating system.","check":"Verify the macOS system has the XProtect service running with the following command:\n\n/bin/launchctl list | /usr/bin/grep -cE \"(com.apple.XprotectFramework.PluginService$|com.apple.XProtect.daemon.scan$)\"\n\nIf the results show \"2\", the XProtect Service is running.\n\nIf the XProtect service is running, verify that it is configured to update automatically by using the following command:\n\n/usr/bin/defaults read /Library/Preferences/com.apple.SoftwareUpdate.plist | /usr/bin/grep \"ConfigDataInstall\"\n\nConfigDataInstall = 1;\n\nIf the XProtect service is being used and \"ConfigDataInstall\" is not set to \"1\", this is a finding.\n\nIf XProtect is not active on the system, ask the System Administrator (SA) or Information System Security Officer (ISSO) if an approved antivirus solution is loaded on the system. The antivirus solution may be bundled with an approved host-based security solution.\n\nIf there is no local antivirus solution installed on the system, this is a finding.","fix":"Configure the macOS system to automatically update XProtect by installing the \"Restrictions Policy\" configuration profile.\n\nIf XProtect is not being used, install an approved antivirus solution on the system."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60909r922876_chk","severity":"high","gid":"V-257224","rid":"SV-257224r922877_rule","stig_id":"APPL-13-002070","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60850r905304_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257225","code":"control 'SV-257225' do\n  title 'The macOS system must issue or obtain public key certificates under an appropriate certificate policy from an approved service provider.'\n  desc 'DOD-approved certificates must be installed to the System Keychain so they will be available to all users.\n\nFor user certificates, each organization obtains certificates from an approved, shared service provider, as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority at medium assurance or higher, this Certification Authority will suffice. This control focuses on certificates with a visibility external to the information system and does not include certificates related to internal system operations; for example, application-specific time services. Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n'\n  desc 'check', %q(Verify the macOS system is configured with approved DOD certificates with the following command:\n\n/usr/bin/sudo /usr/bin/security dump-keychain | /usr/bin/grep labl | /usr/bin/awk -F\\\" '{ print $4 }'\n\nIf this list contains unapproved certificates, this is a finding.)\n  desc 'fix', 'Configure the macOS system with approved DOD certificates from the appropriate authority. Use Keychain Access from \"/Applications/Utilities\" to add certificates to the System Keychain or build a certificate root trust payload as described in the supplemental documentation supplied in this STIG package.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60910r905306_chk'\n  tag severity: 'high'\n  tag gid: 'V-257225'\n  tag rid: 'SV-257225r905308_rule'\n  tag stig_id: 'APPL-13-003001'\n  tag gtitle: 'SRG-OS-000066-GPOS-00034'\n  tag fix_id: 'F-60851r905307_fix'\n  tag satisfies: ['SRG-OS-000066-GPOS-00034', 'SRG-OS-000478-GPOS-00223']\n  tag 'documentable'\n  tag cci: ['CCI-000185', 'CCI-002450']\n  tag nist: ['IA-5 (2) (b) (1)', 'SC-13 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257225.rb"},"title":"The macOS system must issue or obtain public key certificates under an appropriate certificate policy from an approved service provider.","desc":"DOD-approved certificates must be installed to the System Keychain so they will be available to all users.\n\nFor user certificates, each organization obtains certificates from an approved, shared service provider, as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority at medium assurance or higher, this Certification Authority will suffice. This control focuses on certificates with a visibility external to the information system and does not include certificates related to internal system operations; for example, application-specific time services. Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n","descriptions":{"default":"DOD-approved certificates must be installed to the System Keychain so they will be available to all users.\n\nFor user certificates, each organization obtains certificates from an approved, shared service provider, as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority at medium assurance or higher, this Certification Authority will suffice. This control focuses on certificates with a visibility external to the information system and does not include certificates related to internal system operations; for example, application-specific time services. Use of weak or untested encryption algorithms undermines the purposes of using encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n","check":"Verify the macOS system is configured with approved DOD certificates with the following command:\n\n/usr/bin/sudo /usr/bin/security dump-keychain | /usr/bin/grep labl | /usr/bin/awk -F\\\" '{ print $4 }'\n\nIf this list contains unapproved certificates, this is a finding.","fix":"Configure the macOS system with approved DOD certificates from the appropriate authority. Use Keychain Access from \"/Applications/Utilities\" to add certificates to the System Keychain or build a certificate root trust payload as described in the supplemental documentation supplied in this STIG package."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60910r905306_chk","severity":"high","gid":"V-257225","rid":"SV-257225r905308_rule","stig_id":"APPL-13-003001","gtitle":"SRG-OS-000066-GPOS-00034","fix_id":"F-60851r905307_fix","satisfies":["SRG-OS-000066-GPOS-00034","SRG-OS-000478-GPOS-00223"],"documentable":null,"cci":["CCI-000185","CCI-002450"],"nist":["IA-5 (2) (b) (1)","SC-13 b"]}},{"id":"SV-257226","code":"control 'SV-257226' do\n  title 'The macOS system must enforce password complexity by requiring that at least one numeric character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.'\n  desc 'check', 'Verify the macOS system is configured to require at least one numeric character in password complexity with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"requireAlphanumeric\"\n\nrequireAlphanumeric = 1;\n\nIf the result is not \"requireAlphanumeric = 1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to require at least one numeric character in password complexity by installing the \"Passcode Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60911r905309_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257226'\n  tag rid: 'SV-257226r905311_rule'\n  tag stig_id: 'APPL-13-003007'\n  tag gtitle: 'SRG-OS-000071-GPOS-00039'\n  tag fix_id: 'F-60852r905310_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000194']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257226.rb"},"title":"The macOS system must enforce password complexity by requiring that at least one numeric character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","check":"Verify the macOS system is configured to require at least one numeric character in password complexity with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"requireAlphanumeric\"\n\nrequireAlphanumeric = 1;\n\nIf the result is not \"requireAlphanumeric = 1\", this is a finding.","fix":"Configure the macOS system to require at least one numeric character in password complexity by installing the \"Passcode Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60911r905309_chk","severity":"medium","gid":"V-257226","rid":"SV-257226r905311_rule","stig_id":"APPL-13-003007","gtitle":"SRG-OS-000071-GPOS-00039","fix_id":"F-60852r905310_fix","documentable":null,"cci":["CCI-000194"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-257227","code":"control 'SV-257227' do\n  title 'The macOS system must enforce a 60-day maximum password lifetime restriction.'\n  desc 'Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically.\n\nOne method of minimizing this risk is to use complex passwords and periodically change them. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.'\n  desc 'check', 'Verify the macOS system is configured to enforce a 60-day maximum password lifetime with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"maxPINAgeInDays\"\n\nmaxPINAgeInDays = 60;\n\nIf \"maxPINAgeInDays\" is set a value greater than \"60\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to require the enforcement of a 60-day maximum password lifetime by installing the \"Passcode Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60912r905312_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257227'\n  tag rid: 'SV-257227r905314_rule'\n  tag stig_id: 'APPL-13-003008'\n  tag gtitle: 'SRG-OS-000076-GPOS-00044'\n  tag fix_id: 'F-60853r905313_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000199']\n  tag nist: ['IA-5 (1) (d)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257227.rb"},"title":"The macOS system must enforce a 60-day maximum password lifetime restriction.","desc":"Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically.\n\nOne method of minimizing this risk is to use complex passwords and periodically change them. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.","descriptions":{"default":"Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically.\n\nOne method of minimizing this risk is to use complex passwords and periodically change them. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.","check":"Verify the macOS system is configured to enforce a 60-day maximum password lifetime with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"maxPINAgeInDays\"\n\nmaxPINAgeInDays = 60;\n\nIf \"maxPINAgeInDays\" is set a value greater than \"60\", this is a finding.","fix":"Configure the macOS system to require the enforcement of a 60-day maximum password lifetime by installing the \"Passcode Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60912r905312_chk","severity":"medium","gid":"V-257227","rid":"SV-257227r905314_rule","stig_id":"APPL-13-003008","gtitle":"SRG-OS-000076-GPOS-00044","fix_id":"F-60853r905313_fix","documentable":null,"cci":["CCI-000199"],"nist":["IA-5 (1) (d)"]}},{"id":"SV-257228","code":"control 'SV-257228' do\n  title 'The macOS system must prohibit password reuse for a minimum of five generations.'\n  desc 'Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the result is a password that is not changed as per policy requirements.'\n  desc 'check', 'Verify the macOS system is configured to prohibit password reuse for a minimum of five generations with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"pinHistory\"\n\npinHistory = 5;\n\nIf \"pinHistory\" is not set to \"5\" or greater, this is a finding.'\n  desc 'fix', 'Configure the macOS system to prohibit password reuse for five generations by installing the \"Passcode Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60913r905315_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257228'\n  tag rid: 'SV-257228r905317_rule'\n  tag stig_id: 'APPL-13-003009'\n  tag gtitle: 'SRG-OS-000077-GPOS-00045'\n  tag fix_id: 'F-60854r905316_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000200']\n  tag nist: ['IA-5 (1) (e)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257228.rb"},"title":"The macOS system must prohibit password reuse for a minimum of five generations.","desc":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the result is a password that is not changed as per policy requirements.","descriptions":{"default":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the result is a password that is not changed as per policy requirements.","check":"Verify the macOS system is configured to prohibit password reuse for a minimum of five generations with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"pinHistory\"\n\npinHistory = 5;\n\nIf \"pinHistory\" is not set to \"5\" or greater, this is a finding.","fix":"Configure the macOS system to prohibit password reuse for five generations by installing the \"Passcode Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60913r905315_chk","severity":"medium","gid":"V-257228","rid":"SV-257228r905317_rule","stig_id":"APPL-13-003009","gtitle":"SRG-OS-000077-GPOS-00045","fix_id":"F-60854r905316_fix","documentable":null,"cci":["CCI-000200"],"nist":["IA-5 (1) (e)"]}},{"id":"SV-257229","code":"control 'SV-257229' do\n  title 'The macOS system must enforce a minimum 15-character password length.'\n  desc 'The minimum password length must be set to 15 characters. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. The use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.'\n  desc 'check', 'Verify the macOS system is configured to enforce a minimum 15-character password length with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"minLength\"\n\nminLength = 15;\n\nIf \"minLength\" is not set to \"15\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to enforce a 15-character password length by installing the \"Passcode Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60914r905318_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257229'\n  tag rid: 'SV-257229r905320_rule'\n  tag stig_id: 'APPL-13-003010'\n  tag gtitle: 'SRG-OS-000078-GPOS-00046'\n  tag fix_id: 'F-60855r905319_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000205']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257229.rb"},"title":"The macOS system must enforce a minimum 15-character password length.","desc":"The minimum password length must be set to 15 characters. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. The use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","descriptions":{"default":"The minimum password length must be set to 15 characters. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. The use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","check":"Verify the macOS system is configured to enforce a minimum 15-character password length with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"minLength\"\n\nminLength = 15;\n\nIf \"minLength\" is not set to \"15\", this is a finding.","fix":"Configure the macOS system to enforce a 15-character password length by installing the \"Passcode Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60914r905318_chk","severity":"medium","gid":"V-257229","rid":"SV-257229r905320_rule","stig_id":"APPL-13-003010","gtitle":"SRG-OS-000078-GPOS-00046","fix_id":"F-60855r905319_fix","documentable":null,"cci":["CCI-000205"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-257230","code":"control 'SV-257230' do\n  title 'The macOS system must enforce password complexity by requiring that at least one special character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised. Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.'\n  desc 'check', 'Verify the macOS system is configured to enforce at least one special character of password complexity with the following commands:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"minComplexChars\"\n \nminComplexChar = 1;\n\nIf \"minComplexChars\" is not set to \"1\", this is a finding.\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowSimple\"\n\nallowSimple = 0;\n\nIf \"allowSimple\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to enforce at least one special character of password complexity by installing the \"Passcode Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60915r905321_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257230'\n  tag rid: 'SV-257230r905323_rule'\n  tag stig_id: 'APPL-13-003011'\n  tag gtitle: 'SRG-OS-000266-GPOS-00101'\n  tag fix_id: 'F-60856r905322_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001619']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257230.rb"},"title":"The macOS system must enforce password complexity by requiring that at least one special character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised. Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised. Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.","check":"Verify the macOS system is configured to enforce at least one special character of password complexity with the following commands:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"minComplexChars\"\n \nminComplexChar = 1;\n\nIf \"minComplexChars\" is not set to \"1\", this is a finding.\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowSimple\"\n\nallowSimple = 0;\n\nIf \"allowSimple\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to enforce at least one special character of password complexity by installing the \"Passcode Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60915r905321_chk","severity":"medium","gid":"V-257230","rid":"SV-257230r905323_rule","stig_id":"APPL-13-003011","gtitle":"SRG-OS-000266-GPOS-00101","fix_id":"F-60856r905322_fix","documentable":null,"cci":["CCI-001619"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-257231","code":"control 'SV-257231' do\n  title 'The macOS system must be configured to prevent displaying password hints.'\n  desc 'Password hints leak information about passwords in use and can lead to loss of confidentiality.'\n  desc 'check', 'Verify the macOS system is configured to prevent displaying passwords hints with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"RetriesUntilHint\"\n\nRetriesUntilHint = 0;\n\nIf \"RetriesUntilHint\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to prevent displaying password hints by installing the \"Login Window Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60916r905324_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257231'\n  tag rid: 'SV-257231r905326_rule'\n  tag stig_id: 'APPL-13-003012'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60857r905325_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257231.rb"},"title":"The macOS system must be configured to prevent displaying password hints.","desc":"Password hints leak information about passwords in use and can lead to loss of confidentiality.","descriptions":{"default":"Password hints leak information about passwords in use and can lead to loss of confidentiality.","check":"Verify the macOS system is configured to prevent displaying passwords hints with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"RetriesUntilHint\"\n\nRetriesUntilHint = 0;\n\nIf \"RetriesUntilHint\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to prevent displaying password hints by installing the \"Login Window Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60916r905324_chk","severity":"medium","gid":"V-257231","rid":"SV-257231r905326_rule","stig_id":"APPL-13-003012","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60857r905325_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257232","code":"control 'SV-257232' do\n  title 'The macOS system must be configured with a firmware password to prevent access to single user mode and booting from alternative media.'\n  desc 'Single user mode and the boot picker, as well as numerous other tools, are available on macOS through booting while holding the \"Option\" key down. Setting a firmware password restricts access to these tools.'\n  desc 'check', 'For Apple Silicon-based systems, this is not applicable.\n\nVerify the macOS system is configured with a firmware password with the following command:\n\n/usr/bin/sudo /usr/sbin/firmwarepasswd -check\n\nPassword Enabled:Yes\n\nIf \"Password Enabled\" is not set to \"Yes\", this is a finding.'\n  desc 'fix', 'Configure the macOS system with a firmware password with the following command:\n\n/usr/bin/sudo /usr/sbin/firmwarepasswd -setpasswd\n\nNote: If firmware password or passcode is forgotten, the only way to reset the forgotten password is through a machine-specific binary generated and provided by Apple. Users must schedule a support call and provide proof of purchase before the firmware binary will be generated.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60917r905327_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257232'\n  tag rid: 'SV-257232r905329_rule'\n  tag stig_id: 'APPL-13-003013'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60858r905328_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257232.rb"},"title":"The macOS system must be configured with a firmware password to prevent access to single user mode and booting from alternative media.","desc":"Single user mode and the boot picker, as well as numerous other tools, are available on macOS through booting while holding the \"Option\" key down. Setting a firmware password restricts access to these tools.","descriptions":{"default":"Single user mode and the boot picker, as well as numerous other tools, are available on macOS through booting while holding the \"Option\" key down. Setting a firmware password restricts access to these tools.","check":"For Apple Silicon-based systems, this is not applicable.\n\nVerify the macOS system is configured with a firmware password with the following command:\n\n/usr/bin/sudo /usr/sbin/firmwarepasswd -check\n\nPassword Enabled:Yes\n\nIf \"Password Enabled\" is not set to \"Yes\", this is a finding.","fix":"Configure the macOS system with a firmware password with the following command:\n\n/usr/bin/sudo /usr/sbin/firmwarepasswd -setpasswd\n\nNote: If firmware password or passcode is forgotten, the only way to reset the forgotten password is through a machine-specific binary generated and provided by Apple. Users must schedule a support call and provide proof of purchase before the firmware binary will be generated."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60917r905327_chk","severity":"medium","gid":"V-257232","rid":"SV-257232r905329_rule","stig_id":"APPL-13-003013","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60858r905328_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257233","code":"control 'SV-257233' do\n  title 'The macOS system must use multifactor authentication for local access to privileged and nonprivileged accounts.'\n  desc 'Without the use of multifactor authentication, the ease of access to privileged and nonprivileged functions is greatly increased.\n\nMultifactor authentication requires using two or more factors to achieve authentication.\n\nFactors include: \n1) something a user knows (e.g., password/PIN);\n2) something a user has (e.g., cryptographic identification device, token); and\n3) something a user is (e.g., biometric).\n\nA privileged account is defined as an information system account with authorizations of a privileged user.\n\nLocal access is defined as access to an organizational information system by a user (or process acting on behalf of a user) communicating through a direct connection without the use of a network.\n\nThe DOD CAC with DOD-approved PKI is an example of multifactor authentication.\n\n'\n  desc 'check', 'Verify the macOS system is configured to enforce multifactor authentication with the following commands:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"enforceSmartCard\"\n\nenforceSmartCard = 1;\n\nIf \"enforceSmartCard\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to enforce multifactor authentication by installing the \"Smart Card Policy\" configuration profile.\n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the \"Smart Card Policy\".'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60918r905330_chk'\n  tag severity: 'high'\n  tag gid: 'V-257233'\n  tag rid: 'SV-257233r905332_rule'\n  tag stig_id: 'APPL-13-003020'\n  tag gtitle: 'SRG-OS-000068-GPOS-00036'\n  tag fix_id: 'F-60859r905331_fix'\n  tag satisfies: ['SRG-OS-000068-GPOS-00036', 'SRG-OS-000107-GPOS-00054', 'SRG-OS-000108-GPOS-00055']\n  tag 'documentable'\n  tag cci: ['CCI-000187', 'CCI-000767', 'CCI-000768']\n  tag nist: ['IA-5 (2) (a) (2)', 'IA-2 (3)', 'IA-2 (4)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257233.rb"},"title":"The macOS system must use multifactor authentication for local access to privileged and nonprivileged accounts.","desc":"Without the use of multifactor authentication, the ease of access to privileged and nonprivileged functions is greatly increased.\n\nMultifactor authentication requires using two or more factors to achieve authentication.\n\nFactors include: \n1) something a user knows (e.g., password/PIN);\n2) something a user has (e.g., cryptographic identification device, token); and\n3) something a user is (e.g., biometric).\n\nA privileged account is defined as an information system account with authorizations of a privileged user.\n\nLocal access is defined as access to an organizational information system by a user (or process acting on behalf of a user) communicating through a direct connection without the use of a network.\n\nThe DOD CAC with DOD-approved PKI is an example of multifactor authentication.\n\n","descriptions":{"default":"Without the use of multifactor authentication, the ease of access to privileged and nonprivileged functions is greatly increased.\n\nMultifactor authentication requires using two or more factors to achieve authentication.\n\nFactors include: \n1) something a user knows (e.g., password/PIN);\n2) something a user has (e.g., cryptographic identification device, token); and\n3) something a user is (e.g., biometric).\n\nA privileged account is defined as an information system account with authorizations of a privileged user.\n\nLocal access is defined as access to an organizational information system by a user (or process acting on behalf of a user) communicating through a direct connection without the use of a network.\n\nThe DOD CAC with DOD-approved PKI is an example of multifactor authentication.\n\n","check":"Verify the macOS system is configured to enforce multifactor authentication with the following commands:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"enforceSmartCard\"\n\nenforceSmartCard = 1;\n\nIf \"enforceSmartCard\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to enforce multifactor authentication by installing the \"Smart Card Policy\" configuration profile.\n\nNote: To ensure continued access to the operating system, consult the supplemental guidance provided with the STIG before applying the \"Smart Card Policy\"."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60918r905330_chk","severity":"high","gid":"V-257233","rid":"SV-257233r905332_rule","stig_id":"APPL-13-003020","gtitle":"SRG-OS-000068-GPOS-00036","fix_id":"F-60859r905331_fix","satisfies":["SRG-OS-000068-GPOS-00036","SRG-OS-000107-GPOS-00054","SRG-OS-000108-GPOS-00055"],"documentable":null,"cci":["CCI-000187","CCI-000767","CCI-000768"],"nist":["IA-5 (2) (a) (2)","IA-2 (3)","IA-2 (4)"]}},{"id":"SV-257234","code":"control 'SV-257234' do\n  title 'The macOS system must be configured so that the login command requires smart card authentication.'\n  desc 'Configuring the operating system to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DOD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed in hardware, software, or firmware components of the system that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the system, including the parameters required to satisfy other security control requirements. Security-related parameters include, for example: registry settings; account, file, directory permission settings; and settings for functions, ports, protocols, services, and remote connections.'\n  desc 'check', 'For systems that are not using smart card authentication, this requirements is not applicable.\n\nVerify the macOS system is configured to require smart card authentication for the login command with the following command:\n\n/bin/cat /etc/pam.d/login \n\nIf the text that returns does not include the line \"auth sufficient pam_smartcard.so\" at the TOP of the listing and \"auth required pam_deny.so\" as the last entry of the auth management group, this is a finding.'\n  desc 'fix', 'Configure the macOS system to require smart card authentication for the login command with the following procedure:\n\n/usr/bin/sudo /bin/cp /etc/pam.d/login /etc/pam.d/login_backup_`date \"+%Y-%m-%d_%H:%M\"`\n\nReplace the contents of \"/etc/pam.d/login\" with the following:\n\n# login: auth account password session\nauth    sufficient    pam_smartcard.so\nauth    optional    pam_krb5.so use_kcminit\nauth    optional    pam_ntlm.so try_first_pass\nauth    optional    pam_mount.so try_first_pass\nauth    required    pam_opendirectory.so try_first_pass\nauth    required    pam_deny.so\naccount  required    pam_nologin.so\naccount  required    pam_opendirectory.so\npassword  required    pam_opendirectory.so\nsession  required    pam_launchd.so\nsession  required    pam_uwtmp.so\nsession  optional    pam_mount.so'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60919r905333_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257234'\n  tag rid: 'SV-257234r905335_rule'\n  tag stig_id: 'APPL-13-003050'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60860r905334_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257234.rb"},"title":"The macOS system must be configured so that the login command requires smart card authentication.","desc":"Configuring the operating system to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DOD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed in hardware, software, or firmware components of the system that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the system, including the parameters required to satisfy other security control requirements. Security-related parameters include, for example: registry settings; account, file, directory permission settings; and settings for functions, ports, protocols, services, and remote connections.","descriptions":{"default":"Configuring the operating system to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DOD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed in hardware, software, or firmware components of the system that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the system, including the parameters required to satisfy other security control requirements. Security-related parameters include, for example: registry settings; account, file, directory permission settings; and settings for functions, ports, protocols, services, and remote connections.","check":"For systems that are not using smart card authentication, this requirements is not applicable.\n\nVerify the macOS system is configured to require smart card authentication for the login command with the following command:\n\n/bin/cat /etc/pam.d/login \n\nIf the text that returns does not include the line \"auth sufficient pam_smartcard.so\" at the TOP of the listing and \"auth required pam_deny.so\" as the last entry of the auth management group, this is a finding.","fix":"Configure the macOS system to require smart card authentication for the login command with the following procedure:\n\n/usr/bin/sudo /bin/cp /etc/pam.d/login /etc/pam.d/login_backup_`date \"+%Y-%m-%d_%H:%M\"`\n\nReplace the contents of \"/etc/pam.d/login\" with the following:\n\n# login: auth account password session\nauth    sufficient    pam_smartcard.so\nauth    optional    pam_krb5.so use_kcminit\nauth    optional    pam_ntlm.so try_first_pass\nauth    optional    pam_mount.so try_first_pass\nauth    required    pam_opendirectory.so try_first_pass\nauth    required    pam_deny.so\naccount  required    pam_nologin.so\naccount  required    pam_opendirectory.so\npassword  required    pam_opendirectory.so\nsession  required    pam_launchd.so\nsession  required    pam_uwtmp.so\nsession  optional    pam_mount.so"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60919r905333_chk","severity":"medium","gid":"V-257234","rid":"SV-257234r905335_rule","stig_id":"APPL-13-003050","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60860r905334_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257235","code":"control 'SV-257235' do\n  title 'The macOS system must be configured so that the su command requires smart card authentication.'\n  desc 'Configuring the operating system to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DOD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed in hardware, software, or firmware components of the system that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the system, including the parameters required to satisfy other security control requirements. Security-related parameters include, for example: registry settings; account, file, directory permission settings; and settings for functions, ports, protocols, services, and remote connections.'\n  desc 'check', 'For systems that are not using smart card authentication, this requirement is not applicable.\n\nVerify the macOS system is configured to require smart card authentication for the \"su\" command with the following command:\n\n/bin/cat /etc/pam.d/su\n\nIf the text that returns does not include the line, \"auth sufficient pam_smartcard.so\" at the TOP of the listing and the next line is not \"auth required pam_rootok.so\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to require smart card authentication for the su command with the following procedure:\n\n/usr/bin/sudo /bin/cp /etc/pam.d/su /etc/pam.d/su_backup_`date \"+%Y-%m-%d_%H:%M\"`\n\nReplace the contents of \"/etc/pam.d/su\" with the following:\n\n# su: auth account session\nauth    sufficient    pam_smartcard.so\nauth    required    pam_rootok.so\naccount    required    pam_group.so no_warn group=admin,wheel ruser root_only fail_safe\naccount   required    pam_opendirectory.so no_check_shell\npassword  required    pam_opendirectory.so\nsession   required    pam_launchd.so'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60920r905336_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257235'\n  tag rid: 'SV-257235r905338_rule'\n  tag stig_id: 'APPL-13-003051'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60861r905337_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257235.rb"},"title":"The macOS system must be configured so that the su command requires smart card authentication.","desc":"Configuring the operating system to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DOD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed in hardware, software, or firmware components of the system that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the system, including the parameters required to satisfy other security control requirements. Security-related parameters include, for example: registry settings; account, file, directory permission settings; and settings for functions, ports, protocols, services, and remote connections.","descriptions":{"default":"Configuring the operating system to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DOD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed in hardware, software, or firmware components of the system that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the system, including the parameters required to satisfy other security control requirements. Security-related parameters include, for example: registry settings; account, file, directory permission settings; and settings for functions, ports, protocols, services, and remote connections.","check":"For systems that are not using smart card authentication, this requirement is not applicable.\n\nVerify the macOS system is configured to require smart card authentication for the \"su\" command with the following command:\n\n/bin/cat /etc/pam.d/su\n\nIf the text that returns does not include the line, \"auth sufficient pam_smartcard.so\" at the TOP of the listing and the next line is not \"auth required pam_rootok.so\", this is a finding.","fix":"Configure the macOS system to require smart card authentication for the su command with the following procedure:\n\n/usr/bin/sudo /bin/cp /etc/pam.d/su /etc/pam.d/su_backup_`date \"+%Y-%m-%d_%H:%M\"`\n\nReplace the contents of \"/etc/pam.d/su\" with the following:\n\n# su: auth account session\nauth    sufficient    pam_smartcard.so\nauth    required    pam_rootok.so\naccount    required    pam_group.so no_warn group=admin,wheel ruser root_only fail_safe\naccount   required    pam_opendirectory.so no_check_shell\npassword  required    pam_opendirectory.so\nsession   required    pam_launchd.so"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60920r905336_chk","severity":"medium","gid":"V-257235","rid":"SV-257235r905338_rule","stig_id":"APPL-13-003051","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60861r905337_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257236","code":"control 'SV-257236' do\n  title 'The macOS system must be configured so that the sudo command requires smart card authentication.'\n  desc 'Configuring the operating system to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DOD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed in hardware, software, or firmware components of the system that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the system, including the parameters required to satisfy other security control requirements. Security-related parameters include, for example: registry settings; account, file, directory permission settings; and settings for functions, ports, protocols, services, and remote connections.'\n  desc 'check', 'For systems that are not using smart card authentication, this requirement is not applicable.\n\nVerify the macOS system is configured to require smart card authentication for the \"sudo\" command with the following command:\n\n/bin/cat /etc/pam.d/sudo \n\nIf the text that returns does not include the line, \"auth sufficient pam_smartcard.so\" at the top of the listing and \"auth required pam_deny.so\" as the last entry of the auth management group, this is a finding.'\n  desc 'fix', 'Configure the macOS system to require smart card authentication for the sudo command with the following procedure:\n\n/usr/bin/sudo /bin/cp /etc/pam.d/login /etc/pam.d/sudo_backup_`date \"+%Y-%m-%d_%H:%M\"`\n\nReplace the contents of \"/etc/pam.d/sudo\" with the following:\n\n# sudo: auth account password session\nauth    sufficient    pam_smartcard.so\nauth    required    pam_opendirectory.so\nauth    required    pam_deny.so\naccount    required    pam_permit.so\npassword    required    pam_deny.so\nsession    required    pam_permit.so'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60921r905339_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257236'\n  tag rid: 'SV-257236r905341_rule'\n  tag stig_id: 'APPL-13-003052'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60862r905340_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257236.rb"},"title":"The macOS system must be configured so that the sudo command requires smart card authentication.","desc":"Configuring the operating system to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DOD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed in hardware, software, or firmware components of the system that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the system, including the parameters required to satisfy other security control requirements. Security-related parameters include, for example: registry settings; account, file, directory permission settings; and settings for functions, ports, protocols, services, and remote connections.","descriptions":{"default":"Configuring the operating system to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DOD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed in hardware, software, or firmware components of the system that affect the security posture and/or functionality of the system. Security-related parameters are those parameters impacting the security state of the system, including the parameters required to satisfy other security control requirements. Security-related parameters include, for example: registry settings; account, file, directory permission settings; and settings for functions, ports, protocols, services, and remote connections.","check":"For systems that are not using smart card authentication, this requirement is not applicable.\n\nVerify the macOS system is configured to require smart card authentication for the \"sudo\" command with the following command:\n\n/bin/cat /etc/pam.d/sudo \n\nIf the text that returns does not include the line, \"auth sufficient pam_smartcard.so\" at the top of the listing and \"auth required pam_deny.so\" as the last entry of the auth management group, this is a finding.","fix":"Configure the macOS system to require smart card authentication for the sudo command with the following procedure:\n\n/usr/bin/sudo /bin/cp /etc/pam.d/login /etc/pam.d/sudo_backup_`date \"+%Y-%m-%d_%H:%M\"`\n\nReplace the contents of \"/etc/pam.d/sudo\" with the following:\n\n# sudo: auth account password session\nauth    sufficient    pam_smartcard.so\nauth    required    pam_opendirectory.so\nauth    required    pam_deny.so\naccount    required    pam_permit.so\npassword    required    pam_deny.so\nsession    required    pam_permit.so"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60921r905339_chk","severity":"medium","gid":"V-257236","rid":"SV-257236r905341_rule","stig_id":"APPL-13-003052","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60862r905340_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257237","code":"control 'SV-257237' do\n  title 'The macOS system must be configured with system log files owned by root and group-owned by wheel or admin.'\n  desc 'System logs must only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct owner mitigates this risk.\n\nSome system log files are controlled by \"newsyslog\" and \"aslmanager\".'\n  desc 'check', %q(Verify the macOS system is configured with system log files owned by root or a service account and group-owned by wheel or admin with the commands below. \n\nThese commands must be run from inside \"/var/log\".\n\n/usr/bin/sudo /usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2> /dev/null\n\n/usr/bin/sudo /usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2> /dev/null\n\nIf there are any system log files that are not owned by \"root\" or a service account and group-owned by \"wheel\" or \"admin\", this is a finding.)\n  desc 'fix', 'Configure the macOS system with system log files owned by root or a service account and group-owned by wheel or admin with the following command:\n\n/usr/bin/sudo chown root:wheel [log file]\n\nAlternatively, if the file is managed by \"newsyslog\", find the configuration line in the directory \"/etc/newsyslog.d/\" or the file \"/etc/newsyslog.conf\" and ensure the owner:group column is set to \"root:wheel\" or the appropriate service account and group. \n\nIf the file is managed by \"aslmanager\", find the configuration line in the directory \"/etc/asl/\" or the file \"/etc/asl.conf\" and ensure that \"uid\" and \"gid\" options are set to a service account and group, respectively.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60922r905342_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257237'\n  tag rid: 'SV-257237r905344_rule'\n  tag stig_id: 'APPL-13-004001'\n  tag gtitle: 'SRG-OS-000206-GPOS-00084'\n  tag fix_id: 'F-60863r905343_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001314']\n  tag nist: ['SI-11 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257237.rb"},"title":"The macOS system must be configured with system log files owned by root and group-owned by wheel or admin.","desc":"System logs must only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct owner mitigates this risk.\n\nSome system log files are controlled by \"newsyslog\" and \"aslmanager\".","descriptions":{"default":"System logs must only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct owner mitigates this risk.\n\nSome system log files are controlled by \"newsyslog\" and \"aslmanager\".","check":"Verify the macOS system is configured with system log files owned by root or a service account and group-owned by wheel or admin with the commands below. \n\nThese commands must be run from inside \"/var/log\".\n\n/usr/bin/sudo /usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2> /dev/null\n\n/usr/bin/sudo /usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2> /dev/null\n\nIf there are any system log files that are not owned by \"root\" or a service account and group-owned by \"wheel\" or \"admin\", this is a finding.","fix":"Configure the macOS system with system log files owned by root or a service account and group-owned by wheel or admin with the following command:\n\n/usr/bin/sudo chown root:wheel [log file]\n\nAlternatively, if the file is managed by \"newsyslog\", find the configuration line in the directory \"/etc/newsyslog.d/\" or the file \"/etc/newsyslog.conf\" and ensure the owner:group column is set to \"root:wheel\" or the appropriate service account and group. \n\nIf the file is managed by \"aslmanager\", find the configuration line in the directory \"/etc/asl/\" or the file \"/etc/asl.conf\" and ensure that \"uid\" and \"gid\" options are set to a service account and group, respectively."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60922r905342_chk","severity":"medium","gid":"V-257237","rid":"SV-257237r905344_rule","stig_id":"APPL-13-004001","gtitle":"SRG-OS-000206-GPOS-00084","fix_id":"F-60863r905343_fix","documentable":null,"cci":["CCI-001314"],"nist":["SI-11 b"]}},{"id":"SV-257238","code":"control 'SV-257238' do\n  title 'The macOS system must be configured with system log files set to mode 640 or less permissive.'\n  desc 'System logs must only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions mitigates this risk.'\n  desc 'check', %q(Verify the macOS system is configured with system log files set to mode 640 or less with the commands below.\n\nThese commands must be run from inside \"/var/log\".\n\n/usr/bin/sudo /usr/bin/stat -f '%A:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2> /dev/null\n\n/usr/bin/sudo /usr/bin/stat -f '%A:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2> /dev/null\n\nIf the permissions on log files are not \"640\" or less permissive, this is a finding.)\n  desc 'fix', 'Configure the macOS system with system log files set to mode 640 with the following command:\n\n/usr/bin/sudo chmod 640 [log file]\n\nAlternatively, if the file is managed by \"newsyslog\", find the configuration line in the directory \"/etc/newsyslog.d/\" or the file \"/etc/newsyslog.conf\" and edit the mode column to be \"640\". Or, if the file is managed by \"aslmanager\", find the configuration line in the directory \"/etc/asl/\" or the file \"/etc/asl.conf\" and add or edit the mode option to be \"mode=0640\".'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60923r905345_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257238'\n  tag rid: 'SV-257238r905347_rule'\n  tag stig_id: 'APPL-13-004002'\n  tag gtitle: 'SRG-OS-000206-GPOS-00084'\n  tag fix_id: 'F-60864r905346_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001314']\n  tag nist: ['SI-11 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257238.rb"},"title":"The macOS system must be configured with system log files set to mode 640 or less permissive.","desc":"System logs must only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions mitigates this risk.","descriptions":{"default":"System logs must only be readable by root or admin users. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions mitigates this risk.","check":"Verify the macOS system is configured with system log files set to mode 640 or less with the commands below.\n\nThese commands must be run from inside \"/var/log\".\n\n/usr/bin/sudo /usr/bin/stat -f '%A:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2> /dev/null\n\n/usr/bin/sudo /usr/bin/stat -f '%A:%N' $(/usr/bin/grep -e '^>' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2> /dev/null\n\nIf the permissions on log files are not \"640\" or less permissive, this is a finding.","fix":"Configure the macOS system with system log files set to mode 640 with the following command:\n\n/usr/bin/sudo chmod 640 [log file]\n\nAlternatively, if the file is managed by \"newsyslog\", find the configuration line in the directory \"/etc/newsyslog.d/\" or the file \"/etc/newsyslog.conf\" and edit the mode column to be \"640\". Or, if the file is managed by \"aslmanager\", find the configuration line in the directory \"/etc/asl/\" or the file \"/etc/asl.conf\" and add or edit the mode option to be \"mode=0640\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60923r905345_chk","severity":"medium","gid":"V-257238","rid":"SV-257238r905347_rule","stig_id":"APPL-13-004002","gtitle":"SRG-OS-000206-GPOS-00084","fix_id":"F-60864r905346_fix","documentable":null,"cci":["CCI-001314"],"nist":["SI-11 b"]}},{"id":"SV-257239","code":"control 'SV-257239' do\n  title 'The macOS system must require users to reauthenticate for privilege escalation when using the \"sudo\" command.'\n  desc 'Without reauthentication, users may access resources or perform tasks for which they do not have authorization. \n\nWhen operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.\n\n'\n  desc 'check', 'Verify the macOS system requires reauthentication when using the \"sudo\" command to elevate privileges with the following command:\n\n/usr/bin/sudo /usr/bin/grep -r \"timestamp_timeout\" /etc/sudoers*\n\n/etc/sudoers.d/<customfile>:Defaults    timestamp_timeout=0 \n\nIf conflicting results are returned, this is a finding.\n\nIf \"timestamp_timeout\" is set to a negative number, is commented out, or no results are returned, this is a finding.'\n  desc 'fix', 'Configure the macOS system to require reauthentication when using the \"sudo\" command by creating a plain text file in the /private/etc/sudoers.d/ directory containing the following:\n\nDefaults timestamp_timeout=0'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60924r922878_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257239'\n  tag rid: 'SV-257239r922880_rule'\n  tag stig_id: 'APPL-13-004022'\n  tag gtitle: 'SRG-OS-000373-GPOS-00156'\n  tag fix_id: 'F-60865r922879_fix'\n  tag satisfies: ['SRG-OS-000373-GPOS-00156', 'SRG-OS-000373-GPOS-00157', 'SRG-OS-000373-GPOS-00158']\n  tag 'documentable'\n  tag cci: ['CCI-002038']\n  tag nist: ['IA-11']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257239.rb"},"title":"The macOS system must require users to reauthenticate for privilege escalation when using the \"sudo\" command.","desc":"Without reauthentication, users may access resources or perform tasks for which they do not have authorization. \n\nWhen operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.\n\n","descriptions":{"default":"Without reauthentication, users may access resources or perform tasks for which they do not have authorization. \n\nWhen operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.\n\n","check":"Verify the macOS system requires reauthentication when using the \"sudo\" command to elevate privileges with the following command:\n\n/usr/bin/sudo /usr/bin/grep -r \"timestamp_timeout\" /etc/sudoers*\n\n/etc/sudoers.d/<customfile>:Defaults    timestamp_timeout=0 \n\nIf conflicting results are returned, this is a finding.\n\nIf \"timestamp_timeout\" is set to a negative number, is commented out, or no results are returned, this is a finding.","fix":"Configure the macOS system to require reauthentication when using the \"sudo\" command by creating a plain text file in the /private/etc/sudoers.d/ directory containing the following:\n\nDefaults timestamp_timeout=0"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60924r922878_chk","severity":"medium","gid":"V-257239","rid":"SV-257239r922880_rule","stig_id":"APPL-13-004022","gtitle":"SRG-OS-000373-GPOS-00156","fix_id":"F-60865r922879_fix","satisfies":["SRG-OS-000373-GPOS-00156","SRG-OS-000373-GPOS-00157","SRG-OS-000373-GPOS-00158"],"documentable":null,"cci":["CCI-002038"],"nist":["IA-11"]}},{"id":"SV-257240","code":"control 'SV-257240' do\n  title 'The macOS system must enable System Integrity Protection.'\n  desc 'System Integrity Protection (SIP) is vital to the protection of the integrity of macOS. SIP restricts what actions can be performed by administrative users, including root, against protected parts of the operating system. SIP protects all system binaries, including audit tools, from unauthorized access by preventing the modification or deletion of system binaries, or the changing of the permissions associated with those binaries. SIP limits the privileges to change software resident within software libraries to processes that have signed by Apple and have special entitlements to write to system files, such as Apple software updates and Apple installers. By protecting audit binaries, SIP ensures the presence of an audit record generation capability for DOD-defined auditable events for all operating system components and supports on-demand and after-the-fact reporting requirements.\n\nThe XProtect program is part of the SIP component and is integral to protecting the operating system from malware and malicious code.\n\n'\n  desc 'check', 'Verify the macOS system is configured to enable System Integrity Protection with the following command:\n\n/usr/bin/csrutil status\n\nSystem Integrity Protection status: enabled.\n\nIf the \"System Integrity Protection\" is not set to \"enabled\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to enable \"System Integrity Protection\" by booting into \"Recovery\" mode, then launch \"Terminal\" from the \"Utilities\" menu, and run the following command:\n\n/usr/bin/csrutil enable'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60925r905351_chk'\n  tag severity: 'high'\n  tag gid: 'V-257240'\n  tag rid: 'SV-257240r905353_rule'\n  tag stig_id: 'APPL-13-005001'\n  tag gtitle: 'SRG-OS-000051-GPOS-00024'\n  tag fix_id: 'F-60866r905352_fix'\n  tag satisfies: ['SRG-OS-000051-GPOS-00024', 'SRG-OS-000054-GPOS-00025', 'SRG-OS-000062-GPOS-00031', 'SRG-OS-000122-GPOS-00063', 'SRG-OS-000256-GPOS-00097', 'SRG-OS-000257-GPOS-00098', 'SRG-OS-000258-GPOS-00099', 'SRG-OS-000259-GPOS-00100', 'SRG-OS-000348-GPOS-00136', 'SRG-OS-000349-GPOS-00137', 'SRG-OS-000350-GPOS-00138', 'SRG-OS-000351-GPOS-00139', 'SRG-OS-000352-GPOS-00140', 'SRG-OS-000353-GPOS-00141', 'SRG-OS-000354-GPOS-00142']\n  tag 'documentable'\n  tag cci: ['CCI-000154', 'CCI-000158', 'CCI-000169', 'CCI-001493', 'CCI-001494', 'CCI-001495', 'CCI-001499', 'CCI-001875', 'CCI-001876', 'CCI-001877', 'CCI-001878', 'CCI-001879', 'CCI-001880', 'CCI-001881', 'CCI-001882']\n  tag nist: ['AU-6 (4)', 'AU-7 (1)', 'AU-12 a', 'AU-9 a', 'AU-9', 'AU-9', 'CM-5 (6)', 'AU-7 a', 'AU-7 a', 'AU-7 a', 'AU-7 a', 'AU-7 a', 'AU-7 a', 'AU-7 b', 'AU-7 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257240.rb"},"title":"The macOS system must enable System Integrity Protection.","desc":"System Integrity Protection (SIP) is vital to the protection of the integrity of macOS. SIP restricts what actions can be performed by administrative users, including root, against protected parts of the operating system. SIP protects all system binaries, including audit tools, from unauthorized access by preventing the modification or deletion of system binaries, or the changing of the permissions associated with those binaries. SIP limits the privileges to change software resident within software libraries to processes that have signed by Apple and have special entitlements to write to system files, such as Apple software updates and Apple installers. By protecting audit binaries, SIP ensures the presence of an audit record generation capability for DOD-defined auditable events for all operating system components and supports on-demand and after-the-fact reporting requirements.\n\nThe XProtect program is part of the SIP component and is integral to protecting the operating system from malware and malicious code.\n\n","descriptions":{"default":"System Integrity Protection (SIP) is vital to the protection of the integrity of macOS. SIP restricts what actions can be performed by administrative users, including root, against protected parts of the operating system. SIP protects all system binaries, including audit tools, from unauthorized access by preventing the modification or deletion of system binaries, or the changing of the permissions associated with those binaries. SIP limits the privileges to change software resident within software libraries to processes that have signed by Apple and have special entitlements to write to system files, such as Apple software updates and Apple installers. By protecting audit binaries, SIP ensures the presence of an audit record generation capability for DOD-defined auditable events for all operating system components and supports on-demand and after-the-fact reporting requirements.\n\nThe XProtect program is part of the SIP component and is integral to protecting the operating system from malware and malicious code.\n\n","check":"Verify the macOS system is configured to enable System Integrity Protection with the following command:\n\n/usr/bin/csrutil status\n\nSystem Integrity Protection status: enabled.\n\nIf the \"System Integrity Protection\" is not set to \"enabled\", this is a finding.","fix":"Configure the macOS system to enable \"System Integrity Protection\" by booting into \"Recovery\" mode, then launch \"Terminal\" from the \"Utilities\" menu, and run the following command:\n\n/usr/bin/csrutil enable"},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60925r905351_chk","severity":"high","gid":"V-257240","rid":"SV-257240r905353_rule","stig_id":"APPL-13-005001","gtitle":"SRG-OS-000051-GPOS-00024","fix_id":"F-60866r905352_fix","satisfies":["SRG-OS-000051-GPOS-00024","SRG-OS-000054-GPOS-00025","SRG-OS-000062-GPOS-00031","SRG-OS-000122-GPOS-00063","SRG-OS-000256-GPOS-00097","SRG-OS-000257-GPOS-00098","SRG-OS-000258-GPOS-00099","SRG-OS-000259-GPOS-00100","SRG-OS-000348-GPOS-00136","SRG-OS-000349-GPOS-00137","SRG-OS-000350-GPOS-00138","SRG-OS-000351-GPOS-00139","SRG-OS-000352-GPOS-00140","SRG-OS-000353-GPOS-00141","SRG-OS-000354-GPOS-00142"],"documentable":null,"cci":["CCI-000154","CCI-000158","CCI-000169","CCI-001493","CCI-001494","CCI-001495","CCI-001499","CCI-001875","CCI-001876","CCI-001877","CCI-001878","CCI-001879","CCI-001880","CCI-001881","CCI-001882"],"nist":["AU-6 (4)","AU-7 (1)","AU-12 a","AU-9 a","AU-9","AU-9","CM-5 (6)","AU-7 a","AU-7 a","AU-7 a","AU-7 a","AU-7 a","AU-7 a","AU-7 b","AU-7 b"]}},{"id":"SV-257241","code":"control 'SV-257241' do\n  title 'The macOS system must implement cryptographic mechanisms to protect the confidentiality and integrity of all information at rest.'\n  desc 'Information at rest refers to the state of information when it is located on a secondary storage device (e.g., disk drive and tape drive) within an organizational information system. Mobile devices, laptops, desktops, and storage devices can be lost or stolen, and the contents of their data storage (e.g., hard drives and nonvolatile memory) can be read, copied, or altered. By encrypting the system hard drive, the confidentiality and integrity of any data stored on the system is ensured. FileVault Disk Encryption mitigates this risk.\n\n'\n  desc 'check', 'Verify the macOS system is configured to enable \"FileVault\" with the following command:\n\n/usr/bin/fdesetup status\n\nIf \"FileVault\" is \"Off\" and the device is a mobile device or the organization has determined that the drive must encrypt data at rest, this is a finding.'\n  desc 'fix', 'Configure the macOS system to enable \"FileVault\" by opening System Settings >> Privacy & Security >> Security and navigate to the \"FileVault\" section. Use this panel to configure full-disk encryption.\n\nAlternatively, from the command line, run the following command to enable \"FileVault\":\n\n/usr/bin/sudo /usr/bin/fdesetup enable\n\nAfter \"FileVault\" is initially set up, additional users can be added.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60926r905354_chk'\n  tag severity: 'high'\n  tag gid: 'V-257241'\n  tag rid: 'SV-257241r905356_rule'\n  tag stig_id: 'APPL-13-005020'\n  tag gtitle: 'SRG-OS-000185-GPOS-00079'\n  tag fix_id: 'F-60867r905355_fix'\n  tag satisfies: ['SRG-OS-000185-GPOS-00079', 'SRG-OS-000404-GPOS-00183', 'SRG-OS-000405-GPOS-00184']\n  tag 'documentable'\n  tag cci: ['CCI-001199', 'CCI-002475', 'CCI-002476']\n  tag nist: ['SC-28', 'SC-28 (1)', 'SC-28 (1)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257241.rb"},"title":"The macOS system must implement cryptographic mechanisms to protect the confidentiality and integrity of all information at rest.","desc":"Information at rest refers to the state of information when it is located on a secondary storage device (e.g., disk drive and tape drive) within an organizational information system. Mobile devices, laptops, desktops, and storage devices can be lost or stolen, and the contents of their data storage (e.g., hard drives and nonvolatile memory) can be read, copied, or altered. By encrypting the system hard drive, the confidentiality and integrity of any data stored on the system is ensured. FileVault Disk Encryption mitigates this risk.\n\n","descriptions":{"default":"Information at rest refers to the state of information when it is located on a secondary storage device (e.g., disk drive and tape drive) within an organizational information system. Mobile devices, laptops, desktops, and storage devices can be lost or stolen, and the contents of their data storage (e.g., hard drives and nonvolatile memory) can be read, copied, or altered. By encrypting the system hard drive, the confidentiality and integrity of any data stored on the system is ensured. FileVault Disk Encryption mitigates this risk.\n\n","check":"Verify the macOS system is configured to enable \"FileVault\" with the following command:\n\n/usr/bin/fdesetup status\n\nIf \"FileVault\" is \"Off\" and the device is a mobile device or the organization has determined that the drive must encrypt data at rest, this is a finding.","fix":"Configure the macOS system to enable \"FileVault\" by opening System Settings >> Privacy & Security >> Security and navigate to the \"FileVault\" section. Use this panel to configure full-disk encryption.\n\nAlternatively, from the command line, run the following command to enable \"FileVault\":\n\n/usr/bin/sudo /usr/bin/fdesetup enable\n\nAfter \"FileVault\" is initially set up, additional users can be added."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60926r905354_chk","severity":"high","gid":"V-257241","rid":"SV-257241r905356_rule","stig_id":"APPL-13-005020","gtitle":"SRG-OS-000185-GPOS-00079","fix_id":"F-60867r905355_fix","satisfies":["SRG-OS-000185-GPOS-00079","SRG-OS-000404-GPOS-00183","SRG-OS-000405-GPOS-00184"],"documentable":null,"cci":["CCI-001199","CCI-002475","CCI-002476"],"nist":["SC-28","SC-28 (1)","SC-28 (1)"]}},{"id":"SV-257242","code":"control 'SV-257242' do\n  title 'The macOS Application Firewall must be enabled.'\n  desc 'Firewalls protect computers from network attacks by blocking or limiting access to open network ports. Application firewalls limit which applications are allowed to communicate over the network.'\n  desc 'check', 'Verify the macOS system is configured to enable the built-in firewall with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"EnableFirewall\\\\|EnableStealthMode\"\n\nEnableFirewall = 1;\nEnableStealthMode = 1;\n\nIf \"EnableFirewall\" and \"EnableStealthMode\" are not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to enable the built-in firewall by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60927r905357_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257242'\n  tag rid: 'SV-257242r905359_rule'\n  tag stig_id: 'APPL-13-005050'\n  tag gtitle: 'SRG-OS-000480-GPOS-00232'\n  tag fix_id: 'F-60868r905358_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257242.rb"},"title":"The macOS Application Firewall must be enabled.","desc":"Firewalls protect computers from network attacks by blocking or limiting access to open network ports. Application firewalls limit which applications are allowed to communicate over the network.","descriptions":{"default":"Firewalls protect computers from network attacks by blocking or limiting access to open network ports. Application firewalls limit which applications are allowed to communicate over the network.","check":"Verify the macOS system is configured to enable the built-in firewall with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"EnableFirewall\\|EnableStealthMode\"\n\nEnableFirewall = 1;\nEnableStealthMode = 1;\n\nIf \"EnableFirewall\" and \"EnableStealthMode\" are not set to \"1\", this is a finding.","fix":"Configure the macOS system to enable the built-in firewall by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60927r905357_chk","severity":"medium","gid":"V-257242","rid":"SV-257242r905359_rule","stig_id":"APPL-13-005050","gtitle":"SRG-OS-000480-GPOS-00232","fix_id":"F-60868r905358_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257243","code":"control 'SV-257243' do\n  title 'The macOS system must restrict the ability of individuals to use USB storage devices.'\n  desc 'External writeable media devices must be disabled for users. External USB devices are a potential vector for malware and can be used to exfiltrate sensitive data if an approved data-loss prevention (DLP) solution is not installed.'\n  desc 'check', 'Verify the macOS system is configured to disable USB storage devices with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 32 \"mount-controls\"\n\nbd = (\n\"read-only\"\n);\nblankbd = (\ndeny,\neject\n);\nblankcd = (\ndeny,\neject\n);\nblankdvd = (\ndeny,\neject\n);\ncd = (\n\"read-only\"\n);\n\"disk-image\" = (\n\"read-only\"\n);\ndvd = (\n\"read-only\"\n);\ndvdram = (\ndeny,\neject\n);\n\"harddisk-external\" = (\ndeny,\neject\n);\n\nIf the result does not match the output above and is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable USB storage devices by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60928r905360_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257243'\n  tag rid: 'SV-257243r905362_rule'\n  tag stig_id: 'APPL-13-005051'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60869r905361_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257243.rb"},"title":"The macOS system must restrict the ability of individuals to use USB storage devices.","desc":"External writeable media devices must be disabled for users. External USB devices are a potential vector for malware and can be used to exfiltrate sensitive data if an approved data-loss prevention (DLP) solution is not installed.","descriptions":{"default":"External writeable media devices must be disabled for users. External USB devices are a potential vector for malware and can be used to exfiltrate sensitive data if an approved data-loss prevention (DLP) solution is not installed.","check":"Verify the macOS system is configured to disable USB storage devices with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep -A 32 \"mount-controls\"\n\nbd = (\n\"read-only\"\n);\nblankbd = (\ndeny,\neject\n);\nblankcd = (\ndeny,\neject\n);\nblankdvd = (\ndeny,\neject\n);\ncd = (\n\"read-only\"\n);\n\"disk-image\" = (\n\"read-only\"\n);\ndvd = (\n\"read-only\"\n);\ndvdram = (\ndeny,\neject\n);\n\"harddisk-external\" = (\ndeny,\neject\n);\n\nIf the result does not match the output above and is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.","fix":"Configure the macOS system to disable USB storage devices by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60928r905360_chk","severity":"medium","gid":"V-257243","rid":"SV-257243r905362_rule","stig_id":"APPL-13-005051","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60869r905361_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257244","code":"control 'SV-257244' do\n  title 'The macOS system logon window must be configured to prompt for username and password.'\n  desc 'The logon window must be configured to prompt all users for both a username and a password. By default, the system displays a list of known users at the logon screen. This gives an advantage to an attacker with physical access to the system, as the attacker would only have to guess the password for one of the listed accounts.'\n  desc 'check', 'Verify the macOS system is configured to prompt for username and password at the logon window with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SHOWFULLNAME\"\n\nSHOWFULLNAME = 1;\n\nIf \"SHOWFULLNAME\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to prompt for username and password at the logon window by installing the \"Login Window Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60929r905363_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257244'\n  tag rid: 'SV-257244r905365_rule'\n  tag stig_id: 'APPL-13-005052'\n  tag gtitle: 'SRG-OS-000480-GPOS-00229'\n  tag fix_id: 'F-60870r905364_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257244.rb"},"title":"The macOS system logon window must be configured to prompt for username and password.","desc":"The logon window must be configured to prompt all users for both a username and a password. By default, the system displays a list of known users at the logon screen. This gives an advantage to an attacker with physical access to the system, as the attacker would only have to guess the password for one of the listed accounts.","descriptions":{"default":"The logon window must be configured to prompt all users for both a username and a password. By default, the system displays a list of known users at the logon screen. This gives an advantage to an attacker with physical access to the system, as the attacker would only have to guess the password for one of the listed accounts.","check":"Verify the macOS system is configured to prompt for username and password at the logon window with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SHOWFULLNAME\"\n\nSHOWFULLNAME = 1;\n\nIf \"SHOWFULLNAME\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to prompt for username and password at the logon window by installing the \"Login Window Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60929r905363_chk","severity":"medium","gid":"V-257244","rid":"SV-257244r905365_rule","stig_id":"APPL-13-005052","gtitle":"SRG-OS-000480-GPOS-00229","fix_id":"F-60870r905364_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257245","code":"control 'SV-257245' do\n  title 'The macOS system must restrict the ability of individuals to write to external optical media.'\n  desc 'External writeable media devices must be disabled for users. External optical media devices can be used to exfiltrate sensitive data if an approved data-loss prevention (DLP) solution is not installed.'\n  desc 'check', 'Verify the macOS system is configured to disable writing to external optical media devices with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"BurnSupport\"\n\nBurnSupport = off;\n\nIf \"BurnSupport\" is not set to \"off\" and is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable writing to external optical media devices by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60930r905366_chk'\n  tag severity: 'low'\n  tag gid: 'V-257245'\n  tag rid: 'SV-257245r905368_rule'\n  tag stig_id: 'APPL-13-005053'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-60871r905367_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257245.rb"},"title":"The macOS system must restrict the ability of individuals to write to external optical media.","desc":"External writeable media devices must be disabled for users. External optical media devices can be used to exfiltrate sensitive data if an approved data-loss prevention (DLP) solution is not installed.","descriptions":{"default":"External writeable media devices must be disabled for users. External optical media devices can be used to exfiltrate sensitive data if an approved data-loss prevention (DLP) solution is not installed.","check":"Verify the macOS system is configured to disable writing to external optical media devices with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"BurnSupport\"\n\nBurnSupport = off;\n\nIf \"BurnSupport\" is not set to \"off\" and is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.","fix":"Configure the macOS system to disable writing to external optical media devices by installing the \"Restrictions Policy\" configuration profile."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60930r905366_chk","severity":"low","gid":"V-257245","rid":"SV-257245r905368_rule","stig_id":"APPL-13-005053","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-60871r905367_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-257246","code":"control 'SV-257246' do\n  title 'The macOS system must be configured to disable prompts to configure Touch ID.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable prompts to setup TouchID with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipTouchIDSetup\"\n\nSkipTouchIDSetup = 1;\n\nIf \"SkipTouchIDSetup\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable prompts to setup TouchID by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60931r905369_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257246'\n  tag rid: 'SV-257246r905371_rule'\n  tag stig_id: 'APPL-13-005054'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60872r905370_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257246.rb"},"title":"The macOS system must be configured to disable prompts to configure Touch ID.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","check":"Verify the macOS system is configured to disable prompts to setup TouchID with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipTouchIDSetup\"\n\nSkipTouchIDSetup = 1;\n\nIf \"SkipTouchIDSetup\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to disable prompts to setup TouchID by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60931r905369_chk","severity":"medium","gid":"V-257246","rid":"SV-257246r905371_rule","stig_id":"APPL-13-005054","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60872r905370_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257247","code":"control 'SV-257247' do\n  title 'The macOS system must be configured to disable prompts to configure ScreenTime.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable Screentime Setup with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipScreenTime\"\n\nSkipScreenTime = 1;\n\nIf \"SkipScreenTime\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable Screentime Setup by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60932r905372_chk'\n  tag severity: 'low'\n  tag gid: 'V-257247'\n  tag rid: 'SV-257247r905374_rule'\n  tag stig_id: 'APPL-13-005055'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60873r905373_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257247.rb"},"title":"The macOS system must be configured to disable prompts to configure ScreenTime.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","check":"Verify the macOS system is configured to disable Screentime Setup with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipScreenTime\"\n\nSkipScreenTime = 1;\n\nIf \"SkipScreenTime\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to disable Screentime Setup by installing the \"Restrictions Policy\" configuration profile."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60932r905372_chk","severity":"low","gid":"V-257247","rid":"SV-257247r905374_rule","stig_id":"APPL-13-005055","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60873r905373_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257248","code":"control 'SV-257248' do\n  title 'The macOS system must be configured to disable prompts to configure Unlock with Watch.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.'\n  desc 'check', 'Verify the macOS system is configured to disable prompts to setup Unlock with Watch with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipUnlockWithWatch\"\n\nSkipUnlockWithWatch = 1;\n\nIf \"SkipUnlockWithWatch\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to disable prompts to setup Unlock with Watch by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60933r905375_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257248'\n  tag rid: 'SV-257248r905377_rule'\n  tag stig_id: 'APPL-13-005056'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60874r905376_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257248.rb"},"title":"The macOS system must be configured to disable prompts to configure Unlock with Watch.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","check":"Verify the macOS system is configured to disable prompts to setup Unlock with Watch with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"SkipUnlockWithWatch\"\n\nSkipUnlockWithWatch = 1;\n\nIf \"SkipUnlockWithWatch\" is not set to \"1\", this is a finding.","fix":"Configure the macOS system to disable prompts to setup Unlock with Watch by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60933r905375_chk","severity":"medium","gid":"V-257248","rid":"SV-257248r905377_rule","stig_id":"APPL-13-005056","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60874r905376_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257249","code":"control 'SV-257249' do\n  title 'The macOS system must be configured to prevent activity continuation between Apple devices.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.'\n  desc 'check', 'Verify the macOS system is configured to prevent activity continuation between Apple devices with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowActivityContinuation\"\n\nallowActivityContinuation = 0;\n\nIf \"allowActivityContinuation\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to prevent activity continuation between Apple devices by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.3\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60934r905378_chk'\n  tag severity: 'low'\n  tag gid: 'V-257249'\n  tag rid: 'SV-257249r905380_rule'\n  tag stig_id: 'APPL-13-005058'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60875r905379_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257249.rb"},"title":"The macOS system must be configured to prevent activity continuation between Apple devices.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","check":"Verify the macOS system is configured to prevent activity continuation between Apple devices with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowActivityContinuation\"\n\nallowActivityContinuation = 0;\n\nIf \"allowActivityContinuation\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to prevent activity continuation between Apple devices by installing the \"Restrictions Policy\" configuration profile."},"impact":0.3,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60934r905378_chk","severity":"low","gid":"V-257249","rid":"SV-257249r905380_rule","stig_id":"APPL-13-005058","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60875r905379_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257250","code":"control 'SV-257250' do\n  title 'The macOS system must be configured to prevent password proximity sharing requests from nearby Apple devices.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.'\n  desc 'check', 'Verify the macOS system is configured to prevent password proximity sharing with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowPasswordProximityRequests\"\n\nallowPasswordProximityRequests = 0;\n\nIf \"allowPasswordProximityRequests\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to prevent Configure the macOS system to prevent password proximity sharing by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60935r905381_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257250'\n  tag rid: 'SV-257250r905383_rule'\n  tag stig_id: 'APPL-13-005060'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60876r905382_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257250.rb"},"title":"The macOS system must be configured to prevent password proximity sharing requests from nearby Apple devices.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","check":"Verify the macOS system is configured to prevent password proximity sharing with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowPasswordProximityRequests\"\n\nallowPasswordProximityRequests = 0;\n\nIf \"allowPasswordProximityRequests\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to prevent Configure the macOS system to prevent password proximity sharing by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60935r905381_chk","severity":"medium","gid":"V-257250","rid":"SV-257250r905383_rule","stig_id":"APPL-13-005060","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60876r905382_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257251","code":"control 'SV-257251' do\n  title 'The macOS system must be configured to prevent users from erasing all system content and settings.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.'\n  desc 'check', 'Verify the macOS system is configured to prevent users from erasing all system content and settings with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowEraseContentAndSettings\"\n\nallowEraseContentAndSettings = 0;\n\nIf \"allowEraseContentAndSettings\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to prevent users from erasing all system content and settings by installing the \"Restrictions Policy\" configuration profile.'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60936r905384_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257251'\n  tag rid: 'SV-257251r905386_rule'\n  tag stig_id: 'APPL-13-005061'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-60877r905385_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257251.rb"},"title":"The macOS system must be configured to prevent users from erasing all system content and settings.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems can provide a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","check":"Verify the macOS system is configured to prevent users from erasing all system content and settings with the following command:\n\n/usr/sbin/system_profiler SPConfigurationProfileDataType | /usr/bin/grep \"allowEraseContentAndSettings\"\n\nallowEraseContentAndSettings = 0;\n\nIf \"allowEraseContentAndSettings\" is not set to \"0\", this is a finding.","fix":"Configure the macOS system to prevent users from erasing all system content and settings by installing the \"Restrictions Policy\" configuration profile."},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60936r905384_chk","severity":"medium","gid":"V-257251","rid":"SV-257251r905386_rule","stig_id":"APPL-13-005061","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-60877r905385_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-257293","code":"control 'SV-257293' do\n  title 'The macOS system must implement approved ciphers within the SSH client configuration to protect the confidentiality of SSH connections.'\n  desc 'Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n'\n  desc 'check', 'Verify the macOS system is configured to use approved SSH ciphers within the SSH client configuration with the following command:\n\n/usr/bin/sudo /usr/bin/grep -ir \"ciphers\" /etc/ssh/ssh_config*\n\n/etc/ssh/ssh_config.d/fips_ssh_config:Ciphers aes128-gcm@openssh.com\n\nIf any ciphers other than \"aes128-gcm@openssh.com\" are listed, or the \"ciphers\" keyword is missing, this is a finding.'\n  desc 'fix', 'Configure the macOS system to use approved SSH ciphers by creating a plain text file in the /private/etc/ssh/ssh_config.d/ directory containing the following:\n\nCiphers aes128-gcm@openssh.com\n\nThe SSH service must be restarted for changes to take effect.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60980r919356_chk'\n  tag severity: 'high'\n  tag gid: 'V-257293'\n  tag rid: 'SV-257293r919358_rule'\n  tag stig_id: 'APPL-13-000057'\n  tag gtitle: 'SRG-OS-000033-GPOS-00014'\n  tag fix_id: 'F-60907r919357_fix'\n  tag satisfies: ['SRG-OS-000033-GPOS-00014', 'SRG-OS-000120-GPOS-00061', 'SRG-OS-000125-GPOS-00065', 'SRG-OS-000250-GPOS-00093', 'SRG-OS-000393-GPOS-00173', 'SRG-OS-000394-GPOS-00174']\n  tag 'documentable'\n  tag cci: ['CCI-000068', 'CCI-000803', 'CCI-000877', 'CCI-001453', 'CCI-002890', 'CCI-003123']\n  tag nist: ['AC-17 (2)', 'IA-7', 'MA-4 c', 'AC-17 (2)', 'MA-4 (6)', 'MA-4 (6)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257293.rb"},"title":"The macOS system must implement approved ciphers within the SSH client configuration to protect the confidentiality of SSH connections.","desc":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","descriptions":{"default":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","check":"Verify the macOS system is configured to use approved SSH ciphers within the SSH client configuration with the following command:\n\n/usr/bin/sudo /usr/bin/grep -ir \"ciphers\" /etc/ssh/ssh_config*\n\n/etc/ssh/ssh_config.d/fips_ssh_config:Ciphers aes128-gcm@openssh.com\n\nIf any ciphers other than \"aes128-gcm@openssh.com\" are listed, or the \"ciphers\" keyword is missing, this is a finding.","fix":"Configure the macOS system to use approved SSH ciphers by creating a plain text file in the /private/etc/ssh/ssh_config.d/ directory containing the following:\n\nCiphers aes128-gcm@openssh.com\n\nThe SSH service must be restarted for changes to take effect."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60980r919356_chk","severity":"high","gid":"V-257293","rid":"SV-257293r919358_rule","stig_id":"APPL-13-000057","gtitle":"SRG-OS-000033-GPOS-00014","fix_id":"F-60907r919357_fix","satisfies":["SRG-OS-000033-GPOS-00014","SRG-OS-000120-GPOS-00061","SRG-OS-000125-GPOS-00065","SRG-OS-000250-GPOS-00093","SRG-OS-000393-GPOS-00173","SRG-OS-000394-GPOS-00174"],"documentable":null,"cci":["CCI-000068","CCI-000803","CCI-000877","CCI-001453","CCI-002890","CCI-003123"],"nist":["AC-17 (2)","IA-7","MA-4 c","AC-17 (2)","MA-4 (6)","MA-4 (6)"]}},{"id":"SV-257294","code":"control 'SV-257294' do\n  title 'The macOS system must implement approved Message Authentication Codes (MACs) within the SSH client configuration.'\n  desc 'Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n'\n  desc 'check', 'Verify the macOS system is configured to use approved SSH MACs within the SSH client configuration with the following command:\n\n/usr/bin/sudo /usr/bin/grep -ir \"macs\" /etc/ssh/ssh_config*\n\n/etc/ssh/ssh_config.d/fips_ssh_config:Macs hmac-sha2-256\n\nIf any hashes other than \"hmac-sha2-256\" are listed, or the \"macs\" keyword is missing, this is a finding.'\n  desc 'fix', 'Configure the macOS system to use approved SSH MACs by creating a plain text file in the /private/etc/ssh/ssh_config.d/ directory containing the following:\n\nMACs hmac-sha2-256\n\nThe SSH service must be restarted for changes to take effect.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60981r919359_chk'\n  tag severity: 'high'\n  tag gid: 'V-257294'\n  tag rid: 'SV-257294r919361_rule'\n  tag stig_id: 'APPL-13-000058'\n  tag gtitle: 'SRG-OS-000033-GPOS-00014'\n  tag fix_id: 'F-60908r919360_fix'\n  tag satisfies: ['SRG-OS-000033-GPOS-00014', 'SRG-OS-000120-GPOS-00061', 'SRG-OS-000125-GPOS-00065', 'SRG-OS-000250-GPOS-00093', 'SRG-OS-000393-GPOS-00173', 'SRG-OS-000394-GPOS-00175']\n  tag 'documentable'\n  tag cci: ['CCI-000068', 'CCI-000803', 'CCI-000877', 'CCI-001453', 'CCI-002890', 'CCI-003123']\n  tag nist: ['AC-17 (2)', 'IA-7', 'MA-4 c', 'AC-17 (2)', 'MA-4 (6)', 'MA-4 (6)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257294.rb"},"title":"The macOS system must implement approved Message Authentication Codes (MACs) within the SSH client configuration.","desc":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","descriptions":{"default":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","check":"Verify the macOS system is configured to use approved SSH MACs within the SSH client configuration with the following command:\n\n/usr/bin/sudo /usr/bin/grep -ir \"macs\" /etc/ssh/ssh_config*\n\n/etc/ssh/ssh_config.d/fips_ssh_config:Macs hmac-sha2-256\n\nIf any hashes other than \"hmac-sha2-256\" are listed, or the \"macs\" keyword is missing, this is a finding.","fix":"Configure the macOS system to use approved SSH MACs by creating a plain text file in the /private/etc/ssh/ssh_config.d/ directory containing the following:\n\nMACs hmac-sha2-256\n\nThe SSH service must be restarted for changes to take effect."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60981r919359_chk","severity":"high","gid":"V-257294","rid":"SV-257294r919361_rule","stig_id":"APPL-13-000058","gtitle":"SRG-OS-000033-GPOS-00014","fix_id":"F-60908r919360_fix","satisfies":["SRG-OS-000033-GPOS-00014","SRG-OS-000120-GPOS-00061","SRG-OS-000125-GPOS-00065","SRG-OS-000250-GPOS-00093","SRG-OS-000393-GPOS-00173","SRG-OS-000394-GPOS-00175"],"documentable":null,"cci":["CCI-000068","CCI-000803","CCI-000877","CCI-001453","CCI-002890","CCI-003123"],"nist":["AC-17 (2)","IA-7","MA-4 c","AC-17 (2)","MA-4 (6)","MA-4 (6)"]}},{"id":"SV-257295","code":"control 'SV-257295' do\n  title 'The macOS system must implement approved Key Exchange Algorithms within the SSH client configuration.'\n  desc 'Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n'\n  desc 'check', 'Verify the macOS system is configured to use approved SSH Key Exchange Algorithms within the SSH client configuration with the following command:\n\n/usr/bin/sudo /usr/bin/grep -ir \"kexalgorithms\" /etc/ssh/ssh_config*\n\n/etc/ssh/ssh_config.d/fips_ssh_config:KexAlgorithms ecdh-sha2-nistp256\n\nIf any algorithms other than \"ecdh-sha2-nistp256\" are listed, or the \"kexalgorithms\" keyword is missing, this is a finding.'\n  desc 'fix', 'Configure the macOS system to use approved SSH Key Exchange Algorithms by creating a plain text file in the /private/etc/ssh/ssh_config.d/ directory containing the following:\n\nKexAlgorithms ecdh-sha2-nistp256\n\nThe SSH service must be restarted for changes to take effect.'\n  impact 0.7\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-60982r919362_chk'\n  tag severity: 'high'\n  tag gid: 'V-257295'\n  tag rid: 'SV-257295r919364_rule'\n  tag stig_id: 'APPL-13-000059'\n  tag gtitle: 'SRG-OS-000033-GPOS-00014'\n  tag fix_id: 'F-60909r919363_fix'\n  tag satisfies: ['SRG-OS-000033-GPOS-00014', 'SRG-OS-000120-GPOS-00061', 'SRG-OS-000125-GPOS-00065', 'SRG-OS-000250-GPOS-00093', 'SRG-OS-000393-GPOS-00173', 'SRG-OS-000394-GPOS-00176']\n  tag 'documentable'\n  tag cci: ['CCI-000068', 'CCI-000803', 'CCI-000877', 'CCI-001453', 'CCI-002890', 'CCI-003123']\n  tag nist: ['AC-17 (2)', 'IA-7', 'MA-4 c', 'AC-17 (2)', 'MA-4 (6)', 'MA-4 (6)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257295.rb"},"title":"The macOS system must implement approved Key Exchange Algorithms within the SSH client configuration.","desc":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","descriptions":{"default":"Operating systems using encryption are required to use FIPS-compliant mechanisms for authenticating to macOS.\n\nFor OpenSSH to utilize the Apple Corecrypto FIPS-validated algorithms, a specific configuration is required to leverage the shim implemented by macOS to bypass the non-FIPS validated LibreSSL crypto module packaged with OpenSSH. Information regarding this configuration can be found in the manual page \"apple_ssh_and_fips\".\n\n","check":"Verify the macOS system is configured to use approved SSH Key Exchange Algorithms within the SSH client configuration with the following command:\n\n/usr/bin/sudo /usr/bin/grep -ir \"kexalgorithms\" /etc/ssh/ssh_config*\n\n/etc/ssh/ssh_config.d/fips_ssh_config:KexAlgorithms ecdh-sha2-nistp256\n\nIf any algorithms other than \"ecdh-sha2-nistp256\" are listed, or the \"kexalgorithms\" keyword is missing, this is a finding.","fix":"Configure the macOS system to use approved SSH Key Exchange Algorithms by creating a plain text file in the /private/etc/ssh/ssh_config.d/ directory containing the following:\n\nKexAlgorithms ecdh-sha2-nistp256\n\nThe SSH service must be restarted for changes to take effect."},"impact":0.7,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-60982r919362_chk","severity":"high","gid":"V-257295","rid":"SV-257295r919364_rule","stig_id":"APPL-13-000059","gtitle":"SRG-OS-000033-GPOS-00014","fix_id":"F-60909r919363_fix","satisfies":["SRG-OS-000033-GPOS-00014","SRG-OS-000120-GPOS-00061","SRG-OS-000125-GPOS-00065","SRG-OS-000250-GPOS-00093","SRG-OS-000393-GPOS-00173","SRG-OS-000394-GPOS-00176"],"documentable":null,"cci":["CCI-000068","CCI-000803","CCI-000877","CCI-001453","CCI-002890","CCI-003123"],"nist":["AC-17 (2)","IA-7","MA-4 c","AC-17 (2)","MA-4 (6)","MA-4 (6)"]}},{"id":"SV-257776","code":"control 'SV-257776' do\n  title 'The macOS system must prevent nonprivileged users from executing privileged functions to include disabling, circumventing, or altering implemented security safeguards/countermeasures.'\n  desc 'Preventing nonprivileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges.\n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Nonprivileged users are individuals that do not possess appropriate authorizations. Circumventing intrusion detection and prevention mechanisms or malicious code protection mechanisms are examples of privileged functions that require protection from nonprivileged users.'\n  desc 'check', 'Verify the macOS system is configured to require authentication to access all system-level preference panes with the following commands:\n\n/usr/bin/sudo /usr/bin/security authorizationdb read system.preferences | /usr/bin/grep -A1 shared\n\n<key>shared</key>\n<false/>\n\nIf the \"shared\" key is not set to \"false\", this is a finding.'\n  desc 'fix', 'Configure the macOS system to require authentication to access all system-level preference panes with the following actions:\n\nCopy the authorization database to a file:\n/usr/bin/sudo /usr/bin/security authorizationdb read system.preferences > ~/Desktop/authdb.txt\n\nEdit the \"shared\" section of the file:\n     <key>shared</key>\n    <false/>\n\nReload the authorization database:\n/usr/bin/sudo /usr/bin/security authorizationdb write system.preferences < ~/Desktop/authdb.txt'\n  impact 0.5\n  ref 'DPMS Target Apple macOS 13'\n  tag check_id: 'C-61517r922881_chk'\n  tag severity: 'medium'\n  tag gid: 'V-257776'\n  tag rid: 'SV-257776r922883_rule'\n  tag stig_id: 'APPL-13-002069'\n  tag gtitle: 'SRG-OS-000324-GPOS-00125'\n  tag fix_id: 'F-61441r922882_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002235']\n  tag nist: ['AC-6 (10)']\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Apple_macOS_13_STIG_V1R3/controls/SV-257776.rb"},"title":"The macOS system must prevent nonprivileged users from executing privileged functions to include disabling, circumventing, or altering implemented security safeguards/countermeasures.","desc":"Preventing nonprivileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges.\n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Nonprivileged users are individuals that do not possess appropriate authorizations. Circumventing intrusion detection and prevention mechanisms or malicious code protection mechanisms are examples of privileged functions that require protection from nonprivileged users.","descriptions":{"default":"Preventing nonprivileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges.\n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Nonprivileged users are individuals that do not possess appropriate authorizations. Circumventing intrusion detection and prevention mechanisms or malicious code protection mechanisms are examples of privileged functions that require protection from nonprivileged users.","check":"Verify the macOS system is configured to require authentication to access all system-level preference panes with the following commands:\n\n/usr/bin/sudo /usr/bin/security authorizationdb read system.preferences | /usr/bin/grep -A1 shared\n\n<key>shared</key>\n<false/>\n\nIf the \"shared\" key is not set to \"false\", this is a finding.","fix":"Configure the macOS system to require authentication to access all system-level preference panes with the following actions:\n\nCopy the authorization database to a file:\n/usr/bin/sudo /usr/bin/security authorizationdb read system.preferences > ~/Desktop/authdb.txt\n\nEdit the \"shared\" section of the file:\n     <key>shared</key>\n    <false/>\n\nReload the authorization database:\n/usr/bin/sudo /usr/bin/security authorizationdb write system.preferences < ~/Desktop/authdb.txt"},"impact":0.5,"refs":[{"ref":"DPMS Target Apple macOS 13"}],"tags":{"check_id":"C-61517r922881_chk","severity":"medium","gid":"V-257776","rid":"SV-257776r922883_rule","stig_id":"APPL-13-002069","gtitle":"SRG-OS-000324-GPOS-00125","fix_id":"F-61441r922882_fix","documentable":null,"cci":["CCI-002235"],"nist":["AC-6 (10)"]}}],"groups":[{"id":"controls/SV-257142.rb","title":null,"controls":["SV-257142"]},{"id":"controls/SV-257143.rb","title":null,"controls":["SV-257143"]},{"id":"controls/SV-257144.rb","title":null,"controls":["SV-257144"]},{"id":"controls/SV-257145.rb","title":null,"controls":["SV-257145"]},{"id":"controls/SV-257146.rb","title":null,"controls":["SV-257146"]},{"id":"controls/SV-257147.rb","title":null,"controls":["SV-257147"]},{"id":"controls/SV-257148.rb","title":null,"controls":["SV-257148"]},{"id":"controls/SV-257150.rb","title":null,"controls":["SV-257150"]},{"id":"controls/SV-257151.rb","title":null,"controls":["SV-257151"]},{"id":"controls/SV-257152.rb","title":null,"controls":["SV-257152"]},{"id":"controls/SV-257153.rb","title":null,"controls":["SV-257153"]},{"id":"controls/SV-257154.rb","title":null,"controls":["SV-257154"]},{"id":"controls/SV-257155.rb","title":null,"controls":["SV-257155"]},{"id":"controls/SV-257156.rb","title":null,"controls":["SV-257156"]},{"id":"controls/SV-257157.rb","title":null,"controls":["SV-257157"]},{"id":"controls/SV-257158.rb","title":null,"controls":["SV-257158"]},{"id":"controls/SV-257159.rb","title":null,"controls":["SV-257159"]},{"id":"controls/SV-257160.rb","title":null,"controls":["SV-257160"]},{"id":"controls/SV-257161.rb","title":null,"controls":["SV-257161"]},{"id":"controls/SV-257162.rb","title":null,"controls":["SV-257162"]},{"id":"controls/SV-257163.rb","title":null,"controls":["SV-257163"]},{"id":"controls/SV-257164.rb","title":null,"controls":["SV-257164"]},{"id":"controls/SV-257165.rb","title":null,"controls":["SV-257165"]},{"id":"controls/SV-257166.rb","title":null,"controls":["SV-257166"]},{"id":"controls/SV-257167.rb","title":null,"controls":["SV-257167"]},{"id":"controls/SV-257168.rb","title":null,"controls":["SV-257168"]},{"id":"controls/SV-257169.rb","title":null,"controls":["SV-257169"]},{"id":"controls/SV-257170.rb","title":null,"controls":["SV-257170"]},{"id":"controls/SV-257171.rb","title":null,"controls":["SV-257171"]},{"id":"controls/SV-257172.rb","title":null,"controls":["SV-257172"]},{"id":"controls/SV-257173.rb","title":null,"controls":["SV-257173"]},{"id":"controls/SV-257174.rb","title":null,"controls":["SV-257174"]},{"id":"controls/SV-257175.rb","title":null,"controls":["SV-257175"]},{"id":"controls/SV-257176.rb","title":null,"controls":["SV-257176"]},{"id":"controls/SV-257177.rb","title":null,"controls":["SV-257177"]},{"id":"controls/SV-257178.rb","title":null,"controls":["SV-257178"]},{"id":"controls/SV-257179.rb","title":null,"controls":["SV-257179"]},{"id":"controls/SV-257180.rb","title":null,"controls":["SV-257180"]},{"id":"controls/SV-257181.rb","title":null,"controls":["SV-257181"]},{"id":"controls/SV-257182.rb","title":null,"controls":["SV-257182"]},{"id":"controls/SV-257183.rb","title":null,"controls":["SV-257183"]},{"id":"controls/SV-257184.rb","title":null,"controls":["SV-257184"]},{"id":"controls/SV-257185.rb","title":null,"controls":["SV-257185"]},{"id":"controls/SV-257186.rb","title":null,"controls":["SV-257186"]},{"id":"controls/SV-257187.rb","title":null,"controls":["SV-257187"]},{"id":"controls/SV-257188.rb","title":null,"controls":["SV-257188"]},{"id":"controls/SV-257189.rb","title":null,"controls":["SV-257189"]},{"id":"controls/SV-257190.rb","title":null,"controls":["SV-257190"]},{"id":"controls/SV-257191.rb","title":null,"controls":["SV-257191"]},{"id":"controls/SV-257192.rb","title":null,"controls":["SV-257192"]},{"id":"controls/SV-257193.rb","title":null,"controls":["SV-257193"]},{"id":"controls/SV-257194.rb","title":null,"controls":["SV-257194"]},{"id":"controls/SV-257195.rb","title":null,"controls":["SV-257195"]},{"id":"controls/SV-257196.rb","title":null,"controls":["SV-257196"]},{"id":"controls/SV-257197.rb","title":null,"controls":["SV-257197"]},{"id":"controls/SV-257198.rb","title":null,"controls":["SV-257198"]},{"id":"controls/SV-257199.rb","title":null,"controls":["SV-257199"]},{"id":"controls/SV-257200.rb","title":null,"controls":["SV-257200"]},{"id":"controls/SV-257201.rb","title":null,"controls":["SV-257201"]},{"id":"controls/SV-257202.rb","title":null,"controls":["SV-257202"]},{"id":"controls/SV-257203.rb","title":null,"controls":["SV-257203"]},{"id":"controls/SV-257204.rb","title":null,"controls":["SV-257204"]},{"id":"controls/SV-257205.rb","title":null,"controls":["SV-257205"]},{"id":"controls/SV-257206.rb","title":null,"controls":["SV-257206"]},{"id":"controls/SV-257207.rb","title":null,"controls":["SV-257207"]},{"id":"controls/SV-257208.rb","title":null,"controls":["SV-257208"]},{"id":"controls/SV-257209.rb","title":null,"controls":["SV-257209"]},{"id":"controls/SV-257210.rb","title":null,"controls":["SV-257210"]},{"id":"controls/SV-257211.rb","title":null,"controls":["SV-257211"]},{"id":"controls/SV-257212.rb","title":null,"controls":["SV-257212"]},{"id":"controls/SV-257213.rb","title":null,"controls":["SV-257213"]},{"id":"controls/SV-257214.rb","title":null,"controls":["SV-257214"]},{"id":"controls/SV-257215.rb","title":null,"controls":["SV-257215"]},{"id":"controls/SV-257216.rb","title":null,"controls":["SV-257216"]},{"id":"controls/SV-257217.rb","title":null,"controls":["SV-257217"]},{"id":"controls/SV-257218.rb","title":null,"controls":["SV-257218"]},{"id":"controls/SV-257219.rb","title":null,"controls":["SV-257219"]},{"id":"controls/SV-257220.rb","title":null,"controls":["SV-257220"]},{"id":"controls/SV-257221.rb","title":null,"controls":["SV-257221"]},{"id":"controls/SV-257222.rb","title":null,"controls":["SV-257222"]},{"id":"controls/SV-257224.rb","title":null,"controls":["SV-257224"]},{"id":"controls/SV-257225.rb","title":null,"controls":["SV-257225"]},{"id":"controls/SV-257226.rb","title":null,"controls":["SV-257226"]},{"id":"controls/SV-257227.rb","title":null,"controls":["SV-257227"]},{"id":"controls/SV-257228.rb","title":null,"controls":["SV-257228"]},{"id":"controls/SV-257229.rb","title":null,"controls":["SV-257229"]},{"id":"controls/SV-257230.rb","title":null,"controls":["SV-257230"]},{"id":"controls/SV-257231.rb","title":null,"controls":["SV-257231"]},{"id":"controls/SV-257232.rb","title":null,"controls":["SV-257232"]},{"id":"controls/SV-257233.rb","title":null,"controls":["SV-257233"]},{"id":"controls/SV-257234.rb","title":null,"controls":["SV-257234"]},{"id":"controls/SV-257235.rb","title":null,"controls":["SV-257235"]},{"id":"controls/SV-257236.rb","title":null,"controls":["SV-257236"]},{"id":"controls/SV-257237.rb","title":null,"controls":["SV-257237"]},{"id":"controls/SV-257238.rb","title":null,"controls":["SV-257238"]},{"id":"controls/SV-257239.rb","title":null,"controls":["SV-257239"]},{"id":"controls/SV-257240.rb","title":null,"controls":["SV-257240"]},{"id":"controls/SV-257241.rb","title":null,"controls":["SV-257241"]},{"id":"controls/SV-257242.rb","title":null,"controls":["SV-257242"]},{"id":"controls/SV-257243.rb","title":null,"controls":["SV-257243"]},{"id":"controls/SV-257244.rb","title":null,"controls":["SV-257244"]},{"id":"controls/SV-257245.rb","title":null,"controls":["SV-257245"]},{"id":"controls/SV-257246.rb","title":null,"controls":["SV-257246"]},{"id":"controls/SV-257247.rb","title":null,"controls":["SV-257247"]},{"id":"controls/SV-257248.rb","title":null,"controls":["SV-257248"]},{"id":"controls/SV-257249.rb","title":null,"controls":["SV-257249"]},{"id":"controls/SV-257250.rb","title":null,"controls":["SV-257250"]},{"id":"controls/SV-257251.rb","title":null,"controls":["SV-257251"]},{"id":"controls/SV-257293.rb","title":null,"controls":["SV-257293"]},{"id":"controls/SV-257294.rb","title":null,"controls":["SV-257294"]},{"id":"controls/SV-257295.rb","title":null,"controls":["SV-257295"]},{"id":"controls/SV-257776.rb","title":null,"controls":["SV-257776"]}],"name":"Apple_macOS_13_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"c3b428b81ab5a4a0f145bde781fb8aac4484013649e2024a1ad19b4800ba1ec6","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
