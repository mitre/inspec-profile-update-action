{"controls":[{"id":"SV-253878","code":"control 'SV-253878' do\n  title 'The Juniper EX switch must be configured to limit the number of concurrent management sessions to 10 or less.'\n  desc 'Device management includes the ability to control the number of administrators and management sessions that manage a device. Limiting the number of allowed administrators and sessions per administrator based on account type, role, or access type is helpful in limiting risks related to denial of service (DoS) attacks.\n\nThis requirement addresses concurrent sessions for administrative accounts and does not address concurrent sessions by a single administrator via multiple administrative accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system. At a minimum, limits must be set for SSH, HTTPS, account of last resort, and root account sessions.\n\nJuniper switches apply session limits per access method (e.g., web management, SSH), which means the limit is applicable to local, remote, and root account sessions. Some services, like SSH and NETCONF, also support connection rate-limiting. Connection rate limiting is the number of connections per one minute interval.\n\nUnconfigured management access methods are disabled. For instance, if there is no [edit system services ssh] stanza, that service is unavailable and a connection-limit should not be configured because that will enable the service.'\n  desc 'check', 'Review the network device configuration and verify the device limits the number of concurrent management sessions to an organization-defined number for all authorized access methods.\n\nSSH example:\n[edit system services ssh]\nconnection-limit <1..10>;\nrate-limit <1..4>;\nNote: The SSH connection- and rate-limit directives affect secure file transfer protocols like SCP and SFTP.\n\nNETCONF over SSH example:\n[edit system services netconf]\nssh {\n    connection-limit <1..10>;\n    rate-limit <1..4>;\n}\nNote: Rate limiting is the permissible number of connections per one minute interval.\n\nIf the network device does not limit the number of concurrent management sessions to an organization-defined number, this is a finding.'\n  desc 'fix', 'Limit the number of concurrent management sessions to 10.\n\nSSH example:\nset system services ssh connection-limit 10\nset system services ssh rate-limit <1..4>\n\nNETCONF over SSH example:\nset system services netconf ssh connection-limit <1..10>\nset system services netconf ssh rate-limit <1..4>'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57330r843665_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253878'\n  tag rid: 'SV-253878r879511_rule'\n  tag stig_id: 'JUEX-NM-000010'\n  tag gtitle: 'SRG-APP-000001-NDM-000200'\n  tag fix_id: 'F-57281r843666_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253878.rb"},"title":"The Juniper EX switch must be configured to limit the number of concurrent management sessions to 10 or less.","desc":"Device management includes the ability to control the number of administrators and management sessions that manage a device. Limiting the number of allowed administrators and sessions per administrator based on account type, role, or access type is helpful in limiting risks related to denial of service (DoS) attacks.\n\nThis requirement addresses concurrent sessions for administrative accounts and does not address concurrent sessions by a single administrator via multiple administrative accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system. At a minimum, limits must be set for SSH, HTTPS, account of last resort, and root account sessions.\n\nJuniper switches apply session limits per access method (e.g., web management, SSH), which means the limit is applicable to local, remote, and root account sessions. Some services, like SSH and NETCONF, also support connection rate-limiting. Connection rate limiting is the number of connections per one minute interval.\n\nUnconfigured management access methods are disabled. For instance, if there is no [edit system services ssh] stanza, that service is unavailable and a connection-limit should not be configured because that will enable the service.","descriptions":{"default":"Device management includes the ability to control the number of administrators and management sessions that manage a device. Limiting the number of allowed administrators and sessions per administrator based on account type, role, or access type is helpful in limiting risks related to denial of service (DoS) attacks.\n\nThis requirement addresses concurrent sessions for administrative accounts and does not address concurrent sessions by a single administrator via multiple administrative accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system. At a minimum, limits must be set for SSH, HTTPS, account of last resort, and root account sessions.\n\nJuniper switches apply session limits per access method (e.g., web management, SSH), which means the limit is applicable to local, remote, and root account sessions. Some services, like SSH and NETCONF, also support connection rate-limiting. Connection rate limiting is the number of connections per one minute interval.\n\nUnconfigured management access methods are disabled. For instance, if there is no [edit system services ssh] stanza, that service is unavailable and a connection-limit should not be configured because that will enable the service.","check":"Review the network device configuration and verify the device limits the number of concurrent management sessions to an organization-defined number for all authorized access methods.\n\nSSH example:\n[edit system services ssh]\nconnection-limit <1..10>;\nrate-limit <1..4>;\nNote: The SSH connection- and rate-limit directives affect secure file transfer protocols like SCP and SFTP.\n\nNETCONF over SSH example:\n[edit system services netconf]\nssh {\n    connection-limit <1..10>;\n    rate-limit <1..4>;\n}\nNote: Rate limiting is the permissible number of connections per one minute interval.\n\nIf the network device does not limit the number of concurrent management sessions to an organization-defined number, this is a finding.","fix":"Limit the number of concurrent management sessions to 10.\n\nSSH example:\nset system services ssh connection-limit 10\nset system services ssh rate-limit <1..4>\n\nNETCONF over SSH example:\nset system services netconf ssh connection-limit <1..10>\nset system services netconf ssh rate-limit <1..4>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57330r843665_chk","severity":"medium","gid":"V-253878","rid":"SV-253878r879511_rule","stig_id":"JUEX-NM-000010","gtitle":"SRG-APP-000001-NDM-000200","fix_id":"F-57281r843666_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-253879","code":"control 'SV-253879' do\n  title 'The Juniper EX switch must be configured to automatically audit account creation.'\n  desc 'Upon gaining access to a network device, an attacker will often first attempt to create a persistent method of reestablishing access. One way to accomplish this is to create a new account. Notification of account creation helps to mitigate this risk. Auditing account creation provides the necessary reconciliation that account management procedures are being followed. Without this audit trail, personnel without the proper authorization may gain access to critical network nodes.'\n  desc 'check', 'Review the network device configuration to determine if it automatically audits account creation or is configured to use an authentication server that would perform this function.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (e.g., \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf account creation is not automatically audited, this is a finding.'\n  desc 'fix', 'Configure the network device or its associated authentication server to automatically audit the creation of accounts.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57331r843668_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253879'\n  tag rid: 'SV-253879r879525_rule'\n  tag stig_id: 'JUEX-NM-000020'\n  tag gtitle: 'SRG-APP-000026-NDM-000208'\n  tag fix_id: 'F-57282r843669_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000018']\n  tag nist: ['AC-2 (4)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253879.rb"},"title":"The Juniper EX switch must be configured to automatically audit account creation.","desc":"Upon gaining access to a network device, an attacker will often first attempt to create a persistent method of reestablishing access. One way to accomplish this is to create a new account. Notification of account creation helps to mitigate this risk. Auditing account creation provides the necessary reconciliation that account management procedures are being followed. Without this audit trail, personnel without the proper authorization may gain access to critical network nodes.","descriptions":{"default":"Upon gaining access to a network device, an attacker will often first attempt to create a persistent method of reestablishing access. One way to accomplish this is to create a new account. Notification of account creation helps to mitigate this risk. Auditing account creation provides the necessary reconciliation that account management procedures are being followed. Without this audit trail, personnel without the proper authorization may gain access to critical network nodes.","check":"Review the network device configuration to determine if it automatically audits account creation or is configured to use an authentication server that would perform this function.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (e.g., \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf account creation is not automatically audited, this is a finding.","fix":"Configure the network device or its associated authentication server to automatically audit the creation of accounts.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57331r843668_chk","severity":"medium","gid":"V-253879","rid":"SV-253879r879525_rule","stig_id":"JUEX-NM-000020","gtitle":"SRG-APP-000026-NDM-000208","fix_id":"F-57282r843669_fix","documentable":null,"cci":["CCI-000018"],"nist":["AC-2 (4)"]}},{"id":"SV-253880","code":"control 'SV-253880' do\n  title 'The Juniper EX switch must be configured to automatically audit account modification.'\n  desc 'Because the accounts in the network device are privileged, or system-level accounts, account management is vital to the security of the network device. Account management by a designated authority ensures access to the network device is being controlled in a secure manner by only granting access to authorized personnel with the appropriate and necessary privileges.\n\nAuditing account modification along with an automatic notification to appropriate individuals will provide the necessary reconciliation that account management procedures are being followed. If modifications to management accounts are not audited, reconciliation of account management procedures cannot be tracked.'\n  desc 'check', 'Verify the network device automatically audits account modification actions. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (e.g., \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf account modification is not automatically audited, this is a finding.'\n  desc 'fix', 'Configure the network device or its associated authentication server to automatically audit the modification of accounts.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57332r843671_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253880'\n  tag rid: 'SV-253880r879526_rule'\n  tag stig_id: 'JUEX-NM-000030'\n  tag gtitle: 'SRG-APP-000027-NDM-000209'\n  tag fix_id: 'F-57283r843672_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001403']\n  tag nist: ['AC-2 (4)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253880.rb"},"title":"The Juniper EX switch must be configured to automatically audit account modification.","desc":"Because the accounts in the network device are privileged, or system-level accounts, account management is vital to the security of the network device. Account management by a designated authority ensures access to the network device is being controlled in a secure manner by only granting access to authorized personnel with the appropriate and necessary privileges.\n\nAuditing account modification along with an automatic notification to appropriate individuals will provide the necessary reconciliation that account management procedures are being followed. If modifications to management accounts are not audited, reconciliation of account management procedures cannot be tracked.","descriptions":{"default":"Because the accounts in the network device are privileged, or system-level accounts, account management is vital to the security of the network device. Account management by a designated authority ensures access to the network device is being controlled in a secure manner by only granting access to authorized personnel with the appropriate and necessary privileges.\n\nAuditing account modification along with an automatic notification to appropriate individuals will provide the necessary reconciliation that account management procedures are being followed. If modifications to management accounts are not audited, reconciliation of account management procedures cannot be tracked.","check":"Verify the network device automatically audits account modification actions. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (e.g., \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf account modification is not automatically audited, this is a finding.","fix":"Configure the network device or its associated authentication server to automatically audit the modification of accounts.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57332r843671_chk","severity":"medium","gid":"V-253880","rid":"SV-253880r879526_rule","stig_id":"JUEX-NM-000030","gtitle":"SRG-APP-000027-NDM-000209","fix_id":"F-57283r843672_fix","documentable":null,"cci":["CCI-001403"],"nist":["AC-2 (4)"]}},{"id":"SV-253881","code":"control 'SV-253881' do\n  title 'The Juniper EX switch must be configured to automatically audit account disabling actions.'\n  desc 'Account management, as a whole, ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel. Auditing account disabling actions will support account management procedures. When device management accounts are disabled, user or service accessibility may be affected. Auditing also ensures authorized active accounts remain enabled and available for use when required.'\n  desc 'check', 'Check the network device to determine if account disabling actions are automatically audited. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (e.g., \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf account disabling actions are not audited, this is a finding.'\n  desc 'fix', 'Configure the network device or its associated authentication server to automatically audit the disabling of accounts.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57333r844933_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253881'\n  tag rid: 'SV-253881r879527_rule'\n  tag stig_id: 'JUEX-NM-000040'\n  tag gtitle: 'SRG-APP-000028-NDM-000210'\n  tag fix_id: 'F-57284r843675_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001404']\n  tag nist: ['AC-2 (4)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253881.rb"},"title":"The Juniper EX switch must be configured to automatically audit account disabling actions.","desc":"Account management, as a whole, ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel. Auditing account disabling actions will support account management procedures. When device management accounts are disabled, user or service accessibility may be affected. Auditing also ensures authorized active accounts remain enabled and available for use when required.","descriptions":{"default":"Account management, as a whole, ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel. Auditing account disabling actions will support account management procedures. When device management accounts are disabled, user or service accessibility may be affected. Auditing also ensures authorized active accounts remain enabled and available for use when required.","check":"Check the network device to determine if account disabling actions are automatically audited. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (e.g., \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf account disabling actions are not audited, this is a finding.","fix":"Configure the network device or its associated authentication server to automatically audit the disabling of accounts.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57333r844933_chk","severity":"medium","gid":"V-253881","rid":"SV-253881r879527_rule","stig_id":"JUEX-NM-000040","gtitle":"SRG-APP-000028-NDM-000210","fix_id":"F-57284r843675_fix","documentable":null,"cci":["CCI-001404"],"nist":["AC-2 (4)"]}},{"id":"SV-253882","code":"control 'SV-253882' do\n  title 'The Juniper EX switch must be configured to automatically audit account removal actions.'\n  desc 'Account management, as a whole, ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel. Auditing account removal actions will support account management procedures. When device management accounts are terminated, user or service accessibility may be affected. Auditing also ensures authorized active accounts remain enabled and available for use when required.'\n  desc 'check', %q(Check the network device to determine if account removal actions are automatically audited. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example 'authorizations' or 'firewall').\n\nSyslog outputs in standard format unless the 'structured-data' directive is configured. Verify the 'structured-data' command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf account removal actions are not automatically audited, this is a finding.)\n  desc 'fix', 'Configure the network device or its associated authentication server to automatically audit the removal of accounts.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57334r843677_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253882'\n  tag rid: 'SV-253882r879528_rule'\n  tag stig_id: 'JUEX-NM-000050'\n  tag gtitle: 'SRG-APP-000029-NDM-000211'\n  tag fix_id: 'F-57285r843678_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001405']\n  tag nist: ['AC-2 (4)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253882.rb"},"title":"The Juniper EX switch must be configured to automatically audit account removal actions.","desc":"Account management, as a whole, ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel. Auditing account removal actions will support account management procedures. When device management accounts are terminated, user or service accessibility may be affected. Auditing also ensures authorized active accounts remain enabled and available for use when required.","descriptions":{"default":"Account management, as a whole, ensures access to the network device is being controlled in a secure manner by granting access to only authorized personnel. Auditing account removal actions will support account management procedures. When device management accounts are terminated, user or service accessibility may be affected. Auditing also ensures authorized active accounts remain enabled and available for use when required.","check":"Check the network device to determine if account removal actions are automatically audited. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example 'authorizations' or 'firewall').\n\nSyslog outputs in standard format unless the 'structured-data' directive is configured. Verify the 'structured-data' command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf account removal actions are not automatically audited, this is a finding.","fix":"Configure the network device or its associated authentication server to automatically audit the removal of accounts.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57334r843677_chk","severity":"medium","gid":"V-253882","rid":"SV-253882r879528_rule","stig_id":"JUEX-NM-000050","gtitle":"SRG-APP-000029-NDM-000211","fix_id":"F-57285r843678_fix","documentable":null,"cci":["CCI-001405"],"nist":["AC-2 (4)"]}},{"id":"SV-253883","code":"control 'SV-253883' do\n  title 'The Juniper EX switch must be configured to assign appropriate user roles or access levels to authenticated users.'\n  desc 'Successful identification and authentication must not automatically give an entity full access to a network device or security domain. The lack of authorization-based access control could result in the immediate compromise and unauthorized access to sensitive information. All DoD systems must be properly configured to incorporate access control methods that do not rely solely on authentication for authorized access.\n\nAuthorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset or set of resources. Information systems use access control policies and enforcement mechanisms to implement this requirement. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization.\n\nSome network devices are pre-configured with security groups. Other network devices enable operators to create custom security groups with custom permissions. For example, an ISSM may require read-only access to audit the network device. Operators may create an audit security group, define permissions and access levels for members of the group, and then assign the ISSM’s user persona to the audit security group. This is still considered privileged access, but the ISSM’s security group is more restrictive than the network administrator’s security group.\n\nNetwork devices that rely on AAA brokers for authentication and authorization services may need to identify the available security groups or access levels available on the network devices and convey that information to the AAA operator. Once the AAA broker identifies the user persona on the centralized directory service, the user’s security group memberships can be retrieved. The AAA operator may need to create a mapping that links target security groups from the directory service to the appropriate security groups or access levels on the network device. Once these mappings are configured, authorizations can happen dynamically, based on each user’s directory service group membership.'\n  desc 'check', 'If the network device is configured to use a AAA service account, and the AAA broker is configured to assign authorization levels based on centralized user account group memberships on behalf of the network device, that will satisfy this objective. Because the responsibility for meeting this objective is transferred to the AAA broker, this requirement is not applicable for the local network device. This requirement may be verified by demonstration or configuration review.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and/or  local authentication depending upon the authentication order. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives, or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nVerify the network device is configured to assign appropriate user roles or access levels to authenticated users. This requirement may be verified by demonstration or configuration review. If the network device does not enforce the assigned privilege level for each administrator and authorizations for access to all commands relative to the privilege level, this is a finding.'\n  desc 'fix', \"Configure the network device to assign appropriate user roles or access levels to authenticated users, or configure the network device to leverage an AAA solution that will satisfy this objective.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\"\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57335r843680_chk'\n  tag severity: 'high'\n  tag gid: 'V-253883'\n  tag rid: 'SV-253883r879530_rule'\n  tag stig_id: 'JUEX-NM-000060'\n  tag gtitle: 'SRG-APP-000033-NDM-000212'\n  tag fix_id: 'F-57286r843681_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000213']\n  tag nist: ['AC-3']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253883.rb"},"title":"The Juniper EX switch must be configured to assign appropriate user roles or access levels to authenticated users.","desc":"Successful identification and authentication must not automatically give an entity full access to a network device or security domain. The lack of authorization-based access control could result in the immediate compromise and unauthorized access to sensitive information. All DoD systems must be properly configured to incorporate access control methods that do not rely solely on authentication for authorized access.\n\nAuthorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset or set of resources. Information systems use access control policies and enforcement mechanisms to implement this requirement. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization.\n\nSome network devices are pre-configured with security groups. Other network devices enable operators to create custom security groups with custom permissions. For example, an ISSM may require read-only access to audit the network device. Operators may create an audit security group, define permissions and access levels for members of the group, and then assign the ISSM’s user persona to the audit security group. This is still considered privileged access, but the ISSM’s security group is more restrictive than the network administrator’s security group.\n\nNetwork devices that rely on AAA brokers for authentication and authorization services may need to identify the available security groups or access levels available on the network devices and convey that information to the AAA operator. Once the AAA broker identifies the user persona on the centralized directory service, the user’s security group memberships can be retrieved. The AAA operator may need to create a mapping that links target security groups from the directory service to the appropriate security groups or access levels on the network device. Once these mappings are configured, authorizations can happen dynamically, based on each user’s directory service group membership.","descriptions":{"default":"Successful identification and authentication must not automatically give an entity full access to a network device or security domain. The lack of authorization-based access control could result in the immediate compromise and unauthorized access to sensitive information. All DoD systems must be properly configured to incorporate access control methods that do not rely solely on authentication for authorized access.\n\nAuthorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset or set of resources. Information systems use access control policies and enforcement mechanisms to implement this requirement. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization.\n\nSome network devices are pre-configured with security groups. Other network devices enable operators to create custom security groups with custom permissions. For example, an ISSM may require read-only access to audit the network device. Operators may create an audit security group, define permissions and access levels for members of the group, and then assign the ISSM’s user persona to the audit security group. This is still considered privileged access, but the ISSM’s security group is more restrictive than the network administrator’s security group.\n\nNetwork devices that rely on AAA brokers for authentication and authorization services may need to identify the available security groups or access levels available on the network devices and convey that information to the AAA operator. Once the AAA broker identifies the user persona on the centralized directory service, the user’s security group memberships can be retrieved. The AAA operator may need to create a mapping that links target security groups from the directory service to the appropriate security groups or access levels on the network device. Once these mappings are configured, authorizations can happen dynamically, based on each user’s directory service group membership.","check":"If the network device is configured to use a AAA service account, and the AAA broker is configured to assign authorization levels based on centralized user account group memberships on behalf of the network device, that will satisfy this objective. Because the responsibility for meeting this objective is transferred to the AAA broker, this requirement is not applicable for the local network device. This requirement may be verified by demonstration or configuration review.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and/or  local authentication depending upon the authentication order. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives, or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nVerify the network device is configured to assign appropriate user roles or access levels to authenticated users. This requirement may be verified by demonstration or configuration review. If the network device does not enforce the assigned privilege level for each administrator and authorizations for access to all commands relative to the privilege level, this is a finding.","fix":"Configure the network device to assign appropriate user roles or access levels to authenticated users, or configure the network device to leverage an AAA solution that will satisfy this objective.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>"},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57335r843680_chk","severity":"high","gid":"V-253883","rid":"SV-253883r879530_rule","stig_id":"JUEX-NM-000060","gtitle":"SRG-APP-000033-NDM-000212","fix_id":"F-57286r843681_fix","documentable":null,"cci":["CCI-000213"],"nist":["AC-3"]}},{"id":"SV-253884","code":"control 'SV-253884' do\n  title 'The Juniper EX switch must be configured to enforce approved authorizations for controlling the flow of management information within the network device based on information flow control policies.'\n  desc 'A mechanism to detect and prevent unauthorized communication flow must be configured or provided as part of the system design. If management information flow is not enforced based on approved authorizations, the network device may become compromised. Information flow control regulates where management information is allowed to travel within a network device. The flow of all management information must be monitored and controlled so it does not introduce any unacceptable risk to the network device or data. \n\nApplication-specific examples of enforcement occur in systems that employ rule sets or establish configuration settings that restrict information system services or message-filtering capability based on message content (e.g., implementing key word searches or using document characteristics).\n\nApplications providing information flow control must be able to enforce approved authorizations for controlling the flow of management information within the system in accordance with applicable policy.'\n  desc 'check', \"Review the network device configuration to determine if it enforces approved authorizations for controlling the flow of management information within the network device based on information flow control policies.\n\nVerify the switch permits administrative access only from the authorized management network(s). Verify filters and terms account for all authorized management traffic.\n\nExample prefix-list defining the management networks. Prefix lists are not required because IP addresses can be directly embedded into terms, but they define a set of IP addresses once that permits use across multiple terms.\n[edit policy-options]\nprefix-list ipv4-management {\n    <IPv4 MGT subnet/mask>;\n}\nprefix-list ipv6-management {\n    <IPv6 MGT subnet/prefix>;\n}\n\nExample firewall filter for SSH traffic:\n[edit firewall]\nfamily inet {\n    filter permit-management-ipv4 {\n        term 1 {\n            from {\n                destination-address {\n                   <OOBM IPv4 address>;\n                }\n                source-address {  << Example embedded addresses using the 'source-address' match criterion\n                     <IPv4 MGT subnet/mask>;\n                }\n                --or--\n                source-prefix-list { << Example inherited addresses using the 'source-prefix-list' match criterion\n                    ipv4-management;\n                }\n                protocol tcp;\n                destination-port 22;\n            }\n            then {\n                syslog;\n                accept;\n            }\n        }\n        term 2 {\n            then {\n                syslog;\n                discard;\n            }\n        }\n    }\n}\nfamily inet6 {\n    filter permit-management-ipv6 {\n        term 1 {\n            from {\n                destination-address {\n                   <OOBM IPv6 address>;\n                }\n                source-address {  << Example embedded addresses using the 'source-address' match criterion\n                     <IPv6 MGT subnet/prefix>;\n                }\n                --or--\n                source-prefix-list { << Example inherited addresses using the 'source-prefix-list' match criterion\n                    ipv6-management;\n                }\n                next-header tcp;\n                destination-port 22;\n            }\n            then {\n                syslog;\n                accept;\n            }\n        }\n        term 2 {\n            then {\n                syslog;\n                discard;\n            }\n        }\n    }\n}\nNote: Additional terms will be required for other services like SNMP, RADIUS, or syslog.\n\nExample firewall filter applied to the OOBM interface. Juniper devices use different OOBM interface names depending upon platform (fxp0 used in the example):\n[edit interfaces]\nfxp0 {\n    unit 0 {\n        family inet {\n            filter {\n                input permit-management-ipv4;\n            }\n            address  <OOBM IPv4 address>/<mask>;\n        }\n        family inet6 {\n            filter {\n                input permit-management-ipv6;\n            }\n            address  <OOBM IPv6 address>/<prefix>;\n        }\n    }\n}\nNote: Although the example filter is shown applied to the management interface, the filter can also be applied to the loopback interface (lo0). If applying to loopback, ensure the filter terms account for all traffic, services, and protocols that must reach the routing engine (e.g., OSPF, BGP, SNMP, etc.).\n\nIf the switch does not enforce approved authorizations for controlling the flow of management information within the device based on information control policies, this is a finding.\"\n  desc 'fix', 'Configure the network device to enforce approved authorizations for controlling the flow of management information within the network device based on information flow control policies.\n\nExample MGT networks:\nset policy-options prefix-list ipv4-management <IPv4 MGT subnet/mask>\nset policy-options prefix-list ipv6-management <IPv6 MGT subnet/prefix>\n\nExample firewall filters:\nset firewall family inet filter permit-management-ipv4 term 1 from destination-address  <OOBM IPv4 address>\nset firewall family inet filter permit-management-ipv4 term 1 from source-prefix-list ipv4-management\nset firewall family inet filter permit-management-ipv4 term 1 from protocol tcp\nset firewall family inet filter permit-management-ipv4 term 1 from destination-port 22\nset firewall family inet filter permit-management-ipv4 term 1 then syslog\nset firewall family inet filter permit-management-ipv4 term 1 then accept\nset firewall family inet filter permit-management-ipv4 term 2 then syslog\nset firewall family inet filter permit-management-ipv4 term 2 then discard\nset firewall family inet6 filter permit-management-ipv6 term 1 from destination-address  <OOBM IPv6 address>\nset firewall family inet6 filter permit-management-ipv6 term 1 from source-prefix-list ipv6-management\nset firewall family inet6 filter permit-management-ipv6 term 1 from next-header tcp\nset firewall family inet6 filter permit-management-ipv6 term 1 from destination-port 22\nset firewall family inet6 filter permit-management-ipv6 term 1 then syslog\nset firewall family inet6 filter permit-management-ipv6 term 1 then accept\nset firewall family inet6 filter permit-management-ipv6 term 2 then syslog\nset firewall family inet6 filter permit-management-ipv6 term 2 then discard\n\nExample interface configuration:\nset interfaces fxp0 unit 0 family inet filter input permit-management-ipv4\nset interfaces fxp0 unit 0 family inet address  <OOBM IPv4 address>/<mask>\nset interfaces fxp0 unit 0 family inet6 filter input permit-management-ipv6\nset interfaces fxp0 unit 0 family inet6 address  <OOBM IPv6 address>/<prefix>'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57336r843683_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253884'\n  tag rid: 'SV-253884r879533_rule'\n  tag stig_id: 'JUEX-NM-000070'\n  tag gtitle: 'SRG-APP-000038-NDM-000213'\n  tag fix_id: 'F-57287r843684_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001368']\n  tag nist: ['AC-4']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253884.rb"},"title":"The Juniper EX switch must be configured to enforce approved authorizations for controlling the flow of management information within the network device based on information flow control policies.","desc":"A mechanism to detect and prevent unauthorized communication flow must be configured or provided as part of the system design. If management information flow is not enforced based on approved authorizations, the network device may become compromised. Information flow control regulates where management information is allowed to travel within a network device. The flow of all management information must be monitored and controlled so it does not introduce any unacceptable risk to the network device or data. \n\nApplication-specific examples of enforcement occur in systems that employ rule sets or establish configuration settings that restrict information system services or message-filtering capability based on message content (e.g., implementing key word searches or using document characteristics).\n\nApplications providing information flow control must be able to enforce approved authorizations for controlling the flow of management information within the system in accordance with applicable policy.","descriptions":{"default":"A mechanism to detect and prevent unauthorized communication flow must be configured or provided as part of the system design. If management information flow is not enforced based on approved authorizations, the network device may become compromised. Information flow control regulates where management information is allowed to travel within a network device. The flow of all management information must be monitored and controlled so it does not introduce any unacceptable risk to the network device or data. \n\nApplication-specific examples of enforcement occur in systems that employ rule sets or establish configuration settings that restrict information system services or message-filtering capability based on message content (e.g., implementing key word searches or using document characteristics).\n\nApplications providing information flow control must be able to enforce approved authorizations for controlling the flow of management information within the system in accordance with applicable policy.","check":"Review the network device configuration to determine if it enforces approved authorizations for controlling the flow of management information within the network device based on information flow control policies.\n\nVerify the switch permits administrative access only from the authorized management network(s). Verify filters and terms account for all authorized management traffic.\n\nExample prefix-list defining the management networks. Prefix lists are not required because IP addresses can be directly embedded into terms, but they define a set of IP addresses once that permits use across multiple terms.\n[edit policy-options]\nprefix-list ipv4-management {\n    <IPv4 MGT subnet/mask>;\n}\nprefix-list ipv6-management {\n    <IPv6 MGT subnet/prefix>;\n}\n\nExample firewall filter for SSH traffic:\n[edit firewall]\nfamily inet {\n    filter permit-management-ipv4 {\n        term 1 {\n            from {\n                destination-address {\n                   <OOBM IPv4 address>;\n                }\n                source-address {  << Example embedded addresses using the 'source-address' match criterion\n                     <IPv4 MGT subnet/mask>;\n                }\n                --or--\n                source-prefix-list { << Example inherited addresses using the 'source-prefix-list' match criterion\n                    ipv4-management;\n                }\n                protocol tcp;\n                destination-port 22;\n            }\n            then {\n                syslog;\n                accept;\n            }\n        }\n        term 2 {\n            then {\n                syslog;\n                discard;\n            }\n        }\n    }\n}\nfamily inet6 {\n    filter permit-management-ipv6 {\n        term 1 {\n            from {\n                destination-address {\n                   <OOBM IPv6 address>;\n                }\n                source-address {  << Example embedded addresses using the 'source-address' match criterion\n                     <IPv6 MGT subnet/prefix>;\n                }\n                --or--\n                source-prefix-list { << Example inherited addresses using the 'source-prefix-list' match criterion\n                    ipv6-management;\n                }\n                next-header tcp;\n                destination-port 22;\n            }\n            then {\n                syslog;\n                accept;\n            }\n        }\n        term 2 {\n            then {\n                syslog;\n                discard;\n            }\n        }\n    }\n}\nNote: Additional terms will be required for other services like SNMP, RADIUS, or syslog.\n\nExample firewall filter applied to the OOBM interface. Juniper devices use different OOBM interface names depending upon platform (fxp0 used in the example):\n[edit interfaces]\nfxp0 {\n    unit 0 {\n        family inet {\n            filter {\n                input permit-management-ipv4;\n            }\n            address  <OOBM IPv4 address>/<mask>;\n        }\n        family inet6 {\n            filter {\n                input permit-management-ipv6;\n            }\n            address  <OOBM IPv6 address>/<prefix>;\n        }\n    }\n}\nNote: Although the example filter is shown applied to the management interface, the filter can also be applied to the loopback interface (lo0). If applying to loopback, ensure the filter terms account for all traffic, services, and protocols that must reach the routing engine (e.g., OSPF, BGP, SNMP, etc.).\n\nIf the switch does not enforce approved authorizations for controlling the flow of management information within the device based on information control policies, this is a finding.","fix":"Configure the network device to enforce approved authorizations for controlling the flow of management information within the network device based on information flow control policies.\n\nExample MGT networks:\nset policy-options prefix-list ipv4-management <IPv4 MGT subnet/mask>\nset policy-options prefix-list ipv6-management <IPv6 MGT subnet/prefix>\n\nExample firewall filters:\nset firewall family inet filter permit-management-ipv4 term 1 from destination-address  <OOBM IPv4 address>\nset firewall family inet filter permit-management-ipv4 term 1 from source-prefix-list ipv4-management\nset firewall family inet filter permit-management-ipv4 term 1 from protocol tcp\nset firewall family inet filter permit-management-ipv4 term 1 from destination-port 22\nset firewall family inet filter permit-management-ipv4 term 1 then syslog\nset firewall family inet filter permit-management-ipv4 term 1 then accept\nset firewall family inet filter permit-management-ipv4 term 2 then syslog\nset firewall family inet filter permit-management-ipv4 term 2 then discard\nset firewall family inet6 filter permit-management-ipv6 term 1 from destination-address  <OOBM IPv6 address>\nset firewall family inet6 filter permit-management-ipv6 term 1 from source-prefix-list ipv6-management\nset firewall family inet6 filter permit-management-ipv6 term 1 from next-header tcp\nset firewall family inet6 filter permit-management-ipv6 term 1 from destination-port 22\nset firewall family inet6 filter permit-management-ipv6 term 1 then syslog\nset firewall family inet6 filter permit-management-ipv6 term 1 then accept\nset firewall family inet6 filter permit-management-ipv6 term 2 then syslog\nset firewall family inet6 filter permit-management-ipv6 term 2 then discard\n\nExample interface configuration:\nset interfaces fxp0 unit 0 family inet filter input permit-management-ipv4\nset interfaces fxp0 unit 0 family inet address  <OOBM IPv4 address>/<mask>\nset interfaces fxp0 unit 0 family inet6 filter input permit-management-ipv6\nset interfaces fxp0 unit 0 family inet6 address  <OOBM IPv6 address>/<prefix>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57336r843683_chk","severity":"medium","gid":"V-253884","rid":"SV-253884r879533_rule","stig_id":"JUEX-NM-000070","gtitle":"SRG-APP-000038-NDM-000213","fix_id":"F-57287r843684_fix","documentable":null,"cci":["CCI-001368"],"nist":["AC-4"]}},{"id":"SV-253885","code":"control 'SV-253885' do\n  title 'The Juniper EX switch must be configured to enforce the limit of three consecutive invalid logon attempts for any given user, after which time it must block any login attempt for that user for 15 minutes.'\n  desc 'By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Introducing a lockout period significantly increases the time required for each brute-force attack and increases the likelihood that security personnel will identify (and can respond to) an ongoing attack and/or that the authorized owner will recognize and report the unauthorized activity.'\n  desc 'check', 'Juniper switches maintain the number of failed login attempts per user until the session is restarted or, if lockout-period is configured, until the next successful login. If the permissible number of failed login attempts is reached, the switch prevents logging in for the duration of the lockout-period (1..43200 minutes) regardless whether the account is locally or externally authenticated and across all management access methods (e.g., local console and SSH).\n\nReview the device configuration to verify that it enforces the limit of three consecutive invalid logon attempts before introducing a 15 minute lockout period.\n\n[edit system login]\nretry-options {\n    tries-before-disconnect 3;\n    lockout-period 15;\n}\n\nIf the device is not configured to enforce the limit of three consecutive invalid logon attempts before introducing a 15-minute block on subsequent login attempts, this is a finding.'\n  desc 'fix', 'Configure the network device to enforce the limit of three consecutive invalid logon attempts and to block subsequent login attempts for 15 minutes.\n\nset system login retry-options tries-before-disconnect 3\nset system login retry-options lockout-period 15'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57337r844934_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253885'\n  tag rid: 'SV-253885r879546_rule'\n  tag stig_id: 'JUEX-NM-000080'\n  tag gtitle: 'SRG-APP-000065-NDM-000214'\n  tag fix_id: 'F-57288r843687_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000044']\n  tag nist: ['AC-7 a']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253885.rb"},"title":"The Juniper EX switch must be configured to enforce the limit of three consecutive invalid logon attempts for any given user, after which time it must block any login attempt for that user for 15 minutes.","desc":"By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Introducing a lockout period significantly increases the time required for each brute-force attack and increases the likelihood that security personnel will identify (and can respond to) an ongoing attack and/or that the authorized owner will recognize and report the unauthorized activity.","descriptions":{"default":"By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Introducing a lockout period significantly increases the time required for each brute-force attack and increases the likelihood that security personnel will identify (and can respond to) an ongoing attack and/or that the authorized owner will recognize and report the unauthorized activity.","check":"Juniper switches maintain the number of failed login attempts per user until the session is restarted or, if lockout-period is configured, until the next successful login. If the permissible number of failed login attempts is reached, the switch prevents logging in for the duration of the lockout-period (1..43200 minutes) regardless whether the account is locally or externally authenticated and across all management access methods (e.g., local console and SSH).\n\nReview the device configuration to verify that it enforces the limit of three consecutive invalid logon attempts before introducing a 15 minute lockout period.\n\n[edit system login]\nretry-options {\n    tries-before-disconnect 3;\n    lockout-period 15;\n}\n\nIf the device is not configured to enforce the limit of three consecutive invalid logon attempts before introducing a 15-minute block on subsequent login attempts, this is a finding.","fix":"Configure the network device to enforce the limit of three consecutive invalid logon attempts and to block subsequent login attempts for 15 minutes.\n\nset system login retry-options tries-before-disconnect 3\nset system login retry-options lockout-period 15"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57337r844934_chk","severity":"medium","gid":"V-253885","rid":"SV-253885r879546_rule","stig_id":"JUEX-NM-000080","gtitle":"SRG-APP-000065-NDM-000214","fix_id":"F-57288r843687_fix","documentable":null,"cci":["CCI-000044"],"nist":["AC-7 a"]}},{"id":"SV-253886","code":"control 'SV-253886' do\n  title 'The Juniper EX switch must be configured to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device.'\n  desc 'Display of the DoD-approved use notification before granting access to the network device ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users.'\n  desc 'check', %q(Determine if the network device is configured to present a DoD-approved banner that is formatted in accordance with DTM-08-060. Use the following verbiage for applications that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\"I've read & consent to terms in IS user agreem't.\"\n\nVerify the appropriate banner is configured.\n[edit system login]\nmessage \"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n\\n-At any time, the USG may inspect and seize data stored on this IS.\\n\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.-This IS includes security measures (e.g., authentication and access controls) to protect USG interests-not for your personal benefit or privacy.\\n\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or mooring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\\n\";\n\nIf such a banner is not presented, this is a finding.)\n  desc 'fix', 'Configure the network device to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device.\n\nSet system login message:\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\\\\n\\\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\\\n\\\\n-At any time, the USG may inspect and seize data stored on this IS.\\\\n\\\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.-This IS includes security measures (e.g., authentication and access controls) to protect USG interests-not for your personal benefit or privacy.\\\\n\\\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or mooring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\\\\n\"'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57338r843689_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253886'\n  tag rid: 'SV-253886r879547_rule'\n  tag stig_id: 'JUEX-NM-000090'\n  tag gtitle: 'SRG-APP-000068-NDM-000215'\n  tag fix_id: 'F-57289r843690_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000048']\n  tag nist: ['AC-8 a']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253886.rb"},"title":"The Juniper EX switch must be configured to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device.","desc":"Display of the DoD-approved use notification before granting access to the network device ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users.","descriptions":{"default":"Display of the DoD-approved use notification before granting access to the network device ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users.","check":"Determine if the network device is configured to present a DoD-approved banner that is formatted in accordance with DTM-08-060. Use the following verbiage for applications that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\"I've read & consent to terms in IS user agreem't.\"\n\nVerify the appropriate banner is configured.\n[edit system login]\nmessage \"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n\\n-At any time, the USG may inspect and seize data stored on this IS.\\n\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.-This IS includes security measures (e.g., authentication and access controls) to protect USG interests-not for your personal benefit or privacy.\\n\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or mooring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\\n\";\n\nIf such a banner is not presented, this is a finding.","fix":"Configure the network device to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device.\n\nSet system login message:\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\\n\\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\\n\\n-At any time, the USG may inspect and seize data stored on this IS.\\n\\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.-This IS includes security measures (e.g., authentication and access controls) to protect USG interests-not for your personal benefit or privacy.\\n\\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or mooring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\\n\""},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57338r843689_chk","severity":"medium","gid":"V-253886","rid":"SV-253886r879547_rule","stig_id":"JUEX-NM-000090","gtitle":"SRG-APP-000068-NDM-000215","fix_id":"F-57289r843690_fix","documentable":null,"cci":["CCI-000048"],"nist":["AC-8 a"]}},{"id":"SV-253887","code":"control 'SV-253887' do\n  title 'The Juniper EX switch must be configured to protect against an individual (or process acting on behalf of an individual) falsely denying having performed organization-defined actions to be covered by nonrepudiation.'\n  desc 'This requirement supports nonrepudiation of actions taken by an administrator and is required in order to maintain the integrity of the configuration management process. All configuration changes to the network device are logged, and administrators authenticate with two-factor authentication before gaining administrative access. Together, these processes will ensure the administrators can be held accountable for the configuration changes they implement.\n\nTo meet this requirement, the network device must log administrator access and activity.'\n  desc 'check', 'Determine if the network device protects against an individual (or process acting on behalf of an individual) falsely denying having performed organization-defined actions to be covered by nonrepudiation. This requires logging all administrator access and configuration activity. This requirement may be verified by demonstration or configuration review. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server. (Note that two-factor authentication of administrator access is needed to support this requirement.) \n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not protect against an individual (or process acting on behalf of an individual) falsely denying having performed organization-defined actions to be covered by nonrepudiation, this is a finding.'\n  desc 'fix', 'Configure the network device or its associated authentication server to protect against an individual (or process acting on behalf of an individual) falsely denying having performed organization-defined actions to be covered by nonrepudiation. Examples that support this include configuring the audit log to capture administration login events and configuration changes to the network device.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57339r843692_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253887'\n  tag rid: 'SV-253887r879554_rule'\n  tag stig_id: 'JUEX-NM-000100'\n  tag gtitle: 'SRG-APP-000080-NDM-000220'\n  tag fix_id: 'F-57290r843693_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000166']\n  tag nist: ['AU-10']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253887.rb"},"title":"The Juniper EX switch must be configured to protect against an individual (or process acting on behalf of an individual) falsely denying having performed organization-defined actions to be covered by nonrepudiation.","desc":"This requirement supports nonrepudiation of actions taken by an administrator and is required in order to maintain the integrity of the configuration management process. All configuration changes to the network device are logged, and administrators authenticate with two-factor authentication before gaining administrative access. Together, these processes will ensure the administrators can be held accountable for the configuration changes they implement.\n\nTo meet this requirement, the network device must log administrator access and activity.","descriptions":{"default":"This requirement supports nonrepudiation of actions taken by an administrator and is required in order to maintain the integrity of the configuration management process. All configuration changes to the network device are logged, and administrators authenticate with two-factor authentication before gaining administrative access. Together, these processes will ensure the administrators can be held accountable for the configuration changes they implement.\n\nTo meet this requirement, the network device must log administrator access and activity.","check":"Determine if the network device protects against an individual (or process acting on behalf of an individual) falsely denying having performed organization-defined actions to be covered by nonrepudiation. This requires logging all administrator access and configuration activity. This requirement may be verified by demonstration or configuration review. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server. (Note that two-factor authentication of administrator access is needed to support this requirement.) \n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not protect against an individual (or process acting on behalf of an individual) falsely denying having performed organization-defined actions to be covered by nonrepudiation, this is a finding.","fix":"Configure the network device or its associated authentication server to protect against an individual (or process acting on behalf of an individual) falsely denying having performed organization-defined actions to be covered by nonrepudiation. Examples that support this include configuring the audit log to capture administration login events and configuration changes to the network device.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57339r843692_chk","severity":"medium","gid":"V-253887","rid":"SV-253887r879554_rule","stig_id":"JUEX-NM-000100","gtitle":"SRG-APP-000080-NDM-000220","fix_id":"F-57290r843693_fix","documentable":null,"cci":["CCI-000166"],"nist":["AU-10"]}},{"id":"SV-253888","code":"control 'SV-253888' do\n  title 'The Juniper EX switch must be configured to generate audit records for executed commands.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. \n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Determine if the network device generates audit records for executed commands. \n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records for executed commands, this is a finding.'\n  desc 'fix', 'Configure the network device to generate audit records for executed commands.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57340r843695_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253888'\n  tag rid: 'SV-253888r879561_rule'\n  tag stig_id: 'JUEX-NM-000110'\n  tag gtitle: 'SRG-APP-000091-NDM-000223'\n  tag fix_id: 'F-57291r843696_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253888.rb"},"title":"The Juniper EX switch must be configured to generate audit records for executed commands.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. \n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. \n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Determine if the network device generates audit records for executed commands. \n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records for executed commands, this is a finding.","fix":"Configure the network device to generate audit records for executed commands.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57340r843695_chk","severity":"medium","gid":"V-253888","rid":"SV-253888r879561_rule","stig_id":"JUEX-NM-000110","gtitle":"SRG-APP-000091-NDM-000223","fix_id":"F-57291r843696_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-253889","code":"control 'SV-253889' do\n  title 'The Juniper device must be configured to produce audit log records containing sufficient information to establish what type of event occurred.'\n  desc 'It is essential for security personnel to know what is being done, what was attempted, where it was done, when it was done, and by whom it was done to compile an accurate risk assessment. Associating event types with detected events in the application and audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured network device. Without this capability, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.'\n  desc 'check', %q(Determine if the network device produces audit log records containing sufficient information to establish what type of event occurred. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not produce audit log records containing sufficient information to establish what type of event occurred, this is a finding.)\n  desc 'fix', \"Configure the network device to produce audit log records containing sufficient information to establish what type of event occurred.\n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57341r843698_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253889'\n  tag rid: 'SV-253889r879563_rule'\n  tag stig_id: 'JUEX-NM-000120'\n  tag gtitle: 'SRG-APP-000095-NDM-000225'\n  tag fix_id: 'F-57292r843699_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000130']\n  tag nist: ['AU-3 a']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253889.rb"},"title":"The Juniper device must be configured to produce audit log records containing sufficient information to establish what type of event occurred.","desc":"It is essential for security personnel to know what is being done, what was attempted, where it was done, when it was done, and by whom it was done to compile an accurate risk assessment. Associating event types with detected events in the application and audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured network device. Without this capability, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.","descriptions":{"default":"It is essential for security personnel to know what is being done, what was attempted, where it was done, when it was done, and by whom it was done to compile an accurate risk assessment. Associating event types with detected events in the application and audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured network device. Without this capability, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.","check":"Determine if the network device produces audit log records containing sufficient information to establish what type of event occurred. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not produce audit log records containing sufficient information to establish what type of event occurred, this is a finding.","fix":"Configure the network device to produce audit log records containing sufficient information to establish what type of event occurred.\n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57341r843698_chk","severity":"medium","gid":"V-253889","rid":"SV-253889r879563_rule","stig_id":"JUEX-NM-000120","gtitle":"SRG-APP-000095-NDM-000225","fix_id":"F-57292r843699_fix","documentable":null,"cci":["CCI-000130"],"nist":["AU-3 a"]}},{"id":"SV-253890","code":"control 'SV-253890' do\n  title 'The Juniper EX switch must be configured to produce audit records containing information to establish when (date and time) the events occurred.'\n  desc 'It is essential for security personnel to know what is being done, what was attempted, where it was done, when it was done, and by whom it was done in order to compile an accurate risk assessment. Logging the date and time of each detected event provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured network device. In order to establish and correlate the series of events leading up to an outage or attack, it is imperative the date and time are recorded in all log records.'\n  desc 'check', %q(Determine if the network device is configured to produce audit records containing information to establish when (date and time) the events occurred. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not produce audit records containing information to establish when the events occurred, this is a finding.)\n  desc 'fix', \"Configure the network device to produce audit records containing information to establish when (date and time) the events occurred.\n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57342r843701_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253890'\n  tag rid: 'SV-253890r879564_rule'\n  tag stig_id: 'JUEX-NM-000130'\n  tag gtitle: 'SRG-APP-000096-NDM-000226'\n  tag fix_id: 'F-57293r843702_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000131']\n  tag nist: ['AU-3 b']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253890.rb"},"title":"The Juniper EX switch must be configured to produce audit records containing information to establish when (date and time) the events occurred.","desc":"It is essential for security personnel to know what is being done, what was attempted, where it was done, when it was done, and by whom it was done in order to compile an accurate risk assessment. Logging the date and time of each detected event provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured network device. In order to establish and correlate the series of events leading up to an outage or attack, it is imperative the date and time are recorded in all log records.","descriptions":{"default":"It is essential for security personnel to know what is being done, what was attempted, where it was done, when it was done, and by whom it was done in order to compile an accurate risk assessment. Logging the date and time of each detected event provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured network device. In order to establish and correlate the series of events leading up to an outage or attack, it is imperative the date and time are recorded in all log records.","check":"Determine if the network device is configured to produce audit records containing information to establish when (date and time) the events occurred. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not produce audit records containing information to establish when the events occurred, this is a finding.","fix":"Configure the network device to produce audit records containing information to establish when (date and time) the events occurred.\n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57342r843701_chk","severity":"medium","gid":"V-253890","rid":"SV-253890r879564_rule","stig_id":"JUEX-NM-000130","gtitle":"SRG-APP-000096-NDM-000226","fix_id":"F-57293r843702_fix","documentable":null,"cci":["CCI-000131"],"nist":["AU-3 b"]}},{"id":"SV-253891","code":"control 'SV-253891' do\n  title 'The Juniper EX switch must be configured to produce audit records containing information to establish where the events occurred.'\n  desc 'To compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know where events occurred, such as device hardware components, device software modules, session identifiers, filenames, host names, and functionality.\n\nAssociating information about where the event occurred within the network device provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured device.'\n  desc 'check', %q(Determine if the network device is configured to produce audit records containing information to establish where the events occurred. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not produce audit records containing information to establish where the events occurred, this is a finding.)\n  desc 'fix', \"Configure the network device to produce audit records containing information to establish where the events occurred.\n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57343r843704_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253891'\n  tag rid: 'SV-253891r879565_rule'\n  tag stig_id: 'JUEX-NM-000140'\n  tag gtitle: 'SRG-APP-000097-NDM-000227'\n  tag fix_id: 'F-57294r843705_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000132']\n  tag nist: ['AU-3 c']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253891.rb"},"title":"The Juniper EX switch must be configured to produce audit records containing information to establish where the events occurred.","desc":"To compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know where events occurred, such as device hardware components, device software modules, session identifiers, filenames, host names, and functionality.\n\nAssociating information about where the event occurred within the network device provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured device.","descriptions":{"default":"To compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know where events occurred, such as device hardware components, device software modules, session identifiers, filenames, host names, and functionality.\n\nAssociating information about where the event occurred within the network device provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured device.","check":"Determine if the network device is configured to produce audit records containing information to establish where the events occurred. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not produce audit records containing information to establish where the events occurred, this is a finding.","fix":"Configure the network device to produce audit records containing information to establish where the events occurred.\n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57343r843704_chk","severity":"medium","gid":"V-253891","rid":"SV-253891r879565_rule","stig_id":"JUEX-NM-000140","gtitle":"SRG-APP-000097-NDM-000227","fix_id":"F-57294r843705_fix","documentable":null,"cci":["CCI-000132"],"nist":["AU-3 c"]}},{"id":"SV-253892","code":"control 'SV-253892' do\n  title 'The Juniper EX switch must be configured to produce audit log records containing information to establish the source of events.'\n  desc 'To compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know the source of the event. The source may be a component, module, or process within the device or an external session, administrator, or device.\n\nAssociating information about where the source of the event occurred provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured device.'\n  desc 'check', %q(Determine if the network device is configured to produce audit records containing information to establish the source (apparent cause) of the event. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not produce audit records containing information to establish the source of the event, this is a finding.)\n  desc 'fix', \"Configure the network device to produce audit records containing information to establish the source of the event.\n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57344r843707_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253892'\n  tag rid: 'SV-253892r879566_rule'\n  tag stig_id: 'JUEX-NM-000150'\n  tag gtitle: 'SRG-APP-000098-NDM-000228'\n  tag fix_id: 'F-57295r843708_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000133']\n  tag nist: ['AU-3 d']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253892.rb"},"title":"The Juniper EX switch must be configured to produce audit log records containing information to establish the source of events.","desc":"To compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know the source of the event. The source may be a component, module, or process within the device or an external session, administrator, or device.\n\nAssociating information about where the source of the event occurred provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured device.","descriptions":{"default":"To compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know the source of the event. The source may be a component, module, or process within the device or an external session, administrator, or device.\n\nAssociating information about where the source of the event occurred provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured device.","check":"Determine if the network device is configured to produce audit records containing information to establish the source (apparent cause) of the event. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not produce audit records containing information to establish the source of the event, this is a finding.","fix":"Configure the network device to produce audit records containing information to establish the source of the event.\n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57344r843707_chk","severity":"medium","gid":"V-253892","rid":"SV-253892r879566_rule","stig_id":"JUEX-NM-000150","gtitle":"SRG-APP-000098-NDM-000228","fix_id":"F-57295r843708_fix","documentable":null,"cci":["CCI-000133"],"nist":["AU-3 d"]}},{"id":"SV-253893","code":"control 'SV-253893' do\n  title 'The Juniper EX switch must be configured to produce audit records that contain information to establish the outcome of the event.'\n  desc 'Without information about the outcome of events, security personnel cannot make an accurate assessment as to whether an attack was successful or if changes were made to the security state of the system.\n\nEvent outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the device after the event occurred). As such, they also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response.'\n  desc 'check', %q(Determine if the network device is configured to produce audit records that contain information to establish the outcome of the event. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not produce audit records that contain information to establish the outcome of the event, this is a finding.)\n  desc 'fix', \"Configure the network device to produce audit records that contain information to establish the outcome of the event. \n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57345r843710_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253893'\n  tag rid: 'SV-253893r879567_rule'\n  tag stig_id: 'JUEX-NM-000160'\n  tag gtitle: 'SRG-APP-000099-NDM-000229'\n  tag fix_id: 'F-57296r843711_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000134']\n  tag nist: ['AU-3 e']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253893.rb"},"title":"The Juniper EX switch must be configured to produce audit records that contain information to establish the outcome of the event.","desc":"Without information about the outcome of events, security personnel cannot make an accurate assessment as to whether an attack was successful or if changes were made to the security state of the system.\n\nEvent outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the device after the event occurred). As such, they also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response.","descriptions":{"default":"Without information about the outcome of events, security personnel cannot make an accurate assessment as to whether an attack was successful or if changes were made to the security state of the system.\n\nEvent outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the device after the event occurred). As such, they also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response.","check":"Determine if the network device is configured to produce audit records that contain information to establish the outcome of the event. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not produce audit records that contain information to establish the outcome of the event, this is a finding.","fix":"Configure the network device to produce audit records that contain information to establish the outcome of the event. \n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57345r843710_chk","severity":"medium","gid":"V-253893","rid":"SV-253893r879567_rule","stig_id":"JUEX-NM-000160","gtitle":"SRG-APP-000099-NDM-000229","fix_id":"F-57296r843711_fix","documentable":null,"cci":["CCI-000134"],"nist":["AU-3 e"]}},{"id":"SV-253894","code":"control 'SV-253894' do\n  title 'The Juniper EX switch must be configured to generate audit records containing information that establishes the identity of any individual or process associated with the event.'\n  desc 'Without information that establishes the identity of the subjects (i.e., administrators or processes acting on behalf of administrators) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.\n\nEvent identifiers (if authenticated or otherwise known) include, but are not limited to, user database tables, primary key values, user names, or process identifiers.'\n  desc 'check', %q(Determine if the network device generates audit records containing information that establishes the identity of any individual or process associated with the event. This requirement may be verified by demonstration or validated test results. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not generate audit records containing information that establishes the identity of any individual or process associated with the event, this is a finding.)\n  desc 'fix', \"Configure the network device to generate audit records containing information that establishes the identity of any individual or process associated with the event.\n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57346r844935_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253894'\n  tag rid: 'SV-253894r879568_rule'\n  tag stig_id: 'JUEX-NM-000170'\n  tag gtitle: 'SRG-APP-000100-NDM-000230'\n  tag fix_id: 'F-57297r843714_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001487']\n  tag nist: ['AU-3 f']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253894.rb"},"title":"The Juniper EX switch must be configured to generate audit records containing information that establishes the identity of any individual or process associated with the event.","desc":"Without information that establishes the identity of the subjects (i.e., administrators or processes acting on behalf of administrators) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.\n\nEvent identifiers (if authenticated or otherwise known) include, but are not limited to, user database tables, primary key values, user names, or process identifiers.","descriptions":{"default":"Without information that establishes the identity of the subjects (i.e., administrators or processes acting on behalf of administrators) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.\n\nEvent identifiers (if authenticated or otherwise known) include, but are not limited to, user database tables, primary key values, user names, or process identifiers.","check":"Determine if the network device generates audit records containing information that establishes the identity of any individual or process associated with the event. This requirement may be verified by demonstration or validated test results. \n\nJunos standard event log messages are configurable for time format, inclusion of logging facility and severity levels, and format. Setting \"structured-data\" automatically includes \"explicit-priority\" and \"time-format year millisecond\". Verify logging is enabled.\n\n[edit system]\nsyslog {\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        structured-data; <<< Includes 'explicit-priority' and 'time-format'\n    }\n    host <syslog IPv4 or IPv6 address> {\n        any info;\n        explicit-priority; <<< Includes logging facility and severity in standard format\n    }\n    file <file name> {\n        any info; <<< Uses only standard format\n    }\n    time-format year; <<< Applied only to standard format\n}\nNote: In the example, events sent to the first external syslog server include the year and time is expressed in milliseconds. The second syslog server and the file both include the year, but time is expressed in seconds.\n\nIf the network device does not generate audit records containing information that establishes the identity of any individual or process associated with the event, this is a finding.","fix":"Configure the network device to generate audit records containing information that establishes the identity of any individual or process associated with the event.\n\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data <<< Includes the 'explicit-priority' and 'time-format year millisecond' directives\n-or-\nset system syslog host <syslog IPv4 or IPv6 address> any info\nset system syslog host <syslog IPv4 or IPv6 address> explicit-priority <<< Only if log level and severity are required\nset system syslog file <file name> any info\nset system syslog file <file name> explicit-priority <<< Only if log level and severity are required\nset system syslog time-format year"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57346r844935_chk","severity":"medium","gid":"V-253894","rid":"SV-253894r879568_rule","stig_id":"JUEX-NM-000170","gtitle":"SRG-APP-000100-NDM-000230","fix_id":"F-57297r843714_fix","documentable":null,"cci":["CCI-001487"],"nist":["AU-3 f"]}},{"id":"SV-253895","code":"control 'SV-253895' do\n  title 'The Juniper EX switch must be configured to generate audit records containing the full-text recording of privileged commands.'\n  desc 'Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information. \n\nOrganizations consider limiting the additional audit information to only that information explicitly needed for specific audit requirements. The additional information required is dependent on the type of information (i.e., sensitivity of the data and the environment within which it resides). At a minimum, the organization must audit full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.'\n  desc 'check', 'Determine if the network device generates audit records containing the full-text recording of privileged commands. \n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf such audit records are not being generated, this is a finding.'\n  desc 'fix', 'Configure the network device to generate audit records containing the full-text recording of privileged commands.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57347r843716_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253895'\n  tag rid: 'SV-253895r879569_rule'\n  tag stig_id: 'JUEX-NM-000180'\n  tag gtitle: 'SRG-APP-000101-NDM-000231'\n  tag fix_id: 'F-57298r843717_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000135']\n  tag nist: ['AU-3 (1)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253895.rb"},"title":"The Juniper EX switch must be configured to generate audit records containing the full-text recording of privileged commands.","desc":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information. \n\nOrganizations consider limiting the additional audit information to only that information explicitly needed for specific audit requirements. The additional information required is dependent on the type of information (i.e., sensitivity of the data and the environment within which it resides). At a minimum, the organization must audit full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","descriptions":{"default":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information. \n\nOrganizations consider limiting the additional audit information to only that information explicitly needed for specific audit requirements. The additional information required is dependent on the type of information (i.e., sensitivity of the data and the environment within which it resides). At a minimum, the organization must audit full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","check":"Determine if the network device generates audit records containing the full-text recording of privileged commands. \n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf such audit records are not being generated, this is a finding.","fix":"Configure the network device to generate audit records containing the full-text recording of privileged commands.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57347r843716_chk","severity":"medium","gid":"V-253895","rid":"SV-253895r879569_rule","stig_id":"JUEX-NM-000180","gtitle":"SRG-APP-000101-NDM-000231","fix_id":"F-57298r843717_fix","documentable":null,"cci":["CCI-000135"],"nist":["AU-3 (1)"]}},{"id":"SV-253896","code":"control 'SV-253896' do\n  title 'The Juniper EX switch must be configured to protect audit information from unauthorized modification.'\n  desc 'Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit network device activity.\n\nIf audit data were to become compromised, then forensic analysis and discovery of the true source of potentially malicious system activity is impossible to achieve. \n\nTo ensure the veracity of audit data, the network device must protect audit information from unauthorized modification. \n\nThis requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files receive the proper file system permissions and limiting log data locations. \n\nNetwork devices providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights that the user enjoys to make access decisions regarding the modification of audit data.'\n  desc 'check', 'Determine if the network device protects audit information from any type of unauthorized modification with such methods as ensuring log files receive the proper file system permissions, limiting log data locations, and leveraging user permissions and roles to identify the user accessing the data and the corresponding rights that the user enjoys. This requirement may be verified by demonstration, configuration, or validated test results. \n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nAudit logs are configured in the [edit system] hierarchy and require the \"system\" permission to view and the \"system-control\" permission to configure (or permissions set \"all\"). However, using the allow or deny statements permits adding, or removing, specific commands or configuration hierarchy levels. \n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf the network device does not protect audit information from unauthorized modification, this is a finding.'\n  desc 'fix', \"Configure the network device to protect audit information from unauthorized modification.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57348r843719_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253896'\n  tag rid: 'SV-253896r879577_rule'\n  tag stig_id: 'JUEX-NM-000190'\n  tag gtitle: 'SRG-APP-000119-NDM-000236'\n  tag fix_id: 'F-57299r843720_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000163']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253896.rb"},"title":"The Juniper EX switch must be configured to protect audit information from unauthorized modification.","desc":"Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit network device activity.\n\nIf audit data were to become compromised, then forensic analysis and discovery of the true source of potentially malicious system activity is impossible to achieve. \n\nTo ensure the veracity of audit data, the network device must protect audit information from unauthorized modification. \n\nThis requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files receive the proper file system permissions and limiting log data locations. \n\nNetwork devices providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights that the user enjoys to make access decisions regarding the modification of audit data.","descriptions":{"default":"Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit network device activity.\n\nIf audit data were to become compromised, then forensic analysis and discovery of the true source of potentially malicious system activity is impossible to achieve. \n\nTo ensure the veracity of audit data, the network device must protect audit information from unauthorized modification. \n\nThis requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files receive the proper file system permissions and limiting log data locations. \n\nNetwork devices providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights that the user enjoys to make access decisions regarding the modification of audit data.","check":"Determine if the network device protects audit information from any type of unauthorized modification with such methods as ensuring log files receive the proper file system permissions, limiting log data locations, and leveraging user permissions and roles to identify the user accessing the data and the corresponding rights that the user enjoys. This requirement may be verified by demonstration, configuration, or validated test results. \n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nAudit logs are configured in the [edit system] hierarchy and require the \"system\" permission to view and the \"system-control\" permission to configure (or permissions set \"all\"). However, using the allow or deny statements permits adding, or removing, specific commands or configuration hierarchy levels. \n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf the network device does not protect audit information from unauthorized modification, this is a finding.","fix":"Configure the network device to protect audit information from unauthorized modification.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57348r843719_chk","severity":"medium","gid":"V-253896","rid":"SV-253896r879577_rule","stig_id":"JUEX-NM-000190","gtitle":"SRG-APP-000119-NDM-000236","fix_id":"F-57299r843720_fix","documentable":null,"cci":["CCI-000163"],"nist":["AU-9 a"]}},{"id":"SV-253897","code":"control 'SV-253897' do\n  title 'The Juniper EX switch must be configured to protect audit information from unauthorized deletion.'\n  desc 'Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nIf audit data were to become compromised, then forensic analysis and discovery of the true source of potentially malicious system activity is impossible to achieve. \n\nTo ensure the veracity of audit data, the network device must protect audit information from unauthorized deletion. This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files receive the proper file system permissions utilizing file system protections, restricting access, and backing up log data to ensure log data is retained. \n\nNetwork devices providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights the user enjoys in order to make access decisions regarding the deletion of audit data.'\n  desc 'check', 'Determine if the network device protects audit information from any type of unauthorized deletion with such methods as ensuring log files receive the proper file system permissions utilizing file system protections, restricting access to log data and backing up log data to ensure log data is retained, and leveraging user permissions and roles to identify the user accessing the data and the corresponding rights the user enjoys. This requirement may be verified by demonstration, configuration, or validated test results. \n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nAudit logs are configured in the [edit system] hierarchy and require the \"system\" permission to view and the \"system-control\" permission to configure (or permissions set \"all\"). However, using the allow or deny statements permits adding, or removing, specific commands or configuration hierarchy levels. \n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf the network device does not protect audit information from unauthorized deletion, this is a finding.'\n  desc 'fix', \"Configure the network device to protect audit information from unauthorized deletion.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57349r843722_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253897'\n  tag rid: 'SV-253897r879578_rule'\n  tag stig_id: 'JUEX-NM-000200'\n  tag gtitle: 'SRG-APP-000120-NDM-000237'\n  tag fix_id: 'F-57300r843723_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000164']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253897.rb"},"title":"The Juniper EX switch must be configured to protect audit information from unauthorized deletion.","desc":"Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nIf audit data were to become compromised, then forensic analysis and discovery of the true source of potentially malicious system activity is impossible to achieve. \n\nTo ensure the veracity of audit data, the network device must protect audit information from unauthorized deletion. This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files receive the proper file system permissions utilizing file system protections, restricting access, and backing up log data to ensure log data is retained. \n\nNetwork devices providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights the user enjoys in order to make access decisions regarding the deletion of audit data.","descriptions":{"default":"Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nIf audit data were to become compromised, then forensic analysis and discovery of the true source of potentially malicious system activity is impossible to achieve. \n\nTo ensure the veracity of audit data, the network device must protect audit information from unauthorized deletion. This requirement can be achieved through multiple methods, which will depend upon system architecture and design. Some commonly employed methods include ensuring log files receive the proper file system permissions utilizing file system protections, restricting access, and backing up log data to ensure log data is retained. \n\nNetwork devices providing a user interface to audit data will leverage user permissions and roles identifying the user accessing the data and the corresponding rights the user enjoys in order to make access decisions regarding the deletion of audit data.","check":"Determine if the network device protects audit information from any type of unauthorized deletion with such methods as ensuring log files receive the proper file system permissions utilizing file system protections, restricting access to log data and backing up log data to ensure log data is retained, and leveraging user permissions and roles to identify the user accessing the data and the corresponding rights the user enjoys. This requirement may be verified by demonstration, configuration, or validated test results. \n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nAudit logs are configured in the [edit system] hierarchy and require the \"system\" permission to view and the \"system-control\" permission to configure (or permissions set \"all\"). However, using the allow or deny statements permits adding, or removing, specific commands or configuration hierarchy levels. \n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf the network device does not protect audit information from unauthorized deletion, this is a finding.","fix":"Configure the network device to protect audit information from unauthorized deletion.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57349r843722_chk","severity":"medium","gid":"V-253897","rid":"SV-253897r879578_rule","stig_id":"JUEX-NM-000200","gtitle":"SRG-APP-000120-NDM-000237","fix_id":"F-57300r843723_fix","documentable":null,"cci":["CCI-000164"],"nist":["AU-9 a"]}},{"id":"SV-253898","code":"control 'SV-253898' do\n  title 'The Juniper EX switch must be configured to protect audit tools from unauthorized access.'\n  desc 'Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.\n\nNetwork devices providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.'\n  desc 'check', 'Junos provides the operational mode commands \"show\" (to display the contents of a log file) or \"clear\" (to delete all of the contents of a log file); there is no text editor or other \"audit tool\" provided in the CLI. Operational and configuration mode commands require assignment of the required permission bit to execute. For example, audit logs are configured in the [edit system] hierarchy and require the \"system\" permission to view and the \"system-control\" permission to configure (or permissions set \"all\"). However, using the allow or deny statements permits adding, or removing, specific commands or configuration hierarchy levels. Adding the \"deny-commands \"^clear log\"\" directive to a login class prevents any user assigned to that class from clearing any log file.\n\nVerify the permissions assigned to each login class is appropriate.\n\nIn addition to limiting permissions, Junos supports limiting commands and hierarchy levels that would otherwise be permitted. For example, to remove the ability to modify auditing from a login class with the \"system-control\" or \"all\" permissions assigned, use the \"deny-configuration-regexps [ \"system syslog\" ]\" directive. To prevent administrative users assigned to that same login class from viewing and/or deleting the audit file contents, add the \"deny-commands \"^(show|clear) log\"\" directive.\n\nExample login-class definitions:\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf the network device does not protect its audit tools from unauthorized access, this is a finding.'\n  desc 'fix', \"Configure the network device to protect audit tools from unauthorized access.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57350r843725_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253898'\n  tag rid: 'SV-253898r879579_rule'\n  tag stig_id: 'JUEX-NM-000210'\n  tag gtitle: 'SRG-APP-000121-NDM-000238'\n  tag fix_id: 'F-57301r843726_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001493']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253898.rb"},"title":"The Juniper EX switch must be configured to protect audit tools from unauthorized access.","desc":"Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.\n\nNetwork devices providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.","descriptions":{"default":"Protecting audit data also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit data.\n\nNetwork devices providing tools to interface with audit data will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.","check":"Junos provides the operational mode commands \"show\" (to display the contents of a log file) or \"clear\" (to delete all of the contents of a log file); there is no text editor or other \"audit tool\" provided in the CLI. Operational and configuration mode commands require assignment of the required permission bit to execute. For example, audit logs are configured in the [edit system] hierarchy and require the \"system\" permission to view and the \"system-control\" permission to configure (or permissions set \"all\"). However, using the allow or deny statements permits adding, or removing, specific commands or configuration hierarchy levels. Adding the \"deny-commands \"^clear log\"\" directive to a login class prevents any user assigned to that class from clearing any log file.\n\nVerify the permissions assigned to each login class is appropriate.\n\nIn addition to limiting permissions, Junos supports limiting commands and hierarchy levels that would otherwise be permitted. For example, to remove the ability to modify auditing from a login class with the \"system-control\" or \"all\" permissions assigned, use the \"deny-configuration-regexps [ \"system syslog\" ]\" directive. To prevent administrative users assigned to that same login class from viewing and/or deleting the audit file contents, add the \"deny-commands \"^(show|clear) log\"\" directive.\n\nExample login-class definitions:\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf the network device does not protect its audit tools from unauthorized access, this is a finding.","fix":"Configure the network device to protect audit tools from unauthorized access.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57350r843725_chk","severity":"medium","gid":"V-253898","rid":"SV-253898r879579_rule","stig_id":"JUEX-NM-000210","gtitle":"SRG-APP-000121-NDM-000238","fix_id":"F-57301r843726_fix","documentable":null,"cci":["CCI-001493"],"nist":["AU-9 a"]}},{"id":"SV-253899","code":"control 'SV-253899' do\n  title 'The Juniper EX switch must be configured to limit privileges to change the software resident within software libraries.'\n  desc 'Changes to any software components of the network device can have significant effects on the overall security of the network. Therefore, only qualified and authorized individuals should be allowed administrative access to the network device for implementing any changes or upgrades. If the network device were to enable nonauthorized users to make changes to software libraries, those changes could be implemented without undergoing testing, validation, and approval.'\n  desc 'check', 'Determine if the network device limits privileges to change the software resident within software libraries.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator. \n\nInstallation of firmware requires the maintenance permission bit. However, even with that bit set, software installation can be limited by the \"deny-commands\" statement (e.g., deny-commands \"^request system software\"). The command takes a regular expression (REGEX) enclosed in double quotes (\").\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf it does not limit privileges to change the software resident within software libraries, this is a finding.'\n  desc 'fix', \"Configure the network device to limit privileges to change the software resident within software libraries.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57351r843728_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253899'\n  tag rid: 'SV-253899r879586_rule'\n  tag stig_id: 'JUEX-NM-000220'\n  tag gtitle: 'SRG-APP-000133-NDM-000244'\n  tag fix_id: 'F-57302r843729_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001499']\n  tag nist: ['CM-5 (6)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253899.rb"},"title":"The Juniper EX switch must be configured to limit privileges to change the software resident within software libraries.","desc":"Changes to any software components of the network device can have significant effects on the overall security of the network. Therefore, only qualified and authorized individuals should be allowed administrative access to the network device for implementing any changes or upgrades. If the network device were to enable nonauthorized users to make changes to software libraries, those changes could be implemented without undergoing testing, validation, and approval.","descriptions":{"default":"Changes to any software components of the network device can have significant effects on the overall security of the network. Therefore, only qualified and authorized individuals should be allowed administrative access to the network device for implementing any changes or upgrades. If the network device were to enable nonauthorized users to make changes to software libraries, those changes could be implemented without undergoing testing, validation, and approval.","check":"Determine if the network device limits privileges to change the software resident within software libraries.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator. \n\nInstallation of firmware requires the maintenance permission bit. However, even with that bit set, software installation can be limited by the \"deny-commands\" statement (e.g., deny-commands \"^request system software\"). The command takes a regular expression (REGEX) enclosed in double quotes (\").\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf it does not limit privileges to change the software resident within software libraries, this is a finding.","fix":"Configure the network device to limit privileges to change the software resident within software libraries.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57351r843728_chk","severity":"medium","gid":"V-253899","rid":"SV-253899r879586_rule","stig_id":"JUEX-NM-000220","gtitle":"SRG-APP-000133-NDM-000244","fix_id":"F-57302r843729_fix","documentable":null,"cci":["CCI-001499"],"nist":["CM-5 (6)"]}},{"id":"SV-253900","code":"control 'SV-253900' do\n  title 'The Juniper EX switch must be configured to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services.'\n  desc 'To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable unused or unnecessary physical and logical ports/protocols on information systems.\n\nNetwork devices are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the network device must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved. Some network devices have capabilities enabled by default; if these capabilities are not necessary, they must be disabled. If a particular capability is used, then it must be documented and approved.'\n  desc 'check', 'Determine if the network device prohibits the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services.\n\nVerify unnecessary or nonsecure functions are not configured or are explicitly disabled. For example, FTP and Telnet are nonsecure. Verify these services are not enabled as in the example below:\n[edit system services]\nftp;\ntelnet;\n\nIf any unnecessary or nonsecure functions are permitted, this is a finding.'\n  desc 'fix', 'Configure the network device to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services.\n\ndelete system services ftp\ndelete system services telnet\ndelete system services web-management\n\nNote: Delete other configured but unnecessary system services.'\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57352r843731_chk'\n  tag severity: 'high'\n  tag gid: 'V-253900'\n  tag rid: 'SV-253900r879588_rule'\n  tag stig_id: 'JUEX-NM-000230'\n  tag gtitle: 'SRG-APP-000142-NDM-000245'\n  tag fix_id: 'F-57303r843732_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000382']\n  tag nist: ['CM-7 b']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253900.rb"},"title":"The Juniper EX switch must be configured to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services.","desc":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable unused or unnecessary physical and logical ports/protocols on information systems.\n\nNetwork devices are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the network device must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved. Some network devices have capabilities enabled by default; if these capabilities are not necessary, they must be disabled. If a particular capability is used, then it must be documented and approved.","descriptions":{"default":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable unused or unnecessary physical and logical ports/protocols on information systems.\n\nNetwork devices are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component. \n\nTo support the requirements and principles of least functionality, the network device must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved. Some network devices have capabilities enabled by default; if these capabilities are not necessary, they must be disabled. If a particular capability is used, then it must be documented and approved.","check":"Determine if the network device prohibits the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services.\n\nVerify unnecessary or nonsecure functions are not configured or are explicitly disabled. For example, FTP and Telnet are nonsecure. Verify these services are not enabled as in the example below:\n[edit system services]\nftp;\ntelnet;\n\nIf any unnecessary or nonsecure functions are permitted, this is a finding.","fix":"Configure the network device to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services.\n\ndelete system services ftp\ndelete system services telnet\ndelete system services web-management\n\nNote: Delete other configured but unnecessary system services."},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57352r843731_chk","severity":"high","gid":"V-253900","rid":"SV-253900r879588_rule","stig_id":"JUEX-NM-000230","gtitle":"SRG-APP-000142-NDM-000245","fix_id":"F-57303r843732_fix","documentable":null,"cci":["CCI-000382"],"nist":["CM-7 b"]}},{"id":"SV-253901","code":"control 'SV-253901' do\n  title 'The Juniper EX switch must be configured with only one local account to be used as the account of last resort in the event the authentication server is unavailable.'\n  desc \"Authentication for administrative (privileged level) access to the device is required at all times. An account is created on the device's local database for use when the authentication server is down or connectivity between the device and the authentication server is not operable. This account is referred to as the account of last resort since it is intended to be used as a last resort and when immediate administrative access is absolutely necessary.\n\nThe account of last resort logon credentials must be stored in a sealed envelope and kept in a safe. The safe must be periodically audited to verify the envelope remains sealed. The signature of the auditor and the date of the audit should be added to the envelope as a record. Administrators should secure the credentials and disable access to the root account (if possible) when not needed for system administration functions.\"\n  desc 'check', 'Review the network device configuration to determine if an account of last resort is configured. Verify default admin and other vendor-provided accounts are disabled, removed, or renamed where possible. Verify the username and password for the account of last resort is contained within a sealed envelope and kept in a safe. \n\nThere are no default passwords in Junos and the root account cannot be renamed or disabled. The root account password should be saved in the same manner as the account of last resort. \n\nVerify direct root login is disabled.\n[edit system services ssh]\nroot-login deny;\n\n[edit system ports]\nconsole {\n    log-out-on-disconnect;\n    insecure;\n}\nNote: Setting the console port \"insecure\" prevents direct root login but also prevents password recovery without knowledge of the root password.\n\nVerify only a single local account has an authentication stanza. Local accounts without an authentication stanza are \"template accounts\" and must be externally authenticated. Template accounts must match the logging-in username or a returned Vendor Specific Attribute (VSA) and are used to map permissions (assigned in the login class) to the user. This example assumes a working external authentication server and appropriate authentication order.\n\n[edit system login]\n:\n:\nuser <account of last resort name> {\n    uid 2004;\n    class <class name>;\n    authentication {\n        encrypted-password \"$6$0/BgZc6n$BIY..<snip>..vLzjWpYq2D/\"; ## SECRET-DATA\n    }\n}\nuser auditor {\n    uid 2010;\n    class <class name>;\n}\n\nIf one local account does not exist for use as the account of last resort, this is a finding.'\n  desc 'fix', 'Configure the device to only allow one local account for use as the account of last resort.   \n\nDisable direct root login:\nset system services ssh root-login deny\nset system ports console insecure\n\nConfigure the account of last resort:\nset system login user <account of last resort name> class <class name>\nset system login user <account of last resort name> authentication plain-text-password\nNew password: <password - not echoed to the screen>\nRetype new password: <password verification - not echoed to the screen>\n\nSet all other template accounts:\nset system login user <template account 1> class <class 1>\nset system login user <template account 2> class <class 2>'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57353r843734_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253901'\n  tag rid: 'SV-253901r879589_rule'\n  tag stig_id: 'JUEX-NM-000240'\n  tag gtitle: 'SRG-APP-000148-NDM-000346'\n  tag fix_id: 'F-57304r843735_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001358', 'CCI-002111']\n  tag nist: ['AC-2 (7) (a)', 'AC-2 a']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253901.rb"},"title":"The Juniper EX switch must be configured with only one local account to be used as the account of last resort in the event the authentication server is unavailable.","desc":"Authentication for administrative (privileged level) access to the device is required at all times. An account is created on the device's local database for use when the authentication server is down or connectivity between the device and the authentication server is not operable. This account is referred to as the account of last resort since it is intended to be used as a last resort and when immediate administrative access is absolutely necessary.\n\nThe account of last resort logon credentials must be stored in a sealed envelope and kept in a safe. The safe must be periodically audited to verify the envelope remains sealed. The signature of the auditor and the date of the audit should be added to the envelope as a record. Administrators should secure the credentials and disable access to the root account (if possible) when not needed for system administration functions.","descriptions":{"default":"Authentication for administrative (privileged level) access to the device is required at all times. An account is created on the device's local database for use when the authentication server is down or connectivity between the device and the authentication server is not operable. This account is referred to as the account of last resort since it is intended to be used as a last resort and when immediate administrative access is absolutely necessary.\n\nThe account of last resort logon credentials must be stored in a sealed envelope and kept in a safe. The safe must be periodically audited to verify the envelope remains sealed. The signature of the auditor and the date of the audit should be added to the envelope as a record. Administrators should secure the credentials and disable access to the root account (if possible) when not needed for system administration functions.","check":"Review the network device configuration to determine if an account of last resort is configured. Verify default admin and other vendor-provided accounts are disabled, removed, or renamed where possible. Verify the username and password for the account of last resort is contained within a sealed envelope and kept in a safe. \n\nThere are no default passwords in Junos and the root account cannot be renamed or disabled. The root account password should be saved in the same manner as the account of last resort. \n\nVerify direct root login is disabled.\n[edit system services ssh]\nroot-login deny;\n\n[edit system ports]\nconsole {\n    log-out-on-disconnect;\n    insecure;\n}\nNote: Setting the console port \"insecure\" prevents direct root login but also prevents password recovery without knowledge of the root password.\n\nVerify only a single local account has an authentication stanza. Local accounts without an authentication stanza are \"template accounts\" and must be externally authenticated. Template accounts must match the logging-in username or a returned Vendor Specific Attribute (VSA) and are used to map permissions (assigned in the login class) to the user. This example assumes a working external authentication server and appropriate authentication order.\n\n[edit system login]\n:\n:\nuser <account of last resort name> {\n    uid 2004;\n    class <class name>;\n    authentication {\n        encrypted-password \"$6$0/BgZc6n$BIY..<snip>..vLzjWpYq2D/\"; ## SECRET-DATA\n    }\n}\nuser auditor {\n    uid 2010;\n    class <class name>;\n}\n\nIf one local account does not exist for use as the account of last resort, this is a finding.","fix":"Configure the device to only allow one local account for use as the account of last resort.   \n\nDisable direct root login:\nset system services ssh root-login deny\nset system ports console insecure\n\nConfigure the account of last resort:\nset system login user <account of last resort name> class <class name>\nset system login user <account of last resort name> authentication plain-text-password\nNew password: <password - not echoed to the screen>\nRetype new password: <password verification - not echoed to the screen>\n\nSet all other template accounts:\nset system login user <template account 1> class <class 1>\nset system login user <template account 2> class <class 2>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57353r843734_chk","severity":"medium","gid":"V-253901","rid":"SV-253901r879589_rule","stig_id":"JUEX-NM-000240","gtitle":"SRG-APP-000148-NDM-000346","fix_id":"F-57304r843735_fix","documentable":null,"cci":["CCI-001358","CCI-002111"],"nist":["AC-2 (7) (a)","AC-2 a"]}},{"id":"SV-253902","code":"control 'SV-253902' do\n  title 'The Juniper EX switch must be configured to use DoD PKI as multifactor authentication (MFA) for interactive logins.'\n  desc 'MFA is when two or more factors are used to confirm the identity of an individual who is requesting access to digital information resources. Valid factors include something the individual knows (e.g., username and password), something the individual has (e.g., a smartcard or token), or something the individual is (e.g., a fingerprint or biometric). Legacy information system environments only use a single factor for authentication, typically a username and password combination. Although two pieces of data are used in a username and password combination, this is still considered single factor because an attacker can obtain access by learning what the user knows. \n\nCommon attacks against single-factor authentication are attacks on user passwords. These attacks include brute force password guessing, password spraying, and password credential stuffing. MFA, along with strong user account hygiene, helps mitigate the threat of having account passwords discovered by an attacker. Even in the event of a password compromise, with MFA implemented and required for interactive login, the attacker still needs to acquire something the user has or replicate a piece of user’s biometric digital presence.\n\nPrivate industry recognizes and uses a wide variety of MFA solutions. However, DoD public key infrastructure (PKI) is the only prescribed method approved for DoD organizations to implement MFA. This requirement is used in conjunction with the use of a centralized authentication server (e.g., AAA, RADIUS, LDAP), a separate but equally important requirement. The centralized authentication server will provide the second phase of authentication (the digital presence of the PKI ID as a valid user in the requested security domain) and authorization. \n\nJunos currently supports PAP and MS-CHAPv2 for administrative authentication. To mitigate this risk, sites must configure the authorized CAC alternative YubiKey One-Time Password (OTP). The OTP uses AES (AES256 is preferred by DoD) encrypted on the token prior to transmission and is valid only once. When using the authorized CAC alternative SecureID, the credential is valid for 60 seconds or first use, and is valid only once. The single local account (the account of last resort) password is securely hashed in Junos and never transmitted.\n\nTo support the authorized CAC alternatives, configure Junos for RADIUS and point to the appropriate authentication server.\n\nIf DoD PKI is not used but the network device uses an alternative FIPS 140-2 compliant, Cryptographic Module Validation Program (CMVP) validated OTP password solution, this requirement can be downgraded to a CAT III. Alternative MFA solutions for network devices with basic user interfaces (e.g., L2 switch with only SSH access) have been evaluated by the DoD Privileged User Working Group (PUWG). Current alternatives include RSA SecureID tokens and YubiKey One Time Password (OTP) tokens.'\n  desc 'check', 'Verify the network device is configured to use DoD PKI as MFA for interactive logins. Evidence of successful configuration is usually indicated by a prompt for the user to insert a smartcard. If the smartcard is already inserted, the network device will prompt the user to enter the corresponding PIN, which unlocks the certificate keystore on the smartcard. \n\nIf the network device is not configured to use DoD PKI as MFA for interactive logins, this is a finding. \n\nIf the PKI authenticated user is not mapped to the effective local user account, this is a finding.\n\nNote: Alternative MFA solutions for network devices with basic user interfaces (e.g., L2 switch with only SSH access) have been evaluated by the DoD Privileged User Working Group (PUWG). Current alternatives include RSA SecureID tokens and YubiKey OTP tokens. To use an alternative MFA solution, a business case and risk assessment must be presented to the Authorizing Official (AO) for review and acceptance. AOs may choose to accept the risk of using one of these alternatives in a target environment based on the business case that was presented. In this case, it is the responsibility of the AO to determine if the risk should be downgraded to a CAT II or a CAT III based on the risk assessment of the target environment.\n\nIf DoD PKI is not used but the network device uses an alternative FIPS 140-2 compliant, CMVP-validated OTP password solution, this requirement can be downgraded to a CAT III. \n\nJuniper devices fully support authorized alternatives such as the RSA SecureID and Yubico YubiKey OTP tokens.\n\nVerify the device is configured with template accounts and a RADIUS server.\n[edit system login]\n:\n:\nuser <account name> {\n\tuid 2015;\n\tclass <name>;\n}\n:\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\n[edit system radius-server]\n<RSA SecureID or Yubico YubiKey server address> {\n    secret \"...<hashed PSK>...\"; ## SECRET-DATA\n}\n\nNote: Other mitigation strategies that have not been evaluated by the DoD PUWG may include the use of one or more industry solutions. One-time password/PIN/passcodes (OTP), one-time URLs, time-based tokens, and biometrics are examples of such solutions. While AOs may choose to accept the risk of using these alternatives on a case-by-case basis, for DoD the risk of using these alternatives should never be mitigated below a CAT II.\n\nNote: This requirement is not applicable to the emergency account of last resort or for service accounts (noninteractive users). Examples of service accounts include remote service brokers such as AAA, syslog, etc.'\n  desc 'fix', %q(Configure the Juniper EX switch to use DoD PKI MFA for interactive logins.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\n\nset system radius-server <RSA SecureID or Yubico YubiKey server address> secret \"<PSK>\"\n-or-\nprompt system radius-server <RSA SecureID or Yubico YubiKey server address> secret\nNew secret (secret): <PSK> \nRetype new secret (secret): <confirm PSK>\n\nNote: The PSK is not echoed to the screen.)\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57354r843737_chk'\n  tag severity: 'high'\n  tag gid: 'V-253902'\n  tag rid: 'SV-253902r879590_rule'\n  tag stig_id: 'JUEX-NM-000250'\n  tag gtitle: 'SRG-APP-000149-NDM-000247'\n  tag fix_id: 'F-57305r843738_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000765']\n  tag nist: ['IA-2 (1)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253902.rb"},"title":"The Juniper EX switch must be configured to use DoD PKI as multifactor authentication (MFA) for interactive logins.","desc":"MFA is when two or more factors are used to confirm the identity of an individual who is requesting access to digital information resources. Valid factors include something the individual knows (e.g., username and password), something the individual has (e.g., a smartcard or token), or something the individual is (e.g., a fingerprint or biometric). Legacy information system environments only use a single factor for authentication, typically a username and password combination. Although two pieces of data are used in a username and password combination, this is still considered single factor because an attacker can obtain access by learning what the user knows. \n\nCommon attacks against single-factor authentication are attacks on user passwords. These attacks include brute force password guessing, password spraying, and password credential stuffing. MFA, along with strong user account hygiene, helps mitigate the threat of having account passwords discovered by an attacker. Even in the event of a password compromise, with MFA implemented and required for interactive login, the attacker still needs to acquire something the user has or replicate a piece of user’s biometric digital presence.\n\nPrivate industry recognizes and uses a wide variety of MFA solutions. However, DoD public key infrastructure (PKI) is the only prescribed method approved for DoD organizations to implement MFA. This requirement is used in conjunction with the use of a centralized authentication server (e.g., AAA, RADIUS, LDAP), a separate but equally important requirement. The centralized authentication server will provide the second phase of authentication (the digital presence of the PKI ID as a valid user in the requested security domain) and authorization. \n\nJunos currently supports PAP and MS-CHAPv2 for administrative authentication. To mitigate this risk, sites must configure the authorized CAC alternative YubiKey One-Time Password (OTP). The OTP uses AES (AES256 is preferred by DoD) encrypted on the token prior to transmission and is valid only once. When using the authorized CAC alternative SecureID, the credential is valid for 60 seconds or first use, and is valid only once. The single local account (the account of last resort) password is securely hashed in Junos and never transmitted.\n\nTo support the authorized CAC alternatives, configure Junos for RADIUS and point to the appropriate authentication server.\n\nIf DoD PKI is not used but the network device uses an alternative FIPS 140-2 compliant, Cryptographic Module Validation Program (CMVP) validated OTP password solution, this requirement can be downgraded to a CAT III. Alternative MFA solutions for network devices with basic user interfaces (e.g., L2 switch with only SSH access) have been evaluated by the DoD Privileged User Working Group (PUWG). Current alternatives include RSA SecureID tokens and YubiKey One Time Password (OTP) tokens.","descriptions":{"default":"MFA is when two or more factors are used to confirm the identity of an individual who is requesting access to digital information resources. Valid factors include something the individual knows (e.g., username and password), something the individual has (e.g., a smartcard or token), or something the individual is (e.g., a fingerprint or biometric). Legacy information system environments only use a single factor for authentication, typically a username and password combination. Although two pieces of data are used in a username and password combination, this is still considered single factor because an attacker can obtain access by learning what the user knows. \n\nCommon attacks against single-factor authentication are attacks on user passwords. These attacks include brute force password guessing, password spraying, and password credential stuffing. MFA, along with strong user account hygiene, helps mitigate the threat of having account passwords discovered by an attacker. Even in the event of a password compromise, with MFA implemented and required for interactive login, the attacker still needs to acquire something the user has or replicate a piece of user’s biometric digital presence.\n\nPrivate industry recognizes and uses a wide variety of MFA solutions. However, DoD public key infrastructure (PKI) is the only prescribed method approved for DoD organizations to implement MFA. This requirement is used in conjunction with the use of a centralized authentication server (e.g., AAA, RADIUS, LDAP), a separate but equally important requirement. The centralized authentication server will provide the second phase of authentication (the digital presence of the PKI ID as a valid user in the requested security domain) and authorization. \n\nJunos currently supports PAP and MS-CHAPv2 for administrative authentication. To mitigate this risk, sites must configure the authorized CAC alternative YubiKey One-Time Password (OTP). The OTP uses AES (AES256 is preferred by DoD) encrypted on the token prior to transmission and is valid only once. When using the authorized CAC alternative SecureID, the credential is valid for 60 seconds or first use, and is valid only once. The single local account (the account of last resort) password is securely hashed in Junos and never transmitted.\n\nTo support the authorized CAC alternatives, configure Junos for RADIUS and point to the appropriate authentication server.\n\nIf DoD PKI is not used but the network device uses an alternative FIPS 140-2 compliant, Cryptographic Module Validation Program (CMVP) validated OTP password solution, this requirement can be downgraded to a CAT III. Alternative MFA solutions for network devices with basic user interfaces (e.g., L2 switch with only SSH access) have been evaluated by the DoD Privileged User Working Group (PUWG). Current alternatives include RSA SecureID tokens and YubiKey One Time Password (OTP) tokens.","check":"Verify the network device is configured to use DoD PKI as MFA for interactive logins. Evidence of successful configuration is usually indicated by a prompt for the user to insert a smartcard. If the smartcard is already inserted, the network device will prompt the user to enter the corresponding PIN, which unlocks the certificate keystore on the smartcard. \n\nIf the network device is not configured to use DoD PKI as MFA for interactive logins, this is a finding. \n\nIf the PKI authenticated user is not mapped to the effective local user account, this is a finding.\n\nNote: Alternative MFA solutions for network devices with basic user interfaces (e.g., L2 switch with only SSH access) have been evaluated by the DoD Privileged User Working Group (PUWG). Current alternatives include RSA SecureID tokens and YubiKey OTP tokens. To use an alternative MFA solution, a business case and risk assessment must be presented to the Authorizing Official (AO) for review and acceptance. AOs may choose to accept the risk of using one of these alternatives in a target environment based on the business case that was presented. In this case, it is the responsibility of the AO to determine if the risk should be downgraded to a CAT II or a CAT III based on the risk assessment of the target environment.\n\nIf DoD PKI is not used but the network device uses an alternative FIPS 140-2 compliant, CMVP-validated OTP password solution, this requirement can be downgraded to a CAT III. \n\nJuniper devices fully support authorized alternatives such as the RSA SecureID and Yubico YubiKey OTP tokens.\n\nVerify the device is configured with template accounts and a RADIUS server.\n[edit system login]\n:\n:\nuser <account name> {\n\tuid 2015;\n\tclass <name>;\n}\n:\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\n[edit system radius-server]\n<RSA SecureID or Yubico YubiKey server address> {\n    secret \"...<hashed PSK>...\"; ## SECRET-DATA\n}\n\nNote: Other mitigation strategies that have not been evaluated by the DoD PUWG may include the use of one or more industry solutions. One-time password/PIN/passcodes (OTP), one-time URLs, time-based tokens, and biometrics are examples of such solutions. While AOs may choose to accept the risk of using these alternatives on a case-by-case basis, for DoD the risk of using these alternatives should never be mitigated below a CAT II.\n\nNote: This requirement is not applicable to the emergency account of last resort or for service accounts (noninteractive users). Examples of service accounts include remote service brokers such as AAA, syslog, etc.","fix":"Configure the Juniper EX switch to use DoD PKI MFA for interactive logins.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\n\nset system radius-server <RSA SecureID or Yubico YubiKey server address> secret \"<PSK>\"\n-or-\nprompt system radius-server <RSA SecureID or Yubico YubiKey server address> secret\nNew secret (secret): <PSK> \nRetype new secret (secret): <confirm PSK>\n\nNote: The PSK is not echoed to the screen."},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57354r843737_chk","severity":"high","gid":"V-253902","rid":"SV-253902r879590_rule","stig_id":"JUEX-NM-000250","gtitle":"SRG-APP-000149-NDM-000247","fix_id":"F-57305r843738_fix","documentable":null,"cci":["CCI-000765"],"nist":["IA-2 (1)"]}},{"id":"SV-253903","code":"control 'SV-253903' do\n  title 'The Juniper EX switch must be configured to implement replay-resistant authentication mechanisms for network access to privileged accounts.'\n  desc 'A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. \n\nTechniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.'\n  desc 'check', 'Determine if the network device implements replay-resistant authentication mechanisms for network access to privileged accounts. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server. \n\nVerify SSH version 2 is configured for network (remote) access to privileged accounts.\n[edit system services ssh]\nprotocol-version v2;\n\nIf the network device does not implement replay-resistant authentication mechanisms for network access to privileged accounts, this is a finding.'\n  desc 'fix', 'Configure the network device to implement replay-resistant authentication mechanisms for network access to privileged accounts.\n\nset system services ssh protocol-version v2'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57355r843740_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253903'\n  tag rid: 'SV-253903r879597_rule'\n  tag stig_id: 'JUEX-NM-000260'\n  tag gtitle: 'SRG-APP-000156-NDM-000250'\n  tag fix_id: 'F-57306r843741_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001941']\n  tag nist: ['IA-2 (8)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253903.rb"},"title":"The Juniper EX switch must be configured to implement replay-resistant authentication mechanisms for network access to privileged accounts.","desc":"A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. \n\nTechniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.","descriptions":{"default":"A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. \n\nTechniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.","check":"Determine if the network device implements replay-resistant authentication mechanisms for network access to privileged accounts. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server. \n\nVerify SSH version 2 is configured for network (remote) access to privileged accounts.\n[edit system services ssh]\nprotocol-version v2;\n\nIf the network device does not implement replay-resistant authentication mechanisms for network access to privileged accounts, this is a finding.","fix":"Configure the network device to implement replay-resistant authentication mechanisms for network access to privileged accounts.\n\nset system services ssh protocol-version v2"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57355r843740_chk","severity":"medium","gid":"V-253903","rid":"SV-253903r879597_rule","stig_id":"JUEX-NM-000260","gtitle":"SRG-APP-000156-NDM-000250","fix_id":"F-57306r843741_fix","documentable":null,"cci":["CCI-001941"],"nist":["IA-2 (8)"]}},{"id":"SV-253904","code":"control 'SV-253904' do\n  title 'The Juniper EX switch must be configured to enforce a minimum 15-character password length.'\n  desc 'Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password.\n\nThe shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.'\n  desc 'check', 'Determine if the network device or its associated authentication server enforces a minimum 15-character password length. This requirement may be verified by demonstration or configuration review. \n\n[edit system login password]\n:\nminimum-length 15;\n:\n\nIf the network device or its associated authentication server does not enforce a minimum 15-character password length, this is a finding.'\n  desc 'fix', 'Configure the network device or its associated authentication server to enforce a minimum 15-character password length.\n\nset system login password minimum-length 15'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57356r843743_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253904'\n  tag rid: 'SV-253904r879601_rule'\n  tag stig_id: 'JUEX-NM-000270'\n  tag gtitle: 'SRG-APP-000164-NDM-000252'\n  tag fix_id: 'F-57307r843744_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000205']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253904.rb"},"title":"The Juniper EX switch must be configured to enforce a minimum 15-character password length.","desc":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password.\n\nThe shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","descriptions":{"default":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password.\n\nThe shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","check":"Determine if the network device or its associated authentication server enforces a minimum 15-character password length. This requirement may be verified by demonstration or configuration review. \n\n[edit system login password]\n:\nminimum-length 15;\n:\n\nIf the network device or its associated authentication server does not enforce a minimum 15-character password length, this is a finding.","fix":"Configure the network device or its associated authentication server to enforce a minimum 15-character password length.\n\nset system login password minimum-length 15"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57356r843743_chk","severity":"medium","gid":"V-253904","rid":"SV-253904r879601_rule","stig_id":"JUEX-NM-000270","gtitle":"SRG-APP-000164-NDM-000252","fix_id":"F-57307r843744_fix","documentable":null,"cci":["CCI-000205"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-253905","code":"control 'SV-253905' do\n  title 'The Juniper EX switch must be configured to enforce password complexity by requiring that at least one uppercase character be used.'\n  desc 'Use of a complex passwords helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.'\n  desc 'check', 'Where passwords are used, confirm that the network device and associated authentication server enforces password complexity by requiring that at least one uppercase character be used. This requirement may be verified by demonstration, configuration review, or validated test results.\n\n[edit system login password]\n:\nminimum-uppercases 1;\n:\n\nIf the network device and associated authentication server does not require that at least one uppercase character be used in each password, this is a finding.'\n  desc 'fix', 'Configure the network device and associated authentication server to enforce password complexity by requiring that at least one uppercase character be used.\n\nset system login password minimum-uppercases 1'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57357r843746_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253905'\n  tag rid: 'SV-253905r879603_rule'\n  tag stig_id: 'JUEX-NM-000280'\n  tag gtitle: 'SRG-APP-000166-NDM-000254'\n  tag fix_id: 'F-57308r843747_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000192']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253905.rb"},"title":"The Juniper EX switch must be configured to enforce password complexity by requiring that at least one uppercase character be used.","desc":"Use of a complex passwords helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","descriptions":{"default":"Use of a complex passwords helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","check":"Where passwords are used, confirm that the network device and associated authentication server enforces password complexity by requiring that at least one uppercase character be used. This requirement may be verified by demonstration, configuration review, or validated test results.\n\n[edit system login password]\n:\nminimum-uppercases 1;\n:\n\nIf the network device and associated authentication server does not require that at least one uppercase character be used in each password, this is a finding.","fix":"Configure the network device and associated authentication server to enforce password complexity by requiring that at least one uppercase character be used.\n\nset system login password minimum-uppercases 1"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57357r843746_chk","severity":"medium","gid":"V-253905","rid":"SV-253905r879603_rule","stig_id":"JUEX-NM-000280","gtitle":"SRG-APP-000166-NDM-000254","fix_id":"F-57308r843747_fix","documentable":null,"cci":["CCI-000192"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-253906","code":"control 'SV-253906' do\n  title 'The Juniper EX switch must be configured to enforce password complexity by requiring that at least one lowercase character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.'\n  desc 'check', 'Where passwords are used, confirm that the network device and associated authentication server enforces password complexity by requiring that at least one lowercase character be used. This requirement may be verified by demonstration, configuration review, or validated test results.\n\n[edit system login password]\n:\nminimum-lowercases 1;\n:\n\nIf the network device and associated authentication server does not require that at least one lowercase character be used in each password, this is a finding.'\n  desc 'fix', 'Configure the network device and associated authentication server to enforce password complexity by requiring that at least one lowercase character be used.\n\nset system login password minimum-lowercases 1'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57358r843749_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253906'\n  tag rid: 'SV-253906r879604_rule'\n  tag stig_id: 'JUEX-NM-000290'\n  tag gtitle: 'SRG-APP-000167-NDM-000255'\n  tag fix_id: 'F-57309r843750_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000193']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253906.rb"},"title":"The Juniper EX switch must be configured to enforce password complexity by requiring that at least one lowercase character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","check":"Where passwords are used, confirm that the network device and associated authentication server enforces password complexity by requiring that at least one lowercase character be used. This requirement may be verified by demonstration, configuration review, or validated test results.\n\n[edit system login password]\n:\nminimum-lowercases 1;\n:\n\nIf the network device and associated authentication server does not require that at least one lowercase character be used in each password, this is a finding.","fix":"Configure the network device and associated authentication server to enforce password complexity by requiring that at least one lowercase character be used.\n\nset system login password minimum-lowercases 1"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57358r843749_chk","severity":"medium","gid":"V-253906","rid":"SV-253906r879604_rule","stig_id":"JUEX-NM-000290","gtitle":"SRG-APP-000167-NDM-000255","fix_id":"F-57309r843750_fix","documentable":null,"cci":["CCI-000193"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-253907","code":"control 'SV-253907' do\n  title 'The Juniper EX switch must be configured to enforce password complexity by requiring that at least one numeric character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.'\n  desc 'check', 'Where passwords are used, confirm that the network device and associated authentication server enforces password complexity by requiring that at least one numeric character be used. This requirement may be verified by demonstration, configuration review, or validated test results.\n\n[edit system login password]\n:\nminimum-numerics 1;\n:\n\nIf the network device and associated authentication server does not require that at least one numeric character be used in each password, this is a finding.'\n  desc 'fix', 'Configure the network device and associated authentication server to enforce password complexity by requiring that at least one numeric character be used.\n\nset system login password minimum-numerics 1'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57359r843752_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253907'\n  tag rid: 'SV-253907r879605_rule'\n  tag stig_id: 'JUEX-NM-000300'\n  tag gtitle: 'SRG-APP-000168-NDM-000256'\n  tag fix_id: 'F-57310r843753_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000194']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253907.rb"},"title":"The Juniper EX switch must be configured to enforce password complexity by requiring that at least one numeric character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","check":"Where passwords are used, confirm that the network device and associated authentication server enforces password complexity by requiring that at least one numeric character be used. This requirement may be verified by demonstration, configuration review, or validated test results.\n\n[edit system login password]\n:\nminimum-numerics 1;\n:\n\nIf the network device and associated authentication server does not require that at least one numeric character be used in each password, this is a finding.","fix":"Configure the network device and associated authentication server to enforce password complexity by requiring that at least one numeric character be used.\n\nset system login password minimum-numerics 1"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57359r843752_chk","severity":"medium","gid":"V-253907","rid":"SV-253907r879605_rule","stig_id":"JUEX-NM-000300","gtitle":"SRG-APP-000168-NDM-000256","fix_id":"F-57310r843753_fix","documentable":null,"cci":["CCI-000194"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-253908","code":"control 'SV-253908' do\n  title 'The Juniper EX switch must be configured to enforce password complexity by requiring that at least one punctuation (special) character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.'\n  desc 'check', 'Where passwords are used, confirm that the network device and associated authentication server enforces password complexity by requiring that at least one punctuation (special) character be used. This requirement may be verified by demonstration, configuration review, or validated test results.\n\n[edit system login password]\n:\nminimum-punctuations 1;\n:\n\nIf the network device and associated authentication server does not require that at least one special character be used in each password, this is a finding.'\n  desc 'fix', 'Configure the network device and associated authentication server to enforce password complexity by requiring that at least one punctuation (special) character be used. \n\nset system login password minimum-punctuations 1'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57360r843755_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253908'\n  tag rid: 'SV-253908r879606_rule'\n  tag stig_id: 'JUEX-NM-000310'\n  tag gtitle: 'SRG-APP-000169-NDM-000257'\n  tag fix_id: 'F-57311r843756_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001619']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253908.rb"},"title":"The Juniper EX switch must be configured to enforce password complexity by requiring that at least one punctuation (special) character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","check":"Where passwords are used, confirm that the network device and associated authentication server enforces password complexity by requiring that at least one punctuation (special) character be used. This requirement may be verified by demonstration, configuration review, or validated test results.\n\n[edit system login password]\n:\nminimum-punctuations 1;\n:\n\nIf the network device and associated authentication server does not require that at least one special character be used in each password, this is a finding.","fix":"Configure the network device and associated authentication server to enforce password complexity by requiring that at least one punctuation (special) character be used. \n\nset system login password minimum-punctuations 1"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57360r843755_chk","severity":"medium","gid":"V-253908","rid":"SV-253908r879606_rule","stig_id":"JUEX-NM-000310","gtitle":"SRG-APP-000169-NDM-000257","fix_id":"F-57311r843756_fix","documentable":null,"cci":["CCI-001619"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-253909","code":"control 'SV-253909' do\n  title 'The Juniper EX switch must be configured to require that when a password is changed, the characters are changed in at least eight of the positions within the password.'\n  desc 'If the application allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.'\n  desc 'check', 'Where passwords are used, confirm the characters are changed in at least eight of the positions within the password. This requirement may be verified by demonstration, configuration review, or validated test results.\n\n[edit system login password]\n:\nminimum-changes 8;\n:\n\nIf the network device and associated authentication server does not require that when a password is changed, the characters are changed in at least eight of the positions within the password, this is a finding.'\n  desc 'fix', 'Configure the network device and associated authentication server to require that when a password is changed, the characters are changed in at least eight of the positions within the password.\n\nset system login password minimum-changes 8'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57361r843758_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253909'\n  tag rid: 'SV-253909r879607_rule'\n  tag stig_id: 'JUEX-NM-000320'\n  tag gtitle: 'SRG-APP-000170-NDM-000329'\n  tag fix_id: 'F-57312r843759_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000195']\n  tag nist: ['IA-5 (1) (b)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253909.rb"},"title":"The Juniper EX switch must be configured to require that when a password is changed, the characters are changed in at least eight of the positions within the password.","desc":"If the application allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","descriptions":{"default":"If the application allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","check":"Where passwords are used, confirm the characters are changed in at least eight of the positions within the password. This requirement may be verified by demonstration, configuration review, or validated test results.\n\n[edit system login password]\n:\nminimum-changes 8;\n:\n\nIf the network device and associated authentication server does not require that when a password is changed, the characters are changed in at least eight of the positions within the password, this is a finding.","fix":"Configure the network device and associated authentication server to require that when a password is changed, the characters are changed in at least eight of the positions within the password.\n\nset system login password minimum-changes 8"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57361r843758_chk","severity":"medium","gid":"V-253909","rid":"SV-253909r879607_rule","stig_id":"JUEX-NM-000320","gtitle":"SRG-APP-000170-NDM-000329","fix_id":"F-57312r843759_fix","documentable":null,"cci":["CCI-000195"],"nist":["IA-5 (1) (b)"]}},{"id":"SV-253910","code":"control 'SV-253910' do\n  title 'The Juniper EX switch must be configured to only store cryptographic representations of passwords.'\n  desc 'Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.\n\nNetwork devices must enforce cryptographic representations of passwords when storing passwords in databases, configuration files, and log files. Passwords must be protected at all times; using a strong one-way hashing encryption algorithm with a salt is the standard method for providing a means to validate a password without having to store the actual password.\n\nPerformance and time required to access are factors that must be considered, and the one-way hash is the most feasible means of securing the password and providing an acceptable measure of password security. If passwords are stored in clear text, they can be plainly read and easily compromised.\n\nIn many instances, verifying the user knows a password is performed using a password verifier. In its simplest form, a password verifier is a computational function that is capable of creating a hash of a password and determining if the value provided by the user matches the stored hash.'\n  desc 'check', 'Review the network device’s files using a text editor or a database tool that allows viewing data stored in database tables. Determine if password strings are readable/discernable.\n \nDetermine if the network device, and any associated authentication servers, enforce only storing cryptographic representations of passwords. Verify that databases, configuration files, and log files have encrypted representations of all passwords, and that no password strings are readable/discernable. Potential locations include the local file system where configurations and events are stored, or in a network device related database table. Also identify if the network device uses the MD5 hashing algorithm to create password hashes.\n\nBy default, Junos uses SHA-512 as the password hashing algorithm to save only hashed representations of passwords. Verify the hashing algorithm at [edit system login password] format.\n\n[edit system login password]\n:\nformat sha512;\n\nIf the network device, or any associated authentication servers, stores unencrypted (clear text) representations of passwords, this is a finding.\n\nIf the network device uses MD5 hashing algorithm to create password hashes, this is a finding.'\n  desc 'fix', 'Configure the network device, and any associated authentication servers, to store all passwords using cryptographic representations.\n\nset system login password format <sha-256|sha-512>\nNote: Although Junos supports the SHA-1 hashing algorithm, it is included only for backwards compatibility when restoring a previous configuration from an older version.\n\nConfigure all associated databases, configuration files, and log files to use only encrypted representations of passwords, and that no password strings are readable/discernable.\n\nPotential locations include the local file system where configurations and events are stored, or in a network device-related database table.'\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57362r843761_chk'\n  tag severity: 'high'\n  tag gid: 'V-253910'\n  tag rid: 'SV-253910r879608_rule'\n  tag stig_id: 'JUEX-NM-000330'\n  tag gtitle: 'SRG-APP-000171-NDM-000258'\n  tag fix_id: 'F-57313r843762_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000196']\n  tag nist: ['IA-5 (1) (c)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253910.rb"},"title":"The Juniper EX switch must be configured to only store cryptographic representations of passwords.","desc":"Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.\n\nNetwork devices must enforce cryptographic representations of passwords when storing passwords in databases, configuration files, and log files. Passwords must be protected at all times; using a strong one-way hashing encryption algorithm with a salt is the standard method for providing a means to validate a password without having to store the actual password.\n\nPerformance and time required to access are factors that must be considered, and the one-way hash is the most feasible means of securing the password and providing an acceptable measure of password security. If passwords are stored in clear text, they can be plainly read and easily compromised.\n\nIn many instances, verifying the user knows a password is performed using a password verifier. In its simplest form, a password verifier is a computational function that is capable of creating a hash of a password and determining if the value provided by the user matches the stored hash.","descriptions":{"default":"Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.\n\nNetwork devices must enforce cryptographic representations of passwords when storing passwords in databases, configuration files, and log files. Passwords must be protected at all times; using a strong one-way hashing encryption algorithm with a salt is the standard method for providing a means to validate a password without having to store the actual password.\n\nPerformance and time required to access are factors that must be considered, and the one-way hash is the most feasible means of securing the password and providing an acceptable measure of password security. If passwords are stored in clear text, they can be plainly read and easily compromised.\n\nIn many instances, verifying the user knows a password is performed using a password verifier. In its simplest form, a password verifier is a computational function that is capable of creating a hash of a password and determining if the value provided by the user matches the stored hash.","check":"Review the network device’s files using a text editor or a database tool that allows viewing data stored in database tables. Determine if password strings are readable/discernable.\n \nDetermine if the network device, and any associated authentication servers, enforce only storing cryptographic representations of passwords. Verify that databases, configuration files, and log files have encrypted representations of all passwords, and that no password strings are readable/discernable. Potential locations include the local file system where configurations and events are stored, or in a network device related database table. Also identify if the network device uses the MD5 hashing algorithm to create password hashes.\n\nBy default, Junos uses SHA-512 as the password hashing algorithm to save only hashed representations of passwords. Verify the hashing algorithm at [edit system login password] format.\n\n[edit system login password]\n:\nformat sha512;\n\nIf the network device, or any associated authentication servers, stores unencrypted (clear text) representations of passwords, this is a finding.\n\nIf the network device uses MD5 hashing algorithm to create password hashes, this is a finding.","fix":"Configure the network device, and any associated authentication servers, to store all passwords using cryptographic representations.\n\nset system login password format <sha-256|sha-512>\nNote: Although Junos supports the SHA-1 hashing algorithm, it is included only for backwards compatibility when restoring a previous configuration from an older version.\n\nConfigure all associated databases, configuration files, and log files to use only encrypted representations of passwords, and that no password strings are readable/discernable.\n\nPotential locations include the local file system where configurations and events are stored, or in a network device-related database table."},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57362r843761_chk","severity":"high","gid":"V-253910","rid":"SV-253910r879608_rule","stig_id":"JUEX-NM-000330","gtitle":"SRG-APP-000171-NDM-000258","fix_id":"F-57313r843762_fix","documentable":null,"cci":["CCI-000196"],"nist":["IA-5 (1) (c)"]}},{"id":"SV-253911","code":"control 'SV-253911' do\n  title 'The Juniper EX switch must be configured to use FIPS 140-2 approved algorithms for authentication to a cryptographic module.'\n  desc 'Unapproved mechanisms that are used for authentication to the cryptographic module are not validated and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\nNetwork devices utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements. However, authentication algorithms must configure security processes to use only FIPS-approved and NIST-recommended authentication algorithms.'\n  desc 'check', 'Determine if the network device uses FIPS 140-2 approved algorithms for authentication to a cryptographic module. \n\nVerify the password format and SSH use approved algorithms. Verify the random number generator (RNG) is hmac-drbg, a FIPS approved RNG.\n\n[edit system]\nlogin {\n    password {\n        :\n        format <sha-256|sha-512>;\n    }\n}\nservices {\n    ssh {\n        :\n        ciphers [ aes256-ctr aes192-ctr aes128-ctr aes256-cbc aes192-cbc aes128-cbc ];\n        macs [ hmac-sha2-512 hmac-sha2-256 ];\n        key-exchange [ ecdh-sha2-nistp521 ecdh-sha2-nistp384 ecdh-sha2-nistp256 dh-group14-sha1 ];\n        :\n    }\n}\nrng {\n    hmac-drbg;\n}\n\nIf the network device is not configured to use a FIPS-approved authentication algorithm to a cryptographic module, this is a finding.'\n  desc 'fix', 'Configure the network device to use FIPS 140-2 approved algorithms for authentication to a cryptographic module.\n\nset system login password format <sha-256|sha-512>\nset system services ssh ciphers aes256-ctr\nset system services ssh ciphers aes192-ctr\nset system services ssh ciphers aes128-ctr\nset system services ssh ciphers aes256-cbc\nset system services ssh ciphers aes192-cbc\nset system services ssh ciphers aes128-cbc\nset system services ssh macs hmac-sha2-512\nset system services ssh macs hmac-sha2-256\nset system services ssh key-exchange ecdh-sha2-nistp521\nset system services ssh key-exchange ecdh-sha2-nistp384\nset system services ssh key-exchange ecdh-sha2-nistp256\nset system services ssh key-exchange dh-group14-sha1\nset system rng hmac-drbg'\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57363r843764_chk'\n  tag severity: 'high'\n  tag gid: 'V-253911'\n  tag rid: 'SV-253911r879616_rule'\n  tag stig_id: 'JUEX-NM-000340'\n  tag gtitle: 'SRG-APP-000179-NDM-000265'\n  tag fix_id: 'F-57314r843765_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000803']\n  tag nist: ['IA-7']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253911.rb"},"title":"The Juniper EX switch must be configured to use FIPS 140-2 approved algorithms for authentication to a cryptographic module.","desc":"Unapproved mechanisms that are used for authentication to the cryptographic module are not validated and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\nNetwork devices utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements. However, authentication algorithms must configure security processes to use only FIPS-approved and NIST-recommended authentication algorithms.","descriptions":{"default":"Unapproved mechanisms that are used for authentication to the cryptographic module are not validated and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\nNetwork devices utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements. However, authentication algorithms must configure security processes to use only FIPS-approved and NIST-recommended authentication algorithms.","check":"Determine if the network device uses FIPS 140-2 approved algorithms for authentication to a cryptographic module. \n\nVerify the password format and SSH use approved algorithms. Verify the random number generator (RNG) is hmac-drbg, a FIPS approved RNG.\n\n[edit system]\nlogin {\n    password {\n        :\n        format <sha-256|sha-512>;\n    }\n}\nservices {\n    ssh {\n        :\n        ciphers [ aes256-ctr aes192-ctr aes128-ctr aes256-cbc aes192-cbc aes128-cbc ];\n        macs [ hmac-sha2-512 hmac-sha2-256 ];\n        key-exchange [ ecdh-sha2-nistp521 ecdh-sha2-nistp384 ecdh-sha2-nistp256 dh-group14-sha1 ];\n        :\n    }\n}\nrng {\n    hmac-drbg;\n}\n\nIf the network device is not configured to use a FIPS-approved authentication algorithm to a cryptographic module, this is a finding.","fix":"Configure the network device to use FIPS 140-2 approved algorithms for authentication to a cryptographic module.\n\nset system login password format <sha-256|sha-512>\nset system services ssh ciphers aes256-ctr\nset system services ssh ciphers aes192-ctr\nset system services ssh ciphers aes128-ctr\nset system services ssh ciphers aes256-cbc\nset system services ssh ciphers aes192-cbc\nset system services ssh ciphers aes128-cbc\nset system services ssh macs hmac-sha2-512\nset system services ssh macs hmac-sha2-256\nset system services ssh key-exchange ecdh-sha2-nistp521\nset system services ssh key-exchange ecdh-sha2-nistp384\nset system services ssh key-exchange ecdh-sha2-nistp256\nset system services ssh key-exchange dh-group14-sha1\nset system rng hmac-drbg"},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57363r843764_chk","severity":"high","gid":"V-253911","rid":"SV-253911r879616_rule","stig_id":"JUEX-NM-000340","gtitle":"SRG-APP-000179-NDM-000265","fix_id":"F-57314r843765_fix","documentable":null,"cci":["CCI-000803"],"nist":["IA-7"]}},{"id":"SV-253912","code":"control 'SV-253912' do\n  title 'The Juniper EX switch must be configured to terminate all sessions and network connections when nonlocal device maintenance is completed.'\n  desc 'If a device management session or connection remains open after management is completed, it may be hijacked by an attacker and used to compromise or damage the network device.\n\nNonlocal device management and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. \n\nIn the event the remote node has abnormally terminated or an upstream link from the managed device is down, the management session will be terminated, thereby freeing device resources and eliminating any possibility of an unauthorized user being orphaned to an open idle session of the managed device.'\n  desc 'check', 'Determine if the network device terminates all sessions and network connections when nonlocal device maintenance is completed. This requirement may be verified by demonstration or validated test results. \n\nJunos permits the administrator to log out after completing nonlocal maintenance, which terminates the session and the network connection. Junos forcibly terminates the session and network connection if the idle-timeout value expires or when the permissible number of missed keepalive messages is reached. Verify the number of keepalive messages and the interval between messages is appropriate. For example, to forcibly disconnect a session after 30 seconds of lost connectivity:\n\n[edit system services ssh]\n:\nclient-alive-count-max 3;\nclient-alive-interval 10;\nNote: Administrator inactivity timeouts not shown because these are a separate check.\n\nIf the network device does not terminate all sessions and network connections when nonlocal device maintenance is complete, this is a finding.'\n  desc 'fix', 'Configure the network device to terminate all sessions and network connections when nonlocal device maintenance is completed.\n\nset system services ssh client-alive-count-max <0..255>\nset system services ssh client-alive-interval <0..65535 seconds>'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57364r843767_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253912'\n  tag rid: 'SV-253912r879621_rule'\n  tag stig_id: 'JUEX-NM-000350'\n  tag gtitle: 'SRG-APP-000186-NDM-000266'\n  tag fix_id: 'F-57315r843768_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000879']\n  tag nist: ['MA-4 e']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253912.rb"},"title":"The Juniper EX switch must be configured to terminate all sessions and network connections when nonlocal device maintenance is completed.","desc":"If a device management session or connection remains open after management is completed, it may be hijacked by an attacker and used to compromise or damage the network device.\n\nNonlocal device management and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. \n\nIn the event the remote node has abnormally terminated or an upstream link from the managed device is down, the management session will be terminated, thereby freeing device resources and eliminating any possibility of an unauthorized user being orphaned to an open idle session of the managed device.","descriptions":{"default":"If a device management session or connection remains open after management is completed, it may be hijacked by an attacker and used to compromise or damage the network device.\n\nNonlocal device management and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. \n\nIn the event the remote node has abnormally terminated or an upstream link from the managed device is down, the management session will be terminated, thereby freeing device resources and eliminating any possibility of an unauthorized user being orphaned to an open idle session of the managed device.","check":"Determine if the network device terminates all sessions and network connections when nonlocal device maintenance is completed. This requirement may be verified by demonstration or validated test results. \n\nJunos permits the administrator to log out after completing nonlocal maintenance, which terminates the session and the network connection. Junos forcibly terminates the session and network connection if the idle-timeout value expires or when the permissible number of missed keepalive messages is reached. Verify the number of keepalive messages and the interval between messages is appropriate. For example, to forcibly disconnect a session after 30 seconds of lost connectivity:\n\n[edit system services ssh]\n:\nclient-alive-count-max 3;\nclient-alive-interval 10;\nNote: Administrator inactivity timeouts not shown because these are a separate check.\n\nIf the network device does not terminate all sessions and network connections when nonlocal device maintenance is complete, this is a finding.","fix":"Configure the network device to terminate all sessions and network connections when nonlocal device maintenance is completed.\n\nset system services ssh client-alive-count-max <0..255>\nset system services ssh client-alive-interval <0..65535 seconds>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57364r843767_chk","severity":"medium","gid":"V-253912","rid":"SV-253912r879621_rule","stig_id":"JUEX-NM-000350","gtitle":"SRG-APP-000186-NDM-000266","fix_id":"F-57315r843768_fix","documentable":null,"cci":["CCI-000879"],"nist":["MA-4 e"]}},{"id":"SV-253913","code":"control 'SV-253913' do\n  title 'The Juniper EX switch must be configured to end all network connections associated with a device management session at the end of the session, or the session must be terminated after 10 minutes of inactivity except to fulfill mission requirements.'\n  desc 'Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. \n\nTerminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system-level network connection. This does not mean that the device terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.'\n  desc 'check', 'Determine if the network device terminates the connection associated with a device management session at the end of the session or after 10 minutes of inactivity. This requirement may be verified by demonstration or configuration review. \n\nJunos permits the administrator to log out at the end of the session, which terminates the session and the network connection. Junos forcibly terminates the session and network connection upon exceeding the inactivity timeout threshold. Verify the global idle-timeout is 10 minutes. Alternately, verify that each login class is configured for an idle-timeout of 10.\n[edit system login]\nidle-timeout 10;\nclass <name> {\n    idle-timeout 10; <<< Optional. If not configured, each login class inherits the global setting.\n}\n\nIf the network device does not terminate the connection associated with a device management session at the end of the session or after 10 minutes of inactivity, this is a finding.'\n  desc 'fix', 'Configure the network device to terminate the connection associated with a device management session at the end of the session or after 10 minutes of inactivity.\n\nset system login idle-timeout 10'\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57365r843770_chk'\n  tag severity: 'high'\n  tag gid: 'V-253913'\n  tag rid: 'SV-253913r879622_rule'\n  tag stig_id: 'JUEX-NM-000360'\n  tag gtitle: 'SRG-APP-000190-NDM-000267'\n  tag fix_id: 'F-57316r843771_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001133']\n  tag nist: ['SC-10']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253913.rb"},"title":"The Juniper EX switch must be configured to end all network connections associated with a device management session at the end of the session, or the session must be terminated after 10 minutes of inactivity except to fulfill mission requirements.","desc":"Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. \n\nTerminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system-level network connection. This does not mean that the device terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.","descriptions":{"default":"Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. \n\nTerminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system-level network connection. This does not mean that the device terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.","check":"Determine if the network device terminates the connection associated with a device management session at the end of the session or after 10 minutes of inactivity. This requirement may be verified by demonstration or configuration review. \n\nJunos permits the administrator to log out at the end of the session, which terminates the session and the network connection. Junos forcibly terminates the session and network connection upon exceeding the inactivity timeout threshold. Verify the global idle-timeout is 10 minutes. Alternately, verify that each login class is configured for an idle-timeout of 10.\n[edit system login]\nidle-timeout 10;\nclass <name> {\n    idle-timeout 10; <<< Optional. If not configured, each login class inherits the global setting.\n}\n\nIf the network device does not terminate the connection associated with a device management session at the end of the session or after 10 minutes of inactivity, this is a finding.","fix":"Configure the network device to terminate the connection associated with a device management session at the end of the session or after 10 minutes of inactivity.\n\nset system login idle-timeout 10"},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57365r843770_chk","severity":"high","gid":"V-253913","rid":"SV-253913r879622_rule","stig_id":"JUEX-NM-000360","gtitle":"SRG-APP-000190-NDM-000267","fix_id":"F-57316r843771_fix","documentable":null,"cci":["CCI-001133"],"nist":["SC-10"]}},{"id":"SV-253914","code":"control 'SV-253914' do\n  title 'The Juniper device must be configured to only allow authorized administrators to view or change the device configuration, system files, and other files stored either in the device or on removable media (such as a flash drive).'\n  desc 'This requirement is intended to address the confidentiality and integrity of system information at rest (e.g., network device rule sets) when it is located on a storage device within the network device or as a component of the network device. This protection is required to prevent unauthorized alteration, corruption, or disclosure of information when not stored directly on the network device.\n\nFiles on the network device or on removable media used by the device must have their permissions set to allow read or write access to those accounts that are specifically authorized to access or change them. Note that different administrative accounts or roles will have varying levels of access.\n\nFile permissions must be set so that only authorized administrators can read or change their contents. Whenever files are written to removable media and the media removed from the device, the media must be handled appropriately for the classification and sensitivity of the data stored on the device.'\n  desc 'check', 'The Junos operating system maintains file permissions for all files on the device and cannot be configured otherwise. Because Juniper digitally signs and used cryptographic hashes, modified system files (specifically binary files) will invalidate the signature/hash and will not be executed.\n\nThe Junos OS enforces the permissions assigned to each user to restrict access to system, configuration, and audit files via login classes.  Every account must be assigned a login class by an authorized administrator.  \n\nVerify each account is assigned a login class with appropriate permissions based on organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nVerify \"no-world-readable\" for archived log files.\n[edit system syslog]\narchive size <file size> files <number of files> no-world-readable;\n\nIf any files allow read or write access by accounts not specifically authorized access or by nonprivileged accounts, this is a finding.'\n  desc 'fix', \"Configure the device to enforce RBAC permissions so only authorized administrators can read or change file contents.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system syslog archive size <file size> files <number of files> no-world-readable\"\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57366r843773_chk'\n  tag severity: 'high'\n  tag gid: 'V-253914'\n  tag rid: 'SV-253914r879642_rule'\n  tag stig_id: 'JUEX-NM-000370'\n  tag gtitle: 'SRG-APP-000231-NDM-000271'\n  tag fix_id: 'F-57317r843774_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001199']\n  tag nist: ['SC-28']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253914.rb"},"title":"The Juniper device must be configured to only allow authorized administrators to view or change the device configuration, system files, and other files stored either in the device or on removable media (such as a flash drive).","desc":"This requirement is intended to address the confidentiality and integrity of system information at rest (e.g., network device rule sets) when it is located on a storage device within the network device or as a component of the network device. This protection is required to prevent unauthorized alteration, corruption, or disclosure of information when not stored directly on the network device.\n\nFiles on the network device or on removable media used by the device must have their permissions set to allow read or write access to those accounts that are specifically authorized to access or change them. Note that different administrative accounts or roles will have varying levels of access.\n\nFile permissions must be set so that only authorized administrators can read or change their contents. Whenever files are written to removable media and the media removed from the device, the media must be handled appropriately for the classification and sensitivity of the data stored on the device.","descriptions":{"default":"This requirement is intended to address the confidentiality and integrity of system information at rest (e.g., network device rule sets) when it is located on a storage device within the network device or as a component of the network device. This protection is required to prevent unauthorized alteration, corruption, or disclosure of information when not stored directly on the network device.\n\nFiles on the network device or on removable media used by the device must have their permissions set to allow read or write access to those accounts that are specifically authorized to access or change them. Note that different administrative accounts or roles will have varying levels of access.\n\nFile permissions must be set so that only authorized administrators can read or change their contents. Whenever files are written to removable media and the media removed from the device, the media must be handled appropriately for the classification and sensitivity of the data stored on the device.","check":"The Junos operating system maintains file permissions for all files on the device and cannot be configured otherwise. Because Juniper digitally signs and used cryptographic hashes, modified system files (specifically binary files) will invalidate the signature/hash and will not be executed.\n\nThe Junos OS enforces the permissions assigned to each user to restrict access to system, configuration, and audit files via login classes.  Every account must be assigned a login class by an authorized administrator.  \n\nVerify each account is assigned a login class with appropriate permissions based on organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nVerify \"no-world-readable\" for archived log files.\n[edit system syslog]\narchive size <file size> files <number of files> no-world-readable;\n\nIf any files allow read or write access by accounts not specifically authorized access or by nonprivileged accounts, this is a finding.","fix":"Configure the device to enforce RBAC permissions so only authorized administrators can read or change file contents.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system syslog archive size <file size> files <number of files> no-world-readable"},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57366r843773_chk","severity":"high","gid":"V-253914","rid":"SV-253914r879642_rule","stig_id":"JUEX-NM-000370","gtitle":"SRG-APP-000231-NDM-000271","fix_id":"F-57317r843774_fix","documentable":null,"cci":["CCI-001199"],"nist":["SC-28"]}},{"id":"SV-253915","code":"control 'SV-253915' do\n  title 'The Juniper EX switch must be configured to automatically audit account enabling actions.'\n  desc 'Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to simply enable a new or disabled account. Notification of account enabling is one method for mitigating this risk. A comprehensive account management process will ensure an audit trail which documents the creation of application user accounts and notifies administrators and Information System Security Officers (ISSO). Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes.'\n  desc 'check', 'Determine if the network device automatically audits account enabling actions. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (e.g., \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf account enabling actions are not automatically audited, this is a finding.'\n  desc 'fix', 'Configure the network device or its associated authentication server to automatically audit account enabling actions.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57367r843776_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253915'\n  tag rid: 'SV-253915r879696_rule'\n  tag stig_id: 'JUEX-NM-000380'\n  tag gtitle: 'SRG-APP-000319-NDM-000283'\n  tag fix_id: 'F-57318r843777_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002130']\n  tag nist: ['AC-2 (4)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253915.rb"},"title":"The Juniper EX switch must be configured to automatically audit account enabling actions.","desc":"Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to simply enable a new or disabled account. Notification of account enabling is one method for mitigating this risk. A comprehensive account management process will ensure an audit trail which documents the creation of application user accounts and notifies administrators and Information System Security Officers (ISSO). Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes.","descriptions":{"default":"Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to simply enable a new or disabled account. Notification of account enabling is one method for mitigating this risk. A comprehensive account management process will ensure an audit trail which documents the creation of application user accounts and notifies administrators and Information System Security Officers (ISSO). Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes.","check":"Determine if the network device automatically audits account enabling actions. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (e.g., \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf account enabling actions are not automatically audited, this is a finding.","fix":"Configure the network device or its associated authentication server to automatically audit account enabling actions.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57367r843776_chk","severity":"medium","gid":"V-253915","rid":"SV-253915r879696_rule","stig_id":"JUEX-NM-000380","gtitle":"SRG-APP-000319-NDM-000283","fix_id":"F-57318r843777_fix","documentable":null,"cci":["CCI-002130"],"nist":["AC-2 (4)"]}},{"id":"SV-253916","code":"control 'SV-253916' do\n  title 'The Juniper EX switch must be configured to enforce organization-defined role-based access control policies over defined subjects and objects.'\n  desc 'Organizations can create specific roles based on job functions and the authorizations (i.e., privileges) to perform needed operations on organizational information systems associated with the organization-defined roles. When administrators are assigned to the organizational roles, they inherit the authorizations or privileges defined for those roles. RBAC simplifies privilege administration for organizations because privileges are not assigned directly to every administrator (which can be a significant number of individuals for mid- to large-size organizations) but are instead acquired through role assignments. RBAC can be implemented either as a mandatory or discretionary form of access control.\n\nThe RBAC policies and the subjects and objects are defined uniquely for each network device, so they cannot be specified in the requirement.'\n  desc 'check', 'Determine if the network device enforces role-based access control policy over defined subjects and objects. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server. \n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf role-based access control policy is not enforced over defined subjects and objects, this is a finding.'\n  desc 'fix', \"Configure the network device or its associated authentication server to enforce role-based access control policy over defined subjects and objects.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57368r843779_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253916'\n  tag rid: 'SV-253916r879706_rule'\n  tag stig_id: 'JUEX-NM-000390'\n  tag gtitle: 'SRG-APP-000329-NDM-000287'\n  tag fix_id: 'F-57319r843780_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-002169']\n  tag nist: ['CM-6 b', 'AC-3 (7)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253916.rb"},"title":"The Juniper EX switch must be configured to enforce organization-defined role-based access control policies over defined subjects and objects.","desc":"Organizations can create specific roles based on job functions and the authorizations (i.e., privileges) to perform needed operations on organizational information systems associated with the organization-defined roles. When administrators are assigned to the organizational roles, they inherit the authorizations or privileges defined for those roles. RBAC simplifies privilege administration for organizations because privileges are not assigned directly to every administrator (which can be a significant number of individuals for mid- to large-size organizations) but are instead acquired through role assignments. RBAC can be implemented either as a mandatory or discretionary form of access control.\n\nThe RBAC policies and the subjects and objects are defined uniquely for each network device, so they cannot be specified in the requirement.","descriptions":{"default":"Organizations can create specific roles based on job functions and the authorizations (i.e., privileges) to perform needed operations on organizational information systems associated with the organization-defined roles. When administrators are assigned to the organizational roles, they inherit the authorizations or privileges defined for those roles. RBAC simplifies privilege administration for organizations because privileges are not assigned directly to every administrator (which can be a significant number of individuals for mid- to large-size organizations) but are instead acquired through role assignments. RBAC can be implemented either as a mandatory or discretionary form of access control.\n\nThe RBAC policies and the subjects and objects are defined uniquely for each network device, so they cannot be specified in the requirement.","check":"Determine if the network device enforces role-based access control policy over defined subjects and objects. This requirement may be verified by demonstration, configuration review, or validated test results. This requirement may be met through use of a properly configured authentication server if the device is configured to use the authentication server. \n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf role-based access control policy is not enforced over defined subjects and objects, this is a finding.","fix":"Configure the network device or its associated authentication server to enforce role-based access control policy over defined subjects and objects.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57368r843779_chk","severity":"medium","gid":"V-253916","rid":"SV-253916r879706_rule","stig_id":"JUEX-NM-000390","gtitle":"SRG-APP-000329-NDM-000287","fix_id":"F-57319r843780_fix","documentable":null,"cci":["CCI-000366","CCI-002169"],"nist":["CM-6 b","AC-3 (7)"]}},{"id":"SV-253917","code":"control 'SV-253917' do\n  title 'The Juniper EX switch must be configured to audit the execution of privileged functions.'\n  desc 'Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.'\n  desc 'check', 'Determine if the network device audits the execution of privileged functions. This requirement may be verified by demonstration, configuration review, or validated test results. \n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not audit the execution of privileged functions, this is a finding.'\n  desc 'fix', 'Configure the network device to audit the execution of privileged functions.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57369r843782_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253917'\n  tag rid: 'SV-253917r879720_rule'\n  tag stig_id: 'JUEX-NM-000400'\n  tag gtitle: 'SRG-APP-000343-NDM-000289'\n  tag fix_id: 'F-57320r843783_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002234']\n  tag nist: ['AC-6 (9)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253917.rb"},"title":"The Juniper EX switch must be configured to audit the execution of privileged functions.","desc":"Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.","descriptions":{"default":"Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.","check":"Determine if the network device audits the execution of privileged functions. This requirement may be verified by demonstration, configuration review, or validated test results. \n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not audit the execution of privileged functions, this is a finding.","fix":"Configure the network device to audit the execution of privileged functions.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57369r843782_chk","severity":"medium","gid":"V-253917","rid":"SV-253917r879720_rule","stig_id":"JUEX-NM-000400","gtitle":"SRG-APP-000343-NDM-000289","fix_id":"F-57320r843783_fix","documentable":null,"cci":["CCI-002234"],"nist":["AC-6 (9)"]}},{"id":"SV-253918","code":"control 'SV-253918' do\n  title 'The Juniper EX switch must be configured to allocate audit record storage capacity in accordance with organization-defined audit record storage requirements.'\n  desc 'To ensure network devices have a sufficient storage capacity in which to write the audit logs, they need to be able to allocate audit record storage capacity. The task of allocating audit record storage capacity is usually performed during initial device setup if it is modifiable. \n\nThe value for the organization-defined audit record storage requirement will depend on the amount of storage available on the network device, the anticipated volume of logs, the frequency of transfer from the network device to centralized log servers, and other factors.'\n  desc 'check', 'Determine if the network device allocates audit record storage capacity in accordance with organization-defined audit record storage requirements.\n\nThis requirement may be verified by configuration review or vendor-provided information. This requirement may be met through use of a properly configured syslog server if the device is configured to use the syslog server.\n\nJunos does not permit configuring audit logging storage space. However, the majority of disk space is reserved for local audit log storage and file are rotated using a first-in-first-out (FIFO) function.\nVerify external syslog servers are configured.\n[edit system syslog]\nhost <address 1> {\n    any info;\n}\nhost <address 2> {\n    any info;\n}\n\nIf audit record store capacity is not allocated in accordance with organization-defined audit record storage requirements, or the device is not configured to use external syslog server(s), this is a finding.'\n  desc 'fix', 'Configure the network device to allocate audit record storage capacity in accordance with organization-defined audit record storage requirements.\n\nConfigure external syslog server(s):\nset system syslog host <address 1> any info\nset system syslog host <address 2> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57370r843785_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253918'\n  tag rid: 'SV-253918r879730_rule'\n  tag stig_id: 'JUEX-NM-000410'\n  tag gtitle: 'SRG-APP-000357-NDM-000293'\n  tag fix_id: 'F-57321r843786_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001849']\n  tag nist: ['AU-4']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253918.rb"},"title":"The Juniper EX switch must be configured to allocate audit record storage capacity in accordance with organization-defined audit record storage requirements.","desc":"To ensure network devices have a sufficient storage capacity in which to write the audit logs, they need to be able to allocate audit record storage capacity. The task of allocating audit record storage capacity is usually performed during initial device setup if it is modifiable. \n\nThe value for the organization-defined audit record storage requirement will depend on the amount of storage available on the network device, the anticipated volume of logs, the frequency of transfer from the network device to centralized log servers, and other factors.","descriptions":{"default":"To ensure network devices have a sufficient storage capacity in which to write the audit logs, they need to be able to allocate audit record storage capacity. The task of allocating audit record storage capacity is usually performed during initial device setup if it is modifiable. \n\nThe value for the organization-defined audit record storage requirement will depend on the amount of storage available on the network device, the anticipated volume of logs, the frequency of transfer from the network device to centralized log servers, and other factors.","check":"Determine if the network device allocates audit record storage capacity in accordance with organization-defined audit record storage requirements.\n\nThis requirement may be verified by configuration review or vendor-provided information. This requirement may be met through use of a properly configured syslog server if the device is configured to use the syslog server.\n\nJunos does not permit configuring audit logging storage space. However, the majority of disk space is reserved for local audit log storage and file are rotated using a first-in-first-out (FIFO) function.\nVerify external syslog servers are configured.\n[edit system syslog]\nhost <address 1> {\n    any info;\n}\nhost <address 2> {\n    any info;\n}\n\nIf audit record store capacity is not allocated in accordance with organization-defined audit record storage requirements, or the device is not configured to use external syslog server(s), this is a finding.","fix":"Configure the network device to allocate audit record storage capacity in accordance with organization-defined audit record storage requirements.\n\nConfigure external syslog server(s):\nset system syslog host <address 1> any info\nset system syslog host <address 2> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57370r843785_chk","severity":"medium","gid":"V-253918","rid":"SV-253918r879730_rule","stig_id":"JUEX-NM-000410","gtitle":"SRG-APP-000357-NDM-000293","fix_id":"F-57321r843786_fix","documentable":null,"cci":["CCI-001849"],"nist":["AU-4"]}},{"id":"SV-253919","code":"control 'SV-253919' do\n  title 'The Juniper EX switch must be configured to generate an immediate real-time alert of all audit failure events requiring real-time alerts.'\n  desc 'It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected. \n\nAlerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).'\n  desc 'check', 'Determine if the network device generates an immediate alert of all audit failure events requiring real-time alerts.\n\nJuniper network devices support monitoring the audit log storage partition (/var), monitoring the SNMP health status, or both. On devices supporting disk partition monitoring, verify the audit log partition (/var) free space is configured appropriately for the environment. For example, to generate \"high disk usage\" alerts at 80 percent capacity (20 percent free), and \"full disk usage\" at 90 percent capacity (10 percent free):\n[edit chassis]\ndisk-partition /var {\n    level full {\n        free-space 10 percent;\n    }\n    level high {\n        free-space 20 percent;\n    }\n}\nNote: The configurable parameter is a percentage of free space remaining, not percentage used. \"High\" usage percent of remaining free space must be equal to, or greater than, the \"full\" usage percent of remaining free space.\n\nFor network devices supporting SNMP health monitoring, verify the rising and falling threshold values for monitored objects (e.g., CPU, memory, and disk storage usage). In the example below, any monitored object exceeding 75 percent usage will generate an alert. Another alert is generated when the usage falls below 74 percent. As configured in the example, Junos samples every 300 seconds. The falling threshold value must be less than the rising threshold value. Verify the thresholds are appropriate for the target environment.\n[edit snmp]\nhealth-monitor {\n    interval 300;\n    rising-threshold 75;\n    falling-threshold 74;\n}\nNote: Monitored objects generate an event the first time they cross a threshold, not at every sample interval.\n\nThis requirement may be verified by configuration review or validated test results.\n\nIf an immediate alert of all audit failure events requiring real-time alerts is not generated, this is a finding.'\n  desc 'fix', 'Configure the network device to generate an immediate real-time alert of all audit failure events requiring real-time alerts.\n\nset chassis disk-partition /var level full free-space <0..100>\nset chassis disk-partition /var level full free-space percent\nset chassis disk-partition /var level high free-space <0..100>\nset chassis disk-partition /var level high free-space percent\nNote: \"High\" disk free-space value must be equal to or greater than \"full\" free-space value.\n\nset snmp health-monitor interval <1..2147483647 seconds>\nset snmp health-monitor rising-threshold <1..100 percent>\nset snmp health-monitor falling-threshold <0..100 percent>\nNote: Falling threshold value must be less than the rising-threshold value or commit fails.'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57371r843788_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253919'\n  tag rid: 'SV-253919r879733_rule'\n  tag stig_id: 'JUEX-NM-000420'\n  tag gtitle: 'SRG-APP-000360-NDM-000295'\n  tag fix_id: 'F-57322r843789_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001858']\n  tag nist: ['AU-5 (2)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253919.rb"},"title":"The Juniper EX switch must be configured to generate an immediate real-time alert of all audit failure events requiring real-time alerts.","desc":"It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected. \n\nAlerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).","descriptions":{"default":"It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected. \n\nAlerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).","check":"Determine if the network device generates an immediate alert of all audit failure events requiring real-time alerts.\n\nJuniper network devices support monitoring the audit log storage partition (/var), monitoring the SNMP health status, or both. On devices supporting disk partition monitoring, verify the audit log partition (/var) free space is configured appropriately for the environment. For example, to generate \"high disk usage\" alerts at 80 percent capacity (20 percent free), and \"full disk usage\" at 90 percent capacity (10 percent free):\n[edit chassis]\ndisk-partition /var {\n    level full {\n        free-space 10 percent;\n    }\n    level high {\n        free-space 20 percent;\n    }\n}\nNote: The configurable parameter is a percentage of free space remaining, not percentage used. \"High\" usage percent of remaining free space must be equal to, or greater than, the \"full\" usage percent of remaining free space.\n\nFor network devices supporting SNMP health monitoring, verify the rising and falling threshold values for monitored objects (e.g., CPU, memory, and disk storage usage). In the example below, any monitored object exceeding 75 percent usage will generate an alert. Another alert is generated when the usage falls below 74 percent. As configured in the example, Junos samples every 300 seconds. The falling threshold value must be less than the rising threshold value. Verify the thresholds are appropriate for the target environment.\n[edit snmp]\nhealth-monitor {\n    interval 300;\n    rising-threshold 75;\n    falling-threshold 74;\n}\nNote: Monitored objects generate an event the first time they cross a threshold, not at every sample interval.\n\nThis requirement may be verified by configuration review or validated test results.\n\nIf an immediate alert of all audit failure events requiring real-time alerts is not generated, this is a finding.","fix":"Configure the network device to generate an immediate real-time alert of all audit failure events requiring real-time alerts.\n\nset chassis disk-partition /var level full free-space <0..100>\nset chassis disk-partition /var level full free-space percent\nset chassis disk-partition /var level high free-space <0..100>\nset chassis disk-partition /var level high free-space percent\nNote: \"High\" disk free-space value must be equal to or greater than \"full\" free-space value.\n\nset snmp health-monitor interval <1..2147483647 seconds>\nset snmp health-monitor rising-threshold <1..100 percent>\nset snmp health-monitor falling-threshold <0..100 percent>\nNote: Falling threshold value must be less than the rising-threshold value or commit fails."},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57371r843788_chk","severity":"medium","gid":"V-253919","rid":"SV-253919r879733_rule","stig_id":"JUEX-NM-000420","gtitle":"SRG-APP-000360-NDM-000295","fix_id":"F-57322r843789_fix","documentable":null,"cci":["CCI-001858"],"nist":["AU-5 (2)"]}},{"id":"SV-253920","code":"control 'SV-253920' do\n  title 'The Juniper EX switch must be configured to synchronize internal information system clocks using redundant authoritative time sources.'\n  desc 'The loss of connectivity to a particular authoritative time source will result in the loss of time synchronization (free-run mode) and increasingly inaccurate time stamps on audit events and other functions. \n\nMultiple time sources provide redundancy by including a secondary source. Time synchronization is usually a hierarchy; clients synchronize time to a local source while that source synchronizes its time to a more accurate source. The network device must utilize an authoritative time server and/or be configured to use redundant authoritative time sources. This requirement is related to the comparison done in CCI-001891.\n\nDoD-approved solutions consist of a combination of a primary and secondary time source using a combination or multiple instances of the following: A time server designated for the appropriate DoD network (NIPRNet/SIPRNet); United States Naval Observatory (USNO) time servers; and/or the Global Positioning System (GPS). The secondary time source must be located in a different geographic region than the primary time source.'\n  desc 'check', 'Determine if the network device is configured to synchronize internal information system clocks with the primary and secondary time sources.\n\nVerify the Network Time Protocol (NTP) configuration.\n[edit system ntp]\nauthentication-key 1 type sha256 value \"PSK\"; ## SECRET-DATA\nauthentication-key 2 type sha1 value \"PSK\"; ## SECRET-DATA\nserver <address 1> key 1 prefer; ## SECRET-DATA\nserver <address 2> key 2; ## SECRET-DATA\ntrusted-key [ 1 2 ];\nsource-address <lo0 or OOBM address>;\n\nIf the network device is not configured to  synchronize internal information system clocks with the primary and secondary time sources, this is a finding.'\n  desc 'fix', 'Configure the network device to synchronize internal information system clocks with the primary and secondary time sources.\n\nset system ntp authentication-key 1 type sha256\nset system ntp authentication-key 1 value \"PSK\"\nset system ntp authentication-key 2 type sha1\nset system ntp authentication-key 2 value \"PSK\"\nset system ntp server <address 1> key 1\nset system ntp server <address 1> prefer\nset system ntp server <address 2> key 2\nset system ntp trusted-key 1\nset system ntp trusted-key 2\nset system ntp source-address <lo0 or OOBM address>'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57372r843791_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253920'\n  tag rid: 'SV-253920r879746_rule'\n  tag stig_id: 'JUEX-NM-000430'\n  tag gtitle: 'SRG-APP-000373-NDM-000298'\n  tag fix_id: 'F-57323r843792_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-001893']\n  tag nist: ['CM-6 b', 'AU-8 (2)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253920.rb"},"title":"The Juniper EX switch must be configured to synchronize internal information system clocks using redundant authoritative time sources.","desc":"The loss of connectivity to a particular authoritative time source will result in the loss of time synchronization (free-run mode) and increasingly inaccurate time stamps on audit events and other functions. \n\nMultiple time sources provide redundancy by including a secondary source. Time synchronization is usually a hierarchy; clients synchronize time to a local source while that source synchronizes its time to a more accurate source. The network device must utilize an authoritative time server and/or be configured to use redundant authoritative time sources. This requirement is related to the comparison done in CCI-001891.\n\nDoD-approved solutions consist of a combination of a primary and secondary time source using a combination or multiple instances of the following: A time server designated for the appropriate DoD network (NIPRNet/SIPRNet); United States Naval Observatory (USNO) time servers; and/or the Global Positioning System (GPS). The secondary time source must be located in a different geographic region than the primary time source.","descriptions":{"default":"The loss of connectivity to a particular authoritative time source will result in the loss of time synchronization (free-run mode) and increasingly inaccurate time stamps on audit events and other functions. \n\nMultiple time sources provide redundancy by including a secondary source. Time synchronization is usually a hierarchy; clients synchronize time to a local source while that source synchronizes its time to a more accurate source. The network device must utilize an authoritative time server and/or be configured to use redundant authoritative time sources. This requirement is related to the comparison done in CCI-001891.\n\nDoD-approved solutions consist of a combination of a primary and secondary time source using a combination or multiple instances of the following: A time server designated for the appropriate DoD network (NIPRNet/SIPRNet); United States Naval Observatory (USNO) time servers; and/or the Global Positioning System (GPS). The secondary time source must be located in a different geographic region than the primary time source.","check":"Determine if the network device is configured to synchronize internal information system clocks with the primary and secondary time sources.\n\nVerify the Network Time Protocol (NTP) configuration.\n[edit system ntp]\nauthentication-key 1 type sha256 value \"PSK\"; ## SECRET-DATA\nauthentication-key 2 type sha1 value \"PSK\"; ## SECRET-DATA\nserver <address 1> key 1 prefer; ## SECRET-DATA\nserver <address 2> key 2; ## SECRET-DATA\ntrusted-key [ 1 2 ];\nsource-address <lo0 or OOBM address>;\n\nIf the network device is not configured to  synchronize internal information system clocks with the primary and secondary time sources, this is a finding.","fix":"Configure the network device to synchronize internal information system clocks with the primary and secondary time sources.\n\nset system ntp authentication-key 1 type sha256\nset system ntp authentication-key 1 value \"PSK\"\nset system ntp authentication-key 2 type sha1\nset system ntp authentication-key 2 value \"PSK\"\nset system ntp server <address 1> key 1\nset system ntp server <address 1> prefer\nset system ntp server <address 2> key 2\nset system ntp trusted-key 1\nset system ntp trusted-key 2\nset system ntp source-address <lo0 or OOBM address>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57372r843791_chk","severity":"medium","gid":"V-253920","rid":"SV-253920r879746_rule","stig_id":"JUEX-NM-000430","gtitle":"SRG-APP-000373-NDM-000298","fix_id":"F-57323r843792_fix","documentable":null,"cci":["CCI-000366","CCI-001893"],"nist":["CM-6 b","AU-8 (2)"]}},{"id":"SV-253921","code":"control 'SV-253921' do\n  title 'The Juniper EX switch must be configured to record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT).'\n  desc 'If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by the application include date and time. Time is commonly expressed in UTC, a modern continuation of GMT, or local time with an offset from UTC.'\n  desc 'check', 'Determine if the network device records time stamps for audit records that can be mapped to UTC or GMT. This requirement may be verified by demonstration or configuration review.\n\nVerify the time zone is UTC.\n[edit system]\ntime-zone UTC;\n\nIf the network device does not record time stamps for audit records that can be mapped to UTC or GMT, this is a finding.'\n  desc 'fix', 'Configure the network device to record time stamps for audit records that can be mapped to UTC or GMT.\n\nset system time-zone UTC'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57373r843794_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253921'\n  tag rid: 'SV-253921r879747_rule'\n  tag stig_id: 'JUEX-NM-000440'\n  tag gtitle: 'SRG-APP-000374-NDM-000299'\n  tag fix_id: 'F-57324r843795_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001890']\n  tag nist: ['AU-8 b']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253921.rb"},"title":"The Juniper EX switch must be configured to record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT).","desc":"If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by the application include date and time. Time is commonly expressed in UTC, a modern continuation of GMT, or local time with an offset from UTC.","descriptions":{"default":"If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by the application include date and time. Time is commonly expressed in UTC, a modern continuation of GMT, or local time with an offset from UTC.","check":"Determine if the network device records time stamps for audit records that can be mapped to UTC or GMT. This requirement may be verified by demonstration or configuration review.\n\nVerify the time zone is UTC.\n[edit system]\ntime-zone UTC;\n\nIf the network device does not record time stamps for audit records that can be mapped to UTC or GMT, this is a finding.","fix":"Configure the network device to record time stamps for audit records that can be mapped to UTC or GMT.\n\nset system time-zone UTC"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57373r843794_chk","severity":"medium","gid":"V-253921","rid":"SV-253921r879747_rule","stig_id":"JUEX-NM-000440","gtitle":"SRG-APP-000374-NDM-000299","fix_id":"F-57324r843795_fix","documentable":null,"cci":["CCI-001890"],"nist":["AU-8 b"]}},{"id":"SV-253922","code":"control 'SV-253922' do\n  title 'The Juniper EX switch must be configured to prohibit installation of software without explicit privileged status.'\n  desc 'Allowing anyone to install software, without explicit privileges, creates the risk that untested or potentially malicious software will be installed on the system. This requirement applies to code changes and upgrades for all network devices.'\n  desc 'check', 'Determine if the network device prohibits installation of software without explicit privileged status.  This requirement may be verified by demonstration or configuration review.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nInstallation of firmware requires the maintenance permission bit. However, even with that bit set, software installation can be limited by the \"deny-commands\" statement (e.g., deny-commands \"^request system software\"). The command takes a regular expression (REGEX) enclosed in double quotes (\").\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf installation of software is not prohibited without explicit privileged status, this is a finding.'\n  desc 'fix', \"Configure the network device to prohibit installation of software without explicit privileged status.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57374r843797_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253922'\n  tag rid: 'SV-253922r879751_rule'\n  tag stig_id: 'JUEX-NM-000450'\n  tag gtitle: 'SRG-APP-000378-NDM-000302'\n  tag fix_id: 'F-57325r843798_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001812']\n  tag nist: ['CM-11 (2)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253922.rb"},"title":"The Juniper EX switch must be configured to prohibit installation of software without explicit privileged status.","desc":"Allowing anyone to install software, without explicit privileges, creates the risk that untested or potentially malicious software will be installed on the system. This requirement applies to code changes and upgrades for all network devices.","descriptions":{"default":"Allowing anyone to install software, without explicit privileges, creates the risk that untested or potentially malicious software will be installed on the system. This requirement applies to code changes and upgrades for all network devices.","check":"Determine if the network device prohibits installation of software without explicit privileged status.  This requirement may be verified by demonstration or configuration review.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nInstallation of firmware requires the maintenance permission bit. However, even with that bit set, software installation can be limited by the \"deny-commands\" statement (e.g., deny-commands \"^request system software\"). The command takes a regular expression (REGEX) enclosed in double quotes (\").\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf installation of software is not prohibited without explicit privileged status, this is a finding.","fix":"Configure the network device to prohibit installation of software without explicit privileged status.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57374r843797_chk","severity":"medium","gid":"V-253922","rid":"SV-253922r879751_rule","stig_id":"JUEX-NM-000450","gtitle":"SRG-APP-000378-NDM-000302","fix_id":"F-57325r843798_fix","documentable":null,"cci":["CCI-001812"],"nist":["CM-11 (2)"]}},{"id":"SV-253923","code":"control 'SV-253923' do\n  title 'The Juniper EX switch must be configured to enforce access restrictions associated with changes to device configuration.'\n  desc 'Failure to provide logical access restrictions associated with changes to device configuration may have significant effects on the overall security of the system. \n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the device can potentially have significant effects on the overall security of the device. \n\nAccordingly, only qualified and authorized individuals should be allowed to obtain access to device components for the purposes of initiating changes, including upgrades and modifications. \n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).'\n  desc 'check', 'Determine if the network device enforces access restrictions associated with changes to device configuration.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nConfiguration changes require permissions sets appropriate for each stanza. For example, the \"system\" bit permits one to view [edit system] and the \"system-control\" bit permits editing (add, delete, modify).\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf the network device does not enforce such access restrictions, this is a finding.'\n  desc 'fix', \"Configure the network device to enforce access restrictions associated with changes to device configuration.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57375r843800_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253923'\n  tag rid: 'SV-253923r879753_rule'\n  tag stig_id: 'JUEX-NM-000460'\n  tag gtitle: 'SRG-APP-000380-NDM-000304'\n  tag fix_id: 'F-57326r843801_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001813']\n  tag nist: ['CM-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253923.rb"},"title":"The Juniper EX switch must be configured to enforce access restrictions associated with changes to device configuration.","desc":"Failure to provide logical access restrictions associated with changes to device configuration may have significant effects on the overall security of the system. \n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the device can potentially have significant effects on the overall security of the device. \n\nAccordingly, only qualified and authorized individuals should be allowed to obtain access to device components for the purposes of initiating changes, including upgrades and modifications. \n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","descriptions":{"default":"Failure to provide logical access restrictions associated with changes to device configuration may have significant effects on the overall security of the system. \n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the device can potentially have significant effects on the overall security of the device. \n\nAccordingly, only qualified and authorized individuals should be allowed to obtain access to device components for the purposes of initiating changes, including upgrades and modifications. \n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","check":"Determine if the network device enforces access restrictions associated with changes to device configuration.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nConfiguration changes require permissions sets appropriate for each stanza. For example, the \"system\" bit permits one to view [edit system] and the \"system-control\" bit permits editing (add, delete, modify).\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf the network device does not enforce such access restrictions, this is a finding.","fix":"Configure the network device to enforce access restrictions associated with changes to device configuration.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57375r843800_chk","severity":"medium","gid":"V-253923","rid":"SV-253923r879753_rule","stig_id":"JUEX-NM-000460","gtitle":"SRG-APP-000380-NDM-000304","fix_id":"F-57326r843801_fix","documentable":null,"cci":["CCI-001813"],"nist":["CM-5 (1) (a)"]}},{"id":"SV-253924","code":"control 'SV-253924' do\n  title 'The Juniper EX switch must be configured to audit the enforcement actions used to restrict access associated with changes to the device.'\n  desc 'Without auditing the enforcement of access restrictions against changes to the device configuration, it will be difficult to identify attempted attacks, and an audit trail will not be available for forensic investigation for after-the-fact actions. \n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. Enforcement action methods may be as simple as denying access to a file based on the application of file permissions (access restriction). Audit items may consist of lists of actions blocked by access restrictions or changes identified after the fact.'\n  desc 'check', 'Determine if the network device audits the enforcement actions used to restrict access associated with changes to the device. This requirement may be verified by demonstration, configuration review or validated test results.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not audit the enforcement actions used to restrict access associated with changes to the device, this is a finding.'\n  desc 'fix', 'Configure the network device to audit the enforcement actions used to restrict access associated with changes to the device.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57376r843803_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253924'\n  tag rid: 'SV-253924r879754_rule'\n  tag stig_id: 'JUEX-NM-000470'\n  tag gtitle: 'SRG-APP-000381-NDM-000305'\n  tag fix_id: 'F-57327r843804_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001814']\n  tag nist: ['CM-5 (1)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253924.rb"},"title":"The Juniper EX switch must be configured to audit the enforcement actions used to restrict access associated with changes to the device.","desc":"Without auditing the enforcement of access restrictions against changes to the device configuration, it will be difficult to identify attempted attacks, and an audit trail will not be available for forensic investigation for after-the-fact actions. \n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. Enforcement action methods may be as simple as denying access to a file based on the application of file permissions (access restriction). Audit items may consist of lists of actions blocked by access restrictions or changes identified after the fact.","descriptions":{"default":"Without auditing the enforcement of access restrictions against changes to the device configuration, it will be difficult to identify attempted attacks, and an audit trail will not be available for forensic investigation for after-the-fact actions. \n\nEnforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. Enforcement action methods may be as simple as denying access to a file based on the application of file permissions (access restriction). Audit items may consist of lists of actions blocked by access restrictions or changes identified after the fact.","check":"Determine if the network device audits the enforcement actions used to restrict access associated with changes to the device. This requirement may be verified by demonstration, configuration review or validated test results.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not audit the enforcement actions used to restrict access associated with changes to the device, this is a finding.","fix":"Configure the network device to audit the enforcement actions used to restrict access associated with changes to the device.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57376r843803_chk","severity":"medium","gid":"V-253924","rid":"SV-253924r879754_rule","stig_id":"JUEX-NM-000470","gtitle":"SRG-APP-000381-NDM-000305","fix_id":"F-57327r843804_fix","documentable":null,"cci":["CCI-001814"],"nist":["CM-5 (1)"]}},{"id":"SV-253925","code":"control 'SV-253925' do\n  title 'The Juniper EX switch must be configured to authenticate SNMP messages using a FIPS-validated Keyed-Hash Message Authentication Code (HMAC).'\n  desc 'Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.\n\nA local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, internet). A remote connection is any connection with a device communicating through an external network (e.g., the internet).\n\nBecause of the challenges of applying this requirement on a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability.'\n  desc 'check', 'Review the network device configuration to verify SNMP messages are authenticated using a FIPS-validated Keyed-Hash Message Authentication Code (HMAC).\n\nBy default, SNMP is disabled. If used, verify SNMPv3 is configured (minimally) for authentication-sha. Although HMAC-MD5-96 is supported as required by RFC, Junos also supports HMAC-SHA, HMAC-SHA224/256/384/512. Configure the strongest HMAC supported by both the Juniper device and the Network Management System (NMS). \n\n[edit snmp v3]\nusm {\n    local-engine {\n        user <SNMPv3 user> {\n            authentication-sha {\n                authentication-key \"$8$aes256-gcm$hmac-sha2-256$100$2CM/LosUGF4$A...<snip>...rflBKxq/w+jaAVF55Bsc6PA\"; ## SECRET-DATA\n            }\n        }\n    }\n}\n\nIf the network device is not configured to authenticate SNMP messages using a FIPS-validated HMAC, this is a finding.'\n  desc 'fix', 'Configure the network device to authenticate SNMP messages using a FIPS-validated Keyed-Hash Message Authentication Code (HMAC).\n\nset snmp v3 usm local-engine user <SNMPv3 username> authentication-sha authentication-password \"PSK\"'\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57377r843806_chk'\n  tag severity: 'high'\n  tag gid: 'V-253925'\n  tag rid: 'SV-253925r879768_rule'\n  tag stig_id: 'JUEX-NM-000480'\n  tag gtitle: 'SRG-APP-000395-NDM-000310'\n  tag fix_id: 'F-57328r843807_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001967']\n  tag nist: ['IA-3 (1)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253925.rb"},"title":"The Juniper EX switch must be configured to authenticate SNMP messages using a FIPS-validated Keyed-Hash Message Authentication Code (HMAC).","desc":"Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.\n\nA local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, internet). A remote connection is any connection with a device communicating through an external network (e.g., the internet).\n\nBecause of the challenges of applying this requirement on a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability.","descriptions":{"default":"Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.\n\nA local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, internet). A remote connection is any connection with a device communicating through an external network (e.g., the internet).\n\nBecause of the challenges of applying this requirement on a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability.","check":"Review the network device configuration to verify SNMP messages are authenticated using a FIPS-validated Keyed-Hash Message Authentication Code (HMAC).\n\nBy default, SNMP is disabled. If used, verify SNMPv3 is configured (minimally) for authentication-sha. Although HMAC-MD5-96 is supported as required by RFC, Junos also supports HMAC-SHA, HMAC-SHA224/256/384/512. Configure the strongest HMAC supported by both the Juniper device and the Network Management System (NMS). \n\n[edit snmp v3]\nusm {\n    local-engine {\n        user <SNMPv3 user> {\n            authentication-sha {\n                authentication-key \"$8$aes256-gcm$hmac-sha2-256$100$2CM/LosUGF4$A...<snip>...rflBKxq/w+jaAVF55Bsc6PA\"; ## SECRET-DATA\n            }\n        }\n    }\n}\n\nIf the network device is not configured to authenticate SNMP messages using a FIPS-validated HMAC, this is a finding.","fix":"Configure the network device to authenticate SNMP messages using a FIPS-validated Keyed-Hash Message Authentication Code (HMAC).\n\nset snmp v3 usm local-engine user <SNMPv3 username> authentication-sha authentication-password \"PSK\""},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57377r843806_chk","severity":"high","gid":"V-253925","rid":"SV-253925r879768_rule","stig_id":"JUEX-NM-000480","gtitle":"SRG-APP-000395-NDM-000310","fix_id":"F-57328r843807_fix","documentable":null,"cci":["CCI-001967"],"nist":["IA-3 (1)"]}},{"id":"SV-253926","code":"control 'SV-253926' do\n  title 'The Juniper EX switch must use an an NTP service that is hosted by a trusted source or a DOD-compliant enterprise or local NTP server.'\n  desc 'If a trusted time source is not used, an attacker can introduce a rogue NTP server. This rogue server can then be used to send incorrect time information to network devices, which will make log timestamps inaccurate which may hide attacks or result in inaccurate forensic analysis. \n\nThe recommended solution is that the application or endpoint is configured to point to an enterprise or site-owned time server that is DOD-compliant (instead of directly to an NTP source as implied by the current wording of the requirement). Most products are unable to meet the requirement, but DISA can mitigate the risk by using a trusted time source. So the requirement should state that NTPS is used with USNO NTP as an alternative mitigation for this to be marked as Not a Finding.\n\nMore information can be found at:\nhttps://www.cnmoc.usff.navy.mil/Our-Commands/United-States-Naval-Observatory/Precise-Time-Department/Network-Time-Protocol-NTP/DoD-Customer-Servers/\n\nDOD users should not use tick, tock, or ntp2. There are also instructions for obtaining authenticated NTP at the site listed above.'\n  desc 'check', 'Review the Juniper EX configuration to determine if it obtains time information from a trusted source.\n\n[edit system ntp]\nauthentication-key 1 type sha256 value \"PSK\"; ## SECRET-DATA\nauthentication-key 2 type sha1 value \"PSK\"; ## SECRET-DATA\nserver <address 1> key 1 prefer; ## SECRET-DATA\nserver <address 2> key 2; ## SECRET-DATA\ntrusted-key [ 1 2 ];\n\nIf the network device does not support FIPS-validated algorithms, verify the network device configuration to determine NTP endpoints are authenticated before establishing the local, remote, or network connection using cryptographically based algorithms.\n[edit system ntp]\nauthentication-key 3 type md5 value \"PSK\"; ## SECRET-DATA\nserver <address 3> key 3; ## SECRET-DATA\ntrusted-key [ 1 2 3 ];\n\nIf the Juniper EX switch is not configured to use an NTP service that is hosted by a trusted source or a DOD-compliant enterprise or local NTP server, this is a finding.'\n  desc 'fix', 'Configure the network device to authenticate Network Time Protocol sources using FIPS-validated algorithms.\n\nset system ntp authentication-key 1 type sha256\nset system ntp authentication-key 1 value \"PSK\"\nset system ntp authentication-key 2 type sha1\nset system ntp authentication-key 2 value \"PSK\"\nset system ntp server <address 1> key 1\nset system ntp server <address 1> prefer\nset system ntp server <address 2> key 2\nset system ntp trusted-key 1\nset system ntp trusted-key 2\n\nIf the network device does not support FIPS-validated algorithms, configure NTP authentication using cryptographically based algorithms.\nset system ntp authentication-key 3 type md5\nset system ntp authentication-key 3 value \"PSK\"\nset system ntp server <address 3> key 3\nset system ntp trusted-key 3'\n  impact 0.3\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57378r904441_chk'\n  tag severity: 'low'\n  tag gid: 'V-253926'\n  tag rid: 'SV-253926r904442_rule'\n  tag stig_id: 'JUEX-NM-000490'\n  tag gtitle: 'SRG-APP-000395-NDM-000347'\n  tag fix_id: 'F-57329r904417_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001967']\n  tag nist: ['IA-3 (1)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253926.rb"},"title":"The Juniper EX switch must use an an NTP service that is hosted by a trusted source or a DOD-compliant enterprise or local NTP server.","desc":"If a trusted time source is not used, an attacker can introduce a rogue NTP server. This rogue server can then be used to send incorrect time information to network devices, which will make log timestamps inaccurate which may hide attacks or result in inaccurate forensic analysis. \n\nThe recommended solution is that the application or endpoint is configured to point to an enterprise or site-owned time server that is DOD-compliant (instead of directly to an NTP source as implied by the current wording of the requirement). Most products are unable to meet the requirement, but DISA can mitigate the risk by using a trusted time source. So the requirement should state that NTPS is used with USNO NTP as an alternative mitigation for this to be marked as Not a Finding.\n\nMore information can be found at:\nhttps://www.cnmoc.usff.navy.mil/Our-Commands/United-States-Naval-Observatory/Precise-Time-Department/Network-Time-Protocol-NTP/DoD-Customer-Servers/\n\nDOD users should not use tick, tock, or ntp2. There are also instructions for obtaining authenticated NTP at the site listed above.","descriptions":{"default":"If a trusted time source is not used, an attacker can introduce a rogue NTP server. This rogue server can then be used to send incorrect time information to network devices, which will make log timestamps inaccurate which may hide attacks or result in inaccurate forensic analysis. \n\nThe recommended solution is that the application or endpoint is configured to point to an enterprise or site-owned time server that is DOD-compliant (instead of directly to an NTP source as implied by the current wording of the requirement). Most products are unable to meet the requirement, but DISA can mitigate the risk by using a trusted time source. So the requirement should state that NTPS is used with USNO NTP as an alternative mitigation for this to be marked as Not a Finding.\n\nMore information can be found at:\nhttps://www.cnmoc.usff.navy.mil/Our-Commands/United-States-Naval-Observatory/Precise-Time-Department/Network-Time-Protocol-NTP/DoD-Customer-Servers/\n\nDOD users should not use tick, tock, or ntp2. There are also instructions for obtaining authenticated NTP at the site listed above.","check":"Review the Juniper EX configuration to determine if it obtains time information from a trusted source.\n\n[edit system ntp]\nauthentication-key 1 type sha256 value \"PSK\"; ## SECRET-DATA\nauthentication-key 2 type sha1 value \"PSK\"; ## SECRET-DATA\nserver <address 1> key 1 prefer; ## SECRET-DATA\nserver <address 2> key 2; ## SECRET-DATA\ntrusted-key [ 1 2 ];\n\nIf the network device does not support FIPS-validated algorithms, verify the network device configuration to determine NTP endpoints are authenticated before establishing the local, remote, or network connection using cryptographically based algorithms.\n[edit system ntp]\nauthentication-key 3 type md5 value \"PSK\"; ## SECRET-DATA\nserver <address 3> key 3; ## SECRET-DATA\ntrusted-key [ 1 2 3 ];\n\nIf the Juniper EX switch is not configured to use an NTP service that is hosted by a trusted source or a DOD-compliant enterprise or local NTP server, this is a finding.","fix":"Configure the network device to authenticate Network Time Protocol sources using FIPS-validated algorithms.\n\nset system ntp authentication-key 1 type sha256\nset system ntp authentication-key 1 value \"PSK\"\nset system ntp authentication-key 2 type sha1\nset system ntp authentication-key 2 value \"PSK\"\nset system ntp server <address 1> key 1\nset system ntp server <address 1> prefer\nset system ntp server <address 2> key 2\nset system ntp trusted-key 1\nset system ntp trusted-key 2\n\nIf the network device does not support FIPS-validated algorithms, configure NTP authentication using cryptographically based algorithms.\nset system ntp authentication-key 3 type md5\nset system ntp authentication-key 3 value \"PSK\"\nset system ntp server <address 3> key 3\nset system ntp trusted-key 3"},"impact":0.3,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57378r904441_chk","severity":"low","gid":"V-253926","rid":"SV-253926r904442_rule","stig_id":"JUEX-NM-000490","gtitle":"SRG-APP-000395-NDM-000347","fix_id":"F-57329r904417_fix","documentable":null,"cci":["CCI-001967"],"nist":["IA-3 (1)"]}},{"id":"SV-253927","code":"control 'SV-253927' do\n  title 'The Juniper EX switch must be configured to prohibit the use of cached authenticators after an organization-defined time period.'\n  desc 'Some authentication implementations can be configured to use cached authenticators.\n\nIf cached authentication information is out-of-date, the validity of the authentication information may be questionable.\n\nThe organization-defined time period should be established for each device depending on the nature of the device; for example, a device with just a few administrators in a facility with spotty network connectivity may merit a longer caching time period than a device with many administrators.'\n  desc 'check', 'Review the network device configuration to determine if the network device or its associated authentication server prohibits the use of cached authenticators after an organization-defined time period.\n\nVerify idle-timeouts, SSH keepalive messages, and SSH rekey are configured to meet the requirements of the target network.\n[edit system]\nlogin {\n    idle-timeout 10;\n}\nsystem {\n    services {\n        ssh {\n            protocol-version v2;\n            client-alive-count-max (0..255);\n            client-alive-interval (0..65535 seconds);\n            rekey {\n                data-limit (51200..4294967295 bytes);\n                time-limit (1..1440 minutes);\n            }\n        }\n    }\n}\n\nFor externally authenticated accounts, verify the external authentication server enforces appropriate authenticator timeouts.\n\nIf cached authenticators are used after an organization-defined time period, this is a finding.'\n  desc 'fix', 'Configure the network device or its associated authentication server to prohibit the use of cached authenticators after an organization-defined time period.\n\nset system login idle-timeout 10\n\nset system services ssh protocol-version v2\nset system services ssh client-alive-count-max (0..255)\nset system services ssh client-alive-interval (0..65535 seconds)\nset system services ssh rekey data-limit (51200..4294967295 bytes)\nset system services ssh rekey time-limit (1..1440 minutes)'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57379r843812_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253927'\n  tag rid: 'SV-253927r879773_rule'\n  tag stig_id: 'JUEX-NM-000500'\n  tag gtitle: 'SRG-APP-000400-NDM-000313'\n  tag fix_id: 'F-57330r843813_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002007']\n  tag nist: ['IA-5 (13)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253927.rb"},"title":"The Juniper EX switch must be configured to prohibit the use of cached authenticators after an organization-defined time period.","desc":"Some authentication implementations can be configured to use cached authenticators.\n\nIf cached authentication information is out-of-date, the validity of the authentication information may be questionable.\n\nThe organization-defined time period should be established for each device depending on the nature of the device; for example, a device with just a few administrators in a facility with spotty network connectivity may merit a longer caching time period than a device with many administrators.","descriptions":{"default":"Some authentication implementations can be configured to use cached authenticators.\n\nIf cached authentication information is out-of-date, the validity of the authentication information may be questionable.\n\nThe organization-defined time period should be established for each device depending on the nature of the device; for example, a device with just a few administrators in a facility with spotty network connectivity may merit a longer caching time period than a device with many administrators.","check":"Review the network device configuration to determine if the network device or its associated authentication server prohibits the use of cached authenticators after an organization-defined time period.\n\nVerify idle-timeouts, SSH keepalive messages, and SSH rekey are configured to meet the requirements of the target network.\n[edit system]\nlogin {\n    idle-timeout 10;\n}\nsystem {\n    services {\n        ssh {\n            protocol-version v2;\n            client-alive-count-max (0..255);\n            client-alive-interval (0..65535 seconds);\n            rekey {\n                data-limit (51200..4294967295 bytes);\n                time-limit (1..1440 minutes);\n            }\n        }\n    }\n}\n\nFor externally authenticated accounts, verify the external authentication server enforces appropriate authenticator timeouts.\n\nIf cached authenticators are used after an organization-defined time period, this is a finding.","fix":"Configure the network device or its associated authentication server to prohibit the use of cached authenticators after an organization-defined time period.\n\nset system login idle-timeout 10\n\nset system services ssh protocol-version v2\nset system services ssh client-alive-count-max (0..255)\nset system services ssh client-alive-interval (0..65535 seconds)\nset system services ssh rekey data-limit (51200..4294967295 bytes)\nset system services ssh rekey time-limit (1..1440 minutes)"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57379r843812_chk","severity":"medium","gid":"V-253927","rid":"SV-253927r879773_rule","stig_id":"JUEX-NM-000500","gtitle":"SRG-APP-000400-NDM-000313","fix_id":"F-57330r843813_fix","documentable":null,"cci":["CCI-002007"],"nist":["IA-5 (13)"]}},{"id":"SV-253928","code":"control 'SV-253928' do\n  title 'The Juniper EX switches must be configured to use FIPS-validated Keyed-Hash Message Authentication Code (HMAC) to protect the integrity of nonlocal maintenance and diagnostic communications.'\n  desc 'Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. \n\nCurrently, HMAC is the only FIPS-approved algorithm for generating and verifying message/data authentication codes in accordance with FIPS 198-1. Products that are FIPS 140-2 validated will have an HMAC that meets specification; however, the option must be configured for use as the only message authentication code used for authentication to cryptographic modules.\n\nSeparate requirements for configuring applications and protocols used by each application (e.g., SNMPv3, SSHv2, HTTPS, and other protocols and applications that require server/client authentication) are required to implement this requirement. Where SSH is used, the SSHv2 protocol suite is required because it includes Layer 7 protocols such as SCP and SFTP, which can be used for secure file transfers.'\n  desc 'check', 'Verify the network device uses FIPS-validated HMAC to protect the integrity of nonlocal maintenance and diagnostic communications.\n\nIf using SNMPv3, verify (minimally) that authentication-sha is configured. Juniper devices also support authentication-sha224/256/384/512. Verify the strongest mutually supported HMAC between the network device and the Network Management Server (NMS) is configured.\n[edit system snmp]\nv3 {\n    usm {\n        local-engine {\n            user <SNMPv3 user> {\n                authentication-sha {\n                    authentication-key \"PSK\"; ## SECRET-DATA\n                }\n            }\n        }\n    }\n}\n\nVerify SSHv2 is configured for protocol V2 only, ciphers [ aes256-ctr aes192-ctr aes128-ctr aes256-cbc aes192-cbc aes128-cbc ], key-exchange [ ecdh-sha2-nistp521 ecdh-sha2-nistp384 ecdh-sha2-nistp256 ], and macs [ hmac-sha2-512 hmac-sha2-256 hmac-sha1 ].\n[edit system services ssh]\n:\nprotocol-version v2;\nciphers [ aes256-ctr aes192-ctr aes128-ctr aes256-cbc aes192-cbc aes128-cbc ];\nmacs [ hmac-sha2-512 hmac-sha2-256 hmac-sha1 ];\nkey-exchange [ ecdh-sha2-nistp521 ecdh-sha2-nistp384 ecdh-sha2-nistp256 ];\n\nIf the network device does not use FIPS-validated HMAC to protect the integrity of nonlocal maintenance and diagnostic communications, this is a finding.'\n  desc 'fix', 'Configure the network device to use FIPS-validated HMAC to protect the integrity of nonlocal maintenance and diagnostic communications.\n\nset snmp v3 usm local-engine user <SNMPv3 user> authentication-sha authentication-password \"PSK\"\nset snmp v3 usm local-engine user <SNMPv3 user> privacy-aes128 privacy-password \"PSK\"\nNote: Use the strongest HMAC mutually supported with the NMS (e.g., authentication-sha256, authentication-sha512)\n\nset system services ssh protocol-version v2\nset system services ssh ciphers aes256-ctr\nset system services ssh ciphers aes192-ctr\nset system services ssh ciphers aes128-ctr\nset system services ssh ciphers aes256-cbc\nset system services ssh ciphers aes192-cbc\nset system services ssh ciphers aes128-cbc\nset system services ssh macs hmac-sha2-512\nset system services ssh macs hmac-sha2-256\nset system services ssh macs hmac-sha1\nset system services ssh key-exchange ecdh-sha2-nistp521\nset system services ssh key-exchange ecdh-sha2-nistp384\nset system services ssh key-exchange ecdh-sha2-nistp256'\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57380r904419_chk'\n  tag severity: 'high'\n  tag gid: 'V-253928'\n  tag rid: 'SV-253928r904432_rule'\n  tag stig_id: 'JUEX-NM-000510'\n  tag gtitle: 'SRG-APP-000411-NDM-000330'\n  tag fix_id: 'F-57331r904420_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002890']\n  tag nist: ['MA-4 (6)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253928.rb"},"title":"The Juniper EX switches must be configured to use FIPS-validated Keyed-Hash Message Authentication Code (HMAC) to protect the integrity of nonlocal maintenance and diagnostic communications.","desc":"Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. \n\nCurrently, HMAC is the only FIPS-approved algorithm for generating and verifying message/data authentication codes in accordance with FIPS 198-1. Products that are FIPS 140-2 validated will have an HMAC that meets specification; however, the option must be configured for use as the only message authentication code used for authentication to cryptographic modules.\n\nSeparate requirements for configuring applications and protocols used by each application (e.g., SNMPv3, SSHv2, HTTPS, and other protocols and applications that require server/client authentication) are required to implement this requirement. Where SSH is used, the SSHv2 protocol suite is required because it includes Layer 7 protocols such as SCP and SFTP, which can be used for secure file transfers.","descriptions":{"default":"Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. \n\nCurrently, HMAC is the only FIPS-approved algorithm for generating and verifying message/data authentication codes in accordance with FIPS 198-1. Products that are FIPS 140-2 validated will have an HMAC that meets specification; however, the option must be configured for use as the only message authentication code used for authentication to cryptographic modules.\n\nSeparate requirements for configuring applications and protocols used by each application (e.g., SNMPv3, SSHv2, HTTPS, and other protocols and applications that require server/client authentication) are required to implement this requirement. Where SSH is used, the SSHv2 protocol suite is required because it includes Layer 7 protocols such as SCP and SFTP, which can be used for secure file transfers.","check":"Verify the network device uses FIPS-validated HMAC to protect the integrity of nonlocal maintenance and diagnostic communications.\n\nIf using SNMPv3, verify (minimally) that authentication-sha is configured. Juniper devices also support authentication-sha224/256/384/512. Verify the strongest mutually supported HMAC between the network device and the Network Management Server (NMS) is configured.\n[edit system snmp]\nv3 {\n    usm {\n        local-engine {\n            user <SNMPv3 user> {\n                authentication-sha {\n                    authentication-key \"PSK\"; ## SECRET-DATA\n                }\n            }\n        }\n    }\n}\n\nVerify SSHv2 is configured for protocol V2 only, ciphers [ aes256-ctr aes192-ctr aes128-ctr aes256-cbc aes192-cbc aes128-cbc ], key-exchange [ ecdh-sha2-nistp521 ecdh-sha2-nistp384 ecdh-sha2-nistp256 ], and macs [ hmac-sha2-512 hmac-sha2-256 hmac-sha1 ].\n[edit system services ssh]\n:\nprotocol-version v2;\nciphers [ aes256-ctr aes192-ctr aes128-ctr aes256-cbc aes192-cbc aes128-cbc ];\nmacs [ hmac-sha2-512 hmac-sha2-256 hmac-sha1 ];\nkey-exchange [ ecdh-sha2-nistp521 ecdh-sha2-nistp384 ecdh-sha2-nistp256 ];\n\nIf the network device does not use FIPS-validated HMAC to protect the integrity of nonlocal maintenance and diagnostic communications, this is a finding.","fix":"Configure the network device to use FIPS-validated HMAC to protect the integrity of nonlocal maintenance and diagnostic communications.\n\nset snmp v3 usm local-engine user <SNMPv3 user> authentication-sha authentication-password \"PSK\"\nset snmp v3 usm local-engine user <SNMPv3 user> privacy-aes128 privacy-password \"PSK\"\nNote: Use the strongest HMAC mutually supported with the NMS (e.g., authentication-sha256, authentication-sha512)\n\nset system services ssh protocol-version v2\nset system services ssh ciphers aes256-ctr\nset system services ssh ciphers aes192-ctr\nset system services ssh ciphers aes128-ctr\nset system services ssh ciphers aes256-cbc\nset system services ssh ciphers aes192-cbc\nset system services ssh ciphers aes128-cbc\nset system services ssh macs hmac-sha2-512\nset system services ssh macs hmac-sha2-256\nset system services ssh macs hmac-sha1\nset system services ssh key-exchange ecdh-sha2-nistp521\nset system services ssh key-exchange ecdh-sha2-nistp384\nset system services ssh key-exchange ecdh-sha2-nistp256"},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57380r904419_chk","severity":"high","gid":"V-253928","rid":"SV-253928r904432_rule","stig_id":"JUEX-NM-000510","gtitle":"SRG-APP-000411-NDM-000330","fix_id":"F-57331r904420_fix","documentable":null,"cci":["CCI-002890"],"nist":["MA-4 (6)"]}},{"id":"SV-253929","code":"control 'SV-253929' do\n  title 'The Juniper EX switch must be configured to implement cryptographic mechanisms using a FIPS 140-2 approved algorithm to protect the confidentiality of remote maintenance sessions.'\n  desc 'This requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP. If unsecured protocols (lacking cryptographic mechanisms) are used for sessions, the contents of those sessions will be susceptible to eavesdropping, potentially putting sensitive data (including administrator passwords) at risk of compromise and potentially allowing hijacking of maintenance sessions.'\n  desc 'check', 'Review the network device configuration to determine if cryptographic mechanisms are implemented using a FIPS 140-2 approved algorithm to protect the confidentiality of remote maintenance sessions.\n\nIf using SNMPv3, verify (minimally) that authentication-sha is configured. Juniper devices also support authentication-sha224/256/384/512. Verify the strongest mutually supported HMAC between the network device and the Network Management Server (NMS) is configured.\n[edit system snmp]\nv3 {\n    usm {\n        local-engine {\n            user <SNMPv3 user> {\n                authentication-sha {\n                    authentication-key \"PSK\"; ## SECRET-DATA\n                }\n            }\n        }\n    }\n}\n\nVerify SSHv2 is configured for protocol V2 only, ciphers [ aes256-ctr aes192-ctr aes128-ctr aes256-cbc aes192-cbc aes128-cbc ], key-exchange [ ecdh-sha2-nistp521 ecdh-sha2-nistp384 ecdh-sha2-nistp256 ], and macs [ hmac-sha2-512 hmac-sha2-256 hmac-sha1 ].\n[edit system services ssh]\n:\nprotocol-version v2;\nciphers [ aes256-ctr aes192-ctr aes128-ctr aes256-cbc aes192-cbc aes128-cbc ];\nmacs [ hmac-sha2-512 hmac-sha2-256 hmac-sha1 ];\nkey-exchange [ ecdh-sha2-nistp521 ecdh-sha2-nistp384 ecdh-sha2-nistp256 ];\n\nIf the network device is not configured to implement cryptographic mechanisms to protect the confidentiality of remote maintenance sessions using a FIPS 140-2 approved algorithm, this is a finding.'\n  desc 'fix', 'Configure the network device to implement cryptographic mechanisms to protect the confidentiality of remote maintenance sessions using a FIPS 140-2 approved algorithm.\n\nset snmp v3 usm local-engine user <SNMPv3 user> authentication-sha authentication-password \"PSK\"\nset snmp v3 usm local-engine user <SNMPv3 user> privacy-aes128 privacy-password \"PSK\"\nNote: Use the strongest HMAC mutually supported with the NMS (e.g., authentication-sha256, authentication-sha512)\n\nset system services ssh protocol-version v2\nset system services ssh ciphers aes256-ctr\nset system services ssh ciphers aes192-ctr\nset system services ssh ciphers aes128-ctr\nset system services ssh ciphers aes256-cbc\nset system services ssh ciphers aes192-cbc\nset system services ssh ciphers aes128-cbc\nset system services ssh macs hmac-sha2-512\nset system services ssh macs hmac-sha2-256\nset system services ssh macs hmac-sha1\nset system services ssh key-exchange ecdh-sha2-nistp521\nset system services ssh key-exchange ecdh-sha2-nistp384\nset system services ssh key-exchange ecdh-sha2-nistp256'\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57381r904422_chk'\n  tag severity: 'high'\n  tag gid: 'V-253929'\n  tag rid: 'SV-253929r904433_rule'\n  tag stig_id: 'JUEX-NM-000520'\n  tag gtitle: 'SRG-APP-000412-NDM-000331'\n  tag fix_id: 'F-57332r904423_fix'\n  tag 'documentable'\n  tag cci: ['CCI-003123']\n  tag nist: ['MA-4 (6)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253929.rb"},"title":"The Juniper EX switch must be configured to implement cryptographic mechanisms using a FIPS 140-2 approved algorithm to protect the confidentiality of remote maintenance sessions.","desc":"This requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP. If unsecured protocols (lacking cryptographic mechanisms) are used for sessions, the contents of those sessions will be susceptible to eavesdropping, potentially putting sensitive data (including administrator passwords) at risk of compromise and potentially allowing hijacking of maintenance sessions.","descriptions":{"default":"This requires the use of secure protocols instead of their unsecured counterparts, such as SSH instead of telnet, SCP instead of FTP, and HTTPS instead of HTTP. If unsecured protocols (lacking cryptographic mechanisms) are used for sessions, the contents of those sessions will be susceptible to eavesdropping, potentially putting sensitive data (including administrator passwords) at risk of compromise and potentially allowing hijacking of maintenance sessions.","check":"Review the network device configuration to determine if cryptographic mechanisms are implemented using a FIPS 140-2 approved algorithm to protect the confidentiality of remote maintenance sessions.\n\nIf using SNMPv3, verify (minimally) that authentication-sha is configured. Juniper devices also support authentication-sha224/256/384/512. Verify the strongest mutually supported HMAC between the network device and the Network Management Server (NMS) is configured.\n[edit system snmp]\nv3 {\n    usm {\n        local-engine {\n            user <SNMPv3 user> {\n                authentication-sha {\n                    authentication-key \"PSK\"; ## SECRET-DATA\n                }\n            }\n        }\n    }\n}\n\nVerify SSHv2 is configured for protocol V2 only, ciphers [ aes256-ctr aes192-ctr aes128-ctr aes256-cbc aes192-cbc aes128-cbc ], key-exchange [ ecdh-sha2-nistp521 ecdh-sha2-nistp384 ecdh-sha2-nistp256 ], and macs [ hmac-sha2-512 hmac-sha2-256 hmac-sha1 ].\n[edit system services ssh]\n:\nprotocol-version v2;\nciphers [ aes256-ctr aes192-ctr aes128-ctr aes256-cbc aes192-cbc aes128-cbc ];\nmacs [ hmac-sha2-512 hmac-sha2-256 hmac-sha1 ];\nkey-exchange [ ecdh-sha2-nistp521 ecdh-sha2-nistp384 ecdh-sha2-nistp256 ];\n\nIf the network device is not configured to implement cryptographic mechanisms to protect the confidentiality of remote maintenance sessions using a FIPS 140-2 approved algorithm, this is a finding.","fix":"Configure the network device to implement cryptographic mechanisms to protect the confidentiality of remote maintenance sessions using a FIPS 140-2 approved algorithm.\n\nset snmp v3 usm local-engine user <SNMPv3 user> authentication-sha authentication-password \"PSK\"\nset snmp v3 usm local-engine user <SNMPv3 user> privacy-aes128 privacy-password \"PSK\"\nNote: Use the strongest HMAC mutually supported with the NMS (e.g., authentication-sha256, authentication-sha512)\n\nset system services ssh protocol-version v2\nset system services ssh ciphers aes256-ctr\nset system services ssh ciphers aes192-ctr\nset system services ssh ciphers aes128-ctr\nset system services ssh ciphers aes256-cbc\nset system services ssh ciphers aes192-cbc\nset system services ssh ciphers aes128-cbc\nset system services ssh macs hmac-sha2-512\nset system services ssh macs hmac-sha2-256\nset system services ssh macs hmac-sha1\nset system services ssh key-exchange ecdh-sha2-nistp521\nset system services ssh key-exchange ecdh-sha2-nistp384\nset system services ssh key-exchange ecdh-sha2-nistp256"},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57381r904422_chk","severity":"high","gid":"V-253929","rid":"SV-253929r904433_rule","stig_id":"JUEX-NM-000520","gtitle":"SRG-APP-000412-NDM-000331","fix_id":"F-57332r904423_fix","documentable":null,"cci":["CCI-003123"],"nist":["MA-4 (6)"]}},{"id":"SV-253930","code":"control 'SV-253930' do\n  title 'The Juniper EX switch must be configured to protect against known types of denial-of-service (DoS) attacks by employing organization-defined security safeguards.'\n  desc 'DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nThis requirement addresses the configuration of network devices to mitigate the impact of DoS attacks that have occurred or are ongoing on device availability. For each network device, known and potential DoS attacks must be identified and solutions for each type implemented. A variety of technologies exist to limit or, in some cases, eliminate the effects of DoS attacks (e.g., limiting processes or restricting the number of sessions the device opens at one time). Employing increased capacity and bandwidth, combined with service redundancy, may reduce the susceptibility to some DoS attacks.\n\nThe security safeguards cannot be defined at the DoD-level because they vary according to the capabilities of the individual network devices and the security controls applied on the adjacent networks (for example, firewalls performing packet filtering to block DoS attacks).'\n  desc 'check', 'Determine if the network device protects against or limits the effects of all known types of DoS attacks by employing organization-defined security safeguards.\n\nVerify session and (if supported) rate limits for management connections.\nSSH example:\n[edit system services ssh]\nconnection-limit <1..250>;\nrate-limit <1..250>;\nNote: The SSH connection- and rate-limit directives affect secure file transfer protocols like SCP and SFTP.\n\nNETCONF over SSH example:\n[edit system services netconf]\nssh {\n    connection-limit <1..250>;\n    rate-limit <1..250>;\n}\nNote: Rate limiting is the permissible number of connections per one minute interval.\n\nVerify policers (rate limiters) are appropriately applied to limit traffic; for example, to limit SSH connection attempts:\n[edit firewall]\nfamily inet {\n    filter <filter name> {\n        term 1 {\n            from {\n                destination-address {\n                   <device OOBM or loopback address>;\n                }\n                source-prefix-list {\n                    <management address list name>;\n                }\n                protocol tcp;\n                destination-port 22;\n                tcp-initial;\n            }\n            then {\n                policer policer-32k;\n                syslog;\n                accept;\n            }\n        }\n        term 2 {\n            from {\n                destination-address {\n                   <device OOBM or loopback address>;\n                }\n                source-prefix-list {\n                    <management address list name>;\n                }\n                protocol tcp;\n                destination-port 22;\n            }\n            then {\n                syslog;\n                accept;\n            }\n        }\n        term default {\n            then {\n                syslog;\n                discard;\n            }\n        }\n    }\n}\nfamily inet6 {\n    filter <filter name-1> {\n        term 1 {\n            from {\n                destination-address {\n                   <device OOBM or loopback address>;\n                }\n                source-prefix-list {\n                    <management address list name-1>;\n                }\n                next-header tcp;\n                destination-port 22;\n                tcp-initial;\n            }\n            then {\n                policer policer-32k;\n                syslog;\n                accept;\n            }\n        }\n        term 2 {\n            from {\n                destination-address {\n                   <device OOBM or loopback address>;\n                }\n                source-prefix-list {\n                    <management address list name-1>;\n                }\n                next-header tcp;\n                destination-port 22;\n            }\n            then {\n                syslog;\n                accept;\n            }\n        }\n        term default {\n            then {\n                syslog;\n                discard;\n            }\n        }\n    }\n}\nNote: Additional terms will be required for other services like SNMP.\npolicer policer-32k {\n    if-exceeding {\n        bandwidth-limit 32k;\n        burst-size-limit 1500;\n    }\n    then discard;\n}\n\n[edit interfaces]\n<OOBM interface> {\n    unit 0 {\n        family inet {\n            filter {\n                input <filter name>;\n            }\n            address <IPv4 address>/<mask>;\n        }\n        family inet6 {\n            filter {\n                input <filter name-1>;\n            }\n            address <IPv6 address>/<prefix>;\n        }\n    }\n}\nNote: Although the example filter is shown applied to the management interface, the filter can be also be applied to the loopback interface. If applying to loopback, ensure the filter terms account for all traffic, services, and protocols that must reach the routing engine (e.g., OSPF, BGP, SNMP, etc.).\n\nIf the network device does not protect against or limit the effects of all known types of DoS attacks by employing organization-defined security safeguards, this is a finding.'\n  desc 'fix', 'Configure the network device to protect against or limit the effects of all known types of DoS attacks by employing organization-defined security safeguards.\n\nSSH example:\nset system services ssh connection-limit <1..250>\nset system services ssh rate-limit <1..250>\n\nNETCONF over SSH example:\nset system services netconf ssh connection-limit <1..250>\nset system services netconf ssh rate-limit <1..250>\n\nExample firewall filters:\nset firewall family inet filter <filter name> term 1 from destination-address <device OOBM or loopback address>\nset firewall family inet filter <filter name> term 1 from source-prefix-list <management address list name>\nset firewall family inet filter <filter name> term 1 from protocol tcp\nset firewall family inet filter <filter name> term 1 from destination-port 22\nset firewall family inet filter <filter name> term 1 from tcp-initial\nset firewall family inet filter <filter name> term 1 then policer policer-32k\nset firewall family inet filter <filter name> term 1 then syslog\nset firewall family inet filter <filter name> term 1 then accept\nset firewall family inet filter <filter name> term 2 from destination-address <device OOBM or loopback address>\nset firewall family inet filter <filter name> term 2 from source-prefix-list <management address list name>\nset firewall family inet filter <filter name> term 2 from protocol tcp\nset firewall family inet filter <filter name> term 2 from destination-port 22\nset firewall family inet filter <filter name> term 2 then syslog\nset firewall family inet filter <filter name> term 2 then accept\nset firewall family inet filter <filter name> term default then syslog\nset firewall family inet filter <filter name> term default then discard\nset firewall family inet6 filter <filter name-1> term 1 from destination-address <device OOBM or loopback address>\nset firewall family inet6 filter <filter name-1> term 1 from source-prefix-list <management address list name-1>\nset firewall family inet6 filter <filter name-1> term 1 from next-header tcp\nset firewall family inet6 filter <filter name-1> term 1 from destination-port 22\nset firewall family inet6 filter <filter name-1> term 1 from tcp-initial\nset firewall family inet6 filter <filter name-1> term 1 then policer policer-32k\nset firewall family inet6 filter <filter name-1> term 1 then syslog\nset firewall family inet6 filter <filter name-1> term 1 then accept\nset firewall family inet6 filter <filter name-1> term 2 from destination-address <device OOBM or loopback address>\nset firewall family inet6 filter <filter name-1> term 2 from source-prefix-list <management address list name-1>\nset firewall family inet6 filter <filter name-1> term 2 from next-header tcp\nset firewall family inet6 filter <filter name-1> term 2 from destination-port 22\nset firewall family inet6 filter <filter name-1> term 2 then syslog\nset firewall family inet6 filter <filter name-1> term 2 then accept\nset firewall family inet6 filter <filter name-1> term default then syslog\nset firewall family inet6 filter <filter name-1> term default then discard\n\nExample interface configuration:\nset interfaces <OOBM interface> unit 0 family inet filter input <filter name>\nset interfaces <OOBM interface> unit 0 family inet address <IPv4 address>/<mask>\nset interfaces <OOBM interface> unit 0 family inet6 filter input <filter name-1>\nset interfaces <OOBM interface> unit 0 family inet6 address <IPv6 address>/<prefix>'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57382r843821_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253930'\n  tag rid: 'SV-253930r879806_rule'\n  tag stig_id: 'JUEX-NM-000530'\n  tag gtitle: 'SRG-APP-000435-NDM-000315'\n  tag fix_id: 'F-57333r843822_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002385']\n  tag nist: ['SC-5 a']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253930.rb"},"title":"The Juniper EX switch must be configured to protect against known types of denial-of-service (DoS) attacks by employing organization-defined security safeguards.","desc":"DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nThis requirement addresses the configuration of network devices to mitigate the impact of DoS attacks that have occurred or are ongoing on device availability. For each network device, known and potential DoS attacks must be identified and solutions for each type implemented. A variety of technologies exist to limit or, in some cases, eliminate the effects of DoS attacks (e.g., limiting processes or restricting the number of sessions the device opens at one time). Employing increased capacity and bandwidth, combined with service redundancy, may reduce the susceptibility to some DoS attacks.\n\nThe security safeguards cannot be defined at the DoD-level because they vary according to the capabilities of the individual network devices and the security controls applied on the adjacent networks (for example, firewalls performing packet filtering to block DoS attacks).","descriptions":{"default":"DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nThis requirement addresses the configuration of network devices to mitigate the impact of DoS attacks that have occurred or are ongoing on device availability. For each network device, known and potential DoS attacks must be identified and solutions for each type implemented. A variety of technologies exist to limit or, in some cases, eliminate the effects of DoS attacks (e.g., limiting processes or restricting the number of sessions the device opens at one time). Employing increased capacity and bandwidth, combined with service redundancy, may reduce the susceptibility to some DoS attacks.\n\nThe security safeguards cannot be defined at the DoD-level because they vary according to the capabilities of the individual network devices and the security controls applied on the adjacent networks (for example, firewalls performing packet filtering to block DoS attacks).","check":"Determine if the network device protects against or limits the effects of all known types of DoS attacks by employing organization-defined security safeguards.\n\nVerify session and (if supported) rate limits for management connections.\nSSH example:\n[edit system services ssh]\nconnection-limit <1..250>;\nrate-limit <1..250>;\nNote: The SSH connection- and rate-limit directives affect secure file transfer protocols like SCP and SFTP.\n\nNETCONF over SSH example:\n[edit system services netconf]\nssh {\n    connection-limit <1..250>;\n    rate-limit <1..250>;\n}\nNote: Rate limiting is the permissible number of connections per one minute interval.\n\nVerify policers (rate limiters) are appropriately applied to limit traffic; for example, to limit SSH connection attempts:\n[edit firewall]\nfamily inet {\n    filter <filter name> {\n        term 1 {\n            from {\n                destination-address {\n                   <device OOBM or loopback address>;\n                }\n                source-prefix-list {\n                    <management address list name>;\n                }\n                protocol tcp;\n                destination-port 22;\n                tcp-initial;\n            }\n            then {\n                policer policer-32k;\n                syslog;\n                accept;\n            }\n        }\n        term 2 {\n            from {\n                destination-address {\n                   <device OOBM or loopback address>;\n                }\n                source-prefix-list {\n                    <management address list name>;\n                }\n                protocol tcp;\n                destination-port 22;\n            }\n            then {\n                syslog;\n                accept;\n            }\n        }\n        term default {\n            then {\n                syslog;\n                discard;\n            }\n        }\n    }\n}\nfamily inet6 {\n    filter <filter name-1> {\n        term 1 {\n            from {\n                destination-address {\n                   <device OOBM or loopback address>;\n                }\n                source-prefix-list {\n                    <management address list name-1>;\n                }\n                next-header tcp;\n                destination-port 22;\n                tcp-initial;\n            }\n            then {\n                policer policer-32k;\n                syslog;\n                accept;\n            }\n        }\n        term 2 {\n            from {\n                destination-address {\n                   <device OOBM or loopback address>;\n                }\n                source-prefix-list {\n                    <management address list name-1>;\n                }\n                next-header tcp;\n                destination-port 22;\n            }\n            then {\n                syslog;\n                accept;\n            }\n        }\n        term default {\n            then {\n                syslog;\n                discard;\n            }\n        }\n    }\n}\nNote: Additional terms will be required for other services like SNMP.\npolicer policer-32k {\n    if-exceeding {\n        bandwidth-limit 32k;\n        burst-size-limit 1500;\n    }\n    then discard;\n}\n\n[edit interfaces]\n<OOBM interface> {\n    unit 0 {\n        family inet {\n            filter {\n                input <filter name>;\n            }\n            address <IPv4 address>/<mask>;\n        }\n        family inet6 {\n            filter {\n                input <filter name-1>;\n            }\n            address <IPv6 address>/<prefix>;\n        }\n    }\n}\nNote: Although the example filter is shown applied to the management interface, the filter can be also be applied to the loopback interface. If applying to loopback, ensure the filter terms account for all traffic, services, and protocols that must reach the routing engine (e.g., OSPF, BGP, SNMP, etc.).\n\nIf the network device does not protect against or limit the effects of all known types of DoS attacks by employing organization-defined security safeguards, this is a finding.","fix":"Configure the network device to protect against or limit the effects of all known types of DoS attacks by employing organization-defined security safeguards.\n\nSSH example:\nset system services ssh connection-limit <1..250>\nset system services ssh rate-limit <1..250>\n\nNETCONF over SSH example:\nset system services netconf ssh connection-limit <1..250>\nset system services netconf ssh rate-limit <1..250>\n\nExample firewall filters:\nset firewall family inet filter <filter name> term 1 from destination-address <device OOBM or loopback address>\nset firewall family inet filter <filter name> term 1 from source-prefix-list <management address list name>\nset firewall family inet filter <filter name> term 1 from protocol tcp\nset firewall family inet filter <filter name> term 1 from destination-port 22\nset firewall family inet filter <filter name> term 1 from tcp-initial\nset firewall family inet filter <filter name> term 1 then policer policer-32k\nset firewall family inet filter <filter name> term 1 then syslog\nset firewall family inet filter <filter name> term 1 then accept\nset firewall family inet filter <filter name> term 2 from destination-address <device OOBM or loopback address>\nset firewall family inet filter <filter name> term 2 from source-prefix-list <management address list name>\nset firewall family inet filter <filter name> term 2 from protocol tcp\nset firewall family inet filter <filter name> term 2 from destination-port 22\nset firewall family inet filter <filter name> term 2 then syslog\nset firewall family inet filter <filter name> term 2 then accept\nset firewall family inet filter <filter name> term default then syslog\nset firewall family inet filter <filter name> term default then discard\nset firewall family inet6 filter <filter name-1> term 1 from destination-address <device OOBM or loopback address>\nset firewall family inet6 filter <filter name-1> term 1 from source-prefix-list <management address list name-1>\nset firewall family inet6 filter <filter name-1> term 1 from next-header tcp\nset firewall family inet6 filter <filter name-1> term 1 from destination-port 22\nset firewall family inet6 filter <filter name-1> term 1 from tcp-initial\nset firewall family inet6 filter <filter name-1> term 1 then policer policer-32k\nset firewall family inet6 filter <filter name-1> term 1 then syslog\nset firewall family inet6 filter <filter name-1> term 1 then accept\nset firewall family inet6 filter <filter name-1> term 2 from destination-address <device OOBM or loopback address>\nset firewall family inet6 filter <filter name-1> term 2 from source-prefix-list <management address list name-1>\nset firewall family inet6 filter <filter name-1> term 2 from next-header tcp\nset firewall family inet6 filter <filter name-1> term 2 from destination-port 22\nset firewall family inet6 filter <filter name-1> term 2 then syslog\nset firewall family inet6 filter <filter name-1> term 2 then accept\nset firewall family inet6 filter <filter name-1> term default then syslog\nset firewall family inet6 filter <filter name-1> term default then discard\n\nExample interface configuration:\nset interfaces <OOBM interface> unit 0 family inet filter input <filter name>\nset interfaces <OOBM interface> unit 0 family inet address <IPv4 address>/<mask>\nset interfaces <OOBM interface> unit 0 family inet6 filter input <filter name-1>\nset interfaces <OOBM interface> unit 0 family inet6 address <IPv6 address>/<prefix>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57382r843821_chk","severity":"medium","gid":"V-253930","rid":"SV-253930r879806_rule","stig_id":"JUEX-NM-000530","gtitle":"SRG-APP-000435-NDM-000315","fix_id":"F-57333r843822_fix","documentable":null,"cci":["CCI-002385"],"nist":["SC-5 a"]}},{"id":"SV-253931","code":"control 'SV-253931' do\n  title 'The Juniper EX switch must be configured to generate audit records when modifying administrator privileges.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).'\n  desc 'check', 'Determine if the network device generates audit records when modifying administrator privileges.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities e.g., \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records when modifying administrator privileges, this is a finding.'\n  desc 'fix', 'Configure the network device to generate audit records when modifying administrator privileges.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57383r843824_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253931'\n  tag rid: 'SV-253931r879866_rule'\n  tag stig_id: 'JUEX-NM-000540'\n  tag gtitle: 'SRG-APP-000495-NDM-000318'\n  tag fix_id: 'F-57334r843825_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253931.rb"},"title":"The Juniper EX switch must be configured to generate audit records when modifying administrator privileges.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","check":"Determine if the network device generates audit records when modifying administrator privileges.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities e.g., \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records when modifying administrator privileges, this is a finding.","fix":"Configure the network device to generate audit records when modifying administrator privileges.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57383r843824_chk","severity":"medium","gid":"V-253931","rid":"SV-253931r879866_rule","stig_id":"JUEX-NM-000540","gtitle":"SRG-APP-000495-NDM-000318","fix_id":"F-57334r843825_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-253932","code":"control 'SV-253932' do\n  title 'The Juniper EX switch must be configured to generate audit records when deleting administrator privileges.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).'\n  desc 'check', 'Determine if the network device generates audit records when deleting administrator privileges.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records when deleting administrator privileges, this is a finding.'\n  desc 'fix', 'Configure the network device to generate audit records when deleting administrator privileges.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57384r843827_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253932'\n  tag rid: 'SV-253932r879870_rule'\n  tag stig_id: 'JUEX-NM-000550'\n  tag gtitle: 'SRG-APP-000499-NDM-000319'\n  tag fix_id: 'F-57335r843828_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253932.rb"},"title":"The Juniper EX switch must be configured to generate audit records when deleting administrator privileges.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","check":"Determine if the network device generates audit records when deleting administrator privileges.\n\nVerify the system logs the facility \"any\", or minimally \"change-log\" and \"interactive-commands\", and the logging level is appropriate. Generally, the \"all\" (debug) logging level should be avoided because the number of logged messages is significant.\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    any info;\n}\nfile <file name> {\n    change-log info;\n    interactive-commands info;\n}\nNote: If minimally logging only configuration changes, there will be other files receiving the events from the other logging facilities (for example \"authorizations\" or \"firewall\").\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <IPv4 or IPv6 syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records when deleting administrator privileges, this is a finding.","fix":"Configure the network device to generate audit records when deleting administrator privileges.\n\nset system syslog host <IPv4 or IPv6 syslog address> change-log info\nset system syslog host <IPv4 or IPv6 syslog address> interactive-commands info\n-or-\nset system syslog host <IPv4 or IPv6 syslog address> any info\n\nset system syslog file <file name> change-log info\nset system syslog file <file name> interactive-commands info\n-or-\nset system syslog file <file name> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57384r843827_chk","severity":"medium","gid":"V-253932","rid":"SV-253932r879870_rule","stig_id":"JUEX-NM-000550","gtitle":"SRG-APP-000499-NDM-000319","fix_id":"F-57335r843828_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-253933","code":"control 'SV-253933' do\n  title 'The Juniper EX switch must be configured to generate audit records when successful/unsuccessful logon attempts occur.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).'\n  desc 'check', 'Determine if the network device generates audit records when successful/unsuccessful logon attempts occur.\n\nJunos logs all logon attempts via the \"authorization\" syslog facility (or facility \"any\"). Verify logging level \"any info\" or \"authorization info\" is configured.\n\n[edit system syslog]\nfile <file name> {\n    authorization info;\n}\nhost <external syslog address> {\n    any info;\n}\ntime-format year millisecond;\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <syslog address> {\n    authorization info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf it does not generate audit records when successful/unsuccessful logon attempts occur, this is a finding.'\n  desc 'fix', 'Configure the network device to generate audit records when successful/unsuccessful logon attempts occur.\n\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data << (Optional) Only if structured data format is required\nset system syslog host <external syslog address> authorization info\nset system syslog host <external syslog address> structured-data << (Optional) Only if structured data format is required\nset system syslog time-format <(year|millisecond)>'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57385r843830_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253933'\n  tag rid: 'SV-253933r879874_rule'\n  tag stig_id: 'JUEX-NM-000560'\n  tag gtitle: 'SRG-APP-000503-NDM-000320'\n  tag fix_id: 'F-57336r843831_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253933.rb"},"title":"The Juniper EX switch must be configured to generate audit records when successful/unsuccessful logon attempts occur.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","check":"Determine if the network device generates audit records when successful/unsuccessful logon attempts occur.\n\nJunos logs all logon attempts via the \"authorization\" syslog facility (or facility \"any\"). Verify logging level \"any info\" or \"authorization info\" is configured.\n\n[edit system syslog]\nfile <file name> {\n    authorization info;\n}\nhost <external syslog address> {\n    any info;\n}\ntime-format year millisecond;\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <syslog address> {\n    authorization info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf it does not generate audit records when successful/unsuccessful logon attempts occur, this is a finding.","fix":"Configure the network device to generate audit records when successful/unsuccessful logon attempts occur.\n\nset system syslog file <file name> any info\nset system syslog file <file name> structured-data << (Optional) Only if structured data format is required\nset system syslog host <external syslog address> authorization info\nset system syslog host <external syslog address> structured-data << (Optional) Only if structured data format is required\nset system syslog time-format <(year|millisecond)>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57385r843830_chk","severity":"medium","gid":"V-253933","rid":"SV-253933r879874_rule","stig_id":"JUEX-NM-000560","gtitle":"SRG-APP-000503-NDM-000320","fix_id":"F-57336r843831_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-253934","code":"control 'SV-253934' do\n  title 'The Juniper EX switch must be configured to generate audit records for privileged activities or other system-level access.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).'\n  desc 'check', 'Determine if the network device generates audit records for privileged activities or other system-level access.\n\nJunos logs all completed commands via the \"interactive-commands\" syslog facility and all configuration changes via \"change-log\". Successful and unsuccessful login attempts are logged using the \"authorization\" facility. Verify syslog is configured to capture these facilities using the logging level \"info\" or above. The lowest logging level, \"any\", is debug and will generate significant numbers of messages. The \"any\" logging facility (not to be confused with the severity level \"any\")  includes authorization, change-log, and interactive-commands.\n\nExample configuration to generate audit records for privileged activities or other system-level access.\n\n[edit system syslog]\nfile <file name> {\n    authorization info;\n    change-log info;\n    interactive-commands info;\n}\nhost <syslog address> {\n    any info;\n    explicit-priority;\n}\ntime-format year millisecond;\nNote: The time-format command supports including the year and/or the time in milliseconds (both shown for clarity). The default format does not include the year and time is recorded in seconds. \n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <syslog address> {\n    authorization info;\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records for privileged activities or other system-level access, this is a finding.'\n  desc 'fix', 'Configure the network device to generate audit records for privileged activities or other system-level access.\n\nset system syslog host <syslog address> any info\nset system syslog host <syslog address> explicit-priority\nset system syslog file <file name> any info\nset system syslog time-format year'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57386r843833_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253934'\n  tag rid: 'SV-253934r879875_rule'\n  tag stig_id: 'JUEX-NM-000570'\n  tag gtitle: 'SRG-APP-000504-NDM-000321'\n  tag fix_id: 'F-57337r843834_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253934.rb"},"title":"The Juniper EX switch must be configured to generate audit records for privileged activities or other system-level access.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","check":"Determine if the network device generates audit records for privileged activities or other system-level access.\n\nJunos logs all completed commands via the \"interactive-commands\" syslog facility and all configuration changes via \"change-log\". Successful and unsuccessful login attempts are logged using the \"authorization\" facility. Verify syslog is configured to capture these facilities using the logging level \"info\" or above. The lowest logging level, \"any\", is debug and will generate significant numbers of messages. The \"any\" logging facility (not to be confused with the severity level \"any\")  includes authorization, change-log, and interactive-commands.\n\nExample configuration to generate audit records for privileged activities or other system-level access.\n\n[edit system syslog]\nfile <file name> {\n    authorization info;\n    change-log info;\n    interactive-commands info;\n}\nhost <syslog address> {\n    any info;\n    explicit-priority;\n}\ntime-format year millisecond;\nNote: The time-format command supports including the year and/or the time in milliseconds (both shown for clarity). The default format does not include the year and time is recorded in seconds. \n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <syslog address> {\n    authorization info;\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records for privileged activities or other system-level access, this is a finding.","fix":"Configure the network device to generate audit records for privileged activities or other system-level access.\n\nset system syslog host <syslog address> any info\nset system syslog host <syslog address> explicit-priority\nset system syslog file <file name> any info\nset system syslog time-format year"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57386r843833_chk","severity":"medium","gid":"V-253934","rid":"SV-253934r879875_rule","stig_id":"JUEX-NM-000570","gtitle":"SRG-APP-000504-NDM-000321","fix_id":"F-57337r843834_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-253935","code":"control 'SV-253935' do\n  title 'The Juniper EX switch must be configured to generate audit records showing starting and ending time for administrator access to the system.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. \n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).'\n  desc 'check', 'Determine if the network device generates audit records showing starting and ending time for administrator access to the system.\n\nJunos logs all logon attempts via the \"authorization\" syslog facility. Verify logging level \"any info\" or \"authorization info\" is configured. Time stamps are created for every log entry, both successful and failed logon attempts, and logout.\n\n[edit system syslog]\nfile <file name> {\n    any info;\n}\nhost <external syslog address> {\n    any info;\n}\ntime-format year millisecond;\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records showing starting and ending time for administrator access to the system, this is a finding.'\n  desc 'fix', 'Configure the network device to generate audit records showing starting and ending time for administrator access to the system.\n\nset system syslog file <file name> any info\nset system syslog host <external syslog address> any info\nset system syslog time-format year'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57387r843836_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253935'\n  tag rid: 'SV-253935r879876_rule'\n  tag stig_id: 'JUEX-NM-000580'\n  tag gtitle: 'SRG-APP-000505-NDM-000322'\n  tag fix_id: 'F-57338r843837_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253935.rb"},"title":"The Juniper EX switch must be configured to generate audit records showing starting and ending time for administrator access to the system.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. \n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. \n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","check":"Determine if the network device generates audit records showing starting and ending time for administrator access to the system.\n\nJunos logs all logon attempts via the \"authorization\" syslog facility. Verify logging level \"any info\" or \"authorization info\" is configured. Time stamps are created for every log entry, both successful and failed logon attempts, and logout.\n\n[edit system syslog]\nfile <file name> {\n    any info;\n}\nhost <external syslog address> {\n    any info;\n}\ntime-format year millisecond;\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records showing starting and ending time for administrator access to the system, this is a finding.","fix":"Configure the network device to generate audit records showing starting and ending time for administrator access to the system.\n\nset system syslog file <file name> any info\nset system syslog host <external syslog address> any info\nset system syslog time-format year"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57387r843836_chk","severity":"medium","gid":"V-253935","rid":"SV-253935r879876_rule","stig_id":"JUEX-NM-000580","gtitle":"SRG-APP-000505-NDM-000322","fix_id":"F-57338r843837_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-253936","code":"control 'SV-253936' do\n  title 'The Juniper EX switch must be configured to generate audit records when concurrent logons from different workstations occur.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).'\n  desc 'check', 'Determine if the network device generates audit records when concurrent logons from different workstations occur.\n\nJunos logs all logon attempts via the \"authorization\" syslog facility. Verify logging level \"any info\" or \"authorization info\" is configured. Time stamps are created for every log entry, both successful and failed logon attempts, and logout.\n\n[edit system syslog]\nfile <file name> {\n    any info;\n}\nhost <external syslog address> {\n    any info;\n}\ntime-format year millisecond;\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records when concurrent logons from different workstations occur, this is a finding.'\n  desc 'fix', 'Configure the network device to generate audit records when concurrent logons from different workstations occur.\n\nset system syslog file <file name> any info\nset system syslog host <external syslog address> any info\nset system syslog time-format year'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57388r843839_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253936'\n  tag rid: 'SV-253936r879877_rule'\n  tag stig_id: 'JUEX-NM-000590'\n  tag gtitle: 'SRG-APP-000506-NDM-000323'\n  tag fix_id: 'F-57339r843840_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253936.rb"},"title":"The Juniper EX switch must be configured to generate audit records when concurrent logons from different workstations occur.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the network device (e.g., module or policy filter).","check":"Determine if the network device generates audit records when concurrent logons from different workstations occur.\n\nJunos logs all logon attempts via the \"authorization\" syslog facility. Verify logging level \"any info\" or \"authorization info\" is configured. Time stamps are created for every log entry, both successful and failed logon attempts, and logout.\n\n[edit system syslog]\nfile <file name> {\n    any info;\n}\nhost <external syslog address> {\n    any info;\n}\ntime-format year millisecond;\n\nSyslog outputs in standard format unless the \"structured-data\" directive is configured. Verify the \"structured-data\" command for all files and external syslog servers requiring that format. For example:\n\n[edit system syslog]\nhost <syslog address> {\n    change-log info;\n    interactive-commands info;\n    structured-data;\n}\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the network device does not generate audit records when concurrent logons from different workstations occur, this is a finding.","fix":"Configure the network device to generate audit records when concurrent logons from different workstations occur.\n\nset system syslog file <file name> any info\nset system syslog host <external syslog address> any info\nset system syslog time-format year"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57388r843839_chk","severity":"medium","gid":"V-253936","rid":"SV-253936r879877_rule","stig_id":"JUEX-NM-000590","gtitle":"SRG-APP-000506-NDM-000323","fix_id":"F-57339r843840_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-253937","code":"control 'SV-253937' do\n  title 'The Juniper EX switch must be configured to offload audit records onto a different system or media than the system being audited.'\n  desc 'Information stored in one location is vulnerable to accidental or incidental deletion or alteration.\n\nOffloading is a common process in information systems with limited audit storage capacity.'\n  desc 'check', 'Check the network device configuration to determine if the device offloads audit records onto a different system or media than the system being audited.\n\nVerify the device is configured to send system events to external syslog. If the organization has a centralized repository (or repositories) for secure transfer of audit log files, verify each log file is configured to transfer files to the appropriate repository. Each log file must be configured separately.\n\n[edit system syslog]\nfile <file name> {\n    any info;\n    archive size <65536..1073741824 bytes> files <1..1000> transfer-interval <5..2880 minutes> start-time \"<yyyy-mm-dd.hh:mm>\" archive-sites {\n\"URL\" password \"hashed PSK\" } ## SECRET-DATA\n}\nNote: The  URL format is: <scp|sftp>://<username>@<address>/<path>. The trailing slash is omitted because Junos automatically adds that when it appends the filename.\nhost <external syslog address> {\n    any info;\n}\nNote: If using secure file transfer to offload log files, the Juniper device will immediately attempt to connect with the configured protocol, address, and credentials. If successful, Junos will prompt to accept an untrusted public key. If the administrator accepts that key, Junos adds it to [edit security ssh-known-hosts]. Alternately, configure the trusted public key at [edit security ssh-known-hosts] before configuring automatic file offload.\n\nIf the device does not offload audit records onto a different system or media, this is a finding.'\n  desc 'fix', 'Configure the network device to offload audit records onto a different system or media than the system being audited.\n\nset file <file name> any info\nset system syslog file <file name> any info\nset system syslog file <file name> archive size <65536..1073741824 bytes>\nset system syslog file <file name> archive files <1..1000>\nset system syslog file <file name> archive transfer-interval <5..2880 minutes>\nset system syslog file <file name> archive start-time \"<yyyy-mm-dd.hh:mm>\"\nset system syslog file <file name> archive archive-sites \"<scp|sftp>://<username>@<repository address>/<path without trailing slash (/)>\" password \"<PSK>\"\nset system syslog host <external syslog address> any info'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57389r846818_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253937'\n  tag rid: 'SV-253937r879886_rule'\n  tag stig_id: 'JUEX-NM-000600'\n  tag gtitle: 'SRG-APP-000515-NDM-000325'\n  tag fix_id: 'F-57340r846820_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253937.rb"},"title":"The Juniper EX switch must be configured to offload audit records onto a different system or media than the system being audited.","desc":"Information stored in one location is vulnerable to accidental or incidental deletion or alteration.\n\nOffloading is a common process in information systems with limited audit storage capacity.","descriptions":{"default":"Information stored in one location is vulnerable to accidental or incidental deletion or alteration.\n\nOffloading is a common process in information systems with limited audit storage capacity.","check":"Check the network device configuration to determine if the device offloads audit records onto a different system or media than the system being audited.\n\nVerify the device is configured to send system events to external syslog. If the organization has a centralized repository (or repositories) for secure transfer of audit log files, verify each log file is configured to transfer files to the appropriate repository. Each log file must be configured separately.\n\n[edit system syslog]\nfile <file name> {\n    any info;\n    archive size <65536..1073741824 bytes> files <1..1000> transfer-interval <5..2880 minutes> start-time \"<yyyy-mm-dd.hh:mm>\" archive-sites {\n\"URL\" password \"hashed PSK\" } ## SECRET-DATA\n}\nNote: The  URL format is: <scp|sftp>://<username>@<address>/<path>. The trailing slash is omitted because Junos automatically adds that when it appends the filename.\nhost <external syslog address> {\n    any info;\n}\nNote: If using secure file transfer to offload log files, the Juniper device will immediately attempt to connect with the configured protocol, address, and credentials. If successful, Junos will prompt to accept an untrusted public key. If the administrator accepts that key, Junos adds it to [edit security ssh-known-hosts]. Alternately, configure the trusted public key at [edit security ssh-known-hosts] before configuring automatic file offload.\n\nIf the device does not offload audit records onto a different system or media, this is a finding.","fix":"Configure the network device to offload audit records onto a different system or media than the system being audited.\n\nset file <file name> any info\nset system syslog file <file name> any info\nset system syslog file <file name> archive size <65536..1073741824 bytes>\nset system syslog file <file name> archive files <1..1000>\nset system syslog file <file name> archive transfer-interval <5..2880 minutes>\nset system syslog file <file name> archive start-time \"<yyyy-mm-dd.hh:mm>\"\nset system syslog file <file name> archive archive-sites \"<scp|sftp>://<username>@<repository address>/<path without trailing slash (/)>\" password \"<PSK>\"\nset system syslog host <external syslog address> any info"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57389r846818_chk","severity":"medium","gid":"V-253937","rid":"SV-253937r879886_rule","stig_id":"JUEX-NM-000600","gtitle":"SRG-APP-000515-NDM-000325","fix_id":"F-57340r846820_fix","documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}},{"id":"SV-253938","code":"control 'SV-253938' do\n  title 'The Juniper EX switch must be configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.'\n  desc 'Configuring the network device to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed that affect the security posture and/or functionality of the network device. Security-related parameters are those parameters impacting the security state of the network device, including the parameters required to satisfy other security control requirements.'\n  desc 'check', 'Determine if the network device is configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.\n\nVerify the configuration implements security configuration or implementation guidance using the \"show\" commands. For example, to review the entire configuration, use \"show configuration\" from operational mode. If in configuration mode, executing the \"show\" command will show the configuration of the current hierarchy level. \n\nIf it is not configured in accordance with the designated security configuration settings, this is a finding.'\n  desc 'fix', 'Configure the network device to be configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.\n\nTo enable a function or set its configurable parameters, use the \"set\" command. To disable a function or its configuration parameters, use the \"deactivate\" or \"delete\" commands.'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57390r843845_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253938'\n  tag rid: 'SV-253938r879887_rule'\n  tag stig_id: 'JUEX-NM-000610'\n  tag gtitle: 'SRG-APP-000516-NDM-000317'\n  tag fix_id: 'F-57341r843846_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253938.rb"},"title":"The Juniper EX switch must be configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.","desc":"Configuring the network device to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed that affect the security posture and/or functionality of the network device. Security-related parameters are those parameters impacting the security state of the network device, including the parameters required to satisfy other security control requirements.","descriptions":{"default":"Configuring the network device to implement organization-wide security implementation guides and security checklists ensures compliance with federal standards and establishes a common security baseline across DoD that reflects the most restrictive security posture consistent with operational requirements.\n\nConfiguration settings are the set of parameters that can be changed that affect the security posture and/or functionality of the network device. Security-related parameters are those parameters impacting the security state of the network device, including the parameters required to satisfy other security control requirements.","check":"Determine if the network device is configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.\n\nVerify the configuration implements security configuration or implementation guidance using the \"show\" commands. For example, to review the entire configuration, use \"show configuration\" from operational mode. If in configuration mode, executing the \"show\" command will show the configuration of the current hierarchy level. \n\nIf it is not configured in accordance with the designated security configuration settings, this is a finding.","fix":"Configure the network device to be configured in accordance with the security configuration settings based on DoD security configuration or implementation guidance, including STIGs, NSA configuration guides, CTOs, and DTMs.\n\nTo enable a function or set its configurable parameters, use the \"set\" command. To disable a function or its configuration parameters, use the \"deactivate\" or \"delete\" commands."},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57390r843845_chk","severity":"medium","gid":"V-253938","rid":"SV-253938r879887_rule","stig_id":"JUEX-NM-000610","gtitle":"SRG-APP-000516-NDM-000317","fix_id":"F-57341r843846_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-253939","code":"control 'SV-253939' do\n  title 'The Juniper EX switch must be configured to generate log records for a locally developed list of auditable events.'\n  desc 'Auditing and logging are key components of any security architecture. Logging the actions of specific events provides a means to investigate an attack; to recognize resource utilization or capacity thresholds; or to identify an improperly configured network device. If auditing is not comprehensive, it will not be useful for intrusion monitoring, security investigations, and forensic analysis.'\n  desc 'check', 'Determine if the network device generates audit log events for a locally developed list of auditable events.\n\nVerify audit logging is enabled.\n[edit system syslog]\nfile <file name> {\n    any info;\n}\nhost <external syslog address> {\n    any info;\n}\ntime-format year;\n\nNote: Without the \"structured-data\" directive (as shown), syslog outputs in standard format. Add the \"structured-data\" command to all files and external syslog servers requiring that format. For example:\n[edit system syslog]\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the logging facility and level is too broad, Junos supports REGEX or string match conditions to filter events. If used, verify the match conditions capture the required events.\n[edit system syslog]\nfile <file name> {\n    any info;\n    match <REGEX>;\n    -or-\n    match-strings [ \"string 1\" \"string 2\" ];\n}\nNote: When using match conditions, it may be necessary to use the \"any\" (debug) severity level, but this should not generate overwhelming numbers of messages because the filter will ignore all unmatched events.\n\nIf the network device is not configured to generate audit log events for a locally developed list of auditable events, this is a finding.'\n  desc 'fix', 'Configure the network device to generate audit log events for a locally developed list of auditable events.\n\nset system syslog file <file name> messages any info\nset system syslog file <file name> structured-data << (Optional) Only if structured data format is required\nset system syslog host <external syslog address> any info\nset system syslog host <external syslog address> structured-data << (Optional) Only if structured data format is required\nset system syslog time-format year\n\nIf using REGEX or string match conditions:\nset system syslog file <name> any <info|any>\nset system syslog file <name> match <REGEX>\n-or-\nset system syslog file <name> match-strings [ \"string 1\" \"string 2\" ]'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57391r843848_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253939'\n  tag rid: 'SV-253939r879887_rule'\n  tag stig_id: 'JUEX-NM-000620'\n  tag gtitle: 'SRG-APP-000516-NDM-000334'\n  tag fix_id: 'F-57342r843849_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000169', 'CCI-000366']\n  tag nist: ['AU-12 a', 'CM-6 b']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253939.rb"},"title":"The Juniper EX switch must be configured to generate log records for a locally developed list of auditable events.","desc":"Auditing and logging are key components of any security architecture. Logging the actions of specific events provides a means to investigate an attack; to recognize resource utilization or capacity thresholds; or to identify an improperly configured network device. If auditing is not comprehensive, it will not be useful for intrusion monitoring, security investigations, and forensic analysis.","descriptions":{"default":"Auditing and logging are key components of any security architecture. Logging the actions of specific events provides a means to investigate an attack; to recognize resource utilization or capacity thresholds; or to identify an improperly configured network device. If auditing is not comprehensive, it will not be useful for intrusion monitoring, security investigations, and forensic analysis.","check":"Determine if the network device generates audit log events for a locally developed list of auditable events.\n\nVerify audit logging is enabled.\n[edit system syslog]\nfile <file name> {\n    any info;\n}\nhost <external syslog address> {\n    any info;\n}\ntime-format year;\n\nNote: Without the \"structured-data\" directive (as shown), syslog outputs in standard format. Add the \"structured-data\" command to all files and external syslog servers requiring that format. For example:\n[edit system syslog]\nfile <file name> {\n    any info;\n    structured-data;\n}\n\nIf the logging facility and level is too broad, Junos supports REGEX or string match conditions to filter events. If used, verify the match conditions capture the required events.\n[edit system syslog]\nfile <file name> {\n    any info;\n    match <REGEX>;\n    -or-\n    match-strings [ \"string 1\" \"string 2\" ];\n}\nNote: When using match conditions, it may be necessary to use the \"any\" (debug) severity level, but this should not generate overwhelming numbers of messages because the filter will ignore all unmatched events.\n\nIf the network device is not configured to generate audit log events for a locally developed list of auditable events, this is a finding.","fix":"Configure the network device to generate audit log events for a locally developed list of auditable events.\n\nset system syslog file <file name> messages any info\nset system syslog file <file name> structured-data << (Optional) Only if structured data format is required\nset system syslog host <external syslog address> any info\nset system syslog host <external syslog address> structured-data << (Optional) Only if structured data format is required\nset system syslog time-format year\n\nIf using REGEX or string match conditions:\nset system syslog file <name> any <info|any>\nset system syslog file <name> match <REGEX>\n-or-\nset system syslog file <name> match-strings [ \"string 1\" \"string 2\" ]"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57391r843848_chk","severity":"medium","gid":"V-253939","rid":"SV-253939r879887_rule","stig_id":"JUEX-NM-000620","gtitle":"SRG-APP-000516-NDM-000334","fix_id":"F-57342r843849_fix","documentable":null,"cci":["CCI-000169","CCI-000366"],"nist":["AU-12 a","CM-6 b"]}},{"id":"SV-253940","code":"control 'SV-253940' do\n  title 'The Juniper EX switch must be configured to enforce access restrictions associated with changes to the system components.'\n  desc 'Changes to the hardware or software components of the network device can have significant effects on the overall security of the network. Therefore, only qualified and authorized individuals should be allowed administrative access to the network device for implementing any changes or upgrades. This requirement applies to updates of the application files, configuration, firewall filters, and policy filters.'\n  desc 'check', 'Check the network device to determine if only authorized administrators have permissions for changes, deletions and updates on the network device. Inspect the maintenance log to verify changes are being made only by the system administrators.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf unauthorized users are allowed to change the hardware or software, this is a finding.'\n  desc 'fix', \"Configure the network device to enforce access restrictions associated with changes to the system components.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\"\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57392r843851_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253940'\n  tag rid: 'SV-253940r879887_rule'\n  tag stig_id: 'JUEX-NM-000630'\n  tag gtitle: 'SRG-APP-000516-NDM-000335'\n  tag fix_id: 'F-57343r843852_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000345', 'CCI-000366']\n  tag nist: ['CM-5', 'CM-6 b']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253940.rb"},"title":"The Juniper EX switch must be configured to enforce access restrictions associated with changes to the system components.","desc":"Changes to the hardware or software components of the network device can have significant effects on the overall security of the network. Therefore, only qualified and authorized individuals should be allowed administrative access to the network device for implementing any changes or upgrades. This requirement applies to updates of the application files, configuration, firewall filters, and policy filters.","descriptions":{"default":"Changes to the hardware or software components of the network device can have significant effects on the overall security of the network. Therefore, only qualified and authorized individuals should be allowed administrative access to the network device for implementing any changes or upgrades. This requirement applies to updates of the application files, configuration, firewall filters, and policy filters.","check":"Check the network device to determine if only authorized administrators have permissions for changes, deletions and updates on the network device. Inspect the maintenance log to verify changes are being made only by the system administrators.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and local authentication. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nIf unauthorized users are allowed to change the hardware or software, this is a finding.","fix":"Configure the network device to enforce access restrictions associated with changes to the system components.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57392r843851_chk","severity":"medium","gid":"V-253940","rid":"SV-253940r879887_rule","stig_id":"JUEX-NM-000630","gtitle":"SRG-APP-000516-NDM-000335","fix_id":"F-57343r843852_fix","documentable":null,"cci":["CCI-000345","CCI-000366"],"nist":["CM-5","CM-6 b"]}},{"id":"SV-253941","code":"control 'SV-253941' do\n  title 'The Juniper EX switch must be configured to use an authentication server for the purpose of authenticating users prior to granting administrative access.'\n  desc \"Centralized management of authentication settings increases the security of remote and nonlocal access methods. This control is particularly important protection against the insider threat. With robust centralized management, audit records for administrator account access to the organization's network devices can be more readily analyzed for trends and anomalies. The alternative method of defining administrator accounts on each device exposes the device configuration to remote access authentication attacks and system administrators with multiple authenticators for each network device.\"\n  desc 'check', 'Review the network device configuration to verify the device is configured to use an authentication server as the primary source for authentication. Verify the RADIUS and/or TACACS+ server addresses.\n\n[edit system]\nradius-server {\n    <RADIUS-1 address> secret \"hashed PSK\"; ## SECRET-DATA\n    <RADIUS-2 address> secret \"hashed PSK\"; ## SECRET-DATA\n}\ntacplus-server {\n    <TACPLUS-1 address> secret \"hashed PSK\"; ## SECRET-DATA\n    <TACPLUS-2 address> secret \"hashed PSK\"; ## SECRET-DATA\n}\n\nVerify the authentication order places the external authentication server first.\n[edit system]\nauthentication-order [ radius tacplus password ];\n\nNote: Only the global authentication order is required; all administrative access methods will honor the global setting unless configured separately. \n\nIf the network device is not configured to use an authentication server to authenticate users prior to granting administrative access, this is a finding.'\n  desc 'fix', 'Configure the network device to use an authentication server.\nset system radius-server <RADIUS-1 address> secret \"<PSK>\"\nset system tacplus-server <TACPLUS-1 address> secret \"<PSK>\"\n\nConfigure the authentication order to use the authentication server as primary source for authentication.\nset system authentication-order radius\nset system authentication-order tacplus\nset system authentication-order password'\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57393r843854_chk'\n  tag severity: 'high'\n  tag gid: 'V-253941'\n  tag rid: 'SV-253941r879887_rule'\n  tag stig_id: 'JUEX-NM-000640'\n  tag gtitle: 'SRG-APP-000516-NDM-000336'\n  tag fix_id: 'F-57344r843855_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-000370']\n  tag nist: ['CM-6 b', 'CM-6 (1)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253941.rb"},"title":"The Juniper EX switch must be configured to use an authentication server for the purpose of authenticating users prior to granting administrative access.","desc":"Centralized management of authentication settings increases the security of remote and nonlocal access methods. This control is particularly important protection against the insider threat. With robust centralized management, audit records for administrator account access to the organization's network devices can be more readily analyzed for trends and anomalies. The alternative method of defining administrator accounts on each device exposes the device configuration to remote access authentication attacks and system administrators with multiple authenticators for each network device.","descriptions":{"default":"Centralized management of authentication settings increases the security of remote and nonlocal access methods. This control is particularly important protection against the insider threat. With robust centralized management, audit records for administrator account access to the organization's network devices can be more readily analyzed for trends and anomalies. The alternative method of defining administrator accounts on each device exposes the device configuration to remote access authentication attacks and system administrators with multiple authenticators for each network device.","check":"Review the network device configuration to verify the device is configured to use an authentication server as the primary source for authentication. Verify the RADIUS and/or TACACS+ server addresses.\n\n[edit system]\nradius-server {\n    <RADIUS-1 address> secret \"hashed PSK\"; ## SECRET-DATA\n    <RADIUS-2 address> secret \"hashed PSK\"; ## SECRET-DATA\n}\ntacplus-server {\n    <TACPLUS-1 address> secret \"hashed PSK\"; ## SECRET-DATA\n    <TACPLUS-2 address> secret \"hashed PSK\"; ## SECRET-DATA\n}\n\nVerify the authentication order places the external authentication server first.\n[edit system]\nauthentication-order [ radius tacplus password ];\n\nNote: Only the global authentication order is required; all administrative access methods will honor the global setting unless configured separately. \n\nIf the network device is not configured to use an authentication server to authenticate users prior to granting administrative access, this is a finding.","fix":"Configure the network device to use an authentication server.\nset system radius-server <RADIUS-1 address> secret \"<PSK>\"\nset system tacplus-server <TACPLUS-1 address> secret \"<PSK>\"\n\nConfigure the authentication order to use the authentication server as primary source for authentication.\nset system authentication-order radius\nset system authentication-order tacplus\nset system authentication-order password"},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57393r843854_chk","severity":"high","gid":"V-253941","rid":"SV-253941r879887_rule","stig_id":"JUEX-NM-000640","gtitle":"SRG-APP-000516-NDM-000336","fix_id":"F-57344r843855_fix","documentable":null,"cci":["CCI-000366","CCI-000370"],"nist":["CM-6 b","CM-6 (1)"]}},{"id":"SV-253942","code":"control 'SV-253942' do\n  title 'The Juniper EX switch must be configured to conduct backups of system level information contained in the information system when changes occur.'\n  desc 'System-level information includes default and customized settings and security attributes, including firewall filters that relate to the network device configuration, as well as software required for the execution and operation of the device. Information system backup is a critical step in ensuring system integrity and availability. If the system fails and there is no backup of the system-level information, a denial-of-service condition is possible for all who utilize this critical network component.\n\nThis control requires the network device to support the organizational central backup process for system-level information associated with the network device. This function may be provided by the network device itself; however, the preferred best practice is a centralized backup rather than each network device performing discrete backups.'\n  desc 'check', 'Review the network device configuration to determine if the device is configured to conduct backups of system-level information contained in the information system when changes occur. \n\nVerify the preferred centralized backup system is configured to retrieve the configuration file. There is no provision for backing up system binaries because Juniper provides the signed installation packages rather than individual files. Therefore, verify the centralized backup solution has the appropriate installation packages for the deployed platforms. \n\nWhen the configuration file is pulled from the centralized server, an example retrieval method is authenticated connections over NETCONF or manual retrieval using SSH. Junos supports authenticating external services via RADIUS or TACACS+, or via a local account.\n\n[edit system services netconf]\nssh;\nrfc-compliant;\n\nIf the network device will be saving system files to a centralized repository, verify the configuration file is automatically saved at each commit.\n\n[edit system archival]\nconfiguration {\n    transfer-on-commit;\n    archive-sites {\n        \"sftp://user@host/configuration_files\" password \"$9$w52...<snip>...mfzn/\"; ## SECRET-DATA\n    }\n}\nNote: The URL uses <scp|sftp>://<username>@<repository address>/<path without trailing slash (/)> format because Junos appends the slash with the system-generated filename. Junos supports file transfer either on commit, or at configured intervals.\n\nIf the network device is not configured to conduct backups of system-level data when changes occur, this is a finding.'\n  desc 'fix', 'Configure the network device to conduct backups of system-level information contained in the information system when changes occur.\n\nFor NETCONF connections:\nset system services netconf ssh\nset system services netconf rfc-compliant\n\nFor device automated configuration offload:\nset system archival configuration transfer-on-commit\nset system archival configuration archive-sites \"<scp|sftp>://<username>@<address>/<path without trailing slash (/)>\" password \"<PSK>\"'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57394r843857_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253942'\n  tag rid: 'SV-253942r879887_rule'\n  tag stig_id: 'JUEX-NM-000650'\n  tag gtitle: 'SRG-APP-000516-NDM-000340'\n  tag fix_id: 'F-57345r843858_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-000537']\n  tag nist: ['CM-6 b', 'CP-9 (b)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253942.rb"},"title":"The Juniper EX switch must be configured to conduct backups of system level information contained in the information system when changes occur.","desc":"System-level information includes default and customized settings and security attributes, including firewall filters that relate to the network device configuration, as well as software required for the execution and operation of the device. Information system backup is a critical step in ensuring system integrity and availability. If the system fails and there is no backup of the system-level information, a denial-of-service condition is possible for all who utilize this critical network component.\n\nThis control requires the network device to support the organizational central backup process for system-level information associated with the network device. This function may be provided by the network device itself; however, the preferred best practice is a centralized backup rather than each network device performing discrete backups.","descriptions":{"default":"System-level information includes default and customized settings and security attributes, including firewall filters that relate to the network device configuration, as well as software required for the execution and operation of the device. Information system backup is a critical step in ensuring system integrity and availability. If the system fails and there is no backup of the system-level information, a denial-of-service condition is possible for all who utilize this critical network component.\n\nThis control requires the network device to support the organizational central backup process for system-level information associated with the network device. This function may be provided by the network device itself; however, the preferred best practice is a centralized backup rather than each network device performing discrete backups.","check":"Review the network device configuration to determine if the device is configured to conduct backups of system-level information contained in the information system when changes occur. \n\nVerify the preferred centralized backup system is configured to retrieve the configuration file. There is no provision for backing up system binaries because Juniper provides the signed installation packages rather than individual files. Therefore, verify the centralized backup solution has the appropriate installation packages for the deployed platforms. \n\nWhen the configuration file is pulled from the centralized server, an example retrieval method is authenticated connections over NETCONF or manual retrieval using SSH. Junos supports authenticating external services via RADIUS or TACACS+, or via a local account.\n\n[edit system services netconf]\nssh;\nrfc-compliant;\n\nIf the network device will be saving system files to a centralized repository, verify the configuration file is automatically saved at each commit.\n\n[edit system archival]\nconfiguration {\n    transfer-on-commit;\n    archive-sites {\n        \"sftp://user@host/configuration_files\" password \"$9$w52...<snip>...mfzn/\"; ## SECRET-DATA\n    }\n}\nNote: The URL uses <scp|sftp>://<username>@<repository address>/<path without trailing slash (/)> format because Junos appends the slash with the system-generated filename. Junos supports file transfer either on commit, or at configured intervals.\n\nIf the network device is not configured to conduct backups of system-level data when changes occur, this is a finding.","fix":"Configure the network device to conduct backups of system-level information contained in the information system when changes occur.\n\nFor NETCONF connections:\nset system services netconf ssh\nset system services netconf rfc-compliant\n\nFor device automated configuration offload:\nset system archival configuration transfer-on-commit\nset system archival configuration archive-sites \"<scp|sftp>://<username>@<address>/<path without trailing slash (/)>\" password \"<PSK>\""},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57394r843857_chk","severity":"medium","gid":"V-253942","rid":"SV-253942r879887_rule","stig_id":"JUEX-NM-000650","gtitle":"SRG-APP-000516-NDM-000340","fix_id":"F-57345r843858_fix","documentable":null,"cci":["CCI-000366","CCI-000537"],"nist":["CM-6 b","CP-9 (b)"]}},{"id":"SV-253943","code":"control 'SV-253943' do\n  title 'The Juniper EX switch must be configured to obtain its public key certificates from an appropriate certificate policy through an approved service provider.'\n  desc 'For user certificates, each organization obtains certificates from an approved, shared service provider, as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority at medium assurance or higher, this Certification Authority will suffice.'\n  desc 'check', 'Determine if the network device obtains public key certificates from an appropriate certificate policy through an approved service provider.\n\nVerify the certificate is signed by an approved CA via the \"show security pki local-certificate\" or \"show security pki local-certificate detail\" commands.\n\nIf the network device does not obtain its public key certificates from an appropriate certificate policy through an approved service provider, this is a finding.'\n  desc 'fix', 'Configure the network device to obtain its public key certificates from an appropriate certificate policy through an approved service provider. To view installed certificates:\nshow security pki (ca-certificate | local-certificate)\n\nGenerate a public/private keypair:\nrequest security pki generate-key-pair type <ecdsa|rsa> size <bit size> certificate-id <name>\nNote: ECDSA certificates support 256, 384, or 512 key sizes and RSA supports 1024, 2048, or 4096.\n\nGenerate a certificate signing request:\nrequest security pki generate-certificate-request certificate-id <key name> digest <sha-1|sha-256|sha-384> domain-name <FQDN> ip-address <IPv4 address> ipv6-address <IPv6 address> subject <LDAP format>\nNote: The subject is LDAP formatted. For example, \"CN=switch-01,DC=example,DC=com,O=Company,OU=HR,L=Some City,ST=Some State,C=US\". Not all key => value pairs are required but those used must match organizational policy.\n\nAfter securely transferring the CSR to the certificate authority for signing, and securely transferring the certificate to the device, add the certificate:\nrequest security pki local-certificate load filename <path/filename of certificate> certificate-id <key name>\n\nThe certificate can also be generated externally, with separate public and private key files, or a PKCS#12 package containing both certificate and private key. When importing externally generated certificate and private key, use the \"key\" directive to identify the path and filename of the private key. If the private key, or the PKCS#12 package, uses a passphrase, use the \"passphrase\" directive and provide the correct value.'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57395r843860_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253943'\n  tag rid: 'SV-253943r879887_rule'\n  tag stig_id: 'JUEX-NM-000660'\n  tag gtitle: 'SRG-APP-000516-NDM-000344'\n  tag fix_id: 'F-57346r843861_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-001159']\n  tag nist: ['CM-6 b', 'SC-17 a']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253943.rb"},"title":"The Juniper EX switch must be configured to obtain its public key certificates from an appropriate certificate policy through an approved service provider.","desc":"For user certificates, each organization obtains certificates from an approved, shared service provider, as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority at medium assurance or higher, this Certification Authority will suffice.","descriptions":{"default":"For user certificates, each organization obtains certificates from an approved, shared service provider, as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority at medium assurance or higher, this Certification Authority will suffice.","check":"Determine if the network device obtains public key certificates from an appropriate certificate policy through an approved service provider.\n\nVerify the certificate is signed by an approved CA via the \"show security pki local-certificate\" or \"show security pki local-certificate detail\" commands.\n\nIf the network device does not obtain its public key certificates from an appropriate certificate policy through an approved service provider, this is a finding.","fix":"Configure the network device to obtain its public key certificates from an appropriate certificate policy through an approved service provider. To view installed certificates:\nshow security pki (ca-certificate | local-certificate)\n\nGenerate a public/private keypair:\nrequest security pki generate-key-pair type <ecdsa|rsa> size <bit size> certificate-id <name>\nNote: ECDSA certificates support 256, 384, or 512 key sizes and RSA supports 1024, 2048, or 4096.\n\nGenerate a certificate signing request:\nrequest security pki generate-certificate-request certificate-id <key name> digest <sha-1|sha-256|sha-384> domain-name <FQDN> ip-address <IPv4 address> ipv6-address <IPv6 address> subject <LDAP format>\nNote: The subject is LDAP formatted. For example, \"CN=switch-01,DC=example,DC=com,O=Company,OU=HR,L=Some City,ST=Some State,C=US\". Not all key => value pairs are required but those used must match organizational policy.\n\nAfter securely transferring the CSR to the certificate authority for signing, and securely transferring the certificate to the device, add the certificate:\nrequest security pki local-certificate load filename <path/filename of certificate> certificate-id <key name>\n\nThe certificate can also be generated externally, with separate public and private key files, or a PKCS#12 package containing both certificate and private key. When importing externally generated certificate and private key, use the \"key\" directive to identify the path and filename of the private key. If the private key, or the PKCS#12 package, uses a passphrase, use the \"passphrase\" directive and provide the correct value."},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57395r843860_chk","severity":"medium","gid":"V-253943","rid":"SV-253943r879887_rule","stig_id":"JUEX-NM-000660","gtitle":"SRG-APP-000516-NDM-000344","fix_id":"F-57346r843861_fix","documentable":null,"cci":["CCI-000366","CCI-001159"],"nist":["CM-6 b","SC-17 a"]}},{"id":"SV-253944","code":"control 'SV-253944' do\n  title 'The Juniper EX switch must be configured to send log data to a central log server for the purpose of forwarding alerts to the administrators and the ISSO.'\n  desc 'The aggregation of log data kept on a syslog server can be used to detect attacks and trigger an alert to the appropriate security personnel. The stored log data can used to detect weaknesses in security that enable the network IA team to find and address these weaknesses before breaches can occur. Reviewing these logs, whether before or after a security breach, are important in showing whether someone is an internal employee or an outside threat.'\n  desc 'check', 'Verify that the network device is configured to send log data to a central log server. \n\nVerify the external syslog server is configured. The lowest severity level, \"any\", is debug and will generate a significant number of messages.\n\n[edit system syslog]\nhost <external syslog address> {\n    any info;\n    structured-format; << Only if structured formatting is required, otherwise events are recorded in standard format.\n}\ntime-format year;\nNote: The time-format command supports including the year and/or the time in milliseconds. The default format does not include the year and time is recorded in seconds.\n\nIf the network device is not configured to send log data to a central log server, this is a finding.'\n  desc 'fix', 'Configure the network device to send log data to a central log server.\n\nset system syslog host <external syslog IPv4 or IPv6 address> any info'\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57396r843863_chk'\n  tag severity: 'high'\n  tag gid: 'V-253944'\n  tag rid: 'SV-253944r879887_rule'\n  tag stig_id: 'JUEX-NM-000670'\n  tag gtitle: 'SRG-APP-000516-NDM-000350'\n  tag fix_id: 'F-57347r843864_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002605']\n  tag nist: ['SI-2 c']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253944.rb"},"title":"The Juniper EX switch must be configured to send log data to a central log server for the purpose of forwarding alerts to the administrators and the ISSO.","desc":"The aggregation of log data kept on a syslog server can be used to detect attacks and trigger an alert to the appropriate security personnel. The stored log data can used to detect weaknesses in security that enable the network IA team to find and address these weaknesses before breaches can occur. Reviewing these logs, whether before or after a security breach, are important in showing whether someone is an internal employee or an outside threat.","descriptions":{"default":"The aggregation of log data kept on a syslog server can be used to detect attacks and trigger an alert to the appropriate security personnel. The stored log data can used to detect weaknesses in security that enable the network IA team to find and address these weaknesses before breaches can occur. Reviewing these logs, whether before or after a security breach, are important in showing whether someone is an internal employee or an outside threat.","check":"Verify that the network device is configured to send log data to a central log server. \n\nVerify the external syslog server is configured. The lowest severity level, \"any\", is debug and will generate a significant number of messages.\n\n[edit system syslog]\nhost <external syslog address> {\n    any info;\n    structured-format; << Only if structured formatting is required, otherwise events are recorded in standard format.\n}\ntime-format year;\nNote: The time-format command supports including the year and/or the time in milliseconds. The default format does not include the year and time is recorded in seconds.\n\nIf the network device is not configured to send log data to a central log server, this is a finding.","fix":"Configure the network device to send log data to a central log server.\n\nset system syslog host <external syslog IPv4 or IPv6 address> any info"},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57396r843863_chk","severity":"high","gid":"V-253944","rid":"SV-253944r879887_rule","stig_id":"JUEX-NM-000670","gtitle":"SRG-APP-000516-NDM-000350","fix_id":"F-57347r843864_fix","documentable":null,"cci":["CCI-002605"],"nist":["SI-2 c"]}},{"id":"SV-253945","code":"control 'SV-253945' do\n  title 'The Juniper EX switch must be configured with an operating system release that is currently supported by the vendor.'\n  desc 'Network devices running an unsupported operating system lack current security fixes required to mitigate the risks associated with recent vulnerabilities.'\n  desc 'check', 'Verify that the network device is in compliance with this requirement. \n\nThe currently running version is displayed at login and can be displayed at any time by running the \"show version\" (or \"show version local\" depending upon platform) command.\n\nIf the network device is not running an operating system release that is currently supported by the vendor, this is a finding.'\n  desc 'fix', 'Upgrade the network device to an operating system that is supported by the vendor.\n\nrequest system software add <supported installation package>'\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57397r843866_chk'\n  tag severity: 'high'\n  tag gid: 'V-253945'\n  tag rid: 'SV-253945r879887_rule'\n  tag stig_id: 'JUEX-NM-000680'\n  tag gtitle: 'SRG-APP-000516-NDM-000351'\n  tag fix_id: 'F-57348r843867_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253945.rb"},"title":"The Juniper EX switch must be configured with an operating system release that is currently supported by the vendor.","desc":"Network devices running an unsupported operating system lack current security fixes required to mitigate the risks associated with recent vulnerabilities.","descriptions":{"default":"Network devices running an unsupported operating system lack current security fixes required to mitigate the risks associated with recent vulnerabilities.","check":"Verify that the network device is in compliance with this requirement. \n\nThe currently running version is displayed at login and can be displayed at any time by running the \"show version\" (or \"show version local\" depending upon platform) command.\n\nIf the network device is not running an operating system release that is currently supported by the vendor, this is a finding.","fix":"Upgrade the network device to an operating system that is supported by the vendor.\n\nrequest system software add <supported installation package>"},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57397r843866_chk","severity":"high","gid":"V-253945","rid":"SV-253945r879887_rule","stig_id":"JUEX-NM-000680","gtitle":"SRG-APP-000516-NDM-000351","fix_id":"F-57348r843867_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-253946","code":"control 'SV-253946' do\n  title 'The Juniper EX switch must change credentials for account of last resort when administrators who know the credential leave the organization.'\n  desc 'A shared/group account credential is a shared form of authentication that allows multiple individuals to access the network device using a single account. If shared/group account credentials are not terminated when individuals leave the group, the user that left the group can still gain access even though they are no longer authorized. There may also be instances when specific user actions need to be performed on the network device without unique administrator identification or authentication. Examples of credentials include passwords and group membership certificates.'\n  desc 'check', \"Review the site's SSP to verify the password for the account of last resort and the root account are changed when a system administrator with knowledge of the password leaves or no longer has a need to know/access.\n\nIf the credentials for account of last resort are not changed when administrators who know the credential leave the organization, this is a finding.\"\n  desc 'fix', 'Document this process in the SSP. Change the account of last resort to a new password when administrators who know the credential leave the organization\n\nSet the password for the account of last resort:\nset system login user <account of last resort name> authentication plain-text-password\nNew password: <password - not echoed to the screen>\nRetype new password: <password verification - not echoed to the screen>'\n  impact 0.5\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57398r843869_chk'\n  tag severity: 'medium'\n  tag gid: 'V-253946'\n  tag rid: 'SV-253946r879694_rule'\n  tag stig_id: 'JUEX-NM-000910'\n  tag gtitle: 'SRG-APP-000317-NDM-000282'\n  tag fix_id: 'F-57349r843870_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002142']\n  tag nist: ['AC-2 (10)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253946.rb"},"title":"The Juniper EX switch must change credentials for account of last resort when administrators who know the credential leave the organization.","desc":"A shared/group account credential is a shared form of authentication that allows multiple individuals to access the network device using a single account. If shared/group account credentials are not terminated when individuals leave the group, the user that left the group can still gain access even though they are no longer authorized. There may also be instances when specific user actions need to be performed on the network device without unique administrator identification or authentication. Examples of credentials include passwords and group membership certificates.","descriptions":{"default":"A shared/group account credential is a shared form of authentication that allows multiple individuals to access the network device using a single account. If shared/group account credentials are not terminated when individuals leave the group, the user that left the group can still gain access even though they are no longer authorized. There may also be instances when specific user actions need to be performed on the network device without unique administrator identification or authentication. Examples of credentials include passwords and group membership certificates.","check":"Review the site's SSP to verify the password for the account of last resort and the root account are changed when a system administrator with knowledge of the password leaves or no longer has a need to know/access.\n\nIf the credentials for account of last resort are not changed when administrators who know the credential leave the organization, this is a finding.","fix":"Document this process in the SSP. Change the account of last resort to a new password when administrators who know the credential leave the organization\n\nSet the password for the account of last resort:\nset system login user <account of last resort name> authentication plain-text-password\nNew password: <password - not echoed to the screen>\nRetype new password: <password verification - not echoed to the screen>"},"impact":0.5,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57398r843869_chk","severity":"medium","gid":"V-253946","rid":"SV-253946r879694_rule","stig_id":"JUEX-NM-000910","gtitle":"SRG-APP-000317-NDM-000282","fix_id":"F-57349r843870_fix","documentable":null,"cci":["CCI-002142"],"nist":["AC-2 (10)"]}},{"id":"SV-253947","code":"control 'SV-253947' do\n  title 'The Juniper EX switch must prevent nonprivileged users from executing privileged functions to include disabling, circumventing, or altering implemented security safeguards/countermeasures.'\n  desc 'Preventing nonprivileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges. \n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Nonprivileged users are individuals that do not possess appropriate authorizations.'\n  desc 'check', 'If the network device is configured to use a AAA service account, and the AAA broker is configured to assign authorization levels based on centralized user account group memberships on behalf of the network device, that will satisfy this objective. Because the responsibility for meeting this objective is transferred to the AAA broker, this requirement is not applicable for the local network device. This requirement may be verified by demonstration or configuration review.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and/or local authentication depending upon the authentication order. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives, or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nVerify the network device is configured to assign appropriate user roles or access levels to authenticated users. This requirement may be verified by demonstration or configuration review. \n\nIf the Juniper EX switch does not prevent nonprivileged users from executing privileged functions to include disabling, circumventing, or altering implemented security safeguards/countermeasures, this is a finding.'\n  desc 'fix', \"Configure the network device to assign appropriate user roles or access levels to authenticated users, or configure the network device to leverage an AAA solution that will satisfy this objective.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>\"\n  impact 0.7\n  ref 'DPMS Target Juniper EX Series Switches NDM'\n  tag check_id: 'C-57399r843872_chk'\n  tag severity: 'high'\n  tag gid: 'V-253947'\n  tag rid: 'SV-253947r879717_rule'\n  tag stig_id: 'JUEX-NM-000930'\n  tag gtitle: 'SRG-APP-000340-NDM-000288'\n  tag fix_id: 'F-57350r843873_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002235']\n  tag nist: ['AC-6 (10)']\nend","source_location":{"line":1,"ref":"U_Juniper_EX_Switches_NDM_STIG_V1R3/controls/SV-253947.rb"},"title":"The Juniper EX switch must prevent nonprivileged users from executing privileged functions to include disabling, circumventing, or altering implemented security safeguards/countermeasures.","desc":"Preventing nonprivileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges. \n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Nonprivileged users are individuals that do not possess appropriate authorizations.","descriptions":{"default":"Preventing nonprivileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges. \n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Nonprivileged users are individuals that do not possess appropriate authorizations.","check":"If the network device is configured to use a AAA service account, and the AAA broker is configured to assign authorization levels based on centralized user account group memberships on behalf of the network device, that will satisfy this objective. Because the responsibility for meeting this objective is transferred to the AAA broker, this requirement is not applicable for the local network device. This requirement may be verified by demonstration or configuration review.\n\nJuniper switches use role-based access controls (RBAC) to assign privilege levels. Account definitions in Junos are either \"local\" or \"template\", discriminated by the presence of an authentication stanza. Local accounts have an authentication stanza and support both external and/or local authentication depending upon the authentication order. Template accounts do not have an authentication stanza and only support external authentication. Every account (local and template) must be assigned a login class by an authorized administrator.\n\nVerify each account is assigned a login class with appropriate permissions based upon organizational requirements. Login classes support optional allow- and deny- directives as shown in the examples. Organizational requirements may require different allow- and deny- directives, or no directives at all.\n\n[edit system login]\nclass <name> {\n\tidle-timeout 10;\n\tpermissions all;\n\tdeny-commands \"^clear (log|security log)|^(clear|show) security alarms alarm-type idp|^request (security|system set-encryption-key|system firmware upgrade re|system decrypt)|^rollback\";\n\tdeny-configuration-regexps [ \"security alarms potential-violation idp\" \"security (ike|ipsec) (policy|proposal)\" \"security ipsec ^vpn$ .* manual (authentication|encryption|protocol|spi)\" \"security log\" \"system fips self-test after-key-generation\" \"system (archival|syslog|root-authentication|authentication-order|master-password)\" \"system services ssh (protocol-version|root-login)\" \"system login password\" \"system login user [a-zA-Z0-9_-]+ (authentication|class)\" \"system login class [a-zA-Z0-9_-]+ (permissions|deny-|allow-)\" ];\n}\nclass <name-1> {\n\tidle-timeout 10;\n\tpermissions [ configure maintenance security system-control trace view-configuration ];\n\tallow-commands \"^clear (log|security log)|^show cli authorization\";\n\tdeny-commands \"^clear (security alarms|system login lockout)|^file (copy|delete|list|rename|show)|^request (security|system set-encryption-key|system firmware upgrade re)|^rollback|^set date|^show security (alarms|dynamic-policies|match-policies|policies)|^start shell|^request system (decrypt|halt|reboot|software|zeroize)\";\n\tdeny-configuration-regexps [ \"system (login|internet-options|scripts|services|time-zone|^[a-r]+)\" \"security services event-options\" ];\n\tsecurity-role audit-administrator;\n}\n\nExample local and template accounts:\n\nuser <account of last resort> {\n\tuid 2000;\n\tclass <name>;\n\tauthentication {\n\t\tencrypted-password \"$6$HEQnJP/W$/QD...<snip>...5r./\"; ## SECRET-DATA\n\t}\n}\nuser <account name> {\n\tuid 2015;\n\tclass <name-1>;\n}\nNote: Accounts without an authentication stanza are template accounts, must be externally authenticated, and cannot log in locally.\n\nVerify the network device is configured to assign appropriate user roles or access levels to authenticated users. This requirement may be verified by demonstration or configuration review. \n\nIf the Juniper EX switch does not prevent nonprivileged users from executing privileged functions to include disabling, circumventing, or altering implemented security safeguards/countermeasures, this is a finding.","fix":"Configure the network device to assign appropriate user roles or access levels to authenticated users, or configure the network device to leverage an AAA solution that will satisfy this objective.\n\nset system login class <name> permissions <permission sets or 'all'>\nset system login class <name> deny-commands <appropriate commands to deny>\nset system login class <name> deny-configuration-regexps <appropriate configuration hierarchy to deny>\n\nset system login user <account name> class <name>"},"impact":0.7,"refs":[{"ref":"DPMS Target Juniper EX Series Switches NDM"}],"tags":{"check_id":"C-57399r843872_chk","severity":"high","gid":"V-253947","rid":"SV-253947r879717_rule","stig_id":"JUEX-NM-000930","gtitle":"SRG-APP-000340-NDM-000288","fix_id":"F-57350r843873_fix","documentable":null,"cci":["CCI-002235"],"nist":["AC-6 (10)"]}}],"groups":[{"id":"controls/SV-253878.rb","title":null,"controls":["SV-253878"]},{"id":"controls/SV-253879.rb","title":null,"controls":["SV-253879"]},{"id":"controls/SV-253880.rb","title":null,"controls":["SV-253880"]},{"id":"controls/SV-253881.rb","title":null,"controls":["SV-253881"]},{"id":"controls/SV-253882.rb","title":null,"controls":["SV-253882"]},{"id":"controls/SV-253883.rb","title":null,"controls":["SV-253883"]},{"id":"controls/SV-253884.rb","title":null,"controls":["SV-253884"]},{"id":"controls/SV-253885.rb","title":null,"controls":["SV-253885"]},{"id":"controls/SV-253886.rb","title":null,"controls":["SV-253886"]},{"id":"controls/SV-253887.rb","title":null,"controls":["SV-253887"]},{"id":"controls/SV-253888.rb","title":null,"controls":["SV-253888"]},{"id":"controls/SV-253889.rb","title":null,"controls":["SV-253889"]},{"id":"controls/SV-253890.rb","title":null,"controls":["SV-253890"]},{"id":"controls/SV-253891.rb","title":null,"controls":["SV-253891"]},{"id":"controls/SV-253892.rb","title":null,"controls":["SV-253892"]},{"id":"controls/SV-253893.rb","title":null,"controls":["SV-253893"]},{"id":"controls/SV-253894.rb","title":null,"controls":["SV-253894"]},{"id":"controls/SV-253895.rb","title":null,"controls":["SV-253895"]},{"id":"controls/SV-253896.rb","title":null,"controls":["SV-253896"]},{"id":"controls/SV-253897.rb","title":null,"controls":["SV-253897"]},{"id":"controls/SV-253898.rb","title":null,"controls":["SV-253898"]},{"id":"controls/SV-253899.rb","title":null,"controls":["SV-253899"]},{"id":"controls/SV-253900.rb","title":null,"controls":["SV-253900"]},{"id":"controls/SV-253901.rb","title":null,"controls":["SV-253901"]},{"id":"controls/SV-253902.rb","title":null,"controls":["SV-253902"]},{"id":"controls/SV-253903.rb","title":null,"controls":["SV-253903"]},{"id":"controls/SV-253904.rb","title":null,"controls":["SV-253904"]},{"id":"controls/SV-253905.rb","title":null,"controls":["SV-253905"]},{"id":"controls/SV-253906.rb","title":null,"controls":["SV-253906"]},{"id":"controls/SV-253907.rb","title":null,"controls":["SV-253907"]},{"id":"controls/SV-253908.rb","title":null,"controls":["SV-253908"]},{"id":"controls/SV-253909.rb","title":null,"controls":["SV-253909"]},{"id":"controls/SV-253910.rb","title":null,"controls":["SV-253910"]},{"id":"controls/SV-253911.rb","title":null,"controls":["SV-253911"]},{"id":"controls/SV-253912.rb","title":null,"controls":["SV-253912"]},{"id":"controls/SV-253913.rb","title":null,"controls":["SV-253913"]},{"id":"controls/SV-253914.rb","title":null,"controls":["SV-253914"]},{"id":"controls/SV-253915.rb","title":null,"controls":["SV-253915"]},{"id":"controls/SV-253916.rb","title":null,"controls":["SV-253916"]},{"id":"controls/SV-253917.rb","title":null,"controls":["SV-253917"]},{"id":"controls/SV-253918.rb","title":null,"controls":["SV-253918"]},{"id":"controls/SV-253919.rb","title":null,"controls":["SV-253919"]},{"id":"controls/SV-253920.rb","title":null,"controls":["SV-253920"]},{"id":"controls/SV-253921.rb","title":null,"controls":["SV-253921"]},{"id":"controls/SV-253922.rb","title":null,"controls":["SV-253922"]},{"id":"controls/SV-253923.rb","title":null,"controls":["SV-253923"]},{"id":"controls/SV-253924.rb","title":null,"controls":["SV-253924"]},{"id":"controls/SV-253925.rb","title":null,"controls":["SV-253925"]},{"id":"controls/SV-253926.rb","title":null,"controls":["SV-253926"]},{"id":"controls/SV-253927.rb","title":null,"controls":["SV-253927"]},{"id":"controls/SV-253928.rb","title":null,"controls":["SV-253928"]},{"id":"controls/SV-253929.rb","title":null,"controls":["SV-253929"]},{"id":"controls/SV-253930.rb","title":null,"controls":["SV-253930"]},{"id":"controls/SV-253931.rb","title":null,"controls":["SV-253931"]},{"id":"controls/SV-253932.rb","title":null,"controls":["SV-253932"]},{"id":"controls/SV-253933.rb","title":null,"controls":["SV-253933"]},{"id":"controls/SV-253934.rb","title":null,"controls":["SV-253934"]},{"id":"controls/SV-253935.rb","title":null,"controls":["SV-253935"]},{"id":"controls/SV-253936.rb","title":null,"controls":["SV-253936"]},{"id":"controls/SV-253937.rb","title":null,"controls":["SV-253937"]},{"id":"controls/SV-253938.rb","title":null,"controls":["SV-253938"]},{"id":"controls/SV-253939.rb","title":null,"controls":["SV-253939"]},{"id":"controls/SV-253940.rb","title":null,"controls":["SV-253940"]},{"id":"controls/SV-253941.rb","title":null,"controls":["SV-253941"]},{"id":"controls/SV-253942.rb","title":null,"controls":["SV-253942"]},{"id":"controls/SV-253943.rb","title":null,"controls":["SV-253943"]},{"id":"controls/SV-253944.rb","title":null,"controls":["SV-253944"]},{"id":"controls/SV-253945.rb","title":null,"controls":["SV-253945"]},{"id":"controls/SV-253946.rb","title":null,"controls":["SV-253946"]},{"id":"controls/SV-253947.rb","title":null,"controls":["SV-253947"]}],"name":"Juniper_EX_NDM_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"cf07d4c02ff49f6fdc41f47888d90806c9cebb2a3e866eba5ae663540dca4b92","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
