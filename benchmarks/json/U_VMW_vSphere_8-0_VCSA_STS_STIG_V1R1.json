{"controls":[{"id":"SV-258970","code":"control 'SV-258970' do\n  title 'The vCenter STS service must limit the number of maximum concurrent connections permitted.'\n  desc 'Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash.\n\nMitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the maxThreads attribute.\n\n'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Service/Executor[@name=\"tomcatThreadPool\"]/@maxThreads' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nmaxThreads=\"150\"\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Executor> node with the name of tomcatThreadPool and configure with the value \"maxThreads=\"150\"\".\n\nNote: The <Executor> node should be configured similar to the following:\n\n<Executor maxThreads=\"150\"\n                minSpareThreads=\"50\"\n                name=\"tomcatThreadPool\"\n                namePrefix=\"tomcat-http--\"/>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62710r934566_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258970'\n  tag rid: 'SV-258970r934568_rule'\n  tag stig_id: 'VCST-80-000001'\n  tag gtitle: 'SRG-APP-000001-AS-000001'\n  tag fix_id: 'F-62619r934567_fix'\n  tag satisfies: ['SRG-APP-000001-AS-000001', 'SRG-APP-000435-AS-000163']\n  tag 'documentable'\n  tag cci: ['CCI-000054', 'CCI-002385']\n  tag nist: ['AC-10', 'SC-5 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258970.rb"},"title":"The vCenter STS service must limit the number of maximum concurrent connections permitted.","desc":"Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash.\n\nMitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the maxThreads attribute.\n\n","descriptions":{"default":"Resource exhaustion can occur when an unlimited number of concurrent requests are allowed on a website, facilitating a denial-of-service attack. Unless the number of requests is controlled, the web server can consume enough system resources to cause a system crash.\n\nMitigating this kind of attack will include limiting the number of concurrent HTTP/HTTPS requests. In Tomcat, each incoming request requires a thread for the duration of that request. If more simultaneous requests are received than can be handled by the currently available request processing threads, additional threads will be created up to the value of the maxThreads attribute.\n\n","check":"At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Service/Executor[@name=\"tomcatThreadPool\"]/@maxThreads' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nmaxThreads=\"150\"\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Executor> node with the name of tomcatThreadPool and configure with the value \"maxThreads=\"150\"\".\n\nNote: The <Executor> node should be configured similar to the following:\n\n<Executor maxThreads=\"150\"\n                minSpareThreads=\"50\"\n                name=\"tomcatThreadPool\"\n                namePrefix=\"tomcat-http--\"/>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62710r934566_chk","severity":"medium","gid":"V-258970","rid":"SV-258970r934568_rule","stig_id":"VCST-80-000001","gtitle":"SRG-APP-000001-AS-000001","fix_id":"F-62619r934567_fix","satisfies":["SRG-APP-000001-AS-000001","SRG-APP-000435-AS-000163"],"documentable":null,"cci":["CCI-000054","CCI-002385"],"nist":["AC-10","SC-5 a"]}},{"id":"SV-258971","code":"control 'SV-258971' do\n  title 'The vCenter STS service must be configured to use strong encryption ciphers.'\n  desc '<0> [object Object]'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Service/Connector/SSLHostConfig/@ciphers' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nciphers=\"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\"\n\nIf each result returned does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nFor each connector with \"SSLEnabled\" set to true, configure the ciphers attribute under the \"SSLHostConfig\" as follows:\n\nciphers=\"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62711r934569_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258971'\n  tag rid: 'SV-258971r934571_rule'\n  tag stig_id: 'VCST-80-000002'\n  tag gtitle: 'SRG-APP-000014-AS-000009'\n  tag fix_id: 'F-62620r934570_fix'\n  tag cci: ['CCI-000068', 'CCI-000197', 'CCI-001453', 'CCI-002418']\n  tag nist: ['AC-17 (2)', 'IA-5 (1) (c)', 'AC-17 (2)', 'SC-8']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258971.rb"},"title":"The vCenter STS service must be configured to use strong encryption ciphers.","desc":"<0> [object Object]","descriptions":{"default":"<0> [object Object]","check":"At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Service/Connector/SSLHostConfig/@ciphers' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nciphers=\"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\"\n\nIf each result returned does not match the expected result, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nFor each connector with \"SSLEnabled\" set to true, configure the ciphers attribute under the \"SSLHostConfig\" as follows:\n\nciphers=\"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62711r934569_chk","severity":"medium","gid":"V-258971","rid":"SV-258971r934571_rule","stig_id":"VCST-80-000002","gtitle":"SRG-APP-000014-AS-000009","fix_id":"F-62620r934570_fix","cci":["CCI-000068","CCI-000197","CCI-001453","CCI-002418"],"nist":["AC-17 (2)","IA-5 (1) (c)","AC-17 (2)","SC-8"]}},{"id":"SV-258972","code":"control 'SV-258972' do\n  title 'The vCenter STS service cookies must have secure flag set.'\n  desc 'The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of a cookie in clear text.\n\nBy setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel.'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the <session-config> node and configure the <secure> setting as follows:\n\n<session-config>\n  <session-timeout>30</session-timeout>\n  <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n  </cookie-config>\n</session-config>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62712r934572_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258972'\n  tag rid: 'SV-258972r934574_rule'\n  tag stig_id: 'VCST-80-000005'\n  tag gtitle: 'SRG-APP-000033-AS-000024'\n  tag fix_id: 'F-62621r934573_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000213']\n  tag nist: ['AC-3']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258972.rb"},"title":"The vCenter STS service cookies must have secure flag set.","desc":"The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of a cookie in clear text.\n\nBy setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel.","descriptions":{"default":"The secure flag is an option that can be set by the application server when sending a new cookie to the user within an HTTP Response. The purpose of the secure flag is to prevent cookies from being observed by unauthorized parties due to the transmission of a cookie in clear text.\n\nBy setting the secure flag, the browser will prevent the transmission of a cookie over an unencrypted channel.","check":"At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/secure' -\n\nExpected result:\n\n<secure>true</secure>\n\nIf the output of the command does not match the expected result, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the <session-config> node and configure the <secure> setting as follows:\n\n<session-config>\n  <session-timeout>30</session-timeout>\n  <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n  </cookie-config>\n</session-config>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62712r934572_chk","severity":"medium","gid":"V-258972","rid":"SV-258972r934574_rule","stig_id":"VCST-80-000005","gtitle":"SRG-APP-000033-AS-000024","fix_id":"F-62621r934573_fix","documentable":null,"cci":["CCI-000213"],"nist":["AC-3"]}},{"id":"SV-258973","code":"control 'SV-258973' do\n  title 'The vCenter STS service must initiate session logging upon startup.'\n  desc 'Logging must be started as soon as possible when a service starts and as late as possible when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.'\n  desc 'check', 'At the command prompt, run the following command:\n\n# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/sts-lin.json\n\nExpected output:\n\n\"StreamRedirectFile\" : \"%VMWARE_LOG_DIR%/vmware/sso/sts-runtime.log\",\n\nIf no log file is specified for the \"StreamRedirectFile\" setting, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/vmware/vmware-vmon/svcCfgfiles/sts-lin.json\n\nBelow the last line of the \"PreStartCommandArg\" block, add the following line:\n\n\"StreamRedirectFile\" : \"%VMWARE_LOG_DIR%/vmware/sso/sts-runtime.log\",\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62713r934575_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258973'\n  tag rid: 'SV-258973r934577_rule'\n  tag stig_id: 'VCST-80-000013'\n  tag gtitle: 'SRG-APP-000092-AS-000053'\n  tag fix_id: 'F-62622r934576_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001464']\n  tag nist: ['AU-14 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258973.rb"},"title":"The vCenter STS service must initiate session logging upon startup.","desc":"Logging must be started as soon as possible when a service starts and as late as possible when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.","descriptions":{"default":"Logging must be started as soon as possible when a service starts and as late as possible when a service is stopped. Many forms of suspicious actions can be detected by analyzing logs for unexpected service starts and stops. Also, by starting to log immediately after a service starts, it becomes more difficult for suspicious activity to go unlogged.","check":"At the command prompt, run the following command:\n\n# grep StreamRedirectFile /etc/vmware/vmware-vmon/svcCfgfiles/sts-lin.json\n\nExpected output:\n\n\"StreamRedirectFile\" : \"%VMWARE_LOG_DIR%/vmware/sso/sts-runtime.log\",\n\nIf no log file is specified for the \"StreamRedirectFile\" setting, this is a finding.","fix":"Navigate to and open:\n\n/etc/vmware/vmware-vmon/svcCfgfiles/sts-lin.json\n\nBelow the last line of the \"PreStartCommandArg\" block, add the following line:\n\n\"StreamRedirectFile\" : \"%VMWARE_LOG_DIR%/vmware/sso/sts-runtime.log\",\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62713r934575_chk","severity":"medium","gid":"V-258973","rid":"SV-258973r934577_rule","stig_id":"VCST-80-000013","gtitle":"SRG-APP-000092-AS-000053","fix_id":"F-62622r934576_fix","documentable":null,"cci":["CCI-001464"],"nist":["AU-14 (1)"]}},{"id":"SV-258974","code":"control 'SV-258974' do\n  title 'The vCenter STS service must produce log records containing sufficient information regarding event details.'\n  desc %q(Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success.\n\nTomcat can be configured with an \"AccessLogValve\", a component that can be inserted into the request processing pipeline to provide robust access logging. The \"AccessLogValve\" creates log files in the same format as those created by standard web servers. When \"AccessLogValve\" is properly configured, log files will contain all the forensic information necessary in the case of a security incident.\n\n)\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]/@pattern' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExample result:\n\npattern=\"%t %I [Request] &quot;%{User-Agent}i&quot; %{X-Forwarded-For}i/%h:%{remote}p %l %u to local %{local}p - &quot;%r&quot; %H %m %U%q [Response] %s - %b bytes [Perf] process %Dms / commit %Fms / conn [%X]\"\n\nRequired elements:\n\n%h %{X-Forwarded-For}i %l %t %u &quot;%r&quot; %s %b\n\nIf the log pattern does not contain the required elements in any order, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nInside the <Host> node, find the \"AccessLogValve\" <Valve> node and replace the \"pattern\" element as follows:\n\npattern=\"%t %I [Request] &quot;%{User-Agent}i&quot; %{X-Forwarded-For}i/%h:%{remote}p %l %u to local %{local}p - &quot;%r&quot; %H %m %U%q [Response] %s - %b bytes [Perf] process %Dms / commit %Fms / conn [%X]\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62714r934578_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258974'\n  tag rid: 'SV-258974r934580_rule'\n  tag stig_id: 'VCST-80-000014'\n  tag gtitle: 'SRG-APP-000095-AS-000056'\n  tag fix_id: 'F-62623r934579_fix'\n  tag satisfies: ['SRG-APP-000095-AS-000056', 'SRG-APP-000016-AS-000013', 'SRG-APP-000096-AS-000059', 'SRG-APP-000097-AS-000060', 'SRG-APP-000098-AS-000061', 'SRG-APP-000099-AS-000062', 'SRG-APP-000100-AS-000063', 'SRG-APP-000080-AS-000045', 'SRG-APP-000089-AS-000050', 'SRG-APP-000090-AS-000051', 'SRG-APP-000091-AS-000052', 'SRG-APP-000343-AS-000030', 'SRG-APP-000375-AS-000211', 'SRG-APP-000495-AS-000220', 'SRG-APP-000499-AS-000224', 'SRG-APP-000503-AS-000228']\n  tag 'documentable'\n  tag cci: ['CCI-000067', 'CCI-000130', 'CCI-000131', 'CCI-000132', 'CCI-000133', 'CCI-000134', 'CCI-000166', 'CCI-000169', 'CCI-000171', 'CCI-000172', 'CCI-001487', 'CCI-001889', 'CCI-002234']\n  tag nist: ['AC-17 (1)', 'AU-3 a', 'AU-3 b', 'AU-3 c', 'AU-3 d', 'AU-3 e', 'AU-10', 'AU-12 a', 'AU-12 b', 'AU-12 c', 'AU-3 f', 'AU-8 b', 'AC-6 (9)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258974.rb"},"title":"The vCenter STS service must produce log records containing sufficient information regarding event details.","desc":"Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success.\n\nTomcat can be configured with an \"AccessLogValve\", a component that can be inserted into the request processing pipeline to provide robust access logging. The \"AccessLogValve\" creates log files in the same format as those created by standard web servers. When \"AccessLogValve\" is properly configured, log files will contain all the forensic information necessary in the case of a security incident.\n\n","descriptions":{"default":"Remote access can be exploited by an attacker to compromise the server. By recording all remote access activities, it will be possible to determine the attacker's location, intent, and degree of success.\n\nTomcat can be configured with an \"AccessLogValve\", a component that can be inserted into the request processing pipeline to provide robust access logging. The \"AccessLogValve\" creates log files in the same format as those created by standard web servers. When \"AccessLogValve\" is properly configured, log files will contain all the forensic information necessary in the case of a security incident.\n\n","check":"At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.AccessLogValve\"]/@pattern' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExample result:\n\npattern=\"%t %I [Request] &quot;%{User-Agent}i&quot; %{X-Forwarded-For}i/%h:%{remote}p %l %u to local %{local}p - &quot;%r&quot; %H %m %U%q [Response] %s - %b bytes [Perf] process %Dms / commit %Fms / conn [%X]\"\n\nRequired elements:\n\n%h %{X-Forwarded-For}i %l %t %u &quot;%r&quot; %s %b\n\nIf the log pattern does not contain the required elements in any order, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nInside the <Host> node, find the \"AccessLogValve\" <Valve> node and replace the \"pattern\" element as follows:\n\npattern=\"%t %I [Request] &quot;%{User-Agent}i&quot; %{X-Forwarded-For}i/%h:%{remote}p %l %u to local %{local}p - &quot;%r&quot; %H %m %U%q [Response] %s - %b bytes [Perf] process %Dms / commit %Fms / conn [%X]\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62714r934578_chk","severity":"medium","gid":"V-258974","rid":"SV-258974r934580_rule","stig_id":"VCST-80-000014","gtitle":"SRG-APP-000095-AS-000056","fix_id":"F-62623r934579_fix","satisfies":["SRG-APP-000095-AS-000056","SRG-APP-000016-AS-000013","SRG-APP-000096-AS-000059","SRG-APP-000097-AS-000060","SRG-APP-000098-AS-000061","SRG-APP-000099-AS-000062","SRG-APP-000100-AS-000063","SRG-APP-000080-AS-000045","SRG-APP-000089-AS-000050","SRG-APP-000090-AS-000051","SRG-APP-000091-AS-000052","SRG-APP-000343-AS-000030","SRG-APP-000375-AS-000211","SRG-APP-000495-AS-000220","SRG-APP-000499-AS-000224","SRG-APP-000503-AS-000228"],"documentable":null,"cci":["CCI-000067","CCI-000130","CCI-000131","CCI-000132","CCI-000133","CCI-000134","CCI-000166","CCI-000169","CCI-000171","CCI-000172","CCI-001487","CCI-001889","CCI-002234"],"nist":["AC-17 (1)","AU-3 a","AU-3 b","AU-3 c","AU-3 d","AU-3 e","AU-10","AU-12 a","AU-12 b","AU-12 c","AU-3 f","AU-8 b","AC-6 (9)"]}},{"id":"SV-258975","code":"control 'SV-258975' do\n  title 'The vCenter STS service logs folder permissions must be set correctly.'\n  desc 'Log data is essential in the investigation of events. The accuracy of the information is always pertinent. One of the first steps an attacker will take is the modification or deletion of log records to cover tracks and prolong discovery. The web server must protect the log data from unauthorized modification.\n\n'\n  desc 'check', \"At the command prompt, run the following command:\n\n# find /var/log/vmware/sso/ -xdev ! -name lookupsvc-init.log ! -name sts-prestart.log -type f -a '(' -perm -o+w -o -not -user sts -o -not -group lwis ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', 'At the command prompt, run the following commands:\n\n# chmod o-w <file>\n# chown sts:lwis <file>\n\nNote: Substitute <file> with the listed file.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62715r934581_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258975'\n  tag rid: 'SV-258975r934583_rule'\n  tag stig_id: 'VCST-80-000025'\n  tag gtitle: 'SRG-APP-000118-AS-000078'\n  tag fix_id: 'F-62624r934582_fix'\n  tag satisfies: ['SRG-APP-000118-AS-000078', 'SRG-APP-000119-AS-000079', 'SRG-APP-000120-AS-000080']\n  tag 'documentable'\n  tag cci: ['CCI-000162', 'CCI-000163', 'CCI-000164']\n  tag nist: ['AU-9 a', 'AU-9 a', 'AU-9 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258975.rb"},"title":"The vCenter STS service logs folder permissions must be set correctly.","desc":"Log data is essential in the investigation of events. The accuracy of the information is always pertinent. One of the first steps an attacker will take is the modification or deletion of log records to cover tracks and prolong discovery. The web server must protect the log data from unauthorized modification.\n\n","descriptions":{"default":"Log data is essential in the investigation of events. The accuracy of the information is always pertinent. One of the first steps an attacker will take is the modification or deletion of log records to cover tracks and prolong discovery. The web server must protect the log data from unauthorized modification.\n\n","check":"At the command prompt, run the following command:\n\n# find /var/log/vmware/sso/ -xdev ! -name lookupsvc-init.log ! -name sts-prestart.log -type f -a '(' -perm -o+w -o -not -user sts -o -not -group lwis ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.","fix":"At the command prompt, run the following commands:\n\n# chmod o-w <file>\n# chown sts:lwis <file>\n\nNote: Substitute <file> with the listed file."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62715r934581_chk","severity":"medium","gid":"V-258975","rid":"SV-258975r934583_rule","stig_id":"VCST-80-000025","gtitle":"SRG-APP-000118-AS-000078","fix_id":"F-62624r934582_fix","satisfies":["SRG-APP-000118-AS-000078","SRG-APP-000119-AS-000079","SRG-APP-000120-AS-000080"],"documentable":null,"cci":["CCI-000162","CCI-000163","CCI-000164"],"nist":["AU-9 a","AU-9 a","AU-9 a"]}},{"id":"SV-258976","code":"control 'SV-258976' do\n  title 'The vCenter STS service must limit privileges for creating or modifying hosted application shared files.'\n  desc 'Application servers have the ability to specify that the hosted applications use shared libraries. The application server must have a capability to divide roles based upon duties wherein one project user (such as a developer) cannot modify the shared library code of another project user. The application server must also be able to specify that nonprivileged users cannot modify any shared library code at all.\n\nEnsuring the Security Lifecycle Listener element is uncommented and sets a minimum Umask value will allow the server to perform a number of security checks when starting and prevent the service from starting if they fail.'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Listener[@className=\"org.apache.catalina.security.SecurityListener\"]' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExample result:\n\n<Listener className=\"org.apache.catalina.security.SecurityListener\"/>\n\nIf the \"org.apache.catalina.security.SecurityListener\" listener is not present, this is a finding.\n\nIf the \"org.apache.catalina.security.SecurityListener\" listener is configured with a \"minimumUmask\" and is not \"0007\", this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Server> node and add or update the \"org.apache.catalina.security.SecurityListener\" as follows:\n\n<Listener className=\"org.apache.catalina.security.SecurityListener\"/>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62716r934584_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258976'\n  tag rid: 'SV-258976r934586_rule'\n  tag stig_id: 'VCST-80-000034'\n  tag gtitle: 'SRG-APP-000133-AS-000092'\n  tag fix_id: 'F-62625r934585_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001499']\n  tag nist: ['CM-5 (6)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258976.rb"},"title":"The vCenter STS service must limit privileges for creating or modifying hosted application shared files.","desc":"Application servers have the ability to specify that the hosted applications use shared libraries. The application server must have a capability to divide roles based upon duties wherein one project user (such as a developer) cannot modify the shared library code of another project user. The application server must also be able to specify that nonprivileged users cannot modify any shared library code at all.\n\nEnsuring the Security Lifecycle Listener element is uncommented and sets a minimum Umask value will allow the server to perform a number of security checks when starting and prevent the service from starting if they fail.","descriptions":{"default":"Application servers have the ability to specify that the hosted applications use shared libraries. The application server must have a capability to divide roles based upon duties wherein one project user (such as a developer) cannot modify the shared library code of another project user. The application server must also be able to specify that nonprivileged users cannot modify any shared library code at all.\n\nEnsuring the Security Lifecycle Listener element is uncommented and sets a minimum Umask value will allow the server to perform a number of security checks when starting and prevent the service from starting if they fail.","check":"At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Listener[@className=\"org.apache.catalina.security.SecurityListener\"]' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExample result:\n\n<Listener className=\"org.apache.catalina.security.SecurityListener\"/>\n\nIf the \"org.apache.catalina.security.SecurityListener\" listener is not present, this is a finding.\n\nIf the \"org.apache.catalina.security.SecurityListener\" listener is configured with a \"minimumUmask\" and is not \"0007\", this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Server> node and add or update the \"org.apache.catalina.security.SecurityListener\" as follows:\n\n<Listener className=\"org.apache.catalina.security.SecurityListener\"/>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62716r934584_chk","severity":"medium","gid":"V-258976","rid":"SV-258976r934586_rule","stig_id":"VCST-80-000034","gtitle":"SRG-APP-000133-AS-000092","fix_id":"F-62625r934585_fix","documentable":null,"cci":["CCI-001499"],"nist":["CM-5 (6)"]}},{"id":"SV-258977","code":"control 'SV-258977' do\n  title 'The vCenter STS service must disable stack tracing.'\n  desc 'Stack tracing provides debugging information from the application call stacks when a runtime error is encountered. If stack tracing is left enabled, Tomcat will provide this call stack information to the requestor, which could result in the loss of sensitive information or data that could be used to compromise the system.'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@allowTrace = 'true']\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.)\n  desc 'fix', %q(Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to and locate:\n\n'allowTrace=\"true\"'\n\nRemove the 'allowTrace=\"true\"' setting.\n\nNote: If \"allowTrace\" is not present, it defaults to false.\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts)\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62717r934587_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258977'\n  tag rid: 'SV-258977r934589_rule'\n  tag stig_id: 'VCST-80-000036'\n  tag gtitle: 'SRG-APP-000141-AS-000095'\n  tag fix_id: 'F-62626r934588_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258977.rb"},"title":"The vCenter STS service must disable stack tracing.","desc":"Stack tracing provides debugging information from the application call stacks when a runtime error is encountered. If stack tracing is left enabled, Tomcat will provide this call stack information to the requestor, which could result in the loss of sensitive information or data that could be used to compromise the system.","descriptions":{"default":"Stack tracing provides debugging information from the application call stacks when a runtime error is encountered. If stack tracing is left enabled, Tomcat will provide this call stack information to the requestor, which could result in the loss of sensitive information or data that could be used to compromise the system.","check":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@allowTrace = 'true']\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to and locate:\n\n'allowTrace=\"true\"'\n\nRemove the 'allowTrace=\"true\"' setting.\n\nNote: If \"allowTrace\" is not present, it defaults to false.\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62717r934587_chk","severity":"medium","gid":"V-258977","rid":"SV-258977r934589_rule","stig_id":"VCST-80-000036","gtitle":"SRG-APP-000141-AS-000095","fix_id":"F-62626r934588_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-258978","code":"control 'SV-258978' do\n  title 'The vCenter STS service must be configured to use a specified IP address and port.'\n  desc 'The server must be configured to listen on a specified IP address and port. Without specifying an IP address and port for server to use, the server will listen on all IP addresses available.\n\nAccessing the hosted application through an IP address normally used for nonapplication functions opens the possibility of user access to resources, utilities, files, ports, and protocols that are protected on the desired application IP address.'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --xpath '//Connector[not(@port = \"${bio-ssl-clientauth.https.port}\") and (@port = \"0\" or not(@address))]' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nThe STS service has 2 connectors with the below pairs of ports and addresses.\n\nNavigate to the target <Connector> node and configure the port and address as follows.\n\nport=\"${bio-custom.http.port}\"\naddress=\"localhost\"\n\nport=\"${bio-ssl-localhost.https.port}\"\naddress=\"localhost\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts\n\nNote: The connector with port=\"${bio-ssl-clientauth.https.port}\" should not have address set.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62718r934590_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258978'\n  tag rid: 'SV-258978r934592_rule'\n  tag stig_id: 'VCST-80-000037'\n  tag gtitle: 'SRG-APP-000142-AS-000014'\n  tag fix_id: 'F-62627r934591_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000382']\n  tag nist: ['CM-7 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258978.rb"},"title":"The vCenter STS service must be configured to use a specified IP address and port.","desc":"The server must be configured to listen on a specified IP address and port. Without specifying an IP address and port for server to use, the server will listen on all IP addresses available.\n\nAccessing the hosted application through an IP address normally used for nonapplication functions opens the possibility of user access to resources, utilities, files, ports, and protocols that are protected on the desired application IP address.","descriptions":{"default":"The server must be configured to listen on a specified IP address and port. Without specifying an IP address and port for server to use, the server will listen on all IP addresses available.\n\nAccessing the hosted application through an IP address normally used for nonapplication functions opens the possibility of user access to resources, utilities, files, ports, and protocols that are protected on the desired application IP address.","check":"At the command prompt, run the following command:\n\n# xmllint --xpath '//Connector[not(@port = \"${bio-ssl-clientauth.https.port}\") and (@port = \"0\" or not(@address))]' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nThe STS service has 2 connectors with the below pairs of ports and addresses.\n\nNavigate to the target <Connector> node and configure the port and address as follows.\n\nport=\"${bio-custom.http.port}\"\naddress=\"localhost\"\n\nport=\"${bio-ssl-localhost.https.port}\"\naddress=\"localhost\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts\n\nNote: The connector with port=\"${bio-ssl-clientauth.https.port}\" should not have address set."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62718r934590_chk","severity":"medium","gid":"V-258978","rid":"SV-258978r934592_rule","stig_id":"VCST-80-000037","gtitle":"SRG-APP-000142-AS-000014","fix_id":"F-62627r934591_fix","documentable":null,"cci":["CCI-000382"],"nist":["CM-7 b"]}},{"id":"SV-258979","code":"control 'SV-258979' do\n  title 'The vCenter STS service must be configured to limit data exposure between applications.'\n  desc 'If RECYCLE_FACADES is true or if a security manager is in use, a new facade object will be created for each request. This reduces the chances that a bug in an application might expose data from one request to another.'\n  desc 'check', 'At the command line, run the following command:\n\n# grep RECYCLE_FACADES /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.connector.RECYCLE_FACADES=true\n\nIf \"org.apache.catalina.connector.RECYCLE_FACADES\" is not set to \"true\", this is a finding.\n\nIf the \"org.apache.catalina.connector.RECYCLE_FACADES\" setting does not exist, this is not a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nUpdate or remove the following line:\n\norg.apache.catalina.connector.RECYCLE_FACADES=true\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62719r934593_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258979'\n  tag rid: 'SV-258979r934595_rule'\n  tag stig_id: 'VCST-80-000057'\n  tag gtitle: 'SRG-APP-000223-AS-000150'\n  tag fix_id: 'F-62628r934594_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001664']\n  tag nist: ['SC-23 (3)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258979.rb"},"title":"The vCenter STS service must be configured to limit data exposure between applications.","desc":"If RECYCLE_FACADES is true or if a security manager is in use, a new facade object will be created for each request. This reduces the chances that a bug in an application might expose data from one request to another.","descriptions":{"default":"If RECYCLE_FACADES is true or if a security manager is in use, a new facade object will be created for each request. This reduces the chances that a bug in an application might expose data from one request to another.","check":"At the command line, run the following command:\n\n# grep RECYCLE_FACADES /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.connector.RECYCLE_FACADES=true\n\nIf \"org.apache.catalina.connector.RECYCLE_FACADES\" is not set to \"true\", this is a finding.\n\nIf the \"org.apache.catalina.connector.RECYCLE_FACADES\" setting does not exist, this is not a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nUpdate or remove the following line:\n\norg.apache.catalina.connector.RECYCLE_FACADES=true\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62719r934593_chk","severity":"medium","gid":"V-258979","rid":"SV-258979r934595_rule","stig_id":"VCST-80-000057","gtitle":"SRG-APP-000223-AS-000150","fix_id":"F-62628r934594_fix","documentable":null,"cci":["CCI-001664"],"nist":["SC-23 (3)"]}},{"id":"SV-258980","code":"control 'SV-258980' do\n  title 'The vCenter STS service must be configured to fail to a known safe state if system initialization fails.'\n  desc 'Determining a safe state for failure and weighing that against a potential denial of service for users depends on what type of application the web server is hosting. It is preferable that the service abort startup on any initialization failure rather than continuing in a degraded, and potentially insecure, state.'\n  desc 'check', 'At the command line, run the following command:\n\n# grep EXIT_ON_INIT_FAILURE /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nIf there are no results, or if the \"org.apache.catalina.startup.EXIT_ON_INIT_FAILURE\" is not set to \"true\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62720r934596_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258980'\n  tag rid: 'SV-258980r934598_rule'\n  tag stig_id: 'VCST-80-000062'\n  tag gtitle: 'SRG-APP-000225-AS-000166'\n  tag fix_id: 'F-62629r934597_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001190']\n  tag nist: ['SC-24']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258980.rb"},"title":"The vCenter STS service must be configured to fail to a known safe state if system initialization fails.","desc":"Determining a safe state for failure and weighing that against a potential denial of service for users depends on what type of application the web server is hosting. It is preferable that the service abort startup on any initialization failure rather than continuing in a degraded, and potentially insecure, state.","descriptions":{"default":"Determining a safe state for failure and weighing that against a potential denial of service for users depends on what type of application the web server is hosting. It is preferable that the service abort startup on any initialization failure rather than continuing in a degraded, and potentially insecure, state.","check":"At the command line, run the following command:\n\n# grep EXIT_ON_INIT_FAILURE /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nIf there are no results, or if the \"org.apache.catalina.startup.EXIT_ON_INIT_FAILURE\" is not set to \"true\", this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nAdd or change the following line:\n\norg.apache.catalina.startup.EXIT_ON_INIT_FAILURE=true\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62720r934596_chk","severity":"medium","gid":"V-258980","rid":"SV-258980r934598_rule","stig_id":"VCST-80-000062","gtitle":"SRG-APP-000225-AS-000166","fix_id":"F-62629r934597_fix","documentable":null,"cci":["CCI-001190"],"nist":["SC-24"]}},{"id":"SV-258981","code":"control 'SV-258981' do\n  title 'The vCenter STS service must set URIEncoding to UTF-8.'\n  desc \"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.\n\nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or bypass security checks.\"\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@URIEncoding != 'UTF-8'] | //Connector[not[@URIEncoding]]\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nURIEncoding=\"UTF-8\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62721r934599_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258981'\n  tag rid: 'SV-258981r934601_rule'\n  tag stig_id: 'VCST-80-000065'\n  tag gtitle: 'SRG-APP-000251-AS-000165'\n  tag fix_id: 'F-62630r934600_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001310']\n  tag nist: ['SI-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258981.rb"},"title":"The vCenter STS service must set URIEncoding to UTF-8.","desc":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.\n\nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or bypass security checks.","descriptions":{"default":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.\n\nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or bypass security checks.","check":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@URIEncoding != 'UTF-8'] | //Connector[not[@URIEncoding]]\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nURIEncoding=\"UTF-8\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62721r934599_chk","severity":"medium","gid":"V-258981","rid":"SV-258981r934601_rule","stig_id":"VCST-80-000065","gtitle":"SRG-APP-000251-AS-000165","fix_id":"F-62630r934600_fix","documentable":null,"cci":["CCI-001310"],"nist":["SI-10"]}},{"id":"SV-258982","code":"control 'SV-258982' do\n  title 'The vCenter STS service \"ErrorReportValve showServerInfo\" must be set to \"false\".'\n  desc 'The Error Report Valve is a simple error handler for HTTP status codes that will generate and return HTML error pages. It can also be configured to return predefined static HTML pages for specific status codes and/or exception types. Disabling \"showServerInfo\" will only return the HTTP status code and remove all CSS from the default nonerror-related HTTP responses.'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.ErrorReportValve\"]' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExample result:\n\n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showServerInfo=\"false\" showReport=\"false\"/>\n\nIf the \"ErrorReportValve\" element is not defined or \"showServerInfo\" is not set to \"false\", this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nLocate the following Host block:\n\n<Host ...>\n...\n</Host>\n\nInside this block, add or update the following on a new line:\n\n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showServerInfo=\"false\" showReport=\"false\"/>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62722r934602_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258982'\n  tag rid: 'SV-258982r934604_rule'\n  tag stig_id: 'VCST-80-000067'\n  tag gtitle: 'SRG-APP-000266-AS-000169'\n  tag fix_id: 'F-62631r934603_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258982.rb"},"title":"The vCenter STS service \"ErrorReportValve showServerInfo\" must be set to \"false\".","desc":"The Error Report Valve is a simple error handler for HTTP status codes that will generate and return HTML error pages. It can also be configured to return predefined static HTML pages for specific status codes and/or exception types. Disabling \"showServerInfo\" will only return the HTTP status code and remove all CSS from the default nonerror-related HTTP responses.","descriptions":{"default":"The Error Report Valve is a simple error handler for HTTP status codes that will generate and return HTML error pages. It can also be configured to return predefined static HTML pages for specific status codes and/or exception types. Disabling \"showServerInfo\" will only return the HTTP status code and remove all CSS from the default nonerror-related HTTP responses.","check":"At the command prompt, run the following command:\n\n# xmllint --xpath '/Server/Service/Engine/Host/Valve[@className=\"org.apache.catalina.valves.ErrorReportValve\"]' /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExample result:\n\n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showServerInfo=\"false\" showReport=\"false\"/>\n\nIf the \"ErrorReportValve\" element is not defined or \"showServerInfo\" is not set to \"false\", this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nLocate the following Host block:\n\n<Host ...>\n...\n</Host>\n\nInside this block, add or update the following on a new line:\n\n<Valve className=\"org.apache.catalina.valves.ErrorReportValve\" showServerInfo=\"false\" showReport=\"false\"/>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62722r934602_chk","severity":"medium","gid":"V-258982","rid":"SV-258982r934604_rule","stig_id":"VCST-80-000067","gtitle":"SRG-APP-000266-AS-000169","fix_id":"F-62631r934603_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-258983","code":"control 'SV-258983' do\n  title 'The vCenter STS service must set an inactive timeout for sessions.'\n  desc 'Leaving sessions open indefinitely is a major security risk. An attacker can easily use an already authenticated session to access the hosted application as the previously authenticated user. By closing sessions after a set period of inactivity, the web server can make certain that those sessions that are not closed through the user logging out of an application are eventually closed.\n\n'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/session-timeout' -\n\nExample result:\n\n<session-timeout>30</session-timeout>\n\nIf the value of \"session-timeout\" is not \"30\" or less, or is missing, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the <session-config> node and configure the <session-timeout> as follows:\n\n<session-config>\n  <session-timeout>30</session-timeout>\n  <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n  </cookie-config>\n</session-config>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62723r934605_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258983'\n  tag rid: 'SV-258983r934607_rule'\n  tag stig_id: 'VCST-80-000070'\n  tag gtitle: 'SRG-APP-000295-AS-000263'\n  tag fix_id: 'F-62632r934606_fix'\n  tag satisfies: ['SRG-APP-000295-AS-000263', 'SRG-APP-000389-AS-000253']\n  tag 'documentable'\n  tag cci: ['CCI-002038', 'CCI-002361']\n  tag nist: ['IA-11', 'AC-12']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258983.rb"},"title":"The vCenter STS service must set an inactive timeout for sessions.","desc":"Leaving sessions open indefinitely is a major security risk. An attacker can easily use an already authenticated session to access the hosted application as the previously authenticated user. By closing sessions after a set period of inactivity, the web server can make certain that those sessions that are not closed through the user logging out of an application are eventually closed.\n\n","descriptions":{"default":"Leaving sessions open indefinitely is a major security risk. An attacker can easily use an already authenticated session to access the hosted application as the previously authenticated user. By closing sessions after a set period of inactivity, the web server can make certain that those sessions that are not closed through the user logging out of an application are eventually closed.\n\n","check":"At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/session-timeout' -\n\nExample result:\n\n<session-timeout>30</session-timeout>\n\nIf the value of \"session-timeout\" is not \"30\" or less, or is missing, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the <session-config> node and configure the <session-timeout> as follows:\n\n<session-config>\n  <session-timeout>30</session-timeout>\n  <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n  </cookie-config>\n</session-config>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62723r934605_chk","severity":"medium","gid":"V-258983","rid":"SV-258983r934607_rule","stig_id":"VCST-80-000070","gtitle":"SRG-APP-000295-AS-000263","fix_id":"F-62632r934606_fix","satisfies":["SRG-APP-000295-AS-000263","SRG-APP-000389-AS-000253"],"documentable":null,"cci":["CCI-002038","CCI-002361"],"nist":["IA-11","AC-12"]}},{"id":"SV-258984","code":"control 'SV-258984' do\n  title 'The vCenter STS service must offload log records onto a different system or media from the system being logged.'\n  desc 'Information system logging capability is critical for accurate forensic analysis. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nOffloading is a common process in information systems with limited log storage capacity.\n\nCentralized management of log records provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. Application servers and their related components are required to offload log records onto a different system or media than the system being logged.'\n  desc 'check', 'By default, a vmware-services-sso-services.conf rsyslog configuration file includes the service logs when syslog is configured on vCenter, but it must be verified.\n\nAt the command prompt, run the following command:\n\n# cat /etc/vmware-syslog/vmware-services-sso-services.conf\n\nExpected result:\n\n#vmidentity logs\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/activedirectoryservice.log\"\n      Tag=\"activedirectoryservice\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/lookupsvc-init.log\"\n      Tag=\"ssolookupsvc-init\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/openidconnect.log\"\n      Tag=\"openidconnect\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/ssoAdminServer.log\"\n      Tag=\"ssoadminserver\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/svcaccountmgmt.log\"\n      Tag=\"svcaccountmgmt\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tokenservice.log\"\n      Tag=\"tokenservice\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\n#sts health log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-health-status.log\"\n      Tag=\"sts-health-status\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2} [[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2},[[:digit:]]{0,4}\"\n      Facility=\"local0\")\n#sts runtime log stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-runtime.log.stdout\"\n      Tag=\"sts-runtime-stdout\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#sts runtime log stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-runtime.log.stderr\"\n      Tag=\"sts-runtime-stderr\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#gclogFile.0.current log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/gclogFile.*.current\"\n      Tag=\"gclog\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}+[[:digit:]]{0,4}\"\n      Facility=\"local0\")\n#identity sts default\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts-default.log\"\n      Tag=\"sso-identity-sts-default\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity sts\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts.log\"\n      Tag=\"sso-identity-sts\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity perf\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts-perf.log\"\n      Tag=\"sso-identity-perf\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity prestart\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-prestart.log\"\n      Tag=\"sso-identity-prestart\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest idm\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-idm.log\"\n      Tag=\"sso-rest-idm\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest vmdir\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-vmdir.log\"\n      Tag=\"sso-rest-vmdir\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest afd\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-afd.log\"\n      Tag=\"sso-rest-afd\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#websso\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/websso.log\"\n      Tag=\"sso-websso\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat catalina\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/catalina.*.log\"\n      Tag=\"sso-tomcat-catalina\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat localhost\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/localhost.*.log\"\n      Tag=\"sso-tomcat-localhost\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat localhost access\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/localhost_access.log\"\n      Tag=\"sso-tomcat-localhost-access\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#vmdir log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vmdir/*.log\"\n      Tag=\"vmdir\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#vmafd log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vmafd/*.log\"\n      Tag=\"vmafd\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/vmware-syslog/vmware-services-sso-services.conf\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\n#vmidentity logs\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/activedirectoryservice.log\"\n      Tag=\"activedirectoryservice\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/lookupsvc-init.log\"\n      Tag=\"ssolookupsvc-init\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/openidconnect.log\"\n      Tag=\"openidconnect\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/ssoAdminServer.log\"\n      Tag=\"ssoadminserver\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/svcaccountmgmt.log\"\n      Tag=\"svcaccountmgmt\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tokenservice.log\"\n      Tag=\"tokenservice\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\n#sts health log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-health-status.log\"\n      Tag=\"sts-health-status\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2} [[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2},[[:digit:]]{0,4}\"\n      Facility=\"local0\")\n#sts runtime log stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-runtime.log.stdout\"\n      Tag=\"sts-runtime-stdout\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#sts runtime log stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-runtime.log.stderr\"\n      Tag=\"sts-runtime-stderr\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#gclogFile.0.current log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/gclogFile.*.current\"\n      Tag=\"gclog\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}+[[:digit:]]{0,4}\"\n      Facility=\"local0\")\n#identity sts default\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts-default.log\"\n      Tag=\"sso-identity-sts-default\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity sts\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts.log\"\n      Tag=\"sso-identity-sts\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity perf\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts-perf.log\"\n      Tag=\"sso-identity-perf\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity prestart\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-prestart.log\"\n      Tag=\"sso-identity-prestart\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest idm\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-idm.log\"\n      Tag=\"sso-rest-idm\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest vmdir\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-vmdir.log\"\n      Tag=\"sso-rest-vmdir\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest afd\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-afd.log\"\n      Tag=\"sso-rest-afd\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#websso\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/websso.log\"\n      Tag=\"sso-websso\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat catalina\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/catalina.*.log\"\n      Tag=\"sso-tomcat-catalina\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat localhost\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/localhost.*.log\"\n      Tag=\"sso-tomcat-localhost\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat localhost access\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/localhost_access.log\"\n      Tag=\"sso-tomcat-localhost-access\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#vmdir log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vmdir/*.log\"\n      Tag=\"vmdir\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#vmafd log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vmafd/*.log\"\n      Tag=\"vmafd\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62724r934608_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258984'\n  tag rid: 'SV-258984r934610_rule'\n  tag stig_id: 'VCST-80-000081'\n  tag gtitle: 'SRG-APP-000358-AS-000064'\n  tag fix_id: 'F-62633r934609_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258984.rb"},"title":"The vCenter STS service must offload log records onto a different system or media from the system being logged.","desc":"Information system logging capability is critical for accurate forensic analysis. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nOffloading is a common process in information systems with limited log storage capacity.\n\nCentralized management of log records provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. Application servers and their related components are required to offload log records onto a different system or media than the system being logged.","descriptions":{"default":"Information system logging capability is critical for accurate forensic analysis. Log record content that may be necessary to satisfy the requirement of this control includes, but is not limited to, time stamps, source and destination IP addresses, user/process identifiers, event descriptions, application-specific events, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nOffloading is a common process in information systems with limited log storage capacity.\n\nCentralized management of log records provides for efficiency in maintenance and management of records, as well as the backup and archiving of those records. Application servers and their related components are required to offload log records onto a different system or media than the system being logged.","check":"By default, a vmware-services-sso-services.conf rsyslog configuration file includes the service logs when syslog is configured on vCenter, but it must be verified.\n\nAt the command prompt, run the following command:\n\n# cat /etc/vmware-syslog/vmware-services-sso-services.conf\n\nExpected result:\n\n#vmidentity logs\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/activedirectoryservice.log\"\n      Tag=\"activedirectoryservice\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/lookupsvc-init.log\"\n      Tag=\"ssolookupsvc-init\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/openidconnect.log\"\n      Tag=\"openidconnect\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/ssoAdminServer.log\"\n      Tag=\"ssoadminserver\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/svcaccountmgmt.log\"\n      Tag=\"svcaccountmgmt\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tokenservice.log\"\n      Tag=\"tokenservice\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\n#sts health log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-health-status.log\"\n      Tag=\"sts-health-status\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2} [[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2},[[:digit:]]{0,4}\"\n      Facility=\"local0\")\n#sts runtime log stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-runtime.log.stdout\"\n      Tag=\"sts-runtime-stdout\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#sts runtime log stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-runtime.log.stderr\"\n      Tag=\"sts-runtime-stderr\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#gclogFile.0.current log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/gclogFile.*.current\"\n      Tag=\"gclog\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}+[[:digit:]]{0,4}\"\n      Facility=\"local0\")\n#identity sts default\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts-default.log\"\n      Tag=\"sso-identity-sts-default\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity sts\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts.log\"\n      Tag=\"sso-identity-sts\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity perf\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts-perf.log\"\n      Tag=\"sso-identity-perf\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity prestart\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-prestart.log\"\n      Tag=\"sso-identity-prestart\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest idm\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-idm.log\"\n      Tag=\"sso-rest-idm\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest vmdir\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-vmdir.log\"\n      Tag=\"sso-rest-vmdir\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest afd\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-afd.log\"\n      Tag=\"sso-rest-afd\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#websso\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/websso.log\"\n      Tag=\"sso-websso\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat catalina\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/catalina.*.log\"\n      Tag=\"sso-tomcat-catalina\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat localhost\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/localhost.*.log\"\n      Tag=\"sso-tomcat-localhost\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat localhost access\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/localhost_access.log\"\n      Tag=\"sso-tomcat-localhost-access\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#vmdir log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vmdir/*.log\"\n      Tag=\"vmdir\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#vmafd log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vmafd/*.log\"\n      Tag=\"vmafd\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open:\n\n/etc/vmware-syslog/vmware-services-sso-services.conf\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\n#vmidentity logs\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/activedirectoryservice.log\"\n      Tag=\"activedirectoryservice\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/lookupsvc-init.log\"\n      Tag=\"ssolookupsvc-init\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/openidconnect.log\"\n      Tag=\"openidconnect\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/ssoAdminServer.log\"\n      Tag=\"ssoadminserver\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/svcaccountmgmt.log\"\n      Tag=\"svcaccountmgmt\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tokenservice.log\"\n      Tag=\"tokenservice\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}Z\"\n      Facility=\"local0\")\n#sts health log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-health-status.log\"\n      Tag=\"sts-health-status\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2} [[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2},[[:digit:]]{0,4}\"\n      Facility=\"local0\")\n#sts runtime log stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-runtime.log.stdout\"\n      Tag=\"sts-runtime-stdout\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#sts runtime log stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-runtime.log.stderr\"\n      Tag=\"sts-runtime-stderr\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#gclogFile.0.current log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/gclogFile.*.current\"\n      Tag=\"gclog\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      startmsg.regex=\"^[[:digit:]]{4}-[[:digit:]]{1,2}-[[:digit:]]{1,2}T[[:digit:]]{1,2}:[[:digit:]]{1,2}:[[:digit:]]{1,2}.[[:digit:]]{0,3}+[[:digit:]]{0,4}\"\n      Facility=\"local0\")\n#identity sts default\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts-default.log\"\n      Tag=\"sso-identity-sts-default\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity sts\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts.log\"\n      Tag=\"sso-identity-sts\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity perf\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-identity-sts-perf.log\"\n      Tag=\"sso-identity-perf\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#identity prestart\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/sts-prestart.log\"\n      Tag=\"sso-identity-prestart\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest idm\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-idm.log\"\n      Tag=\"sso-rest-idm\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest vmdir\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-vmdir.log\"\n      Tag=\"sso-rest-vmdir\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rest afd\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/vmware-rest-afd.log\"\n      Tag=\"sso-rest-afd\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#websso\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/websso.log\"\n      Tag=\"sso-websso\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat catalina\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/catalina.*.log\"\n      Tag=\"sso-tomcat-catalina\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat localhost\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/localhost.*.log\"\n      Tag=\"sso-tomcat-localhost\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#tomcat localhost access\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/sso/tomcat/localhost_access.log\"\n      Tag=\"sso-tomcat-localhost-access\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#vmdir log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vmdir/*.log\"\n      Tag=\"vmdir\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#vmafd log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/vmafd/*.log\"\n      Tag=\"vmafd\"\n      PersistStateInterval=\"200\"\n      Severity=\"info\"\n      Facility=\"local0\")"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62724r934608_chk","severity":"medium","gid":"V-258984","rid":"SV-258984r934610_rule","stig_id":"VCST-80-000081","gtitle":"SRG-APP-000358-AS-000064","fix_id":"F-62633r934609_fix","documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}},{"id":"SV-258985","code":"control 'SV-258985' do\n  title 'The vCenter STS service must limit the amount of time that each Transmission Control Protocol (TCP) connection is kept alive.'\n  desc 'Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests.\n\nIn Tomcat, the \"connectionTimeout\" attribute sets the number of milliseconds the server will wait after accepting a connection for the request Uniform Resource Identifier (URI) line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.'\n  desc 'check', %q(The connection timeout should not be disabled by setting it to \"-1\".\n\nAt the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@connectionTimeout = '-1']\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nconnectionTimeout=\"60000\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62725r934611_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258985'\n  tag rid: 'SV-258985r934613_rule'\n  tag stig_id: 'VCST-80-000125'\n  tag gtitle: 'SRG-APP-000001-AS-000001'\n  tag fix_id: 'F-62634r934612_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258985.rb"},"title":"The vCenter STS service must limit the amount of time that each Transmission Control Protocol (TCP) connection is kept alive.","desc":"Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests.\n\nIn Tomcat, the \"connectionTimeout\" attribute sets the number of milliseconds the server will wait after accepting a connection for the request Uniform Resource Identifier (URI) line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.","descriptions":{"default":"Denial of service (DoS) is one threat against web servers. Many DoS attacks attempt to consume web server resources in such a way that no more resources are available to satisfy legitimate requests.\n\nIn Tomcat, the \"connectionTimeout\" attribute sets the number of milliseconds the server will wait after accepting a connection for the request Uniform Resource Identifier (URI) line to be presented. This timeout will also be used when reading the request body (if any). This prevents idle sockets that are not sending HTTP requests from consuming system resources and potentially denying new connections.","check":"The connection timeout should not be disabled by setting it to \"-1\".\n\nAt the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@connectionTimeout = '-1']\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nconnectionTimeout=\"60000\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62725r934611_chk","severity":"medium","gid":"V-258985","rid":"SV-258985r934613_rule","stig_id":"VCST-80-000125","gtitle":"SRG-APP-000001-AS-000001","fix_id":"F-62634r934612_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-258986","code":"control 'SV-258986' do\n  title 'The vCenter STS service must limit the number of times that each Transmission Control Protocol (TCP) connection is kept alive.'\n  desc 'KeepAlive provides long lived HTTP sessions that allow multiple requests to be sent over the same connection. Enabling KeepAlive mitigates the effects of several types of denial-of-service attacks.\n\nAn advantage of KeepAlive is the reduced latency in subsequent requests (no handshaking). However, a disadvantage is that server resources are not available to handle other requests while a connection is maintained between the server and the client.\n\nTomcat can be configured to limit the number of subsequent requests that one client can submit to the server over an established connection. This limit helps provide a balance between the advantages of KeepAlive, while not allowing any one connection being held too long by any one client.'\n  desc 'check', %q(The connection timeout should not be unlimited by setting it to \"-1\".\n\nAt the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@maxKeepAliveRequests = '-1']\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nmaxKeepAliveRequests=\"100\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62726r934614_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258986'\n  tag rid: 'SV-258986r934616_rule'\n  tag stig_id: 'VCST-80-000126'\n  tag gtitle: 'SRG-APP-000001-AS-000001'\n  tag fix_id: 'F-62635r934615_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258986.rb"},"title":"The vCenter STS service must limit the number of times that each Transmission Control Protocol (TCP) connection is kept alive.","desc":"KeepAlive provides long lived HTTP sessions that allow multiple requests to be sent over the same connection. Enabling KeepAlive mitigates the effects of several types of denial-of-service attacks.\n\nAn advantage of KeepAlive is the reduced latency in subsequent requests (no handshaking). However, a disadvantage is that server resources are not available to handle other requests while a connection is maintained between the server and the client.\n\nTomcat can be configured to limit the number of subsequent requests that one client can submit to the server over an established connection. This limit helps provide a balance between the advantages of KeepAlive, while not allowing any one connection being held too long by any one client.","descriptions":{"default":"KeepAlive provides long lived HTTP sessions that allow multiple requests to be sent over the same connection. Enabling KeepAlive mitigates the effects of several types of denial-of-service attacks.\n\nAn advantage of KeepAlive is the reduced latency in subsequent requests (no handshaking). However, a disadvantage is that server resources are not available to handle other requests while a connection is maintained between the server and the client.\n\nTomcat can be configured to limit the number of subsequent requests that one client can submit to the server over an established connection. This limit helps provide a balance between the advantages of KeepAlive, while not allowing any one connection being held too long by any one client.","check":"The connection timeout should not be unlimited by setting it to \"-1\".\n\nAt the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector[@maxKeepAliveRequests = '-1']\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nXPath set is empty\n\nIf any connectors are returned, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nConfigure the <Connector> node with the value:\n\nmaxKeepAliveRequests=\"100\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62726r934614_chk","severity":"medium","gid":"V-258986","rid":"SV-258986r934616_rule","stig_id":"VCST-80-000126","gtitle":"SRG-APP-000001-AS-000001","fix_id":"F-62635r934615_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-258987","code":"control 'SV-258987' do\n  title 'The vCenter STS service must configure the \"setCharacterEncodingFilter\" filter.'\n  desc %q(Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.\n\nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. VMware uses the standard Tomcat \"SetCharacterEncodingFilter\" to provide a layer of defense against character encoding attacks. Filters are Java objects that perform filtering tasks on the request to a resource (a servlet or static content), on the response from a resource, or both.)\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --xpath \"//*[contains(text(), 'setCharacterEncodingFilter')]/parent::*\" /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nExpected result:\n\n<filter-mapping>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <url-pattern>/*</url-pattern>\n</filter-mapping>\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <async-supported>true</async-supported>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n  </init-param>\n  <init-param>\n    <param-name>ignore</param-name>\n    <param-value>true</param-value>\n  </init-param>\n</filter>\n\nIf the output is does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nConfigure the <web-app> node with the child nodes listed below:\n\n<filter-mapping>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <url-pattern>/*</url-pattern>\n</filter-mapping>\n\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <async-supported>true</async-supported>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n  </init-param>\n  <init-param>\n    <param-name>ignore</param-name>\n    <param-value>true</param-value>\n  </init-param>\n</filter>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62727r934617_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258987'\n  tag rid: 'SV-258987r934619_rule'\n  tag stig_id: 'VCST-80-000127'\n  tag gtitle: 'SRG-APP-000251-AS-000165'\n  tag fix_id: 'F-62636r934618_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001310']\n  tag nist: ['SI-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258987.rb"},"title":"The vCenter STS service must configure the \"setCharacterEncodingFilter\" filter.","desc":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.\n\nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. VMware uses the standard Tomcat \"SetCharacterEncodingFilter\" to provide a layer of defense against character encoding attacks. Filters are Java objects that perform filtering tasks on the request to a resource (a servlet or static content), on the response from a resource, or both.","descriptions":{"default":"Invalid user input occurs when a user inserts data or characters into a hosted application's data entry field and the hosted application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.\n\nAn attacker can also enter Unicode characters into hosted applications in an effort to break out of the document home or root home directory or to bypass security checks. VMware uses the standard Tomcat \"SetCharacterEncodingFilter\" to provide a layer of defense against character encoding attacks. Filters are Java objects that perform filtering tasks on the request to a resource (a servlet or static content), on the response from a resource, or both.","check":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//*[contains(text(), 'setCharacterEncodingFilter')]/parent::*\" /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nExpected result:\n\n<filter-mapping>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <url-pattern>/*</url-pattern>\n</filter-mapping>\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <async-supported>true</async-supported>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n  </init-param>\n  <init-param>\n    <param-name>ignore</param-name>\n    <param-value>true</param-value>\n  </init-param>\n</filter>\n\nIf the output is does not match the expected result, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nConfigure the <web-app> node with the child nodes listed below:\n\n<filter-mapping>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <url-pattern>/*</url-pattern>\n</filter-mapping>\n\n<filter>\n  <filter-name>setCharacterEncodingFilter</filter-name>\n  <filter-class>org.apache.catalina.filters.SetCharacterEncodingFilter</filter-class>\n  <async-supported>true</async-supported>\n  <init-param>\n    <param-name>encoding</param-name>\n    <param-value>UTF-8</param-value>\n  </init-param>\n  <init-param>\n    <param-name>ignore</param-name>\n    <param-value>true</param-value>\n  </init-param>\n</filter>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62727r934617_chk","severity":"medium","gid":"V-258987","rid":"SV-258987r934619_rule","stig_id":"VCST-80-000127","gtitle":"SRG-APP-000251-AS-000165","fix_id":"F-62636r934618_fix","documentable":null,"cci":["CCI-001310"],"nist":["SI-10"]}},{"id":"SV-258988","code":"control 'SV-258988' do\n  title 'The vCenter STS service cookies must have \"http-only\" flag set.'\n  desc 'Cookies are a common way to save session state over the HTTP(S) protocol. If attackers can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. When a cookie is tagged with the \"HttpOnly\" flag, it tells the browser this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/http-only' -\n\nExpected result:\n\n<http-only>true</http-only>\n\nIf the output does not match the expected result, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the <session-config> node and configure the <http-only> as follows:\n\n<session-config>\n  <session-timeout>30</session-timeout>\n  <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n  </cookie-config>\n</session-config>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62728r934620_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258988'\n  tag rid: 'SV-258988r934622_rule'\n  tag stig_id: 'VCST-80-000129'\n  tag gtitle: 'SRG-APP-000033-AS-000024'\n  tag fix_id: 'F-62637r934621_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000213']\n  tag nist: ['AC-3']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258988.rb"},"title":"The vCenter STS service cookies must have \"http-only\" flag set.","desc":"Cookies are a common way to save session state over the HTTP(S) protocol. If attackers can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. When a cookie is tagged with the \"HttpOnly\" flag, it tells the browser this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.","descriptions":{"default":"Cookies are a common way to save session state over the HTTP(S) protocol. If attackers can compromise session data stored in a cookie, they are better able to launch an attack against the server and its applications. When a cookie is tagged with the \"HttpOnly\" flag, it tells the browser this particular cookie should only be accessed by the originating server. Any attempt to access the cookie from client script is strictly forbidden.","check":"At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '/web-app/session-config/cookie-config/http-only' -\n\nExpected result:\n\n<http-only>true</http-only>\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the <session-config> node and configure the <http-only> as follows:\n\n<session-config>\n  <session-timeout>30</session-timeout>\n  <cookie-config>\n      <http-only>true</http-only>\n      <secure>true</secure>\n  </cookie-config>\n</session-config>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62728r934620_chk","severity":"medium","gid":"V-258988","rid":"SV-258988r934622_rule","stig_id":"VCST-80-000129","gtitle":"SRG-APP-000033-AS-000024","fix_id":"F-62637r934621_fix","documentable":null,"cci":["CCI-000213"],"nist":["AC-3"]}},{"id":"SV-258989","code":"control 'SV-258989' do\n  title 'The vCenter STS service DefaultServlet must be set to \"readonly\" for \"PUT\" and \"DELETE\" commands.'\n  desc 'The default servlet (or DefaultServlet) is a special servlet provided with Tomcat that is called when no other suitable page is found in a particular folder. The DefaultServlet serves static resources as well as directory listings. The DefaultServlet is configured by default with the \"readonly\" parameter set to \"true\" where HTTP commands such as \"PUT\" and \"DELETE\" are rejected.\n\nChanging this to \"false\" allows clients to delete or modify static resources on the server and to upload new resources. DefaultServlet \"readonly\" must be set to \"true\", either literally or by absence (default).'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --xpath \"//*[contains(text(), 'DefaultServlet')]/parent::*\" /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nExample output:\n\n<servlet>\n      <description>File servlet</description>\n      <servlet-name>FileServlet</servlet-name>\n      <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>\n</servlet>\n\nIf the \"readOnly\" param-value for the \"DefaultServlet\" servlet class is set to \"false\", this is a finding.\n\nIf the \"readOnly\" param-value does not exist, this is not a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the /<web-apps>/<servlet>/<servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>/ node and remove the following node:\n\n<init-param>\n      <param-name>readonly</param-name>\n      <param-value>false</param-value>\n</init-param>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62729r934623_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258989'\n  tag rid: 'SV-258989r934625_rule'\n  tag stig_id: 'VCST-80-000130'\n  tag gtitle: 'SRG-APP-000033-AS-000024'\n  tag fix_id: 'F-62638r934624_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000213']\n  tag nist: ['AC-3']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258989.rb"},"title":"The vCenter STS service DefaultServlet must be set to \"readonly\" for \"PUT\" and \"DELETE\" commands.","desc":"The default servlet (or DefaultServlet) is a special servlet provided with Tomcat that is called when no other suitable page is found in a particular folder. The DefaultServlet serves static resources as well as directory listings. The DefaultServlet is configured by default with the \"readonly\" parameter set to \"true\" where HTTP commands such as \"PUT\" and \"DELETE\" are rejected.\n\nChanging this to \"false\" allows clients to delete or modify static resources on the server and to upload new resources. DefaultServlet \"readonly\" must be set to \"true\", either literally or by absence (default).","descriptions":{"default":"The default servlet (or DefaultServlet) is a special servlet provided with Tomcat that is called when no other suitable page is found in a particular folder. The DefaultServlet serves static resources as well as directory listings. The DefaultServlet is configured by default with the \"readonly\" parameter set to \"true\" where HTTP commands such as \"PUT\" and \"DELETE\" are rejected.\n\nChanging this to \"false\" allows clients to delete or modify static resources on the server and to upload new resources. DefaultServlet \"readonly\" must be set to \"true\", either literally or by absence (default).","check":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//*[contains(text(), 'DefaultServlet')]/parent::*\" /usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nExample output:\n\n<servlet>\n      <description>File servlet</description>\n      <servlet-name>FileServlet</servlet-name>\n      <servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>\n</servlet>\n\nIf the \"readOnly\" param-value for the \"DefaultServlet\" servlet class is set to \"false\", this is a finding.\n\nIf the \"readOnly\" param-value does not exist, this is not a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to the /<web-apps>/<servlet>/<servlet-class>org.apache.catalina.servlets.DefaultServlet</servlet-class>/ node and remove the following node:\n\n<init-param>\n      <param-name>readonly</param-name>\n      <param-value>false</param-value>\n</init-param>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62729r934623_chk","severity":"medium","gid":"V-258989","rid":"SV-258989r934625_rule","stig_id":"VCST-80-000130","gtitle":"SRG-APP-000033-AS-000024","fix_id":"F-62638r934624_fix","documentable":null,"cci":["CCI-000213"],"nist":["AC-3"]}},{"id":"SV-258990","code":"control 'SV-258990' do\n  title 'The vCenter STS service shutdown port must be disabled.'\n  desc 'Tomcat by default listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. Setting the port to \"-1\" in $CATALINA_BASE/conf/server.xml instructs Tomcat to not listen for the shutdown command.'\n  desc 'check', %q(At the command prompt, run the following commands:\n\n# xmllint --xpath \"//Server/@port\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n# grep 'base.shutdown.port' /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExample results:\n\nport=\"${base.shutdown.port}\"\nbase.shutdown.port=-1\n\nIf \"port\" does not equal \"${base.shutdown.port}\", this is a finding.\n\nIf \"base.shutdown.port\" does not equal \"-1\", this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nAdd or modify the setting \"base.shutdown.port=-1\" in the \"catalina.properties\" file.\n\nNavigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nConfigure the <Server> node with the value:\n\nport=\"${base.shutdown.port}\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62730r934626_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258990'\n  tag rid: 'SV-258990r934628_rule'\n  tag stig_id: 'VCST-80-000134'\n  tag gtitle: 'SRG-APP-000141-AS-000095'\n  tag fix_id: 'F-62639r934627_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258990.rb"},"title":"The vCenter STS service shutdown port must be disabled.","desc":"Tomcat by default listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. Setting the port to \"-1\" in $CATALINA_BASE/conf/server.xml instructs Tomcat to not listen for the shutdown command.","descriptions":{"default":"Tomcat by default listens on TCP port 8005 to accept shutdown requests. By connecting to this port and sending the SHUTDOWN command, all applications within Tomcat are halted. The shutdown port is not exposed to the network as it is bound to the loopback interface. Setting the port to \"-1\" in $CATALINA_BASE/conf/server.xml instructs Tomcat to not listen for the shutdown command.","check":"At the command prompt, run the following commands:\n\n# xmllint --xpath \"//Server/@port\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n# grep 'base.shutdown.port' /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExample results:\n\nport=\"${base.shutdown.port}\"\nbase.shutdown.port=-1\n\nIf \"port\" does not equal \"${base.shutdown.port}\", this is a finding.\n\nIf \"base.shutdown.port\" does not equal \"-1\", this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nAdd or modify the setting \"base.shutdown.port=-1\" in the \"catalina.properties\" file.\n\nNavigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nConfigure the <Server> node with the value:\n\nport=\"${base.shutdown.port}\"\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62730r934626_chk","severity":"medium","gid":"V-258990","rid":"SV-258990r934628_rule","stig_id":"VCST-80-000134","gtitle":"SRG-APP-000141-AS-000095","fix_id":"F-62639r934627_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-258991","code":"control 'SV-258991' do\n  title 'The vCenter STS service debug parameter must be disabled.'\n  desc 'Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage may be displayed.\n\nBecause this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information.'\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"debug\"]/parent::init-param' -\n\nExample result:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n</init-param>\n\nIf the \"debug\" parameter is specified and is not \"0\", this is a finding.\n\nIf the \"debug\" parameter does not exist, this is not a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to all <debug> nodes that are not set to \"0\".\n\nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the following:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n</init-param>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62731r934629_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258991'\n  tag rid: 'SV-258991r934631_rule'\n  tag stig_id: 'VCST-80-000136'\n  tag gtitle: 'SRG-APP-000141-AS-000095'\n  tag fix_id: 'F-62640r934630_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258991.rb"},"title":"The vCenter STS service debug parameter must be disabled.","desc":"Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage may be displayed.\n\nBecause this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information.","descriptions":{"default":"Information needed by an attacker to begin looking for possible vulnerabilities in a web server includes any information about the web server and plug-ins or modules being used. When debugging or trace information is enabled in a production web server, information about the web server, such as web server type, version, patches installed, plug-ins and modules installed, type of code being used by the hosted application, and any backends being used for data storage may be displayed.\n\nBecause this information may be placed in logs and general messages during normal operation of the web server, an attacker does not need to cause an error condition to gain this information.","check":"At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"debug\"]/parent::init-param' -\n\nExample result:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n</init-param>\n\nIf the \"debug\" parameter is specified and is not \"0\", this is a finding.\n\nIf the \"debug\" parameter does not exist, this is not a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nNavigate to all <debug> nodes that are not set to \"0\".\n\nSet the <param-value> to \"0\" in all <param-name>debug</param-name> nodes.\n\nNote: The debug setting should look like the following:\n\n<init-param>\n      <param-name>debug</param-name>\n      <param-value>0</param-value>\n</init-param>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62731r934629_chk","severity":"medium","gid":"V-258991","rid":"SV-258991r934631_rule","stig_id":"VCST-80-000136","gtitle":"SRG-APP-000141-AS-000095","fix_id":"F-62640r934630_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-258992","code":"control 'SV-258992' do\n  title 'The vCenter STS service directory listings parameter must be disabled.'\n  desc %q(Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring that directory listing is disabled is one approach to mitigating the vulnerability.\n\nIn Tomcat, directory listing is disabled by default but can be enabled via the \"listings\" parameter. Ensure this node is not present to have the default effect.)\n  desc 'check', %q(At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"listings\"]/parent::init-param' -\n\nExample result:\n\nXPath set is empty\n\nIf the \"listings\" parameter is specified and is not \"false\", this is a finding.\n\nIf the \"listings\" parameter does not exist, this is not a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nFind and remove the entire block returned in the check.\n\nExample:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>true</param-value>\n</init-param>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62732r934632_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258992'\n  tag rid: 'SV-258992r934634_rule'\n  tag stig_id: 'VCST-80-000137'\n  tag gtitle: 'SRG-APP-000141-AS-000095'\n  tag fix_id: 'F-62641r934633_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258992.rb"},"title":"The vCenter STS service directory listings parameter must be disabled.","desc":"Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring that directory listing is disabled is one approach to mitigating the vulnerability.\n\nIn Tomcat, directory listing is disabled by default but can be enabled via the \"listings\" parameter. Ensure this node is not present to have the default effect.","descriptions":{"default":"Enumeration techniques, such as URL parameter manipulation, rely on being able to obtain information about the web server's directory structure by locating directories without default pages. In this scenario, the web server will display to the user a listing of the files in the directory being accessed. Ensuring that directory listing is disabled is one approach to mitigating the vulnerability.\n\nIn Tomcat, directory listing is disabled by default but can be enabled via the \"listings\" parameter. Ensure this node is not present to have the default effect.","check":"At the command prompt, run the following command:\n\n# xmllint --format /usr/lib/vmware-sso/vmware-sts/conf/web.xml | sed 's/xmlns=\".*\"//g' | xmllint --xpath '//param-name[text()=\"listings\"]/parent::init-param' -\n\nExample result:\n\nXPath set is empty\n\nIf the \"listings\" parameter is specified and is not \"false\", this is a finding.\n\nIf the \"listings\" parameter does not exist, this is not a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/web.xml\n\nFind and remove the entire block returned in the check.\n\nExample:\n\n<init-param>\n      <param-name>listings</param-name>\n      <param-value>true</param-value>\n</init-param>\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62732r934632_chk","severity":"medium","gid":"V-258992","rid":"SV-258992r934634_rule","stig_id":"VCST-80-000137","gtitle":"SRG-APP-000141-AS-000095","fix_id":"F-62641r934633_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-258993","code":"control 'SV-258993' do\n  title 'The vCenter STS service must have Autodeploy disabled.'\n  desc 'Tomcat allows auto-deployment of applications while it is running. This can allow untested or malicious applications to be automatically loaded into production. Autodeploy must be disabled in production.'\n  desc 'check', 'At the command prompt, run the following command:\n\n# xmllint --xpath \"//Host/@autoDeploy\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nautoDeploy=\"false\"\n\nIf \"autoDeploy\" does not equal \"false\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Host> node and configure with the value \"autoDeploy=\"false\"\".\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62733r934635_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258993'\n  tag rid: 'SV-258993r934637_rule'\n  tag stig_id: 'VCST-80-000139'\n  tag gtitle: 'SRG-APP-000141-AS-000095'\n  tag fix_id: 'F-62642r934636_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258993.rb"},"title":"The vCenter STS service must have Autodeploy disabled.","desc":"Tomcat allows auto-deployment of applications while it is running. This can allow untested or malicious applications to be automatically loaded into production. Autodeploy must be disabled in production.","descriptions":{"default":"Tomcat allows auto-deployment of applications while it is running. This can allow untested or malicious applications to be automatically loaded into production. Autodeploy must be disabled in production.","check":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//Host/@autoDeploy\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExpected result:\n\nautoDeploy=\"false\"\n\nIf \"autoDeploy\" does not equal \"false\", this is a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Host> node and configure with the value \"autoDeploy=\"false\"\".\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62733r934635_chk","severity":"medium","gid":"V-258993","rid":"SV-258993r934637_rule","stig_id":"VCST-80-000139","gtitle":"SRG-APP-000141-AS-000095","fix_id":"F-62642r934636_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-258994","code":"control 'SV-258994' do\n  title 'The vCenter STS service xpoweredBy attribute must be disabled.'\n  desc 'Individual connectors can be configured to display the Tomcat information to clients. This information can be used to identify server versions that can be useful to attackers for identifying vulnerable versions of Tomcat. Individual connectors must be checked for the xpoweredBy attribute to ensure they do not pass server information to clients. The default value for xpoweredBy is \"false\".'\n  desc 'check', 'At the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector/@xpoweredBy\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExample result:\n\nXPath set is empty\n\nIf the \"xpoweredBy\" parameter is specified and is not \"false\", this is a finding.\n\nIf the \"xpoweredBy\" parameter does not exist, this is not a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Connector> node and remove the \"xpoweredBy\" attribute.\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62734r934638_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258994'\n  tag rid: 'SV-258994r934640_rule'\n  tag stig_id: 'VCST-80-000140'\n  tag gtitle: 'SRG-APP-000141-AS-000095'\n  tag fix_id: 'F-62643r934639_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258994.rb"},"title":"The vCenter STS service xpoweredBy attribute must be disabled.","desc":"Individual connectors can be configured to display the Tomcat information to clients. This information can be used to identify server versions that can be useful to attackers for identifying vulnerable versions of Tomcat. Individual connectors must be checked for the xpoweredBy attribute to ensure they do not pass server information to clients. The default value for xpoweredBy is \"false\".","descriptions":{"default":"Individual connectors can be configured to display the Tomcat information to clients. This information can be used to identify server versions that can be useful to attackers for identifying vulnerable versions of Tomcat. Individual connectors must be checked for the xpoweredBy attribute to ensure they do not pass server information to clients. The default value for xpoweredBy is \"false\".","check":"At the command prompt, run the following command:\n\n# xmllint --xpath \"//Connector/@xpoweredBy\" /usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nExample result:\n\nXPath set is empty\n\nIf the \"xpoweredBy\" parameter is specified and is not \"false\", this is a finding.\n\nIf the \"xpoweredBy\" parameter does not exist, this is not a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/server.xml\n\nNavigate to the <Connector> node and remove the \"xpoweredBy\" attribute.\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62734r934638_chk","severity":"medium","gid":"V-258994","rid":"SV-258994r934640_rule","stig_id":"VCST-80-000140","gtitle":"SRG-APP-000141-AS-000095","fix_id":"F-62643r934639_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-258995","code":"control 'SV-258995' do\n  title 'The vCenter STS service example applications must be removed.'\n  desc 'Tomcat provides example applications, documentation, and other directories in the default installation that do not serve a production use. These files must be deleted.'\n  desc 'check', 'At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/examples\n\nIf the examples folder exists or contains any content, this is a finding.'\n  desc 'fix', 'At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/examples'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62735r934641_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258995'\n  tag rid: 'SV-258995r934643_rule'\n  tag stig_id: 'VCST-80-000141'\n  tag gtitle: 'SRG-APP-000141-AS-000095'\n  tag fix_id: 'F-62644r934642_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258995.rb"},"title":"The vCenter STS service example applications must be removed.","desc":"Tomcat provides example applications, documentation, and other directories in the default installation that do not serve a production use. These files must be deleted.","descriptions":{"default":"Tomcat provides example applications, documentation, and other directories in the default installation that do not serve a production use. These files must be deleted.","check":"At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/examples\n\nIf the examples folder exists or contains any content, this is a finding.","fix":"At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/examples"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62735r934641_chk","severity":"medium","gid":"V-258995","rid":"SV-258995r934643_rule","stig_id":"VCST-80-000141","gtitle":"SRG-APP-000141-AS-000095","fix_id":"F-62644r934642_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-258996","code":"control 'SV-258996' do\n  title 'The vCenter STS service default ROOT web application must be removed.'\n  desc 'The default ROOT web application includes the version of Tomcat being used, links to Tomcat documentation, examples, FAQs, and mailing lists. The default ROOT web application must be removed from a publicly accessible instance and a more appropriate default page shown to users.'\n  desc 'check', 'At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/ROOT\n\nIf the ROOT web application contains any content, this is a finding.'\n  desc 'fix', 'At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/ROOT/*'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62736r934644_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258996'\n  tag rid: 'SV-258996r934646_rule'\n  tag stig_id: 'VCST-80-000142'\n  tag gtitle: 'SRG-APP-000141-AS-000095'\n  tag fix_id: 'F-62645r934645_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258996.rb"},"title":"The vCenter STS service default ROOT web application must be removed.","desc":"The default ROOT web application includes the version of Tomcat being used, links to Tomcat documentation, examples, FAQs, and mailing lists. The default ROOT web application must be removed from a publicly accessible instance and a more appropriate default page shown to users.","descriptions":{"default":"The default ROOT web application includes the version of Tomcat being used, links to Tomcat documentation, examples, FAQs, and mailing lists. The default ROOT web application must be removed from a publicly accessible instance and a more appropriate default page shown to users.","check":"At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/ROOT\n\nIf the ROOT web application contains any content, this is a finding.","fix":"At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/ROOT/*"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62736r934644_chk","severity":"medium","gid":"V-258996","rid":"SV-258996r934646_rule","stig_id":"VCST-80-000142","gtitle":"SRG-APP-000141-AS-000095","fix_id":"F-62645r934645_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-258997","code":"control 'SV-258997' do\n  title 'The vCenter STS service default documentation must be removed.'\n  desc 'Tomcat provides documentation and other directories in the default installation that do not serve a production use. These files must be deleted.'\n  desc 'check', 'At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/docs\n\nIf the \"docs\" folder exists or contains any content, this is a finding.'\n  desc 'fix', 'At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/docs'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62737r934647_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258997'\n  tag rid: 'SV-258997r934649_rule'\n  tag stig_id: 'VCST-80-000143'\n  tag gtitle: 'SRG-APP-000141-AS-000095'\n  tag fix_id: 'F-62646r934648_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258997.rb"},"title":"The vCenter STS service default documentation must be removed.","desc":"Tomcat provides documentation and other directories in the default installation that do not serve a production use. These files must be deleted.","descriptions":{"default":"Tomcat provides documentation and other directories in the default installation that do not serve a production use. These files must be deleted.","check":"At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/docs\n\nIf the \"docs\" folder exists or contains any content, this is a finding.","fix":"At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/docs"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62737r934647_chk","severity":"medium","gid":"V-258997","rid":"SV-258997r934649_rule","stig_id":"VCST-80-000143","gtitle":"SRG-APP-000141-AS-000095","fix_id":"F-62646r934648_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-258998","code":"control 'SV-258998' do\n  title 'The vCenter STS service files must have permissions in an out-of-the-box state.'\n  desc 'As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled.'\n  desc 'check', \"At the command prompt, run the following command:\n\n# find /usr/lib/vmware-sso/ -xdev -type f -a '(' -perm -o+w -o -not -user root -o -not -group root ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', 'At the command prompt, run the following commands:\n\n# chmod o-w <file>\n# chown root:root <file>\n\nNote: Substitute <file> with the listed file.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62738r934650_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258998'\n  tag rid: 'SV-258998r934652_rule'\n  tag stig_id: 'VCST-80-000144'\n  tag gtitle: 'SRG-APP-000380-AS-000088'\n  tag fix_id: 'F-62647r934651_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001813']\n  tag nist: ['CM-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258998.rb"},"title":"The vCenter STS service files must have permissions in an out-of-the-box state.","desc":"As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled.","descriptions":{"default":"As a rule, accounts on a web server are to be kept to a minimum. Only administrators, web managers, developers, auditors, and web authors require accounts on the machine hosting the web server. The resources to which these accounts have access must also be closely monitored and controlled.","check":"At the command prompt, run the following command:\n\n# find /usr/lib/vmware-sso/ -xdev -type f -a '(' -perm -o+w -o -not -user root -o -not -group root ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.","fix":"At the command prompt, run the following commands:\n\n# chmod o-w <file>\n# chown root:root <file>\n\nNote: Substitute <file> with the listed file."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62738r934650_chk","severity":"medium","gid":"V-258998","rid":"SV-258998r934652_rule","stig_id":"VCST-80-000144","gtitle":"SRG-APP-000380-AS-000088","fix_id":"F-62647r934651_fix","documentable":null,"cci":["CCI-001813"],"nist":["CM-5 (1) (a)"]}},{"id":"SV-258999","code":"control 'SV-258999' do\n  title 'The vCenter STS service must disable \"ALLOW_BACKSLASH\".'\n  desc 'When Tomcat is installed behind a proxy configured to only allow access to certain contexts (web applications), an HTTP request containing \"/\\\\../\" may allow attackers to work around the proxy restrictions using directory traversal attack methods. If \"allow_backslash\" is \"true\", the \"\\\\\" character will be permitted as a path delimiter. The default value for the setting is \"false\", but Tomcat must always be configured as if no proxy restricting context access was used, and \"allow_backslash\" should be set to \"false\" to prevent directory-traversal-style attacks. This setting can create operability issues with noncompliant clients.'\n  desc 'check', 'At the command line, run the following command:\n\n# grep ALLOW_BACKSLASH /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.connector.ALLOW_BACKSLASH=false\n\nIf \"org.apache.catalina.connector.ALLOW_BACKSLASH\" is not set to \"false\", this is a finding.\n\nIf the \"org.apache.catalina.connector.ALLOW_BACKSLASH\" setting does not exist, this is not a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nUpdate or remove the following line:\n\norg.apache.catalina.connector.ALLOW_BACKSLASH=false\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62739r934653_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258999'\n  tag rid: 'SV-258999r934655_rule'\n  tag stig_id: 'VCST-80-000151'\n  tag gtitle: 'SRG-APP-000516-AS-000237'\n  tag fix_id: 'F-62648r934654_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-258999.rb"},"title":"The vCenter STS service must disable \"ALLOW_BACKSLASH\".","desc":"When Tomcat is installed behind a proxy configured to only allow access to certain contexts (web applications), an HTTP request containing \"/\\../\" may allow attackers to work around the proxy restrictions using directory traversal attack methods. If \"allow_backslash\" is \"true\", the \"\\\" character will be permitted as a path delimiter. The default value for the setting is \"false\", but Tomcat must always be configured as if no proxy restricting context access was used, and \"allow_backslash\" should be set to \"false\" to prevent directory-traversal-style attacks. This setting can create operability issues with noncompliant clients.","descriptions":{"default":"When Tomcat is installed behind a proxy configured to only allow access to certain contexts (web applications), an HTTP request containing \"/\\../\" may allow attackers to work around the proxy restrictions using directory traversal attack methods. If \"allow_backslash\" is \"true\", the \"\\\" character will be permitted as a path delimiter. The default value for the setting is \"false\", but Tomcat must always be configured as if no proxy restricting context access was used, and \"allow_backslash\" should be set to \"false\" to prevent directory-traversal-style attacks. This setting can create operability issues with noncompliant clients.","check":"At the command line, run the following command:\n\n# grep ALLOW_BACKSLASH /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.connector.ALLOW_BACKSLASH=false\n\nIf \"org.apache.catalina.connector.ALLOW_BACKSLASH\" is not set to \"false\", this is a finding.\n\nIf the \"org.apache.catalina.connector.ALLOW_BACKSLASH\" setting does not exist, this is not a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nUpdate or remove the following line:\n\norg.apache.catalina.connector.ALLOW_BACKSLASH=false\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62739r934653_chk","severity":"medium","gid":"V-258999","rid":"SV-258999r934655_rule","stig_id":"VCST-80-000151","gtitle":"SRG-APP-000516-AS-000237","fix_id":"F-62648r934654_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-259000","code":"control 'SV-259000' do\n  title 'The vCenter STS service must enable \"ENFORCE_ENCODING_IN_GET_WRITER\".'\n  desc 'Some clients try to guess the character encoding of text media when the mandated default of ISO-8859-1 should be used. Some browsers will interpret as UTF-7 when the characters are safe for ISO-8859-1. This can create the potential for a XSS attack. To defend against this, enforce_encoding_in_get_writer must be set to true.'\n  desc 'check', 'At the command line, run the following command:\n\n# grep ENFORCE_ENCODING_IN_GET_WRITER /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true\n\nIf \"org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER\" is not set to \"true\", this is a finding.\n\nIf the \"org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER\" setting does not exist, this is not a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nUpdate or remove the following line:\n\norg.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62740r934656_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259000'\n  tag rid: 'SV-259000r934658_rule'\n  tag stig_id: 'VCST-80-000152'\n  tag gtitle: 'SRG-APP-000516-AS-000237'\n  tag fix_id: 'F-62649r934657_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-259000.rb"},"title":"The vCenter STS service must enable \"ENFORCE_ENCODING_IN_GET_WRITER\".","desc":"Some clients try to guess the character encoding of text media when the mandated default of ISO-8859-1 should be used. Some browsers will interpret as UTF-7 when the characters are safe for ISO-8859-1. This can create the potential for a XSS attack. To defend against this, enforce_encoding_in_get_writer must be set to true.","descriptions":{"default":"Some clients try to guess the character encoding of text media when the mandated default of ISO-8859-1 should be used. Some browsers will interpret as UTF-7 when the characters are safe for ISO-8859-1. This can create the potential for a XSS attack. To defend against this, enforce_encoding_in_get_writer must be set to true.","check":"At the command line, run the following command:\n\n# grep ENFORCE_ENCODING_IN_GET_WRITER /usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nExample result:\n\norg.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true\n\nIf \"org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER\" is not set to \"true\", this is a finding.\n\nIf the \"org.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER\" setting does not exist, this is not a finding.","fix":"Navigate to and open:\n\n/usr/lib/vmware-sso/vmware-sts/conf/catalina.properties\n\nUpdate or remove the following line:\n\norg.apache.catalina.connector.response.ENFORCE_ENCODING_IN_GET_WRITER=true\n\nRestart the service with the following command:\n\n# vmon-cli --restart sts"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62740r934656_chk","severity":"medium","gid":"V-259000","rid":"SV-259000r934658_rule","stig_id":"VCST-80-000152","gtitle":"SRG-APP-000516-AS-000237","fix_id":"F-62649r934657_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-259001","code":"control 'SV-259001' do\n  title 'The vCenter STS service manager webapp must be removed.'\n  desc 'Tomcat provides management functionality through either a default manager webapp or through local editing of the configuration files. The manager webapp files must be deleted, and administration must be performed through the local editing of the configuration files.'\n  desc 'check', 'At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/manager\n\nIf the manager folder exists or contains any content, this is a finding.'\n  desc 'fix', 'At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/manager'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62741r934659_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259001'\n  tag rid: 'SV-259001r934661_rule'\n  tag stig_id: 'VCST-80-000154'\n  tag gtitle: 'SRG-APP-000141-AS-000095'\n  tag fix_id: 'F-62650r934660_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-259001.rb"},"title":"The vCenter STS service manager webapp must be removed.","desc":"Tomcat provides management functionality through either a default manager webapp or through local editing of the configuration files. The manager webapp files must be deleted, and administration must be performed through the local editing of the configuration files.","descriptions":{"default":"Tomcat provides management functionality through either a default manager webapp or through local editing of the configuration files. The manager webapp files must be deleted, and administration must be performed through the local editing of the configuration files.","check":"At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/manager\n\nIf the manager folder exists or contains any content, this is a finding.","fix":"At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/manager"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62741r934659_chk","severity":"medium","gid":"V-259001","rid":"SV-259001r934661_rule","stig_id":"VCST-80-000154","gtitle":"SRG-APP-000141-AS-000095","fix_id":"F-62650r934660_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-259002","code":"control 'SV-259002' do\n  title 'The vCenter STS service host-manager webapp must be removed.'\n  desc 'Tomcat provides host management functionality through either a default host-manager webapp or through local editing of the configuration files. The host-manager webapp files must be deleted, and administration must be performed through the local editing of the configuration files.'\n  desc 'check', 'At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/host-manager\n\nIf the manager folder exists or contains any content, this is a finding.'\n  desc 'fix', 'At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/host-manager'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)'\n  tag check_id: 'C-62742r934662_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259002'\n  tag rid: 'SV-259002r934664_rule'\n  tag stig_id: 'VCST-80-000155'\n  tag gtitle: 'SRG-APP-000141-AS-000095'\n  tag fix_id: 'F-62651r934663_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_STS_STIG_V1R1/controls/SV-259002.rb"},"title":"The vCenter STS service host-manager webapp must be removed.","desc":"Tomcat provides host management functionality through either a default host-manager webapp or through local editing of the configuration files. The host-manager webapp files must be deleted, and administration must be performed through the local editing of the configuration files.","descriptions":{"default":"Tomcat provides host management functionality through either a default host-manager webapp or through local editing of the configuration files. The host-manager webapp files must be deleted, and administration must be performed through the local editing of the configuration files.","check":"At the command prompt, run the following command:\n\n# ls -l /var/opt/apache-tomcat/webapps/host-manager\n\nIf the manager folder exists or contains any content, this is a finding.","fix":"At the command prompt, run the following command:\n\n# rm -rf /var/opt/apache-tomcat/webapps/host-manager"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Secure Token Service (STS)"}],"tags":{"check_id":"C-62742r934662_chk","severity":"medium","gid":"V-259002","rid":"SV-259002r934664_rule","stig_id":"VCST-80-000155","gtitle":"SRG-APP-000141-AS-000095","fix_id":"F-62651r934663_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}}],"groups":[{"id":"controls/SV-258970.rb","title":null,"controls":["SV-258970"]},{"id":"controls/SV-258971.rb","title":null,"controls":["SV-258971"]},{"id":"controls/SV-258972.rb","title":null,"controls":["SV-258972"]},{"id":"controls/SV-258973.rb","title":null,"controls":["SV-258973"]},{"id":"controls/SV-258974.rb","title":null,"controls":["SV-258974"]},{"id":"controls/SV-258975.rb","title":null,"controls":["SV-258975"]},{"id":"controls/SV-258976.rb","title":null,"controls":["SV-258976"]},{"id":"controls/SV-258977.rb","title":null,"controls":["SV-258977"]},{"id":"controls/SV-258978.rb","title":null,"controls":["SV-258978"]},{"id":"controls/SV-258979.rb","title":null,"controls":["SV-258979"]},{"id":"controls/SV-258980.rb","title":null,"controls":["SV-258980"]},{"id":"controls/SV-258981.rb","title":null,"controls":["SV-258981"]},{"id":"controls/SV-258982.rb","title":null,"controls":["SV-258982"]},{"id":"controls/SV-258983.rb","title":null,"controls":["SV-258983"]},{"id":"controls/SV-258984.rb","title":null,"controls":["SV-258984"]},{"id":"controls/SV-258985.rb","title":null,"controls":["SV-258985"]},{"id":"controls/SV-258986.rb","title":null,"controls":["SV-258986"]},{"id":"controls/SV-258987.rb","title":null,"controls":["SV-258987"]},{"id":"controls/SV-258988.rb","title":null,"controls":["SV-258988"]},{"id":"controls/SV-258989.rb","title":null,"controls":["SV-258989"]},{"id":"controls/SV-258990.rb","title":null,"controls":["SV-258990"]},{"id":"controls/SV-258991.rb","title":null,"controls":["SV-258991"]},{"id":"controls/SV-258992.rb","title":null,"controls":["SV-258992"]},{"id":"controls/SV-258993.rb","title":null,"controls":["SV-258993"]},{"id":"controls/SV-258994.rb","title":null,"controls":["SV-258994"]},{"id":"controls/SV-258995.rb","title":null,"controls":["SV-258995"]},{"id":"controls/SV-258996.rb","title":null,"controls":["SV-258996"]},{"id":"controls/SV-258997.rb","title":null,"controls":["SV-258997"]},{"id":"controls/SV-258998.rb","title":null,"controls":["SV-258998"]},{"id":"controls/SV-258999.rb","title":null,"controls":["SV-258999"]},{"id":"controls/SV-259000.rb","title":null,"controls":["SV-259000"]},{"id":"controls/SV-259001.rb","title":null,"controls":["SV-259001"]},{"id":"controls/SV-259002.rb","title":null,"controls":["SV-259002"]}],"name":"VMW_vSphere_8-0_VCSA_STS_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"41d84361b7d304b5212563d4e1ac6c4881f0e606910e6e56f39fb0c507565ff3","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
