{"controls":[{"id":"SV-256318","code":"control 'SV-256318' do\n  title 'The vCenter Server must use TLS 1.2, at a minimum, to protect the confidentiality of sensitive data during electronic dissemination using remote access.'\n  desc 'Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.\n\n'\n  desc 'check', 'At the command prompt on the vCenter Server Appliance, run the following command:\n\n# /usr/lib/vmware-TlsReconfigurator/VcTlsReconfigurator/reconfigureVc scan\n\nIf the output indicates versions of TLS other than 1.2 are enabled, this is a finding.'\n  desc 'fix', 'At the command prompt on the vCenter Server Appliance, run the following commands:\n\n# /usr/lib/vmware-TlsReconfigurator/VcTlsReconfigurator/reconfigureVc backup\n\n# /usr/lib/vmware-TlsReconfigurator/VcTlsReconfigurator/reconfigureVc update -p TLSv1.2\n\nvCenter services will be restarted as part of the reconfiguration. The operating system will not be restarted.\n\nThe \"--no-restart\" flag can be added to restart services at a later time.\n\nChanges will not take effect until all services are restarted or the appliance is rebooted.\n\nNote: This change should be performed on vCenter prior to ESXi.'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-59993r885563_chk'\n  tag severity: 'high'\n  tag gid: 'V-256318'\n  tag rid: 'SV-256318r919041_rule'\n  tag stig_id: 'VCSA-70-000009'\n  tag gtitle: 'SRG-APP-000014'\n  tag fix_id: 'F-59936r918988_fix'\n  tag satisfies: ['SRG-APP-000014', 'SRG-APP-000645', 'SRG-APP-000156', 'SRG-APP-000157', 'SRG-APP-000219', 'SRG-APP-000439', 'SRG-APP-000440', 'SRG-APP-000441', 'SRG-APP-000442', 'SRG-APP-000560', 'SRG-APP-000565', 'SRG-APP-000625']\n  tag 'documentable'\n  tag cci: ['CCI-000068', 'CCI-000382', 'CCI-001184', 'CCI-001453', 'CCI-001941', 'CCI-001942', 'CCI-002418', 'CCI-002420', 'CCI-002421', 'CCI-002422', 'CCI-002450']\n  tag nist: ['AC-17 (2)', 'CM-7 b', 'SC-23', 'AC-17 (2)', 'IA-2 (8)', 'IA-2 (9)', 'SC-8', 'SC-8 (2)', 'SC-8 (1)', 'SC-8 (2)', 'SC-13 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256318.rb"},"title":"The vCenter Server must use TLS 1.2, at a minimum, to protect the confidentiality of sensitive data during electronic dissemination using remote access.","desc":"Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.\n\n","descriptions":{"default":"Using older unauthorized versions or incorrectly configuring protocol negotiation makes the gateway vulnerable to known and unknown attacks that exploit vulnerabilities in this protocol.\n\n","check":"At the command prompt on the vCenter Server Appliance, run the following command:\n\n# /usr/lib/vmware-TlsReconfigurator/VcTlsReconfigurator/reconfigureVc scan\n\nIf the output indicates versions of TLS other than 1.2 are enabled, this is a finding.","fix":"At the command prompt on the vCenter Server Appliance, run the following commands:\n\n# /usr/lib/vmware-TlsReconfigurator/VcTlsReconfigurator/reconfigureVc backup\n\n# /usr/lib/vmware-TlsReconfigurator/VcTlsReconfigurator/reconfigureVc update -p TLSv1.2\n\nvCenter services will be restarted as part of the reconfiguration. The operating system will not be restarted.\n\nThe \"--no-restart\" flag can be added to restart services at a later time.\n\nChanges will not take effect until all services are restarted or the appliance is rebooted.\n\nNote: This change should be performed on vCenter prior to ESXi."},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-59993r885563_chk","severity":"high","gid":"V-256318","rid":"SV-256318r919041_rule","stig_id":"VCSA-70-000009","gtitle":"SRG-APP-000014","fix_id":"F-59936r918988_fix","satisfies":["SRG-APP-000014","SRG-APP-000645","SRG-APP-000156","SRG-APP-000157","SRG-APP-000219","SRG-APP-000439","SRG-APP-000440","SRG-APP-000441","SRG-APP-000442","SRG-APP-000560","SRG-APP-000565","SRG-APP-000625"],"documentable":null,"cci":["CCI-000068","CCI-000382","CCI-001184","CCI-001453","CCI-001941","CCI-001942","CCI-002418","CCI-002420","CCI-002421","CCI-002422","CCI-002450"],"nist":["AC-17 (2)","CM-7 b","SC-23","AC-17 (2)","IA-2 (8)","IA-2 (9)","SC-8","SC-8 (2)","SC-8 (1)","SC-8 (2)","SC-13 b"]}},{"id":"SV-256319","code":"control 'SV-256319' do\n  title 'The vCenter Server must enforce the limit of three consecutive invalid login attempts by a user.'\n  desc 'By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy. \n\nThe lockout policy should be set as follows:\n\nMaximum number of failed login attempts: 3 \n\nIf this account lockout policy is not configured as stated, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy.\n\nClick \"Edit\".\n\nSet the \"Maximum number of failed login attempts\" to \"3\" and click \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-59994r885566_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256319'\n  tag rid: 'SV-256319r885568_rule'\n  tag stig_id: 'VCSA-70-000023'\n  tag gtitle: 'SRG-APP-000065'\n  tag fix_id: 'F-59937r885567_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000044']\n  tag nist: ['AC-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256319.rb"},"title":"The vCenter Server must enforce the limit of three consecutive invalid login attempts by a user.","desc":"By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.","descriptions":{"default":"By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy. \n\nThe lockout policy should be set as follows:\n\nMaximum number of failed login attempts: 3 \n\nIf this account lockout policy is not configured as stated, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy.\n\nClick \"Edit\".\n\nSet the \"Maximum number of failed login attempts\" to \"3\" and click \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-59994r885566_chk","severity":"medium","gid":"V-256319","rid":"SV-256319r885568_rule","stig_id":"VCSA-70-000023","gtitle":"SRG-APP-000065","fix_id":"F-59937r885567_fix","documentable":null,"cci":["CCI-000044"],"nist":["AC-7 a"]}},{"id":"SV-256320","code":"control 'SV-256320' do\n  title 'The vCenter Server must display the Standard Mandatory DOD Notice and Consent Banner before login.'\n  desc %q(Display of the DOD-approved use notification before granting access to the application ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060. Use the following verbiage for applications that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n \nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read (literal ampersand) consent to terms in IS user agreem't.\"\n\n)\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Login Message.\n\nIf the selection box next to \"Show login message\" is disabled, \"Details of login message\" is not configured to the standard DOD User Agreement, or the \"Consent checkbox\" is disabled, this is a finding.\n\nNote: Refer to vulnerability discussion for user agreement language.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Login Message.\n\nClick \"Edit\".\n\nClick the \"Show login message\" slider to enable.\n\nConfigure the \"Login message\" to \"DOD User Agreement\".\n\nClick the \"Consent checkbox\" slider to enable.\n\nSet the \"Details of login message\" to the Standard Mandatory DOD Notice and Consent Banner text.\n\nClick \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-59995r885569_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256320'\n  tag rid: 'SV-256320r885571_rule'\n  tag stig_id: 'VCSA-70-000024'\n  tag gtitle: 'SRG-APP-000068'\n  tag fix_id: 'F-59938r885570_fix'\n  tag satisfies: ['SRG-APP-000068', 'SRG-APP-000069', 'SRG-APP-000070']\n  tag 'documentable'\n  tag cci: ['CCI-000048', 'CCI-000050', 'CCI-001384']\n  tag nist: ['AC-8 a', 'AC-8 b', 'AC-8 c 1']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256320.rb"},"title":"The vCenter Server must display the Standard Mandatory DOD Notice and Consent Banner before login.","desc":"Display of the DOD-approved use notification before granting access to the application ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060. Use the following verbiage for applications that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n \nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read (literal ampersand) consent to terms in IS user agreem't.\"\n\n","descriptions":{"default":"Display of the DOD-approved use notification before granting access to the application ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with DTM-08-060. Use the following verbiage for applications that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n \nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read (literal ampersand) consent to terms in IS user agreem't.\"\n\n","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Login Message.\n\nIf the selection box next to \"Show login message\" is disabled, \"Details of login message\" is not configured to the standard DOD User Agreement, or the \"Consent checkbox\" is disabled, this is a finding.\n\nNote: Refer to vulnerability discussion for user agreement language.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Login Message.\n\nClick \"Edit\".\n\nClick the \"Show login message\" slider to enable.\n\nConfigure the \"Login message\" to \"DOD User Agreement\".\n\nClick the \"Consent checkbox\" slider to enable.\n\nSet the \"Details of login message\" to the Standard Mandatory DOD Notice and Consent Banner text.\n\nClick \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-59995r885569_chk","severity":"medium","gid":"V-256320","rid":"SV-256320r885571_rule","stig_id":"VCSA-70-000024","gtitle":"SRG-APP-000068","fix_id":"F-59938r885570_fix","satisfies":["SRG-APP-000068","SRG-APP-000069","SRG-APP-000070"],"documentable":null,"cci":["CCI-000048","CCI-000050","CCI-001384"],"nist":["AC-8 a","AC-8 b","AC-8 c 1"]}},{"id":"SV-256321","code":"control 'SV-256321' do\n  title 'The vCenter Server must produce audit records containing information to establish what type of events occurred.'\n  desc 'Without establishing what types of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.'\n  desc 'check', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nVerify the \"config.log.level\" value is set to \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.log.level and verify it is set to \"info\".\n\nIf the \"config.log.level\" value is not set to \"info\" or does not exist, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nClick \"Edit Settings\" and configure the \"config.log.level\" setting to \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.log.level | Set-AdvancedSetting -Value info'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-59996r885572_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256321'\n  tag rid: 'SV-256321r885574_rule'\n  tag stig_id: 'VCSA-70-000034'\n  tag gtitle: 'SRG-APP-000095'\n  tag fix_id: 'F-59939r885573_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000130']\n  tag nist: ['AU-3 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256321.rb"},"title":"The vCenter Server must produce audit records containing information to establish what type of events occurred.","desc":"Without establishing what types of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.","descriptions":{"default":"Without establishing what types of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.","check":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nVerify the \"config.log.level\" value is set to \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.log.level and verify it is set to \"info\".\n\nIf the \"config.log.level\" value is not set to \"info\" or does not exist, this is a finding.","fix":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nClick \"Edit Settings\" and configure the \"config.log.level\" setting to \"info\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.log.level | Set-AdvancedSetting -Value info"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-59996r885572_chk","severity":"medium","gid":"V-256321","rid":"SV-256321r885574_rule","stig_id":"VCSA-70-000034","gtitle":"SRG-APP-000095","fix_id":"F-59939r885573_fix","documentable":null,"cci":["CCI-000130"],"nist":["AU-3 a"]}},{"id":"SV-256322","code":"control 'SV-256322' do\n  title 'vCenter Server plugins must be verified.'\n  desc 'The vCenter Server includes a vSphere Client extensibility framework, which provides the ability to extend the vSphere Client with menu selections or toolbar icons that provide access to vCenter Server add-on components or external, web-based functionality.\n\nvSphere Client plugins or extensions run at the same privilege level as the user. Malicious extensions might masquerade as useful add-ons while compromising the system by stealing credentials or incorrectly configuring the system.\n\nAdditionally, vCenter comes with a number of plugins preinstalled that may or may not be necessary for proper operation.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Solutions >> Client Plug-Ins.\n\nView the Installed/Available Plug-ins list and verify they are all identified as authorized VMware, third-party (partner), and/or site-specific approved plug-ins.\n\nIf any installed/available plug-ins in the viewable list cannot be verified as allowed vSphere Client plug-ins from trusted sources or are not in active use, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Solutions >> Client Plug-Ins, click the radio button next to the unknown plug-in, and click \"Disable\".\n\nIf the plugin will not be needed in the future, proceed to uninstall the plug-in.\n\nTo uninstall plug-ins, do the following:\n\nIf vCenter Server is in linked mode, perform this procedure on the vCenter Server that is used to install the plug-in initially and then restart the vCenter Server services on the linked vCenter Server:\n\nIn a web browser, navigate to \"http://vCenter_Server_name_or_IP/mob\", where \"vCenter_Server_name_or_IP/mob\" is the name of the vCenter Server or its IP address.\n\nClick \"Content\".\n\nClick \"ExtensionManager\".\n\nSelect and copy the name of the plug-in to be removed from the list of values under \"Properties\". \n\nClick \"UnregisterExtension\". A new window appears.\n\nPaste the name of the plug-in and click \"Invoke Method\". This removes the plug-in.\n\nClose the window.\n\nRefresh the Managed Object Type:ManagedObjectReference:ExtensionManager window to verify the plug-in is removed successfully.\n\nNote: If the plug-in still appears, restart the vSphere Client.\n\nNote: The Managed Object Browser (MOB) may have to be enabled temporarily if it was disabled previously.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-59997r885575_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256322'\n  tag rid: 'SV-256322r885577_rule'\n  tag stig_id: 'VCSA-70-000057'\n  tag gtitle: 'SRG-APP-000141'\n  tag fix_id: 'F-59940r885576_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256322.rb"},"title":"vCenter Server plugins must be verified.","desc":"The vCenter Server includes a vSphere Client extensibility framework, which provides the ability to extend the vSphere Client with menu selections or toolbar icons that provide access to vCenter Server add-on components or external, web-based functionality.\n\nvSphere Client plugins or extensions run at the same privilege level as the user. Malicious extensions might masquerade as useful add-ons while compromising the system by stealing credentials or incorrectly configuring the system.\n\nAdditionally, vCenter comes with a number of plugins preinstalled that may or may not be necessary for proper operation.","descriptions":{"default":"The vCenter Server includes a vSphere Client extensibility framework, which provides the ability to extend the vSphere Client with menu selections or toolbar icons that provide access to vCenter Server add-on components or external, web-based functionality.\n\nvSphere Client plugins or extensions run at the same privilege level as the user. Malicious extensions might masquerade as useful add-ons while compromising the system by stealing credentials or incorrectly configuring the system.\n\nAdditionally, vCenter comes with a number of plugins preinstalled that may or may not be necessary for proper operation.","check":"From the vSphere Client, go to Administration >> Solutions >> Client Plug-Ins.\n\nView the Installed/Available Plug-ins list and verify they are all identified as authorized VMware, third-party (partner), and/or site-specific approved plug-ins.\n\nIf any installed/available plug-ins in the viewable list cannot be verified as allowed vSphere Client plug-ins from trusted sources or are not in active use, this is a finding.","fix":"From the vSphere Client, go to Administration >> Solutions >> Client Plug-Ins, click the radio button next to the unknown plug-in, and click \"Disable\".\n\nIf the plugin will not be needed in the future, proceed to uninstall the plug-in.\n\nTo uninstall plug-ins, do the following:\n\nIf vCenter Server is in linked mode, perform this procedure on the vCenter Server that is used to install the plug-in initially and then restart the vCenter Server services on the linked vCenter Server:\n\nIn a web browser, navigate to \"http://vCenter_Server_name_or_IP/mob\", where \"vCenter_Server_name_or_IP/mob\" is the name of the vCenter Server or its IP address.\n\nClick \"Content\".\n\nClick \"ExtensionManager\".\n\nSelect and copy the name of the plug-in to be removed from the list of values under \"Properties\". \n\nClick \"UnregisterExtension\". A new window appears.\n\nPaste the name of the plug-in and click \"Invoke Method\". This removes the plug-in.\n\nClose the window.\n\nRefresh the Managed Object Type:ManagedObjectReference:ExtensionManager window to verify the plug-in is removed successfully.\n\nNote: If the plug-in still appears, restart the vSphere Client.\n\nNote: The Managed Object Browser (MOB) may have to be enabled temporarily if it was disabled previously."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-59997r885575_chk","severity":"medium","gid":"V-256322","rid":"SV-256322r885577_rule","stig_id":"VCSA-70-000057","gtitle":"SRG-APP-000141","fix_id":"F-59940r885576_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-256323","code":"control 'SV-256323' do\n  title 'The vCenter Server must uniquely identify and authenticate users or processes acting on behalf of users.'\n  desc 'To ensure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system. \n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses except the following.\n\n(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; and \n(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity.\n\nUsing Active Directory or an identity provider for authentication provides more robust account management capabilities and accountability.\n\n'\n  desc 'check', 'From the vSphere Web Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider. \n\nIf the identity provider type is \"embedded\" and there is no identity source of type \"Active Directory\" (either Windows Integrated Authentication or LDAP), this is a finding.\n\nIf the identity provider type is \"Microsoft ADFS\" or another supported identity provider, this is NOT a finding.'\n  desc 'fix', 'When using the embedded identity provider type, perform the following:\n\nFrom the vSphere Web Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider >> Identity Sources.\n\nClick \"Add\".\n\nSelect either \"Active Directory over LDAP\" or \"Active Directory (Windows Integrated Authentication)\" and configure appropriately. \n\nNote: Windows Integrated Authentication requires that the vCenter server be joined to Active Directory before configuration via Administration >> Single Sign On >> Configuration >> Identity Provider >> Active Directory Domain.\n\nOR\n\nTo change the identity provider type to a third-party identity provider such as Microsoft ADFS, perform the following:\n\nFrom the vSphere Web Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider.\n\nClick \"Change Identity Provider\".\n\nSelect \"Microsoft ADFS\" and click \"Next\".\n\nEnter the ADFS server information and User and Group details and click \"Finish\".\n\nFor additional information on configuring ADFS for use with vCenter, refer to the vSphere documentation.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-59998r885578_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256323'\n  tag rid: 'SV-256323r885580_rule'\n  tag stig_id: 'VCSA-70-000059'\n  tag gtitle: 'SRG-APP-000148'\n  tag fix_id: 'F-59941r885579_fix'\n  tag satisfies: ['SRG-APP-000148', 'SRG-APP-000153', 'SRG-APP-000163', 'SRG-APP-000180', 'SRG-APP-000234']\n  tag 'documentable'\n  tag cci: ['CCI-000764', 'CCI-000770', 'CCI-000795', 'CCI-000804', 'CCI-001682']\n  tag nist: ['IA-2', 'IA-2 (5)', 'IA-4 e', 'IA-8', 'AC-2 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256323.rb"},"title":"The vCenter Server must uniquely identify and authenticate users or processes acting on behalf of users.","desc":"To ensure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system. \n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses except the following.\n\n(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; and \n(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity.\n\nUsing Active Directory or an identity provider for authentication provides more robust account management capabilities and accountability.\n\n","descriptions":{"default":"To ensure accountability and prevent unauthenticated access, organizational users must be identified and authenticated to prevent potential misuse and compromise of the system. \n\nOrganizational users include organizational employees or individuals the organization deems to have equivalent status of employees (e.g., contractors). Organizational users (and any processes acting on behalf of users) must be uniquely identified and authenticated for all accesses except the following.\n\n(i) Accesses explicitly identified and documented by the organization. Organizations document specific user actions that can be performed on the information system without identification or authentication; and \n(ii) Accesses that occur through authorized use of group authenticators without individual authentication. Organizations may require unique identification of individuals in group accounts (e.g., shared privilege accounts) or for detailed accountability of individual activity.\n\nUsing Active Directory or an identity provider for authentication provides more robust account management capabilities and accountability.\n\n","check":"From the vSphere Web Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider. \n\nIf the identity provider type is \"embedded\" and there is no identity source of type \"Active Directory\" (either Windows Integrated Authentication or LDAP), this is a finding.\n\nIf the identity provider type is \"Microsoft ADFS\" or another supported identity provider, this is NOT a finding.","fix":"When using the embedded identity provider type, perform the following:\n\nFrom the vSphere Web Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider >> Identity Sources.\n\nClick \"Add\".\n\nSelect either \"Active Directory over LDAP\" or \"Active Directory (Windows Integrated Authentication)\" and configure appropriately. \n\nNote: Windows Integrated Authentication requires that the vCenter server be joined to Active Directory before configuration via Administration >> Single Sign On >> Configuration >> Identity Provider >> Active Directory Domain.\n\nOR\n\nTo change the identity provider type to a third-party identity provider such as Microsoft ADFS, perform the following:\n\nFrom the vSphere Web Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider.\n\nClick \"Change Identity Provider\".\n\nSelect \"Microsoft ADFS\" and click \"Next\".\n\nEnter the ADFS server information and User and Group details and click \"Finish\".\n\nFor additional information on configuring ADFS for use with vCenter, refer to the vSphere documentation."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-59998r885578_chk","severity":"medium","gid":"V-256323","rid":"SV-256323r885580_rule","stig_id":"VCSA-70-000059","gtitle":"SRG-APP-000148","fix_id":"F-59941r885579_fix","satisfies":["SRG-APP-000148","SRG-APP-000153","SRG-APP-000163","SRG-APP-000180","SRG-APP-000234"],"documentable":null,"cci":["CCI-000764","CCI-000770","CCI-000795","CCI-000804","CCI-001682"],"nist":["IA-2","IA-2 (5)","IA-4 e","IA-8","AC-2 (2)"]}},{"id":"SV-256324","code":"control 'SV-256324' do\n  title 'The vCenter Server must require multifactor authentication.'\n  desc 'Without the use of multifactor authentication, the ease of access to privileged functions is greatly increased. \n\nMultifactor authentication requires using two or more factors to achieve authentication. \n\nFactors include: \n(i) something a user knows (e.g., password/PIN); \n(ii) something a user has (e.g., cryptographic identification device, token); or \n(iii) something a user is (e.g., biometric).\n\n'\n  desc 'check', 'From the vSphere Web Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider.\n\nIf the embedded identity provider is used, click on \"Smart Card Authentication\".\n\nIf the embedded identity provider is used and \"Smart Card Authentication\" is not enabled, this is a finding.\n\nIf a third-party identity provider is used, such as Microsoft ADFS, and it does not require multifactor authentication to log on to vCenter, this is a finding.'\n  desc 'fix', \"To configure smart card authentication for vCenter when using the embedded identity provider, refer to the supplemental document. \n\nFor vCenter Servers using a third-party identity provider, consult the product's documentation for enabling multifactor authentication.\"\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-59999r885581_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256324'\n  tag rid: 'SV-256324r885583_rule'\n  tag stig_id: 'VCSA-70-000060'\n  tag gtitle: 'SRG-APP-000149'\n  tag fix_id: 'F-59942r885582_fix'\n  tag satisfies: ['SRG-APP-000149', 'SRG-APP-000080', 'SRG-APP-000150', 'SRG-APP-000391', 'SRG-APP-000402']\n  tag 'documentable'\n  tag cci: ['CCI-000166', 'CCI-000765', 'CCI-000766', 'CCI-001953', 'CCI-002009']\n  tag nist: ['AU-10', 'IA-2 (1)', 'IA-2 (2)', 'IA-2 (12)', 'IA-8 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256324.rb"},"title":"The vCenter Server must require multifactor authentication.","desc":"Without the use of multifactor authentication, the ease of access to privileged functions is greatly increased. \n\nMultifactor authentication requires using two or more factors to achieve authentication. \n\nFactors include: \n(i) something a user knows (e.g., password/PIN); \n(ii) something a user has (e.g., cryptographic identification device, token); or \n(iii) something a user is (e.g., biometric).\n\n","descriptions":{"default":"Without the use of multifactor authentication, the ease of access to privileged functions is greatly increased. \n\nMultifactor authentication requires using two or more factors to achieve authentication. \n\nFactors include: \n(i) something a user knows (e.g., password/PIN); \n(ii) something a user has (e.g., cryptographic identification device, token); or \n(iii) something a user is (e.g., biometric).\n\n","check":"From the vSphere Web Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider.\n\nIf the embedded identity provider is used, click on \"Smart Card Authentication\".\n\nIf the embedded identity provider is used and \"Smart Card Authentication\" is not enabled, this is a finding.\n\nIf a third-party identity provider is used, such as Microsoft ADFS, and it does not require multifactor authentication to log on to vCenter, this is a finding.","fix":"To configure smart card authentication for vCenter when using the embedded identity provider, refer to the supplemental document. \n\nFor vCenter Servers using a third-party identity provider, consult the product's documentation for enabling multifactor authentication."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-59999r885581_chk","severity":"medium","gid":"V-256324","rid":"SV-256324r885583_rule","stig_id":"VCSA-70-000060","gtitle":"SRG-APP-000149","fix_id":"F-59942r885582_fix","satisfies":["SRG-APP-000149","SRG-APP-000080","SRG-APP-000150","SRG-APP-000391","SRG-APP-000402"],"documentable":null,"cci":["CCI-000166","CCI-000765","CCI-000766","CCI-001953","CCI-002009"],"nist":["AU-10","IA-2 (1)","IA-2 (2)","IA-2 (12)","IA-8 (1)"]}},{"id":"SV-256325","code":"control 'SV-256325' do\n  title 'The vCenter Server passwords must be at least 15 characters in length.'\n  desc 'The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. \n\nUse of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy. \n\nThe following password requirement should be set with at least the stated value: \n\nMinimum Length: 15 \n\nIf this password policy is not configured as stated, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\".\n\nSet the \"Minimum Length\" to \"15\" and click \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60000r885584_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256325'\n  tag rid: 'SV-256325r885586_rule'\n  tag stig_id: 'VCSA-70-000069'\n  tag gtitle: 'SRG-APP-000164'\n  tag fix_id: 'F-59943r885585_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000205']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256325.rb"},"title":"The vCenter Server passwords must be at least 15 characters in length.","desc":"The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. \n\nUse of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","descriptions":{"default":"The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. \n\nUse of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy. \n\nThe following password requirement should be set with at least the stated value: \n\nMinimum Length: 15 \n\nIf this password policy is not configured as stated, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\".\n\nSet the \"Minimum Length\" to \"15\" and click \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60000r885584_chk","severity":"medium","gid":"V-256325","rid":"SV-256325r885586_rule","stig_id":"VCSA-70-000069","gtitle":"SRG-APP-000164","fix_id":"F-59943r885585_fix","documentable":null,"cci":["CCI-000205"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-256326","code":"control 'SV-256326' do\n  title 'The vCenter Server must prohibit password reuse for a minimum of five generations.'\n  desc 'Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nTo meet password policy requirements, passwords must be changed at specific policy-based intervals. \n\nIf the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the result is a password that is not changed per policy requirements.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nView the value of the \"Restrict reuse\" setting.\n\nIf the \"Restrict reuse\" policy is not set to \"5\" or more, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\", enter \"5\" as the \"Restrict reuse\" setting, and click \"OK\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60001r885587_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256326'\n  tag rid: 'SV-256326r885589_rule'\n  tag stig_id: 'VCSA-70-000070'\n  tag gtitle: 'SRG-APP-000165'\n  tag fix_id: 'F-59944r885588_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000200']\n  tag nist: ['IA-5 (1) (e)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256326.rb"},"title":"The vCenter Server must prohibit password reuse for a minimum of five generations.","desc":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nTo meet password policy requirements, passwords must be changed at specific policy-based intervals. \n\nIf the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the result is a password that is not changed per policy requirements.","descriptions":{"default":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nTo meet password policy requirements, passwords must be changed at specific policy-based intervals. \n\nIf the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the result is a password that is not changed per policy requirements.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nView the value of the \"Restrict reuse\" setting.\n\nIf the \"Restrict reuse\" policy is not set to \"5\" or more, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\", enter \"5\" as the \"Restrict reuse\" setting, and click \"OK\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60001r885587_chk","severity":"medium","gid":"V-256326","rid":"SV-256326r885589_rule","stig_id":"VCSA-70-000070","gtitle":"SRG-APP-000165","fix_id":"F-59944r885588_fix","documentable":null,"cci":["CCI-000200"],"nist":["IA-5 (1) (e)"]}},{"id":"SV-256327","code":"control 'SV-256327' do\n  title 'The vCenter Server passwords must contain at least one uppercase character.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy. \n\nSet the following password requirement with at least the stated value: \n\nUpper-case Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\".\n\nSet \"Upper-case Characters\" to at least \"1\" and click \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60002r885590_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256327'\n  tag rid: 'SV-256327r885592_rule'\n  tag stig_id: 'VCSA-70-000071'\n  tag gtitle: 'SRG-APP-000166'\n  tag fix_id: 'F-59945r885591_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000192']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256327.rb"},"title":"The vCenter Server passwords must contain at least one uppercase character.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy. \n\nSet the following password requirement with at least the stated value: \n\nUpper-case Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\".\n\nSet \"Upper-case Characters\" to at least \"1\" and click \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60002r885590_chk","severity":"medium","gid":"V-256327","rid":"SV-256327r885592_rule","stig_id":"VCSA-70-000071","gtitle":"SRG-APP-000166","fix_id":"F-59945r885591_fix","documentable":null,"cci":["CCI-000192"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-256328","code":"control 'SV-256328' do\n  title 'The vCenter Server passwords must contain at least one lowercase character.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy. \n\nSet the following password requirement with at least the stated value: \n\nLower-case Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\".\n\nSet \"Lower-case Characters\" to at least \"1\" and click \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60003r885593_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256328'\n  tag rid: 'SV-256328r885595_rule'\n  tag stig_id: 'VCSA-70-000072'\n  tag gtitle: 'SRG-APP-000167'\n  tag fix_id: 'F-59946r885594_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000193']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256328.rb"},"title":"The vCenter Server passwords must contain at least one lowercase character.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy. \n\nSet the following password requirement with at least the stated value: \n\nLower-case Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\".\n\nSet \"Lower-case Characters\" to at least \"1\" and click \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60003r885593_chk","severity":"medium","gid":"V-256328","rid":"SV-256328r885595_rule","stig_id":"VCSA-70-000072","gtitle":"SRG-APP-000167","fix_id":"F-59946r885594_fix","documentable":null,"cci":["CCI-000193"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-256329","code":"control 'SV-256329' do\n  title 'The vCenter Server passwords must contain at least one numeric character.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy. \n\nSet the following password requirement with at least the stated value: \n\nNumeric Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\".\n\nSet \"Numeric Characters\" to at least \"1\" and click \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60004r885596_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256329'\n  tag rid: 'SV-256329r885598_rule'\n  tag stig_id: 'VCSA-70-000073'\n  tag gtitle: 'SRG-APP-000168'\n  tag fix_id: 'F-59947r885597_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000194']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256329.rb"},"title":"The vCenter Server passwords must contain at least one numeric character.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy. \n\nSet the following password requirement with at least the stated value: \n\nNumeric Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\".\n\nSet \"Numeric Characters\" to at least \"1\" and click \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60004r885596_chk","severity":"medium","gid":"V-256329","rid":"SV-256329r885598_rule","stig_id":"VCSA-70-000073","gtitle":"SRG-APP-000168","fix_id":"F-59947r885597_fix","documentable":null,"cci":["CCI-000194"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-256330","code":"control 'SV-256330' do\n  title 'The vCenter Server passwords must contain at least one special character.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised. \n\nSpecial characters are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy. \n\nSet the following password requirements with at least the stated value: \n\nSpecial Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\".\n\nSet \"Special Characters\" to at least \"1\" and click \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60005r885599_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256330'\n  tag rid: 'SV-256330r885601_rule'\n  tag stig_id: 'VCSA-70-000074'\n  tag gtitle: 'SRG-APP-000169'\n  tag fix_id: 'F-59948r885600_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001619']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256330.rb"},"title":"The vCenter Server passwords must contain at least one special character.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised. \n\nSpecial characters are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. \n\nPassword complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised. \n\nSpecial characters are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy. \n\nSet the following password requirements with at least the stated value: \n\nSpecial Characters: At least 1 \n\nIf this password complexity policy is not configured as stated, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\".\n\nSet \"Special Characters\" to at least \"1\" and click \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60005r885599_chk","severity":"medium","gid":"V-256330","rid":"SV-256330r885601_rule","stig_id":"VCSA-70-000074","gtitle":"SRG-APP-000169","fix_id":"F-59948r885600_fix","documentable":null,"cci":["CCI-001619"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-256331","code":"control 'SV-256331' do\n  title 'The vCenter Server must enable FIPS-validated cryptography.'\n  desc 'FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules use authentication that meets DOD requirements.\n\nIn vSphere 6.7 and later, ESXi and vCenter Server use FIPS-validated cryptography to protect management interfaces and the VMware Certificate Authority (VMCA).\n\nvSphere 7.0 Update 2 and later adds additional FIPS-validated cryptography to vCenter Server Appliance. By default, this FIPS validation option is disabled and must be enabled.\n\n'\n  desc 'check', 'From the vSphere Web Client, go to Developer Center >> API Explorer.\n\nFrom the \"Select API\" drop-down menu, select appliance.\n\nExpand system/security/global_fips >> GET.\n\nClick \"Execute\" and then \"Copy Response\"  to view the results.\n\nExample response:\n\n{\n    \"enabled\": true\n}\n\nIf global FIPS mode is not enabled, this is a finding.'\n  desc 'fix', 'From the vSphere Web Client, go to Developer Center >> API Explorer.\n\nFrom the \"Select API\" drop-down menu, select appliance.\n\nExpand system/security/global_fips >> PUT.\n\nIn the response body under \"Try it out\", paste the following:\n\n{\n    \"enabled\": true\n}\n\nClick \"Execute\".\n\nNote: The vCenter server reboots after FIPS is enabled or disabled.'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60006r885602_chk'\n  tag severity: 'high'\n  tag gid: 'V-256331'\n  tag rid: 'SV-256331r885604_rule'\n  tag stig_id: 'VCSA-70-000077'\n  tag gtitle: 'SRG-APP-000172'\n  tag fix_id: 'F-59949r885603_fix'\n  tag satisfies: ['SRG-APP-000172', 'SRG-APP-000179', 'SRG-APP-000224', 'SRG-APP-000231', 'SRG-APP-000412', 'SRG-APP-000514', 'SRG-APP-000555', 'SRG-APP-000600', 'SRG-APP-000610', 'SRG-APP-000620', 'SRG-APP-000630', 'SRG-APP-000635']\n  tag 'documentable'\n  tag cci: ['CCI-000197', 'CCI-000803', 'CCI-001188', 'CCI-001199', 'CCI-001967', 'CCI-002450', 'CCI-003123']\n  tag nist: ['IA-5 (1) (c)', 'IA-7', 'SC-23 (3)', 'SC-28', 'IA-3 (1)', 'SC-13 b', 'MA-4 (6)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256331.rb"},"title":"The vCenter Server must enable FIPS-validated cryptography.","desc":"FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules use authentication that meets DOD requirements.\n\nIn vSphere 6.7 and later, ESXi and vCenter Server use FIPS-validated cryptography to protect management interfaces and the VMware Certificate Authority (VMCA).\n\nvSphere 7.0 Update 2 and later adds additional FIPS-validated cryptography to vCenter Server Appliance. By default, this FIPS validation option is disabled and must be enabled.\n\n","descriptions":{"default":"FIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules use authentication that meets DOD requirements.\n\nIn vSphere 6.7 and later, ESXi and vCenter Server use FIPS-validated cryptography to protect management interfaces and the VMware Certificate Authority (VMCA).\n\nvSphere 7.0 Update 2 and later adds additional FIPS-validated cryptography to vCenter Server Appliance. By default, this FIPS validation option is disabled and must be enabled.\n\n","check":"From the vSphere Web Client, go to Developer Center >> API Explorer.\n\nFrom the \"Select API\" drop-down menu, select appliance.\n\nExpand system/security/global_fips >> GET.\n\nClick \"Execute\" and then \"Copy Response\"  to view the results.\n\nExample response:\n\n{\n    \"enabled\": true\n}\n\nIf global FIPS mode is not enabled, this is a finding.","fix":"From the vSphere Web Client, go to Developer Center >> API Explorer.\n\nFrom the \"Select API\" drop-down menu, select appliance.\n\nExpand system/security/global_fips >> PUT.\n\nIn the response body under \"Try it out\", paste the following:\n\n{\n    \"enabled\": true\n}\n\nClick \"Execute\".\n\nNote: The vCenter server reboots after FIPS is enabled or disabled."},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60006r885602_chk","severity":"high","gid":"V-256331","rid":"SV-256331r885604_rule","stig_id":"VCSA-70-000077","gtitle":"SRG-APP-000172","fix_id":"F-59949r885603_fix","satisfies":["SRG-APP-000172","SRG-APP-000179","SRG-APP-000224","SRG-APP-000231","SRG-APP-000412","SRG-APP-000514","SRG-APP-000555","SRG-APP-000600","SRG-APP-000610","SRG-APP-000620","SRG-APP-000630","SRG-APP-000635"],"documentable":null,"cci":["CCI-000197","CCI-000803","CCI-001188","CCI-001199","CCI-001967","CCI-002450","CCI-003123"],"nist":["IA-5 (1) (c)","IA-7","SC-23 (3)","SC-28","IA-3 (1)","SC-13 b","MA-4 (6)"]}},{"id":"SV-256332","code":"control 'SV-256332' do\n  title 'The vCenter Server must enforce a 60-day maximum password lifetime restriction.'\n  desc 'Any password, no matter how complex, can eventually be cracked. Therefore, passwords must be changed at specific intervals. \n\nOne method of minimizing this risk is to use complex passwords and periodically change them. If the application does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the system and/or application passwords could be compromised. \n\nThis requirement does not include emergency administration accounts, which are meant for access to the application in case of failure. These accounts are not required to have maximum password lifetime restrictions.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nView the value of the \"Maximum lifetime\" setting.\n\nIf the \"Maximum lifetime\" policy is not set to \"60\", this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\", enter \"60\" into the \"Maximum lifetime\" setting, and click \"OK\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60007r885605_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256332'\n  tag rid: 'SV-256332r885607_rule'\n  tag stig_id: 'VCSA-70-000079'\n  tag gtitle: 'SRG-APP-000174'\n  tag fix_id: 'F-59950r885606_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000199']\n  tag nist: ['IA-5 (1) (d)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256332.rb"},"title":"The vCenter Server must enforce a 60-day maximum password lifetime restriction.","desc":"Any password, no matter how complex, can eventually be cracked. Therefore, passwords must be changed at specific intervals. \n\nOne method of minimizing this risk is to use complex passwords and periodically change them. If the application does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the system and/or application passwords could be compromised. \n\nThis requirement does not include emergency administration accounts, which are meant for access to the application in case of failure. These accounts are not required to have maximum password lifetime restrictions.","descriptions":{"default":"Any password, no matter how complex, can eventually be cracked. Therefore, passwords must be changed at specific intervals. \n\nOne method of minimizing this risk is to use complex passwords and periodically change them. If the application does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the system and/or application passwords could be compromised. \n\nThis requirement does not include emergency administration accounts, which are meant for access to the application in case of failure. These accounts are not required to have maximum password lifetime restrictions.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nView the value of the \"Maximum lifetime\" setting.\n\nIf the \"Maximum lifetime\" policy is not set to \"60\", this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Password Policy.\n\nClick \"Edit\", enter \"60\" into the \"Maximum lifetime\" setting, and click \"OK\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60007r885605_chk","severity":"medium","gid":"V-256332","rid":"SV-256332r885607_rule","stig_id":"VCSA-70-000079","gtitle":"SRG-APP-000174","fix_id":"F-59950r885606_fix","documentable":null,"cci":["CCI-000199"],"nist":["IA-5 (1) (d)"]}},{"id":"SV-256333","code":"control 'SV-256333' do\n  title 'The vCenter Server must enable revocation checking for certificate-based authentication.'\n  desc 'The system must establish the validity of the user-supplied identity certificate using Online Certificate Status Protocol (OCSP) and/or Certificate Revocation List (CRL) revocation checking.\n\n'\n  desc 'check', 'If a federated identity provider is configured and used for an identity source and supports Smartcard authentication, this is not applicable.\n\nFrom the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider >> Smart Card Authentication.\n\nUnder Smart card authentication settings >> Certificate revocation, verify \"Revocation check\" does not show as disabled.\n\nIf \"Revocation check\" shows as disabled, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider >> Smart Card Authentication.\n\nUnder Smart card authentication settings >> Certificate revocation, click the \"Edit\" button.\n\nConfigure revocation checking per site requirements. OCSP with CRL failover is recommended.\n\nBy default, both locations are pulled from the cert. CRL location can be overridden in this screen, and local responders can be specified via the sso-config command line tool. Refer to the supplemental document for more information.\n\nNote: If FIPS mode is enabled on vCenter, OCSP revocation validation may not function and CRL used instead.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60008r885608_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256333'\n  tag rid: 'SV-256333r919043_rule'\n  tag stig_id: 'VCSA-70-000080'\n  tag gtitle: 'SRG-APP-000175'\n  tag fix_id: 'F-59951r919042_fix'\n  tag satisfies: ['SRG-APP-000175', 'SRG-APP-000392', 'SRG-APP-000401', 'SRG-APP-000403']\n  tag 'documentable'\n  tag cci: ['CCI-000185', 'CCI-001954', 'CCI-001991', 'CCI-002010']\n  tag nist: ['IA-5 (2) (b) (1)', 'IA-2 (12)', 'IA-5 (2) (d)', 'IA-8 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256333.rb"},"title":"The vCenter Server must enable revocation checking for certificate-based authentication.","desc":"The system must establish the validity of the user-supplied identity certificate using Online Certificate Status Protocol (OCSP) and/or Certificate Revocation List (CRL) revocation checking.\n\n","descriptions":{"default":"The system must establish the validity of the user-supplied identity certificate using Online Certificate Status Protocol (OCSP) and/or Certificate Revocation List (CRL) revocation checking.\n\n","check":"If a federated identity provider is configured and used for an identity source and supports Smartcard authentication, this is not applicable.\n\nFrom the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider >> Smart Card Authentication.\n\nUnder Smart card authentication settings >> Certificate revocation, verify \"Revocation check\" does not show as disabled.\n\nIf \"Revocation check\" shows as disabled, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider >> Smart Card Authentication.\n\nUnder Smart card authentication settings >> Certificate revocation, click the \"Edit\" button.\n\nConfigure revocation checking per site requirements. OCSP with CRL failover is recommended.\n\nBy default, both locations are pulled from the cert. CRL location can be overridden in this screen, and local responders can be specified via the sso-config command line tool. Refer to the supplemental document for more information.\n\nNote: If FIPS mode is enabled on vCenter, OCSP revocation validation may not function and CRL used instead."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60008r885608_chk","severity":"medium","gid":"V-256333","rid":"SV-256333r919043_rule","stig_id":"VCSA-70-000080","gtitle":"SRG-APP-000175","fix_id":"F-59951r919042_fix","satisfies":["SRG-APP-000175","SRG-APP-000392","SRG-APP-000401","SRG-APP-000403"],"documentable":null,"cci":["CCI-000185","CCI-001954","CCI-001991","CCI-002010"],"nist":["IA-5 (2) (b) (1)","IA-2 (12)","IA-5 (2) (d)","IA-8 (1)"]}},{"id":"SV-256334","code":"control 'SV-256334' do\n  title 'The vCenter Server must terminate vSphere Client sessions after 10 minutes of inactivity.'\n  desc 'Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free resources committed by the managed network element.\n\n'\n  desc 'check', 'From the vSphere Client, go to Administration >> Deployment >> Client Configuration.\n\nView the value of the \"Session timeout\" setting.\n\nIf \"Session timeout\" is not set to \"10 minute(s)\" or below, this is a finding.\n\nNote: If vCenter is not 7.0 U2 or newer, this setting is not available through the UI and must be checked with the \"session.timeout\" setting in the \"/etc/vmware/vsphere-ui/webclient.properties file\".'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Deployment >> Client Configuration.\n\nClick \"Edit\" and enter \"10\" minutes into the \"Session timeout\" setting. Click \"Save\".\n\nNote: If vCenter is not 7.0 U2 or newer, this setting is not available through the UI and must be checked with the \"session.timeout\" setting in the \"/etc/vmware/vsphere-ui/webclient.properties file\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60009r885611_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256334'\n  tag rid: 'SV-256334r885613_rule'\n  tag stig_id: 'VCSA-70-000089'\n  tag gtitle: 'SRG-APP-000190'\n  tag fix_id: 'F-59952r885612_fix'\n  tag satisfies: ['SRG-APP-000190', 'SRG-APP-000295', 'SRG-APP-000389']\n  tag 'documentable'\n  tag cci: ['CCI-001133', 'CCI-002038', 'CCI-002361']\n  tag nist: ['SC-10', 'IA-11', 'AC-12']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256334.rb"},"title":"The vCenter Server must terminate vSphere Client sessions after 10 minutes of inactivity.","desc":"Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free resources committed by the managed network element.\n\n","descriptions":{"default":"Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free resources committed by the managed network element.\n\n","check":"From the vSphere Client, go to Administration >> Deployment >> Client Configuration.\n\nView the value of the \"Session timeout\" setting.\n\nIf \"Session timeout\" is not set to \"10 minute(s)\" or below, this is a finding.\n\nNote: If vCenter is not 7.0 U2 or newer, this setting is not available through the UI and must be checked with the \"session.timeout\" setting in the \"/etc/vmware/vsphere-ui/webclient.properties file\".","fix":"From the vSphere Client, go to Administration >> Deployment >> Client Configuration.\n\nClick \"Edit\" and enter \"10\" minutes into the \"Session timeout\" setting. Click \"Save\".\n\nNote: If vCenter is not 7.0 U2 or newer, this setting is not available through the UI and must be checked with the \"session.timeout\" setting in the \"/etc/vmware/vsphere-ui/webclient.properties file\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60009r885611_chk","severity":"medium","gid":"V-256334","rid":"SV-256334r885613_rule","stig_id":"VCSA-70-000089","gtitle":"SRG-APP-000190","fix_id":"F-59952r885612_fix","satisfies":["SRG-APP-000190","SRG-APP-000295","SRG-APP-000389"],"documentable":null,"cci":["CCI-001133","CCI-002038","CCI-002361"],"nist":["SC-10","IA-11","AC-12"]}},{"id":"SV-256335","code":"control 'SV-256335' do\n  title 'The vCenter Server users must have the correct roles assigned.'\n  desc 'Users and service accounts must only be assigned privileges they require. Least privilege requires that these privileges must only be assigned if needed to reduce risk of confidentiality, availability, or integrity loss.\n\n'\n  desc 'check', 'From the vSphere Client, go to Administration >> Access Control >> Roles.\n\nView each role and verify the users and/or groups assigned to it by clicking \"Usage\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VIPermission | Sort Role | Select Role,Principal,Entity,Propagate,IsGroup | FT -Auto\n\nApplication service account and user required privileges should be documented.\n\nIf any user or service account has more privileges than required, this is a finding.'\n  desc 'fix', %q(To update a user's or group's permissions to an existing role with reduced permissions, do the following:\n\nFrom the vSphere Client, go to Administration >> Access Control >> Global Permissions.\n\nSelect the user or group, click the pencil button, change the assigned role, and click \"OK\".\n\nNote: If permissions are assigned on a specific object, the role must be updated where it is assigned (for example, at the cluster level).\n\nTo create a new role with reduced permissions, do the following:\n\nFrom the vSphere Client, go to Administration >> Access Control >> Roles.\n\nClick the green plus sign and enter a name for the role and select only the specific permissions required.\n\nUsers can then be assigned to the newly created role.)\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60010r885614_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256335'\n  tag rid: 'SV-256335r885616_rule'\n  tag stig_id: 'VCSA-70-000095'\n  tag gtitle: 'SRG-APP-000211'\n  tag fix_id: 'F-59953r885615_fix'\n  tag satisfies: ['SRG-APP-000211', 'SRG-APP-000233', 'SRG-APP-000380']\n  tag 'documentable'\n  tag cci: ['CCI-001082', 'CCI-001084', 'CCI-001813']\n  tag nist: ['SC-2', 'SC-3', 'CM-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256335.rb"},"title":"The vCenter Server users must have the correct roles assigned.","desc":"Users and service accounts must only be assigned privileges they require. Least privilege requires that these privileges must only be assigned if needed to reduce risk of confidentiality, availability, or integrity loss.\n\n","descriptions":{"default":"Users and service accounts must only be assigned privileges they require. Least privilege requires that these privileges must only be assigned if needed to reduce risk of confidentiality, availability, or integrity loss.\n\n","check":"From the vSphere Client, go to Administration >> Access Control >> Roles.\n\nView each role and verify the users and/or groups assigned to it by clicking \"Usage\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VIPermission | Sort Role | Select Role,Principal,Entity,Propagate,IsGroup | FT -Auto\n\nApplication service account and user required privileges should be documented.\n\nIf any user or service account has more privileges than required, this is a finding.","fix":"To update a user's or group's permissions to an existing role with reduced permissions, do the following:\n\nFrom the vSphere Client, go to Administration >> Access Control >> Global Permissions.\n\nSelect the user or group, click the pencil button, change the assigned role, and click \"OK\".\n\nNote: If permissions are assigned on a specific object, the role must be updated where it is assigned (for example, at the cluster level).\n\nTo create a new role with reduced permissions, do the following:\n\nFrom the vSphere Client, go to Administration >> Access Control >> Roles.\n\nClick the green plus sign and enter a name for the role and select only the specific permissions required.\n\nUsers can then be assigned to the newly created role."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60010r885614_chk","severity":"medium","gid":"V-256335","rid":"SV-256335r885616_rule","stig_id":"VCSA-70-000095","gtitle":"SRG-APP-000211","fix_id":"F-59953r885615_fix","satisfies":["SRG-APP-000211","SRG-APP-000233","SRG-APP-000380"],"documentable":null,"cci":["CCI-001082","CCI-001084","CCI-001813"],"nist":["SC-2","SC-3","CM-5 (1) (a)"]}},{"id":"SV-256336","code":"control 'SV-256336' do\n  title 'The vCenter Server must manage excess capacity, bandwidth, or other redundancy to limit the effects of information flooding types of denial-of-service (DoS) attacks by enabling Network I/O Control (NIOC).'\n  desc 'DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nManaging excess capacity ensures sufficient capacity is available to counter flooding attacks. Employing increased capacity and service redundancy may reduce the susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning.'\n  desc 'check', 'If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking.\n\nSelect a distributed switch >> Configure >> Settings >> Properties.\n\nView the \"Properties\" pane and verify \"Network I/O Control\" is \"Enabled\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDSwitch | select Name,@{N=\"NIOC Enabled\";E={$_.ExtensionData.config.NetworkResourceManagementEnabled}}\n\nIf \"Network I/O Control\" is disabled, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Networking.\n\nSelect a distributed switch >> Configure >> Settings >> Properties.\n\nIn the \"Properties\" pane, click \"Edit\". Change \"Network I/O Control\" to \"Enabled\". Click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\n(Get-VDSwitch \"VDSwitch Name\" | Get-View).EnableNetworkResourceManagement($true)'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60011r885617_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256336'\n  tag rid: 'SV-256336r885619_rule'\n  tag stig_id: 'VCSA-70-000110'\n  tag gtitle: 'SRG-APP-000247'\n  tag fix_id: 'F-59954r885618_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001095']\n  tag nist: ['SC-5 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256336.rb"},"title":"The vCenter Server must manage excess capacity, bandwidth, or other redundancy to limit the effects of information flooding types of denial-of-service (DoS) attacks by enabling Network I/O Control (NIOC).","desc":"DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nManaging excess capacity ensures sufficient capacity is available to counter flooding attacks. Employing increased capacity and service redundancy may reduce the susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning.","descriptions":{"default":"DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nManaging excess capacity ensures sufficient capacity is available to counter flooding attacks. Employing increased capacity and service redundancy may reduce the susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning.","check":"If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking.\n\nSelect a distributed switch >> Configure >> Settings >> Properties.\n\nView the \"Properties\" pane and verify \"Network I/O Control\" is \"Enabled\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDSwitch | select Name,@{N=\"NIOC Enabled\";E={$_.ExtensionData.config.NetworkResourceManagementEnabled}}\n\nIf \"Network I/O Control\" is disabled, this is a finding.","fix":"From the vSphere Client, go to Networking.\n\nSelect a distributed switch >> Configure >> Settings >> Properties.\n\nIn the \"Properties\" pane, click \"Edit\". Change \"Network I/O Control\" to \"Enabled\". Click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\n(Get-VDSwitch \"VDSwitch Name\" | Get-View).EnableNetworkResourceManagement($true)"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60011r885617_chk","severity":"medium","gid":"V-256336","rid":"SV-256336r885619_rule","stig_id":"VCSA-70-000110","gtitle":"SRG-APP-000247","fix_id":"F-59954r885618_fix","documentable":null,"cci":["CCI-001095"],"nist":["SC-5 (2)"]}},{"id":"SV-256337","code":"control 'SV-256337' do\n  title 'The vCenter Server must provide an immediate real-time alert to the system administrator (SA) and information system security officer (ISSO), at a minimum, on every Single Sign-On (SSO) account action.'\n  desc 'Once an attacker establishes initial access to a system, they often attempt to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create a new account. They may also try to hijack an existing account by changing a password or enabling a previously disabled account. Therefore, all actions performed on accounts in the SSO domain much be alerted on in vCenter at a minimum and ideally on a Security Information and Event Management (SIEM) system as well.\n\nTo ensure the appropriate personnel are alerted about SSO account actions, create a new vCenter alarm for the \"com.vmware.sso.PrincipalManagement\" event ID and configure the alert mechanisms appropriately.\n\n'\n  desc 'check', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Security >> Alarm Definitions.\n\nVerify an alarm has been created to alert upon all SSO account actions.\n\nThe alarm name may vary, but it is suggested to name it \"SSO account actions - com.vmware.sso.PrincipalManagement\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AlarmDefinition | Where {$_.ExtensionData.Info.Expression.Expression.EventTypeId -eq \"com.vmware.sso.PrincipalManagement\"} | Select Name,Enabled,@{N=\"EventTypeId\";E={$_.ExtensionData.Info.Expression.Expression.EventTypeId}}\n\nIf an alarm is not created to alert on SSO account actions, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Security >> Alarm Definitions.\n\nClick \"Add\".\n\nProvide the alarm name of \"SSO account actions - com.vmware.sso.PrincipalManagement\" and an optional description.\n\nFrom the \"Target type\" drop-down menu, select \"vCenter Server\".\n\nClick \"Next\".\n\nPaste \"com.vmware.sso.PrincipalManagement\" (without quotes) in the line after \"IF\" and press \"Enter\".\n\nNext to \"Trigger the alarm and\", select \"Show as Warning\".\n\nConfigure the desired notification actions that will inform the SA and ISSO of the event.\n\nClick \"Next\". Click \"Next\" again. Click \"Create\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60012r885620_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256337'\n  tag rid: 'SV-256337r885622_rule'\n  tag stig_id: 'VCSA-70-000123'\n  tag gtitle: 'SRG-APP-000291'\n  tag fix_id: 'F-59955r885621_fix'\n  tag satisfies: ['SRG-APP-000291', 'SRG-APP-000292', 'SRG-APP-000293', 'SRG-APP-000294', 'SRG-APP-000320']\n  tag 'documentable'\n  tag cci: ['CCI-001683', 'CCI-001684', 'CCI-001685', 'CCI-001686', 'CCI-002132']\n  tag nist: ['AC-2 (4)', 'AC-2 (4)', 'AC-2 (4)', 'AC-2 (4)', 'AC-2 (4)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256337.rb"},"title":"The vCenter Server must provide an immediate real-time alert to the system administrator (SA) and information system security officer (ISSO), at a minimum, on every Single Sign-On (SSO) account action.","desc":"Once an attacker establishes initial access to a system, they often attempt to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create a new account. They may also try to hijack an existing account by changing a password or enabling a previously disabled account. Therefore, all actions performed on accounts in the SSO domain much be alerted on in vCenter at a minimum and ideally on a Security Information and Event Management (SIEM) system as well.\n\nTo ensure the appropriate personnel are alerted about SSO account actions, create a new vCenter alarm for the \"com.vmware.sso.PrincipalManagement\" event ID and configure the alert mechanisms appropriately.\n\n","descriptions":{"default":"Once an attacker establishes initial access to a system, they often attempt to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create a new account. They may also try to hijack an existing account by changing a password or enabling a previously disabled account. Therefore, all actions performed on accounts in the SSO domain much be alerted on in vCenter at a minimum and ideally on a Security Information and Event Management (SIEM) system as well.\n\nTo ensure the appropriate personnel are alerted about SSO account actions, create a new vCenter alarm for the \"com.vmware.sso.PrincipalManagement\" event ID and configure the alert mechanisms appropriately.\n\n","check":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Security >> Alarm Definitions.\n\nVerify an alarm has been created to alert upon all SSO account actions.\n\nThe alarm name may vary, but it is suggested to name it \"SSO account actions - com.vmware.sso.PrincipalManagement\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AlarmDefinition | Where {$_.ExtensionData.Info.Expression.Expression.EventTypeId -eq \"com.vmware.sso.PrincipalManagement\"} | Select Name,Enabled,@{N=\"EventTypeId\";E={$_.ExtensionData.Info.Expression.Expression.EventTypeId}}\n\nIf an alarm is not created to alert on SSO account actions, this is a finding.","fix":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Security >> Alarm Definitions.\n\nClick \"Add\".\n\nProvide the alarm name of \"SSO account actions - com.vmware.sso.PrincipalManagement\" and an optional description.\n\nFrom the \"Target type\" drop-down menu, select \"vCenter Server\".\n\nClick \"Next\".\n\nPaste \"com.vmware.sso.PrincipalManagement\" (without quotes) in the line after \"IF\" and press \"Enter\".\n\nNext to \"Trigger the alarm and\", select \"Show as Warning\".\n\nConfigure the desired notification actions that will inform the SA and ISSO of the event.\n\nClick \"Next\". Click \"Next\" again. Click \"Create\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60012r885620_chk","severity":"medium","gid":"V-256337","rid":"SV-256337r885622_rule","stig_id":"VCSA-70-000123","gtitle":"SRG-APP-000291","fix_id":"F-59955r885621_fix","satisfies":["SRG-APP-000291","SRG-APP-000292","SRG-APP-000293","SRG-APP-000294","SRG-APP-000320"],"documentable":null,"cci":["CCI-001683","CCI-001684","CCI-001685","CCI-001686","CCI-002132"],"nist":["AC-2 (4)","AC-2 (4)","AC-2 (4)","AC-2 (4)","AC-2 (4)"]}},{"id":"SV-256338","code":"control 'SV-256338' do\n  title 'The vCenter Server must set the interval for counting failed login attempts to at least 15 minutes.'\n  desc 'By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy. \n\nVerify the following lockout policy is set as follows: \n\nTime interval between failures: 900 seconds \n\nIf this lockout policy is not configured as stated, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy.\n\nClick \"Edit\".\n\nSet \"Time interval between failures\" to \"900\" and click \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60013r885623_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256338'\n  tag rid: 'SV-256338r885625_rule'\n  tag stig_id: 'VCSA-70-000145'\n  tag gtitle: 'SRG-APP-000345'\n  tag fix_id: 'F-59956r885624_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002238']\n  tag nist: ['AC-7 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256338.rb"},"title":"The vCenter Server must set the interval for counting failed login attempts to at least 15 minutes.","desc":"By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.","descriptions":{"default":"By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute forcing, is reduced. Limits are imposed by locking the account.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy. \n\nVerify the following lockout policy is set as follows: \n\nTime interval between failures: 900 seconds \n\nIf this lockout policy is not configured as stated, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy.\n\nClick \"Edit\".\n\nSet \"Time interval between failures\" to \"900\" and click \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60013r885623_chk","severity":"medium","gid":"V-256338","rid":"SV-256338r885625_rule","stig_id":"VCSA-70-000145","gtitle":"SRG-APP-000345","fix_id":"F-59956r885624_fix","documentable":null,"cci":["CCI-002238"],"nist":["AC-7 b"]}},{"id":"SV-256339","code":"control 'SV-256339' do\n  title 'The vCenter Server must be configured to send logs to a central log server.'\n  desc 'vCenter must be configured to send near real-time log data to syslog collectors so information will be available to investigators in the case of a security incident or to assist in troubleshooting.'\n  desc 'check', 'Open the Virtual Appliance Management Interface (VAMI) by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with a Single Sign-On (SSO) account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Syslog\" on the left navigation pane.\n\nOn the resulting pane on the right, verify at least one site-specific syslog receiver is configured and is listed as \"Reachable\".\n\nIf no valid syslog collector is configured or if the collector is not listed as \"Reachable\", this is a finding.'\n  desc 'fix', 'Open the VAMI by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with an SSO account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Syslog\" on the left navigation pane.\n\nOn the resulting pane on the right, click \"Edit\" or \"Configure\".\n\nEdit or add the address and port of a site-specific syslog aggregator or Security Information Event Management (SIEM) system with the appropriate protocol.\n\nUser Datagram Protocol (UDP) is discouraged due to its stateless and unencrypted nature. Transport Layer Security (TLS) is preferred. \n\nClick \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60014r885626_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256339'\n  tag rid: 'SV-256339r885628_rule'\n  tag stig_id: 'VCSA-70-000148'\n  tag gtitle: 'SRG-APP-000358'\n  tag fix_id: 'F-59957r885627_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256339.rb"},"title":"The vCenter Server must be configured to send logs to a central log server.","desc":"vCenter must be configured to send near real-time log data to syslog collectors so information will be available to investigators in the case of a security incident or to assist in troubleshooting.","descriptions":{"default":"vCenter must be configured to send near real-time log data to syslog collectors so information will be available to investigators in the case of a security incident or to assist in troubleshooting.","check":"Open the Virtual Appliance Management Interface (VAMI) by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with a Single Sign-On (SSO) account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Syslog\" on the left navigation pane.\n\nOn the resulting pane on the right, verify at least one site-specific syslog receiver is configured and is listed as \"Reachable\".\n\nIf no valid syslog collector is configured or if the collector is not listed as \"Reachable\", this is a finding.","fix":"Open the VAMI by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with an SSO account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Syslog\" on the left navigation pane.\n\nOn the resulting pane on the right, click \"Edit\" or \"Configure\".\n\nEdit or add the address and port of a site-specific syslog aggregator or Security Information Event Management (SIEM) system with the appropriate protocol.\n\nUser Datagram Protocol (UDP) is discouraged due to its stateless and unencrypted nature. Transport Layer Security (TLS) is preferred. \n\nClick \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60014r885626_chk","severity":"medium","gid":"V-256339","rid":"SV-256339r885628_rule","stig_id":"VCSA-70-000148","gtitle":"SRG-APP-000358","fix_id":"F-59957r885627_fix","documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}},{"id":"SV-256340","code":"control 'SV-256340' do\n  title 'vCenter must provide an immediate real-time alert to the system administrator (SA) and information system security officer (ISSO), at a minimum, of all audit failure events requiring real-time alerts.'\n  desc 'It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected. \n\nAlerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).\n\n'\n  desc 'check', 'Review the Central Logging Server being used to verify it is configured to alert the SA and ISSO, at a minimum, on any AO-defined events. Otherwise, this is a finding.\n\nIf there are no AO-defined events, this is not a finding.'\n  desc 'fix', 'Configure the Central Logging Server being used to alert the SA and ISSO, at a minimum, on any AO-defined events.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60015r885629_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256340'\n  tag rid: 'SV-256340r885631_rule'\n  tag stig_id: 'VCSA-70-000150'\n  tag gtitle: 'SRG-APP-000360'\n  tag fix_id: 'F-59958r885630_fix'\n  tag satisfies: ['SRG-APP-000360', 'SRG-APP-000379', 'SRG-APP-000510']\n  tag 'documentable'\n  tag cci: ['CCI-000172', 'CCI-001744', 'CCI-001858']\n  tag nist: ['AU-12 c', 'CM-3 (5)', 'AU-5 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256340.rb"},"title":"vCenter must provide an immediate real-time alert to the system administrator (SA) and information system security officer (ISSO), at a minimum, of all audit failure events requiring real-time alerts.","desc":"It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected. \n\nAlerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).\n\n","descriptions":{"default":"It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of an impending failure of the audit capability and system operation may be adversely affected. \n\nAlerts provide organizations with urgent messages. Real-time alerts provide these messages immediately (i.e., the time from event detection to alert occurs in seconds or less).\n\n","check":"Review the Central Logging Server being used to verify it is configured to alert the SA and ISSO, at a minimum, on any AO-defined events. Otherwise, this is a finding.\n\nIf there are no AO-defined events, this is not a finding.","fix":"Configure the Central Logging Server being used to alert the SA and ISSO, at a minimum, on any AO-defined events."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60015r885629_chk","severity":"medium","gid":"V-256340","rid":"SV-256340r885631_rule","stig_id":"VCSA-70-000150","gtitle":"SRG-APP-000360","fix_id":"F-59958r885630_fix","satisfies":["SRG-APP-000360","SRG-APP-000379","SRG-APP-000510"],"documentable":null,"cci":["CCI-000172","CCI-001744","CCI-001858"],"nist":["AU-12 c","CM-3 (5)","AU-5 (2)"]}},{"id":"SV-256341","code":"control 'SV-256341' do\n  title 'The vCenter Server must compare internal information system clocks at least every 24 hours with an authoritative time server.'\n  desc 'Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside of the configured acceptable allowance (drift) may be inaccurate. Additionally, unnecessary synchronization may have an adverse impact on system performance and may indicate malicious activity.\n\nSynchronizing internal information system clocks to an authoritative time server provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.'\n  desc 'check', 'Open the Virtual Appliance Management Interface (VAMI) by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with a Single Sign-On (SSO) account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Time\" on the left navigation pane.\n\nOn the resulting pane on the right, verify at least one authorized time server is configured and is listed as \"Reachable\".\n\nIf \"NTP\" is not enabled and at least one authorized time server configured, this is a finding.'\n  desc 'fix', 'Open the VAMI by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with an SSO account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Time\" on the left navigation pane.\n\nOn the resulting pane on the right, click \"Edit\" under \"Time Synchronization\".\n\nSelect \"NTP\" for \"Mode\" and enter a list of authorized time servers separated by commas. Click \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60016r885632_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256341'\n  tag rid: 'SV-256341r892804_rule'\n  tag stig_id: 'VCSA-70-000158'\n  tag gtitle: 'SRG-APP-000371'\n  tag fix_id: 'F-59959r885633_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001891']\n  tag nist: ['AU-8 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256341.rb"},"title":"The vCenter Server must compare internal information system clocks at least every 24 hours with an authoritative time server.","desc":"Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside of the configured acceptable allowance (drift) may be inaccurate. Additionally, unnecessary synchronization may have an adverse impact on system performance and may indicate malicious activity.\n\nSynchronizing internal information system clocks to an authoritative time server provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.","descriptions":{"default":"Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside of the configured acceptable allowance (drift) may be inaccurate. Additionally, unnecessary synchronization may have an adverse impact on system performance and may indicate malicious activity.\n\nSynchronizing internal information system clocks to an authoritative time server provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.","check":"Open the Virtual Appliance Management Interface (VAMI) by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with a Single Sign-On (SSO) account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Time\" on the left navigation pane.\n\nOn the resulting pane on the right, verify at least one authorized time server is configured and is listed as \"Reachable\".\n\nIf \"NTP\" is not enabled and at least one authorized time server configured, this is a finding.","fix":"Open the VAMI by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with an SSO account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Time\" on the left navigation pane.\n\nOn the resulting pane on the right, click \"Edit\" under \"Time Synchronization\".\n\nSelect \"NTP\" for \"Mode\" and enter a list of authorized time servers separated by commas. Click \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60016r885632_chk","severity":"medium","gid":"V-256341","rid":"SV-256341r892804_rule","stig_id":"VCSA-70-000158","gtitle":"SRG-APP-000371","fix_id":"F-59959r885633_fix","documentable":null,"cci":["CCI-001891"],"nist":["AU-8 (1) (a)"]}},{"id":"SV-256342","code":"control 'SV-256342' do\n  title 'The vCenter Server Machine Secure Sockets Layer (SSL) certificate must be issued by a DOD certificate authority.'\n  desc 'Untrusted certificate authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DOD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DOD-approved CA, trust of this CA has not been established.\n\nThe DOD will only accept public key infrastructure (PKI) certificates obtained from a DOD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of Transport Layer Security (TLS) certificates.\n\nThe default self-signed, VMware Certificate Authority (VMCA)-issued vCenter reverse proxy certificate must be replaced with a DOD-approved certificate. The use of a DOD certificate on the vCenter reverse proxy and other services assures clients that the service they are connecting to is legitimate and trusted.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Certificates >> Certificate Management >> Machine SSL Certificate.\n\nClick \"View Details\" and examine the \"Issuer Information\" block.\n\nIf the issuer specified is not a DOD-approved certificate authority, this is a finding.'\n  desc 'fix', 'Obtain a DOD-issued certificate and private key for each vCenter in the system following the requirements below:\n\nKey size: 2048 bits or more (PEM encoded)\nCRT format (Base-64)\nx509 version 3\nSubjectAltName must contain DNS Name=<machine_FQDN>\nContains the following Key Usages: Digital Signature, Non Repudiation, Key Encipherment\n\nExport the entire certificate issuing chain up to the root in Base-64 format. Concatenate the individual certificates into one file with the \".cer\" extension.\n\nFrom the vSphere Client, go to Administration >> Certificates >> Certificate Management >> Machine SSL Certificate.\n\nClick Actions >> Import and Replace Certificate.\n\nSelect the \"Replace with external CA certificate\" radio button and click \"Next\".\n\nSupply the CA-issued certificate , the exported roots file, and the private key.\n\nClick \"Replace\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60017r885635_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256342'\n  tag rid: 'SV-256342r885637_rule'\n  tag stig_id: 'VCSA-70-000195'\n  tag gtitle: 'SRG-APP-000427'\n  tag fix_id: 'F-59960r885636_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002470']\n  tag nist: ['SC-23 (5)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256342.rb"},"title":"The vCenter Server Machine Secure Sockets Layer (SSL) certificate must be issued by a DOD certificate authority.","desc":"Untrusted certificate authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DOD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DOD-approved CA, trust of this CA has not been established.\n\nThe DOD will only accept public key infrastructure (PKI) certificates obtained from a DOD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of Transport Layer Security (TLS) certificates.\n\nThe default self-signed, VMware Certificate Authority (VMCA)-issued vCenter reverse proxy certificate must be replaced with a DOD-approved certificate. The use of a DOD certificate on the vCenter reverse proxy and other services assures clients that the service they are connecting to is legitimate and trusted.","descriptions":{"default":"Untrusted certificate authorities (CA) can issue certificates, but they may be issued by organizations or individuals that seek to compromise DOD systems or by organizations with insufficient security controls. If the CA used for verifying the certificate is not a DOD-approved CA, trust of this CA has not been established.\n\nThe DOD will only accept public key infrastructure (PKI) certificates obtained from a DOD-approved internal or external certificate authority. Reliance on CAs for the establishment of secure sessions includes, for example, the use of Transport Layer Security (TLS) certificates.\n\nThe default self-signed, VMware Certificate Authority (VMCA)-issued vCenter reverse proxy certificate must be replaced with a DOD-approved certificate. The use of a DOD certificate on the vCenter reverse proxy and other services assures clients that the service they are connecting to is legitimate and trusted.","check":"From the vSphere Client, go to Administration >> Certificates >> Certificate Management >> Machine SSL Certificate.\n\nClick \"View Details\" and examine the \"Issuer Information\" block.\n\nIf the issuer specified is not a DOD-approved certificate authority, this is a finding.","fix":"Obtain a DOD-issued certificate and private key for each vCenter in the system following the requirements below:\n\nKey size: 2048 bits or more (PEM encoded)\nCRT format (Base-64)\nx509 version 3\nSubjectAltName must contain DNS Name=<machine_FQDN>\nContains the following Key Usages: Digital Signature, Non Repudiation, Key Encipherment\n\nExport the entire certificate issuing chain up to the root in Base-64 format. Concatenate the individual certificates into one file with the \".cer\" extension.\n\nFrom the vSphere Client, go to Administration >> Certificates >> Certificate Management >> Machine SSL Certificate.\n\nClick Actions >> Import and Replace Certificate.\n\nSelect the \"Replace with external CA certificate\" radio button and click \"Next\".\n\nSupply the CA-issued certificate , the exported roots file, and the private key.\n\nClick \"Replace\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60017r885635_chk","severity":"medium","gid":"V-256342","rid":"SV-256342r885637_rule","stig_id":"VCSA-70-000195","gtitle":"SRG-APP-000427","fix_id":"F-59960r885636_fix","documentable":null,"cci":["CCI-002470"],"nist":["SC-23 (5)"]}},{"id":"SV-256343","code":"control 'SV-256343' do\n  title 'The vCenter Server must disable the Customer Experience Improvement Program (CEIP).'\n  desc 'The VMware CEIP sends VMware anonymized system information that is used to improve the quality, reliability, and functionality of VMware products and services. For confidentiality purposes this feature must be disabled.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Deployment >> Customer Experience Improvement Program.\n\nIf Customer Experience Improvement \"Program Status\" is \"Joined\", this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Deployment >> Customer Experience Improvement Program.\n\nClick \"Leave Program\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60018r885638_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256343'\n  tag rid: 'SV-256343r885640_rule'\n  tag stig_id: 'VCSA-70-000248'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59961r885639_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256343.rb"},"title":"The vCenter Server must disable the Customer Experience Improvement Program (CEIP).","desc":"The VMware CEIP sends VMware anonymized system information that is used to improve the quality, reliability, and functionality of VMware products and services. For confidentiality purposes this feature must be disabled.","descriptions":{"default":"The VMware CEIP sends VMware anonymized system information that is used to improve the quality, reliability, and functionality of VMware products and services. For confidentiality purposes this feature must be disabled.","check":"From the vSphere Client, go to Administration >> Deployment >> Customer Experience Improvement Program.\n\nIf Customer Experience Improvement \"Program Status\" is \"Joined\", this is a finding.","fix":"From the vSphere Client, go to Administration >> Deployment >> Customer Experience Improvement Program.\n\nClick \"Leave Program\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60018r885638_chk","severity":"medium","gid":"V-256343","rid":"SV-256343r885640_rule","stig_id":"VCSA-70-000248","gtitle":"SRG-APP-000516","fix_id":"F-59961r885639_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256344","code":"control 'SV-256344' do\n  title 'The vCenter server must enforce SNMPv3 security features where SNMP is required.'\n  desc 'SNMPv3 supports commercial-grade security, including authentication, authorization, access control, and privacy. Previous versions of the protocol contained well-known security weaknesses that were easily exploited. SNMPv3 can be configured for identification and cryptographically based authentication. \n\nSNMPv3 defines a user-based security model (USM) and a view-based access control model (VACM). SNMPv3 USM provides data integrity, data origin authentication, message replay protection, and protection against disclosure of the message payload. SNMPv3 VACM provides access control to determine whether a specific type of access (read or write) to the management information is allowed. Implement both VACM and USM for full protection.\n\nSNMPv3 must be disabled by default and enabled only if used. SNMP v3 provides security feature enhancements to SNMP, including encryption and message authentication.'\n  desc 'check', 'At the command prompt on the vCenter Server Appliance, run the following commands:\n\n# appliancesh\n# snmp.get\n\nNote: The \"appliancesh\" command is not needed if the default shell has not been changed for root.\n\nIf \"Enable\" is set to \"False\", this is not a finding.\n\nIf \"Enable\" is set to \"True\" and \"Authentication\" is not set to \"SHA1\", this is a finding.\n\nIf \"Enable\" is set to \"True\" and \"Privacy\" is not set to \"AES128\", this is a finding.\n\nIf any \"Users\" are configured with a \"Sec_level\" that does not equal \"priv\", this is a finding.'\n  desc 'fix', 'At the command prompt on the vCenter Server Appliance, run the following commands:\n\n# appliancesh\n# snmp.set --authentication SHA1\n# snmp.set --privacy AES128\n\nTo change the security level of a user, run the following command:\n\n# snmp.set --users <username>/<auth_password> <priv_password>/priv'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60019r885641_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256344'\n  tag rid: 'SV-256344r885643_rule'\n  tag stig_id: 'VCSA-70-000253'\n  tag gtitle: 'SRG-APP-000575'\n  tag fix_id: 'F-59962r885642_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001967']\n  tag nist: ['IA-3 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256344.rb"},"title":"The vCenter server must enforce SNMPv3 security features where SNMP is required.","desc":"SNMPv3 supports commercial-grade security, including authentication, authorization, access control, and privacy. Previous versions of the protocol contained well-known security weaknesses that were easily exploited. SNMPv3 can be configured for identification and cryptographically based authentication. \n\nSNMPv3 defines a user-based security model (USM) and a view-based access control model (VACM). SNMPv3 USM provides data integrity, data origin authentication, message replay protection, and protection against disclosure of the message payload. SNMPv3 VACM provides access control to determine whether a specific type of access (read or write) to the management information is allowed. Implement both VACM and USM for full protection.\n\nSNMPv3 must be disabled by default and enabled only if used. SNMP v3 provides security feature enhancements to SNMP, including encryption and message authentication.","descriptions":{"default":"SNMPv3 supports commercial-grade security, including authentication, authorization, access control, and privacy. Previous versions of the protocol contained well-known security weaknesses that were easily exploited. SNMPv3 can be configured for identification and cryptographically based authentication. \n\nSNMPv3 defines a user-based security model (USM) and a view-based access control model (VACM). SNMPv3 USM provides data integrity, data origin authentication, message replay protection, and protection against disclosure of the message payload. SNMPv3 VACM provides access control to determine whether a specific type of access (read or write) to the management information is allowed. Implement both VACM and USM for full protection.\n\nSNMPv3 must be disabled by default and enabled only if used. SNMP v3 provides security feature enhancements to SNMP, including encryption and message authentication.","check":"At the command prompt on the vCenter Server Appliance, run the following commands:\n\n# appliancesh\n# snmp.get\n\nNote: The \"appliancesh\" command is not needed if the default shell has not been changed for root.\n\nIf \"Enable\" is set to \"False\", this is not a finding.\n\nIf \"Enable\" is set to \"True\" and \"Authentication\" is not set to \"SHA1\", this is a finding.\n\nIf \"Enable\" is set to \"True\" and \"Privacy\" is not set to \"AES128\", this is a finding.\n\nIf any \"Users\" are configured with a \"Sec_level\" that does not equal \"priv\", this is a finding.","fix":"At the command prompt on the vCenter Server Appliance, run the following commands:\n\n# appliancesh\n# snmp.set --authentication SHA1\n# snmp.set --privacy AES128\n\nTo change the security level of a user, run the following command:\n\n# snmp.set --users <username>/<auth_password> <priv_password>/priv"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60019r885641_chk","severity":"medium","gid":"V-256344","rid":"SV-256344r885643_rule","stig_id":"VCSA-70-000253","gtitle":"SRG-APP-000575","fix_id":"F-59962r885642_fix","documentable":null,"cci":["CCI-001967"],"nist":["IA-3 (1)"]}},{"id":"SV-256345","code":"control 'SV-256345' do\n  title 'The vCenter server must disable SNMPv1/2 receivers.'\n  desc 'SNMPv3 supports commercial-grade security, including authentication, authorization, access control, and privacy. Previous versions of the protocol contained well-known security weaknesses that were easily exploited. Therefore, SNMPv1/2 receivers must be disabled, while SNMPv3 is configured in another control. vCenter exposes SNMP v1/2 in the UI and SNMPv3 in the CLI.'\n  desc 'check', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> General.\n\nClick \"Edit\".\n\nOn the \"SNMP receivers\" tab, note the presence of any enabled receiver.\n\nIf there are any enabled receivers, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> General.\n\nClick \"Edit\".\n\nOn the \"SNMP receivers\" tab, ensure all receivers are disabled.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60020r885644_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256345'\n  tag rid: 'SV-256345r885646_rule'\n  tag stig_id: 'VCSA-70-000265'\n  tag gtitle: 'SRG-APP-000575'\n  tag fix_id: 'F-59963r885645_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001967']\n  tag nist: ['IA-3 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256345.rb"},"title":"The vCenter server must disable SNMPv1/2 receivers.","desc":"SNMPv3 supports commercial-grade security, including authentication, authorization, access control, and privacy. Previous versions of the protocol contained well-known security weaknesses that were easily exploited. Therefore, SNMPv1/2 receivers must be disabled, while SNMPv3 is configured in another control. vCenter exposes SNMP v1/2 in the UI and SNMPv3 in the CLI.","descriptions":{"default":"SNMPv3 supports commercial-grade security, including authentication, authorization, access control, and privacy. Previous versions of the protocol contained well-known security weaknesses that were easily exploited. Therefore, SNMPv1/2 receivers must be disabled, while SNMPv3 is configured in another control. vCenter exposes SNMP v1/2 in the UI and SNMPv3 in the CLI.","check":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> General.\n\nClick \"Edit\".\n\nOn the \"SNMP receivers\" tab, note the presence of any enabled receiver.\n\nIf there are any enabled receivers, this is a finding.","fix":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> General.\n\nClick \"Edit\".\n\nOn the \"SNMP receivers\" tab, ensure all receivers are disabled."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60020r885644_chk","severity":"medium","gid":"V-256345","rid":"SV-256345r885646_rule","stig_id":"VCSA-70-000265","gtitle":"SRG-APP-000575","fix_id":"F-59963r885645_fix","documentable":null,"cci":["CCI-001967"],"nist":["IA-3 (1)"]}},{"id":"SV-256346","code":"control 'SV-256346' do\n  title 'The vCenter Server must require an administrator to unlock an account locked due to excessive login failures.'\n  desc 'By requiring that Single Sign-On (SSO) accounts be unlocked manually, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. When the account unlock time is set to zero, once an account is locked it can only be unlocked manually by an administrator.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy. \n\nVerify the following lockout policy is set as follows:\n\nUnlock time: 0 \n\nIf this account lockout policy is not configured as stated, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy.\n\nClick \"Edit\".\n\nSet the \"Unlock time\" to \"0\" and click \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60021r885647_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256346'\n  tag rid: 'SV-256346r885649_rule'\n  tag stig_id: 'VCSA-70-000266'\n  tag gtitle: 'SRG-APP-000345'\n  tag fix_id: 'F-59964r885648_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002238']\n  tag nist: ['AC-7 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256346.rb"},"title":"The vCenter Server must require an administrator to unlock an account locked due to excessive login failures.","desc":"By requiring that Single Sign-On (SSO) accounts be unlocked manually, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. When the account unlock time is set to zero, once an account is locked it can only be unlocked manually by an administrator.","descriptions":{"default":"By requiring that Single Sign-On (SSO) accounts be unlocked manually, the risk of unauthorized access via user password guessing, otherwise known as brute forcing, is reduced. When the account unlock time is set to zero, once an account is locked it can only be unlocked manually by an administrator.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy. \n\nVerify the following lockout policy is set as follows:\n\nUnlock time: 0 \n\nIf this account lockout policy is not configured as stated, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Local Accounts >> Lockout Policy.\n\nClick \"Edit\".\n\nSet the \"Unlock time\" to \"0\" and click \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60021r885647_chk","severity":"medium","gid":"V-256346","rid":"SV-256346r885649_rule","stig_id":"VCSA-70-000266","gtitle":"SRG-APP-000345","fix_id":"F-59964r885648_fix","documentable":null,"cci":["CCI-002238"],"nist":["AC-7 b"]}},{"id":"SV-256347","code":"control 'SV-256347' do\n  title 'The vCenter Server must disable the distributed virtual switch health check.'\n  desc 'Network health check is disabled by default. Once enabled, the health check packets contain information on host#, vds#, and port#, which an attacker would find useful. It is recommended that network health check be used for troubleshooting and turned off when troubleshooting is finished.'\n  desc 'check', 'If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> Configure >> Settings >> Health Check.\n\nView the health check pane and verify the \"VLAN and MTU\" and \"Teaming and failover\" checks are \"Disabled\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n$vds = Get-VDSwitch\n$vds.ExtensionData.Config.HealthCheckConfig\n\nIf the health check feature is enabled on distributed switches and is not on temporarily for troubleshooting purposes, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> Configure >> Settings >> Health Check.\n\nClick \"Edit\".\n\nDisable the \"VLAN and MTU\" and \"Teaming and failover\" checks.\n\nClick \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-View -ViewType DistributedVirtualSwitch | ?{($_.config.HealthCheckConfig | ?{$_.enable -notmatch \"False\"})}| %{$_.UpdateDVSHealthCheckConfig(@((New-Object Vmware.Vim.VMwareDVSVlanMtuHealthCheckConfig -property @{enable=0}),(New-Object Vmware.Vim.VMwareDVSTeamingHealthCheckConfig -property @{enable=0})))}'\n  impact 0.3\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60022r885650_chk'\n  tag severity: 'low'\n  tag gid: 'V-256347'\n  tag rid: 'SV-256347r885652_rule'\n  tag stig_id: 'VCSA-70-000267'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59965r885651_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256347.rb"},"title":"The vCenter Server must disable the distributed virtual switch health check.","desc":"Network health check is disabled by default. Once enabled, the health check packets contain information on host#, vds#, and port#, which an attacker would find useful. It is recommended that network health check be used for troubleshooting and turned off when troubleshooting is finished.","descriptions":{"default":"Network health check is disabled by default. Once enabled, the health check packets contain information on host#, vds#, and port#, which an attacker would find useful. It is recommended that network health check be used for troubleshooting and turned off when troubleshooting is finished.","check":"If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> Configure >> Settings >> Health Check.\n\nView the health check pane and verify the \"VLAN and MTU\" and \"Teaming and failover\" checks are \"Disabled\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n$vds = Get-VDSwitch\n$vds.ExtensionData.Config.HealthCheckConfig\n\nIf the health check feature is enabled on distributed switches and is not on temporarily for troubleshooting purposes, this is a finding.","fix":"From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> Configure >> Settings >> Health Check.\n\nClick \"Edit\".\n\nDisable the \"VLAN and MTU\" and \"Teaming and failover\" checks.\n\nClick \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-View -ViewType DistributedVirtualSwitch | ?{($_.config.HealthCheckConfig | ?{$_.enable -notmatch \"False\"})}| %{$_.UpdateDVSHealthCheckConfig(@((New-Object Vmware.Vim.VMwareDVSVlanMtuHealthCheckConfig -property @{enable=0}),(New-Object Vmware.Vim.VMwareDVSTeamingHealthCheckConfig -property @{enable=0})))}"},"impact":0.3,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60022r885650_chk","severity":"low","gid":"V-256347","rid":"SV-256347r885652_rule","stig_id":"VCSA-70-000267","gtitle":"SRG-APP-000516","fix_id":"F-59965r885651_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256348","code":"control 'SV-256348' do\n  title 'The vCenter Server must set the distributed port group Forged Transmits policy to \"Reject\".'\n  desc 'If the virtual machine operating system changes the Media Access Control (MAC) address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.\n\nWhen the \"Forged Transmits\" option is set to \"Accept\", ESXi does not compare source and effective MAC addresses.\n\nTo protect against MAC impersonation, set the \"Forged Transmits\" option to \"Reject\". The host compares the source MAC address being transmitted by the guest operating system with the effective MAC address for its virtual machine adapter to determine if they match. If the addresses do not match, the ESXi host drops the packet.'\n  desc 'check', 'If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group.\n\nSelect Configure >> Settings >> Policies.\n\nVerify \"Forged Transmits\" is set to \"Reject\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy\n\nIf the \"Forged Transmits\" policy is set to accept for a nonuplink port, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group.\n\nSelect Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"Security\" tab.\n\nSet \"Forged Transmits\" to \"Reject\".\n\nClick \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60023r885653_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256348'\n  tag rid: 'SV-256348r885655_rule'\n  tag stig_id: 'VCSA-70-000268'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59966r885654_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256348.rb"},"title":"The vCenter Server must set the distributed port group Forged Transmits policy to \"Reject\".","desc":"If the virtual machine operating system changes the Media Access Control (MAC) address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.\n\nWhen the \"Forged Transmits\" option is set to \"Accept\", ESXi does not compare source and effective MAC addresses.\n\nTo protect against MAC impersonation, set the \"Forged Transmits\" option to \"Reject\". The host compares the source MAC address being transmitted by the guest operating system with the effective MAC address for its virtual machine adapter to determine if they match. If the addresses do not match, the ESXi host drops the packet.","descriptions":{"default":"If the virtual machine operating system changes the Media Access Control (MAC) address, the operating system can send frames with an impersonated source MAC address at any time. This allows an operating system to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.\n\nWhen the \"Forged Transmits\" option is set to \"Accept\", ESXi does not compare source and effective MAC addresses.\n\nTo protect against MAC impersonation, set the \"Forged Transmits\" option to \"Reject\". The host compares the source MAC address being transmitted by the guest operating system with the effective MAC address for its virtual machine adapter to determine if they match. If the addresses do not match, the ESXi host drops the packet.","check":"If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group.\n\nSelect Configure >> Settings >> Policies.\n\nVerify \"Forged Transmits\" is set to \"Reject\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy\n\nIf the \"Forged Transmits\" policy is set to accept for a nonuplink port, this is a finding.","fix":"From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group.\n\nSelect Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"Security\" tab.\n\nSet \"Forged Transmits\" to \"Reject\".\n\nClick \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -ForgedTransmits $false"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60023r885653_chk","severity":"medium","gid":"V-256348","rid":"SV-256348r885655_rule","stig_id":"VCSA-70-000268","gtitle":"SRG-APP-000516","fix_id":"F-59966r885654_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256349","code":"control 'SV-256349' do\n  title 'The vCenter Server must set the distributed port group Media Access Control (MAC) Address Change policy to \"Reject\".'\n  desc 'If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.\n\nThis will prevent virtual machines from changing their effective MAC address and will affect applications that require this functionality. This will also affect how a layer 2 bridge will operate and will affect applications that require a specific MAC address for licensing.'\n  desc 'check', 'If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group.\n\nSelect Configure >> Settings >> Policies.\n\nVerify \"MAC Address Changes\" is set to \"Reject\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy\n\nIf the \"MAC Address Changes\" policy is set to \"Accept\", this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group.\n\nSelect Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"Security\" tab.\n\nSet \"MAC Address Changes\" to \"Reject\".\n\nClick \"OK\".\n \nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60024r885656_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256349'\n  tag rid: 'SV-256349r885658_rule'\n  tag stig_id: 'VCSA-70-000269'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59967r885657_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256349.rb"},"title":"The vCenter Server must set the distributed port group Media Access Control (MAC) Address Change policy to \"Reject\".","desc":"If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.\n\nThis will prevent virtual machines from changing their effective MAC address and will affect applications that require this functionality. This will also affect how a layer 2 bridge will operate and will affect applications that require a specific MAC address for licensing.","descriptions":{"default":"If the virtual machine operating system changes the MAC address, it can send frames with an impersonated source MAC address at any time. This allows it to stage malicious attacks on the devices in a network by impersonating a network adaptor authorized by the receiving network.\n\nThis will prevent virtual machines from changing their effective MAC address and will affect applications that require this functionality. This will also affect how a layer 2 bridge will operate and will affect applications that require a specific MAC address for licensing.","check":"If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group.\n\nSelect Configure >> Settings >> Policies.\n\nVerify \"MAC Address Changes\" is set to \"Reject\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy\n\nIf the \"MAC Address Changes\" policy is set to \"Accept\", this is a finding.","fix":"From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group.\n\nSelect Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"Security\" tab.\n\nSet \"MAC Address Changes\" to \"Reject\".\n\nClick \"OK\".\n \nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -MacChanges $false"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60024r885656_chk","severity":"medium","gid":"V-256349","rid":"SV-256349r885658_rule","stig_id":"VCSA-70-000269","gtitle":"SRG-APP-000516","fix_id":"F-59967r885657_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256350","code":"control 'SV-256350' do\n  title 'The vCenter Server must set the distributed port group Promiscuous Mode policy to \"Reject\".'\n  desc 'When promiscuous mode is enabled for a virtual switch, all virtual machines connected to the port group have the potential of reading all packets across that network, meaning only the virtual machines connected to that port group.\n\nPromiscuous mode is disabled by default on the ESXi Server, and this is the recommended setting.'\n  desc 'check', 'If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group. \n\nSelect Configure >> Settings >> Policies.\n\nVerify \"Promiscuous Mode\" is set to \"Reject\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy\n\nIf the \"Promiscuous Mode\" policy is set to \"Accept\", this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group. \n\nSelect Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"Security\" tab.\n\nSet \"Promiscuous Mode\" to \"Reject\".\n\nClick \"OK\".\n \nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60025r885659_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256350'\n  tag rid: 'SV-256350r885661_rule'\n  tag stig_id: 'VCSA-70-000270'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59968r885660_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256350.rb"},"title":"The vCenter Server must set the distributed port group Promiscuous Mode policy to \"Reject\".","desc":"When promiscuous mode is enabled for a virtual switch, all virtual machines connected to the port group have the potential of reading all packets across that network, meaning only the virtual machines connected to that port group.\n\nPromiscuous mode is disabled by default on the ESXi Server, and this is the recommended setting.","descriptions":{"default":"When promiscuous mode is enabled for a virtual switch, all virtual machines connected to the port group have the potential of reading all packets across that network, meaning only the virtual machines connected to that port group.\n\nPromiscuous mode is disabled by default on the ESXi Server, and this is the recommended setting.","check":"If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group. \n\nSelect Configure >> Settings >> Policies.\n\nVerify \"Promiscuous Mode\" is set to \"Reject\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy\n\nIf the \"Promiscuous Mode\" policy is set to \"Accept\", this is a finding.","fix":"From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch and then select a port group. \n\nSelect Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"Security\" tab.\n\nSet \"Promiscuous Mode\" to \"Reject\".\n\nClick \"OK\".\n \nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nGet-VDSwitch | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false\nGet-VDPortgroup | ?{$_.IsUplink -eq $false} | Get-VDSecurityPolicy | Set-VDSecurityPolicy -AllowPromiscuous $false"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60025r885659_chk","severity":"medium","gid":"V-256350","rid":"SV-256350r885661_rule","stig_id":"VCSA-70-000270","gtitle":"SRG-APP-000516","fix_id":"F-59968r885660_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256351","code":"control 'SV-256351' do\n  title 'The vCenter Server must only send NetFlow traffic to authorized collectors.'\n  desc 'The distributed virtual switch can export NetFlow information about traffic crossing the switch. NetFlow exports are not encrypted and can contain information about the virtual network, making it easier for a man-in-the-middle attack to be executed successfully. If NetFlow export is required, verify that all NetFlow target Internet Protocols (IPs) are correct.'\n  desc 'check', 'If distributed switches are not used, this is not applicable.\n\nTo view NetFlow Collector IPs configured on distributed switches:\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> Configure >> Settings >> NetFlow.\n\nView the NetFlow pane and verify any collector IP addresses are valid and in use for troubleshooting.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDSwitch | select Name,@{N=\"NetFlowCollectorIPs\";E={$_.ExtensionData.config.IpfixConfig.CollectorIpAddress}}\n\nTo view if NetFlow is enabled on any distributed port groups:\n\nFrom the vSphere Client, go to Networking.\n\nSelect a distributed port group >> Manage >> Settings >> Policies.\n\nGo to \"Monitoring\" and view the NetFlow status.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | Select Name,VirtualSwitch,@{N=\"NetFlowEnabled\";E={$_.Extensiondata.Config.defaultPortConfig.ipfixEnabled.Value}}\n\nIf NetFlow is configured and the collector IP is not known and documented, this is a finding.'\n  desc 'fix', 'To remove collector IPs, do the following:\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> Configure >> Settings >> NetFlow.\n\nClick \"Edit\".\n\nRemove any unknown collector IPs.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n$dvs = Get-VDSwitch dvswitch | Get-View\nForEach($vs in $dvs){\n$spec = New-Object VMware.Vim.VMwareDVSConfigSpec\n$spec.configversion = $vs.Config.ConfigVersion\n$spec.IpfixConfig = New-Object VMware.Vim.VMwareIpfixConfig\n$spec.IpfixConfig.CollectorIpAddress = \"\"\n$spec.IpfixConfig.CollectorPort = \"0\"\n$spec.IpfixConfig.ActiveFlowTimeout = \"60\"\n$spec.IpfixConfig.IdleFlowTimeout = \"15\"\n$spec.IpfixConfig.SamplingRate = \"0\"\n$spec.IpfixConfig.InternalFlowsOnly = $False\n$vs.ReconfigureDvs_Task($spec)\n}\n\nNote: This will reset the NetFlow collector configuration back to the defaults.\n\nTo disable NetFlow on a distributed port group, do the following:\n\nFrom the vSphere Client, go to Networking.\n\nSelect a distributed port group >> Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"Monitoring\" tab.\n\nChange \"NetFlow\" to \"Disabled\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n$pgs = Get-VDPortgroup | Get-View\nForEach($pg in $pgs){\n$spec = New-Object VMware.Vim.DVPortgroupConfigSpec\n$spec.configversion = $pg.Config.ConfigVersion\n$spec.defaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting\n$spec.defaultPortConfig.ipfixEnabled = New-Object VMware.Vim.BoolPolicy\n$spec.defaultPortConfig.ipfixEnabled.inherited = $false\n$spec.defaultPortConfig.ipfixEnabled.value = $false\n$pg.ReconfigureDVPortgroup_Task($spec)\n}'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60026r885662_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256351'\n  tag rid: 'SV-256351r885664_rule'\n  tag stig_id: 'VCSA-70-000271'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59969r885663_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256351.rb"},"title":"The vCenter Server must only send NetFlow traffic to authorized collectors.","desc":"The distributed virtual switch can export NetFlow information about traffic crossing the switch. NetFlow exports are not encrypted and can contain information about the virtual network, making it easier for a man-in-the-middle attack to be executed successfully. If NetFlow export is required, verify that all NetFlow target Internet Protocols (IPs) are correct.","descriptions":{"default":"The distributed virtual switch can export NetFlow information about traffic crossing the switch. NetFlow exports are not encrypted and can contain information about the virtual network, making it easier for a man-in-the-middle attack to be executed successfully. If NetFlow export is required, verify that all NetFlow target Internet Protocols (IPs) are correct.","check":"If distributed switches are not used, this is not applicable.\n\nTo view NetFlow Collector IPs configured on distributed switches:\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> Configure >> Settings >> NetFlow.\n\nView the NetFlow pane and verify any collector IP addresses are valid and in use for troubleshooting.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDSwitch | select Name,@{N=\"NetFlowCollectorIPs\";E={$_.ExtensionData.config.IpfixConfig.CollectorIpAddress}}\n\nTo view if NetFlow is enabled on any distributed port groups:\n\nFrom the vSphere Client, go to Networking.\n\nSelect a distributed port group >> Manage >> Settings >> Policies.\n\nGo to \"Monitoring\" and view the NetFlow status.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | Select Name,VirtualSwitch,@{N=\"NetFlowEnabled\";E={$_.Extensiondata.Config.defaultPortConfig.ipfixEnabled.Value}}\n\nIf NetFlow is configured and the collector IP is not known and documented, this is a finding.","fix":"To remove collector IPs, do the following:\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> Configure >> Settings >> NetFlow.\n\nClick \"Edit\".\n\nRemove any unknown collector IPs.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n$dvs = Get-VDSwitch dvswitch | Get-View\nForEach($vs in $dvs){\n$spec = New-Object VMware.Vim.VMwareDVSConfigSpec\n$spec.configversion = $vs.Config.ConfigVersion\n$spec.IpfixConfig = New-Object VMware.Vim.VMwareIpfixConfig\n$spec.IpfixConfig.CollectorIpAddress = \"\"\n$spec.IpfixConfig.CollectorPort = \"0\"\n$spec.IpfixConfig.ActiveFlowTimeout = \"60\"\n$spec.IpfixConfig.IdleFlowTimeout = \"15\"\n$spec.IpfixConfig.SamplingRate = \"0\"\n$spec.IpfixConfig.InternalFlowsOnly = $False\n$vs.ReconfigureDvs_Task($spec)\n}\n\nNote: This will reset the NetFlow collector configuration back to the defaults.\n\nTo disable NetFlow on a distributed port group, do the following:\n\nFrom the vSphere Client, go to Networking.\n\nSelect a distributed port group >> Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"Monitoring\" tab.\n\nChange \"NetFlow\" to \"Disabled\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n$pgs = Get-VDPortgroup | Get-View\nForEach($pg in $pgs){\n$spec = New-Object VMware.Vim.DVPortgroupConfigSpec\n$spec.configversion = $pg.Config.ConfigVersion\n$spec.defaultPortConfig = New-Object VMware.Vim.VMwareDVSPortSetting\n$spec.defaultPortConfig.ipfixEnabled = New-Object VMware.Vim.BoolPolicy\n$spec.defaultPortConfig.ipfixEnabled.inherited = $false\n$spec.defaultPortConfig.ipfixEnabled.value = $false\n$pg.ReconfigureDVPortgroup_Task($spec)\n}"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60026r885662_chk","severity":"medium","gid":"V-256351","rid":"SV-256351r885664_rule","stig_id":"VCSA-70-000271","gtitle":"SRG-APP-000516","fix_id":"F-59969r885663_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256352","code":"control 'SV-256352' do\n  title 'The vCenter Server must configure all port groups to a value other than that of the native virtual local area network (VLAN).'\n  desc 'ESXi does not use the concept of native VLAN. Frames with VLAN specified in the port group will have a tag, but frames with VLAN not specified in the port group are not tagged and therefore will end up belonging to native VLAN of the physical switch.\n\nFor example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a \"1\"; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a \"1\" instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged).\n\nIf the ESXi virtual switch port group uses the native VLAN ID, traffic from those virtual machines will not be visible to the native VLAN on the switch, because the switch is expecting untagged traffic.'\n  desc 'check', %q(If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies. \n\nReview the port group VLAN tags and verify they are not set to the native VLAN ID of the attached physical switch.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | select Name, VlanConfiguration\n\nIf any port group is configured with the native VLAN of the ESXi host's attached physical switch, this is a finding.)\n  desc 'fix', 'From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"VLAN\" tab.\n\nChange the VLAN ID to a non-native VLAN.\n\nClick \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup \"portgroup name\" | Set-VDVlanConfiguration -VlanId \"New VLAN#\"'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60027r885665_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256352'\n  tag rid: 'SV-256352r885667_rule'\n  tag stig_id: 'VCSA-70-000272'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59970r885666_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256352.rb"},"title":"The vCenter Server must configure all port groups to a value other than that of the native virtual local area network (VLAN).","desc":"ESXi does not use the concept of native VLAN. Frames with VLAN specified in the port group will have a tag, but frames with VLAN not specified in the port group are not tagged and therefore will end up belonging to native VLAN of the physical switch.\n\nFor example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a \"1\"; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a \"1\" instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged).\n\nIf the ESXi virtual switch port group uses the native VLAN ID, traffic from those virtual machines will not be visible to the native VLAN on the switch, because the switch is expecting untagged traffic.","descriptions":{"default":"ESXi does not use the concept of native VLAN. Frames with VLAN specified in the port group will have a tag, but frames with VLAN not specified in the port group are not tagged and therefore will end up belonging to native VLAN of the physical switch.\n\nFor example, frames on VLAN 1 from a Cisco physical switch will be untagged, because this is considered as the native VLAN. However, frames from ESXi specified as VLAN 1 will be tagged with a \"1\"; therefore, traffic from ESXi that is destined for the native VLAN will not be correctly routed (because it is tagged with a \"1\" instead of being untagged), and traffic from the physical switch coming from the native VLAN will not be visible (because it is not tagged).\n\nIf the ESXi virtual switch port group uses the native VLAN ID, traffic from those virtual machines will not be visible to the native VLAN on the switch, because the switch is expecting untagged traffic.","check":"If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies. \n\nReview the port group VLAN tags and verify they are not set to the native VLAN ID of the attached physical switch.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | select Name, VlanConfiguration\n\nIf any port group is configured with the native VLAN of the ESXi host's attached physical switch, this is a finding.","fix":"From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"VLAN\" tab.\n\nChange the VLAN ID to a non-native VLAN.\n\nClick \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup \"portgroup name\" | Set-VDVlanConfiguration -VlanId \"New VLAN#\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60027r885665_chk","severity":"medium","gid":"V-256352","rid":"SV-256352r885667_rule","stig_id":"VCSA-70-000272","gtitle":"SRG-APP-000516","fix_id":"F-59970r885666_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256353","code":"control 'SV-256353' do\n  title 'The vCenter Server must not configure VLAN Trunking unless Virtual Guest Tagging (VGT) is required and authorized.'\n  desc 'When a port group is set to VLAN Trunking, the vSwitch passes all network frames in the specified range to the attached virtual machines without modifying the virtual local area network (VLAN) tags. In vSphere, this is referred to as VGT.\n\nThe virtual machine must process the VLAN information itself via an 802.1Q driver in the operating system. VLAN Trunking must only be implemented if the attached virtual machines have been specifically authorized and are capable of managing VLAN tags themselves.\n\nIf VLAN Trunking is enabled inappropriately, it may cause a denial of service or allow a virtual machine to interact with traffic on an unauthorized VLAN.'\n  desc 'check', 'If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies. \n\nReview the port group \"VLAN Type\" and \"VLAN trunk range\", if present.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | Where {$_.ExtensionData.Config.Uplink -ne \"True\"} | Select Name,VlanConfiguration\n\nIf any port group is configured with \"VLAN trunking\" and is not documented as a needed exception (such as NSX appliances), this is a finding.\n\nIf any port group is authorized to be configured with \"VLAN trunking\" but is not configured with the most limited range necessary, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"VLAN\" tab.\n\nIf \"VLAN trunking\" is not authorized, remove it by setting \"VLAN type\" to \"VLAN\" and configure an appropriate VLAN ID. Click \"OK\".\n\nIf \"VLAN trunking\" is authorized but the range is too broad, modify the range in the \"VLAN trunk range\" field to the minimum necessary and authorized range. An example range would be \"1,3-5,8\". Click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command to configure trunking:\n\nGet-VDPortgroup \"Portgroup Name\" | Set-VDVlanConfiguration -VlanTrunkRange \"<VLAN Range(s) comma separated>\"\n\nor\n\nRun this command to configure a single VLAN ID:\n\nGet-VDPortgroup \"Portgroup Name\" | Set-VDVlanConfiguration -VlanId \"<New VLAN#>\"'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60028r885668_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256353'\n  tag rid: 'SV-256353r885670_rule'\n  tag stig_id: 'VCSA-70-000273'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59971r885669_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256353.rb"},"title":"The vCenter Server must not configure VLAN Trunking unless Virtual Guest Tagging (VGT) is required and authorized.","desc":"When a port group is set to VLAN Trunking, the vSwitch passes all network frames in the specified range to the attached virtual machines without modifying the virtual local area network (VLAN) tags. In vSphere, this is referred to as VGT.\n\nThe virtual machine must process the VLAN information itself via an 802.1Q driver in the operating system. VLAN Trunking must only be implemented if the attached virtual machines have been specifically authorized and are capable of managing VLAN tags themselves.\n\nIf VLAN Trunking is enabled inappropriately, it may cause a denial of service or allow a virtual machine to interact with traffic on an unauthorized VLAN.","descriptions":{"default":"When a port group is set to VLAN Trunking, the vSwitch passes all network frames in the specified range to the attached virtual machines without modifying the virtual local area network (VLAN) tags. In vSphere, this is referred to as VGT.\n\nThe virtual machine must process the VLAN information itself via an 802.1Q driver in the operating system. VLAN Trunking must only be implemented if the attached virtual machines have been specifically authorized and are capable of managing VLAN tags themselves.\n\nIf VLAN Trunking is enabled inappropriately, it may cause a denial of service or allow a virtual machine to interact with traffic on an unauthorized VLAN.","check":"If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies. \n\nReview the port group \"VLAN Type\" and \"VLAN trunk range\", if present.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | Where {$_.ExtensionData.Config.Uplink -ne \"True\"} | Select Name,VlanConfiguration\n\nIf any port group is configured with \"VLAN trunking\" and is not documented as a needed exception (such as NSX appliances), this is a finding.\n\nIf any port group is authorized to be configured with \"VLAN trunking\" but is not configured with the most limited range necessary, this is a finding.","fix":"From the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"VLAN\" tab.\n\nIf \"VLAN trunking\" is not authorized, remove it by setting \"VLAN type\" to \"VLAN\" and configure an appropriate VLAN ID. Click \"OK\".\n\nIf \"VLAN trunking\" is authorized but the range is too broad, modify the range in the \"VLAN trunk range\" field to the minimum necessary and authorized range. An example range would be \"1,3-5,8\". Click \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command to configure trunking:\n\nGet-VDPortgroup \"Portgroup Name\" | Set-VDVlanConfiguration -VlanTrunkRange \"<VLAN Range(s) comma separated>\"\n\nor\n\nRun this command to configure a single VLAN ID:\n\nGet-VDPortgroup \"Portgroup Name\" | Set-VDVlanConfiguration -VlanId \"<New VLAN#>\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60028r885668_chk","severity":"medium","gid":"V-256353","rid":"SV-256353r885670_rule","stig_id":"VCSA-70-000273","gtitle":"SRG-APP-000516","fix_id":"F-59971r885669_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256354","code":"control 'SV-256354' do\n  title 'The vCenter Server must not configure all port groups to virtual local area network (VLAN) values reserved by upstream physical switches.'\n  desc \"Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001 to 1024 and 4094, while Nexus switches typically reserve 3968 to 4094.\n\nCheck with the documentation for the organization's specific switch. Using a reserved VLAN might result in a denial of service on the network.\"\n  desc 'check', 'If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking.\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies. \n\nReview the port group VLAN tags and verify they are not set to a reserved VLAN ID.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | select Name, VlanConfiguration\n\nIf any port group is configured with a reserved VLAN ID, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Networking.\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"VLAN\" tab. Change the VLAN ID to an unreserved VLAN ID.\n\nClick \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup \"portgroup name\" | Set-VDVlanConfiguration -VlanId \"New VLAN#\"'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60029r885671_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256354'\n  tag rid: 'SV-256354r885673_rule'\n  tag stig_id: 'VCSA-70-000274'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59972r885672_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256354.rb"},"title":"The vCenter Server must not configure all port groups to virtual local area network (VLAN) values reserved by upstream physical switches.","desc":"Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001 to 1024 and 4094, while Nexus switches typically reserve 3968 to 4094.\n\nCheck with the documentation for the organization's specific switch. Using a reserved VLAN might result in a denial of service on the network.","descriptions":{"default":"Certain physical switches reserve certain VLAN IDs for internal purposes and often disallow traffic configured to these values. For example, Cisco Catalyst switches typically reserve VLANs 1001 to 1024 and 4094, while Nexus switches typically reserve 3968 to 4094.\n\nCheck with the documentation for the organization's specific switch. Using a reserved VLAN might result in a denial of service on the network.","check":"If distributed switches are not used, this is not applicable.\n\nFrom the vSphere Client, go to Networking.\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies. \n\nReview the port group VLAN tags and verify they are not set to a reserved VLAN ID.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup | select Name, VlanConfiguration\n\nIf any port group is configured with a reserved VLAN ID, this is a finding.","fix":"From the vSphere Client, go to Networking.\n\nSelect a distributed switch >> distributed port group >> Configure >> Settings >> Policies.\n\nClick \"Edit\".\n\nClick the \"VLAN\" tab. Change the VLAN ID to an unreserved VLAN ID.\n\nClick \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VDPortgroup \"portgroup name\" | Set-VDVlanConfiguration -VlanId \"New VLAN#\""},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60029r885671_chk","severity":"medium","gid":"V-256354","rid":"SV-256354r885673_rule","stig_id":"VCSA-70-000274","gtitle":"SRG-APP-000516","fix_id":"F-59972r885672_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256355","code":"control 'SV-256355' do\n  title 'The vCenter Server must configure the \"vpxuser\" auto-password to be changed every 30 days.'\n  desc 'By default, vCenter will change the \"vpxuser\" password automatically every 30 days. Ensure this setting meets site policies. If it does not, configure it to meet password aging policies. \n\nNote: It is very important the password aging policy is not shorter than the default interval that is set to automatically change the \"vpxuser\" password to preclude the possibility that vCenter might be locked out of an ESXi host.'\n  desc 'check', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings. \n\nVerify \"VirtualCenter.VimPasswordExpirationInDays\" is set to \"30\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name VirtualCenter.VimPasswordExpirationInDays\n\nIf the \"VirtualCenter.VimPasswordExpirationInDays\" is set to a value other than \"30\" or does not exist, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nClick \"Edit Settings\" and configure the \"VirtualCenter.VimPasswordExpirationInDays\" value to \"30\", or if the value does not exist, create it by entering the values in the \"Key\" and \"Value\" fields and clicking \"Add\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nIf the setting already exists:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name VirtualCenter.VimPasswordExpirationInDays | Set-AdvancedSetting -Value 30\n\nIf the setting does not exist:\n\nNew-AdvancedSetting -Entity <vcenter server name> -Name VirtualCenter.VimPasswordExpirationInDays -Value 30'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60030r885674_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256355'\n  tag rid: 'SV-256355r885676_rule'\n  tag stig_id: 'VCSA-70-000275'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59973r885675_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256355.rb"},"title":"The vCenter Server must configure the \"vpxuser\" auto-password to be changed every 30 days.","desc":"By default, vCenter will change the \"vpxuser\" password automatically every 30 days. Ensure this setting meets site policies. If it does not, configure it to meet password aging policies. \n\nNote: It is very important the password aging policy is not shorter than the default interval that is set to automatically change the \"vpxuser\" password to preclude the possibility that vCenter might be locked out of an ESXi host.","descriptions":{"default":"By default, vCenter will change the \"vpxuser\" password automatically every 30 days. Ensure this setting meets site policies. If it does not, configure it to meet password aging policies. \n\nNote: It is very important the password aging policy is not shorter than the default interval that is set to automatically change the \"vpxuser\" password to preclude the possibility that vCenter might be locked out of an ESXi host.","check":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings. \n\nVerify \"VirtualCenter.VimPasswordExpirationInDays\" is set to \"30\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name VirtualCenter.VimPasswordExpirationInDays\n\nIf the \"VirtualCenter.VimPasswordExpirationInDays\" is set to a value other than \"30\" or does not exist, this is a finding.","fix":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nClick \"Edit Settings\" and configure the \"VirtualCenter.VimPasswordExpirationInDays\" value to \"30\", or if the value does not exist, create it by entering the values in the \"Key\" and \"Value\" fields and clicking \"Add\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nIf the setting already exists:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name VirtualCenter.VimPasswordExpirationInDays | Set-AdvancedSetting -Value 30\n\nIf the setting does not exist:\n\nNew-AdvancedSetting -Entity <vcenter server name> -Name VirtualCenter.VimPasswordExpirationInDays -Value 30"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60030r885674_chk","severity":"medium","gid":"V-256355","rid":"SV-256355r885676_rule","stig_id":"VCSA-70-000275","gtitle":"SRG-APP-000516","fix_id":"F-59973r885675_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256356","code":"control 'SV-256356' do\n  title 'The vCenter Server must configure the \"vpxuser\" password to meet length policy.'\n  desc 'The \"vpxuser\" password default length is 32 characters. Ensure this setting meets site policies; if not, configure to meet password length policies.\n\nLonger passwords make brute-force password attacks more difficult. The \"vpxuser\" password is added by vCenter, meaning no manual intervention is normally required. The \"vpxuser\" password length must never be modified to less than the default length of 32 characters.'\n  desc 'check', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings. \n\nVerify \"config.vpxd.hostPasswordLength\" is set to \"32\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.vpxd.hostPasswordLength and verify it is set to 32.\n\nIf the \"config.vpxd.hostPasswordLength\" is set to a value other than \"32\", this is a finding.\n\nIf the setting does not exist, this is not a finding.'\n  desc 'fix', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nClick \"Edit Settings\" and configure the \"config.vpxd.hostPasswordLength\" value to \"32\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.vpxd.hostPasswordLength | Set-AdvancedSetting -Value 32'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60031r885677_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256356'\n  tag rid: 'SV-256356r885679_rule'\n  tag stig_id: 'VCSA-70-000276'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59974r885678_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256356.rb"},"title":"The vCenter Server must configure the \"vpxuser\" password to meet length policy.","desc":"The \"vpxuser\" password default length is 32 characters. Ensure this setting meets site policies; if not, configure to meet password length policies.\n\nLonger passwords make brute-force password attacks more difficult. The \"vpxuser\" password is added by vCenter, meaning no manual intervention is normally required. The \"vpxuser\" password length must never be modified to less than the default length of 32 characters.","descriptions":{"default":"The \"vpxuser\" password default length is 32 characters. Ensure this setting meets site policies; if not, configure to meet password length policies.\n\nLonger passwords make brute-force password attacks more difficult. The \"vpxuser\" password is added by vCenter, meaning no manual intervention is normally required. The \"vpxuser\" password length must never be modified to less than the default length of 32 characters.","check":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings. \n\nVerify \"config.vpxd.hostPasswordLength\" is set to \"32\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.vpxd.hostPasswordLength and verify it is set to 32.\n\nIf the \"config.vpxd.hostPasswordLength\" is set to a value other than \"32\", this is a finding.\n\nIf the setting does not exist, this is not a finding.","fix":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nClick \"Edit Settings\" and configure the \"config.vpxd.hostPasswordLength\" value to \"32\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name config.vpxd.hostPasswordLength | Set-AdvancedSetting -Value 32"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60031r885677_chk","severity":"medium","gid":"V-256356","rid":"SV-256356r885679_rule","stig_id":"VCSA-70-000276","gtitle":"SRG-APP-000516","fix_id":"F-59974r885678_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256357","code":"control 'SV-256357' do\n  title 'The vCenter Server must be isolated from the public internet but must still allow for patch notification and delivery.'\n  desc 'vCenter and the embedded Lifecycle Manager system must never have a direct route to the internet. Despite this, updates and patches sourced from VMware on the internet must be delivered in a timely manner.\n\nThere are two methods to accomplish this: a proxy server and the Update Manager Download Service (UMDS). UMDS is an optional module for Lifecycle Manager that fetches upgrades for virtual appliances, patch metadata, patch binaries, and notifications that would not otherwise be available to an isolated Lifecycle Manager directly.\n\nAlternatively, a proxy for Lifecycle Manager can be configured to allow controlled, limited access to the public internet for the sole purpose of patch gathering. Either solution mitigates the risk of internet connectivity by limiting its scope and use.'\n  desc 'check', 'Check the following conditions:\n\n1. Lifecycle Manager must be configured to use the UMDS.\n\nOR\n\n2. Lifecycle Manager must be configured to use a proxy server for access to VMware patch repositories.\n\nOR\n\n3. Lifecycle Manager must disable internet patch repositories and any patches must be manually validated and imported as needed.\n\nOption 1:\n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Setup.\n\nClick the \"Change Download Source\" button.\n\nVerify the \"Download patches from a UMDS shared repository\" radio button is selected and a valid UMDS repository is supplied.\n\nClick \"Cancel\".\n\nIf this is not set, this is a finding.\n\nOption 2: \n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Setup.\n\nClick the \"Change Download Source\" button.\n\nVerify the \"Download patches directly from the internet\" radio button is selected.\n\nClick \"Cancel\".\n\nNavigate to the vCenter Server Management interface at https://<vcenter dns>:5480 >> Networking >> Proxy Settings.\n\nVerify \"HTTPS\" is \"Enabled\".\n\nClick the \"HTTPS\" row.\n\nVerify the proxy server configuration is accurate.\n\nIf this is not set, this is a finding.\n\nOption 3: \n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Downloads.\n\nVerify the \"Automatic downloads\" option is disabled.\n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Setup.\n\nVerify any download sources are disabled.\n\nIf this is not set, this is a finding.'\n  desc 'fix', 'Option 1:\n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Setup.\n\nClick the \"Change Download Source\" button.\n\nSelect the \"Download patches from a UMDS shared repository\" radio button and supply a valid UMDS repository.\n\nClick \"Save\".\n\nOption 2:\n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Setup.\n\nClick the \"Change Download Source\" button.\n\nSelect the \"Download patches directly from the internet\" radio button.\n\nClick \"Save\".\n\nNavigate to the vCenter Server Management interface at https://<vcenter dns>:5480 >> Networking >> Proxy Settings.\n\nClick \"Edit\".\n\nSlide \"HTTPS\" to \"Enabled\".\n\nSupply the appropriate proxy server configuration.\n\nClick \"Save\".\n\nOption 3:\n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Downloads.\n\nClick \"Edit\" and uncheck \"Download patches\". \n\nUnder \"Patch Setup\", select each download source and click \"Disable\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60032r885680_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256357'\n  tag rid: 'SV-256357r885682_rule'\n  tag stig_id: 'VCSA-70-000277'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59975r885681_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256357.rb"},"title":"The vCenter Server must be isolated from the public internet but must still allow for patch notification and delivery.","desc":"vCenter and the embedded Lifecycle Manager system must never have a direct route to the internet. Despite this, updates and patches sourced from VMware on the internet must be delivered in a timely manner.\n\nThere are two methods to accomplish this: a proxy server and the Update Manager Download Service (UMDS). UMDS is an optional module for Lifecycle Manager that fetches upgrades for virtual appliances, patch metadata, patch binaries, and notifications that would not otherwise be available to an isolated Lifecycle Manager directly.\n\nAlternatively, a proxy for Lifecycle Manager can be configured to allow controlled, limited access to the public internet for the sole purpose of patch gathering. Either solution mitigates the risk of internet connectivity by limiting its scope and use.","descriptions":{"default":"vCenter and the embedded Lifecycle Manager system must never have a direct route to the internet. Despite this, updates and patches sourced from VMware on the internet must be delivered in a timely manner.\n\nThere are two methods to accomplish this: a proxy server and the Update Manager Download Service (UMDS). UMDS is an optional module for Lifecycle Manager that fetches upgrades for virtual appliances, patch metadata, patch binaries, and notifications that would not otherwise be available to an isolated Lifecycle Manager directly.\n\nAlternatively, a proxy for Lifecycle Manager can be configured to allow controlled, limited access to the public internet for the sole purpose of patch gathering. Either solution mitigates the risk of internet connectivity by limiting its scope and use.","check":"Check the following conditions:\n\n1. Lifecycle Manager must be configured to use the UMDS.\n\nOR\n\n2. Lifecycle Manager must be configured to use a proxy server for access to VMware patch repositories.\n\nOR\n\n3. Lifecycle Manager must disable internet patch repositories and any patches must be manually validated and imported as needed.\n\nOption 1:\n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Setup.\n\nClick the \"Change Download Source\" button.\n\nVerify the \"Download patches from a UMDS shared repository\" radio button is selected and a valid UMDS repository is supplied.\n\nClick \"Cancel\".\n\nIf this is not set, this is a finding.\n\nOption 2: \n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Setup.\n\nClick the \"Change Download Source\" button.\n\nVerify the \"Download patches directly from the internet\" radio button is selected.\n\nClick \"Cancel\".\n\nNavigate to the vCenter Server Management interface at https://<vcenter dns>:5480 >> Networking >> Proxy Settings.\n\nVerify \"HTTPS\" is \"Enabled\".\n\nClick the \"HTTPS\" row.\n\nVerify the proxy server configuration is accurate.\n\nIf this is not set, this is a finding.\n\nOption 3: \n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Downloads.\n\nVerify the \"Automatic downloads\" option is disabled.\n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Setup.\n\nVerify any download sources are disabled.\n\nIf this is not set, this is a finding.","fix":"Option 1:\n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Setup.\n\nClick the \"Change Download Source\" button.\n\nSelect the \"Download patches from a UMDS shared repository\" radio button and supply a valid UMDS repository.\n\nClick \"Save\".\n\nOption 2:\n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Setup.\n\nClick the \"Change Download Source\" button.\n\nSelect the \"Download patches directly from the internet\" radio button.\n\nClick \"Save\".\n\nNavigate to the vCenter Server Management interface at https://<vcenter dns>:5480 >> Networking >> Proxy Settings.\n\nClick \"Edit\".\n\nSlide \"HTTPS\" to \"Enabled\".\n\nSupply the appropriate proxy server configuration.\n\nClick \"Save\".\n\nOption 3:\n\nFrom the vSphere Client, go to Lifecycle Manager >> Settings >> Patch Downloads.\n\nClick \"Edit\" and uncheck \"Download patches\". \n\nUnder \"Patch Setup\", select each download source and click \"Disable\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60032r885680_chk","severity":"medium","gid":"V-256357","rid":"SV-256357r885682_rule","stig_id":"VCSA-70-000277","gtitle":"SRG-APP-000516","fix_id":"F-59975r885681_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256358","code":"control 'SV-256358' do\n  title 'The vCenter Server must use unique service accounts when applications connect to vCenter.'\n  desc 'To not violate nonrepudiation (i.e., deny the authenticity of who is connecting to vCenter), when applications need to connect to vCenter they must use unique service accounts.'\n  desc 'check', 'Verify each external application that connects to vCenter has a unique service account dedicated to that application.\n\nFor example, there should be separate accounts for Log Insight, Operations Manager, or anything else that requires an account to access vCenter.\n\nIf any application shares a service account that is used to connect to vCenter, this is a finding.'\n  desc 'fix', 'For applications sharing service accounts, create a new service account to assign to the application so that no application shares a service account with another.\n\nWhen standing up a new application that requires access to vCenter, always create a new service account prior to installation and grant only the permissions needed for that application.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60033r885683_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256358'\n  tag rid: 'SV-256358r885685_rule'\n  tag stig_id: 'VCSA-70-000278'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59976r885684_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256358.rb"},"title":"The vCenter Server must use unique service accounts when applications connect to vCenter.","desc":"To not violate nonrepudiation (i.e., deny the authenticity of who is connecting to vCenter), when applications need to connect to vCenter they must use unique service accounts.","descriptions":{"default":"To not violate nonrepudiation (i.e., deny the authenticity of who is connecting to vCenter), when applications need to connect to vCenter they must use unique service accounts.","check":"Verify each external application that connects to vCenter has a unique service account dedicated to that application.\n\nFor example, there should be separate accounts for Log Insight, Operations Manager, or anything else that requires an account to access vCenter.\n\nIf any application shares a service account that is used to connect to vCenter, this is a finding.","fix":"For applications sharing service accounts, create a new service account to assign to the application so that no application shares a service account with another.\n\nWhen standing up a new application that requires access to vCenter, always create a new service account prior to installation and grant only the permissions needed for that application."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60033r885683_chk","severity":"medium","gid":"V-256358","rid":"SV-256358r885685_rule","stig_id":"VCSA-70-000278","gtitle":"SRG-APP-000516","fix_id":"F-59976r885684_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256359","code":"control 'SV-256359' do\n  title 'The vCenter Server must protect the confidentiality and integrity of transmitted information by isolating Internet Protocol (IP)-based storage traffic.'\n  desc 'Virtual machines might share virtual switches and virtual local area networks (VLAN) with the IP-based storage configurations. \n\nIP-based storage includes vSAN, Internet Small Computer System Interface (iSCSI), and Network File System (NFS). This configuration might expose IP-based storage traffic to unauthorized virtual machine users. IP-based storage frequently is not encrypted. It can be viewed by anyone with access to this network.\n\nTo restrict unauthorized users from viewing the IP-based storage traffic, the IP-based storage network must be logically separated from the production traffic. Configuring the IP-based storage adaptors on separate VLANs or network segments from other VMkernels and virtual machines will limit unauthorized users from viewing the traffic.'\n  desc 'check', 'If IP-based storage is not used, this is not applicable.\n\nIP-based storage (iSCSI, NFS, vSAN) VMkernel port groups must be in a dedicated VLAN that can be on a standard or distributed virtual switch that is logically separated from other traffic types.\n\nThe check for this will be unique per environment.\n\nTo check a standard switch, from the vSphere Client, select the ESXi host and go to Configure >> Networking >> Virtual switches. Select a standard switch.\n\nFor each storage port group (iSCSI, NFS, vSAN), select the port group and note the VLAN ID associated with each port group.\n\nVerify it is dedicated to that purpose and is logically separated from other traffic types.\n\nTo check a distributed switch, from the vSphere Client, go to \"Networking\" and select and expand a distributed switch.\n\nFor each storage port group (iSCSI, NFS, vSAN), select the port group and navigate to the \"Summary\" tab.\n\nNote the VLAN ID associated with each port group and verify it is dedicated to that purpose and is logically separated from other traffic types.\n\nIf any IP-based storage networks are not isolated from other traffic types, this is a finding.'\n  desc 'fix', 'Configuration of an IP-based VMkernel will be unique to each environment.\n\nTo configure VLANs and traffic types, do the following:\n\nStandard switch:\n\nFrom the vSphere Client, select the ESXi host and go to Configure >> Networking >> VMkernel adapters.\n\nSelect the Storage VMkernel (for any IP-based storage). Click \"Edit...\" and click the \"Port properties\" tab.\n\nUncheck everything (unless vSAN).\n\nClick the \"IPv4\" settings or \"IPv6\" settings tab.\n\nEnter the appropriate IP address and subnet information.\n\nClick \"OK\". \n\nFrom the vSphere Client, select the ESXi host and go to Configure >> Networking >> Virtual switches. Select a standard switch.\n\nFor each storage port group (iSCSI, NFS, vSAN), select the port group and click \"...\". Click \"Edit Settings\". On the \"Properties\" tab, enter the appropriate VLAN ID and click \"OK\".\n\nDistributed switch:\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> Configure >> Settings >> Topology.\n\nSelect the Storage VMkernel (for any IP-based storage). Click \"...\" and click \"Edit Settings\".\n\nOn the \"Port properties\" tab, uncheck everything (unless vSAN).\n\nClick the \"IPv4\" settings or \"IPv6\" settings tab.\n\nEnter the appropriate IP address and subnet information.\n\nClick \"OK\". \n\nFrom the vSphere Client, go to Networking >> Select and expand a distributed switch.\n\nFor each storage port group (iSCSI, NFS, vSAN), select the port group and navigate to Configure >> Settings >> Properties.\n\nClick \"Edit\".\n\nClick the \"VLAN\" tab.\n\nEnter the appropriate VLAN type and ID and click \"OK\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60034r885686_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256359'\n  tag rid: 'SV-256359r885688_rule'\n  tag stig_id: 'VCSA-70-000279'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59977r885687_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256359.rb"},"title":"The vCenter Server must protect the confidentiality and integrity of transmitted information by isolating Internet Protocol (IP)-based storage traffic.","desc":"Virtual machines might share virtual switches and virtual local area networks (VLAN) with the IP-based storage configurations. \n\nIP-based storage includes vSAN, Internet Small Computer System Interface (iSCSI), and Network File System (NFS). This configuration might expose IP-based storage traffic to unauthorized virtual machine users. IP-based storage frequently is not encrypted. It can be viewed by anyone with access to this network.\n\nTo restrict unauthorized users from viewing the IP-based storage traffic, the IP-based storage network must be logically separated from the production traffic. Configuring the IP-based storage adaptors on separate VLANs or network segments from other VMkernels and virtual machines will limit unauthorized users from viewing the traffic.","descriptions":{"default":"Virtual machines might share virtual switches and virtual local area networks (VLAN) with the IP-based storage configurations. \n\nIP-based storage includes vSAN, Internet Small Computer System Interface (iSCSI), and Network File System (NFS). This configuration might expose IP-based storage traffic to unauthorized virtual machine users. IP-based storage frequently is not encrypted. It can be viewed by anyone with access to this network.\n\nTo restrict unauthorized users from viewing the IP-based storage traffic, the IP-based storage network must be logically separated from the production traffic. Configuring the IP-based storage adaptors on separate VLANs or network segments from other VMkernels and virtual machines will limit unauthorized users from viewing the traffic.","check":"If IP-based storage is not used, this is not applicable.\n\nIP-based storage (iSCSI, NFS, vSAN) VMkernel port groups must be in a dedicated VLAN that can be on a standard or distributed virtual switch that is logically separated from other traffic types.\n\nThe check for this will be unique per environment.\n\nTo check a standard switch, from the vSphere Client, select the ESXi host and go to Configure >> Networking >> Virtual switches. Select a standard switch.\n\nFor each storage port group (iSCSI, NFS, vSAN), select the port group and note the VLAN ID associated with each port group.\n\nVerify it is dedicated to that purpose and is logically separated from other traffic types.\n\nTo check a distributed switch, from the vSphere Client, go to \"Networking\" and select and expand a distributed switch.\n\nFor each storage port group (iSCSI, NFS, vSAN), select the port group and navigate to the \"Summary\" tab.\n\nNote the VLAN ID associated with each port group and verify it is dedicated to that purpose and is logically separated from other traffic types.\n\nIf any IP-based storage networks are not isolated from other traffic types, this is a finding.","fix":"Configuration of an IP-based VMkernel will be unique to each environment.\n\nTo configure VLANs and traffic types, do the following:\n\nStandard switch:\n\nFrom the vSphere Client, select the ESXi host and go to Configure >> Networking >> VMkernel adapters.\n\nSelect the Storage VMkernel (for any IP-based storage). Click \"Edit...\" and click the \"Port properties\" tab.\n\nUncheck everything (unless vSAN).\n\nClick the \"IPv4\" settings or \"IPv6\" settings tab.\n\nEnter the appropriate IP address and subnet information.\n\nClick \"OK\". \n\nFrom the vSphere Client, select the ESXi host and go to Configure >> Networking >> Virtual switches. Select a standard switch.\n\nFor each storage port group (iSCSI, NFS, vSAN), select the port group and click \"...\". Click \"Edit Settings\". On the \"Properties\" tab, enter the appropriate VLAN ID and click \"OK\".\n\nDistributed switch:\n\nFrom the vSphere Client, go to \"Networking\".\n\nSelect a distributed switch >> Configure >> Settings >> Topology.\n\nSelect the Storage VMkernel (for any IP-based storage). Click \"...\" and click \"Edit Settings\".\n\nOn the \"Port properties\" tab, uncheck everything (unless vSAN).\n\nClick the \"IPv4\" settings or \"IPv6\" settings tab.\n\nEnter the appropriate IP address and subnet information.\n\nClick \"OK\". \n\nFrom the vSphere Client, go to Networking >> Select and expand a distributed switch.\n\nFor each storage port group (iSCSI, NFS, vSAN), select the port group and navigate to Configure >> Settings >> Properties.\n\nClick \"Edit\".\n\nClick the \"VLAN\" tab.\n\nEnter the appropriate VLAN type and ID and click \"OK\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60034r885686_chk","severity":"medium","gid":"V-256359","rid":"SV-256359r885688_rule","stig_id":"VCSA-70-000279","gtitle":"SRG-APP-000516","fix_id":"F-59977r885687_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256360","code":"control 'SV-256360' do\n  title 'The vCenter server must be configured to send events to a central log server.'\n  desc 'vCenter server generates volumes of security-relevant application-level events. Examples include logins, system reconfigurations, system degradation warnings, and more. To ensure these events are available for forensic analysis and correlation, they must be sent to the syslog and forwarded on to the configured Security Information and Event Management (SIEM) system and/or central log server.\n\nThe vCenter server sends events to syslog by default, but this configuration must be verified and maintained.'\n  desc 'check', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nVerify the \"vpxd.event.syslog.enabled\" value is set to \"true\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name vpxd.event.syslog.enabled\n\nIf the \"vpxd.event.syslog.enabled\" value is not set to \"true\", this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nClick \"Edit Settings\" and configure the \"vpxd.event.syslog.enabled\" setting to \"true\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name vpxd.event.syslog.enabled | Set-AdvancedSetting -Value true'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60035r885689_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256360'\n  tag rid: 'SV-256360r885691_rule'\n  tag stig_id: 'VCSA-70-000280'\n  tag gtitle: 'SRG-APP-000358'\n  tag fix_id: 'F-59978r885690_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256360.rb"},"title":"The vCenter server must be configured to send events to a central log server.","desc":"vCenter server generates volumes of security-relevant application-level events. Examples include logins, system reconfigurations, system degradation warnings, and more. To ensure these events are available for forensic analysis and correlation, they must be sent to the syslog and forwarded on to the configured Security Information and Event Management (SIEM) system and/or central log server.\n\nThe vCenter server sends events to syslog by default, but this configuration must be verified and maintained.","descriptions":{"default":"vCenter server generates volumes of security-relevant application-level events. Examples include logins, system reconfigurations, system degradation warnings, and more. To ensure these events are available for forensic analysis and correlation, they must be sent to the syslog and forwarded on to the configured Security Information and Event Management (SIEM) system and/or central log server.\n\nThe vCenter server sends events to syslog by default, but this configuration must be verified and maintained.","check":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nVerify the \"vpxd.event.syslog.enabled\" value is set to \"true\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name vpxd.event.syslog.enabled\n\nIf the \"vpxd.event.syslog.enabled\" value is not set to \"true\", this is a finding.","fix":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> Advanced Settings.\n\nClick \"Edit Settings\" and configure the \"vpxd.event.syslog.enabled\" setting to \"true\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-AdvancedSetting -Entity <vcenter server name> -Name vpxd.event.syslog.enabled | Set-AdvancedSetting -Value true"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60035r885689_chk","severity":"medium","gid":"V-256360","rid":"SV-256360r885691_rule","stig_id":"VCSA-70-000280","gtitle":"SRG-APP-000358","fix_id":"F-59978r885690_fix","documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}},{"id":"SV-256361","code":"control 'SV-256361' do\n  title 'The vCenter Server must disable or restrict the connectivity between vSAN Health Check and public Hardware Compatibility List (HCL) by use of an external proxy server.'\n  desc 'The vSAN Health Check is able to download the HCL from VMware to check compliance against the underlying vSAN Cluster hosts. To ensure the vCenter server is not directly downloading content from the internet, this functionality must be disabled. If this feature is necessary, an external proxy server must be configured.'\n  desc 'check', 'If no clusters are enabled for vSAN, this is not applicable.\n\nFrom the vSphere Client, go to Host and Clusters.\n\nSelect the vCenter Server >> Configure >> vSAN >> Internet Connectivity.\n\nIf the HCL internet download is not required, verify \"Status\" is \"Disabled\". \n\nIf the \"Status\" is \"Enabled\", this is a finding.\n\nIf the HCL internet download is required, verify \"Status\" is \"Enabled\" and a proxy host is configured. \n\nIf \"Status\" is \"Enabled\" and a proxy is not configured, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Host and Clusters.\n\nSelect the vCenter Server >> Configure >> vSAN >> Internet Connectivity.\n\nClick \"Edit\".\n\nIf the HCL internet download is not required, ensure \"Status\" is \"Disabled\".\n\nIf the HCL internet download is required, ensure \"Status\" is \"Enabled\" and a proxy host is appropriately configured.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60036r885692_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256361'\n  tag rid: 'SV-256361r885694_rule'\n  tag stig_id: 'VCSA-70-000281'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59979r885693_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256361.rb"},"title":"The vCenter Server must disable or restrict the connectivity between vSAN Health Check and public Hardware Compatibility List (HCL) by use of an external proxy server.","desc":"The vSAN Health Check is able to download the HCL from VMware to check compliance against the underlying vSAN Cluster hosts. To ensure the vCenter server is not directly downloading content from the internet, this functionality must be disabled. If this feature is necessary, an external proxy server must be configured.","descriptions":{"default":"The vSAN Health Check is able to download the HCL from VMware to check compliance against the underlying vSAN Cluster hosts. To ensure the vCenter server is not directly downloading content from the internet, this functionality must be disabled. If this feature is necessary, an external proxy server must be configured.","check":"If no clusters are enabled for vSAN, this is not applicable.\n\nFrom the vSphere Client, go to Host and Clusters.\n\nSelect the vCenter Server >> Configure >> vSAN >> Internet Connectivity.\n\nIf the HCL internet download is not required, verify \"Status\" is \"Disabled\". \n\nIf the \"Status\" is \"Enabled\", this is a finding.\n\nIf the HCL internet download is required, verify \"Status\" is \"Enabled\" and a proxy host is configured. \n\nIf \"Status\" is \"Enabled\" and a proxy is not configured, this is a finding.","fix":"From the vSphere Client, go to Host and Clusters.\n\nSelect the vCenter Server >> Configure >> vSAN >> Internet Connectivity.\n\nClick \"Edit\".\n\nIf the HCL internet download is not required, ensure \"Status\" is \"Disabled\".\n\nIf the HCL internet download is required, ensure \"Status\" is \"Enabled\" and a proxy host is appropriately configured."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60036r885692_chk","severity":"medium","gid":"V-256361","rid":"SV-256361r885694_rule","stig_id":"VCSA-70-000281","gtitle":"SRG-APP-000516","fix_id":"F-59979r885693_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256362","code":"control 'SV-256362' do\n  title 'The vCenter Server must configure the vSAN Datastore name to a unique name.'\n  desc 'A vSAN Datastore name by default is \"vsanDatastore\". If more than one vSAN cluster is present in vCenter, both datastores will have the same name by default, potentially leading to confusion and manually misplaced workloads.'\n  desc 'check', 'If no clusters are enabled for vSAN, this is not applicable.\n\nFrom the vSphere Client, go to Host and Clusters.\n\nSelect a vSAN Enabled Cluster >> Datastores.\n\nReview the datastores and identify any datastores with \"vSAN\" as the datastore type.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nIf($(Get-Cluster | where {$_.VsanEnabled} | Measure).Count -gt 0){\nWrite-Host \"vSAN Enabled Cluster found\"\nGet-Cluster | where {$_.VsanEnabled} | Get-Datastore | where {$_.type -match \"vsan\"}\n}\nelse{\nWrite-Host \"vSAN is not enabled, this finding is not applicable\"\n}\n\nIf vSAN is enabled and a datastore is named \"vsanDatastore\", this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vSAN Enabled Cluster >> Datastores.\n\nRight-click on the datastore named \"vsanDatastore\" and select \"Rename\".\n\nRename the datastore based on site-specific naming standards.\n\nClick \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nIf($(Get-Cluster | where {$_.VsanEnabled} | Measure).Count -gt 0){\nWrite-Host \"vSAN Enabled Cluster found\"\n$Clusters = Get-Cluster | where {$_.VsanEnabled} \nForeach ($clus in $clusters){\n $clus | Get-Datastore | where {$_.type -match \"vsan\"} | Set-Datastore -Name $(($clus.name) + \"_vSAN_Datastore\")\n}\n}\nelse{\nWrite-Host \"vSAN is not enabled, this finding is not applicable\"\n}'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60037r885695_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256362'\n  tag rid: 'SV-256362r885697_rule'\n  tag stig_id: 'VCSA-70-000282'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59980r885696_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256362.rb"},"title":"The vCenter Server must configure the vSAN Datastore name to a unique name.","desc":"A vSAN Datastore name by default is \"vsanDatastore\". If more than one vSAN cluster is present in vCenter, both datastores will have the same name by default, potentially leading to confusion and manually misplaced workloads.","descriptions":{"default":"A vSAN Datastore name by default is \"vsanDatastore\". If more than one vSAN cluster is present in vCenter, both datastores will have the same name by default, potentially leading to confusion and manually misplaced workloads.","check":"If no clusters are enabled for vSAN, this is not applicable.\n\nFrom the vSphere Client, go to Host and Clusters.\n\nSelect a vSAN Enabled Cluster >> Datastores.\n\nReview the datastores and identify any datastores with \"vSAN\" as the datastore type.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nIf($(Get-Cluster | where {$_.VsanEnabled} | Measure).Count -gt 0){\nWrite-Host \"vSAN Enabled Cluster found\"\nGet-Cluster | where {$_.VsanEnabled} | Get-Datastore | where {$_.type -match \"vsan\"}\n}\nelse{\nWrite-Host \"vSAN is not enabled, this finding is not applicable\"\n}\n\nIf vSAN is enabled and a datastore is named \"vsanDatastore\", this is a finding.","fix":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vSAN Enabled Cluster >> Datastores.\n\nRight-click on the datastore named \"vsanDatastore\" and select \"Rename\".\n\nRename the datastore based on site-specific naming standards.\n\nClick \"OK\".\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\nIf($(Get-Cluster | where {$_.VsanEnabled} | Measure).Count -gt 0){\nWrite-Host \"vSAN Enabled Cluster found\"\n$Clusters = Get-Cluster | where {$_.VsanEnabled} \nForeach ($clus in $clusters){\n $clus | Get-Datastore | where {$_.type -match \"vsan\"} | Set-Datastore -Name $(($clus.name) + \"_vSAN_Datastore\")\n}\n}\nelse{\nWrite-Host \"vSAN is not enabled, this finding is not applicable\"\n}"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60037r885695_chk","severity":"medium","gid":"V-256362","rid":"SV-256362r885697_rule","stig_id":"VCSA-70-000282","gtitle":"SRG-APP-000516","fix_id":"F-59980r885696_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256363","code":"control 'SV-256363' do\n  title 'The vCenter Server must disable Username/Password and Windows Integrated Authentication.'\n  desc 'All forms of authentication other than Common Access Card (CAC) must be disabled. Password authentication can be temporarily reenabled for emergency access to the local Single Sign-On (SSO) accounts or Active Directory user/pass accounts, but it must be disabled as soon as CAC authentication is functional.'\n  desc 'check', 'If a federated identity provider is configured and used for an identity source, this is not applicable.\n\nFrom the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider >> Smart Card Authentication.\n\nUnder \"Authentication method\", examine the allowed methods.\n\nIf \"Smart card authentication\" is not enabled and \"Password and windows session authentication\" is not disabled , this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider >> Smart Card Authentication.\n\nNext to \"Authentication method\", click \"Edit\".\n\nSelect the radio button to \"Enable smart card authentication\".\n\nClick \"Save\".\n\nTo reenable password authentication for troubleshooting purposes, run the following command on the vCenter Server Appliance:\n\n# /opt/vmware/bin/sso-config.sh -set_authn_policy -pwdAuthn true -winAuthn false -certAuthn false -securIDAuthn false -t vsphere.local'\n  impact 0.3\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60038r885698_chk'\n  tag severity: 'low'\n  tag gid: 'V-256363'\n  tag rid: 'SV-256363r885700_rule'\n  tag stig_id: 'VCSA-70-000283'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59981r885699_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256363.rb"},"title":"The vCenter Server must disable Username/Password and Windows Integrated Authentication.","desc":"All forms of authentication other than Common Access Card (CAC) must be disabled. Password authentication can be temporarily reenabled for emergency access to the local Single Sign-On (SSO) accounts or Active Directory user/pass accounts, but it must be disabled as soon as CAC authentication is functional.","descriptions":{"default":"All forms of authentication other than Common Access Card (CAC) must be disabled. Password authentication can be temporarily reenabled for emergency access to the local Single Sign-On (SSO) accounts or Active Directory user/pass accounts, but it must be disabled as soon as CAC authentication is functional.","check":"If a federated identity provider is configured and used for an identity source, this is not applicable.\n\nFrom the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider >> Smart Card Authentication.\n\nUnder \"Authentication method\", examine the allowed methods.\n\nIf \"Smart card authentication\" is not enabled and \"Password and windows session authentication\" is not disabled , this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider >> Smart Card Authentication.\n\nNext to \"Authentication method\", click \"Edit\".\n\nSelect the radio button to \"Enable smart card authentication\".\n\nClick \"Save\".\n\nTo reenable password authentication for troubleshooting purposes, run the following command on the vCenter Server Appliance:\n\n# /opt/vmware/bin/sso-config.sh -set_authn_policy -pwdAuthn true -winAuthn false -certAuthn false -securIDAuthn false -t vsphere.local"},"impact":0.3,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60038r885698_chk","severity":"low","gid":"V-256363","rid":"SV-256363r885700_rule","stig_id":"VCSA-70-000283","gtitle":"SRG-APP-000516","fix_id":"F-59981r885699_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256364","code":"control 'SV-256364' do\n  title 'The vCenter Server must restrict access to the default roles with cryptographic permissions.'\n  desc 'In vSphere, a number of default roles contain permission to perform cryptographic operations such as Key Management Server (KMS) functions and encrypting and decrypting virtual machine disks. These roles must be reserved for cryptographic administrators where virtual machine encryption and/or vSAN encryption is in use.\n\nA new built-in role called \"No Cryptography Administrator\" exists to provide all administrative permissions except cryptographic operations. Permissions must be restricted such that normal vSphere administrators are assigned the \"No Cryptography Administrator\" role or more restrictive.\n\nThese default roles must be tightly controlled and must not be applied to administrators who will not be doing cryptographic work. Catastrophic data loss can result from poorly administered cryptography.'\n  desc 'check', 'By default, there are four roles that contain cryptographic-related permissions: Administrator, No Trusted Infrastructure Administrator, vCLSAdmin, and vSphere Kubernetes Manager.\n\nFrom the vSphere Client, go to Administration >> Access Control >> Roles.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VIPermission | Where {$_.Role -eq \"Admin\" -or $_.Role -eq \"NoTrustedAdmin\" -or $_.Role -eq \"vCLSAdmin\" -or $_.Role -eq \"vSphereKubernetesManager\"} | Select Role,Principal,Entity,Propagate,IsGroup | FT -Auto\n\nIf there are any users or groups assigned to the default roles with cryptographic permissions and are not explicitly designated to perform cryptographic operations, this is a finding.\n\nThe built-in solution users assigned to the administrator role are NOT a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Access Control >> Roles.\n\nMove any accounts not explicitly designated for cryptographic operations, other than Solution Users, to other roles such as \"No Cryptography Administrator\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60039r919044_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256364'\n  tag rid: 'SV-256364r919045_rule'\n  tag stig_id: 'VCSA-70-000284'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59982r885702_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256364.rb"},"title":"The vCenter Server must restrict access to the default roles with cryptographic permissions.","desc":"In vSphere, a number of default roles contain permission to perform cryptographic operations such as Key Management Server (KMS) functions and encrypting and decrypting virtual machine disks. These roles must be reserved for cryptographic administrators where virtual machine encryption and/or vSAN encryption is in use.\n\nA new built-in role called \"No Cryptography Administrator\" exists to provide all administrative permissions except cryptographic operations. Permissions must be restricted such that normal vSphere administrators are assigned the \"No Cryptography Administrator\" role or more restrictive.\n\nThese default roles must be tightly controlled and must not be applied to administrators who will not be doing cryptographic work. Catastrophic data loss can result from poorly administered cryptography.","descriptions":{"default":"In vSphere, a number of default roles contain permission to perform cryptographic operations such as Key Management Server (KMS) functions and encrypting and decrypting virtual machine disks. These roles must be reserved for cryptographic administrators where virtual machine encryption and/or vSAN encryption is in use.\n\nA new built-in role called \"No Cryptography Administrator\" exists to provide all administrative permissions except cryptographic operations. Permissions must be restricted such that normal vSphere administrators are assigned the \"No Cryptography Administrator\" role or more restrictive.\n\nThese default roles must be tightly controlled and must not be applied to administrators who will not be doing cryptographic work. Catastrophic data loss can result from poorly administered cryptography.","check":"By default, there are four roles that contain cryptographic-related permissions: Administrator, No Trusted Infrastructure Administrator, vCLSAdmin, and vSphere Kubernetes Manager.\n\nFrom the vSphere Client, go to Administration >> Access Control >> Roles.\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following command:\n\nGet-VIPermission | Where {$_.Role -eq \"Admin\" -or $_.Role -eq \"NoTrustedAdmin\" -or $_.Role -eq \"vCLSAdmin\" -or $_.Role -eq \"vSphereKubernetesManager\"} | Select Role,Principal,Entity,Propagate,IsGroup | FT -Auto\n\nIf there are any users or groups assigned to the default roles with cryptographic permissions and are not explicitly designated to perform cryptographic operations, this is a finding.\n\nThe built-in solution users assigned to the administrator role are NOT a finding.","fix":"From the vSphere Client, go to Administration >> Access Control >> Roles.\n\nMove any accounts not explicitly designated for cryptographic operations, other than Solution Users, to other roles such as \"No Cryptography Administrator\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60039r919044_chk","severity":"medium","gid":"V-256364","rid":"SV-256364r919045_rule","stig_id":"VCSA-70-000284","gtitle":"SRG-APP-000516","fix_id":"F-59982r885702_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256365","code":"control 'SV-256365' do\n  title 'The vCenter Server must restrict access to cryptographic permissions.'\n  desc 'These permissions must be reserved for cryptographic administrators where virtual machine encryption and/or vSAN encryption is in use. Catastrophic data loss can result from poorly administered cryptography.'\n  desc 'check', %q(By default, there are four roles that contain cryptographic-related permissions: Administrator, No Trusted Infrastructure Administrator, vCLSAdmin, and vSphere Kubernetes Manager.\n\nFrom the vSphere Client, go to Administration >> Access Control >> Roles.\n\nHighlight each role and click the 'Privileges\" button in the right pane.\n\nVerify that only the Administrator, No Trusted Infrastructure Administrator, vCLSAdmin, and vSphere Kubernetes Manager and any site-specific cryptographic roles have the following permissions:\n\nCryptographic Operations privileges\nGlobal.Diagnostics\nHost.Inventory.Add host to cluster\nHost.Inventory.Add standalone host\nHost.Local operations.Manage user groups\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n$roles = Get-VIRole\nForEach($role in $roles){\n    $privileges = $role.PrivilegeList\n    If($privileges -match \"Crypto*\" -or $privileges -match \"Global.Diagnostics\" -or $privileges -match \"Host.Inventory.Add*\" -or $privileges -match \"Host.Local operations.Manage user groups\"){\n    Write-Host \"$role has Cryptographic privileges\"\n    }\n}\n\nIf any role other than the four default roles contain the permissions listed above and is not authorized to perform cryptographic-related operations, this is a finding.)\n  desc 'fix', 'From the vSphere Client, go to Administration >> Access Control >> Roles.\n\nHighlight the target custom role and click \"Edit\".\n\nRemove the following permissions from any custom role that is not authorized to perform cryptographic-related operations:\n\nCryptographic Operations privileges\nGlobal.Diagnostics\nHost.Inventory.Add host to cluster\nHost.Inventory.Add standalone host\nHost.Local operations.Manage user groups'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60040r919038_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256365'\n  tag rid: 'SV-256365r919040_rule'\n  tag stig_id: 'VCSA-70-000285'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59983r919039_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256365.rb"},"title":"The vCenter Server must restrict access to cryptographic permissions.","desc":"These permissions must be reserved for cryptographic administrators where virtual machine encryption and/or vSAN encryption is in use. Catastrophic data loss can result from poorly administered cryptography.","descriptions":{"default":"These permissions must be reserved for cryptographic administrators where virtual machine encryption and/or vSAN encryption is in use. Catastrophic data loss can result from poorly administered cryptography.","check":"By default, there are four roles that contain cryptographic-related permissions: Administrator, No Trusted Infrastructure Administrator, vCLSAdmin, and vSphere Kubernetes Manager.\n\nFrom the vSphere Client, go to Administration >> Access Control >> Roles.\n\nHighlight each role and click the 'Privileges\" button in the right pane.\n\nVerify that only the Administrator, No Trusted Infrastructure Administrator, vCLSAdmin, and vSphere Kubernetes Manager and any site-specific cryptographic roles have the following permissions:\n\nCryptographic Operations privileges\nGlobal.Diagnostics\nHost.Inventory.Add host to cluster\nHost.Inventory.Add standalone host\nHost.Local operations.Manage user groups\n\nor\n\nFrom a PowerCLI command prompt while connected to the vCenter server, run the following commands:\n\n$roles = Get-VIRole\nForEach($role in $roles){\n    $privileges = $role.PrivilegeList\n    If($privileges -match \"Crypto*\" -or $privileges -match \"Global.Diagnostics\" -or $privileges -match \"Host.Inventory.Add*\" -or $privileges -match \"Host.Local operations.Manage user groups\"){\n    Write-Host \"$role has Cryptographic privileges\"\n    }\n}\n\nIf any role other than the four default roles contain the permissions listed above and is not authorized to perform cryptographic-related operations, this is a finding.","fix":"From the vSphere Client, go to Administration >> Access Control >> Roles.\n\nHighlight the target custom role and click \"Edit\".\n\nRemove the following permissions from any custom role that is not authorized to perform cryptographic-related operations:\n\nCryptographic Operations privileges\nGlobal.Diagnostics\nHost.Inventory.Add host to cluster\nHost.Inventory.Add standalone host\nHost.Local operations.Manage user groups"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60040r919038_chk","severity":"medium","gid":"V-256365","rid":"SV-256365r919040_rule","stig_id":"VCSA-70-000285","gtitle":"SRG-APP-000516","fix_id":"F-59983r919039_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256366","code":"control 'SV-256366' do\n  title 'The vCenter Server must have Mutual Challenge Handshake Authentication Protocol (CHAP) configured for vSAN Internet Small Computer System Interface (iSCSI) targets.'\n  desc 'When enabled, vSphere performs bidirectional authentication of both the iSCSI target and host. When not authenticating both the iSCSI target and host, the potential exists for a man-in-the-middle attack in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication mitigates this risk.'\n  desc 'check', 'If no clusters are enabled for vSAN or if vSAN is enabled but iSCSI is not enabled, this is not applicable.\n\nFrom the vSphere Client, go to Host and Clusters.\n\nSelect a vSAN Enabled Cluster >> Configure >> vSAN >> iSCSI Target Service.\n\nFor each iSCSI target, review the value in the \"Authentication\" column.\n\nIf the Authentication method is not set to \"CHAP_Mutual\" for any iSCSI target, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Host and Clusters. \n\nSelect a vSAN Enabled Cluster >> Configure >> vSAN >> iSCSI Target Service.\n\nFor each iSCSI target, select the item and click \"Edit\".\n\nChange the \"Authentication\" field to \"Mutual CHAP\" and configure the incoming and outgoing users and secrets appropriately.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60041r885707_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256366'\n  tag rid: 'SV-256366r885709_rule'\n  tag stig_id: 'VCSA-70-000286'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59984r885708_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256366.rb"},"title":"The vCenter Server must have Mutual Challenge Handshake Authentication Protocol (CHAP) configured for vSAN Internet Small Computer System Interface (iSCSI) targets.","desc":"When enabled, vSphere performs bidirectional authentication of both the iSCSI target and host. When not authenticating both the iSCSI target and host, the potential exists for a man-in-the-middle attack in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication mitigates this risk.","descriptions":{"default":"When enabled, vSphere performs bidirectional authentication of both the iSCSI target and host. When not authenticating both the iSCSI target and host, the potential exists for a man-in-the-middle attack in which an attacker might impersonate either side of the connection to steal data. Bidirectional authentication mitigates this risk.","check":"If no clusters are enabled for vSAN or if vSAN is enabled but iSCSI is not enabled, this is not applicable.\n\nFrom the vSphere Client, go to Host and Clusters.\n\nSelect a vSAN Enabled Cluster >> Configure >> vSAN >> iSCSI Target Service.\n\nFor each iSCSI target, review the value in the \"Authentication\" column.\n\nIf the Authentication method is not set to \"CHAP_Mutual\" for any iSCSI target, this is a finding.","fix":"From the vSphere Client, go to Host and Clusters. \n\nSelect a vSAN Enabled Cluster >> Configure >> vSAN >> iSCSI Target Service.\n\nFor each iSCSI target, select the item and click \"Edit\".\n\nChange the \"Authentication\" field to \"Mutual CHAP\" and configure the incoming and outgoing users and secrets appropriately."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60041r885707_chk","severity":"medium","gid":"V-256366","rid":"SV-256366r885709_rule","stig_id":"VCSA-70-000286","gtitle":"SRG-APP-000516","fix_id":"F-59984r885708_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256367","code":"control 'SV-256367' do\n  title 'The vCenter Server must have new Key Encryption Keys (KEKs) reissued at regular intervals for vSAN encrypted datastore(s).'\n  desc 'The KEK for a vSAN encrypted datastore is generated by the Key Management Server (KMS) and serves as a wrapper and lock around the Disk Encryption Key (DEK). The DEK is generated by the host and is used to encrypt and decrypt the datastore. A shallow rekey is a procedure in which the KMS issues a new KEK to the ESXi host, which rewraps the DEK but does not change the DEK or any data on disk.\n\nThis operation must be done on a regular, site-defined interval and can be viewed as similar in criticality to changing an administrative password. If the KMS is compromised, a standing operational procedure to rekey will put a time limit on the usefulness of any stolen KMS data.'\n  desc 'check', 'If vSAN is not in use, this is not applicable.\n\nInterview the system administrator (SA) to determine that a procedure has been put in place to perform a shallow rekey of all vSAN encrypted datastores at regular, site-defined intervals.\n\nVMware recommends a 60-day rekey task, but this interval must be defined by the SA and the information system security officer (ISSO).\n\nIf vSAN encryption is not in use, this is not a finding.\n\nIf vSAN encryption is in use and a regular rekey procedure is not in place, this is a finding.'\n  desc 'fix', 'If vSAN encryption is in use, ensure a regular rekey procedure is in place.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60042r885710_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256367'\n  tag rid: 'SV-256367r885712_rule'\n  tag stig_id: 'VCSA-70-000287'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59985r885711_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256367.rb"},"title":"The vCenter Server must have new Key Encryption Keys (KEKs) reissued at regular intervals for vSAN encrypted datastore(s).","desc":"The KEK for a vSAN encrypted datastore is generated by the Key Management Server (KMS) and serves as a wrapper and lock around the Disk Encryption Key (DEK). The DEK is generated by the host and is used to encrypt and decrypt the datastore. A shallow rekey is a procedure in which the KMS issues a new KEK to the ESXi host, which rewraps the DEK but does not change the DEK or any data on disk.\n\nThis operation must be done on a regular, site-defined interval and can be viewed as similar in criticality to changing an administrative password. If the KMS is compromised, a standing operational procedure to rekey will put a time limit on the usefulness of any stolen KMS data.","descriptions":{"default":"The KEK for a vSAN encrypted datastore is generated by the Key Management Server (KMS) and serves as a wrapper and lock around the Disk Encryption Key (DEK). The DEK is generated by the host and is used to encrypt and decrypt the datastore. A shallow rekey is a procedure in which the KMS issues a new KEK to the ESXi host, which rewraps the DEK but does not change the DEK or any data on disk.\n\nThis operation must be done on a regular, site-defined interval and can be viewed as similar in criticality to changing an administrative password. If the KMS is compromised, a standing operational procedure to rekey will put a time limit on the usefulness of any stolen KMS data.","check":"If vSAN is not in use, this is not applicable.\n\nInterview the system administrator (SA) to determine that a procedure has been put in place to perform a shallow rekey of all vSAN encrypted datastores at regular, site-defined intervals.\n\nVMware recommends a 60-day rekey task, but this interval must be defined by the SA and the information system security officer (ISSO).\n\nIf vSAN encryption is not in use, this is not a finding.\n\nIf vSAN encryption is in use and a regular rekey procedure is not in place, this is a finding.","fix":"If vSAN encryption is in use, ensure a regular rekey procedure is in place."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60042r885710_chk","severity":"medium","gid":"V-256367","rid":"SV-256367r885712_rule","stig_id":"VCSA-70-000287","gtitle":"SRG-APP-000516","fix_id":"F-59985r885711_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256368","code":"control 'SV-256368' do\n  title 'The vCenter Server must use secure Lightweight Directory Access Protocol (LDAPS) when adding an LDAP identity source.'\n  desc 'LDAP is an industry standard protocol for querying directory services such as Active Directory. This protocol can operate in clear text or over a Secure Sockets Layer (SSL)/Transport Layer Security (TLS) encrypted tunnel. To protect confidentiality of LDAP communications, secure LDAP (LDAPS) must be explicitly configured when adding an LDAP identity source in vSphere Single Sign-On (SSO).\n\nWhen configuring an identity source and supplying an SSL certificate, vCenter will enforce LDAPS. The server URLs do not need to be explicitly provided if an SSL certificate is uploaded.'\n  desc 'check', 'If LDAP is not used as an identity provider, this is not applicable.\n\nFrom the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider.\n\nClick the \"Identity Sources\" tab.\n\nFor each identity source of type \"Active Directory over LDAP\", if the \"Server URL\" does not indicate \"ldaps://\", this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider. \n\nClick the \"Identity Sources\" tab.\n\nFor each identity source of type \"Active Directory over LDAP\" where LDAPS is not configured, highlight the item and click \"Edit\".\n\nEnsure the primary and secondary server URLs, if specified, are configured for \"ldaps://\".\n\nAt the bottom, click the \"Browse\" button, select the AD LDAP cert previously exported to the local computer, click \"Open\", and \"Save\" to complete modifications.\n\nNote: With LDAPS, the server must be a specific domain controller and its specific certificate or the domain alias with a certificate that is valid for that URL.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60043r885713_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256368'\n  tag rid: 'SV-256368r885715_rule'\n  tag stig_id: 'VCSA-70-000288'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59986r885714_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256368.rb"},"title":"The vCenter Server must use secure Lightweight Directory Access Protocol (LDAPS) when adding an LDAP identity source.","desc":"LDAP is an industry standard protocol for querying directory services such as Active Directory. This protocol can operate in clear text or over a Secure Sockets Layer (SSL)/Transport Layer Security (TLS) encrypted tunnel. To protect confidentiality of LDAP communications, secure LDAP (LDAPS) must be explicitly configured when adding an LDAP identity source in vSphere Single Sign-On (SSO).\n\nWhen configuring an identity source and supplying an SSL certificate, vCenter will enforce LDAPS. The server URLs do not need to be explicitly provided if an SSL certificate is uploaded.","descriptions":{"default":"LDAP is an industry standard protocol for querying directory services such as Active Directory. This protocol can operate in clear text or over a Secure Sockets Layer (SSL)/Transport Layer Security (TLS) encrypted tunnel. To protect confidentiality of LDAP communications, secure LDAP (LDAPS) must be explicitly configured when adding an LDAP identity source in vSphere Single Sign-On (SSO).\n\nWhen configuring an identity source and supplying an SSL certificate, vCenter will enforce LDAPS. The server URLs do not need to be explicitly provided if an SSL certificate is uploaded.","check":"If LDAP is not used as an identity provider, this is not applicable.\n\nFrom the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider.\n\nClick the \"Identity Sources\" tab.\n\nFor each identity source of type \"Active Directory over LDAP\", if the \"Server URL\" does not indicate \"ldaps://\", this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider. \n\nClick the \"Identity Sources\" tab.\n\nFor each identity source of type \"Active Directory over LDAP\" where LDAPS is not configured, highlight the item and click \"Edit\".\n\nEnsure the primary and secondary server URLs, if specified, are configured for \"ldaps://\".\n\nAt the bottom, click the \"Browse\" button, select the AD LDAP cert previously exported to the local computer, click \"Open\", and \"Save\" to complete modifications.\n\nNote: With LDAPS, the server must be a specific domain controller and its specific certificate or the domain alias with a certificate that is valid for that URL."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60043r885713_chk","severity":"medium","gid":"V-256368","rid":"SV-256368r885715_rule","stig_id":"VCSA-70-000288","gtitle":"SRG-APP-000516","fix_id":"F-59986r885714_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256369","code":"control 'SV-256369' do\n  title 'The vCenter Server must use a limited privilege account when adding a Lightweight Directory Access Protocol (LDAP) identity source.'\n  desc 'When adding an LDAP identity source to vSphere Single Sign-On (SSO), the account used to bind to Active Directory must be minimally privileged. This account only requires read rights to the base domain name specified. Any other permissions inside or outside of that organizational unit are unnecessary and violate least privilege.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider.\n\nClick the \"Identity Sources\" tab.\n\nFor each identity source with a type of \"Active Directory over LDAP\", highlight the item and click \"Edit\". \n\nIf the account that is configured to bind to the LDAP server is not one with minimal privileges, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider.\n\nClick the \"Identity Sources\" tab.\n\nFor each identity source that has been configured with a highly privileged Active Directory account, highlight the item and click \"Edit\".\n\nChange the username and password to one with read-only rights to the base DN and complete the dialog.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60044r885716_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256369'\n  tag rid: 'SV-256369r885718_rule'\n  tag stig_id: 'VCSA-70-000289'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59987r885717_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256369.rb"},"title":"The vCenter Server must use a limited privilege account when adding a Lightweight Directory Access Protocol (LDAP) identity source.","desc":"When adding an LDAP identity source to vSphere Single Sign-On (SSO), the account used to bind to Active Directory must be minimally privileged. This account only requires read rights to the base domain name specified. Any other permissions inside or outside of that organizational unit are unnecessary and violate least privilege.","descriptions":{"default":"When adding an LDAP identity source to vSphere Single Sign-On (SSO), the account used to bind to Active Directory must be minimally privileged. This account only requires read rights to the base domain name specified. Any other permissions inside or outside of that organizational unit are unnecessary and violate least privilege.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider.\n\nClick the \"Identity Sources\" tab.\n\nFor each identity source with a type of \"Active Directory over LDAP\", highlight the item and click \"Edit\". \n\nIf the account that is configured to bind to the LDAP server is not one with minimal privileges, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Configuration >> Identity Provider.\n\nClick the \"Identity Sources\" tab.\n\nFor each identity source that has been configured with a highly privileged Active Directory account, highlight the item and click \"Edit\".\n\nChange the username and password to one with read-only rights to the base DN and complete the dialog."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60044r885716_chk","severity":"medium","gid":"V-256369","rid":"SV-256369r885718_rule","stig_id":"VCSA-70-000289","gtitle":"SRG-APP-000516","fix_id":"F-59987r885717_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256370","code":"control 'SV-256370' do\n  title 'The vCenter Server must limit membership to the \"SystemConfiguration.BashShellAdministrators\" Single Sign-On (SSO) group.'\n  desc 'vCenter SSO integrates with PAM in the underlying Photon operating system so members of the \"SystemConfiguration.BashShellAdministrators\" SSO group can log on to the operating system without needing a separate account. However, even though unique SSO users log on, they are transparently using a group account named \"sso-user\" as far as Photon auditing is concerned. While the audit trail can still be traced back to the individual SSO user, it is a more involved process.\n\nTo force accountability and nonrepudiation, the SSO group \"SystemConfiguration.BashShellAdministrators\" must be severely restricted.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Users and Groups >> Groups.\n\nClick the next page arrow until the \"SystemConfiguration.BashShellAdministrators\" group appears.\n\nClick \"SystemConfiguration.BashShellAdministrators\".\n\nReview the members of the group and ensure that only authorized accounts are present.\n\nNote: These accounts act as root on the Photon operating system and have the ability to severely damage vCenter, inadvertently or otherwise.\n\nIf there are any accounts present as members of SystemConfiguration.BashShellAdministrators that are not authorized, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Users and Groups >> Groups.\n\nClick the next page arrow until the \"SystemConfiguration.BashShellAdministrators\" group appears.\n\nClick \"SystemConfiguration.BashShellAdministrators\".\n\nClick the three vertical dots next to the name of each unauthorized account.\n\nSelect \"Remove Member\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60045r885719_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256370'\n  tag rid: 'SV-256370r885721_rule'\n  tag stig_id: 'VCSA-70-000290'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59988r885720_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256370.rb"},"title":"The vCenter Server must limit membership to the \"SystemConfiguration.BashShellAdministrators\" Single Sign-On (SSO) group.","desc":"vCenter SSO integrates with PAM in the underlying Photon operating system so members of the \"SystemConfiguration.BashShellAdministrators\" SSO group can log on to the operating system without needing a separate account. However, even though unique SSO users log on, they are transparently using a group account named \"sso-user\" as far as Photon auditing is concerned. While the audit trail can still be traced back to the individual SSO user, it is a more involved process.\n\nTo force accountability and nonrepudiation, the SSO group \"SystemConfiguration.BashShellAdministrators\" must be severely restricted.","descriptions":{"default":"vCenter SSO integrates with PAM in the underlying Photon operating system so members of the \"SystemConfiguration.BashShellAdministrators\" SSO group can log on to the operating system without needing a separate account. However, even though unique SSO users log on, they are transparently using a group account named \"sso-user\" as far as Photon auditing is concerned. While the audit trail can still be traced back to the individual SSO user, it is a more involved process.\n\nTo force accountability and nonrepudiation, the SSO group \"SystemConfiguration.BashShellAdministrators\" must be severely restricted.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Users and Groups >> Groups.\n\nClick the next page arrow until the \"SystemConfiguration.BashShellAdministrators\" group appears.\n\nClick \"SystemConfiguration.BashShellAdministrators\".\n\nReview the members of the group and ensure that only authorized accounts are present.\n\nNote: These accounts act as root on the Photon operating system and have the ability to severely damage vCenter, inadvertently or otherwise.\n\nIf there are any accounts present as members of SystemConfiguration.BashShellAdministrators that are not authorized, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Users and Groups >> Groups.\n\nClick the next page arrow until the \"SystemConfiguration.BashShellAdministrators\" group appears.\n\nClick \"SystemConfiguration.BashShellAdministrators\".\n\nClick the three vertical dots next to the name of each unauthorized account.\n\nSelect \"Remove Member\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60045r885719_chk","severity":"medium","gid":"V-256370","rid":"SV-256370r885721_rule","stig_id":"VCSA-70-000290","gtitle":"SRG-APP-000516","fix_id":"F-59988r885720_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256371","code":"control 'SV-256371' do\n  title 'The vCenter Server must limit membership to the \"TrustedAdmins\" Single Sign-On (SSO) group.'\n  desc 'The vSphere \"TrustedAdmins\" group grants additional rights to administer the vSphere Trust Authority feature.\n\nTo force accountability and nonrepudiation, the SSO group \"TrustedAdmins\" must be severely restricted.'\n  desc 'check', 'From the vSphere Client, go to Administration >> Single Sign On >> Users and Groups >> Groups.\n\nClick the next page arrow until the \"TrustedAdmins\" group appears.\n\nClick \"TrustedAdmins\".\n\nReview the members of the group and verify only authorized accounts are present.\n\nNote: These accounts act as root on the Photon operating system and have the ability to severely damage vCenter, inadvertently or otherwise.\n\nIf any accounts are present as members of \"TrustedAdmins\" that are not authorized, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Administration >> Single Sign On >> Users and Groups >> Groups.\n\nClick the next page arrow until the \"TrustedAdmins\" group appears.\n\nClick \"TrustedAdmins\".\n\nClick the three vertical dots next to the name of each unauthorized account.\n\nSelect \"Remove Member\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60046r885722_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256371'\n  tag rid: 'SV-256371r885724_rule'\n  tag stig_id: 'VCSA-70-000291'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59989r885723_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256371.rb"},"title":"The vCenter Server must limit membership to the \"TrustedAdmins\" Single Sign-On (SSO) group.","desc":"The vSphere \"TrustedAdmins\" group grants additional rights to administer the vSphere Trust Authority feature.\n\nTo force accountability and nonrepudiation, the SSO group \"TrustedAdmins\" must be severely restricted.","descriptions":{"default":"The vSphere \"TrustedAdmins\" group grants additional rights to administer the vSphere Trust Authority feature.\n\nTo force accountability and nonrepudiation, the SSO group \"TrustedAdmins\" must be severely restricted.","check":"From the vSphere Client, go to Administration >> Single Sign On >> Users and Groups >> Groups.\n\nClick the next page arrow until the \"TrustedAdmins\" group appears.\n\nClick \"TrustedAdmins\".\n\nReview the members of the group and verify only authorized accounts are present.\n\nNote: These accounts act as root on the Photon operating system and have the ability to severely damage vCenter, inadvertently or otherwise.\n\nIf any accounts are present as members of \"TrustedAdmins\" that are not authorized, this is a finding.","fix":"From the vSphere Client, go to Administration >> Single Sign On >> Users and Groups >> Groups.\n\nClick the next page arrow until the \"TrustedAdmins\" group appears.\n\nClick \"TrustedAdmins\".\n\nClick the three vertical dots next to the name of each unauthorized account.\n\nSelect \"Remove Member\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60046r885722_chk","severity":"medium","gid":"V-256371","rid":"SV-256371r885724_rule","stig_id":"VCSA-70-000291","gtitle":"SRG-APP-000516","fix_id":"F-59989r885723_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256372","code":"control 'SV-256372' do\n  title 'The vCenter server configuration must be backed up on a regular basis.'\n  desc 'vCenter server is the control plane for the vSphere infrastructure and all the workloads it hosts. As such, vCenter is usually a highly critical system in its own right. Backups of vCenter can now be made at a data and configuration level versus traditional storage/image-based backups. This reduces recovery time by letting the system administrator (SA) spin up a new vCenter while simultaneously importing the backed-up data.\n\nFor sites that implement the Native Key Provider (NKP), introduced in 7.0 Update 2, regular vCenter backups are critical. In a recovery scenario where the virtual machine files are intact but vCenter was lost, the encrypted virtual machines will not be able to boot as their private keys were stored in vCenter after it was last backed up. When using the NKP, vCenter becomes critical to the virtual machine workloads and ceases to be just the control plane.'\n  desc 'check', 'Option 1:\n\nIf vCenter is backed up in a traditional manner, at the storage array level, interview the SA to determine configuration and schedule.\n\nOption 2:\n\nFor vCenter native backup functionality, open the Virtual Appliance Management Interface (VAMI) by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with a Single Sign-On (SSO) account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Backup\" on the left navigation pane.\n\nOn the resulting pane on the right, verify the \"Status\" is \"Enabled\".\n\nClick \"Status\" to expand the backup details.\n\nIf vCenter server backups are not configured and there is no other vCenter backup system, this is a finding.\n\nIf the backup configuration is not set to a proper, reachable location or if the schedule is anything less frequent than \"Daily\", this is a finding.'\n  desc 'fix', 'Option 1:\n\nImplement and document a VMware-supported storage/image-based backup schedule.\n\nOption 2:\n\nTo configure vCenter native backup functionality, open the VAMI by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with an SSO account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Backup\" on the left navigation pane.\n\nOn the resulting pane on the right, click \"Configure\" (or \"Edit\" for an existing configuration).\n\nEnter site-specific information for the backup job.\n\nEnsure \"Schedule\" is set to \"Daily\". Limiting the number of retained backups is recommended but not required.\n\nClick \"Create\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60047r885725_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256372'\n  tag rid: 'SV-256372r885727_rule'\n  tag stig_id: 'VCSA-70-000292'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59990r885726_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256372.rb"},"title":"The vCenter server configuration must be backed up on a regular basis.","desc":"vCenter server is the control plane for the vSphere infrastructure and all the workloads it hosts. As such, vCenter is usually a highly critical system in its own right. Backups of vCenter can now be made at a data and configuration level versus traditional storage/image-based backups. This reduces recovery time by letting the system administrator (SA) spin up a new vCenter while simultaneously importing the backed-up data.\n\nFor sites that implement the Native Key Provider (NKP), introduced in 7.0 Update 2, regular vCenter backups are critical. In a recovery scenario where the virtual machine files are intact but vCenter was lost, the encrypted virtual machines will not be able to boot as their private keys were stored in vCenter after it was last backed up. When using the NKP, vCenter becomes critical to the virtual machine workloads and ceases to be just the control plane.","descriptions":{"default":"vCenter server is the control plane for the vSphere infrastructure and all the workloads it hosts. As such, vCenter is usually a highly critical system in its own right. Backups of vCenter can now be made at a data and configuration level versus traditional storage/image-based backups. This reduces recovery time by letting the system administrator (SA) spin up a new vCenter while simultaneously importing the backed-up data.\n\nFor sites that implement the Native Key Provider (NKP), introduced in 7.0 Update 2, regular vCenter backups are critical. In a recovery scenario where the virtual machine files are intact but vCenter was lost, the encrypted virtual machines will not be able to boot as their private keys were stored in vCenter after it was last backed up. When using the NKP, vCenter becomes critical to the virtual machine workloads and ceases to be just the control plane.","check":"Option 1:\n\nIf vCenter is backed up in a traditional manner, at the storage array level, interview the SA to determine configuration and schedule.\n\nOption 2:\n\nFor vCenter native backup functionality, open the Virtual Appliance Management Interface (VAMI) by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with a Single Sign-On (SSO) account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Backup\" on the left navigation pane.\n\nOn the resulting pane on the right, verify the \"Status\" is \"Enabled\".\n\nClick \"Status\" to expand the backup details.\n\nIf vCenter server backups are not configured and there is no other vCenter backup system, this is a finding.\n\nIf the backup configuration is not set to a proper, reachable location or if the schedule is anything less frequent than \"Daily\", this is a finding.","fix":"Option 1:\n\nImplement and document a VMware-supported storage/image-based backup schedule.\n\nOption 2:\n\nTo configure vCenter native backup functionality, open the VAMI by navigating to https://<vCenter server>:5480.\n\nLog in with local operating system administrative credentials or with an SSO account that is a member of the \"SystemConfiguration.BashShellAdministrator\" group.\n\nSelect \"Backup\" on the left navigation pane.\n\nOn the resulting pane on the right, click \"Configure\" (or \"Edit\" for an existing configuration).\n\nEnter site-specific information for the backup job.\n\nEnsure \"Schedule\" is set to \"Daily\". Limiting the number of retained backups is recommended but not required.\n\nClick \"Create\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60047r885725_chk","severity":"medium","gid":"V-256372","rid":"SV-256372r885727_rule","stig_id":"VCSA-70-000292","gtitle":"SRG-APP-000516","fix_id":"F-59990r885726_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256373","code":"control 'SV-256373' do\n  title 'vCenter task and event retention must be set to at least 30 days.'\n  desc 'vCenter tasks and events contain valuable historical actions, useful in troubleshooting availability issues and for incident forensics. While vCenter events are sent to central log servers in real time, it is important that administrators have quick access to this information when needed.\n\nvCenter retains 30 days of tasks and events by default, and this is sufficient for most purposes. The vCenter disk partitions are also sized with this in mind. Decreasing is not recommended for operational reasons, while increasing is not recommended unless guided by VMware support due to the partition sizing concerns.'\n  desc 'check', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> General.\n\nClick to expand the \"Database\" section.\n\nNote the \"Task retention\" and \"Event retention\" values.\n\nIf either value is configured to less than \"30\" days, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> General.\n\nClick \"Edit\".\n\nOn the \"Database\" tab, set the value for both \"Task retention\" and \"Event retention\" to \"30\" days (default) or greater, as required by the site.\n\nClick \"Save\".'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60048r885728_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256373'\n  tag rid: 'SV-256373r885730_rule'\n  tag stig_id: 'VCSA-70-000293'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59991r885729_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256373.rb"},"title":"vCenter task and event retention must be set to at least 30 days.","desc":"vCenter tasks and events contain valuable historical actions, useful in troubleshooting availability issues and for incident forensics. While vCenter events are sent to central log servers in real time, it is important that administrators have quick access to this information when needed.\n\nvCenter retains 30 days of tasks and events by default, and this is sufficient for most purposes. The vCenter disk partitions are also sized with this in mind. Decreasing is not recommended for operational reasons, while increasing is not recommended unless guided by VMware support due to the partition sizing concerns.","descriptions":{"default":"vCenter tasks and events contain valuable historical actions, useful in troubleshooting availability issues and for incident forensics. While vCenter events are sent to central log servers in real time, it is important that administrators have quick access to this information when needed.\n\nvCenter retains 30 days of tasks and events by default, and this is sufficient for most purposes. The vCenter disk partitions are also sized with this in mind. Decreasing is not recommended for operational reasons, while increasing is not recommended unless guided by VMware support due to the partition sizing concerns.","check":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> General.\n\nClick to expand the \"Database\" section.\n\nNote the \"Task retention\" and \"Event retention\" values.\n\nIf either value is configured to less than \"30\" days, this is a finding.","fix":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Settings >> General.\n\nClick \"Edit\".\n\nOn the \"Database\" tab, set the value for both \"Task retention\" and \"Event retention\" to \"30\" days (default) or greater, as required by the site.\n\nClick \"Save\"."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60048r885728_chk","severity":"medium","gid":"V-256373","rid":"SV-256373r885730_rule","stig_id":"VCSA-70-000293","gtitle":"SRG-APP-000516","fix_id":"F-59991r885729_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-256374","code":"control 'SV-256374' do\n  title 'vCenter Native Key Providers must be backed up with a strong password.'\n  desc 'The vCenter Native Key Provider feature was introduced in U2 and acts as a key provider for encryption-based capabilities, such as encrypted virtual machines without requiring an external KMS solution. When enabling this feature, a backup must be taken that is a PKCS#12 formatted file. If no password is provided during the backup process, this presents the opportunity for this to be used maliciously and compromise the environment.'\n  desc 'check', 'If the vCenter Native Key Provider feature is not in use, this is not applicable.\n\nInterview the system administrator and determine if a password was provided for any backups taken of the Native Key Provider.\n\nIf backups exist for the Native Key Provider that are not password protected, this is a finding.'\n  desc 'fix', 'From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Security >> Key Providers.\n\nSelect the Native Key Provider, click \"Back-up\", and check the box \"Protect Native Key Provider data with password\".\n\nProvide a strong password and click \"Back up key provider\".\n\nDelete any previous backups that were not protected with a password.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 7.0 vCenter'\n  tag check_id: 'C-60049r885731_chk'\n  tag severity: 'medium'\n  tag gid: 'V-256374'\n  tag rid: 'SV-256374r919046_rule'\n  tag stig_id: 'VCSA-70-000294'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-59992r918994_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_7-0_vCenter_STIG_V1R2/controls/SV-256374.rb"},"title":"vCenter Native Key Providers must be backed up with a strong password.","desc":"The vCenter Native Key Provider feature was introduced in U2 and acts as a key provider for encryption-based capabilities, such as encrypted virtual machines without requiring an external KMS solution. When enabling this feature, a backup must be taken that is a PKCS#12 formatted file. If no password is provided during the backup process, this presents the opportunity for this to be used maliciously and compromise the environment.","descriptions":{"default":"The vCenter Native Key Provider feature was introduced in U2 and acts as a key provider for encryption-based capabilities, such as encrypted virtual machines without requiring an external KMS solution. When enabling this feature, a backup must be taken that is a PKCS#12 formatted file. If no password is provided during the backup process, this presents the opportunity for this to be used maliciously and compromise the environment.","check":"If the vCenter Native Key Provider feature is not in use, this is not applicable.\n\nInterview the system administrator and determine if a password was provided for any backups taken of the Native Key Provider.\n\nIf backups exist for the Native Key Provider that are not password protected, this is a finding.","fix":"From the vSphere Client, go to Host and Clusters.\n\nSelect a vCenter Server >> Configure >> Security >> Key Providers.\n\nSelect the Native Key Provider, click \"Back-up\", and check the box \"Protect Native Key Provider data with password\".\n\nProvide a strong password and click \"Back up key provider\".\n\nDelete any previous backups that were not protected with a password."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 7.0 vCenter"}],"tags":{"check_id":"C-60049r885731_chk","severity":"medium","gid":"V-256374","rid":"SV-256374r919046_rule","stig_id":"VCSA-70-000294","gtitle":"SRG-APP-000516","fix_id":"F-59992r918994_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}}],"groups":[{"id":"controls/SV-256318.rb","title":null,"controls":["SV-256318"]},{"id":"controls/SV-256319.rb","title":null,"controls":["SV-256319"]},{"id":"controls/SV-256320.rb","title":null,"controls":["SV-256320"]},{"id":"controls/SV-256321.rb","title":null,"controls":["SV-256321"]},{"id":"controls/SV-256322.rb","title":null,"controls":["SV-256322"]},{"id":"controls/SV-256323.rb","title":null,"controls":["SV-256323"]},{"id":"controls/SV-256324.rb","title":null,"controls":["SV-256324"]},{"id":"controls/SV-256325.rb","title":null,"controls":["SV-256325"]},{"id":"controls/SV-256326.rb","title":null,"controls":["SV-256326"]},{"id":"controls/SV-256327.rb","title":null,"controls":["SV-256327"]},{"id":"controls/SV-256328.rb","title":null,"controls":["SV-256328"]},{"id":"controls/SV-256329.rb","title":null,"controls":["SV-256329"]},{"id":"controls/SV-256330.rb","title":null,"controls":["SV-256330"]},{"id":"controls/SV-256331.rb","title":null,"controls":["SV-256331"]},{"id":"controls/SV-256332.rb","title":null,"controls":["SV-256332"]},{"id":"controls/SV-256333.rb","title":null,"controls":["SV-256333"]},{"id":"controls/SV-256334.rb","title":null,"controls":["SV-256334"]},{"id":"controls/SV-256335.rb","title":null,"controls":["SV-256335"]},{"id":"controls/SV-256336.rb","title":null,"controls":["SV-256336"]},{"id":"controls/SV-256337.rb","title":null,"controls":["SV-256337"]},{"id":"controls/SV-256338.rb","title":null,"controls":["SV-256338"]},{"id":"controls/SV-256339.rb","title":null,"controls":["SV-256339"]},{"id":"controls/SV-256340.rb","title":null,"controls":["SV-256340"]},{"id":"controls/SV-256341.rb","title":null,"controls":["SV-256341"]},{"id":"controls/SV-256342.rb","title":null,"controls":["SV-256342"]},{"id":"controls/SV-256343.rb","title":null,"controls":["SV-256343"]},{"id":"controls/SV-256344.rb","title":null,"controls":["SV-256344"]},{"id":"controls/SV-256345.rb","title":null,"controls":["SV-256345"]},{"id":"controls/SV-256346.rb","title":null,"controls":["SV-256346"]},{"id":"controls/SV-256347.rb","title":null,"controls":["SV-256347"]},{"id":"controls/SV-256348.rb","title":null,"controls":["SV-256348"]},{"id":"controls/SV-256349.rb","title":null,"controls":["SV-256349"]},{"id":"controls/SV-256350.rb","title":null,"controls":["SV-256350"]},{"id":"controls/SV-256351.rb","title":null,"controls":["SV-256351"]},{"id":"controls/SV-256352.rb","title":null,"controls":["SV-256352"]},{"id":"controls/SV-256353.rb","title":null,"controls":["SV-256353"]},{"id":"controls/SV-256354.rb","title":null,"controls":["SV-256354"]},{"id":"controls/SV-256355.rb","title":null,"controls":["SV-256355"]},{"id":"controls/SV-256356.rb","title":null,"controls":["SV-256356"]},{"id":"controls/SV-256357.rb","title":null,"controls":["SV-256357"]},{"id":"controls/SV-256358.rb","title":null,"controls":["SV-256358"]},{"id":"controls/SV-256359.rb","title":null,"controls":["SV-256359"]},{"id":"controls/SV-256360.rb","title":null,"controls":["SV-256360"]},{"id":"controls/SV-256361.rb","title":null,"controls":["SV-256361"]},{"id":"controls/SV-256362.rb","title":null,"controls":["SV-256362"]},{"id":"controls/SV-256363.rb","title":null,"controls":["SV-256363"]},{"id":"controls/SV-256364.rb","title":null,"controls":["SV-256364"]},{"id":"controls/SV-256365.rb","title":null,"controls":["SV-256365"]},{"id":"controls/SV-256366.rb","title":null,"controls":["SV-256366"]},{"id":"controls/SV-256367.rb","title":null,"controls":["SV-256367"]},{"id":"controls/SV-256368.rb","title":null,"controls":["SV-256368"]},{"id":"controls/SV-256369.rb","title":null,"controls":["SV-256369"]},{"id":"controls/SV-256370.rb","title":null,"controls":["SV-256370"]},{"id":"controls/SV-256371.rb","title":null,"controls":["SV-256371"]},{"id":"controls/SV-256372.rb","title":null,"controls":["SV-256372"]},{"id":"controls/SV-256373.rb","title":null,"controls":["SV-256373"]},{"id":"controls/SV-256374.rb","title":null,"controls":["SV-256374"]}],"name":"VMW_vSphere_7-0_vCenter_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"1c401471f4fee9a1761df279b8525da4480899cc11511b83e9afafa148983041","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
