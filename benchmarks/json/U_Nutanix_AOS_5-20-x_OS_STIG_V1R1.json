{"controls":[{"id":"SV-254120","code":"control 'SV-254120' do\n  title 'Nutanix AOS must limit the number of concurrent sessions to ten for all accounts and/or account types.'\n  desc 'Operating system management includes the ability to control the number of users and user sessions that utilize an operating system. Limiting the number of allowed users and sessions per user is helpful in reducing the risks related to DoS attacks.\n\nThis requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions must be defined based upon mission needs and the operational environment for each system.'\n  desc 'check', 'Verify Nutanix AOS limits the number of concurrent sessions to \"10\" or less for all accounts and/or account types by issuing the following command:\n\n$ sudo grep \"maxlogins\" /etc/security/limits.conf \n\nIf the line * hard maxlogins 10, is missing or set to a number more than 10, this is a finding.'\n  desc 'fix', 'Modify the file /etc/security/limits.conf and add the line * hard maxlogins 10 or set the number to less than or equal to 10.'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57605r846446_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254120'\n  tag rid: 'SV-254120r846448_rule'\n  tag stig_id: 'NUTX-OS-000010'\n  tag gtitle: 'SRG-OS-000027-GPOS-00008'\n  tag fix_id: 'F-57556r846447_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254120.rb"},"title":"Nutanix AOS must limit the number of concurrent sessions to ten for all accounts and/or account types.","desc":"Operating system management includes the ability to control the number of users and user sessions that utilize an operating system. Limiting the number of allowed users and sessions per user is helpful in reducing the risks related to DoS attacks.\n\nThis requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions must be defined based upon mission needs and the operational environment for each system.","descriptions":{"default":"Operating system management includes the ability to control the number of users and user sessions that utilize an operating system. Limiting the number of allowed users and sessions per user is helpful in reducing the risks related to DoS attacks.\n\nThis requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions must be defined based upon mission needs and the operational environment for each system.","check":"Verify Nutanix AOS limits the number of concurrent sessions to \"10\" or less for all accounts and/or account types by issuing the following command:\n\n$ sudo grep \"maxlogins\" /etc/security/limits.conf \n\nIf the line * hard maxlogins 10, is missing or set to a number more than 10, this is a finding.","fix":"Modify the file /etc/security/limits.conf and add the line * hard maxlogins 10 or set the number to less than or equal to 10."},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57605r846446_chk","severity":"medium","gid":"V-254120","rid":"SV-254120r846448_rule","stig_id":"NUTX-OS-000010","gtitle":"SRG-OS-000027-GPOS-00008","fix_id":"F-57556r846447_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-254121","code":"control 'SV-254121' do\n  title 'Nutanix AOS must disconnect a session after 15 minutes of idle time for all connection types.'\n  desc 'A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence.\n\nThe session lock is implemented at the point where session activity can be determined. The operating system session lock event must include an obfuscation of the display screen so as to prevent other users from reading what was previously displayed.\n\nPublicly viewable images can include static or dynamic images, for example, patterns used with screen savers, photographic images, solid colors, a clock, a battery life indicator, or a blank screen, with the additional caveat that none of the images convey sensitive information.\n\n'\n  desc 'check', 'Confirm Nutanix AOS is configured for autologout after 15 minutes of idle time.\n\n$ sudo grep -i tmout /etc/profile.d/*\n/etc/profile.d/os-security.sh:readonly TMOUT=900\n\nIf \"TMOUT\" is not set to \"900\" or less in a script located in the /etc/profile.d/ directory to enforce session termination after inactivity, this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS for autologout of idle sessions by running the following commands.\n\n$ sudo salt-call state.sls security/CVM/shellCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57606r846449_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254121'\n  tag rid: 'SV-254121r846451_rule'\n  tag stig_id: 'NUTX-OS-000020'\n  tag gtitle: 'SRG-OS-000029-GPOS-00010'\n  tag fix_id: 'F-57557r846450_fix'\n  tag satisfies: ['SRG-OS-000029-GPOS-00010', 'SRG-OS-000030-GPOS-00011', 'SRG-OS-000031-GPOS-00012']\n  tag 'documentable'\n  tag cci: ['CCI-000057', 'CCI-000058', 'CCI-000060']\n  tag nist: ['AC-11 a', 'AC-11 a', 'AC-11 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254121.rb"},"title":"Nutanix AOS must disconnect a session after 15 minutes of idle time for all connection types.","desc":"A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence.\n\nThe session lock is implemented at the point where session activity can be determined. The operating system session lock event must include an obfuscation of the display screen so as to prevent other users from reading what was previously displayed.\n\nPublicly viewable images can include static or dynamic images, for example, patterns used with screen savers, photographic images, solid colors, a clock, a battery life indicator, or a blank screen, with the additional caveat that none of the images convey sensitive information.\n\n","descriptions":{"default":"A session lock is a temporary action taken when a user stops work and moves away from the immediate physical vicinity of the information system but does not log out because of the temporary nature of the absence.\n\nThe session lock is implemented at the point where session activity can be determined. The operating system session lock event must include an obfuscation of the display screen so as to prevent other users from reading what was previously displayed.\n\nPublicly viewable images can include static or dynamic images, for example, patterns used with screen savers, photographic images, solid colors, a clock, a battery life indicator, or a blank screen, with the additional caveat that none of the images convey sensitive information.\n\n","check":"Confirm Nutanix AOS is configured for autologout after 15 minutes of idle time.\n\n$ sudo grep -i tmout /etc/profile.d/*\n/etc/profile.d/os-security.sh:readonly TMOUT=900\n\nIf \"TMOUT\" is not set to \"900\" or less in a script located in the /etc/profile.d/ directory to enforce session termination after inactivity, this is a finding.","fix":"Configure Nutanix AOS for autologout of idle sessions by running the following commands.\n\n$ sudo salt-call state.sls security/CVM/shellCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57606r846449_chk","severity":"medium","gid":"V-254121","rid":"SV-254121r846451_rule","stig_id":"NUTX-OS-000020","gtitle":"SRG-OS-000029-GPOS-00010","fix_id":"F-57557r846450_fix","satisfies":["SRG-OS-000029-GPOS-00010","SRG-OS-000030-GPOS-00011","SRG-OS-000031-GPOS-00012"],"documentable":null,"cci":["CCI-000057","CCI-000058","CCI-000060"],"nist":["AC-11 a","AC-11 a","AC-11 (1)"]}},{"id":"SV-254122","code":"control 'SV-254122' do\n  title 'Nutanix AOS must automatically terminate a user session after inactivity time-outs have expired or at shutdown.'\n  desc \"Automatic session termination addresses the termination of user-initiated logical sessions in contrast to the termination of network connections associated with communications sessions (i.e., network disconnect). A logical session (for local, network, and remote access) is initiated whenever a user (or process acting on behalf of a user) accesses an organizational information system. Such user sessions can be terminated (and thus terminate user access) without terminating network sessions.\n\nSession termination terminates all processes associated with a user's logical session except those processes that are specifically created by the user (i.e., session owner) to continue after the session is terminated.\n\nConditions or trigger events requiring automatic session termination can include, for example, organization-defined periods of user inactivity, targeted responses to certain types of incidents, and time-of-day restrictions on information system use.\n\nThis capability is typically reserved for specific operating system functionality where the system owner, data owner, or organization requires additional assurance.\n\n\"\n  desc 'check', 'Confirm Nutanix AOS is configured to auto disconnect remote session to prevent session hijacking.\n\n$ sudo grep -i clientalive /etc/ssh/sshd_config\nClientAliveInterval 600\nClientAliveCountMax 0\n\nIf ClientAliveInterval is not \"600\" and ClientAliveCountMax is not \"0\", this is a finding.'\n  desc 'fix', 'Configure SSH to terminate remote sessions to prevent session hijacking by running the following command.\n\n$ sudo salt-call state.sls security/CVM/sshdCVM\n\nThe SSH service will need to be restarted for the changes to take effect:\n\n$ sudo systemctl restart sshd'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57607r846452_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254122'\n  tag rid: 'SV-254122r846454_rule'\n  tag stig_id: 'NUTX-OS-000050'\n  tag gtitle: 'SRG-OS-000279-GPOS-00109'\n  tag fix_id: 'F-57558r846453_fix'\n  tag satisfies: ['SRG-OS-000279-GPOS-00109', 'SRG-OS-000126-GPOS-00066', 'SRG-OS-000163-GPOS-00072']\n  tag 'documentable'\n  tag cci: ['CCI-000879', 'CCI-001133', 'CCI-002361']\n  tag nist: ['MA-4 e', 'SC-10', 'AC-12']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254122.rb"},"title":"Nutanix AOS must automatically terminate a user session after inactivity time-outs have expired or at shutdown.","desc":"Automatic session termination addresses the termination of user-initiated logical sessions in contrast to the termination of network connections associated with communications sessions (i.e., network disconnect). A logical session (for local, network, and remote access) is initiated whenever a user (or process acting on behalf of a user) accesses an organizational information system. Such user sessions can be terminated (and thus terminate user access) without terminating network sessions.\n\nSession termination terminates all processes associated with a user's logical session except those processes that are specifically created by the user (i.e., session owner) to continue after the session is terminated.\n\nConditions or trigger events requiring automatic session termination can include, for example, organization-defined periods of user inactivity, targeted responses to certain types of incidents, and time-of-day restrictions on information system use.\n\nThis capability is typically reserved for specific operating system functionality where the system owner, data owner, or organization requires additional assurance.\n\n","descriptions":{"default":"Automatic session termination addresses the termination of user-initiated logical sessions in contrast to the termination of network connections associated with communications sessions (i.e., network disconnect). A logical session (for local, network, and remote access) is initiated whenever a user (or process acting on behalf of a user) accesses an organizational information system. Such user sessions can be terminated (and thus terminate user access) without terminating network sessions.\n\nSession termination terminates all processes associated with a user's logical session except those processes that are specifically created by the user (i.e., session owner) to continue after the session is terminated.\n\nConditions or trigger events requiring automatic session termination can include, for example, organization-defined periods of user inactivity, targeted responses to certain types of incidents, and time-of-day restrictions on information system use.\n\nThis capability is typically reserved for specific operating system functionality where the system owner, data owner, or organization requires additional assurance.\n\n","check":"Confirm Nutanix AOS is configured to auto disconnect remote session to prevent session hijacking.\n\n$ sudo grep -i clientalive /etc/ssh/sshd_config\nClientAliveInterval 600\nClientAliveCountMax 0\n\nIf ClientAliveInterval is not \"600\" and ClientAliveCountMax is not \"0\", this is a finding.","fix":"Configure SSH to terminate remote sessions to prevent session hijacking by running the following command.\n\n$ sudo salt-call state.sls security/CVM/sshdCVM\n\nThe SSH service will need to be restarted for the changes to take effect:\n\n$ sudo systemctl restart sshd"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57607r846452_chk","severity":"medium","gid":"V-254122","rid":"SV-254122r846454_rule","stig_id":"NUTX-OS-000050","gtitle":"SRG-OS-000279-GPOS-00109","fix_id":"F-57558r846453_fix","satisfies":["SRG-OS-000279-GPOS-00109","SRG-OS-000126-GPOS-00066","SRG-OS-000163-GPOS-00072"],"documentable":null,"cci":["CCI-000879","CCI-001133","CCI-002361"],"nist":["MA-4 e","SC-10","AC-12"]}},{"id":"SV-254123","code":"control 'SV-254123' do\n  title 'Nutanix AOS must monitor remote access methods.'\n  desc 'Remote access services, such as those providing remote access to network devices and information systems, which lack automated monitoring capabilities, increase risk and make remote user access management difficult at best.\n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nAutomated monitoring of remote access sessions allows organizations to detect cyberattacks and also ensure ongoing compliance with remote access policies by auditing connection activities of remote access capabilities, such as Remote Desktop Protocol (RDP), on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).'\n  desc 'check', 'Confirm Nutanix AOS monitors remote access methods.\n\n$ sudo grep -i loglevel /etc/ssh/sshd_config\n\nIf the LogLevel is not set to \"VERBOSE\", this is a finding.'\n  desc 'fix', 'Configure SSH to verbosely log connection attempts and failed logon attempts to the operating system by running the following command.\n\n$ sudo salt-call state.sls security/CVM/sshdCVM\n\nThe SSH service will need to be restarted for the changes to take effect:\n\n$ sudo systemctl restart sshd'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57608r846455_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254123'\n  tag rid: 'SV-254123r846457_rule'\n  tag stig_id: 'NUTX-OS-000060'\n  tag gtitle: 'SRG-OS-000032-GPOS-00013'\n  tag fix_id: 'F-57559r846456_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000067']\n  tag nist: ['AC-17 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254123.rb"},"title":"Nutanix AOS must monitor remote access methods.","desc":"Remote access services, such as those providing remote access to network devices and information systems, which lack automated monitoring capabilities, increase risk and make remote user access management difficult at best.\n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nAutomated monitoring of remote access sessions allows organizations to detect cyberattacks and also ensure ongoing compliance with remote access policies by auditing connection activities of remote access capabilities, such as Remote Desktop Protocol (RDP), on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).","descriptions":{"default":"Remote access services, such as those providing remote access to network devices and information systems, which lack automated monitoring capabilities, increase risk and make remote user access management difficult at best.\n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nAutomated monitoring of remote access sessions allows organizations to detect cyberattacks and also ensure ongoing compliance with remote access policies by auditing connection activities of remote access capabilities, such as Remote Desktop Protocol (RDP), on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).","check":"Confirm Nutanix AOS monitors remote access methods.\n\n$ sudo grep -i loglevel /etc/ssh/sshd_config\n\nIf the LogLevel is not set to \"VERBOSE\", this is a finding.","fix":"Configure SSH to verbosely log connection attempts and failed logon attempts to the operating system by running the following command.\n\n$ sudo salt-call state.sls security/CVM/sshdCVM\n\nThe SSH service will need to be restarted for the changes to take effect:\n\n$ sudo systemctl restart sshd"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57608r846455_chk","severity":"medium","gid":"V-254123","rid":"SV-254123r846457_rule","stig_id":"NUTX-OS-000060","gtitle":"SRG-OS-000032-GPOS-00013","fix_id":"F-57559r846456_fix","documentable":null,"cci":["CCI-000067"],"nist":["AC-17 (1)"]}},{"id":"SV-254124","code":"control 'SV-254124' do\n  title 'Nutanix AOS must control remote access methods.'\n  desc 'Remote access services, such as those providing remote access to network devices and information systems, which lack automated control capabilities, increase risk and make remote user access management difficult at best.\n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nOperating system functionality (e.g., RDP) must be capable of taking enforcement action if the audit reveals unauthorized activity. Automated control of remote access sessions allows organizations to ensure ongoing compliance with remote access policies by enforcing connection rules of remote access applications on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).'\n  desc 'check', 'Confirm Nutanix AOS prohibits or restricts the use of remote access methods, using the iptables firewall service.\n\n$ sudo service iptables status\niptables.service - IPv4 firewall with iptables\n   Loaded: loaded (/usr/lib/systemd/system/iptables.service; enabled; vendor preset: disabled)\n   Active: active (exited) since Mon 2021-08-02 15:02:12 CDT; 2 weeks 6 days ago\n Main PID: 1250 (code=exited, status=0/SUCCESS)\n   CGroup: /system.slice/iptables.service\n\nIf IPv6 is in use:\n$ sudo service ip6tables status\nip6tables.service - IPv6 firewall with ip6tables\n   Loaded: loaded (/usr/lib/systemd/system/ip6tables.service; enabled; vendor preset: disabled)\n   Active: active (exited) since Mon 2021-08-02 15:02:12 CDT; 2 weeks 6 days ago\n Main PID: 1313 (code=exited, status=0/SUCCESS)\n   CGroup: /system.slice/ip6tables.service\n\nIf no iptables services are \"Loaded\" and \"Active\", this is a finding.'\n  desc 'fix', 'Configure the system to restrict the use of remote access methods by running the following command.\n\n$ sudo salt-call state.sls security/CVM/iptables/init'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57609r846458_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254124'\n  tag rid: 'SV-254124r846460_rule'\n  tag stig_id: 'NUTX-OS-000070'\n  tag gtitle: 'SRG-OS-000297-GPOS-00115'\n  tag fix_id: 'F-57560r846459_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002314']\n  tag nist: ['AC-17 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254124.rb"},"title":"Nutanix AOS must control remote access methods.","desc":"Remote access services, such as those providing remote access to network devices and information systems, which lack automated control capabilities, increase risk and make remote user access management difficult at best.\n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nOperating system functionality (e.g., RDP) must be capable of taking enforcement action if the audit reveals unauthorized activity. Automated control of remote access sessions allows organizations to ensure ongoing compliance with remote access policies by enforcing connection rules of remote access applications on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).","descriptions":{"default":"Remote access services, such as those providing remote access to network devices and information systems, which lack automated control capabilities, increase risk and make remote user access management difficult at best.\n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nOperating system functionality (e.g., RDP) must be capable of taking enforcement action if the audit reveals unauthorized activity. Automated control of remote access sessions allows organizations to ensure ongoing compliance with remote access policies by enforcing connection rules of remote access applications on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).","check":"Confirm Nutanix AOS prohibits or restricts the use of remote access methods, using the iptables firewall service.\n\n$ sudo service iptables status\niptables.service - IPv4 firewall with iptables\n   Loaded: loaded (/usr/lib/systemd/system/iptables.service; enabled; vendor preset: disabled)\n   Active: active (exited) since Mon 2021-08-02 15:02:12 CDT; 2 weeks 6 days ago\n Main PID: 1250 (code=exited, status=0/SUCCESS)\n   CGroup: /system.slice/iptables.service\n\nIf IPv6 is in use:\n$ sudo service ip6tables status\nip6tables.service - IPv6 firewall with ip6tables\n   Loaded: loaded (/usr/lib/systemd/system/ip6tables.service; enabled; vendor preset: disabled)\n   Active: active (exited) since Mon 2021-08-02 15:02:12 CDT; 2 weeks 6 days ago\n Main PID: 1313 (code=exited, status=0/SUCCESS)\n   CGroup: /system.slice/ip6tables.service\n\nIf no iptables services are \"Loaded\" and \"Active\", this is a finding.","fix":"Configure the system to restrict the use of remote access methods by running the following command.\n\n$ sudo salt-call state.sls security/CVM/iptables/init"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57609r846458_chk","severity":"medium","gid":"V-254124","rid":"SV-254124r846460_rule","stig_id":"NUTX-OS-000070","gtitle":"SRG-OS-000297-GPOS-00115","fix_id":"F-57560r846459_fix","documentable":null,"cci":["CCI-002314"],"nist":["AC-17 (1)"]}},{"id":"SV-254125","code":"control 'SV-254125' do\n  title 'Nutanix AOS must implement DoD-approved encryption to protect the confidentiality of remote access sessions.'\n  desc 'Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session.\n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nEncryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection (e.g., RDP), thereby providing a degree of confidentiality. The encryption strength of a mechanism is selected based on the security categorization of the information.\n\n'\n  desc 'check', 'Inspect the \"Ciphers\" configuration with the following command:\n\n$ sudo grep -i ciphers /etc/ssh/sshd_config\nCiphers aes256-ctr\n\nIf any ciphers other than \"aes256-ctr\" are listed, the \"Ciphers\" keyword is missing, or the returned line is commented out, this is a finding.'\n  desc 'fix', 'Configure SSH to use only DoD approved ciphers by running the following command.\n\n$ sudo salt-call state.sls security/CVM/sshdCVM\n\nThe SSH service will need to be restarted for the changes to take effect:\n\n$ sudo systemctl restart sshd'\n  impact 0.7\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57610r846461_chk'\n  tag severity: 'high'\n  tag gid: 'V-254125'\n  tag rid: 'SV-254125r846463_rule'\n  tag stig_id: 'NUTX-OS-000080'\n  tag gtitle: 'SRG-OS-000033-GPOS-00014'\n  tag fix_id: 'F-57561r846462_fix'\n  tag satisfies: ['SRG-OS-000033-GPOS-00014', 'SRG-OS-000250-GPOS-00093', 'SRG-OS-000393-GPOS-00173', 'SRG-OS-000394-GPOS-00174', 'SRG-OS-000125-GPOS-00065', 'SRG-OS-000424-GPOS-00188']\n  tag 'documentable'\n  tag cci: ['CCI-000068', 'CCI-000877', 'CCI-001453', 'CCI-002421', 'CCI-002890', 'CCI-003123']\n  tag nist: ['AC-17 (2)', 'MA-4 c', 'AC-17 (2)', 'SC-8 (1)', 'MA-4 (6)', 'MA-4 (6)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254125.rb"},"title":"Nutanix AOS must implement DoD-approved encryption to protect the confidentiality of remote access sessions.","desc":"Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session.\n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nEncryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection (e.g., RDP), thereby providing a degree of confidentiality. The encryption strength of a mechanism is selected based on the security categorization of the information.\n\n","descriptions":{"default":"Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session.\n\nRemote access is access to DoD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nEncryption provides a means to secure the remote connection to prevent unauthorized access to the data traversing the remote access connection (e.g., RDP), thereby providing a degree of confidentiality. The encryption strength of a mechanism is selected based on the security categorization of the information.\n\n","check":"Inspect the \"Ciphers\" configuration with the following command:\n\n$ sudo grep -i ciphers /etc/ssh/sshd_config\nCiphers aes256-ctr\n\nIf any ciphers other than \"aes256-ctr\" are listed, the \"Ciphers\" keyword is missing, or the returned line is commented out, this is a finding.","fix":"Configure SSH to use only DoD approved ciphers by running the following command.\n\n$ sudo salt-call state.sls security/CVM/sshdCVM\n\nThe SSH service will need to be restarted for the changes to take effect:\n\n$ sudo systemctl restart sshd"},"impact":0.7,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57610r846461_chk","severity":"high","gid":"V-254125","rid":"SV-254125r846463_rule","stig_id":"NUTX-OS-000080","gtitle":"SRG-OS-000033-GPOS-00014","fix_id":"F-57561r846462_fix","satisfies":["SRG-OS-000033-GPOS-00014","SRG-OS-000250-GPOS-00093","SRG-OS-000393-GPOS-00173","SRG-OS-000394-GPOS-00174","SRG-OS-000125-GPOS-00065","SRG-OS-000424-GPOS-00188"],"documentable":null,"cci":["CCI-000068","CCI-000877","CCI-001453","CCI-002421","CCI-002890","CCI-003123"],"nist":["AC-17 (2)","MA-4 c","AC-17 (2)","SC-8 (1)","MA-4 (6)","MA-4 (6)"]}},{"id":"SV-254126","code":"control 'SV-254126' do\n  title 'Nutanix AOS must automatically remove or disable temporary user accounts after 72 hours.'\n  desc 'If temporary user accounts remain active when no longer needed or for an excessive period, these accounts may be used to gain unauthorized access. To mitigate this risk, automated termination of all temporary accounts must be set upon account creation.\n\nTemporary accounts are established as part of normal account activation procedures when there is a need for short-term accounts without the demand for immediacy in account activation.\n\nIf temporary accounts are used, the operating system must be configured to automatically terminate these types of accounts after a DoD-defined time period of 72 hours.\n\nTo address access requirements, many operating systems may be integrated with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements.\n\n'\n  desc 'check', 'Nutanix AOS does not natively support temporary user accounts, named or otherwise. However, if temporary accounts are created, they must be configured to automatically terminate these types of accounts after a DoD-defined time period of 72 hours.\n\nVerify that temporary accounts have been provisioned with an expiration date of 72 hours.\n\nFor every existing temporary account, run the following command to obtain its account expiration information.\n\n$ sudo chage -l system_account_name\n\nVerify each of these accounts has an expiration date set within 72 hours.\n\nIf any temporary accounts have no expiration date set or do not expire within 72 hours, this is a finding.'\n  desc 'fix', 'Configure any temporary account(s) that have been created with an expiration date exceeding the DoD-defined time period of 72 hours by running the following command:\n\nsudo chage -E `date -d \"+3 days\" +%Y-%m-%d` system_account_name'\n  impact 0.3\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57611r846464_chk'\n  tag severity: 'low'\n  tag gid: 'V-254126'\n  tag rid: 'SV-254126r846466_rule'\n  tag stig_id: 'NUTX-OS-000100'\n  tag gtitle: 'SRG-OS-000002-GPOS-00002'\n  tag fix_id: 'F-57562r846465_fix'\n  tag satisfies: ['SRG-OS-000002-GPOS-00002', 'SRG-OS-000123-GPOS-00064']\n  tag 'documentable'\n  tag cci: ['CCI-000016', 'CCI-001682']\n  tag nist: ['AC-2 (2)', 'AC-2 (2)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254126.rb"},"title":"Nutanix AOS must automatically remove or disable temporary user accounts after 72 hours.","desc":"If temporary user accounts remain active when no longer needed or for an excessive period, these accounts may be used to gain unauthorized access. To mitigate this risk, automated termination of all temporary accounts must be set upon account creation.\n\nTemporary accounts are established as part of normal account activation procedures when there is a need for short-term accounts without the demand for immediacy in account activation.\n\nIf temporary accounts are used, the operating system must be configured to automatically terminate these types of accounts after a DoD-defined time period of 72 hours.\n\nTo address access requirements, many operating systems may be integrated with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements.\n\n","descriptions":{"default":"If temporary user accounts remain active when no longer needed or for an excessive period, these accounts may be used to gain unauthorized access. To mitigate this risk, automated termination of all temporary accounts must be set upon account creation.\n\nTemporary accounts are established as part of normal account activation procedures when there is a need for short-term accounts without the demand for immediacy in account activation.\n\nIf temporary accounts are used, the operating system must be configured to automatically terminate these types of accounts after a DoD-defined time period of 72 hours.\n\nTo address access requirements, many operating systems may be integrated with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements.\n\n","check":"Nutanix AOS does not natively support temporary user accounts, named or otherwise. However, if temporary accounts are created, they must be configured to automatically terminate these types of accounts after a DoD-defined time period of 72 hours.\n\nVerify that temporary accounts have been provisioned with an expiration date of 72 hours.\n\nFor every existing temporary account, run the following command to obtain its account expiration information.\n\n$ sudo chage -l system_account_name\n\nVerify each of these accounts has an expiration date set within 72 hours.\n\nIf any temporary accounts have no expiration date set or do not expire within 72 hours, this is a finding.","fix":"Configure any temporary account(s) that have been created with an expiration date exceeding the DoD-defined time period of 72 hours by running the following command:\n\nsudo chage -E `date -d \"+3 days\" +%Y-%m-%d` system_account_name"},"impact":0.3,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57611r846464_chk","severity":"low","gid":"V-254126","rid":"SV-254126r846466_rule","stig_id":"NUTX-OS-000100","gtitle":"SRG-OS-000002-GPOS-00002","fix_id":"F-57562r846465_fix","satisfies":["SRG-OS-000002-GPOS-00002","SRG-OS-000123-GPOS-00064"],"documentable":null,"cci":["CCI-000016","CCI-001682"],"nist":["AC-2 (2)","AC-2 (2)"]}},{"id":"SV-254127","code":"control 'SV-254127' do\n  title 'Nutanix AOS must audit all account actions.'\n  desc 'Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.\n\nTo address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.\n\n'\n  desc 'check', 'Verify Nutanix AOS is configured to audit all account creations.\n\nRun the following command to verify account creation and modification is audited.\n\n$ sudo auditctl -l | grep \"audit_account_changes\"\n\nIf the command does not return the following output, this is a finding.\n\n-w /etc/group -p wa -k audit_account_changes\n-w /etc/passwd -p wa -k audit_account_changes\n-w /etc/gshadow -p wa -k audit_account_changes\n-w /etc/shadow -p wa -k audit_account_changes\n-w /etc/security/opasswd -p wa -k audit_account_changes'\n  desc 'fix', 'Run the salt stack call to set the audit configuration to audit all account creation and modification.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57612r846467_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254127'\n  tag rid: 'SV-254127r846469_rule'\n  tag stig_id: 'NUTX-OS-000110'\n  tag gtitle: 'SRG-OS-000004-GPOS-00004'\n  tag fix_id: 'F-57563r846468_fix'\n  tag satisfies: ['SRG-OS-000004-GPOS-00004', 'SRG-OS-000239-GPOS-00089', 'SRG-OS-000240-GPOS-00090', 'SRG-OS-000241-GPOS-00091', 'SRG-OS-000303-GPOS-00120']\n  tag 'documentable'\n  tag cci: ['CCI-000018', 'CCI-001403', 'CCI-001404', 'CCI-001405', 'CCI-002130']\n  tag nist: ['AC-2 (4)', 'AC-2 (4)', 'AC-2 (4)', 'AC-2 (4)', 'AC-2 (4)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254127.rb"},"title":"Nutanix AOS must audit all account actions.","desc":"Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.\n\nTo address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.\n\n","descriptions":{"default":"Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.\n\nTo address access requirements, many operating systems may be integrated with enterprise level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.\n\n","check":"Verify Nutanix AOS is configured to audit all account creations.\n\nRun the following command to verify account creation and modification is audited.\n\n$ sudo auditctl -l | grep \"audit_account_changes\"\n\nIf the command does not return the following output, this is a finding.\n\n-w /etc/group -p wa -k audit_account_changes\n-w /etc/passwd -p wa -k audit_account_changes\n-w /etc/gshadow -p wa -k audit_account_changes\n-w /etc/shadow -p wa -k audit_account_changes\n-w /etc/security/opasswd -p wa -k audit_account_changes","fix":"Run the salt stack call to set the audit configuration to audit all account creation and modification.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57612r846467_chk","severity":"medium","gid":"V-254127","rid":"SV-254127r846469_rule","stig_id":"NUTX-OS-000110","gtitle":"SRG-OS-000004-GPOS-00004","fix_id":"F-57563r846468_fix","satisfies":["SRG-OS-000004-GPOS-00004","SRG-OS-000239-GPOS-00089","SRG-OS-000240-GPOS-00090","SRG-OS-000241-GPOS-00091","SRG-OS-000303-GPOS-00120"],"documentable":null,"cci":["CCI-000018","CCI-001403","CCI-001404","CCI-001405","CCI-002130"],"nist":["AC-2 (4)","AC-2 (4)","AC-2 (4)","AC-2 (4)","AC-2 (4)"]}},{"id":"SV-254128","code":"control 'SV-254128' do\n  title 'Nutanix AOS must be configured with an encrypted boot password for root.'\n  desc 'To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems (e.g., web servers and web portals) must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement.\n\nAccess control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system.'\n  desc 'check', 'Confirm Nutanix AOS is configured to enforce approved authorizations for logical access to information and system resources.\n\n$ sudo grep -i password /boot/grub/grub.conf\npassword [superusers-account] [password-hash]\n\nIf the root password entry does not begin with \"password\", this is a finding.\n\n$ sudo grep -i execstart /usr/lib/systemd/system/rescue.service | grep -i sulogin\nExecStart=-/bin/sh -c \"/usr/sbin/sulogin; /usr/bin/systemctl --fail --no-block default\"\n\nIf \"ExecStart\" does not have \"/usr/sbin/sulogin\" as an option, this is a finding.'\n  desc 'fix', %q(Configure the system to encrypt the boot password for root. \n\n1. Use the following command as root to generate a grub sha512 password hash: python -c 'import crypt; print crypt.crypt(\"password\", crypt.mksalt(crypt.METHOD_SHA512))' Replacing \"password\" with the password string desired for grub. \n\n2. Edit the /boot/grub/grub.conf file as root and add the following line above the title line: 'password --encrypted [password-hash]', replacing [password-hash] with the hash result of the python command output.)\n  impact 0.3\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57613r846470_chk'\n  tag severity: 'low'\n  tag gid: 'V-254128'\n  tag rid: 'SV-254128r846472_rule'\n  tag stig_id: 'NUTX-OS-000160'\n  tag gtitle: 'SRG-OS-000080-GPOS-00048'\n  tag fix_id: 'F-57564r846471_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000213']\n  tag nist: ['AC-3']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254128.rb"},"title":"Nutanix AOS must be configured with an encrypted boot password for root.","desc":"To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems (e.g., web servers and web portals) must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement.\n\nAccess control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system.","descriptions":{"default":"To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems (e.g., web servers and web portals) must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement.\n\nAccess control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system.","check":"Confirm Nutanix AOS is configured to enforce approved authorizations for logical access to information and system resources.\n\n$ sudo grep -i password /boot/grub/grub.conf\npassword [superusers-account] [password-hash]\n\nIf the root password entry does not begin with \"password\", this is a finding.\n\n$ sudo grep -i execstart /usr/lib/systemd/system/rescue.service | grep -i sulogin\nExecStart=-/bin/sh -c \"/usr/sbin/sulogin; /usr/bin/systemctl --fail --no-block default\"\n\nIf \"ExecStart\" does not have \"/usr/sbin/sulogin\" as an option, this is a finding.","fix":"Configure the system to encrypt the boot password for root. \n\n1. Use the following command as root to generate a grub sha512 password hash: python -c 'import crypt; print crypt.crypt(\"password\", crypt.mksalt(crypt.METHOD_SHA512))' Replacing \"password\" with the password string desired for grub. \n\n2. Edit the /boot/grub/grub.conf file as root and add the following line above the title line: 'password --encrypted [password-hash]', replacing [password-hash] with the hash result of the python command output."},"impact":0.3,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57613r846470_chk","severity":"low","gid":"V-254128","rid":"SV-254128r846472_rule","stig_id":"NUTX-OS-000160","gtitle":"SRG-OS-000080-GPOS-00048","fix_id":"F-57564r846471_fix","documentable":null,"cci":["CCI-000213"],"nist":["AC-3"]}},{"id":"SV-254129","code":"control 'SV-254129' do\n  title 'Nutanix AOS must enforce discretionary access control on symlinks and hardlinks.'\n  desc 'Discretionary Access Control (DAC) is based on the notion that individual users are \"owners\" of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment. DAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled file permissions.\n\nWhen discretionary access control policies are implemented, subjects are not constrained with regard to what actions they can take with information for which they have already been granted access. Thus, subjects that have been granted access to information are not prevented from passing (i.e., the subjects have the discretion to pass) the information to other subjects or objects. A subject that is constrained in its operation by Mandatory Access Control policies is still able to operate under the less rigorous constraints of this requirement. Thus, while Mandatory Access Control imposes constraints preventing a subject from passing information to another subject operating at a different sensitivity level, this requirement permits the subject to pass the information to any subject at the same sensitivity level. The policy is bounded by the information system boundary. Once the information is passed outside the control of the information system, additional means may be required to ensure the constraints remain in effect. While the older, more traditional definitions of discretionary access control require identity-based access control, that limitation is not required for this use of discretionary access control.\n\n'\n  desc 'check', 'Confirm Nutanix AOS enforces discretionary access control on symlinks and hardlinks.\n\n$ sudo sysctl fs.protected_symlinks\nfs.protected_symlinks = 1\n\nIf \"fs.protected_symlinks\" is not set to \"1\" or is missing, this is a finding.\n\nCheck the status of the fs.protected_hardlinks kernel parameter.\n\n$ sudo sysctl fs.protected_hardlinks\nfs.protected_hardlinks = 1\n\nIf \"fs.protected_hardlinks\" is not set to \"1\" or is missing, this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS to allow operating system admins to pass information to other operating system admins or users adding or modifying the following line(s) in the system configuration file /etc/syscrl.d/\n\nfs.protected_symlinks = 1\nfs.protected_hardlinks = 1\n\nLoad settings from all system configuration files with the following command:\n\n$ sudo sysctl --system'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57614r846473_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254129'\n  tag rid: 'SV-254129r846475_rule'\n  tag stig_id: 'NUTX-OS-000170'\n  tag gtitle: 'SRG-OS-000312-GPOS-00122'\n  tag fix_id: 'F-57565r846474_fix'\n  tag satisfies: ['SRG-OS-000312-GPOS-00122', 'SRG-OS-000312-GPOS-00123', 'SRG-OS-000312-GPOS-00124']\n  tag 'documentable'\n  tag cci: ['CCI-002165']\n  tag nist: ['AC-3 (4)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254129.rb"},"title":"Nutanix AOS must enforce discretionary access control on symlinks and hardlinks.","desc":"Discretionary Access Control (DAC) is based on the notion that individual users are \"owners\" of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment. DAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled file permissions.\n\nWhen discretionary access control policies are implemented, subjects are not constrained with regard to what actions they can take with information for which they have already been granted access. Thus, subjects that have been granted access to information are not prevented from passing (i.e., the subjects have the discretion to pass) the information to other subjects or objects. A subject that is constrained in its operation by Mandatory Access Control policies is still able to operate under the less rigorous constraints of this requirement. Thus, while Mandatory Access Control imposes constraints preventing a subject from passing information to another subject operating at a different sensitivity level, this requirement permits the subject to pass the information to any subject at the same sensitivity level. The policy is bounded by the information system boundary. Once the information is passed outside the control of the information system, additional means may be required to ensure the constraints remain in effect. While the older, more traditional definitions of discretionary access control require identity-based access control, that limitation is not required for this use of discretionary access control.\n\n","descriptions":{"default":"Discretionary Access Control (DAC) is based on the notion that individual users are \"owners\" of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment. DAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled file permissions.\n\nWhen discretionary access control policies are implemented, subjects are not constrained with regard to what actions they can take with information for which they have already been granted access. Thus, subjects that have been granted access to information are not prevented from passing (i.e., the subjects have the discretion to pass) the information to other subjects or objects. A subject that is constrained in its operation by Mandatory Access Control policies is still able to operate under the less rigorous constraints of this requirement. Thus, while Mandatory Access Control imposes constraints preventing a subject from passing information to another subject operating at a different sensitivity level, this requirement permits the subject to pass the information to any subject at the same sensitivity level. The policy is bounded by the information system boundary. Once the information is passed outside the control of the information system, additional means may be required to ensure the constraints remain in effect. While the older, more traditional definitions of discretionary access control require identity-based access control, that limitation is not required for this use of discretionary access control.\n\n","check":"Confirm Nutanix AOS enforces discretionary access control on symlinks and hardlinks.\n\n$ sudo sysctl fs.protected_symlinks\nfs.protected_symlinks = 1\n\nIf \"fs.protected_symlinks\" is not set to \"1\" or is missing, this is a finding.\n\nCheck the status of the fs.protected_hardlinks kernel parameter.\n\n$ sudo sysctl fs.protected_hardlinks\nfs.protected_hardlinks = 1\n\nIf \"fs.protected_hardlinks\" is not set to \"1\" or is missing, this is a finding.","fix":"Configure Nutanix AOS to allow operating system admins to pass information to other operating system admins or users adding or modifying the following line(s) in the system configuration file /etc/syscrl.d/\n\nfs.protected_symlinks = 1\nfs.protected_hardlinks = 1\n\nLoad settings from all system configuration files with the following command:\n\n$ sudo sysctl --system"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57614r846473_chk","severity":"medium","gid":"V-254129","rid":"SV-254129r846475_rule","stig_id":"NUTX-OS-000170","gtitle":"SRG-OS-000312-GPOS-00122","fix_id":"F-57565r846474_fix","satisfies":["SRG-OS-000312-GPOS-00122","SRG-OS-000312-GPOS-00123","SRG-OS-000312-GPOS-00124"],"documentable":null,"cci":["CCI-002165"],"nist":["AC-3 (4)"]}},{"id":"SV-254130","code":"control 'SV-254130' do\n  title 'Nutanix AOS must audit the execution of privileged functions.'\n  desc 'Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.'\n  desc 'check', 'Confirm Nutanix AOS is configured to audit the misuse of privileged commands.\n\n$ sudo grep -iw execve /etc/audit/audit.rules\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k setuid\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k setuid\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k setgid\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k setgid\n\nIf both the \"b32\" and \"b64\" audit rules for \"SUID\" files are not defined, this is a finding.\n\nIf both the \"b32\" and \"b64\" audit rules for \"SGID\" files are not defined, this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS to audit the misuse of privileged commands by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57615r846476_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254130'\n  tag rid: 'SV-254130r846478_rule'\n  tag stig_id: 'NUTX-OS-000210'\n  tag gtitle: 'SRG-OS-000327-GPOS-00127'\n  tag fix_id: 'F-57566r846477_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002234']\n  tag nist: ['AC-6 (9)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254130.rb"},"title":"Nutanix AOS must audit the execution of privileged functions.","desc":"Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.","descriptions":{"default":"Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.","check":"Confirm Nutanix AOS is configured to audit the misuse of privileged commands.\n\n$ sudo grep -iw execve /etc/audit/audit.rules\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k setuid\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k setuid\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k setgid\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k setgid\n\nIf both the \"b32\" and \"b64\" audit rules for \"SUID\" files are not defined, this is a finding.\n\nIf both the \"b32\" and \"b64\" audit rules for \"SGID\" files are not defined, this is a finding.","fix":"Configure Nutanix AOS to audit the misuse of privileged commands by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57615r846476_chk","severity":"medium","gid":"V-254130","rid":"SV-254130r846478_rule","stig_id":"NUTX-OS-000210","gtitle":"SRG-OS-000327-GPOS-00127","fix_id":"F-57566r846477_fix","documentable":null,"cci":["CCI-002234"],"nist":["AC-6 (9)"]}},{"id":"SV-254131","code":"control 'SV-254131' do\n  title 'Nutanix AOS must enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period.'\n  desc 'By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\n'\n  desc 'check', 'Confirm that Nutanix AOS locks an account for a minimum of 15 minutes after three unsuccessful logon attempts within a period of 15 minutes with the following command:\n\n$ sudo grep pam_faillock.so /etc/pam.d/password-auth\n\nauth        required      pam_faillock.so preauth silent audit deny=3 even_deny_root unlock_time=900 root_unlock_time=900 fail_interval=900\nauth        [default=die] pam_faillock.so authfail audit deny=3 even_deny_root unlock_time=900 root_unlock_time=900 fail_interval=900\n\nIf the \"deny\" parameter is set to \"0\" or a value greater than \"3\" on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"even_deny_root\" parameter is not set on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"fail_interval\" parameter is set to \"0\" or is set to a value less than \"900\" on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"unlock_time\" parameter is not set to \"0\", \"never\", or is set to a value less than \"900\" on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nNote: The maximum configurable value for \"unlock_time\" is \"604800\".\n\nIf any line referencing the \"pam_faillock.so\" module is commented out, this is a finding.\n\n$ sudo grep pam_faillock.so /etc/pam.d/system-auth\n\nauth required pam_faillock.so preauth silent audit deny=3 even_deny_root fail_interval=900 unlock_time=900\nauth [default=die] pam_faillock.so authfail audit deny=3 even_deny_root fail_interval=900 unlock_time=900\naccount required pam_faillock.so\n\nIf the \"deny\" parameter is set to \"0\" or a value greater than \"3\" on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"even_deny_root\" parameter is not set on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"fail_interval\" parameter is set to \"0\" or is set to a value less than \"900\" on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"unlock_time\" parameter is not set to \"0\", \"never\", or is set to a value less than \"900\" on both \"auth\" lines with the \"pam_faillock.so\" module or is missing from these lines, this is a finding.\n\nNote: The maximum configurable value for \"unlock_time\" is \"604800\".\n\nIf any line referencing the \"pam_faillock.so\" module is commented out, this is a finding.'\n  desc 'fix', 'Configure the pam.d modules to comply with the locking an account for a minimum of 15 minutes after three unsuccessful logon attempts within a period of 15 minutes with the following command:\n\n1. Enable high-strength passwords:\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true\n\n2. After enabling the high-strength passwords, the system will process the salt stack to enable the DoD versions of the pam.d files. Recheck the Check Text for compliance.  \n\nTo run the salt command manually to enable the pam.d auth files, run the following command (high-strength passwords must be set to true):\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57616r846479_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254131'\n  tag rid: 'SV-254131r846481_rule'\n  tag stig_id: 'NUTX-OS-000220'\n  tag gtitle: 'SRG-OS-000021-GPOS-00005'\n  tag fix_id: 'F-57567r846480_fix'\n  tag satisfies: ['SRG-OS-000021-GPOS-00005', 'SRG-OS-000329-GPOS-00128']\n  tag 'documentable'\n  tag cci: ['CCI-000044', 'CCI-002238']\n  tag nist: ['AC-7 a', 'AC-7 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254131.rb"},"title":"Nutanix AOS must enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period.","desc":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\n","descriptions":{"default":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\n","check":"Confirm that Nutanix AOS locks an account for a minimum of 15 minutes after three unsuccessful logon attempts within a period of 15 minutes with the following command:\n\n$ sudo grep pam_faillock.so /etc/pam.d/password-auth\n\nauth        required      pam_faillock.so preauth silent audit deny=3 even_deny_root unlock_time=900 root_unlock_time=900 fail_interval=900\nauth        [default=die] pam_faillock.so authfail audit deny=3 even_deny_root unlock_time=900 root_unlock_time=900 fail_interval=900\n\nIf the \"deny\" parameter is set to \"0\" or a value greater than \"3\" on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"even_deny_root\" parameter is not set on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"fail_interval\" parameter is set to \"0\" or is set to a value less than \"900\" on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"unlock_time\" parameter is not set to \"0\", \"never\", or is set to a value less than \"900\" on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nNote: The maximum configurable value for \"unlock_time\" is \"604800\".\n\nIf any line referencing the \"pam_faillock.so\" module is commented out, this is a finding.\n\n$ sudo grep pam_faillock.so /etc/pam.d/system-auth\n\nauth required pam_faillock.so preauth silent audit deny=3 even_deny_root fail_interval=900 unlock_time=900\nauth [default=die] pam_faillock.so authfail audit deny=3 even_deny_root fail_interval=900 unlock_time=900\naccount required pam_faillock.so\n\nIf the \"deny\" parameter is set to \"0\" or a value greater than \"3\" on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"even_deny_root\" parameter is not set on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"fail_interval\" parameter is set to \"0\" or is set to a value less than \"900\" on both \"auth\" lines with the \"pam_faillock.so\" module, or is missing from these lines, this is a finding.\n\nIf the \"unlock_time\" parameter is not set to \"0\", \"never\", or is set to a value less than \"900\" on both \"auth\" lines with the \"pam_faillock.so\" module or is missing from these lines, this is a finding.\n\nNote: The maximum configurable value for \"unlock_time\" is \"604800\".\n\nIf any line referencing the \"pam_faillock.so\" module is commented out, this is a finding.","fix":"Configure the pam.d modules to comply with the locking an account for a minimum of 15 minutes after three unsuccessful logon attempts within a period of 15 minutes with the following command:\n\n1. Enable high-strength passwords:\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true\n\n2. After enabling the high-strength passwords, the system will process the salt stack to enable the DoD versions of the pam.d files. Recheck the Check Text for compliance.  \n\nTo run the salt command manually to enable the pam.d auth files, run the following command (high-strength passwords must be set to true):\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57616r846479_chk","severity":"medium","gid":"V-254131","rid":"SV-254131r846481_rule","stig_id":"NUTX-OS-000220","gtitle":"SRG-OS-000021-GPOS-00005","fix_id":"F-57567r846480_fix","satisfies":["SRG-OS-000021-GPOS-00005","SRG-OS-000329-GPOS-00128"],"documentable":null,"cci":["CCI-000044","CCI-002238"],"nist":["AC-7 a","AC-7 b"]}},{"id":"SV-254132","code":"control 'SV-254132' do\n  title 'Nutanix AOS must be configured to display the Standard Mandatory DoD Notice and Consent Banner before granting access.'\n  desc %q(Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with applicable DoD policy. Use the following verbiage for operating systems that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read & consent to terms in IS user agreem't.\"\n\n)\n  desc 'check', 'Verify that the Standard Mandatory DoD Notice and Consent Banner is configured.\n\nVerify that SSH is configured to display the Standard Mandatory DoD Notice Consent Banner:\n$ sudo grep -i banner /etc/ssh/sshd_config\nbanner /etc/issue\n\nIf \"banner\" is not set or is commented out, this is a finding.'\n  desc 'fix', \"Configure the Standard Mandatory DoD Notice and Consent Banner.\n\n$ ncli cluster edit-cvm-security-params enable-banner=true'\"\n  impact 0.3\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57617r846482_chk'\n  tag severity: 'low'\n  tag gid: 'V-254132'\n  tag rid: 'SV-254132r846484_rule'\n  tag stig_id: 'NUTX-OS-000240'\n  tag gtitle: 'SRG-OS-000023-GPOS-00006'\n  tag fix_id: 'F-57568r846483_fix'\n  tag satisfies: ['SRG-OS-000023-GPOS-00006', 'SRG-OS-000024-GPOS-00007']\n  tag 'documentable'\n  tag cci: ['CCI-000048', 'CCI-000050']\n  tag nist: ['AC-8 a', 'AC-8 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254132.rb"},"title":"Nutanix AOS must be configured to display the Standard Mandatory DoD Notice and Consent Banner before granting access.","desc":"Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with applicable DoD policy. Use the following verbiage for operating systems that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read & consent to terms in IS user agreem't.\"\n\n","descriptions":{"default":"Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with applicable DoD policy. Use the following verbiage for operating systems that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read & consent to terms in IS user agreem't.\"\n\n","check":"Verify that the Standard Mandatory DoD Notice and Consent Banner is configured.\n\nVerify that SSH is configured to display the Standard Mandatory DoD Notice Consent Banner:\n$ sudo grep -i banner /etc/ssh/sshd_config\nbanner /etc/issue\n\nIf \"banner\" is not set or is commented out, this is a finding.","fix":"Configure the Standard Mandatory DoD Notice and Consent Banner.\n\n$ ncli cluster edit-cvm-security-params enable-banner=true'"},"impact":0.3,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57617r846482_chk","severity":"low","gid":"V-254132","rid":"SV-254132r846484_rule","stig_id":"NUTX-OS-000240","gtitle":"SRG-OS-000023-GPOS-00006","fix_id":"F-57568r846483_fix","satisfies":["SRG-OS-000023-GPOS-00006","SRG-OS-000024-GPOS-00007"],"documentable":null,"cci":["CCI-000048","CCI-000050"],"nist":["AC-8 a","AC-8 b"]}},{"id":"SV-254133","code":"control 'SV-254133' do\n  title 'Any publicly accessible connection to Nutanix AOS must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system.'\n  desc %q(Display of a standardized and approved use notification before granting access to the publicly accessible operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with applicable DoD policy. Use the following verbiage for operating systems that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read & consent to terms in IS user agreem't.\")\n  desc 'check', 'Confirm Nutanix AOS is configured to use the Standard Mandatory DoD Notice and Consent Banner.\n\n$ sudo more /etc/issue\n\nThe command should return the following text:\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nIf the operating system does not display a graphical logon banner or the banner does not match the Standard Mandatory DoD Notice and Consent Banner, this is a finding.\n\nIf the text in the \"/etc/issue\" file does not match the Standard Mandatory DoD Notice and Consent Banner, this is a finding.'\n  desc 'fix', 'Configure the Standard Mandatory DoD Notice and Consent Banner by running the following command.\n\n$ ncli cluster edit-cvm-security-params enable-banner=true'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57618r846485_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254133'\n  tag rid: 'SV-254133r846487_rule'\n  tag stig_id: 'NUTX-OS-000260'\n  tag gtitle: 'SRG-OS-000228-GPOS-00088'\n  tag fix_id: 'F-57569r846486_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001384', 'CCI-001385', 'CCI-001386', 'CCI-001387', 'CCI-001388']\n  tag nist: ['AC-8 c 1', 'AC-8 c 2', 'AC-8 c 2', 'AC-8 c 2', 'AC-8 c 3']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254133.rb"},"title":"Any publicly accessible connection to Nutanix AOS must display the Standard Mandatory DoD Notice and Consent Banner before granting access to the system.","desc":"Display of a standardized and approved use notification before granting access to the publicly accessible operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with applicable DoD policy. Use the following verbiage for operating systems that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read & consent to terms in IS user agreem't.\"","descriptions":{"default":"Display of a standardized and approved use notification before granting access to the publicly accessible operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with applicable DoD policy. Use the following verbiage for operating systems that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read & consent to terms in IS user agreem't.\"","check":"Confirm Nutanix AOS is configured to use the Standard Mandatory DoD Notice and Consent Banner.\n\n$ sudo more /etc/issue\n\nThe command should return the following text:\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nIf the operating system does not display a graphical logon banner or the banner does not match the Standard Mandatory DoD Notice and Consent Banner, this is a finding.\n\nIf the text in the \"/etc/issue\" file does not match the Standard Mandatory DoD Notice and Consent Banner, this is a finding.","fix":"Configure the Standard Mandatory DoD Notice and Consent Banner by running the following command.\n\n$ ncli cluster edit-cvm-security-params enable-banner=true"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57618r846485_chk","severity":"medium","gid":"V-254133","rid":"SV-254133r846487_rule","stig_id":"NUTX-OS-000260","gtitle":"SRG-OS-000228-GPOS-00088","fix_id":"F-57569r846486_fix","documentable":null,"cci":["CCI-001384","CCI-001385","CCI-001386","CCI-001387","CCI-001388"],"nist":["AC-8 c 1","AC-8 c 2","AC-8 c 2","AC-8 c 2","AC-8 c 3"]}},{"id":"SV-254134","code":"control 'SV-254134' do\n  title 'Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels).'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels).'\n  desc 'check', 'Confirm Nutanix AOS is configured to generate audit records on all successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels).\n\n$ sudo grep -w \"postdrop\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w \"postqueue\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/postqueue -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w \"semanage\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -w \"setfiles\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change\n\n$ sudo grep -w \"userhelper\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd\n\n$ sudo grep -w \"setsebool\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -w \"unix_chkpwd\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w faillock /etc/audit/audit.rules\n-w /var/run/faillock/ -p wa -k logins\n\n$ sudo grep -w lastlog /etc/audit/audit.rules\n-w /var/log/lastlog -p wa -k logins\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57619r846488_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254134'\n  tag rid: 'SV-254134r846800_rule'\n  tag stig_id: 'NUTX-OS-000270'\n  tag gtitle: 'SRG-OS-000062-GPOS-00031'\n  tag fix_id: 'F-57570r846489_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000169']\n  tag nist: ['AU-12 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254134.rb"},"title":"Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels).","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels).","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels).","check":"Confirm Nutanix AOS is configured to generate audit records on all successful and unsuccessful attempts to access, modify, or delete privileges, security objects, security levels, or categories of information (e.g., classification levels).\n\n$ sudo grep -w \"postdrop\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w \"postqueue\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/postqueue -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w \"semanage\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -w \"setfiles\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change\n\n$ sudo grep -w \"userhelper\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd\n\n$ sudo grep -w \"setsebool\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -w \"unix_chkpwd\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w faillock /etc/audit/audit.rules\n-w /var/run/faillock/ -p wa -k logins\n\n$ sudo grep -w lastlog /etc/audit/audit.rules\n-w /var/log/lastlog -p wa -k logins\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57619r846488_chk","severity":"medium","gid":"V-254134","rid":"SV-254134r846800_rule","stig_id":"NUTX-OS-000270","gtitle":"SRG-OS-000062-GPOS-00031","fix_id":"F-57570r846489_fix","documentable":null,"cci":["CCI-000169"],"nist":["AU-12 a"]}},{"id":"SV-254135","code":"control 'SV-254135' do\n  title 'Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for system and account management actions.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.'\n  desc 'check', 'Confirm Nutanix AOS auditing is configured to generate audit records for all access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.\n\n$ sudo yum list installed audit\nInstalled Packages\naudit.x86_64 \n\n$ sudo grep -w chcon /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep ssh-agent /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w /usr/bin/mount /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w /usr/bin/umount /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep ssh-keysign /etc/audit/audit.rules\n-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w pam_timestamp_check /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w crontab /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w chsh /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVMI18:J21N18I18:J22I18:J22N18I18:J22I18:J23N18I18:J22I18:J24N18I18:J22I18:J25N18II18:J22'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57620r846491_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254135'\n  tag rid: 'SV-254135r846493_rule'\n  tag stig_id: 'NUTX-OS-000280'\n  tag gtitle: 'SRG-OS-000062-GPOS-00031'\n  tag fix_id: 'F-57571r846492_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000169']\n  tag nist: ['AU-12 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254135.rb"},"title":"Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for system and account management actions.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.","check":"Confirm Nutanix AOS auditing is configured to generate audit records for all access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.\n\n$ sudo yum list installed audit\nInstalled Packages\naudit.x86_64 \n\n$ sudo grep -w chcon /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep ssh-agent /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w /usr/bin/mount /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w /usr/bin/umount /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep ssh-keysign /etc/audit/audit.rules\n-a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w pam_timestamp_check /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w crontab /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w chsh /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVMI18:J21N18I18:J22I18:J22N18I18:J22I18:J23N18I18:J22I18:J24N18I18:J22I18:J25N18II18:J22"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57620r846491_chk","severity":"medium","gid":"V-254135","rid":"SV-254135r846493_rule","stig_id":"NUTX-OS-000280","gtitle":"SRG-OS-000062-GPOS-00031","fix_id":"F-57571r846492_fix","documentable":null,"cci":["CCI-000169"],"nist":["AU-12 a"]}},{"id":"SV-254136","code":"control 'SV-254136' do\n  title 'Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for file attribute management actions.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.'\n  desc 'check', 'Confirm Nutanix AOS auditing is configured to generate audit records for all access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.\n\n$ sudo grep -w lremovexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S lremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w removexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S removexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S removexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S removexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S removexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w lsetxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S lsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S lsetxattr-F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lsetxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fsetxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fsetxattr-F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fsetxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fremovexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w setxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S setxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S setxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S setxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S setxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57621r846494_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254136'\n  tag rid: 'SV-254136r846496_rule'\n  tag stig_id: 'NUTX-OS-000290'\n  tag gtitle: 'SRG-OS-000062-GPOS-00031'\n  tag fix_id: 'F-57572r846495_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000169']\n  tag nist: ['AU-12 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254136.rb"},"title":"Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for file attribute management actions.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.","check":"Confirm Nutanix AOS auditing is configured to generate audit records for all access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.\n\n$ sudo grep -w lremovexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S lremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w removexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S removexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S removexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S removexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S removexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w lsetxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S lsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S lsetxattr-F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lsetxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fsetxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fsetxattr-F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fsetxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fremovexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w setxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S setxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S setxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S setxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S setxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.","fix":"Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57621r846494_chk","severity":"medium","gid":"V-254136","rid":"SV-254136r846496_rule","stig_id":"NUTX-OS-000290","gtitle":"SRG-OS-000062-GPOS-00031","fix_id":"F-57572r846495_fix","documentable":null,"cci":["CCI-000169"],"nist":["AU-12 a"]}},{"id":"SV-254137","code":"control 'SV-254137' do\n  title 'Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for system module management actions.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.'\n  desc 'check', 'Confirm Nutanix AOS auditing is configured to generate audit records for all access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.\n\n$ sudo grep -w \"init_module\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S init_module -k audit_network_modifications_modules\n-a always,exit -F arch=b32 -S init_module -k audit_network_modifications_modules\n-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n-a always,exit -F arch=b32 -S init_module -S delete_module -k modules\n\n$ sudo grep -w \"finit_module\" /etc/audit/audit.rules\n-a always,exit -F arch=b32 -S finit_module -k module-change\n-a always,exit -F arch=b64 -S finit_module -k module-change\n\n$ sudo grep -w \"delete_module\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S delete_module -k audit_network_modifications_modules\n-a always,exit -F arch=b32 -S delete_module -k audit_network_modifications_modules\n-a always,exit -F arch=b64 -S delete_module -k modules\n-a always,exit -F arch=b32 -S delete_module -k modules\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57622r846497_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254137'\n  tag rid: 'SV-254137r846499_rule'\n  tag stig_id: 'NUTX-OS-000300'\n  tag gtitle: 'SRG-OS-000062-GPOS-00031'\n  tag fix_id: 'F-57573r846498_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000169']\n  tag nist: ['AU-12 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254137.rb"},"title":"Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for system module management actions.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.","check":"Confirm Nutanix AOS auditing is configured to generate audit records for all access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.\n\n$ sudo grep -w \"init_module\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S init_module -k audit_network_modifications_modules\n-a always,exit -F arch=b32 -S init_module -k audit_network_modifications_modules\n-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n-a always,exit -F arch=b32 -S init_module -S delete_module -k modules\n\n$ sudo grep -w \"finit_module\" /etc/audit/audit.rules\n-a always,exit -F arch=b32 -S finit_module -k module-change\n-a always,exit -F arch=b64 -S finit_module -k module-change\n\n$ sudo grep -w \"delete_module\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S delete_module -k audit_network_modifications_modules\n-a always,exit -F arch=b32 -S delete_module -k audit_network_modifications_modules\n-a always,exit -F arch=b64 -S delete_module -k modules\n-a always,exit -F arch=b32 -S delete_module -k modules\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.","fix":"Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57622r846497_chk","severity":"medium","gid":"V-254137","rid":"SV-254137r846499_rule","stig_id":"NUTX-OS-000300","gtitle":"SRG-OS-000062-GPOS-00031","fix_id":"F-57573r846498_fix","documentable":null,"cci":["CCI-000169"],"nist":["AU-12 a"]}},{"id":"SV-254138","code":"control 'SV-254138' do\n  title 'Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for directory and permissions management actions.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.'\n  desc 'check', 'Confirm Nutanix AOS auditing is configured to generate audit records for all access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.\n\n$ sudo grep -w \"\\\\-S mount\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S mount -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S mount -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w \"rename\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S rename -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S rename -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rename -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rename -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w \"renameat\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S renameat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S renameat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S renameat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S renameat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w \"rmdir\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S rmdir -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S rmdir -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rmdir -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rmdir -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w \"unlink\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S unlink -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S unlink -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlink -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlink -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w \"unlinkat\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S unlinkat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S unlinkat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlinkat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlinkat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w chown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w chmod /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S chmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w lchown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchownat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchmodat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchmodat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmodat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchmod /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57623r846500_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254138'\n  tag rid: 'SV-254138r846502_rule'\n  tag stig_id: 'NUTX-OS-000310'\n  tag gtitle: 'SRG-OS-000062-GPOS-00031'\n  tag fix_id: 'F-57574r846501_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000169']\n  tag nist: ['AU-12 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254138.rb"},"title":"Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for directory and permissions management actions.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.","check":"Confirm Nutanix AOS auditing is configured to generate audit records for all access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.\n\n$ sudo grep -w \"\\-S mount\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S mount -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S mount -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w \"rename\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S rename -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S rename -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rename -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rename -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w \"renameat\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S renameat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S renameat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S renameat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S renameat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w \"rmdir\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S rmdir -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S rmdir -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rmdir -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rmdir -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w \"unlink\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S unlink -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S unlink -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlink -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlink -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w \"unlinkat\" /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S unlinkat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S unlinkat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlinkat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlinkat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w chown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w chmod /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S chmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w lchown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchownat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchmodat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchmodat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmodat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchmod /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.","fix":"Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57623r846500_chk","severity":"medium","gid":"V-254138","rid":"SV-254138r846502_rule","stig_id":"NUTX-OS-000310","gtitle":"SRG-OS-000062-GPOS-00031","fix_id":"F-57574r846501_fix","documentable":null,"cci":["CCI-000169"],"nist":["AU-12 a"]}},{"id":"SV-254139","code":"control 'SV-254139' do\n  title 'Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for file management actions.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.'\n  desc 'check', 'Confirm Nutanix AOS auditing is configured to generate audit records for all access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.\n\n$ sudo grep -iw truncate /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S truncate -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S truncate -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\n$ sudo grep -iw openat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S openat-F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S openat -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S openat -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\n$ sudo grep -iw open /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S open-F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S open -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S open -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\n$ sudo grep -iw open_by_handle_at /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S open_by_handle_at-F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S open_by_handle_at -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S open_by_handle_at -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\n$ sudo grep -iw ftruncate /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S ftruncate -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S ftruncate -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\n$ sudo grep -iw creat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S creat -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S creat -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57624r846503_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254139'\n  tag rid: 'SV-254139r846505_rule'\n  tag stig_id: 'NUTX-OS-000320'\n  tag gtitle: 'SRG-OS-000062-GPOS-00031'\n  tag fix_id: 'F-57575r846504_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000169']\n  tag nist: ['AU-12 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254139.rb"},"title":"Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for file management actions.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as: Access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.","check":"Confirm Nutanix AOS auditing is configured to generate audit records for all access actions, such as successful and unsuccessful logon attempts, privileged activities or other system-level access, starting and ending time for user access to the system, concurrent logons from different workstations, successful and unsuccessful accesses to objects, all program initiations, and all direct access to the information system.\n\n$ sudo grep -iw truncate /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S truncate -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S truncate -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\n$ sudo grep -iw openat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S openat-F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S openat -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S openat -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\n$ sudo grep -iw open /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S open-F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S open -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S open -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\n$ sudo grep -iw open_by_handle_at /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S open_by_handle_at-F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S open_by_handle_at -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S open_by_handle_at -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\n$ sudo grep -iw ftruncate /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S ftruncate -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S ftruncate -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\n$ sudo grep -iw creat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b64 -S creat -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid=0 -k access\n-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid=0 -k access\n-a always,exit -F arch=b32 -S creat -F auid>=1000 -F auid!=4294967295 -k access\n-a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.","fix":"Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57624r846503_chk","severity":"medium","gid":"V-254139","rid":"SV-254139r846505_rule","stig_id":"NUTX-OS-000320","gtitle":"SRG-OS-000062-GPOS-00031","fix_id":"F-57575r846504_fix","documentable":null,"cci":["CCI-000169"],"nist":["AU-12 a"]}},{"id":"SV-254140","code":"control 'SV-254140' do\n  title 'Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for all account creations, modifications, disabling, and terminations.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as all account creations, modifications, disabling, and terminations.'\n  desc 'check', 'Confirm Nutanix AOS auditing is configured to generate audit records for all account creations, modifications, disabling, and terminations.\n\n$ sudo grep /etc/shadow /etc/audit/audit.rules\n-w /etc/shadow -p wa -k audit_account_changes\n\n$ sudo grep /etc/security/opasswd /etc/audit/audit.rules\n-w /etc/security/opasswd -p wa -k audit_account_changes\n\n$ sudo grep /etc/passwd /etc/audit/audit.rules\n-w /etc/passwd -p wa -k audit_account_changes\n\n$ sudo grep /etc/gshadow /etc/audit/audit.rules\n-w /etc/gshadow -p wa -k audit_account_changes\n\n$ sudo grep /etc/group /etc/audit/audit.rules\n-w /etc/group -p wa -k audit_account_changes\n\n$ sudo grep /etc/sudoers /etc/audit/audit.rules\n-w /etc/sudoers -p wa -k actions\n\n$ sudo grep /etc/sudoers.d/ /etc/audit/audit.rules\n-w /etc/sudoers.d/ -p wa -k actions\n\n$ sudo grep -w /usr/bin/su /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w sudo /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w gpasswd /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w passwd /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd\n\n$ sudo grep -w chage /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w newgrp /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57625r846506_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254140'\n  tag rid: 'SV-254140r846508_rule'\n  tag stig_id: 'NUTX-OS-000330'\n  tag gtitle: 'SRG-OS-000062-GPOS-00031'\n  tag fix_id: 'F-57576r846507_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000169']\n  tag nist: ['AU-12 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254140.rb"},"title":"Nutanix AOS must provide audit record generation capability for DoD-defined auditable events for all account creations, modifications, disabling, and terminations.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as all account creations, modifications, disabling, and terminations.","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\nThe list of audited events is the set of events for which audits are to be generated. This set of events is typically a subset of the list of all events for which the system is capable of generating audit records.\n\nDoD has defined the list of events for which the operating system will provide an audit record generation capability as all account creations, modifications, disabling, and terminations.","check":"Confirm Nutanix AOS auditing is configured to generate audit records for all account creations, modifications, disabling, and terminations.\n\n$ sudo grep /etc/shadow /etc/audit/audit.rules\n-w /etc/shadow -p wa -k audit_account_changes\n\n$ sudo grep /etc/security/opasswd /etc/audit/audit.rules\n-w /etc/security/opasswd -p wa -k audit_account_changes\n\n$ sudo grep /etc/passwd /etc/audit/audit.rules\n-w /etc/passwd -p wa -k audit_account_changes\n\n$ sudo grep /etc/gshadow /etc/audit/audit.rules\n-w /etc/gshadow -p wa -k audit_account_changes\n\n$ sudo grep /etc/group /etc/audit/audit.rules\n-w /etc/group -p wa -k audit_account_changes\n\n$ sudo grep /etc/sudoers /etc/audit/audit.rules\n-w /etc/sudoers -p wa -k actions\n\n$ sudo grep /etc/sudoers.d/ /etc/audit/audit.rules\n-w /etc/sudoers.d/ -p wa -k actions\n\n$ sudo grep -w /usr/bin/su /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w sudo /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w gpasswd /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w passwd /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd\n\n$ sudo grep -w chage /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w newgrp /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57625r846506_chk","severity":"medium","gid":"V-254140","rid":"SV-254140r846508_rule","stig_id":"NUTX-OS-000330","gtitle":"SRG-OS-000062-GPOS-00031","fix_id":"F-57576r846507_fix","documentable":null,"cci":["CCI-000169"],"nist":["AU-12 a"]}},{"id":"SV-254141","code":"control 'SV-254141' do\n  title 'Nutanix AOS must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.'\n  desc \"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\"\n  desc 'check', 'Confirm Nutanix AOS must allow only the Information System Security Manager (ISSM) (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.\n\nNote: Nutanix AOS audit facility is locked down so that only root has access to browse below the /etc/audit/ directory. \n\n$ sudo su -\n# ls -al /etc/audit/rules.d/*.rules\n-rw-r----- 1 root root 1280 Feb 16 17:09 audit.rules\n\n$ sudo su -\nsudo stat -c \"%a %n\" /etc/audit/auditd.conf\n640 /etc/audit/auditd.conf\n\nIf the files in the \"/etc/audit/rules.d/\" directory or the \"/etc/audit/auditd.conf\" file have a mode more permissive than \"0640\", this is a finding.'\n  desc 'fix', 'Configure the files in directory \"/etc/audit/rules.d/\" and the \"/etc/audit/auditd.conf\" file to have a mode of \"0640\" with the following commands:\n\n$ sudo su -\n# chmod 0640 /etc/audit/rules.d/audit.rules\n# chmod 0640 /etc/audit/rules.d/[customrulesfile].rules\n# chmod 0640 /etc/audit/auditd.conf'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57626r846509_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254141'\n  tag rid: 'SV-254141r846511_rule'\n  tag stig_id: 'NUTX-OS-000350'\n  tag gtitle: 'SRG-OS-000063-GPOS-00032'\n  tag fix_id: 'F-57577r846510_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000171']\n  tag nist: ['AU-12 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254141.rb"},"title":"Nutanix AOS must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.","desc":"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.","descriptions":{"default":"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.","check":"Confirm Nutanix AOS must allow only the Information System Security Manager (ISSM) (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.\n\nNote: Nutanix AOS audit facility is locked down so that only root has access to browse below the /etc/audit/ directory. \n\n$ sudo su -\n# ls -al /etc/audit/rules.d/*.rules\n-rw-r----- 1 root root 1280 Feb 16 17:09 audit.rules\n\n$ sudo su -\nsudo stat -c \"%a %n\" /etc/audit/auditd.conf\n640 /etc/audit/auditd.conf\n\nIf the files in the \"/etc/audit/rules.d/\" directory or the \"/etc/audit/auditd.conf\" file have a mode more permissive than \"0640\", this is a finding.","fix":"Configure the files in directory \"/etc/audit/rules.d/\" and the \"/etc/audit/auditd.conf\" file to have a mode of \"0640\" with the following commands:\n\n$ sudo su -\n# chmod 0640 /etc/audit/rules.d/audit.rules\n# chmod 0640 /etc/audit/rules.d/[customrulesfile].rules\n# chmod 0640 /etc/audit/auditd.conf"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57626r846509_chk","severity":"medium","gid":"V-254141","rid":"SV-254141r846511_rule","stig_id":"NUTX-OS-000350","gtitle":"SRG-OS-000063-GPOS-00032","fix_id":"F-57577r846510_fix","documentable":null,"cci":["CCI-000171"],"nist":["AU-12 b"]}},{"id":"SV-254142","code":"control 'SV-254142' do\n  title 'Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful uses and variations of the chown privileged commands.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access privileges occur.\n\n$ sudo grep -iw chown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chown -F auid=0 -k audit_time_perm_mod_export_delete\n -a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw fchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a exit,never -F arch=b64 -S openat -S open -S fchown -F success=0 -F uid=1000 -F exit=-13.\n -a exit,never -F arch=b64 -S fchown -F success=0 -F uid=0 -F exit=-13.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw lchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw fchownat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57627r846512_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254142'\n  tag rid: 'SV-254142r846514_rule'\n  tag stig_id: 'NUTX-OS-000360'\n  tag gtitle: 'SRG-OS-000064-GPOS-00033'\n  tag fix_id: 'F-57578r846513_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254142.rb"},"title":"Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful uses and variations of the chown privileged commands.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access privileges occur.\n\n$ sudo grep -iw chown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chown -F auid=0 -k audit_time_perm_mod_export_delete\n -a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw fchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a exit,never -F arch=b64 -S openat -S open -S fchown -F success=0 -F uid=1000 -F exit=-13.\n -a exit,never -F arch=b64 -S fchown -F success=0 -F uid=0 -F exit=-13.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw lchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw fchownat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57627r846512_chk","severity":"medium","gid":"V-254142","rid":"SV-254142r846514_rule","stig_id":"NUTX-OS-000360","gtitle":"SRG-OS-000064-GPOS-00033","fix_id":"F-57578r846513_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254143","code":"control 'SV-254143' do\n  title 'Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful uses and variations of the creat privileged commands.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access privileges occur.\n\n$ sudo grep -iw creat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57628r858400_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254143'\n  tag rid: 'SV-254143r858400_rule'\n  tag stig_id: 'NUTX-OS-000370'\n  tag gtitle: 'SRG-OS-000064-GPOS-00033'\n  tag fix_id: 'F-57579r846516_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254143.rb"},"title":"Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful uses and variations of the creat privileged commands.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access privileges occur.\n\n$ sudo grep -iw creat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57628r858400_chk","severity":"medium","gid":"V-254143","rid":"SV-254143r858400_rule","stig_id":"NUTX-OS-000370","gtitle":"SRG-OS-000064-GPOS-00033","fix_id":"F-57579r846516_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254144","code":"control 'SV-254144' do\n  title 'Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful uses and variations of the open-related privileged commands.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access privileges occur.\n\n$ sudo grep -iw open /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw openat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw open_by_handle_at /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57629r846518_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254144'\n  tag rid: 'SV-254144r846520_rule'\n  tag stig_id: 'NUTX-OS-000380'\n  tag gtitle: 'SRG-OS-000064-GPOS-00033'\n  tag fix_id: 'F-57580r846519_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254144.rb"},"title":"Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful uses and variations of the open-related privileged commands.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access privileges occur.\n\n$ sudo grep -iw open /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw openat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw open_by_handle_at /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57629r846518_chk","severity":"medium","gid":"V-254144","rid":"SV-254144r846520_rule","stig_id":"NUTX-OS-000380","gtitle":"SRG-OS-000064-GPOS-00033","fix_id":"F-57580r846519_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254145","code":"control 'SV-254145' do\n  title 'Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful uses and variations of the truncate-related privileged commands.'\n  desc 'Without generating audit records  specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access privileges occur.\n\n$ sudo grep -iw truncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw ftruncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57630r846521_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254145'\n  tag rid: 'SV-254145r846523_rule'\n  tag stig_id: 'NUTX-OS-000390'\n  tag gtitle: 'SRG-OS-000064-GPOS-00033'\n  tag fix_id: 'F-57581r846522_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254145.rb"},"title":"Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful uses and variations of the truncate-related privileged commands.","desc":"Without generating audit records  specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records  specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access privileges occur.\n\n$ sudo grep -iw truncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw ftruncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57630r846521_chk","severity":"medium","gid":"V-254145","rid":"SV-254145r846523_rule","stig_id":"NUTX-OS-000390","gtitle":"SRG-OS-000064-GPOS-00033","fix_id":"F-57581r846522_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254146","code":"control 'SV-254146' do\n  title 'Nutanix AOS must generate audit records for file access actions.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access categories of information occur.\n\n$ sudo grep -iw creat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n\n$ sudo grep -iw open /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw openat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw open_by_handle_at /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n\n$ sudo grep -iw truncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw ftruncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57631r846524_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254146'\n  tag rid: 'SV-254146r846526_rule'\n  tag stig_id: 'NUTX-OS-000400'\n  tag gtitle: 'SRG-OS-000458-GPOS-00203'\n  tag fix_id: 'F-57582r846525_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254146.rb"},"title":"Nutanix AOS must generate audit records for file access actions.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access categories of information occur.\n\n$ sudo grep -iw creat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n\n$ sudo grep -iw open /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw openat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw open_by_handle_at /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n\n$ sudo grep -iw truncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw ftruncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.","fix":"Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57631r846524_chk","severity":"medium","gid":"V-254146","rid":"SV-254146r846526_rule","stig_id":"NUTX-OS-000400","gtitle":"SRG-OS-000458-GPOS-00203","fix_id":"F-57582r846525_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254147","code":"control 'SV-254147' do\n  title 'Nutanix AOS must generate audit records for file ownership actions.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access categories of information occur.\n\n$ sudo grep -iw chown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chown -F auid=0 -k audit_time_perm_mod_export_delete\n -a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n\n$ sudo grep -iw fchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a exit,never -F arch=b64 -S openat -S open -S fchown -F success=0 -F uid=1000 -F exit=-13.\n -a exit,never -F arch=b64 -S fchown -F success=0 -F uid=0 -F exit=-13.\n\n$ sudo grep -iw lchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n\n$ sudo grep -iw fchownat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57632r846527_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254147'\n  tag rid: 'SV-254147r846529_rule'\n  tag stig_id: 'NUTX-OS-000410'\n  tag gtitle: 'SRG-OS-000458-GPOS-00203'\n  tag fix_id: 'F-57583r846528_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254147.rb"},"title":"Nutanix AOS must generate audit records for file ownership actions.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access categories of information occur.\n\n$ sudo grep -iw chown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chown -F auid=0 -k audit_time_perm_mod_export_delete\n -a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n\n$ sudo grep -iw fchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a exit,never -F arch=b64 -S openat -S open -S fchown -F success=0 -F uid=1000 -F exit=-13.\n -a exit,never -F arch=b64 -S fchown -F success=0 -F uid=0 -F exit=-13.\n\n$ sudo grep -iw lchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n\n$ sudo grep -iw fchownat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.","fix":"Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57632r846527_chk","severity":"medium","gid":"V-254147","rid":"SV-254147r846529_rule","stig_id":"NUTX-OS-000410","gtitle":"SRG-OS-000458-GPOS-00203","fix_id":"F-57583r846528_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254148","code":"control 'SV-254148' do\n  title 'Nutanix AOS must generate audit records for file permission actions.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access categories of information occur.\n\n$ sudo grep -w chmod /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S chmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchmod /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchmodat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchmodat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmodat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57633r846530_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254148'\n  tag rid: 'SV-254148r846532_rule'\n  tag stig_id: 'NUTX-OS-000420'\n  tag gtitle: 'SRG-OS-000458-GPOS-00203'\n  tag fix_id: 'F-57584r846531_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254148.rb"},"title":"Nutanix AOS must generate audit records for file permission actions.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access categories of information occur.\n\n$ sudo grep -w chmod /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S chmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S chmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchmod /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmod -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmod -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fchmodat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fchmodat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmodat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fchmodat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.","fix":"Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57633r846530_chk","severity":"medium","gid":"V-254148","rid":"SV-254148r846532_rule","stig_id":"NUTX-OS-000420","gtitle":"SRG-OS-000458-GPOS-00203","fix_id":"F-57584r846531_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254149","code":"control 'SV-254149' do\n  title 'Nutanix AOS must generate audit records for file extended attribute actions.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access categories of information occur.\n\n$ sudo grep -w setxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S setxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S setxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S setxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S setxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fsetxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fsetxattr-F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fsetxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w lsetxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S lsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S lsetxattr-F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lsetxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w removexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S removexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S removexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S removexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S removexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fremovexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w lremovexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S lremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57634r846533_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254149'\n  tag rid: 'SV-254149r846535_rule'\n  tag stig_id: 'NUTX-OS-000430'\n  tag gtitle: 'SRG-OS-000458-GPOS-00203'\n  tag fix_id: 'F-57585r846534_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254149.rb"},"title":"Nutanix AOS must generate audit records for file extended attribute actions.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access categories of information occur.\n\n$ sudo grep -w setxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S setxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S setxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S setxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S setxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fsetxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fsetxattr-F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fsetxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w lsetxattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S lsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S lsetxattr-F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lsetxattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lsetxattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w removexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S removexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S removexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S removexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S removexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w fremovexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S fremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -w lremovexattr /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S lremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lremovexattr -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S lremovexattr -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.","fix":"Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57634r846533_chk","severity":"medium","gid":"V-254149","rid":"SV-254149r846535_rule","stig_id":"NUTX-OS-000430","gtitle":"SRG-OS-000458-GPOS-00203","fix_id":"F-57585r846534_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254150","code":"control 'SV-254150' do\n  title 'Nutanix AOS must generate audit records when successful/unsuccessful attempts to access categories of information (e.g., classification levels) occur.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access categories of information occur.\n\n$ sudo grep -iw creat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n\n$ sudo grep -iw open /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw openat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw open_by_handle_at /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n\n$ sudo grep -iw truncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw ftruncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57635r846536_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254150'\n  tag rid: 'SV-254150r846538_rule'\n  tag stig_id: 'NUTX-OS-000440'\n  tag gtitle: 'SRG-OS-000461-GPOS-00205'\n  tag fix_id: 'F-57586r846537_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254150.rb"},"title":"Nutanix AOS must generate audit records when successful/unsuccessful attempts to access categories of information (e.g., classification levels) occur.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access categories of information occur.\n\n$ sudo grep -iw creat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S creat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n\n$ sudo grep -iw open /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw openat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S openat -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw open_by_handle_at /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n\n$ sudo grep -iw truncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S truncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw ftruncate /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b64 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid=0 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access.\n -a always,exit -F arch=b32 -S ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57635r846536_chk","severity":"medium","gid":"V-254150","rid":"SV-254150r846538_rule","stig_id":"NUTX-OS-000440","gtitle":"SRG-OS-000461-GPOS-00205","fix_id":"F-57586r846537_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254151","code":"control 'SV-254151' do\n  title 'Nutanix AOS must generate audit records when successful/unsuccessful attempts to modify privileges occur.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records when successful/unsuccessful attempts to modify privileged objects occur.\n\n$ sudo grep /etc/sudoers /etc/audit/audit.rules\n-w /etc/sudoers -p wa -k actions\n\n$ sudo grep /etc/sudoers.d/ /etc/audit/audit.rules\n-w /etc/sudoers.d/ -p wa -k actions\n\n$ sudo grep -w /usr/bin/su /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w sudo /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w newgrp /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -i /usr/bin/chsh /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\nIf the privileged activities access listed do not return any output, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57636r846539_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254151'\n  tag rid: 'SV-254151r846541_rule'\n  tag stig_id: 'NUTX-OS-000450'\n  tag gtitle: 'SRG-OS-000462-GPOS-00206'\n  tag fix_id: 'F-57587r846540_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254151.rb"},"title":"Nutanix AOS must generate audit records when successful/unsuccessful attempts to modify privileges occur.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records when successful/unsuccessful attempts to modify privileged objects occur.\n\n$ sudo grep /etc/sudoers /etc/audit/audit.rules\n-w /etc/sudoers -p wa -k actions\n\n$ sudo grep /etc/sudoers.d/ /etc/audit/audit.rules\n-w /etc/sudoers.d/ -p wa -k actions\n\n$ sudo grep -w /usr/bin/su /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w sudo /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w newgrp /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -i /usr/bin/chsh /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\nIf the privileged activities access listed do not return any output, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57636r846539_chk","severity":"medium","gid":"V-254151","rid":"SV-254151r846541_rule","stig_id":"NUTX-OS-000450","gtitle":"SRG-OS-000462-GPOS-00206","fix_id":"F-57587r846540_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254152","code":"control 'SV-254152' do\n  title 'Nutanix AOS must generate audit records when successful/unsuccessful attempts to modify security objects occur.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records for successful/unsuccessful attempts to modify security objects occur.\n\n$ sudo grep -i /usr/sbin/semanage /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/sbin/setsebool /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/bin/chcon /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -iw /usr/sbin/setfiles /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change\n\nIf the commands does not return any output, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57637r846542_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254152'\n  tag rid: 'SV-254152r846544_rule'\n  tag stig_id: 'NUTX-OS-000460'\n  tag gtitle: 'SRG-OS-000463-GPOS-00207'\n  tag fix_id: 'F-57588r846543_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254152.rb"},"title":"Nutanix AOS must generate audit records when successful/unsuccessful attempts to modify security objects occur.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records for successful/unsuccessful attempts to modify security objects occur.\n\n$ sudo grep -i /usr/sbin/semanage /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/sbin/setsebool /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/bin/chcon /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -iw /usr/sbin/setfiles /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change\n\nIf the commands does not return any output, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57637r846542_chk","severity":"medium","gid":"V-254152","rid":"SV-254152r846544_rule","stig_id":"NUTX-OS-000460","gtitle":"SRG-OS-000463-GPOS-00207","fix_id":"F-57588r846543_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254153","code":"control 'SV-254153' do\n  title 'Nutanix AOS must generate audit records when successful/unsuccessful attempts to modify categories of information occur.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records for successful/unsuccessful attempts to modify categories of information.\n\n$ sudo grep -i /usr/sbin/semanage /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/sbin/setsebool /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/bin/chcon /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -iw /usr/sbin/setfiles /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change\n\nIf the commands does not return any output, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57638r846545_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254153'\n  tag rid: 'SV-254153r846547_rule'\n  tag stig_id: 'NUTX-OS-000470'\n  tag gtitle: 'SRG-OS-000465-GPOS-00209'\n  tag fix_id: 'F-57589r846546_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254153.rb"},"title":"Nutanix AOS must generate audit records when successful/unsuccessful attempts to modify categories of information occur.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records for successful/unsuccessful attempts to modify categories of information.\n\n$ sudo grep -i /usr/sbin/semanage /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/sbin/setsebool /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/bin/chcon /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -iw /usr/sbin/setfiles /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change\n\nIf the commands does not return any output, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57638r846545_chk","severity":"medium","gid":"V-254153","rid":"SV-254153r846547_rule","stig_id":"NUTX-OS-000470","gtitle":"SRG-OS-000465-GPOS-00209","fix_id":"F-57589r846546_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254154","code":"control 'SV-254154' do\n  title 'Nutanix AOS must audit attempts to modify or delete security objects.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n'\n  desc 'check', 'Confirm Nutanix AOS generates audit records when successful/unsuccessful attempts to delete security objects occur.\n\n$ sudo grep -iw rename /etc/audit/audit.rules\n-a exit,never -F arch=b64 -S rename -F success=1 -F uid=1000 -F exit=0\n-a exit,never -F arch=b64 -S rename -F success=0 -F uid=1000 -F exit=-2\n-a always,exit -F arch=b64 -S rename -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S rename -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rename -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rename -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -iw renameat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S renameat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S renameat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S renameat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S renameat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -iw rmdir /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S rmdir -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S rmdir -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rmdir -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rmdir -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\ngrep -iw unlink /etc/audit/audit.rules\n-a exit,never -F arch=b64 -S unlink -F success=1 -F uid=1000 -F exit=0\n-a exit,never -F arch=b64 -S unlink -F success=0 -F uid=1000 -F exit=-2\n-a always,exit -F arch=b64 -S unlink -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S unlink -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlink -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlink -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\ngrep -iw unlinkat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S unlinkat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S unlinkat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlinkat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlinkat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\nIf both the \"b32\" and \"b64\" audit rules are not defined for the syscalls listed, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57639r846548_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254154'\n  tag rid: 'SV-254154r846550_rule'\n  tag stig_id: 'NUTX-OS-000480'\n  tag gtitle: 'SRG-OS-000466-GPOS-00210'\n  tag fix_id: 'F-57590r846549_fix'\n  tag satisfies: ['SRG-OS-000466-GPOS-00210', 'SRG-OS-000467-GPOS-00211', 'SRG-OS-000468-GPOS-00212']\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254154.rb"},"title":"Nutanix AOS must audit attempts to modify or delete security objects.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n","check":"Confirm Nutanix AOS generates audit records when successful/unsuccessful attempts to delete security objects occur.\n\n$ sudo grep -iw rename /etc/audit/audit.rules\n-a exit,never -F arch=b64 -S rename -F success=1 -F uid=1000 -F exit=0\n-a exit,never -F arch=b64 -S rename -F success=0 -F uid=1000 -F exit=-2\n-a always,exit -F arch=b64 -S rename -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S rename -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rename -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rename -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -iw renameat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S renameat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S renameat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S renameat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S renameat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\n$ sudo grep -iw rmdir /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S rmdir -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S rmdir -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rmdir -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S rmdir -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\ngrep -iw unlink /etc/audit/audit.rules\n-a exit,never -F arch=b64 -S unlink -F success=1 -F uid=1000 -F exit=0\n-a exit,never -F arch=b64 -S unlink -F success=0 -F uid=1000 -F exit=-2\n-a always,exit -F arch=b64 -S unlink -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S unlink -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlink -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlink -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\ngrep -iw unlinkat /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S unlinkat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b64 -S unlinkat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlinkat -F auid=0 -k audit_time_perm_mod_export_delete\n-a always,exit -F arch=b32 -S unlinkat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete\n\nIf both the \"b32\" and \"b64\" audit rules are not defined for the syscalls listed, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57639r846548_chk","severity":"medium","gid":"V-254154","rid":"SV-254154r846550_rule","stig_id":"NUTX-OS-000480","gtitle":"SRG-OS-000466-GPOS-00210","fix_id":"F-57590r846549_fix","satisfies":["SRG-OS-000466-GPOS-00210","SRG-OS-000467-GPOS-00211","SRG-OS-000468-GPOS-00212"],"documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254155","code":"control 'SV-254155' do\n  title 'Nutanix AOS must generate audit records when successful/unsuccessful logon attempts occur.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records when concurrent logons to the same account occur.\n\n$ sudo  grep -i /var/run/faillock /etc/audit/audit.rules\n-w /var/run/faillock -p wa -k logins\n\n$ sudo grep -i /var/log/lastlog /etc/audit/audit.rules\n-w /var/log/lastlog -p wa -k logins \n\nIf the commands listed do not return any output, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57640r846551_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254155'\n  tag rid: 'SV-254155r846553_rule'\n  tag stig_id: 'NUTX-OS-000510'\n  tag gtitle: 'SRG-OS-000470-GPOS-00214'\n  tag fix_id: 'F-57591r846552_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254155.rb"},"title":"Nutanix AOS must generate audit records when successful/unsuccessful logon attempts occur.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records when concurrent logons to the same account occur.\n\n$ sudo  grep -i /var/run/faillock /etc/audit/audit.rules\n-w /var/run/faillock -p wa -k logins\n\n$ sudo grep -i /var/log/lastlog /etc/audit/audit.rules\n-w /var/log/lastlog -p wa -k logins \n\nIf the commands listed do not return any output, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57640r846551_chk","severity":"medium","gid":"V-254155","rid":"SV-254155r846553_rule","stig_id":"NUTX-OS-000510","gtitle":"SRG-OS-000470-GPOS-00214","fix_id":"F-57591r846552_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254156","code":"control 'SV-254156' do\n  title 'Nutanix AOS must generate audit records for privileged security activities.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records for privileged activities or other system-level access.\n\n$ sudo grep /etc/shadow /etc/audit/audit.rules\n-w /etc/shadow -p wa -k audit_account_changes\n\n$ sudo grep /etc/security/opasswd /etc/audit/audit.rules\n-w /etc/security/opasswd -p wa -k audit_account_changes\n\n$ sudo grep /etc/passwd /etc/audit/audit.rules\n-w /etc/passwd -p wa -k audit_account_changes\n\n$ sudo grep /etc/gshadow /etc/audit/audit.rules\n-w /etc/gshadow -p wa -k audit_account_changes\n\n$ sudo grep /etc/group /etc/audit/audit.rules\n-w /etc/group -p wa -k audit_account_changes\n\n$ sudo grep /etc/sudoers /etc/audit/audit.rules\n-w /etc/sudoers -p wa -k actions\n\n$ sudo grep /etc/sudoers.d/ /etc/audit/audit.rules\n-w /etc/sudoers.d/ -p wa -k actions\n\n$ sudo grep -w /usr/bin/su /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w sudo /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w gpasswd /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w passwd /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd\n\nIf the privileged activities access listed do not return any output, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57641r846554_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254156'\n  tag rid: 'SV-254156r846556_rule'\n  tag stig_id: 'NUTX-OS-000520'\n  tag gtitle: 'SRG-OS-000471-GPOS-00215'\n  tag fix_id: 'F-57592r846555_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254156.rb"},"title":"Nutanix AOS must generate audit records for privileged security activities.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records for privileged activities or other system-level access.\n\n$ sudo grep /etc/shadow /etc/audit/audit.rules\n-w /etc/shadow -p wa -k audit_account_changes\n\n$ sudo grep /etc/security/opasswd /etc/audit/audit.rules\n-w /etc/security/opasswd -p wa -k audit_account_changes\n\n$ sudo grep /etc/passwd /etc/audit/audit.rules\n-w /etc/passwd -p wa -k audit_account_changes\n\n$ sudo grep /etc/gshadow /etc/audit/audit.rules\n-w /etc/gshadow -p wa -k audit_account_changes\n\n$ sudo grep /etc/group /etc/audit/audit.rules\n-w /etc/group -p wa -k audit_account_changes\n\n$ sudo grep /etc/sudoers /etc/audit/audit.rules\n-w /etc/sudoers -p wa -k actions\n\n$ sudo grep /etc/sudoers.d/ /etc/audit/audit.rules\n-w /etc/sudoers.d/ -p wa -k actions\n\n$ sudo grep -w /usr/bin/su /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w sudo /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w gpasswd /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w passwd /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd\n\nIf the privileged activities access listed do not return any output, this is a finding.","fix":"Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57641r846554_chk","severity":"medium","gid":"V-254156","rid":"SV-254156r846556_rule","stig_id":"NUTX-OS-000520","gtitle":"SRG-OS-000471-GPOS-00215","fix_id":"F-57592r846555_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254157","code":"control 'SV-254157' do\n  title 'Nutanix AOS must generate audit records for privileged account activities.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records for privileged activities or other system-level access.\n\n$ sudo grep -w chage /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w newgrp /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -i /usr/bin/chsh /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w \"userhelper\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd\n\n$ sudo grep -w \"unix_chkpwd\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w faillock /etc/audit/audit.rules\n-w /var/run/faillock/ -p wa -k logins\n\n$ sudo grep -w lastlog /etc/audit/audit.rules\n-w /var/log/lastlog -p wa -k logins\n\n$ sudo grep -iw \"/usr/sbin/pam_timestamp_check\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\nIf the privileged activities access listed do not return any output, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57642r846557_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254157'\n  tag rid: 'SV-254157r846559_rule'\n  tag stig_id: 'NUTX-OS-000530'\n  tag gtitle: 'SRG-OS-000471-GPOS-00215'\n  tag fix_id: 'F-57593r846558_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254157.rb"},"title":"Nutanix AOS must generate audit records for privileged account activities.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records for privileged activities or other system-level access.\n\n$ sudo grep -w chage /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w newgrp /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -i /usr/bin/chsh /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w \"userhelper\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/userhelper -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-passwd\n\n$ sudo grep -w \"unix_chkpwd\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/unix_chkpwd -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\n$ sudo grep -w faillock /etc/audit/audit.rules\n-w /var/run/faillock/ -p wa -k logins\n\n$ sudo grep -w lastlog /etc/audit/audit.rules\n-w /var/log/lastlog -p wa -k logins\n\n$ sudo grep -iw \"/usr/sbin/pam_timestamp_check\" /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged\n\nIf the privileged activities access listed do not return any output, this is a finding.","fix":"Configure the audit rules by running the following command.\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57642r846557_chk","severity":"medium","gid":"V-254157","rid":"SV-254157r846559_rule","stig_id":"NUTX-OS-000530","gtitle":"SRG-OS-000471-GPOS-00215","fix_id":"F-57593r846558_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254158","code":"control 'SV-254158' do\n  title 'Nutanix AOS must be configured to audit the loading and unloading of dynamic kernel modules.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n'\n  desc 'check', 'Confirm Nutanix AOS generates audit records for all kernel module load, unload, restart actions, and initiations.\n\n$ sudo grep -iw create_module /etc/audit/audit.rules\n-a always,exit -F arch=b32 -S create_module -k module-change\n-a always,exit -F arch=b64 -S create_module -k module-change\n\n$ sudo grep -iw init_module /etc/audit/audit.rules \n-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n-a always,exit -F arch=b32 -S init_module -S delete_module -k modules\n\n$ sudo grep -iw finit_module /etc/audit/audit.rules\n-a always,exit -F arch=b32 -S finit_module -k module-change\n-a always,exit -F arch=b64 -S finit_module -k module-change\n\n$ sudo grep -iw delete_module /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n-a always,exit -F arch=b32 -S init_module -S delete_module -k modules\n\nIf both the \"b32\" and \"b64\" audit rules are not defined for the module(s) listed syscall, this is a finding.\n\n$ sudo grep -iw kmod /etc/audit/audit.rules\n-w /usr/bin/kmod -p x -F auid!=unset -k module-change\n\nIf the command does not return any output, this is a finding.\n\n$ sudo cat /boot/grub/grub.conf | grep audit\n\tkernel /boot/vmlinuz-3.10.0-1160.24.1.el7.nutanix.20210425.cvm.x86_64 ro root=UUID=71a1fe8c-812f-4403-80ed-894f554b061c rd_NO_LUKS rd_NO_LVM rd_NO_MD rd_NO_DM LANG=en_US.UTF-8 SYSFONT=latarcyrheb-sun16 rhgb crashkernel=auto KEYBOARDTYPE=pc KEYTABLE=us audit=1 audit_backlog_limit=8192 nousb fips=1 nomodeset biosdevname=0 net.ifnames=0 scsi_mod.use_blk_mq=y panic=30 console=ttyS0,115200n8 console=tty0 clocksource=tsc kvm_nopvspin=1 xen_nopvspin=1 hv_netvsc.ring_size=512 mds=off mitigations=off\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57643r846560_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254158'\n  tag rid: 'SV-254158r846562_rule'\n  tag stig_id: 'NUTX-OS-000540'\n  tag gtitle: 'SRG-OS-000062-GPOS-00031'\n  tag fix_id: 'F-57594r846561_fix'\n  tag satisfies: ['SRG-OS-000062-GPOS-00031', 'SRG-OS-000471-GPOS-00216', 'SRG-OS-000477-GPOS-00222']\n  tag 'documentable'\n  tag cci: ['CCI-000169', 'CCI-000172']\n  tag nist: ['AU-12 a', 'AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254158.rb"},"title":"Nutanix AOS must be configured to audit the loading and unloading of dynamic kernel modules.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n","check":"Confirm Nutanix AOS generates audit records for all kernel module load, unload, restart actions, and initiations.\n\n$ sudo grep -iw create_module /etc/audit/audit.rules\n-a always,exit -F arch=b32 -S create_module -k module-change\n-a always,exit -F arch=b64 -S create_module -k module-change\n\n$ sudo grep -iw init_module /etc/audit/audit.rules \n-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n-a always,exit -F arch=b32 -S init_module -S delete_module -k modules\n\n$ sudo grep -iw finit_module /etc/audit/audit.rules\n-a always,exit -F arch=b32 -S finit_module -k module-change\n-a always,exit -F arch=b64 -S finit_module -k module-change\n\n$ sudo grep -iw delete_module /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S init_module -S delete_module -k modules\n-a always,exit -F arch=b32 -S init_module -S delete_module -k modules\n\nIf both the \"b32\" and \"b64\" audit rules are not defined for the module(s) listed syscall, this is a finding.\n\n$ sudo grep -iw kmod /etc/audit/audit.rules\n-w /usr/bin/kmod -p x -F auid!=unset -k module-change\n\nIf the command does not return any output, this is a finding.\n\n$ sudo cat /boot/grub/grub.conf | grep audit\n\tkernel /boot/vmlinuz-3.10.0-1160.24.1.el7.nutanix.20210425.cvm.x86_64 ro root=UUID=71a1fe8c-812f-4403-80ed-894f554b061c rd_NO_LUKS rd_NO_LVM rd_NO_MD rd_NO_DM LANG=en_US.UTF-8 SYSFONT=latarcyrheb-sun16 rhgb crashkernel=auto KEYBOARDTYPE=pc KEYTABLE=us audit=1 audit_backlog_limit=8192 nousb fips=1 nomodeset biosdevname=0 net.ifnames=0 scsi_mod.use_blk_mq=y panic=30 console=ttyS0,115200n8 console=tty0 clocksource=tsc kvm_nopvspin=1 xen_nopvspin=1 hv_netvsc.ring_size=512 mds=off mitigations=off\n\nIf the command(s) does not return the appropriate response line, as indicated above, or if the line(s) is commented out, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57643r846560_chk","severity":"medium","gid":"V-254158","rid":"SV-254158r846562_rule","stig_id":"NUTX-OS-000540","gtitle":"SRG-OS-000062-GPOS-00031","fix_id":"F-57594r846561_fix","satisfies":["SRG-OS-000062-GPOS-00031","SRG-OS-000471-GPOS-00216","SRG-OS-000477-GPOS-00222"],"documentable":null,"cci":["CCI-000169","CCI-000172"],"nist":["AU-12 a","AU-12 c"]}},{"id":"SV-254159","code":"control 'SV-254159' do\n  title 'Nutanix AOS must generate audit records when concurrent logons to the same account occur from different sources.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records when concurrent logons to the same account occur.\n\n$ sudo  grep -i /var/run/faillock /etc/audit/audit.rules\n-w /var/run/faillock -p wa -k logins\n\n$ sudo grep -i /var/log/lastlog /etc/audit/audit.rules\n-w /var/log/lastlog -p wa -k logins \n\nIf the commands listed do not return any output, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57644r846563_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254159'\n  tag rid: 'SV-254159r846565_rule'\n  tag stig_id: 'NUTX-OS-000560'\n  tag gtitle: 'SRG-OS-000473-GPOS-00218'\n  tag fix_id: 'F-57595r846564_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254159.rb"},"title":"Nutanix AOS must generate audit records when concurrent logons to the same account occur from different sources.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records when concurrent logons to the same account occur.\n\n$ sudo  grep -i /var/run/faillock /etc/audit/audit.rules\n-w /var/run/faillock -p wa -k logins\n\n$ sudo grep -i /var/log/lastlog /etc/audit/audit.rules\n-w /var/log/lastlog -p wa -k logins \n\nIf the commands listed do not return any output, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57644r846563_chk","severity":"medium","gid":"V-254159","rid":"SV-254159r846565_rule","stig_id":"NUTX-OS-000560","gtitle":"SRG-OS-000473-GPOS-00218","fix_id":"F-57595r846564_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254160","code":"control 'SV-254160' do\n  title 'Nutanix AOS must generate audit records when successful/unsuccessful accesses to objects occur.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access privileges occur.\n\n$ sudo grep -iw chown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chown -F auid=0 -k audit_time_perm_mod_export_delete\n -a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw fchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a exit,never -F arch=b64 -S openat -S open -S fchown -F success=0 -F uid=1000 -F exit=-13.\n -a exit,never -F arch=b64 -S fchown -F success=0 -F uid=0 -F exit=-13.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw lchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw fchownat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57645r846566_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254160'\n  tag rid: 'SV-254160r846568_rule'\n  tag stig_id: 'NUTX-OS-000570'\n  tag gtitle: 'SRG-OS-000474-GPOS-00219'\n  tag fix_id: 'F-57596r846567_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254160.rb"},"title":"Nutanix AOS must generate audit records when successful/unsuccessful accesses to objects occur.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records on all successful/unsuccessful attempts to access privileges occur.\n\n$ sudo grep -iw chown /etc/audit/audit.rules\n-a always,exit -F arch=b64 -S chown -F auid=0 -k audit_time_perm_mod_export_delete\n -a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw fchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a exit,never -F arch=b64 -S openat -S open -S fchown -F success=0 -F uid=1000 -F exit=-13.\n -a exit,never -F arch=b64 -S fchown -F success=0 -F uid=0 -F exit=-13.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw lchown /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.\n\n$ sudo grep -iw fchownat /etc/audit/audit.rules\n -a always,exit -F arch=b64 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid=0 -k audit_time_perm_mod_export_delete.\n -a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=4294967295 -k audit_time_perm_mod_export_delete.\nIf the output does not contain all of the above rules, this is a finding.\nIf both the \"b32\" and \"b64\" audit rules are not defined for the listed syscall(s), this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57645r846566_chk","severity":"medium","gid":"V-254160","rid":"SV-254160r846568_rule","stig_id":"NUTX-OS-000570","gtitle":"SRG-OS-000474-GPOS-00219","fix_id":"F-57596r846567_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254161","code":"control 'SV-254161' do\n  title 'Nutanix AOS must generate audit records for all direct access to the information system.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n'\n  desc 'check', 'Confirm Nutanix AOS is configured with the ausearch tool. The ausearch tool is a feature of the audit rpm. \n\n$ sudo yum list installed audit\nInstalled Packages\naudit.x86_64\n\nIf Installed Packages does not list the audit.x86_64 or No matching Packages to list is returned, this is a finding.'\n  desc 'fix', 'Configure the system to generate audit records for all direct access to the information system by installing the audit package.\n\n$ sudo yum install audit'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57646r846569_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254161'\n  tag rid: 'SV-254161r846571_rule'\n  tag stig_id: 'NUTX-OS-000580'\n  tag gtitle: 'SRG-OS-000472-GPOS-00217'\n  tag fix_id: 'F-57597r846570_fix'\n  tag satisfies: ['SRG-OS-000472-GPOS-00217', 'SRG-OS-000475-GPOS-00220']\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254161.rb"},"title":"Nutanix AOS must generate audit records for all direct access to the information system.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n","check":"Confirm Nutanix AOS is configured with the ausearch tool. The ausearch tool is a feature of the audit rpm. \n\n$ sudo yum list installed audit\nInstalled Packages\naudit.x86_64\n\nIf Installed Packages does not list the audit.x86_64 or No matching Packages to list is returned, this is a finding.","fix":"Configure the system to generate audit records for all direct access to the information system by installing the audit package.\n\n$ sudo yum install audit"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57646r846569_chk","severity":"medium","gid":"V-254161","rid":"SV-254161r846571_rule","stig_id":"NUTX-OS-000580","gtitle":"SRG-OS-000472-GPOS-00217","fix_id":"F-57597r846570_fix","satisfies":["SRG-OS-000472-GPOS-00217","SRG-OS-000475-GPOS-00220"],"documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254162","code":"control 'SV-254162' do\n  title 'Nutanix AOS must generate audit records for all account creations, modifications, disabling, and termination events.'\n  desc 'Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'Confirm Nutanix AOS generates audit records for all account creation, modification, disabling, and termination.\n\n$ sudo grep /etc/passwd /etc/audit/audit.rules\n-w /etc/passwd -p wa -k audit_account_changes\n\nIf the command does not return a line, or the line is commented out, this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS to generate audit records for all account creations, modifications, disabling, and terminations by running the following command.\n\n$ sudo \tsalt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57647r846572_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254162'\n  tag rid: 'SV-254162r846574_rule'\n  tag stig_id: 'NUTX-OS-000590'\n  tag gtitle: 'SRG-OS-000476-GPOS-00221'\n  tag fix_id: 'F-57598r846573_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254162.rb"},"title":"Nutanix AOS must generate audit records for all account creations, modifications, disabling, and termination events.","desc":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"Confirm Nutanix AOS generates audit records for all account creation, modification, disabling, and termination.\n\n$ sudo grep /etc/passwd /etc/audit/audit.rules\n-w /etc/passwd -p wa -k audit_account_changes\n\nIf the command does not return a line, or the line is commented out, this is a finding.","fix":"Configure Nutanix AOS to generate audit records for all account creations, modifications, disabling, and terminations by running the following command.\n\n$ sudo \tsalt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57647r846572_chk","severity":"medium","gid":"V-254162","rid":"SV-254162r846574_rule","stig_id":"NUTX-OS-000590","gtitle":"SRG-OS-000476-GPOS-00221","fix_id":"F-57598r846573_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-254163","code":"control 'SV-254163' do\n  title 'Nutanix AOS must initiate session audits at system start-up.'\n  desc 'If auditing is enabled late in the start-up process, the actions of some start-up processes may not be audited. Some audit systems also maintain state information only available if auditing is enabled before a given process is created.'\n  desc 'check', 'Determine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.'\n  desc 'fix', 'Configure the audit service to be active and start automatically with the system at startup. The Audit service is protected and restricted to allow access or modifications only from the root account.\n$ sudo su -\n# systemctl start auditd.service'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57648r846575_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254163'\n  tag rid: 'SV-254163r846577_rule'\n  tag stig_id: 'NUTX-OS-000610'\n  tag gtitle: 'SRG-OS-000254-GPOS-00095'\n  tag fix_id: 'F-57599r846576_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001464']\n  tag nist: ['AU-14 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254163.rb"},"title":"Nutanix AOS must initiate session audits at system start-up.","desc":"If auditing is enabled late in the start-up process, the actions of some start-up processes may not be audited. Some audit systems also maintain state information only available if auditing is enabled before a given process is created.","descriptions":{"default":"If auditing is enabled late in the start-up process, the actions of some start-up processes may not be audited. Some audit systems also maintain state information only available if auditing is enabled before a given process is created.","check":"Determine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.","fix":"Configure the audit service to be active and start automatically with the system at startup. The Audit service is protected and restricted to allow access or modifications only from the root account.\n$ sudo su -\n# systemctl start auditd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57648r846575_chk","severity":"medium","gid":"V-254163","rid":"SV-254163r846577_rule","stig_id":"NUTX-OS-000610","gtitle":"SRG-OS-000254-GPOS-00095","fix_id":"F-57599r846576_fix","documentable":null,"cci":["CCI-001464"],"nist":["AU-14 (1)"]}},{"id":"SV-254164","code":"control 'SV-254164' do\n  title 'Nutanix AOS must produce audit records containing information to establish what type of events occurred.'\n  desc 'Without establishing what type of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the operating system audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.'\n  desc 'check', 'Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo auditctl -l | grep -iw /usr/bin/su /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo auditctl -l | grep -iw /usr/bin/sudo /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -i \"/etc/sudoers\" /etc/audit/audit.rules\nIf the output is not -w /etc/sudoers -p wa -k actions, this is a finding.\n\n$ sudo grep -i \"/etc/sudoers.d/\" /etc/audit/audit.rules\nIf the output is not -w /etc/sudoers.d/ -p wa -k actions, this is a finding.\n\n$ sudo grep -i /usr/bin/newgrp /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -i /usr/bin/chsh /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57649r846578_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254164'\n  tag rid: 'SV-254164r846580_rule'\n  tag stig_id: 'NUTX-OS-000620'\n  tag gtitle: 'SRG-OS-000037-GPOS-00015'\n  tag fix_id: 'F-57600r846579_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000130']\n  tag nist: ['AU-3 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254164.rb"},"title":"Nutanix AOS must produce audit records containing information to establish what type of events occurred.","desc":"Without establishing what type of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the operating system audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.","descriptions":{"default":"Without establishing what type of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.\n\nAssociating event types with detected events in the operating system audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.","check":"Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo auditctl -l | grep -iw /usr/bin/su /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/su -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo auditctl -l | grep -iw /usr/bin/sudo /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -i \"/etc/sudoers\" /etc/audit/audit.rules\nIf the output is not -w /etc/sudoers -p wa -k actions, this is a finding.\n\n$ sudo grep -i \"/etc/sudoers.d/\" /etc/audit/audit.rules\nIf the output is not -w /etc/sudoers.d/ -p wa -k actions, this is a finding.\n\n$ sudo grep -i /usr/bin/newgrp /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -i /usr/bin/chsh /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57649r846578_chk","severity":"medium","gid":"V-254164","rid":"SV-254164r846580_rule","stig_id":"NUTX-OS-000620","gtitle":"SRG-OS-000037-GPOS-00015","fix_id":"F-57600r846579_fix","documentable":null,"cci":["CCI-000130"],"nist":["AU-3 a"]}},{"id":"SV-254165","code":"control 'SV-254165' do\n  title 'Nutanix AOS must produce audit records containing information to establish when events occurred.'\n  desc 'Without establishing when events occurred, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.\n\nTo compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know when events occurred (date and time).\n\nAssociating event types with detected events in the operating system audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.'\n  desc 'check', 'Verify the operating system produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.'\n  desc 'fix', 'Enable the auditd service to run automatically.\n\n$ sudo systemctl enable auditd'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57650r846581_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254165'\n  tag rid: 'SV-254165r846583_rule'\n  tag stig_id: 'NUTX-OS-000630'\n  tag gtitle: 'SRG-OS-000038-GPOS-00016'\n  tag fix_id: 'F-57601r846582_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000131']\n  tag nist: ['AU-3 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254165.rb"},"title":"Nutanix AOS must produce audit records containing information to establish when events occurred.","desc":"Without establishing when events occurred, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.\n\nTo compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know when events occurred (date and time).\n\nAssociating event types with detected events in the operating system audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.","descriptions":{"default":"Without establishing when events occurred, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.\n\nTo compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know when events occurred (date and time).\n\nAssociating event types with detected events in the operating system audit logs provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.","check":"Verify the operating system produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.","fix":"Enable the auditd service to run automatically.\n\n$ sudo systemctl enable auditd"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57650r846581_chk","severity":"medium","gid":"V-254165","rid":"SV-254165r846583_rule","stig_id":"NUTX-OS-000630","gtitle":"SRG-OS-000038-GPOS-00016","fix_id":"F-57601r846582_fix","documentable":null,"cci":["CCI-000131"],"nist":["AU-3 b"]}},{"id":"SV-254166","code":"control 'SV-254166' do\n  title 'Nutanix AOS must produce audit records containing information to establish where events occurred.'\n  desc 'Without establishing where events occurred, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.\n\nTo compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know where events occurred, such as operating system components, modules, device identifiers, node names, file names, and functionality.\n\nAssociating information about where the event occurred within the operating system provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.'\n  desc 'check', 'Verify the operating system produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.'\n  desc 'fix', 'Enable the auditd service to run automatically.\n\n$ sudo systemctl enable auditd'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57651r846584_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254166'\n  tag rid: 'SV-254166r846586_rule'\n  tag stig_id: 'NUTX-OS-000640'\n  tag gtitle: 'SRG-OS-000039-GPOS-00017'\n  tag fix_id: 'F-57602r846585_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000132']\n  tag nist: ['AU-3 c']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254166.rb"},"title":"Nutanix AOS must produce audit records containing information to establish where events occurred.","desc":"Without establishing where events occurred, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.\n\nTo compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know where events occurred, such as operating system components, modules, device identifiers, node names, file names, and functionality.\n\nAssociating information about where the event occurred within the operating system provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.","descriptions":{"default":"Without establishing where events occurred, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.\n\nTo compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know where events occurred, such as operating system components, modules, device identifiers, node names, file names, and functionality.\n\nAssociating information about where the event occurred within the operating system provides a means of investigating an attack; recognizing resource utilization or capacity thresholds; or identifying an improperly configured operating system.","check":"Verify the operating system produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.","fix":"Enable the auditd service to run automatically.\n\n$ sudo systemctl enable auditd"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57651r846584_chk","severity":"medium","gid":"V-254166","rid":"SV-254166r846586_rule","stig_id":"NUTX-OS-000640","gtitle":"SRG-OS-000039-GPOS-00017","fix_id":"F-57602r846585_fix","documentable":null,"cci":["CCI-000132"],"nist":["AU-3 c"]}},{"id":"SV-254167","code":"control 'SV-254167' do\n  title 'Nutanix AOS must produce audit records containing information to establish the source of events.'\n  desc 'Without establishing the source of the event, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.\n\nIn addition to logging where events occur within the operating system, the operating system must also generate audit records that identify sources of events. Sources of operating system events include, but are not limited to, processes, and services.\n\nTo compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know the source of the event.'\n  desc 'check', 'Verify the operating system produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.'\n  desc 'fix', 'Enable the auditd service to run automatically.\n\n$ sudo systemctl enable auditd'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57652r846587_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254167'\n  tag rid: 'SV-254167r846589_rule'\n  tag stig_id: 'NUTX-OS-000650'\n  tag gtitle: 'SRG-OS-000040-GPOS-00018'\n  tag fix_id: 'F-57603r846588_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000133']\n  tag nist: ['AU-3 d']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254167.rb"},"title":"Nutanix AOS must produce audit records containing information to establish the source of events.","desc":"Without establishing the source of the event, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.\n\nIn addition to logging where events occur within the operating system, the operating system must also generate audit records that identify sources of events. Sources of operating system events include, but are not limited to, processes, and services.\n\nTo compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know the source of the event.","descriptions":{"default":"Without establishing the source of the event, it is impossible to establish, correlate, and investigate the events leading up to an outage or attack.\n\nIn addition to logging where events occur within the operating system, the operating system must also generate audit records that identify sources of events. Sources of operating system events include, but are not limited to, processes, and services.\n\nTo compile an accurate risk assessment and provide forensic analysis, it is essential for security personnel to know the source of the event.","check":"Verify the operating system produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.","fix":"Enable the auditd service to run automatically.\n\n$ sudo systemctl enable auditd"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57652r846587_chk","severity":"medium","gid":"V-254167","rid":"SV-254167r846589_rule","stig_id":"NUTX-OS-000650","gtitle":"SRG-OS-000040-GPOS-00018","fix_id":"F-57603r846588_fix","documentable":null,"cci":["CCI-000133"],"nist":["AU-3 d"]}},{"id":"SV-254168","code":"control 'SV-254168' do\n  title 'Nutanix AOS must produce audit records containing information to establish the outcome of events.'\n  desc 'Without information about the outcome of events, security personnel cannot make an accurate assessment as to whether an attack was successful or if changes were made to the security state of the system.\n\nEvent outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the information system after the event occurred). As such, they also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response.'\n  desc 'check', 'Verify the operating system produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.'\n  desc 'fix', 'Enable the auditd service to run automatically.\n\n$ sudo systemctl enable auditd'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57653r846590_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254168'\n  tag rid: 'SV-254168r846592_rule'\n  tag stig_id: 'NUTX-OS-000660'\n  tag gtitle: 'SRG-OS-000041-GPOS-00019'\n  tag fix_id: 'F-57604r846591_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000134']\n  tag nist: ['AU-3 e']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254168.rb"},"title":"Nutanix AOS must produce audit records containing information to establish the outcome of events.","desc":"Without information about the outcome of events, security personnel cannot make an accurate assessment as to whether an attack was successful or if changes were made to the security state of the system.\n\nEvent outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the information system after the event occurred). As such, they also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response.","descriptions":{"default":"Without information about the outcome of events, security personnel cannot make an accurate assessment as to whether an attack was successful or if changes were made to the security state of the system.\n\nEvent outcomes can include indicators of event success or failure and event-specific results (e.g., the security state of the information system after the event occurred). As such, they also provide a means to measure the impact of an event and help authorized personnel to determine the appropriate response.","check":"Verify the operating system produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.","fix":"Enable the auditd service to run automatically.\n\n$ sudo systemctl enable auditd"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57653r846590_chk","severity":"medium","gid":"V-254168","rid":"SV-254168r846592_rule","stig_id":"NUTX-OS-000660","gtitle":"SRG-OS-000041-GPOS-00019","fix_id":"F-57604r846591_fix","documentable":null,"cci":["CCI-000134"],"nist":["AU-3 e"]}},{"id":"SV-254169","code":"control 'SV-254169' do\n  title 'Nutanix AOS must produce audit records containing information to establish the identity of any individual or process associated with the event.'\n  desc 'Without information that establishes the identity of the subjects (i.e., users or processes acting on behalf of users) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.'\n  desc 'check', 'Confirm Nutanix AOS produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.'\n  desc 'fix', 'Configure the audit service to be active and start automatically with the system at startup. The Audit service is protected and restricted to allow access or modifications only from the root account.\n\n$ sudo su -\n# systemctl start auditd.service'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57654r846593_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254169'\n  tag rid: 'SV-254169r846595_rule'\n  tag stig_id: 'NUTX-OS-000670'\n  tag gtitle: 'SRG-OS-000255-GPOS-00096'\n  tag fix_id: 'F-57605r846594_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001487']\n  tag nist: ['AU-3 f']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254169.rb"},"title":"Nutanix AOS must produce audit records containing information to establish the identity of any individual or process associated with the event.","desc":"Without information that establishes the identity of the subjects (i.e., users or processes acting on behalf of users) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.","descriptions":{"default":"Without information that establishes the identity of the subjects (i.e., users or processes acting on behalf of users) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.","check":"Confirm Nutanix AOS produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.","fix":"Configure the audit service to be active and start automatically with the system at startup. The Audit service is protected and restricted to allow access or modifications only from the root account.\n\n$ sudo su -\n# systemctl start auditd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57654r846593_chk","severity":"medium","gid":"V-254169","rid":"SV-254169r846595_rule","stig_id":"NUTX-OS-000670","gtitle":"SRG-OS-000255-GPOS-00096","fix_id":"F-57605r846594_fix","documentable":null,"cci":["CCI-001487"],"nist":["AU-3 f"]}},{"id":"SV-254170","code":"control 'SV-254170' do\n  title 'Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the passwd/gpasswd/unix-chkpwd privileged commands.'\n  desc 'Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.'\n  desc 'check', 'Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -i /usr/bin/passwd /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/passwd -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -iw /usr/sbin/unix_chkpwd /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/sbin/unix_chkpwd -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -i /usr/bin/gpasswd /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/gpasswd -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57655r846596_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254170'\n  tag rid: 'SV-254170r846598_rule'\n  tag stig_id: 'NUTX-OS-000680'\n  tag gtitle: 'SRG-OS-000042-GPOS-00020'\n  tag fix_id: 'F-57606r846597_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000135']\n  tag nist: ['AU-3 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254170.rb"},"title":"Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the passwd/gpasswd/unix-chkpwd privileged commands.","desc":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","descriptions":{"default":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","check":"Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -i /usr/bin/passwd /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/passwd -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -iw /usr/sbin/unix_chkpwd /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/sbin/unix_chkpwd -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -i /usr/bin/gpasswd /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/gpasswd -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57655r846596_chk","severity":"medium","gid":"V-254170","rid":"SV-254170r846598_rule","stig_id":"NUTX-OS-000680","gtitle":"SRG-OS-000042-GPOS-00020","fix_id":"F-57606r846597_fix","documentable":null,"cci":["CCI-000135"],"nist":["AU-3 (1)"]}},{"id":"SV-254171","code":"control 'SV-254171' do\n  title 'Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the chage privileged command.'\n  desc 'Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.'\n  desc 'check', 'Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -i /usr/bin/chage /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/chage -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57656r846599_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254171'\n  tag rid: 'SV-254171r846601_rule'\n  tag stig_id: 'NUTX-OS-000690'\n  tag gtitle: 'SRG-OS-000042-GPOS-00020'\n  tag fix_id: 'F-57607r846600_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000135']\n  tag nist: ['AU-3 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254171.rb"},"title":"Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the chage privileged command.","desc":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","descriptions":{"default":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","check":"Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -i /usr/bin/chage /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/chage -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57656r846599_chk","severity":"medium","gid":"V-254171","rid":"SV-254171r846601_rule","stig_id":"NUTX-OS-000690","gtitle":"SRG-OS-000042-GPOS-00020","fix_id":"F-57607r846600_fix","documentable":null,"cci":["CCI-000135"],"nist":["AU-3 (1)"]}},{"id":"SV-254172","code":"control 'SV-254172' do\n  title 'Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the userhelper privileged command.'\n  desc 'Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.'\n  desc 'check', 'Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -i /usr/sbin/userhelper /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/sbin/userhelper -F auid>=1000 -F auid!=4294967295 -k privileged-passwd, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57657r846602_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254172'\n  tag rid: 'SV-254172r846604_rule'\n  tag stig_id: 'NUTX-OS-000700'\n  tag gtitle: 'SRG-OS-000042-GPOS-00020'\n  tag fix_id: 'F-57608r846603_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000135']\n  tag nist: ['AU-3 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254172.rb"},"title":"Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the userhelper privileged command.","desc":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","descriptions":{"default":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","check":"Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -i /usr/sbin/userhelper /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/sbin/userhelper -F auid>=1000 -F auid!=4294967295 -k privileged-passwd, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57657r846602_chk","severity":"medium","gid":"V-254172","rid":"SV-254172r846604_rule","stig_id":"NUTX-OS-000700","gtitle":"SRG-OS-000042-GPOS-00020","fix_id":"F-57608r846603_fix","documentable":null,"cci":["CCI-000135"],"nist":["AU-3 (1)"]}},{"id":"SV-254173","code":"control 'SV-254173' do\n  title 'Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the mount and umount privileged commands.'\n  desc 'Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.'\n  desc 'check', 'Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -iw \"mount\" /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -iw \"/usr/bin/umount\" /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57658r846605_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254173'\n  tag rid: 'SV-254173r846607_rule'\n  tag stig_id: 'NUTX-OS-000710'\n  tag gtitle: 'SRG-OS-000042-GPOS-00020'\n  tag fix_id: 'F-57609r846606_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000135']\n  tag nist: ['AU-3 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254173.rb"},"title":"Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the mount and umount privileged commands.","desc":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","descriptions":{"default":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","check":"Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -iw \"mount\" /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -iw \"/usr/bin/umount\" /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57658r846605_chk","severity":"medium","gid":"V-254173","rid":"SV-254173r846607_rule","stig_id":"NUTX-OS-000710","gtitle":"SRG-OS-000042-GPOS-00020","fix_id":"F-57609r846606_fix","documentable":null,"cci":["CCI-000135"],"nist":["AU-3 (1)"]}},{"id":"SV-254174","code":"control 'SV-254174' do\n  title 'Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the post-related privileged commands.'\n  desc 'Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.'\n  desc 'check', 'Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -iw /usr/sbin/postdrop /etc/audit/audit.rules\nIf the output is not clear-a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -iw /usr/sbin/postqueue /etc/audit/audit.rules\nIf the output in not, -a always,exit -F path=/usr/sbin/postqueue -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57659r846608_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254174'\n  tag rid: 'SV-254174r846610_rule'\n  tag stig_id: 'NUTX-OS-000720'\n  tag gtitle: 'SRG-OS-000042-GPOS-00020'\n  tag fix_id: 'F-57610r846609_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000135']\n  tag nist: ['AU-3 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254174.rb"},"title":"Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the post-related privileged commands.","desc":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","descriptions":{"default":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","check":"Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -iw /usr/sbin/postdrop /etc/audit/audit.rules\nIf the output is not clear-a always,exit -F path=/usr/sbin/postdrop -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.\n\n$ sudo grep -iw /usr/sbin/postqueue /etc/audit/audit.rules\nIf the output in not, -a always,exit -F path=/usr/sbin/postqueue -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57659r846608_chk","severity":"medium","gid":"V-254174","rid":"SV-254174r846610_rule","stig_id":"NUTX-OS-000720","gtitle":"SRG-OS-000042-GPOS-00020","fix_id":"F-57610r846609_fix","documentable":null,"cci":["CCI-000135"],"nist":["AU-3 (1)"]}},{"id":"SV-254175","code":"control 'SV-254175' do\n  title 'Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the opensshrelated privileged commands.'\n  desc 'Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.'\n  desc 'check', 'Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -iw /usr/libexec/openssh/ssh-keysign /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57660r846611_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254175'\n  tag rid: 'SV-254175r846613_rule'\n  tag stig_id: 'NUTX-OS-000730'\n  tag gtitle: 'SRG-OS-000042-GPOS-00020'\n  tag fix_id: 'F-57611r846612_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000135']\n  tag nist: ['AU-3 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254175.rb"},"title":"Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the opensshrelated privileged commands.","desc":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","descriptions":{"default":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","check":"Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -iw /usr/libexec/openssh/ssh-keysign /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/libexec/openssh/ssh-keysign -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57660r846611_chk","severity":"medium","gid":"V-254175","rid":"SV-254175r846613_rule","stig_id":"NUTX-OS-000730","gtitle":"SRG-OS-000042-GPOS-00020","fix_id":"F-57611r846612_fix","documentable":null,"cci":["CCI-000135"],"nist":["AU-3 (1)"]}},{"id":"SV-254176","code":"control 'SV-254176' do\n  title 'Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the crontab-related privileged commands.'\n  desc 'Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.'\n  desc 'check', 'Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -iw /usr/bin/crontab /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/crontab -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.'\n  desc 'fix', 'Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57661r846614_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254176'\n  tag rid: 'SV-254176r846616_rule'\n  tag stig_id: 'NUTX-OS-000740'\n  tag gtitle: 'SRG-OS-000042-GPOS-00020'\n  tag fix_id: 'F-57612r846615_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000135']\n  tag nist: ['AU-3 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254176.rb"},"title":"Nutanix AOS must produce audit records containing the full-text recording of successful and unsuccessful attempts to execute the crontab-related privileged commands.","desc":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","descriptions":{"default":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the full-text recording of privileged commands. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the cause and impact of compromise.","check":"Verify Nutanix AOS generates audit records when successful/unsuccessful attempts to use the following commands occur.\n\nCheck that the following system call is being audited by performing the following command to check the file system rules in \"/etc/audit/audit.rules\":\n\n$ sudo grep -iw /usr/bin/crontab /etc/audit/audit.rules\nIf the output is not -a always,exit -F path=/usr/bin/crontab -F auid>=1000 -F auid!=4294967295 -k privileged, this is a finding.","fix":"Configure the audit rules by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57661r846614_chk","severity":"medium","gid":"V-254176","rid":"SV-254176r846616_rule","stig_id":"NUTX-OS-000740","gtitle":"SRG-OS-000042-GPOS-00020","fix_id":"F-57612r846615_fix","documentable":null,"cci":["CCI-000135"],"nist":["AU-3 (1)"]}},{"id":"SV-254177","code":"control 'SV-254177' do\n  title 'Nutanix AOS must produce audit records containing the individual identities of group account users.'\n  desc 'Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the individual identities of group users. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the actual account involved in the activity.'\n  desc 'check', 'Verify Nutanix AOS produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.'\n  desc 'fix', 'Enable the auditd service to run automatically.\n\n$ sudo systemctl enable auditd'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57662r846617_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254177'\n  tag rid: 'SV-254177r846619_rule'\n  tag stig_id: 'NUTX-OS-000750'\n  tag gtitle: 'SRG-OS-000042-GPOS-00021'\n  tag fix_id: 'F-57613r846618_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000135']\n  tag nist: ['AU-3 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254177.rb"},"title":"Nutanix AOS must produce audit records containing the individual identities of group account users.","desc":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the individual identities of group users. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the actual account involved in the activity.","descriptions":{"default":"Reconstruction of harmful events or forensic analysis is not possible if audit records do not contain enough information.\n\nAt a minimum, the organization must audit the individual identities of group users. The organization must maintain audit trails in sufficient detail to reconstruct events to determine the actual account involved in the activity.","check":"Verify Nutanix AOS produces audit records containing information to establish when (date and time) the events occurred.\n\nDetermine if auditing is active by issuing the following command:\n\n$ sudo systemctl is-active auditd.service\nactive\n\nIf the \"auditd\" status is not active, this is a finding.","fix":"Enable the auditd service to run automatically.\n\n$ sudo systemctl enable auditd"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57662r846617_chk","severity":"medium","gid":"V-254177","rid":"SV-254177r846619_rule","stig_id":"NUTX-OS-000750","gtitle":"SRG-OS-000042-GPOS-00021","fix_id":"F-57613r846618_fix","documentable":null,"cci":["CCI-000135"],"nist":["AU-3 (1)"]}},{"id":"SV-254178","code":"control 'SV-254178' do\n  title \"Nutanix AOS must allocate audit record storage capacity to store at least one week's worth of audit records, when audit records are not immediately sent to a central audit record storage facility.\"\n  desc 'To ensure operating systems have a sufficient storage capacity in which to write the audit logs, operating systems must be able to allocate audit record storage capacity.\n\nThe task of allocating audit record storage capacity is usually performed during initial installation of the operating system.'\n  desc 'check', %q(Confirm Nutanix AOS preconfigures storage for one week's worth of audit records, when audit records are not immediately sent to a central audit record facility.\n\n$ sudo cat /boot/grub/grub.conf | grep audit_backlog_limit\naudit_backlog_limit=8192\n\nIf the \"audit_backlog_limit\" entry does not equal \"8192\", is missing, or the line is commented out, this is a finding.)\n  desc 'fix', 'As root, modify the /boot/grub/grub.conf file to include the following line:\n\naudit_backlog_limit=8192'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57663r846620_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254178'\n  tag rid: 'SV-254178r846622_rule'\n  tag stig_id: 'NUTX-OS-000760'\n  tag gtitle: 'SRG-OS-000341-GPOS-00132'\n  tag fix_id: 'F-57614r846621_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001849']\n  tag nist: ['AU-4']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254178.rb"},"title":"Nutanix AOS must allocate audit record storage capacity to store at least one week's worth of audit records, when audit records are not immediately sent to a central audit record storage facility.","desc":"To ensure operating systems have a sufficient storage capacity in which to write the audit logs, operating systems must be able to allocate audit record storage capacity.\n\nThe task of allocating audit record storage capacity is usually performed during initial installation of the operating system.","descriptions":{"default":"To ensure operating systems have a sufficient storage capacity in which to write the audit logs, operating systems must be able to allocate audit record storage capacity.\n\nThe task of allocating audit record storage capacity is usually performed during initial installation of the operating system.","check":"Confirm Nutanix AOS preconfigures storage for one week's worth of audit records, when audit records are not immediately sent to a central audit record facility.\n\n$ sudo cat /boot/grub/grub.conf | grep audit_backlog_limit\naudit_backlog_limit=8192\n\nIf the \"audit_backlog_limit\" entry does not equal \"8192\", is missing, or the line is commented out, this is a finding.","fix":"As root, modify the /boot/grub/grub.conf file to include the following line:\n\naudit_backlog_limit=8192"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57663r846620_chk","severity":"medium","gid":"V-254178","rid":"SV-254178r846622_rule","stig_id":"NUTX-OS-000760","gtitle":"SRG-OS-000341-GPOS-00132","fix_id":"F-57614r846621_fix","documentable":null,"cci":["CCI-001849"],"nist":["AU-4"]}},{"id":"SV-254179","code":"control 'SV-254179' do\n  title 'Nutanix AOS must offload audit records to a syslog server.'\n  desc 'Information stored in one location is vulnerable to accidental or incidental deletion or alteration. Offloading is a common process in information systems with limited audit storage capacity.\n\n'\n  desc 'check', 'Confirm Nutanix AOS is configured to offload the audit records to a site-specific syslog server.\n\n$ sudo grep @ /etc/rsyslog.d/rsyslog-nutanix.conf\nlocal0.*; @remote-log-host:514\n\nIf there are no lines in the \"/etc/rsyslog.d/rsyslog-nutanix.conf\" files that contain the \"@\" or \"@@\" symbol(s), and the lines with the correct symbol(s) to send output to another system do not cover all \"rsyslog\" output, ask the System Administrator to indicate how the audit logs are offloaded to a different system or media.\n\nIf the lines are commented out or there is no evidence that the audit logs are being sent to another system, this is a finding.'\n  desc 'fix', 'Configure AOS to offload audit records to site specific syslog server by running the following command.\n\nncli rsyslog-config add-server name=[alias_of_central_host] ip-address=[IP_of_central_host] port=[port_of_central_host] network-protocol=tcp|udp|relp relp-enabled=yes|no; ncli rsyslog-config add-module module-name=syslog_module level=info server-name=[alias_of_central_host]'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57664r846623_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254179'\n  tag rid: 'SV-254179r846625_rule'\n  tag stig_id: 'NUTX-OS-000770'\n  tag gtitle: 'SRG-OS-000342-GPOS-00133'\n  tag fix_id: 'F-57615r846624_fix'\n  tag satisfies: ['SRG-OS-000342-GPOS-00133', 'SRG-OS-000479-GPOS-00224']\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254179.rb"},"title":"Nutanix AOS must offload audit records to a syslog server.","desc":"Information stored in one location is vulnerable to accidental or incidental deletion or alteration. Offloading is a common process in information systems with limited audit storage capacity.\n\n","descriptions":{"default":"Information stored in one location is vulnerable to accidental or incidental deletion or alteration. Offloading is a common process in information systems with limited audit storage capacity.\n\n","check":"Confirm Nutanix AOS is configured to offload the audit records to a site-specific syslog server.\n\n$ sudo grep @ /etc/rsyslog.d/rsyslog-nutanix.conf\nlocal0.*; @remote-log-host:514\n\nIf there are no lines in the \"/etc/rsyslog.d/rsyslog-nutanix.conf\" files that contain the \"@\" or \"@@\" symbol(s), and the lines with the correct symbol(s) to send output to another system do not cover all \"rsyslog\" output, ask the System Administrator to indicate how the audit logs are offloaded to a different system or media.\n\nIf the lines are commented out or there is no evidence that the audit logs are being sent to another system, this is a finding.","fix":"Configure AOS to offload audit records to site specific syslog server by running the following command.\n\nncli rsyslog-config add-server name=[alias_of_central_host] ip-address=[IP_of_central_host] port=[port_of_central_host] network-protocol=tcp|udp|relp relp-enabled=yes|no; ncli rsyslog-config add-module module-name=syslog_module level=info server-name=[alias_of_central_host]"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57664r846623_chk","severity":"medium","gid":"V-254179","rid":"SV-254179r846625_rule","stig_id":"NUTX-OS-000770","gtitle":"SRG-OS-000342-GPOS-00133","fix_id":"F-57615r846624_fix","satisfies":["SRG-OS-000342-GPOS-00133","SRG-OS-000479-GPOS-00224"],"documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}},{"id":"SV-254180","code":"control 'SV-254180' do\n  title 'Nutanix AOS must shut down by default upon audit failure (unless availability is an overriding concern).'\n  desc 'It is critical that when the operating system is at risk of failing to process audit logs as required, it takes action to mitigate the failure. Audit processing failures include software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.\n\nWhen availability is an overriding concern, other approved actions in response to an audit failure are as follows:\n\n1) If the failure was caused by the lack of audit record storage capacity, the operating system must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.\n\n2) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the operating system must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.'\n  desc 'check', 'Confirm the audit configuration regarding how auditing processing failures are handled in Nutanix AOS.\n\n$ sudo auditctl -s | grep -i \"fail\"\nIf the output is not failure 1, this is a finding.'\n  desc 'fix', 'Configure the audit alert setting by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57665r846626_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254180'\n  tag rid: 'SV-254180r846628_rule'\n  tag stig_id: 'NUTX-OS-000780'\n  tag gtitle: 'SRG-OS-000047-GPOS-00023'\n  tag fix_id: 'F-57616r846627_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000140']\n  tag nist: ['AU-5 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254180.rb"},"title":"Nutanix AOS must shut down by default upon audit failure (unless availability is an overriding concern).","desc":"It is critical that when the operating system is at risk of failing to process audit logs as required, it takes action to mitigate the failure. Audit processing failures include software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.\n\nWhen availability is an overriding concern, other approved actions in response to an audit failure are as follows:\n\n1) If the failure was caused by the lack of audit record storage capacity, the operating system must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.\n\n2) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the operating system must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.","descriptions":{"default":"It is critical that when the operating system is at risk of failing to process audit logs as required, it takes action to mitigate the failure. Audit processing failures include software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.\n\nWhen availability is an overriding concern, other approved actions in response to an audit failure are as follows:\n\n1) If the failure was caused by the lack of audit record storage capacity, the operating system must continue generating audit records if possible (automatically restarting the audit service if necessary), overwriting the oldest audit records in a first-in-first-out manner.\n\n2) If audit records are sent to a centralized collection server and communication with this server is lost or the server fails, the operating system must queue audit records locally until communication is restored or until the audit records are retrieved manually. Upon restoration of the connection to the centralized collection server, action should be taken to synchronize the local audit data with the collection server.","check":"Confirm the audit configuration regarding how auditing processing failures are handled in Nutanix AOS.\n\n$ sudo auditctl -s | grep -i \"fail\"\nIf the output is not failure 1, this is a finding.","fix":"Configure the audit alert setting by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57665r846626_chk","severity":"medium","gid":"V-254180","rid":"SV-254180r846628_rule","stig_id":"NUTX-OS-000780","gtitle":"SRG-OS-000047-GPOS-00023","fix_id":"F-57616r846627_fix","documentable":null,"cci":["CCI-000140"],"nist":["AU-5 b"]}},{"id":"SV-254181","code":"control 'SV-254181' do\n  title 'Nutanix AOS must provide the capability to centrally review and analyze audit records from multiple components within the system.'\n  desc 'Successful incident response and auditing relies on timely, accurate system information and analysis to allow the organization to identify and respond to potential incidents in a proficient manner. If the operating system does not provide the ability to centrally review the operating system logs, forensic analysis is negatively impacted.\n\nSegregation of logging data to multiple disparate computer systems is counterproductive and makes log analysis and log event alarming difficult to implement and manage, particularly when the system has multiple logging components writing to different locations or systems.\n\nTo support the centralized capability, the operating system must be able to provide the information in a format that can be extracted and used, allowing the application performing the centralization of the log records to meet this requirement.\n\n'\n  desc 'check', 'Confirm Nutanix AOS is configured with the ausearch tool. The ausearch tool is a feature of the audit rpm. \n\n$ sudo yum list installed audit\nInstalled Packages\naudit.x86_64\n\nIf Installed Packages does not list the audit.x86_64 or No matching Packages to list is returned, this is a finding.'\n  desc 'fix', 'Configure the system to provide on-demand (i.e., ad hoc ) audit report generation by installing the correct audit.x86_64 rpm.\n\n$ sudo yum install audit'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57666r846629_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254181'\n  tag rid: 'SV-254181r846631_rule'\n  tag stig_id: 'NUTX-OS-000790'\n  tag gtitle: 'SRG-OS-000051-GPOS-00024'\n  tag fix_id: 'F-57617r846630_fix'\n  tag satisfies: ['SRG-OS-000051-GPOS-00024', 'SRG-OS-000054-GPOS-00025', 'SRG-OS-000122-GPOS-00063', 'SRG-OS-000348-GPOS-00136', 'SRG-OS-000349-GPOS-00137', 'SRG-OS-000350-GPOS-00138', 'SRG-OS-000351-GPOS-00139', 'SRG-OS-000352-GPOS-00140', 'SRG-OS-000353-GPOS-00141', 'SRG-OS-000354-GPOS-00142']\n  tag 'documentable'\n  tag cci: ['CCI-000154', 'CCI-000158', 'CCI-001875', 'CCI-001876', 'CCI-001877', 'CCI-001878', 'CCI-001879', 'CCI-001880', 'CCI-001881', 'CCI-001882']\n  tag nist: ['AU-6 (4)', 'AU-7 (1)', 'AU-7 a', 'AU-7 a', 'AU-7 a', 'AU-7 a', 'AU-7 a', 'AU-7 a', 'AU-7 b', 'AU-7 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254181.rb"},"title":"Nutanix AOS must provide the capability to centrally review and analyze audit records from multiple components within the system.","desc":"Successful incident response and auditing relies on timely, accurate system information and analysis to allow the organization to identify and respond to potential incidents in a proficient manner. If the operating system does not provide the ability to centrally review the operating system logs, forensic analysis is negatively impacted.\n\nSegregation of logging data to multiple disparate computer systems is counterproductive and makes log analysis and log event alarming difficult to implement and manage, particularly when the system has multiple logging components writing to different locations or systems.\n\nTo support the centralized capability, the operating system must be able to provide the information in a format that can be extracted and used, allowing the application performing the centralization of the log records to meet this requirement.\n\n","descriptions":{"default":"Successful incident response and auditing relies on timely, accurate system information and analysis to allow the organization to identify and respond to potential incidents in a proficient manner. If the operating system does not provide the ability to centrally review the operating system logs, forensic analysis is negatively impacted.\n\nSegregation of logging data to multiple disparate computer systems is counterproductive and makes log analysis and log event alarming difficult to implement and manage, particularly when the system has multiple logging components writing to different locations or systems.\n\nTo support the centralized capability, the operating system must be able to provide the information in a format that can be extracted and used, allowing the application performing the centralization of the log records to meet this requirement.\n\n","check":"Confirm Nutanix AOS is configured with the ausearch tool. The ausearch tool is a feature of the audit rpm. \n\n$ sudo yum list installed audit\nInstalled Packages\naudit.x86_64\n\nIf Installed Packages does not list the audit.x86_64 or No matching Packages to list is returned, this is a finding.","fix":"Configure the system to provide on-demand (i.e., ad hoc ) audit report generation by installing the correct audit.x86_64 rpm.\n\n$ sudo yum install audit"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57666r846629_chk","severity":"medium","gid":"V-254181","rid":"SV-254181r846631_rule","stig_id":"NUTX-OS-000790","gtitle":"SRG-OS-000051-GPOS-00024","fix_id":"F-57617r846630_fix","satisfies":["SRG-OS-000051-GPOS-00024","SRG-OS-000054-GPOS-00025","SRG-OS-000122-GPOS-00063","SRG-OS-000348-GPOS-00136","SRG-OS-000349-GPOS-00137","SRG-OS-000350-GPOS-00138","SRG-OS-000351-GPOS-00139","SRG-OS-000352-GPOS-00140","SRG-OS-000353-GPOS-00141","SRG-OS-000354-GPOS-00142"],"documentable":null,"cci":["CCI-000154","CCI-000158","CCI-001875","CCI-001876","CCI-001877","CCI-001878","CCI-001879","CCI-001880","CCI-001881","CCI-001882"],"nist":["AU-6 (4)","AU-7 (1)","AU-7 a","AU-7 a","AU-7 a","AU-7 a","AU-7 a","AU-7 a","AU-7 b","AU-7 b"]}},{"id":"SV-254182","code":"control 'SV-254182' do\n  title 'Nutanix AOS must compare internal information system clocks at least every 24 hours with a server synchronized to one of the redundant United States Naval Observatory (USNO) time servers, or a time server designated for the appropriate DoD network (NIPRNet/SIPRNet), and/or the Global Positioning System (GPS).'\n  desc 'Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside the configured acceptable allowance (drift) may be inaccurate.\n\nSynchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.\n\nOrganizations must consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).\n\n'\n  desc 'check', 'Confirm Nutanix AOS is running the NTP service.\n\n# sudo ps -ef | grep ntp\nntp       7447     1  0 Aug17 ?        00:00:05 /usr/sbin/ntpd -u ntp:ntp -g\n\nIf the NTP service is not running, this is a finding.\n\nNext Check the ntp.conf file for the \"maxpoll\" option setting.\n\n$ sudo grep maxpoll /etc/ntp.conf\nserver #.#.#.# maxpoll 10\n\nIf the option is set to \"17\" or is not set, this is a finding.'\n  desc 'fix', 'Log in to the Nutanix CVM.\n\nRun the following command to add a list of DoD Approved NTP servers:  $ ncli cluster add-to-ntp-servers servers=IP_1,IP_2,IP_3'\n  impact 0.3\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57667r846632_chk'\n  tag severity: 'low'\n  tag gid: 'V-254182'\n  tag rid: 'SV-254182r846801_rule'\n  tag stig_id: 'NUTX-OS-000890'\n  tag gtitle: 'SRG-OS-000355-GPOS-00143'\n  tag fix_id: 'F-57618r846633_fix'\n  tag satisfies: ['SRG-OS-000355-GPOS-00143', 'SRG-OS-000356-GPOS-00144']\n  tag 'documentable'\n  tag cci: ['CCI-001891', 'CCI-002046']\n  tag nist: ['AU-8 (1) (a)', 'AU-8 (1) (b)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254182.rb"},"title":"Nutanix AOS must compare internal information system clocks at least every 24 hours with a server synchronized to one of the redundant United States Naval Observatory (USNO) time servers, or a time server designated for the appropriate DoD network (NIPRNet/SIPRNet), and/or the Global Positioning System (GPS).","desc":"Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside the configured acceptable allowance (drift) may be inaccurate.\n\nSynchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.\n\nOrganizations must consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).\n\n","descriptions":{"default":"Inaccurate time stamps make it more difficult to correlate events and can lead to an inaccurate analysis. Determining the correct time a particular event occurred on a system is critical when conducting forensic analysis and investigating system events. Sources outside the configured acceptable allowance (drift) may be inaccurate.\n\nSynchronizing internal information system clocks provides uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.\n\nOrganizations must consider endpoints that may not have regular access to the authoritative time server (e.g., mobile, teleworking, and tactical endpoints).\n\n","check":"Confirm Nutanix AOS is running the NTP service.\n\n# sudo ps -ef | grep ntp\nntp       7447     1  0 Aug17 ?        00:00:05 /usr/sbin/ntpd -u ntp:ntp -g\n\nIf the NTP service is not running, this is a finding.\n\nNext Check the ntp.conf file for the \"maxpoll\" option setting.\n\n$ sudo grep maxpoll /etc/ntp.conf\nserver #.#.#.# maxpoll 10\n\nIf the option is set to \"17\" or is not set, this is a finding.","fix":"Log in to the Nutanix CVM.\n\nRun the following command to add a list of DoD Approved NTP servers:  $ ncli cluster add-to-ntp-servers servers=IP_1,IP_2,IP_3"},"impact":0.3,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57667r846632_chk","severity":"low","gid":"V-254182","rid":"SV-254182r846801_rule","stig_id":"NUTX-OS-000890","gtitle":"SRG-OS-000355-GPOS-00143","fix_id":"F-57618r846633_fix","satisfies":["SRG-OS-000355-GPOS-00143","SRG-OS-000356-GPOS-00144"],"documentable":null,"cci":["CCI-001891","CCI-002046"],"nist":["AU-8 (1) (a)","AU-8 (1) (b)"]}},{"id":"SV-254183","code":"control 'SV-254183' do\n  title 'Nutanix AOS must protect audit information from unauthorized access.'\n  desc 'Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.\n\nAudit information includes all information (e.g., audit records, audit settings, audit reports) needed to successfully audit operating system activity.\n\n'\n  desc 'check', 'Verify Nutanix AOS audit log permissions are \"0600\" or less permissive.\n\n$ sudo stat -c \"%a %n\" /home/log/audit/audit.log\n600 /home/log/audit/audit.log\n\nIf the audit.log file(s) are more permissive than \"0600\", this is a finding.'\n  desc 'fix', 'Run the salt stack call to set the audit log file permissions to \"600\".\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57668r846635_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254183'\n  tag rid: 'SV-254183r846637_rule'\n  tag stig_id: 'NUTX-OS-000930'\n  tag gtitle: 'SRG-OS-000057-GPOS-00027'\n  tag fix_id: 'F-57619r846636_fix'\n  tag satisfies: ['SRG-OS-000057-GPOS-00027', 'SRG-OS-000058-GPOS-00028', 'SRG-OS-000059-GPOS-00029']\n  tag 'documentable'\n  tag cci: ['CCI-000162', 'CCI-000163', 'CCI-000164']\n  tag nist: ['AU-9 a', 'AU-9 a', 'AU-9 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254183.rb"},"title":"Nutanix AOS must protect audit information from unauthorized access.","desc":"Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.\n\nAudit information includes all information (e.g., audit records, audit settings, audit reports) needed to successfully audit operating system activity.\n\n","descriptions":{"default":"Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.\n\nAudit information includes all information (e.g., audit records, audit settings, audit reports) needed to successfully audit operating system activity.\n\n","check":"Verify Nutanix AOS audit log permissions are \"0600\" or less permissive.\n\n$ sudo stat -c \"%a %n\" /home/log/audit/audit.log\n600 /home/log/audit/audit.log\n\nIf the audit.log file(s) are more permissive than \"0600\", this is a finding.","fix":"Run the salt stack call to set the audit log file permissions to \"600\".\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57668r846635_chk","severity":"medium","gid":"V-254183","rid":"SV-254183r846637_rule","stig_id":"NUTX-OS-000930","gtitle":"SRG-OS-000057-GPOS-00027","fix_id":"F-57619r846636_fix","satisfies":["SRG-OS-000057-GPOS-00027","SRG-OS-000058-GPOS-00028","SRG-OS-000059-GPOS-00029"],"documentable":null,"cci":["CCI-000162","CCI-000163","CCI-000164"],"nist":["AU-9 a","AU-9 a","AU-9 a"]}},{"id":"SV-254184","code":"control 'SV-254184' do\n  title 'Nutanix AOS audit tools must be configured to 0755 or less permissive.'\n  desc 'Without information that establishes the identity of the subjects (i.e., users or processes acting on behalf of users) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.'\n  desc 'check', 'Verify the audit tools are protected from unauthorized access, deletion, or modification by checking the permissive mode.\n\nCheck the octal permission of each audit tool by running the following command:\n$ sudo stat -c \"%a %n\" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/rsyslogd /sbin/augenrules\n750 /sbin/auditctl\n750 /sbin/aureport\n750 /sbin/ausearch\n750 /sbin/autrace\n750 /sbin/auditd\n755 /sbin/rsyslogd\n755 /sbin/augenrules\n\nIf any of the audit tools has a mode more permissive than \"0755\", this is a finding.'\n  desc 'fix', 'Configure the audit tools to be protected from unauthorized access by setting the correct permissive mode using the following command:\n\n$ sudo chmod 0755 [audit_tool]\n\nReplace \"[audit_tool]\" with the audit tool that does not have the correct permissive mode.'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57669r846638_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254184'\n  tag rid: 'SV-254184r846640_rule'\n  tag stig_id: 'NUTX-OS-000960'\n  tag gtitle: 'SRG-OS-000256-GPOS-00097'\n  tag fix_id: 'F-57620r846639_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001493']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254184.rb"},"title":"Nutanix AOS audit tools must be configured to 0755 or less permissive.","desc":"Without information that establishes the identity of the subjects (i.e., users or processes acting on behalf of users) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.","descriptions":{"default":"Without information that establishes the identity of the subjects (i.e., users or processes acting on behalf of users) associated with the events, security personnel cannot determine responsibility for the potentially harmful event.","check":"Verify the audit tools are protected from unauthorized access, deletion, or modification by checking the permissive mode.\n\nCheck the octal permission of each audit tool by running the following command:\n$ sudo stat -c \"%a %n\" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/rsyslogd /sbin/augenrules\n750 /sbin/auditctl\n750 /sbin/aureport\n750 /sbin/ausearch\n750 /sbin/autrace\n750 /sbin/auditd\n755 /sbin/rsyslogd\n755 /sbin/augenrules\n\nIf any of the audit tools has a mode more permissive than \"0755\", this is a finding.","fix":"Configure the audit tools to be protected from unauthorized access by setting the correct permissive mode using the following command:\n\n$ sudo chmod 0755 [audit_tool]\n\nReplace \"[audit_tool]\" with the audit tool that does not have the correct permissive mode."},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57669r846638_chk","severity":"medium","gid":"V-254184","rid":"SV-254184r846640_rule","stig_id":"NUTX-OS-000960","gtitle":"SRG-OS-000256-GPOS-00097","fix_id":"F-57620r846639_fix","documentable":null,"cci":["CCI-001493"],"nist":["AU-9 a"]}},{"id":"SV-254185","code":"control 'SV-254185' do\n  title 'Nutanix AOS audit tools must be owned by root.'\n  desc 'Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user has to make access decisions regarding the modification of audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.'\n  desc 'check', 'Verify the audit tools are owned by \"root\" to prevent any unauthorized access, deletion, or modification.\n\nCheck the owner of each audit tool by running the following commands:\n$ sudo stat -c \"%U %n\" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/rsyslogd /sbin/augenrules\n[sudo] password for admin: \nroot /sbin/auditctl\nroot /sbin/aureport\nroot /sbin/ausearch\nroot /sbin/autrace\nroot /sbin/auditd\nroot /sbin/rsyslogd\nroot /sbin/augenrules\n\nIf any of the audit tools are not owned by \"root\", this is a finding.'\n  desc 'fix', 'Configure the audit tools to be owned by \"root\", by running the following command:\n\n$ sudo chown root [audit_tool]\n\nReplace \"[audit_tool]\" with each audit tool not owned by \"root\".'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57670r846641_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254185'\n  tag rid: 'SV-254185r846643_rule'\n  tag stig_id: 'NUTX-OS-000970'\n  tag gtitle: 'SRG-OS-000257-GPOS-00098'\n  tag fix_id: 'F-57621r846642_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001494']\n  tag nist: ['AU-9']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254185.rb"},"title":"Nutanix AOS audit tools must be owned by root.","desc":"Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user has to make access decisions regarding the modification of audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.","descriptions":{"default":"Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user has to make access decisions regarding the modification of audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.","check":"Verify the audit tools are owned by \"root\" to prevent any unauthorized access, deletion, or modification.\n\nCheck the owner of each audit tool by running the following commands:\n$ sudo stat -c \"%U %n\" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/rsyslogd /sbin/augenrules\n[sudo] password for admin: \nroot /sbin/auditctl\nroot /sbin/aureport\nroot /sbin/ausearch\nroot /sbin/autrace\nroot /sbin/auditd\nroot /sbin/rsyslogd\nroot /sbin/augenrules\n\nIf any of the audit tools are not owned by \"root\", this is a finding.","fix":"Configure the audit tools to be owned by \"root\", by running the following command:\n\n$ sudo chown root [audit_tool]\n\nReplace \"[audit_tool]\" with each audit tool not owned by \"root\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57670r846641_chk","severity":"medium","gid":"V-254185","rid":"SV-254185r846643_rule","stig_id":"NUTX-OS-000970","gtitle":"SRG-OS-000257-GPOS-00098","fix_id":"F-57621r846642_fix","documentable":null,"cci":["CCI-001494"],"nist":["AU-9"]}},{"id":"SV-254186","code":"control 'SV-254186' do\n  title 'Nutanix AOS audit tools must be group-owned by root.'\n  desc 'Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user has in order to make access decisions regarding the deletion of audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.'\n  desc 'check', 'Verify the audit tools are group-owned by \"root\" to prevent any unauthorized access, deletion, or modification.\n\nCheck the owner of each audit tool by running the following commands:\n$ sudo stat -c \"%G %n\" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/rsyslogd /sbin/augenrules\n[sudo] password for admin: \nroot /sbin/auditctl\nroot /sbin/aureport\nroot /sbin/ausearch\nroot /sbin/autrace\nroot /sbin/auditd\nroot /sbin/rsyslogd\nroot /sbin/augenrules\n\nIf any of the audit tools are not group-owned by \"root\", this is a finding.'\n  desc 'fix', 'Configure the audit tools to be group-owned by \"root\", by running the following command:\n\n$ sudo chgrp root [audit_tool]\n\nReplace \"[audit_tool]\" with each audit tool not group-owned by \"root\".'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57671r846644_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254186'\n  tag rid: 'SV-254186r846646_rule'\n  tag stig_id: 'NUTX-OS-000980'\n  tag gtitle: 'SRG-OS-000258-GPOS-00099'\n  tag fix_id: 'F-57622r846645_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001495']\n  tag nist: ['AU-9']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254186.rb"},"title":"Nutanix AOS audit tools must be group-owned by root.","desc":"Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user has in order to make access decisions regarding the deletion of audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.","descriptions":{"default":"Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user has in order to make access decisions regarding the deletion of audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.","check":"Verify the audit tools are group-owned by \"root\" to prevent any unauthorized access, deletion, or modification.\n\nCheck the owner of each audit tool by running the following commands:\n$ sudo stat -c \"%G %n\" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/rsyslogd /sbin/augenrules\n[sudo] password for admin: \nroot /sbin/auditctl\nroot /sbin/aureport\nroot /sbin/ausearch\nroot /sbin/autrace\nroot /sbin/auditd\nroot /sbin/rsyslogd\nroot /sbin/augenrules\n\nIf any of the audit tools are not group-owned by \"root\", this is a finding.","fix":"Configure the audit tools to be group-owned by \"root\", by running the following command:\n\n$ sudo chgrp root [audit_tool]\n\nReplace \"[audit_tool]\" with each audit tool not group-owned by \"root\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57671r846644_chk","severity":"medium","gid":"V-254186","rid":"SV-254186r846646_rule","stig_id":"NUTX-OS-000980","gtitle":"SRG-OS-000258-GPOS-00099","fix_id":"F-57622r846645_fix","documentable":null,"cci":["CCI-001495"],"nist":["AU-9"]}},{"id":"SV-254187","code":"control 'SV-254187' do\n  title 'Nutanix AOS must use cryptographic mechanisms to protect the integrity of audit tools.'\n  desc 'Protecting the integrity of the tools used for auditing purposes is a critical step toward ensuring the integrity of audit information. Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.\n\nIt is not uncommon for attackers to replace the audit tools or inject code into the existing tools with the purpose of providing the capability to hide or erase system activity from the audit logs.\n\nTo address this risk, audit tools must be cryptographically signed to provide the capability to identify when the audit tools have been modified, manipulated, or replaced. An example is a checksum hash of the file or files.'\n  desc 'check', %q(Verify that Advanced Intrusion Detection Environment (AIDE) is properly configured to use cryptographic mechanisms to protect the integrity of audit tools.\n\nIf AIDE is not installed, ask the System Administrator how file integrity checks are performed on the system.\n\nVerify the location of the seven auditing tools that require cryptographic protection with the following command:\n(auditctl, auditd, ausearch, aureport, autrace, augenrules, rsyslogd)\n\n$ sudo ls -al /usr/sbin/ | egrep '(audit|au|rsys)'\n\nIf the seven identified audit tools are not listed, this is a finding.\n\nCheck the aide.conf file for the  configured rule set.\n\n$ sudo grep -i \"FIPSR =\" /etc/aide.conf  \nFIPSR = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha512\n\nIf the FIPSR rule set is commented out or does not display, this is a finding.\n\nCheck to ensure that the root directory of the seven audit tools is configured to be monitored and that the proper rule set is applied to that directory (/usr/).\n\n$ sudo grep -i /usr /etc/aide.conf\n/usr    FIPSR\n\nif the /usr directory is not listed or  has a preceding '=' or '!' sign or the Rule  Set is not set to FIPSR, this is a finding.)\n  desc 'fix', 'Configure AIDE on Nutanix AOS by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-aide=true'\n  impact 0.7\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57672r846647_chk'\n  tag severity: 'high'\n  tag gid: 'V-254187'\n  tag rid: 'SV-254187r846649_rule'\n  tag stig_id: 'NUTX-OS-000990'\n  tag gtitle: 'SRG-OS-000278-GPOS-00108'\n  tag fix_id: 'F-57623r846648_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001496']\n  tag nist: ['AU-9 (3)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254187.rb"},"title":"Nutanix AOS must use cryptographic mechanisms to protect the integrity of audit tools.","desc":"Protecting the integrity of the tools used for auditing purposes is a critical step toward ensuring the integrity of audit information. Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.\n\nIt is not uncommon for attackers to replace the audit tools or inject code into the existing tools with the purpose of providing the capability to hide or erase system activity from the audit logs.\n\nTo address this risk, audit tools must be cryptographically signed to provide the capability to identify when the audit tools have been modified, manipulated, or replaced. An example is a checksum hash of the file or files.","descriptions":{"default":"Protecting the integrity of the tools used for auditing purposes is a critical step toward ensuring the integrity of audit information. Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.\n\nIt is not uncommon for attackers to replace the audit tools or inject code into the existing tools with the purpose of providing the capability to hide or erase system activity from the audit logs.\n\nTo address this risk, audit tools must be cryptographically signed to provide the capability to identify when the audit tools have been modified, manipulated, or replaced. An example is a checksum hash of the file or files.","check":"Verify that Advanced Intrusion Detection Environment (AIDE) is properly configured to use cryptographic mechanisms to protect the integrity of audit tools.\n\nIf AIDE is not installed, ask the System Administrator how file integrity checks are performed on the system.\n\nVerify the location of the seven auditing tools that require cryptographic protection with the following command:\n(auditctl, auditd, ausearch, aureport, autrace, augenrules, rsyslogd)\n\n$ sudo ls -al /usr/sbin/ | egrep '(audit|au|rsys)'\n\nIf the seven identified audit tools are not listed, this is a finding.\n\nCheck the aide.conf file for the  configured rule set.\n\n$ sudo grep -i \"FIPSR =\" /etc/aide.conf  \nFIPSR = p+i+n+u+g+s+m+c+acl+selinux+xattrs+sha512\n\nIf the FIPSR rule set is commented out or does not display, this is a finding.\n\nCheck to ensure that the root directory of the seven audit tools is configured to be monitored and that the proper rule set is applied to that directory (/usr/).\n\n$ sudo grep -i /usr /etc/aide.conf\n/usr    FIPSR\n\nif the /usr directory is not listed or  has a preceding '=' or '!' sign or the Rule  Set is not set to FIPSR, this is a finding.","fix":"Configure AIDE on Nutanix AOS by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-aide=true"},"impact":0.7,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57672r846647_chk","severity":"high","gid":"V-254187","rid":"SV-254187r846649_rule","stig_id":"NUTX-OS-000990","gtitle":"SRG-OS-000278-GPOS-00108","fix_id":"F-57623r846648_fix","documentable":null,"cci":["CCI-001496"],"nist":["AU-9 (3)"]}},{"id":"SV-254188","code":"control 'SV-254188' do\n  title 'Nutanix AOS must notify designated personnel if baseline configurations are changed in an unauthorized manner.'\n  desc \"Unauthorized changes to the baseline configuration could make the system vulnerable to various attacks or allow unauthorized access to the operating system. Changes to operating system configurations can have unintended side effects, some of which may be relevant to security.\n\nDetecting such changes and providing an automated response can help avoid unintended, negative consequences that could ultimately affect the security state of the operating system. The operating system's ISSO and SAs must be notified via email and/or monitoring system trap when there is an unauthorized modification of a configuration item.\"\n  desc 'check', 'Confirm that Nutanix AOS has been set to have the Advanced Intrusion Detection Environment (AIDE) installed and enabled.\n\n$ sudo yum list installed aide\nInstalled Packages\naide.x86_64 \n\nIf the aide_x86_64 package is not installed, this is a finding.\n\nCheck for the presence of a cron job running daily or weekly on the system that executes AIDE daily to scan for changes to the system baseline. \n\nCheck the cron directories for a script file controlling the execution of the file integrity application. For example, if AIDE is installed on the system, use the following command:\n\n$ sudo  ls -al /etc/cron.* | grep aide\n\nIf the file integrity application does not exist, or a script file controlling the execution of the file integrity application does not exist, this is a finding.'\n  desc 'fix', 'Configure AIDE on Nutanix AOS by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-aide=true'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57673r846650_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254188'\n  tag rid: 'SV-254188r846652_rule'\n  tag stig_id: 'NUTX-OS-001000'\n  tag gtitle: 'SRG-OS-000363-GPOS-00150'\n  tag fix_id: 'F-57624r846651_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001744']\n  tag nist: ['CM-3 (5)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254188.rb"},"title":"Nutanix AOS must notify designated personnel if baseline configurations are changed in an unauthorized manner.","desc":"Unauthorized changes to the baseline configuration could make the system vulnerable to various attacks or allow unauthorized access to the operating system. Changes to operating system configurations can have unintended side effects, some of which may be relevant to security.\n\nDetecting such changes and providing an automated response can help avoid unintended, negative consequences that could ultimately affect the security state of the operating system. The operating system's ISSO and SAs must be notified via email and/or monitoring system trap when there is an unauthorized modification of a configuration item.","descriptions":{"default":"Unauthorized changes to the baseline configuration could make the system vulnerable to various attacks or allow unauthorized access to the operating system. Changes to operating system configurations can have unintended side effects, some of which may be relevant to security.\n\nDetecting such changes and providing an automated response can help avoid unintended, negative consequences that could ultimately affect the security state of the operating system. The operating system's ISSO and SAs must be notified via email and/or monitoring system trap when there is an unauthorized modification of a configuration item.","check":"Confirm that Nutanix AOS has been set to have the Advanced Intrusion Detection Environment (AIDE) installed and enabled.\n\n$ sudo yum list installed aide\nInstalled Packages\naide.x86_64 \n\nIf the aide_x86_64 package is not installed, this is a finding.\n\nCheck for the presence of a cron job running daily or weekly on the system that executes AIDE daily to scan for changes to the system baseline. \n\nCheck the cron directories for a script file controlling the execution of the file integrity application. For example, if AIDE is installed on the system, use the following command:\n\n$ sudo  ls -al /etc/cron.* | grep aide\n\nIf the file integrity application does not exist, or a script file controlling the execution of the file integrity application does not exist, this is a finding.","fix":"Configure AIDE on Nutanix AOS by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-aide=true"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57673r846650_chk","severity":"medium","gid":"V-254188","rid":"SV-254188r846652_rule","stig_id":"NUTX-OS-001000","gtitle":"SRG-OS-000363-GPOS-00150","fix_id":"F-57624r846651_fix","documentable":null,"cci":["CCI-001744"],"nist":["CM-3 (5)"]}},{"id":"SV-254189","code":"control 'SV-254189' do\n  title 'Nutanix AOS must not be configured to allow GSSAPIAuthentication.'\n  desc 'Failure to provide logical access restrictions associated with changes to system configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the operating system can have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to operating system components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).'\n  desc 'check', 'Confirm Nutanix AOS enforces access restrictions.\n\nCheck that the SSH daemon does not permit GSSAPI authentication with the following command:\n\n$ sudo grep -i gssapiauth /etc/ssh/sshd_config\nGSSAPIAuthentication no\n\nIf the \"GSSAPIAuthentication\" keyword is missing, is set to \"yes\" and is not documented with the Information System Security Officer (ISSO), or the returned line is commented out, this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS to enforce access restrictions by running the following command:\n\n$ sudo salt-call state.sls security/CVM/sshdCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57674r846653_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254189'\n  tag rid: 'SV-254189r846655_rule'\n  tag stig_id: 'NUTX-OS-001010'\n  tag gtitle: 'SRG-OS-000364-GPOS-00151'\n  tag fix_id: 'F-57625r846654_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001813']\n  tag nist: ['CM-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254189.rb"},"title":"Nutanix AOS must not be configured to allow GSSAPIAuthentication.","desc":"Failure to provide logical access restrictions associated with changes to system configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the operating system can have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to operating system components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","descriptions":{"default":"Failure to provide logical access restrictions associated with changes to system configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the operating system can have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to operating system components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","check":"Confirm Nutanix AOS enforces access restrictions.\n\nCheck that the SSH daemon does not permit GSSAPI authentication with the following command:\n\n$ sudo grep -i gssapiauth /etc/ssh/sshd_config\nGSSAPIAuthentication no\n\nIf the \"GSSAPIAuthentication\" keyword is missing, is set to \"yes\" and is not documented with the Information System Security Officer (ISSO), or the returned line is commented out, this is a finding.","fix":"Configure Nutanix AOS to enforce access restrictions by running the following command:\n\n$ sudo salt-call state.sls security/CVM/sshdCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57674r846653_chk","severity":"medium","gid":"V-254189","rid":"SV-254189r846655_rule","stig_id":"NUTX-OS-001010","gtitle":"SRG-OS-000364-GPOS-00151","fix_id":"F-57625r846654_fix","documentable":null,"cci":["CCI-001813"],"nist":["CM-5 (1) (a)"]}},{"id":"SV-254190","code":"control 'SV-254190' do\n  title 'Nutanix AOS must not be configured to allow KerberosAuthentication.'\n  desc 'Failure to provide logical access restrictions associated with changes to system configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the operating system can have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to operating system components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).'\n  desc 'check', 'Confirm Nutanix AOS enforces access restrictions.\n\nCheck that the SSH daemon does not permit Kerberos to authenticate passwords with the following command:\n\n$ sudo grep -i kerberosauth /etc/ssh/sshd_config\nKerberosAuthentication no\n\nIf the \"KerberosAuthentication\" keyword is missing, or is set to \"yes\" and is not documented with the Information System Security Officer (ISSO), or the returned line is commented out, this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS to enforce access restrictions by running the following command.\n\n$ sudo salt-call state.sls security/CVM/sshdCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57675r846656_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254190'\n  tag rid: 'SV-254190r846658_rule'\n  tag stig_id: 'NUTX-OS-001020'\n  tag gtitle: 'SRG-OS-000364-GPOS-00151'\n  tag fix_id: 'F-57626r846657_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001813']\n  tag nist: ['CM-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254190.rb"},"title":"Nutanix AOS must not be configured to allow KerberosAuthentication.","desc":"Failure to provide logical access restrictions associated with changes to system configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the operating system can have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to operating system components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","descriptions":{"default":"Failure to provide logical access restrictions associated with changes to system configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the operating system can have significant effects on the overall security of the system.\n\nAccordingly, only qualified and authorized individuals must be allowed to obtain access to operating system components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","check":"Confirm Nutanix AOS enforces access restrictions.\n\nCheck that the SSH daemon does not permit Kerberos to authenticate passwords with the following command:\n\n$ sudo grep -i kerberosauth /etc/ssh/sshd_config\nKerberosAuthentication no\n\nIf the \"KerberosAuthentication\" keyword is missing, or is set to \"yes\" and is not documented with the Information System Security Officer (ISSO), or the returned line is commented out, this is a finding.","fix":"Configure Nutanix AOS to enforce access restrictions by running the following command.\n\n$ sudo salt-call state.sls security/CVM/sshdCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57675r846656_chk","severity":"medium","gid":"V-254190","rid":"SV-254190r846658_rule","stig_id":"NUTX-OS-001020","gtitle":"SRG-OS-000364-GPOS-00151","fix_id":"F-57626r846657_fix","documentable":null,"cci":["CCI-001813"],"nist":["CM-5 (1) (a)"]}},{"id":"SV-254191","code":"control 'SV-254191' do\n  title 'Nutanix AOS must prevent the installation of patches, service packs, device drivers, or operating system components without verification they have been digitally signed using a certificate that is recognized and approved by the organization.'\n  desc 'Changes to any software components can have significant effects on the overall security of the operating system. This requirement ensures the software has not been tampered with and that it has been provided by a trusted vendor.\n\nAccordingly, patches, service packs, device drivers, or operating system components must be signed with a certificate recognized and approved by the organization.\n\nVerifying the authenticity of the software prior to installation validates the integrity of the patch or upgrade received from a vendor. This ensures the software has not been tampered with and that it has been provided by a trusted vendor. Self-signed certificates are disallowed by this requirement. The operating system should not have to verify the software again. This requirement does not mandate DoD certificates for this purpose; however, the certificate used to verify the software must be from an approved CA.'\n  desc 'check', 'Confirm that Nutanix AOS is configured to require gpgcheck and localpkg_gpgcheck for all installation packages provided by the vendor.\n\n$ sudo grep gpgcheck /etc/yum.conf\ngpgcheck=1\n\n$ sudo grep localpkg_gpgcheck /etc/yum.conf\nlocalpkg_gpgcheck=1\n\n$ sudo grep repo_gpgcheck /etc/yum.conf\nrepo_gpgcheck=1\n\nIf any of the three gpg checks output is not set to \"1\", this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS to require gpgcheck validation checks on all required yum repo configurations by running the following command:\n\n$ sudo salt-call state.sls security/CVM/yumCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57676r846659_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254191'\n  tag rid: 'SV-254191r846661_rule'\n  tag stig_id: 'NUTX-OS-001040'\n  tag gtitle: 'SRG-OS-000366-GPOS-00153'\n  tag fix_id: 'F-57627r846660_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001749']\n  tag nist: ['CM-5 (3)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254191.rb"},"title":"Nutanix AOS must prevent the installation of patches, service packs, device drivers, or operating system components without verification they have been digitally signed using a certificate that is recognized and approved by the organization.","desc":"Changes to any software components can have significant effects on the overall security of the operating system. This requirement ensures the software has not been tampered with and that it has been provided by a trusted vendor.\n\nAccordingly, patches, service packs, device drivers, or operating system components must be signed with a certificate recognized and approved by the organization.\n\nVerifying the authenticity of the software prior to installation validates the integrity of the patch or upgrade received from a vendor. This ensures the software has not been tampered with and that it has been provided by a trusted vendor. Self-signed certificates are disallowed by this requirement. The operating system should not have to verify the software again. This requirement does not mandate DoD certificates for this purpose; however, the certificate used to verify the software must be from an approved CA.","descriptions":{"default":"Changes to any software components can have significant effects on the overall security of the operating system. This requirement ensures the software has not been tampered with and that it has been provided by a trusted vendor.\n\nAccordingly, patches, service packs, device drivers, or operating system components must be signed with a certificate recognized and approved by the organization.\n\nVerifying the authenticity of the software prior to installation validates the integrity of the patch or upgrade received from a vendor. This ensures the software has not been tampered with and that it has been provided by a trusted vendor. Self-signed certificates are disallowed by this requirement. The operating system should not have to verify the software again. This requirement does not mandate DoD certificates for this purpose; however, the certificate used to verify the software must be from an approved CA.","check":"Confirm that Nutanix AOS is configured to require gpgcheck and localpkg_gpgcheck for all installation packages provided by the vendor.\n\n$ sudo grep gpgcheck /etc/yum.conf\ngpgcheck=1\n\n$ sudo grep localpkg_gpgcheck /etc/yum.conf\nlocalpkg_gpgcheck=1\n\n$ sudo grep repo_gpgcheck /etc/yum.conf\nrepo_gpgcheck=1\n\nIf any of the three gpg checks output is not set to \"1\", this is a finding.","fix":"Configure Nutanix AOS to require gpgcheck validation checks on all required yum repo configurations by running the following command:\n\n$ sudo salt-call state.sls security/CVM/yumCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57676r846659_chk","severity":"medium","gid":"V-254191","rid":"SV-254191r846661_rule","stig_id":"NUTX-OS-001040","gtitle":"SRG-OS-000366-GPOS-00153","fix_id":"F-57627r846660_fix","documentable":null,"cci":["CCI-001749"],"nist":["CM-5 (3)"]}},{"id":"SV-254192","code":"control 'SV-254192' do\n  title 'Nutanix AOS must prevent the use of dictionary words for passwords.'\n  desc 'If the operating system allows the user to select passwords based on dictionary words, then this increases the chances of password compromise by increasing the opportunity for successful guesses and brute-force attacks.'\n  desc 'check', 'Confirm Nutanix AOS prevents the use of dictionary words for passwords. \n\nCheck the /etc/pam.d/password-auth file for pam_pwquality.so\n\n$ sudo grep pwquality.so /etc/pam.d/password-auth\npassword    requisite     pam_pwquality.so try_first_pass local_users_only enforce_for_root retry=3 authtok_type=\n \nIf the output does not contain \"pam_pwquality.so\" with the option of \"required\" or \"requisite\", this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS to enforce the use of pam_pwquality.so by running the following command.\n\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57677r846662_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254192'\n  tag rid: 'SV-254192r846664_rule'\n  tag stig_id: 'NUTX-OS-001050'\n  tag gtitle: 'SRG-OS-000480-GPOS-00225'\n  tag fix_id: 'F-57628r846663_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254192.rb"},"title":"Nutanix AOS must prevent the use of dictionary words for passwords.","desc":"If the operating system allows the user to select passwords based on dictionary words, then this increases the chances of password compromise by increasing the opportunity for successful guesses and brute-force attacks.","descriptions":{"default":"If the operating system allows the user to select passwords based on dictionary words, then this increases the chances of password compromise by increasing the opportunity for successful guesses and brute-force attacks.","check":"Confirm Nutanix AOS prevents the use of dictionary words for passwords. \n\nCheck the /etc/pam.d/password-auth file for pam_pwquality.so\n\n$ sudo grep pwquality.so /etc/pam.d/password-auth\npassword    requisite     pam_pwquality.so try_first_pass local_users_only enforce_for_root retry=3 authtok_type=\n \nIf the output does not contain \"pam_pwquality.so\" with the option of \"required\" or \"requisite\", this is a finding.","fix":"Configure Nutanix AOS to enforce the use of pam_pwquality.so by running the following command.\n\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57677r846662_chk","severity":"medium","gid":"V-254192","rid":"SV-254192r846664_rule","stig_id":"NUTX-OS-001050","gtitle":"SRG-OS-000480-GPOS-00225","fix_id":"F-57628r846663_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-254193","code":"control 'SV-254193' do\n  title 'Nutanix AOS must enforce a delay of at least four seconds between logon prompts following a failed logon attempt.'\n  desc 'Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.'\n  desc 'check', 'Confirm Nutanix AOS enforces a delay of at least four seconds between console logon prompts following a failed logon attempt.\n\n$ sudo grep -i fail_delay /etc/login.defs\nFAIL_DELAY 4\n\nIf the value of \"FAIL_DELAY\" is not set to \"4\" or greater, or the line is commented out, this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS to enforce a delay between logon prompts following a failed logon attempt by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57678r846665_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254193'\n  tag rid: 'SV-254193r846667_rule'\n  tag stig_id: 'NUTX-OS-001060'\n  tag gtitle: 'SRG-OS-000480-GPOS-00226'\n  tag fix_id: 'F-57629r846666_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254193.rb"},"title":"Nutanix AOS must enforce a delay of at least four seconds between logon prompts following a failed logon attempt.","desc":"Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.","descriptions":{"default":"Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.","check":"Confirm Nutanix AOS enforces a delay of at least four seconds between console logon prompts following a failed logon attempt.\n\n$ sudo grep -i fail_delay /etc/login.defs\nFAIL_DELAY 4\n\nIf the value of \"FAIL_DELAY\" is not set to \"4\" or greater, or the line is commented out, this is a finding.","fix":"Configure Nutanix AOS to enforce a delay between logon prompts following a failed logon attempt by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57678r846665_chk","severity":"medium","gid":"V-254193","rid":"SV-254193r846667_rule","stig_id":"NUTX-OS-001060","gtitle":"SRG-OS-000480-GPOS-00226","fix_id":"F-57629r846666_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-254194","code":"control 'SV-254194' do\n  title 'Nutanix AOS must be configured to run SCMA daily.'\n  desc 'The Nutanix platform leverages the use of the Security Configuration Management Automation (SCMA) framework to ensure secure configurations have not been altered from their desired state. If the SCMA framework is not run on a daily basis, changes to the secure baseline could be made, compromising multiple security functions and features on the operating system.'\n  desc 'check', %q(Verify that the SCMA framework is set to run daily:\n\n$ ncli cluster get-cvm-security-config | egrep 'Schedule'\nSchedule : DAILY\n\nIf \"Schedule\" is not set to \"DAILY\", this is a finding.)\n  desc 'fix', 'Set the SCMA framework to check the baseline daily:\n$ sudo ncli cluster edit-cvm-security-params schedule=daily'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57679r846668_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254194'\n  tag rid: 'SV-254194r846670_rule'\n  tag stig_id: 'NUTX-OS-001070'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-57630r846669_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254194.rb"},"title":"Nutanix AOS must be configured to run SCMA daily.","desc":"The Nutanix platform leverages the use of the Security Configuration Management Automation (SCMA) framework to ensure secure configurations have not been altered from their desired state. If the SCMA framework is not run on a daily basis, changes to the secure baseline could be made, compromising multiple security functions and features on the operating system.","descriptions":{"default":"The Nutanix platform leverages the use of the Security Configuration Management Automation (SCMA) framework to ensure secure configurations have not been altered from their desired state. If the SCMA framework is not run on a daily basis, changes to the secure baseline could be made, compromising multiple security functions and features on the operating system.","check":"Verify that the SCMA framework is set to run daily:\n\n$ ncli cluster get-cvm-security-config | egrep 'Schedule'\nSchedule : DAILY\n\nIf \"Schedule\" is not set to \"DAILY\", this is a finding.","fix":"Set the SCMA framework to check the baseline daily:\n$ sudo ncli cluster edit-cvm-security-params schedule=daily"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57679r846668_chk","severity":"medium","gid":"V-254194","rid":"SV-254194r846670_rule","stig_id":"NUTX-OS-001070","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-57630r846669_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-254195","code":"control 'SV-254195' do\n  title 'Nutanix AOS must define default permissions for all authenticated users in such a way that the user can only read and modify their own files.'\n  desc 'Setting the most restrictive default permissions ensures that when new accounts are created they do not have unnecessary access.'\n  desc 'check', 'Confirm Nutanix AOS defines default permissions for all authenticated users in such a way that the user can only read and modify their own files.\n\n$ sudo grep -i umask /etc/login.defs\nUMASK 077\n\nIf the value for the \"UMASK\" parameter is not \"077\", or the \"UMASK\" parameter is missing or is commented out, this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS default permissions UMASK to 077 by running the following command.\n\nsalt-call state.sls security/CVM/shellCVM'\n  impact 0.3\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57680r846671_chk'\n  tag severity: 'low'\n  tag gid: 'V-254195'\n  tag rid: 'SV-254195r846673_rule'\n  tag stig_id: 'NUTX-OS-001080'\n  tag gtitle: 'SRG-OS-000480-GPOS-00228'\n  tag fix_id: 'F-57631r846672_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254195.rb"},"title":"Nutanix AOS must define default permissions for all authenticated users in such a way that the user can only read and modify their own files.","desc":"Setting the most restrictive default permissions ensures that when new accounts are created they do not have unnecessary access.","descriptions":{"default":"Setting the most restrictive default permissions ensures that when new accounts are created they do not have unnecessary access.","check":"Confirm Nutanix AOS defines default permissions for all authenticated users in such a way that the user can only read and modify their own files.\n\n$ sudo grep -i umask /etc/login.defs\nUMASK 077\n\nIf the value for the \"UMASK\" parameter is not \"077\", or the \"UMASK\" parameter is missing or is commented out, this is a finding.","fix":"Configure Nutanix AOS default permissions UMASK to 077 by running the following command.\n\nsalt-call state.sls security/CVM/shellCVM"},"impact":0.3,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57680r846671_chk","severity":"low","gid":"V-254195","rid":"SV-254195r846673_rule","stig_id":"NUTX-OS-001080","gtitle":"SRG-OS-000480-GPOS-00228","fix_id":"F-57631r846672_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-254196","code":"control 'SV-254196' do\n  title 'Nutanix AOS must not allow an unattended or automatic logon to the system.'\n  desc 'Failure to restrict system access to authenticated users negatively impacts operating system security.'\n  desc 'check', 'Confirm Nutanix AOS does not allow users to override environment variables to the SSH daemon.\n\nCheck for the value of the \"PermitUserEnvironment\" keyword with the following command:\n\n$ sudo grep -i permituserenvironment /etc/ssh/sshd_config\nPermitUserEnvironment no\n\nIf the \"PermitUserEnvironment\" keyword is not set to \"no\", is missing, or is commented out, this is a finding.\n\n$ sudo grep -i hostbasedauthentication /etc/ssh/sshd_config\nHostbasedAuthentication no\n\nIf the \"HostbasedAuthentication\" keyword is not set to \"no\", is missing, or is commented out, this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS to not allow users to override environment variables to the SSH daemon by running the following command.\n\n$ sudo salt-call state.sls security/CVM/sshdCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57681r846674_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254196'\n  tag rid: 'SV-254196r846676_rule'\n  tag stig_id: 'NUTX-OS-001090'\n  tag gtitle: 'SRG-OS-000480-GPOS-00229'\n  tag fix_id: 'F-57632r846675_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254196.rb"},"title":"Nutanix AOS must not allow an unattended or automatic logon to the system.","desc":"Failure to restrict system access to authenticated users negatively impacts operating system security.","descriptions":{"default":"Failure to restrict system access to authenticated users negatively impacts operating system security.","check":"Confirm Nutanix AOS does not allow users to override environment variables to the SSH daemon.\n\nCheck for the value of the \"PermitUserEnvironment\" keyword with the following command:\n\n$ sudo grep -i permituserenvironment /etc/ssh/sshd_config\nPermitUserEnvironment no\n\nIf the \"PermitUserEnvironment\" keyword is not set to \"no\", is missing, or is commented out, this is a finding.\n\n$ sudo grep -i hostbasedauthentication /etc/ssh/sshd_config\nHostbasedAuthentication no\n\nIf the \"HostbasedAuthentication\" keyword is not set to \"no\", is missing, or is commented out, this is a finding.","fix":"Configure Nutanix AOS to not allow users to override environment variables to the SSH daemon by running the following command.\n\n$ sudo salt-call state.sls security/CVM/sshdCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57681r846674_chk","severity":"medium","gid":"V-254196","rid":"SV-254196r846676_rule","stig_id":"NUTX-OS-001090","gtitle":"SRG-OS-000480-GPOS-00229","fix_id":"F-57632r846675_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-254197","code":"control 'SV-254197' do\n  title 'Nutanix AOS must be configured so that all local interactive user home directories have mode \"0750\" or less permissive.'\n  desc 'Excessive permissions on local interactive user home directories may allow unauthorized access to user files by other users.'\n  desc 'check', %q(Confirm Nutanix AOS has assigned home directory of all local interactive users has a mode of \"0750\" or less permissive.\n\nStep 1. Determine interactive users\n$ sudo cat $(awk -F: '($3>=1000)&&($7 !~ /nologin/){print $6}' /etc/passwd)\ncat: /home/nutanix: Is a directory\ncat: /home/admin: Is a directory\n\nStep 2. Determine permissions on interactive users home directories.\n$ sudo stat -c \"%a %n\" /home/admin\n750 /home/admin\n\n$ sudo stat -c \"%a %n\" /home/nutanix\n750 /home/nutanix\n\nIf home directories referenced in \"/etc/passwd\" do not have a mode of \"0750\" or less permissive, this is a finding.)\n  desc 'fix', 'Configure any interactive users home directory to have a mode of \"0750\" or less by running the command:\n\n$ sudo chmod 0750 [path to interactive users home directory]'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57682r846677_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254197'\n  tag rid: 'SV-254197r846679_rule'\n  tag stig_id: 'NUTX-OS-001100'\n  tag gtitle: 'SRG-OS-000480-GPOS-00230'\n  tag fix_id: 'F-57633r846678_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254197.rb"},"title":"Nutanix AOS must be configured so that all local interactive user home directories have mode \"0750\" or less permissive.","desc":"Excessive permissions on local interactive user home directories may allow unauthorized access to user files by other users.","descriptions":{"default":"Excessive permissions on local interactive user home directories may allow unauthorized access to user files by other users.","check":"Confirm Nutanix AOS has assigned home directory of all local interactive users has a mode of \"0750\" or less permissive.\n\nStep 1. Determine interactive users\n$ sudo cat $(awk -F: '($3>=1000)&&($7 !~ /nologin/){print $6}' /etc/passwd)\ncat: /home/nutanix: Is a directory\ncat: /home/admin: Is a directory\n\nStep 2. Determine permissions on interactive users home directories.\n$ sudo stat -c \"%a %n\" /home/admin\n750 /home/admin\n\n$ sudo stat -c \"%a %n\" /home/nutanix\n750 /home/nutanix\n\nIf home directories referenced in \"/etc/passwd\" do not have a mode of \"0750\" or less permissive, this is a finding.","fix":"Configure any interactive users home directory to have a mode of \"0750\" or less by running the command:\n\n$ sudo chmod 0750 [path to interactive users home directory]"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57682r846677_chk","severity":"medium","gid":"V-254197","rid":"SV-254197r846679_rule","stig_id":"NUTX-OS-001100","gtitle":"SRG-OS-000480-GPOS-00230","fix_id":"F-57633r846678_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-254198","code":"control 'SV-254198' do\n  title 'Nutanix AOS must enable an application firewall, if available.'\n  desc 'Firewalls protect computers from network attacks by blocking or limiting access to open network ports. Application firewalls limit which applications are allowed to communicate over the network.'\n  desc 'check', 'Confirm Nutanix AOS prohibits or restricts the use of remote access methods, using the iptables firewall service.\n\n$ sudo service iptables status\niptables.service - IPv4 firewall with iptables\n   Loaded: loaded (/usr/lib/systemd/system/iptables.service; enabled; vendor preset: disabled)\n   Active: active (exited) since Mon 2021-08-02 15:02:12 CDT; 2 weeks 6 days ago\n Main PID: 1250 (code=exited, status=0/SUCCESS)\n   CGroup: /system.slice/iptables.service\n\nIf IPv6 is in use:\n$ sudo service ip6tables status\nip6tables.service - IPv6 firewall with ip6tables\n   Loaded: loaded (/usr/lib/systemd/system/ip6tables.service; enabled; vendor preset: disabled)\n   Active: active (exited) since Mon 2021-08-02 15:02:12 CDT; 2 weeks 6 days ago\n Main PID: 1313 (code=exited, status=0/SUCCESS)\n   CGroup: /system.slice/ip6tables.service\n\nIf no iptables services are \"Loaded\" and \"Active\", this is a finding.'\n  desc 'fix', 'Configure the system to restrict the use of remote access methods by running the following command.\n\n$ sudo salt-call state.sls security/CVM/iptables/init'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57683r846680_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254198'\n  tag rid: 'SV-254198r846682_rule'\n  tag stig_id: 'NUTX-OS-001110'\n  tag gtitle: 'SRG-OS-000480-GPOS-00232'\n  tag fix_id: 'F-57634r846681_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254198.rb"},"title":"Nutanix AOS must enable an application firewall, if available.","desc":"Firewalls protect computers from network attacks by blocking or limiting access to open network ports. Application firewalls limit which applications are allowed to communicate over the network.","descriptions":{"default":"Firewalls protect computers from network attacks by blocking or limiting access to open network ports. Application firewalls limit which applications are allowed to communicate over the network.","check":"Confirm Nutanix AOS prohibits or restricts the use of remote access methods, using the iptables firewall service.\n\n$ sudo service iptables status\niptables.service - IPv4 firewall with iptables\n   Loaded: loaded (/usr/lib/systemd/system/iptables.service; enabled; vendor preset: disabled)\n   Active: active (exited) since Mon 2021-08-02 15:02:12 CDT; 2 weeks 6 days ago\n Main PID: 1250 (code=exited, status=0/SUCCESS)\n   CGroup: /system.slice/iptables.service\n\nIf IPv6 is in use:\n$ sudo service ip6tables status\nip6tables.service - IPv6 firewall with ip6tables\n   Loaded: loaded (/usr/lib/systemd/system/ip6tables.service; enabled; vendor preset: disabled)\n   Active: active (exited) since Mon 2021-08-02 15:02:12 CDT; 2 weeks 6 days ago\n Main PID: 1313 (code=exited, status=0/SUCCESS)\n   CGroup: /system.slice/ip6tables.service\n\nIf no iptables services are \"Loaded\" and \"Active\", this is a finding.","fix":"Configure the system to restrict the use of remote access methods by running the following command.\n\n$ sudo salt-call state.sls security/CVM/iptables/init"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57683r846680_chk","severity":"medium","gid":"V-254198","rid":"SV-254198r846682_rule","stig_id":"NUTX-OS-001110","gtitle":"SRG-OS-000480-GPOS-00232","fix_id":"F-57634r846681_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-254199","code":"control 'SV-254199' do\n  title 'Nutanix AOS must be configured with nodev, nosuid, and noexec options for /dev/shm.'\n  desc 'Control of program execution is a mechanism used to prevent execution of unauthorized programs. Some operating systems may provide a capability that runs counter to the mission or provides users with functionality that exceeds mission requirements. This includes functions and services installed at the operating system-level.\n\nSome of the programs, installed by default, may be harmful or may not be necessary to support essential organizational operations (e.g., key missions, functions). Removal of executable programs is not always possible; therefore, establishing a method of preventing program execution is critical to maintaining a secure system baseline.\n\nMethods for complying with this requirement include restricting execution of programs in certain environments, while preventing execution in other environments; or limiting execution of certain program functionality based on organization-defined criteria (e.g., privileges, subnets, sandboxed environments, or roles).'\n  desc 'check', 'Confirm Nutanix AOS that \"nodev\",\"nosuid\", and \"noexec\" options are configured for /dev/shm:\n\n$ cat /etc/fstab | grep /dev/shm\ntmpfs\t\t/dev/shm\ttmpfs\tdefaults,size=512m,noexec,rw,seclabel,nosuid,nodev\t0 0\n\nIf /dev/shm is mounted without secure options \"nodev\", \"nosuid\", and \"noexec\", this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS so that /dev/shm is mounted with the \"nodev\", \"nosuid\", and \"noexec\" options by adding /modifying the /etc/fstab with the following line:\n\ntmpfs /dev/shm tmpfs defaults,nodev,nosuid,noexec 0 0'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57684r846683_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254199'\n  tag rid: 'SV-254199r846685_rule'\n  tag stig_id: 'NUTX-OS-001120'\n  tag gtitle: 'SRG-OS-000368-GPOS-00154'\n  tag fix_id: 'F-57635r846684_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001764']\n  tag nist: ['CM-7 (2)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254199.rb"},"title":"Nutanix AOS must be configured with nodev, nosuid, and noexec options for /dev/shm.","desc":"Control of program execution is a mechanism used to prevent execution of unauthorized programs. Some operating systems may provide a capability that runs counter to the mission or provides users with functionality that exceeds mission requirements. This includes functions and services installed at the operating system-level.\n\nSome of the programs, installed by default, may be harmful or may not be necessary to support essential organizational operations (e.g., key missions, functions). Removal of executable programs is not always possible; therefore, establishing a method of preventing program execution is critical to maintaining a secure system baseline.\n\nMethods for complying with this requirement include restricting execution of programs in certain environments, while preventing execution in other environments; or limiting execution of certain program functionality based on organization-defined criteria (e.g., privileges, subnets, sandboxed environments, or roles).","descriptions":{"default":"Control of program execution is a mechanism used to prevent execution of unauthorized programs. Some operating systems may provide a capability that runs counter to the mission or provides users with functionality that exceeds mission requirements. This includes functions and services installed at the operating system-level.\n\nSome of the programs, installed by default, may be harmful or may not be necessary to support essential organizational operations (e.g., key missions, functions). Removal of executable programs is not always possible; therefore, establishing a method of preventing program execution is critical to maintaining a secure system baseline.\n\nMethods for complying with this requirement include restricting execution of programs in certain environments, while preventing execution in other environments; or limiting execution of certain program functionality based on organization-defined criteria (e.g., privileges, subnets, sandboxed environments, or roles).","check":"Confirm Nutanix AOS that \"nodev\",\"nosuid\", and \"noexec\" options are configured for /dev/shm:\n\n$ cat /etc/fstab | grep /dev/shm\ntmpfs\t\t/dev/shm\ttmpfs\tdefaults,size=512m,noexec,rw,seclabel,nosuid,nodev\t0 0\n\nIf /dev/shm is mounted without secure options \"nodev\", \"nosuid\", and \"noexec\", this is a finding.","fix":"Configure Nutanix AOS so that /dev/shm is mounted with the \"nodev\", \"nosuid\", and \"noexec\" options by adding /modifying the /etc/fstab with the following line:\n\ntmpfs /dev/shm tmpfs defaults,nodev,nosuid,noexec 0 0"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57684r846683_chk","severity":"medium","gid":"V-254199","rid":"SV-254199r846685_rule","stig_id":"NUTX-OS-001120","gtitle":"SRG-OS-000368-GPOS-00154","fix_id":"F-57635r846684_fix","documentable":null,"cci":["CCI-001764"],"nist":["CM-7 (2)"]}},{"id":"SV-254200","code":"control 'SV-254200' do\n  title 'Nutanix AOS must not have the rsh-server package installed.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.\n\n'\n  desc 'check', 'Confirm Nutanix AOS is configured to disable nonessential capabilities.\n\n$ sudo yum list installed rsh-server\n\nIf the rsh-server package is installed, this is a finding.'\n  desc 'fix', 'Remove any finding identified by running the correlating command:\n\n$ sudo yum remove rsh-server'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57685r846686_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254200'\n  tag rid: 'SV-254200r846688_rule'\n  tag stig_id: 'NUTX-OS-001130'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-57636r846687_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000074-GPOS-00042']\n  tag 'documentable'\n  tag cci: ['CCI-000197', 'CCI-000381']\n  tag nist: ['IA-5 (1) (c)', 'CM-7 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254200.rb"},"title":"Nutanix AOS must not have the rsh-server package installed.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.\n\n","check":"Confirm Nutanix AOS is configured to disable nonessential capabilities.\n\n$ sudo yum list installed rsh-server\n\nIf the rsh-server package is installed, this is a finding.","fix":"Remove any finding identified by running the correlating command:\n\n$ sudo yum remove rsh-server"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57685r846686_chk","severity":"medium","gid":"V-254200","rid":"SV-254200r846688_rule","stig_id":"NUTX-OS-001130","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-57636r846687_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000074-GPOS-00042"],"documentable":null,"cci":["CCI-000197","CCI-000381"],"nist":["IA-5 (1) (c)","CM-7 a"]}},{"id":"SV-254201","code":"control 'SV-254201' do\n  title 'Nutanix AOS must not have the ypserv package installed.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.'\n  desc 'check', 'Confirm Nutanix AOS is configured to disable nonessential capabilities.\n\n$ sudo yum list installed ypserv\n\nIf the \"ypserv\" package is installed, this is a finding.'\n  desc 'fix', 'Remove any finding identified by running the correlating command:\n\n$ sudo yum remove ypserv'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57686r846689_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254201'\n  tag rid: 'SV-254201r846691_rule'\n  tag stig_id: 'NUTX-OS-001140'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-57637r846690_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254201.rb"},"title":"Nutanix AOS must not have the ypserv package installed.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","check":"Confirm Nutanix AOS is configured to disable nonessential capabilities.\n\n$ sudo yum list installed ypserv\n\nIf the \"ypserv\" package is installed, this is a finding.","fix":"Remove any finding identified by running the correlating command:\n\n$ sudo yum remove ypserv"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57686r846689_chk","severity":"medium","gid":"V-254201","rid":"SV-254201r846691_rule","stig_id":"NUTX-OS-001140","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-57637r846690_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-254202","code":"control 'SV-254202' do\n  title 'Nutanix AOS must not have the telnet-server package installed.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.'\n  desc 'check', 'Confirm Nutanix AOS is configured to disable nonessential capabilities.\n\n$ sudo yum list installed telnet-server\n\nIf the telnet-server package is installed, this is a finding.'\n  desc 'fix', 'Remove any finding identified by running the correlating command:\n\n$ sudo yum remove telnet-server'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57687r846692_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254202'\n  tag rid: 'SV-254202r846694_rule'\n  tag stig_id: 'NUTX-OS-001150'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-57638r846693_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000381']\n  tag nist: ['CM-7 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254202.rb"},"title":"Nutanix AOS must not have the telnet-server package installed.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.","check":"Confirm Nutanix AOS is configured to disable nonessential capabilities.\n\n$ sudo yum list installed telnet-server\n\nIf the telnet-server package is installed, this is a finding.","fix":"Remove any finding identified by running the correlating command:\n\n$ sudo yum remove telnet-server"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57687r846692_chk","severity":"medium","gid":"V-254202","rid":"SV-254202r846694_rule","stig_id":"NUTX-OS-001150","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-57638r846693_fix","documentable":null,"cci":["CCI-000381"],"nist":["CM-7 a"]}},{"id":"SV-254203","code":"control 'SV-254203' do\n  title 'Nutanix AOS must be configured to prohibit or restrict the use of functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.'\n  desc 'To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.'\n  desc 'check', 'Confirm Nutanix AOS prohibits or restricts the use of functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.\n\n$ sudo iptables -S\n\nIf IPv6 is in use:\n$ sudo ip6tables -S\n\nReview the site or program PPSM CAL; verify the services allowed by the firewall match the PPSM CLSA. \n\nIf there are additional ports, protocols, or services that are not in the PPSM CLSA, or there are ports, protocols, or services that are prohibited by the PPSM Category Assurance List (CAL), this is a finding.'\n  desc 'fix', 'Configure the system to restrict the use of functions, ports, protocols, and/or services as defined in the PPSM CAL and vulnerability assessments by running the following command:\n\n$ sudo salt-call state.sls security/CVM/iptables/init'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57688r846695_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254203'\n  tag rid: 'SV-254203r846697_rule'\n  tag stig_id: 'NUTX-OS-001160'\n  tag gtitle: 'SRG-OS-000096-GPOS-00050'\n  tag fix_id: 'F-57639r846696_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000382']\n  tag nist: ['CM-7 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254203.rb"},"title":"Nutanix AOS must be configured to prohibit or restrict the use of functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.","desc":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.","descriptions":{"default":"To prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable or restrict unused or unnecessary physical and logical ports/protocols on information systems.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., VPN and IPS); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the operating system must support the organizational requirements, providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved to conduct official business or to address authorized quality of life issues.","check":"Confirm Nutanix AOS prohibits or restricts the use of functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.\n\n$ sudo iptables -S\n\nIf IPv6 is in use:\n$ sudo ip6tables -S\n\nReview the site or program PPSM CAL; verify the services allowed by the firewall match the PPSM CLSA. \n\nIf there are additional ports, protocols, or services that are not in the PPSM CLSA, or there are ports, protocols, or services that are prohibited by the PPSM Category Assurance List (CAL), this is a finding.","fix":"Configure the system to restrict the use of functions, ports, protocols, and/or services as defined in the PPSM CAL and vulnerability assessments by running the following command:\n\n$ sudo salt-call state.sls security/CVM/iptables/init"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57688r846695_chk","severity":"medium","gid":"V-254203","rid":"SV-254203r846697_rule","stig_id":"NUTX-OS-001160","gtitle":"SRG-OS-000096-GPOS-00050","fix_id":"F-57639r846696_fix","documentable":null,"cci":["CCI-000382"],"nist":["CM-7 b"]}},{"id":"SV-254204","code":"control 'SV-254204' do\n  title 'Nutanix AOS must require users to reauthenticate for privilege escalation.'\n  desc 'Without reauthentication, users may access resources or perform tasks for which they do not have authorization.\n\nWhen operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.\n\n'\n  desc 'check', 'Confirm Nutanix AOS is configured as shown for reauthentication in the sudoers file.\n\n$ grep -i nopasswd /etc/sudoers /etc/sudoers.d/*\n\nIf any occurrences of \"NOPASSWD\" are returned from the command and have not been documented with the Information System Security Officer (ISSO) as an organizationally defined administrative group utilizing MFA, this is a finding.'\n  desc 'fix', 'If any occurrences of \"NOPASSWD\" found are not documented with the ISSO need to be removed. Configure Nutanix AOS to meet this requirement run the following command:\n\nsalt-call state.sls security/CVM/manualCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57689r846698_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254204'\n  tag rid: 'SV-254204r846700_rule'\n  tag stig_id: 'NUTX-OS-001170'\n  tag gtitle: 'SRG-OS-000373-GPOS-00156'\n  tag fix_id: 'F-57640r846699_fix'\n  tag satisfies: ['SRG-OS-000373-GPOS-00156', 'SRG-OS-000373-GPOS-00157', 'SRG-OS-000373-GPOS-00158']\n  tag 'documentable'\n  tag cci: ['CCI-002038']\n  tag nist: ['IA-11']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254204.rb"},"title":"Nutanix AOS must require users to reauthenticate for privilege escalation.","desc":"Without reauthentication, users may access resources or perform tasks for which they do not have authorization.\n\nWhen operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.\n\n","descriptions":{"default":"Without reauthentication, users may access resources or perform tasks for which they do not have authorization.\n\nWhen operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.\n\n","check":"Confirm Nutanix AOS is configured as shown for reauthentication in the sudoers file.\n\n$ grep -i nopasswd /etc/sudoers /etc/sudoers.d/*\n\nIf any occurrences of \"NOPASSWD\" are returned from the command and have not been documented with the Information System Security Officer (ISSO) as an organizationally defined administrative group utilizing MFA, this is a finding.","fix":"If any occurrences of \"NOPASSWD\" found are not documented with the ISSO need to be removed. Configure Nutanix AOS to meet this requirement run the following command:\n\nsalt-call state.sls security/CVM/manualCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57689r846698_chk","severity":"medium","gid":"V-254204","rid":"SV-254204r846700_rule","stig_id":"NUTX-OS-001170","gtitle":"SRG-OS-000373-GPOS-00156","fix_id":"F-57640r846699_fix","satisfies":["SRG-OS-000373-GPOS-00156","SRG-OS-000373-GPOS-00157","SRG-OS-000373-GPOS-00158"],"documentable":null,"cci":["CCI-002038"],"nist":["IA-11"]}},{"id":"SV-254205","code":"control 'SV-254205' do\n  title 'Nutanix AOS must implement replay-resistant authentication mechanisms for network access to privileged accounts.'\n  desc 'A replay attack may enable an unauthorized user to gain access to the operating system. Authentication sessions between the authenticator and the operating system validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.\n\nA privileged account is any information system account with authorizations of a privileged user.\n\nTechniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.\n\n'\n  desc 'check', 'Confirm Nutanix AOS has SSH loaded and active.\n\n$ sudo systemctl status sshd\nsshd.service - OpenSSH server daemon\nLoaded: loaded (/usr/lib/systemd/system/sshd.service; enabled)\nActive: active (running) since Tue 2015-11-17 15:17:22 EST; 4 weeks 0 days ago\nMain PID: 1348 (sshd)\nCGroup: /system.slice/sshd.service\n1053 /usr/sbin/sshd -D\n\nIf \"sshd\" does not show a status of \"active\" and \"running\", this is a finding.\n\nIf the \"SSH server\" package is not installed, this is a finding.'\n  desc 'fix', 'Configure SSH on Nutanix AOS by running the following command:\n\n$ sudo salt-call state.sls security/CVM/sshdCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57690r846701_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254205'\n  tag rid: 'SV-254205r846703_rule'\n  tag stig_id: 'NUTX-OS-001190'\n  tag gtitle: 'SRG-OS-000112-GPOS-00057'\n  tag fix_id: 'F-57641r846702_fix'\n  tag satisfies: ['SRG-OS-000112-GPOS-00057', 'SRG-OS-000113-GPOS-00058']\n  tag 'documentable'\n  tag cci: ['CCI-001941', 'CCI-001942']\n  tag nist: ['IA-2 (8)', 'IA-2 (9)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254205.rb"},"title":"Nutanix AOS must implement replay-resistant authentication mechanisms for network access to privileged accounts.","desc":"A replay attack may enable an unauthorized user to gain access to the operating system. Authentication sessions between the authenticator and the operating system validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.\n\nA privileged account is any information system account with authorizations of a privileged user.\n\nTechniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.\n\n","descriptions":{"default":"A replay attack may enable an unauthorized user to gain access to the operating system. Authentication sessions between the authenticator and the operating system validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message.\n\nA privileged account is any information system account with authorizations of a privileged user.\n\nTechniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.\n\n","check":"Confirm Nutanix AOS has SSH loaded and active.\n\n$ sudo systemctl status sshd\nsshd.service - OpenSSH server daemon\nLoaded: loaded (/usr/lib/systemd/system/sshd.service; enabled)\nActive: active (running) since Tue 2015-11-17 15:17:22 EST; 4 weeks 0 days ago\nMain PID: 1348 (sshd)\nCGroup: /system.slice/sshd.service\n1053 /usr/sbin/sshd -D\n\nIf \"sshd\" does not show a status of \"active\" and \"running\", this is a finding.\n\nIf the \"SSH server\" package is not installed, this is a finding.","fix":"Configure SSH on Nutanix AOS by running the following command:\n\n$ sudo salt-call state.sls security/CVM/sshdCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57690r846701_chk","severity":"medium","gid":"V-254205","rid":"SV-254205r846703_rule","stig_id":"NUTX-OS-001190","gtitle":"SRG-OS-000112-GPOS-00057","fix_id":"F-57641r846702_fix","satisfies":["SRG-OS-000112-GPOS-00057","SRG-OS-000113-GPOS-00058"],"documentable":null,"cci":["CCI-001941","CCI-001942"],"nist":["IA-2 (8)","IA-2 (9)"]}},{"id":"SV-254206","code":"control 'SV-254206' do\n  title 'Nutanix AOS must be configured to disable USB mass storage devices.'\n  desc 'Without identifying devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity.\n\nPeripherals include, but are not limited to, devices such as flash drives, external storage, and printers.'\n  desc 'check', 'Confirm Nutanix AOS is configured to disable USB mass storage devices.\n\n$ sudo grep -r usb-storage /etc/modprobe.d/* | grep -i \"/bin/true\" | grep -v \"^#\"\ninstall usb-storage /bin/true\n\nIf the command does not return any output, or the line is commented out, and use of USB Storage is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.\n\nVerify the operating system disables the ability to use USB mass storage devices.\nDetermine if USB mass storage is disabled with the following command:\n\n$ sudo grep usb-storage /etc/modprobe.d/* | grep -i \"blacklist\" | grep -v \"^#\"\nblacklist usb-storage\n\nIf the command does not return any output or the output is not \"blacklist usb-storage\", and use of USB storage devices is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.'\n  desc 'fix', 'Configure the system to disable USB mass storage and blacklist from executing by running the following command:\n\n$ sudo salt-call state.sls security/CVM/modprobeCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57691r846704_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254206'\n  tag rid: 'SV-254206r846706_rule'\n  tag stig_id: 'NUTX-OS-001210'\n  tag gtitle: 'SRG-OS-000114-GPOS-00059'\n  tag fix_id: 'F-57642r846705_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000778']\n  tag nist: ['IA-3']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254206.rb"},"title":"Nutanix AOS must be configured to disable USB mass storage devices.","desc":"Without identifying devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity.\n\nPeripherals include, but are not limited to, devices such as flash drives, external storage, and printers.","descriptions":{"default":"Without identifying devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity.\n\nPeripherals include, but are not limited to, devices such as flash drives, external storage, and printers.","check":"Confirm Nutanix AOS is configured to disable USB mass storage devices.\n\n$ sudo grep -r usb-storage /etc/modprobe.d/* | grep -i \"/bin/true\" | grep -v \"^#\"\ninstall usb-storage /bin/true\n\nIf the command does not return any output, or the line is commented out, and use of USB Storage is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.\n\nVerify the operating system disables the ability to use USB mass storage devices.\nDetermine if USB mass storage is disabled with the following command:\n\n$ sudo grep usb-storage /etc/modprobe.d/* | grep -i \"blacklist\" | grep -v \"^#\"\nblacklist usb-storage\n\nIf the command does not return any output or the output is not \"blacklist usb-storage\", and use of USB storage devices is not documented with the Information System Security Officer (ISSO) as an operational requirement, this is a finding.","fix":"Configure the system to disable USB mass storage and blacklist from executing by running the following command:\n\n$ sudo salt-call state.sls security/CVM/modprobeCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57691r846704_chk","severity":"medium","gid":"V-254206","rid":"SV-254206r846706_rule","stig_id":"NUTX-OS-001210","gtitle":"SRG-OS-000114-GPOS-00059","fix_id":"F-57642r846705_fix","documentable":null,"cci":["CCI-000778"],"nist":["IA-3"]}},{"id":"SV-254207","code":"control 'SV-254207' do\n  title 'Nutanix AOS must be configured to disable user accounts after the password expires.'\n  desc 'Inactive identifiers pose a risk to systems and applications because attackers may exploit an inactive identifier and potentially obtain undetected access to the system. Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained.\n\nOperating systems need to track periods of inactivity and disable application identifiers after zero days of inactivity.'\n  desc 'check', 'Confirm Nutanix AOS is configured to disable user accounts after the password expires.\n\n$ sudo grep -i inactive /etc/default/useradd\nINACTIVE=0\n\nIf the value is not set to \"0\", is commented out, or is not defined, this is a finding.'\n  desc 'fix', 'Configure the system to disable inactive user accounts after the password expires by running the following command.\n\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.3\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57692r846707_chk'\n  tag severity: 'low'\n  tag gid: 'V-254207'\n  tag rid: 'SV-254207r846709_rule'\n  tag stig_id: 'NUTX-OS-001220'\n  tag gtitle: 'SRG-OS-000118-GPOS-00060'\n  tag fix_id: 'F-57643r846708_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000795']\n  tag nist: ['IA-4 e']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254207.rb"},"title":"Nutanix AOS must be configured to disable user accounts after the password expires.","desc":"Inactive identifiers pose a risk to systems and applications because attackers may exploit an inactive identifier and potentially obtain undetected access to the system. Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained.\n\nOperating systems need to track periods of inactivity and disable application identifiers after zero days of inactivity.","descriptions":{"default":"Inactive identifiers pose a risk to systems and applications because attackers may exploit an inactive identifier and potentially obtain undetected access to the system. Owners of inactive accounts will not notice if unauthorized access to their user account has been obtained.\n\nOperating systems need to track periods of inactivity and disable application identifiers after zero days of inactivity.","check":"Confirm Nutanix AOS is configured to disable user accounts after the password expires.\n\n$ sudo grep -i inactive /etc/default/useradd\nINACTIVE=0\n\nIf the value is not set to \"0\", is commented out, or is not defined, this is a finding.","fix":"Configure the system to disable inactive user accounts after the password expires by running the following command.\n\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.3,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57692r846707_chk","severity":"low","gid":"V-254207","rid":"SV-254207r846709_rule","stig_id":"NUTX-OS-001220","gtitle":"SRG-OS-000118-GPOS-00060","fix_id":"F-57643r846708_fix","documentable":null,"cci":["CCI-000795"],"nist":["IA-4 e"]}},{"id":"SV-254208","code":"control 'SV-254208' do\n  title 'Nutanix AOS must enforce password complexity by requiring that at least one uppercase character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.'\n  desc 'check', 'Confirm Nutanix AOS is configured to require complex passwords.\nNote: The value to require a number of uppercase characters to be set is expressed as a negative number in \"/etc/security/pwquality.conf\".\n\nCheck the value for \"ucredit\" in \"/etc/security/pwquality.conf\" with the following command.\n\n$ sudo grep ucredit /etc/security/pwquality.conf \nucredit = -1\n\nIf the value of \"ucredit\" is not set to a negative value, this is a finding.'\n  desc 'fix', 'Configure the complex password requirements by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57693r846710_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254208'\n  tag rid: 'SV-254208r846712_rule'\n  tag stig_id: 'NUTX-OS-001230'\n  tag gtitle: 'SRG-OS-000069-GPOS-00037'\n  tag fix_id: 'F-57644r846711_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000192']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254208.rb"},"title":"Nutanix AOS must enforce password complexity by requiring that at least one uppercase character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","check":"Confirm Nutanix AOS is configured to require complex passwords.\nNote: The value to require a number of uppercase characters to be set is expressed as a negative number in \"/etc/security/pwquality.conf\".\n\nCheck the value for \"ucredit\" in \"/etc/security/pwquality.conf\" with the following command.\n\n$ sudo grep ucredit /etc/security/pwquality.conf \nucredit = -1\n\nIf the value of \"ucredit\" is not set to a negative value, this is a finding.","fix":"Configure the complex password requirements by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57693r846710_chk","severity":"medium","gid":"V-254208","rid":"SV-254208r846712_rule","stig_id":"NUTX-OS-001230","gtitle":"SRG-OS-000069-GPOS-00037","fix_id":"F-57644r846711_fix","documentable":null,"cci":["CCI-000192"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-254209","code":"control 'SV-254209' do\n  title 'Nutanix AOS must enforce password complexity by requiring that at least one lowercase character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.'\n  desc 'check', 'Confirm Nutanix AOS is configured to require complex passwords.\nNote: The value to require a number of lowercase characters to be set is expressed as a negative number in \"/etc/security/pwquality.conf\".\n\nCheck the value for \"lcredit\" in \"/etc/security/pwquality.conf\" with the following command:\n\n$ sudo grep lcredit /etc/security/pwquality.conf \nlcredit = -1\n\nIf the value of \"lcredit\" is not set to a negative value, this is a finding.'\n  desc 'fix', 'Configure the complex password requirements by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57694r846713_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254209'\n  tag rid: 'SV-254209r846715_rule'\n  tag stig_id: 'NUTX-OS-001240'\n  tag gtitle: 'SRG-OS-000070-GPOS-00038'\n  tag fix_id: 'F-57645r846714_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000193']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254209.rb"},"title":"Nutanix AOS must enforce password complexity by requiring that at least one lowercase character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","check":"Confirm Nutanix AOS is configured to require complex passwords.\nNote: The value to require a number of lowercase characters to be set is expressed as a negative number in \"/etc/security/pwquality.conf\".\n\nCheck the value for \"lcredit\" in \"/etc/security/pwquality.conf\" with the following command:\n\n$ sudo grep lcredit /etc/security/pwquality.conf \nlcredit = -1\n\nIf the value of \"lcredit\" is not set to a negative value, this is a finding.","fix":"Configure the complex password requirements by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57694r846713_chk","severity":"medium","gid":"V-254209","rid":"SV-254209r846715_rule","stig_id":"NUTX-OS-001240","gtitle":"SRG-OS-000070-GPOS-00038","fix_id":"F-57645r846714_fix","documentable":null,"cci":["CCI-000193"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-254210","code":"control 'SV-254210' do\n  title 'Nutanix AOS must enforce password complexity by requiring that at least one numeric character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.'\n  desc 'check', 'Confirm Nutanix AOS is configured to require complex passwords.\nNote: The value to require a number of numeric characters to be set is expressed as a negative number in \"/etc/security/pwquality.conf\".\n\nCheck the value for \"dcredit\" in \"/etc/security/pwquality.conf\" with the following command:\n\n$ sudo grep dcredit /etc/security/pwquality.conf \ndcredit = -1\n\nIf the value of \"dcredit\" is not set to a negative value, this is a finding.'\n  desc 'fix', 'Configure the complex password requirements by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57695r846716_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254210'\n  tag rid: 'SV-254210r846718_rule'\n  tag stig_id: 'NUTX-OS-001250'\n  tag gtitle: 'SRG-OS-000071-GPOS-00039'\n  tag fix_id: 'F-57646r846717_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000194']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254210.rb"},"title":"Nutanix AOS must enforce password complexity by requiring that at least one numeric character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","check":"Confirm Nutanix AOS is configured to require complex passwords.\nNote: The value to require a number of numeric characters to be set is expressed as a negative number in \"/etc/security/pwquality.conf\".\n\nCheck the value for \"dcredit\" in \"/etc/security/pwquality.conf\" with the following command:\n\n$ sudo grep dcredit /etc/security/pwquality.conf \ndcredit = -1\n\nIf the value of \"dcredit\" is not set to a negative value, this is a finding.","fix":"Configure the complex password requirements by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57695r846716_chk","severity":"medium","gid":"V-254210","rid":"SV-254210r846718_rule","stig_id":"NUTX-OS-001250","gtitle":"SRG-OS-000071-GPOS-00039","fix_id":"F-57646r846717_fix","documentable":null,"cci":["CCI-000194"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-254211","code":"control 'SV-254211' do\n  title 'Nutanix AOS must enforce a minimum 15 character password length.'\n  desc 'The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.'\n  desc 'check', 'Confirm Nutanix AOS is configured to enforce a minimum 15 character password length.\n\n$ sudo grep minlen /etc/security/pwquality.conf\nminlen = 15\n\nIf the command does not return a \"minlen\" value of \"15\" or greater, this is a finding.'\n  desc 'fix', 'Configure the password minimum length requirement of 15 characters by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57696r846719_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254211'\n  tag rid: 'SV-254211r846721_rule'\n  tag stig_id: 'NUTX-OS-001260'\n  tag gtitle: 'SRG-OS-000078-GPOS-00046'\n  tag fix_id: 'F-57647r846720_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000205']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254211.rb"},"title":"Nutanix AOS must enforce a minimum 15 character password length.","desc":"The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","descriptions":{"default":"The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","check":"Confirm Nutanix AOS is configured to enforce a minimum 15 character password length.\n\n$ sudo grep minlen /etc/security/pwquality.conf\nminlen = 15\n\nIf the command does not return a \"minlen\" value of \"15\" or greater, this is a finding.","fix":"Configure the password minimum length requirement of 15 characters by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57696r846719_chk","severity":"medium","gid":"V-254211","rid":"SV-254211r846721_rule","stig_id":"NUTX-OS-001260","gtitle":"SRG-OS-000078-GPOS-00046","fix_id":"F-57647r846720_fix","documentable":null,"cci":["CCI-000205"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-254212","code":"control 'SV-254212' do\n  title 'Nutanix AOS must enforce password complexity by requiring that at least one special character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nSpecial characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.'\n  desc 'check', 'Confirm Nutanix AOS enforces password complexity by requiring that at least one special character be used.\n\nNote: The value to require a number of special characters to be set is expressed as a negative number in \"/etc/security/pwquality.conf\".\n\nCheck the value for \"ocredit\" in \"/etc/security/pwquality.conf\" with the following command:\n\n$ sudo grep ocredit /etc/security/pwquality.conf \nocredit=-1\n\nIf the value of \"ocredit\" is not set to a negative value, this is a finding.'\n  desc 'fix', 'Configure the operating system to enforce password complexity by requiring that at least one special character be used by setting the \"ocredit\" option.\n\nLog in to a Nutanix CVM and run the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57697r846722_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254212'\n  tag rid: 'SV-254212r846724_rule'\n  tag stig_id: 'NUTX-OS-001270'\n  tag gtitle: 'SRG-OS-000266-GPOS-00101'\n  tag fix_id: 'F-57648r846723_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001619']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254212.rb"},"title":"Nutanix AOS must enforce password complexity by requiring that at least one special character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nSpecial characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nSpecial characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.","check":"Confirm Nutanix AOS enforces password complexity by requiring that at least one special character be used.\n\nNote: The value to require a number of special characters to be set is expressed as a negative number in \"/etc/security/pwquality.conf\".\n\nCheck the value for \"ocredit\" in \"/etc/security/pwquality.conf\" with the following command:\n\n$ sudo grep ocredit /etc/security/pwquality.conf \nocredit=-1\n\nIf the value of \"ocredit\" is not set to a negative value, this is a finding.","fix":"Configure the operating system to enforce password complexity by requiring that at least one special character be used by setting the \"ocredit\" option.\n\nLog in to a Nutanix CVM and run the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57697r846722_chk","severity":"medium","gid":"V-254212","rid":"SV-254212r846724_rule","stig_id":"NUTX-OS-001270","gtitle":"SRG-OS-000266-GPOS-00101","fix_id":"F-57648r846723_fix","documentable":null,"cci":["CCI-001619"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-254213","code":"control 'SV-254213' do\n  title 'Nutanix AOS must require the change of at least 50 percent of the total number of characters when passwords are changed.'\n  desc 'If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number, then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.'\n  desc 'check', 'Verify Nutanix AOS is configured to require complex passwords.\n\n$ sudo grep difok /etc/security/pwquality.conf \ndifok = 8\n\nIf the value of \"difok\" is set to less than \"8\", this is a finding.'\n  desc 'fix', 'Configure the complex password requirements by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57698r846725_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254213'\n  tag rid: 'SV-254213r846727_rule'\n  tag stig_id: 'NUTX-OS-001280'\n  tag gtitle: 'SRG-OS-000072-GPOS-00040'\n  tag fix_id: 'F-57649r846726_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000195']\n  tag nist: ['IA-5 (1) (b)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254213.rb"},"title":"Nutanix AOS must require the change of at least 50 percent of the total number of characters when passwords are changed.","desc":"If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number, then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.","descriptions":{"default":"If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number, then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.","check":"Verify Nutanix AOS is configured to require complex passwords.\n\n$ sudo grep difok /etc/security/pwquality.conf \ndifok = 8\n\nIf the value of \"difok\" is set to less than \"8\", this is a finding.","fix":"Configure the complex password requirements by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57698r846725_chk","severity":"medium","gid":"V-254213","rid":"SV-254213r846727_rule","stig_id":"NUTX-OS-001280","gtitle":"SRG-OS-000072-GPOS-00040","fix_id":"F-57649r846726_fix","documentable":null,"cci":["CCI-000195"],"nist":["IA-5 (1) (b)"]}},{"id":"SV-254214","code":"control 'SV-254214' do\n  title 'Nutanix AOS must require the change of at least four character classes when passwords are changed.'\n  desc 'If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.'\n  desc 'check', 'Verify Nutanix AOS is configured to require complex passwords.\n\n$ sudo grep minclass /etc/security/pwquality.conf \nminclass = 4\n\nIf the value of \"minclass\" is set to less than \"4\", this is a finding.'\n  desc 'fix', 'Configure the complex password requirements by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57699r846728_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254214'\n  tag rid: 'SV-254214r846730_rule'\n  tag stig_id: 'NUTX-OS-001290'\n  tag gtitle: 'SRG-OS-000072-GPOS-00040'\n  tag fix_id: 'F-57650r846729_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000195']\n  tag nist: ['IA-5 (1) (b)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254214.rb"},"title":"Nutanix AOS must require the change of at least four character classes when passwords are changed.","desc":"If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.","descriptions":{"default":"If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.","check":"Verify Nutanix AOS is configured to require complex passwords.\n\n$ sudo grep minclass /etc/security/pwquality.conf \nminclass = 4\n\nIf the value of \"minclass\" is set to less than \"4\", this is a finding.","fix":"Configure the complex password requirements by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57699r846728_chk","severity":"medium","gid":"V-254214","rid":"SV-254214r846730_rule","stig_id":"NUTX-OS-001290","gtitle":"SRG-OS-000072-GPOS-00040","fix_id":"F-57650r846729_fix","documentable":null,"cci":["CCI-000195"],"nist":["IA-5 (1) (b)"]}},{"id":"SV-254215","code":"control 'SV-254215' do\n  title 'Nutanix AOS must require the maximum number of repeating characters be limited to three when passwords are changed.'\n  desc 'If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.'\n  desc 'check', 'Verify Nutanix AOS is configured to require complex passwords.\n\n$ sudo grep maxrepeat /etc/security/pwquality.conf \nmaxrepeat = 2\n\nIf the value of \"maxrepeat\" is set to more than \"2\", this is a finding.'\n  desc 'fix', 'Configure the complex password requirements by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57700r846731_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254215'\n  tag rid: 'SV-254215r846733_rule'\n  tag stig_id: 'NUTX-OS-001300'\n  tag gtitle: 'SRG-OS-000072-GPOS-00040'\n  tag fix_id: 'F-57651r846732_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000195']\n  tag nist: ['IA-5 (1) (b)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254215.rb"},"title":"Nutanix AOS must require the maximum number of repeating characters be limited to three when passwords are changed.","desc":"If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.","descriptions":{"default":"If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.","check":"Verify Nutanix AOS is configured to require complex passwords.\n\n$ sudo grep maxrepeat /etc/security/pwquality.conf \nmaxrepeat = 2\n\nIf the value of \"maxrepeat\" is set to more than \"2\", this is a finding.","fix":"Configure the complex password requirements by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57700r846731_chk","severity":"medium","gid":"V-254215","rid":"SV-254215r846733_rule","stig_id":"NUTX-OS-001300","gtitle":"SRG-OS-000072-GPOS-00040","fix_id":"F-57651r846732_fix","documentable":null,"cci":["CCI-000195"],"nist":["IA-5 (1) (b)"]}},{"id":"SV-254216","code":"control 'SV-254216' do\n  title 'Nutanix AOS must require the maximum number of repeating characters of the same character class be limited to four when passwords are changed.'\n  desc 'If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.'\n  desc 'check', 'Verify Nutanix AOS is configured to require complex passwords.\n\n$ sudo grep maxclassrepeat /etc/security/pwquality.conf \nmaxclassrepeat = 4\n\nIf the value of \"maxclassrepeat\" is set to more than \"4\", this is a finding.'\n  desc 'fix', 'Configure the complex password requirements by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57701r846734_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254216'\n  tag rid: 'SV-254216r846736_rule'\n  tag stig_id: 'NUTX-OS-001310'\n  tag gtitle: 'SRG-OS-000072-GPOS-00040'\n  tag fix_id: 'F-57652r846735_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000195']\n  tag nist: ['IA-5 (1) (b)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254216.rb"},"title":"Nutanix AOS must require the maximum number of repeating characters of the same character class be limited to four when passwords are changed.","desc":"If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.","descriptions":{"default":"If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.","check":"Verify Nutanix AOS is configured to require complex passwords.\n\n$ sudo grep maxclassrepeat /etc/security/pwquality.conf \nmaxclassrepeat = 4\n\nIf the value of \"maxclassrepeat\" is set to more than \"4\", this is a finding.","fix":"Configure the complex password requirements by running the following command:\n\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57701r846734_chk","severity":"medium","gid":"V-254216","rid":"SV-254216r846736_rule","stig_id":"NUTX-OS-001310","gtitle":"SRG-OS-000072-GPOS-00040","fix_id":"F-57652r846735_fix","documentable":null,"cci":["CCI-000195"],"nist":["IA-5 (1) (b)"]}},{"id":"SV-254217","code":"control 'SV-254217' do\n  title 'Nutanix AOS must store only encrypted representations of passwords.'\n  desc 'Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.'\n  desc 'check', 'Confirm Nutanix AOS is configured to store encrypted representation of passwords and that the encryption meets required standards.\n\n$ sudo grep -i encrypt /etc/login.defs\nENCRYPT_METHOD SHA512\n\nIf the /etc/login.defs file does not contain the required output, this is a finding.\n\n$ sudo grep -i sha512 /etc/libuser.conf\ncrypt_style = sha512\n\nIf the /etc/libuser.conf file does not contain the required output, this is a finding.'\n  desc 'fix', 'Configure the required password encryption requirements by running the following command.\n\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.7\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57702r846737_chk'\n  tag severity: 'high'\n  tag gid: 'V-254217'\n  tag rid: 'SV-254217r846739_rule'\n  tag stig_id: 'NUTX-OS-001320'\n  tag gtitle: 'SRG-OS-000073-GPOS-00041'\n  tag fix_id: 'F-57653r846738_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000196']\n  tag nist: ['IA-5 (1) (c)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254217.rb"},"title":"Nutanix AOS must store only encrypted representations of passwords.","desc":"Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.","descriptions":{"default":"Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.","check":"Confirm Nutanix AOS is configured to store encrypted representation of passwords and that the encryption meets required standards.\n\n$ sudo grep -i encrypt /etc/login.defs\nENCRYPT_METHOD SHA512\n\nIf the /etc/login.defs file does not contain the required output, this is a finding.\n\n$ sudo grep -i sha512 /etc/libuser.conf\ncrypt_style = sha512\n\nIf the /etc/libuser.conf file does not contain the required output, this is a finding.","fix":"Configure the required password encryption requirements by running the following command.\n\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.7,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57702r846737_chk","severity":"high","gid":"V-254217","rid":"SV-254217r846739_rule","stig_id":"NUTX-OS-001320","gtitle":"SRG-OS-000073-GPOS-00041","fix_id":"F-57653r846738_fix","documentable":null,"cci":["CCI-000196"],"nist":["IA-5 (1) (c)"]}},{"id":"SV-254218","code":"control 'SV-254218' do\n  title 'Nutanix AOS must enforce 24 hours/1 day as the minimum password lifetime.'\n  desc \"Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, then the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.\"\n  desc 'check', %q(Confirm Nutanix AOS is configured to enforce 24 hour/1 day minimum password lifetime.\n\n$ sudo grep -i pass_min_days /etc/login.defs\nPASS_MIN_DAYS 1\n\nIf the \"PASS_MIN_DAYS\" parameter value is not \"1\" or greater, or is commented out, this is a finding.\n\n$ sudo awk -F: '$4 < 1 {print $1 \" \" $4}' /etc/shadow\n\nIf any results are returned that are not associated with a system account, this is a finding.)\n  desc 'fix', 'Configure the password minimum age by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57703r846740_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254218'\n  tag rid: 'SV-254218r846742_rule'\n  tag stig_id: 'NUTX-OS-001340'\n  tag gtitle: 'SRG-OS-000075-GPOS-00043'\n  tag fix_id: 'F-57654r846741_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000198']\n  tag nist: ['IA-5 (1) (d)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254218.rb"},"title":"Nutanix AOS must enforce 24 hours/1 day as the minimum password lifetime.","desc":"Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, then the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.","descriptions":{"default":"Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, then the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.","check":"Confirm Nutanix AOS is configured to enforce 24 hour/1 day minimum password lifetime.\n\n$ sudo grep -i pass_min_days /etc/login.defs\nPASS_MIN_DAYS 1\n\nIf the \"PASS_MIN_DAYS\" parameter value is not \"1\" or greater, or is commented out, this is a finding.\n\n$ sudo awk -F: '$4 < 1 {print $1 \" \" $4}' /etc/shadow\n\nIf any results are returned that are not associated with a system account, this is a finding.","fix":"Configure the password minimum age by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57703r846740_chk","severity":"medium","gid":"V-254218","rid":"SV-254218r846742_rule","stig_id":"NUTX-OS-001340","gtitle":"SRG-OS-000075-GPOS-00043","fix_id":"F-57654r846741_fix","documentable":null,"cci":["CCI-000198"],"nist":["IA-5 (1) (d)"]}},{"id":"SV-254219","code":"control 'SV-254219' do\n  title 'Nutanix AOS must enforce a 60-day maximum password lifetime restriction.'\n  desc 'Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.'\n  desc 'check', %q(Confirm Nutanix AOS is configured to enforce a 60-day maximum password lifetime.\n\n$ sudo grep -i pass_max_days /etc/login.defs\nPASS_MAX_DAYS 60\n\nIf the \"PASS_MAX_DAYS\" parameter value is not \"60\" or less, or is commented out, this is a finding.\n\n$ sudo awk -F: '$5 > 60 {print $1 \" \" $5}' /etc/shadow\n\nIf any results are returned that are not associated with a system account, this is a finding.)\n  desc 'fix', 'Configure the password maximum age by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57704r846743_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254219'\n  tag rid: 'SV-254219r846745_rule'\n  tag stig_id: 'NUTX-OS-001350'\n  tag gtitle: 'SRG-OS-000076-GPOS-00044'\n  tag fix_id: 'F-57655r846744_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000199']\n  tag nist: ['IA-5 (1) (d)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254219.rb"},"title":"Nutanix AOS must enforce a 60-day maximum password lifetime restriction.","desc":"Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.","descriptions":{"default":"Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.","check":"Confirm Nutanix AOS is configured to enforce a 60-day maximum password lifetime.\n\n$ sudo grep -i pass_max_days /etc/login.defs\nPASS_MAX_DAYS 60\n\nIf the \"PASS_MAX_DAYS\" parameter value is not \"60\" or less, or is commented out, this is a finding.\n\n$ sudo awk -F: '$5 > 60 {print $1 \" \" $5}' /etc/shadow\n\nIf any results are returned that are not associated with a system account, this is a finding.","fix":"Configure the password maximum age by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57704r846743_chk","severity":"medium","gid":"V-254219","rid":"SV-254219r846745_rule","stig_id":"NUTX-OS-001350","gtitle":"SRG-OS-000076-GPOS-00044","fix_id":"F-57655r846744_fix","documentable":null,"cci":["CCI-000199"],"nist":["IA-5 (1) (d)"]}},{"id":"SV-254220","code":"control 'SV-254220' do\n  title 'Nutanix AOS must prohibit password reuse for a minimum of five generations.'\n  desc 'Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.'\n  desc 'check', 'Confirm Nutanix AOS is configured to prohibit password reuse for a minimum of five generations.\n\n$ sudo grep -i remember /etc/pam.d/system-auth /etc/pam.d/password-auth\npassword requisite pam_pwhistory.so use_authtok remember=5 retry=3\n\nIf the line containing the \"pam_pwhistory.so\" line does not have the \"remember\" module argument set, is commented out, or the value of the \"remember\" module argument is set to less than \"5\", this is a finding.'\n  desc 'fix', 'Configure the password maximum age by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57705r846746_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254220'\n  tag rid: 'SV-254220r846748_rule'\n  tag stig_id: 'NUTX-OS-001360'\n  tag gtitle: 'SRG-OS-000077-GPOS-00045'\n  tag fix_id: 'F-57656r846747_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000200']\n  tag nist: ['IA-5 (1) (e)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254220.rb"},"title":"Nutanix AOS must prohibit password reuse for a minimum of five generations.","desc":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.","descriptions":{"default":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.","check":"Confirm Nutanix AOS is configured to prohibit password reuse for a minimum of five generations.\n\n$ sudo grep -i remember /etc/pam.d/system-auth /etc/pam.d/password-auth\npassword requisite pam_pwhistory.so use_authtok remember=5 retry=3\n\nIf the line containing the \"pam_pwhistory.so\" line does not have the \"remember\" module argument set, is commented out, or the value of the \"remember\" module argument is set to less than \"5\", this is a finding.","fix":"Configure the password maximum age by running the following command:\n\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57705r846746_chk","severity":"medium","gid":"V-254220","rid":"SV-254220r846748_rule","stig_id":"NUTX-OS-001360","gtitle":"SRG-OS-000077-GPOS-00045","fix_id":"F-57656r846747_fix","documentable":null,"cci":["CCI-000200"],"nist":["IA-5 (1) (e)"]}},{"id":"SV-254221","code":"control 'SV-254221' do\n  title 'Nutanix AOS must prohibit the use of cached authenticators.'\n  desc 'If cached authentication information is out-of-date, the validity of the authentication information may be questionable.'\n  desc 'check', 'Confirm Nutanix AOS is not configured to allow cached credentials via the System Security Session Daemon (SSSD).\n\n$ service sssd status\n\nIf the sssd service is installed or active, this is a finding.'\n  desc 'fix', 'If the SSSD service is installed, the Controller VM must be reinstalled.'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57706r846749_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254221'\n  tag rid: 'SV-254221r846751_rule'\n  tag stig_id: 'NUTX-OS-001370'\n  tag gtitle: 'SRG-OS-000383-GPOS-00166'\n  tag fix_id: 'F-57657r846750_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002007']\n  tag nist: ['IA-5 (13)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254221.rb"},"title":"Nutanix AOS must prohibit the use of cached authenticators.","desc":"If cached authentication information is out-of-date, the validity of the authentication information may be questionable.","descriptions":{"default":"If cached authentication information is out-of-date, the validity of the authentication information may be questionable.","check":"Confirm Nutanix AOS is not configured to allow cached credentials via the System Security Session Daemon (SSSD).\n\n$ service sssd status\n\nIf the sssd service is installed or active, this is a finding.","fix":"If the SSSD service is installed, the Controller VM must be reinstalled."},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57706r846749_chk","severity":"medium","gid":"V-254221","rid":"SV-254221r846751_rule","stig_id":"NUTX-OS-001370","gtitle":"SRG-OS-000383-GPOS-00166","fix_id":"F-57657r846750_fix","documentable":null,"cci":["CCI-002007"],"nist":["IA-5 (13)"]}},{"id":"SV-254222","code":"control 'SV-254222' do\n  title 'Nutanix AOS pam_unix.so module must be configured in the password-auth file to use a FIPS 140-2 approved cryptographic hashing algorithm for system authentication.'\n  desc 'Unapproved mechanisms used for authentication to the cryptographic module are not verified and therefore, cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\nOperating systems utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements. This allows for Security Levels 1, 2, 3, or 4 for use on a general purpose computing system.'\n  desc 'check', 'Verify that the pam_unix.so module is configured to use SHA512.\n\n$ sudo grep password /etc/pam.d/password-auth | grep pam_unix\npassword    sufficient    pam_unix.so sha512 shadow try_first_pass use_authtok\n\n$ sudo grep password /etc/pam.d/system-auth | grep pam_unix\npassword    sufficient    pam_unix.so sha512 shadow try_first_pass use_authtok\n\nIf \"sha512\" is not an option in both outputs, or is commented out, this is a finding.'\n  desc 'fix', 'Configure the pam.d modules to comply with FIPS 140-2:\n\n1. Enable high-strength passwords:\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true\n\n2. After enabling the high-strength passwords, the system will process the salt stack to enable the DoD versions of the pam.d files. Recheck the Check Text for compliance.  \n\nTo run the salt command manually to enable the pam.d auth files, run the following command (high-strength passwords must be set to true):\n$ sudo salt-call state.sls security/CVM/pamCVM'\n  impact 0.7\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57707r846752_chk'\n  tag severity: 'high'\n  tag gid: 'V-254222'\n  tag rid: 'SV-254222r846754_rule'\n  tag stig_id: 'NUTX-OS-001380'\n  tag gtitle: 'SRG-OS-000120-GPOS-00061'\n  tag fix_id: 'F-57658r846753_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000803']\n  tag nist: ['IA-7']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254222.rb"},"title":"Nutanix AOS pam_unix.so module must be configured in the password-auth file to use a FIPS 140-2 approved cryptographic hashing algorithm for system authentication.","desc":"Unapproved mechanisms used for authentication to the cryptographic module are not verified and therefore, cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\nOperating systems utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements. This allows for Security Levels 1, 2, 3, or 4 for use on a general purpose computing system.","descriptions":{"default":"Unapproved mechanisms used for authentication to the cryptographic module are not verified and therefore, cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\nOperating systems utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DoD requirements. This allows for Security Levels 1, 2, 3, or 4 for use on a general purpose computing system.","check":"Verify that the pam_unix.so module is configured to use SHA512.\n\n$ sudo grep password /etc/pam.d/password-auth | grep pam_unix\npassword    sufficient    pam_unix.so sha512 shadow try_first_pass use_authtok\n\n$ sudo grep password /etc/pam.d/system-auth | grep pam_unix\npassword    sufficient    pam_unix.so sha512 shadow try_first_pass use_authtok\n\nIf \"sha512\" is not an option in both outputs, or is commented out, this is a finding.","fix":"Configure the pam.d modules to comply with FIPS 140-2:\n\n1. Enable high-strength passwords:\n$ ncli cluster edit-cvm-security-params enable-high-strength-password=true\n\n2. After enabling the high-strength passwords, the system will process the salt stack to enable the DoD versions of the pam.d files. Recheck the Check Text for compliance.  \n\nTo run the salt command manually to enable the pam.d auth files, run the following command (high-strength passwords must be set to true):\n$ sudo salt-call state.sls security/CVM/pamCVM"},"impact":0.7,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57707r846752_chk","severity":"high","gid":"V-254222","rid":"SV-254222r846754_rule","stig_id":"NUTX-OS-001380","gtitle":"SRG-OS-000120-GPOS-00061","fix_id":"F-57658r846753_fix","documentable":null,"cci":["CCI-000803"],"nist":["IA-7"]}},{"id":"SV-254223","code":"control 'SV-254223' do\n  title 'Nutanix AOS must audit all activities performed during nonlocal maintenance and diagnostic sessions.'\n  desc 'If events associated with nonlocal administrative access or diagnostic sessions are not logged, a major tool for assessing and investigating attacks would not be available.\n\nThis requirement addresses auditing-related issues associated with maintenance tools used specifically for diagnostic and repair actions on organizational information systems.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection.\n\nThis requirement applies to hardware/software diagnostic test equipment or tools. This requirement does not cover hardware/software components that may support information system maintenance, yet are a part of the system, for example, the software implementing \"ping,\" \"ls,\" \"ipconfig,\" or the hardware and software implementing the monitoring port of an Ethernet switch.'\n  desc 'check', 'Confirm Nutanix AOS audits all required activities performed during nonlocal maintenance and diagnostic sessions.\n\n$ sudo grep -i /usr/sbin/semanage /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/sbin/setsebool /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/bin/chcon /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -iw /usr/sbin/setfiles /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change\n\n$ sudo grep -i /var/run/faillock /etc/audit/audit.rules\n-w /var/run/faillock/ -p wa -k logins\n\n$ sudo grep -i /var/log/lastlog /etc/audit/audit.rules\n-w /var/log/lastlog -p wa -k logins\n\nIf any of the commands listed do not return any output, this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS to audit all required activities performed during nonlocal maintenance and diagnostic sessions by running the following command.\n\nsalt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57708r846755_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254223'\n  tag rid: 'SV-254223r846757_rule'\n  tag stig_id: 'NUTX-OS-001390'\n  tag gtitle: 'SRG-OS-000392-GPOS-00172'\n  tag fix_id: 'F-57659r846756_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002884']\n  tag nist: ['MA-4 (1) (a)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254223.rb"},"title":"Nutanix AOS must audit all activities performed during nonlocal maintenance and diagnostic sessions.","desc":"If events associated with nonlocal administrative access or diagnostic sessions are not logged, a major tool for assessing and investigating attacks would not be available.\n\nThis requirement addresses auditing-related issues associated with maintenance tools used specifically for diagnostic and repair actions on organizational information systems.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection.\n\nThis requirement applies to hardware/software diagnostic test equipment or tools. This requirement does not cover hardware/software components that may support information system maintenance, yet are a part of the system, for example, the software implementing \"ping,\" \"ls,\" \"ipconfig,\" or the hardware and software implementing the monitoring port of an Ethernet switch.","descriptions":{"default":"If events associated with nonlocal administrative access or diagnostic sessions are not logged, a major tool for assessing and investigating attacks would not be available.\n\nThis requirement addresses auditing-related issues associated with maintenance tools used specifically for diagnostic and repair actions on organizational information systems.\n\nNonlocal maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network (e.g., the internet) or an internal network. Local maintenance and diagnostic activities are those activities carried out by individuals physically present at the information system or information system component and not communicating across a network connection.\n\nThis requirement applies to hardware/software diagnostic test equipment or tools. This requirement does not cover hardware/software components that may support information system maintenance, yet are a part of the system, for example, the software implementing \"ping,\" \"ls,\" \"ipconfig,\" or the hardware and software implementing the monitoring port of an Ethernet switch.","check":"Confirm Nutanix AOS audits all required activities performed during nonlocal maintenance and diagnostic sessions.\n\n$ sudo grep -i /usr/sbin/semanage /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/semanage -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/sbin/setsebool /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setsebool -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -i /usr/bin/chcon /etc/audit/audit.rules\n-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=4294967295 -k secobjects\n\n$ sudo grep -iw /usr/sbin/setfiles /etc/audit/audit.rules\n-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=4294967295 -k privileged-priv_change\n\n$ sudo grep -i /var/run/faillock /etc/audit/audit.rules\n-w /var/run/faillock/ -p wa -k logins\n\n$ sudo grep -i /var/log/lastlog /etc/audit/audit.rules\n-w /var/log/lastlog -p wa -k logins\n\nIf any of the commands listed do not return any output, this is a finding.","fix":"Configure Nutanix AOS to audit all required activities performed during nonlocal maintenance and diagnostic sessions by running the following command.\n\nsalt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57708r846755_chk","severity":"medium","gid":"V-254223","rid":"SV-254223r846757_rule","stig_id":"NUTX-OS-001390","gtitle":"SRG-OS-000392-GPOS-00172","fix_id":"F-57659r846756_fix","documentable":null,"cci":["CCI-002884"],"nist":["MA-4 (1) (a)"]}},{"id":"SV-254224","code":"control 'SV-254224' do\n  title 'Nutanix AOS must enable FIPS mode to implement NIST FIPS-validated cryptography.'\n  desc 'Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n'\n  desc 'check', 'Confirm Nutanix AOS implements DoD-approved encryption to protect the confidentiality of remote access sessions.\n\nDetermine if the \"dracut-fips\" package is installed with the following command:\n\n$ sudo yum list installed dracut-fips\ndracut-fips.x86_64-033-572.el7 \n\nIf dracut-fips package is not installed, this is a finding.\n\nDetermine if FIPS mode is enabled with the following command:\n\n$ fipscheck\nusage: fipscheck [-s <hmac-suffix>] <paths-to-files>\nfips mode is on\n\nIf FIPS mode is \"on\", Determine if the kernel boot parameter is configured for FIPS mode with the following command:\n\n$ sudo cat /boot/grub/grub.conf | grep fips\n\nIt the  kernel output does not list \"fips=1\", this is a finding.\n\nIf the kernel boot parameter is configured to use FIPS mode, Determine if the system is in FIPS mode with the following command:\n\n$ sudo cat /proc/sys/crypto/fips_enabled\n1\n\nIf FIPS mode is not \"on\", the kernel boot parameter is not configured for FIPS mode, or the system does not have a value of \"1\" for \"fips_enabled\" in \"/proc/sys/crypto\", this is a finding.'\n  desc 'fix', 'Configure the system to run in FIPS mode by running the following command:\n\n$ sudo salt-call state.sls security/CVM/fipsCVM'\n  impact 0.7\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57709r846758_chk'\n  tag severity: 'high'\n  tag gid: 'V-254224'\n  tag rid: 'SV-254224r846760_rule'\n  tag stig_id: 'NUTX-OS-001460'\n  tag gtitle: 'SRG-OS-000478-GPOS-00223'\n  tag fix_id: 'F-57660r846759_fix'\n  tag satisfies: ['SRG-OS-000478-GPOS-00223', 'SRG-OS-000396-GPOS-00176']\n  tag 'documentable'\n  tag cci: ['CCI-002450']\n  tag nist: ['SC-13 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254224.rb"},"title":"Nutanix AOS must enable FIPS mode to implement NIST FIPS-validated cryptography.","desc":"Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n","descriptions":{"default":"Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n","check":"Confirm Nutanix AOS implements DoD-approved encryption to protect the confidentiality of remote access sessions.\n\nDetermine if the \"dracut-fips\" package is installed with the following command:\n\n$ sudo yum list installed dracut-fips\ndracut-fips.x86_64-033-572.el7 \n\nIf dracut-fips package is not installed, this is a finding.\n\nDetermine if FIPS mode is enabled with the following command:\n\n$ fipscheck\nusage: fipscheck [-s <hmac-suffix>] <paths-to-files>\nfips mode is on\n\nIf FIPS mode is \"on\", Determine if the kernel boot parameter is configured for FIPS mode with the following command:\n\n$ sudo cat /boot/grub/grub.conf | grep fips\n\nIt the  kernel output does not list \"fips=1\", this is a finding.\n\nIf the kernel boot parameter is configured to use FIPS mode, Determine if the system is in FIPS mode with the following command:\n\n$ sudo cat /proc/sys/crypto/fips_enabled\n1\n\nIf FIPS mode is not \"on\", the kernel boot parameter is not configured for FIPS mode, or the system does not have a value of \"1\" for \"fips_enabled\" in \"/proc/sys/crypto\", this is a finding.","fix":"Configure the system to run in FIPS mode by running the following command:\n\n$ sudo salt-call state.sls security/CVM/fipsCVM"},"impact":0.7,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57709r846758_chk","severity":"high","gid":"V-254224","rid":"SV-254224r846760_rule","stig_id":"NUTX-OS-001460","gtitle":"SRG-OS-000478-GPOS-00223","fix_id":"F-57660r846759_fix","satisfies":["SRG-OS-000478-GPOS-00223","SRG-OS-000396-GPOS-00176"],"documentable":null,"cci":["CCI-002450"],"nist":["SC-13 b"]}},{"id":"SV-254225","code":"control 'SV-254225' do\n  title 'Nutanix AOS must be configured to run SELinux Policies.'\n  desc 'Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.'\n  desc 'check', 'Nutanix AOS is configured by default to run SELinux Policies. Confirm Nutanix AOS has the policycoreutils package installed with the following command:\n\n$ sudo yum list installed policycoreutils\nInstalled Packages\npolicycoreutils.x86_64                                                 2.5-34.el7                                                 @base\n\nIf the policycoreutils package is not installed, this is a finding.'\n  desc 'fix', 'Configure the operating system to have the policycoreutils package installed with the following command:\n\n$ sudo yum install policycoreutils'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57710r846761_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254225'\n  tag rid: 'SV-254225r846763_rule'\n  tag stig_id: 'NUTX-OS-001480'\n  tag gtitle: 'SRG-OS-000134-GPOS-00068'\n  tag fix_id: 'F-57661r846762_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001084']\n  tag nist: ['SC-3']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254225.rb"},"title":"Nutanix AOS must be configured to run SELinux Policies.","desc":"Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.","descriptions":{"default":"Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.","check":"Nutanix AOS is configured by default to run SELinux Policies. Confirm Nutanix AOS has the policycoreutils package installed with the following command:\n\n$ sudo yum list installed policycoreutils\nInstalled Packages\npolicycoreutils.x86_64                                                 2.5-34.el7                                                 @base\n\nIf the policycoreutils package is not installed, this is a finding.","fix":"Configure the operating system to have the policycoreutils package installed with the following command:\n\n$ sudo yum install policycoreutils"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57710r846761_chk","severity":"medium","gid":"V-254225","rid":"SV-254225r846763_rule","stig_id":"NUTX-OS-001480","gtitle":"SRG-OS-000134-GPOS-00068","fix_id":"F-57661r846762_fix","documentable":null,"cci":["CCI-001084"],"nist":["SC-3"]}},{"id":"SV-254226","code":"control 'SV-254226' do\n  title 'Nutanix AOS must be configured to restrict public directories.'\n  desc 'Preventing unauthorized information transfers mitigates the risk of information, including encrypted representations of information, produced by the actions of prior users/roles (or the actions of processes acting on behalf of prior users/roles) from being available to any current users/roles (or current processes) that obtain access to shared system resources (e.g., registers, main memory, hard disks) after those resources have been released back to information systems. The control of information in shared resources is also commonly referred to as object reuse and residual information protection.\n\nThis requirement generally applies to the design of an information technology product, but it can also apply to the configuration of particular information system components that are, or use, such products. This can be verified by acceptance/validation processes in DoD or other government agencies.\n\nThere may be shared resources with configurable protections (e.g., files in storage) that may be assessed on specific information system components.'\n  desc 'check', 'Confirm Nutanix AOS provides that all public directories are owned by root or a system account with the following command:\n\n$ sudo find / -type d -perm -0002 -exec ls -lLd {} \\\\;\ndrwxrwxrwt. 2 root root 40 Jun  4 15:21 /dev/mqueue\ndrwxrwxrwt. 2 root root 40 Jun  4 15:21 /dev/shm\ndrwxrwxrwt. 7 root root 4096 Jul 28 15:37 /tmp\n\nIf any of the returned directories are not owned by root or a system account, this is a finding.\n\nDetermine that all world-writable directories have the sticky bit set by running the following command:\n\n$ sudo find / -type d \\\\( -perm -0002 -a ! -perm -1000 \\\\) -print 2>/dev/null\ndrwxrwxrwxt 7 root root 4096 Jul 26 11:19 /tmp\n\nIf any of the returned directories are world-writable and do not have the sticky bit set, this is a finding.'\n  desc 'fix', 'Configure all public directories to be owned by root or a system account to prevent unauthorized and unintended information transferred via shared system resources.\n\nSet the owner of all public directories as root or a system account using the command, replace \"[Public Directory]\" with any directory path not owned by root or a system account:\n\n$ sudo chown root [Public Directory]\n\nSet the sticky bit on all world-writable directories using the command, replace \"[World-Writable Directory]\" with any directory path missing the sticky bit:\n\n$ sudo chmod 1777 [World-Writable Directory]'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57711r846764_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254226'\n  tag rid: 'SV-254226r846766_rule'\n  tag stig_id: 'NUTX-OS-001490'\n  tag gtitle: 'SRG-OS-000138-GPOS-00069'\n  tag fix_id: 'F-57662r846765_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001090']\n  tag nist: ['SC-4']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254226.rb"},"title":"Nutanix AOS must be configured to restrict public directories.","desc":"Preventing unauthorized information transfers mitigates the risk of information, including encrypted representations of information, produced by the actions of prior users/roles (or the actions of processes acting on behalf of prior users/roles) from being available to any current users/roles (or current processes) that obtain access to shared system resources (e.g., registers, main memory, hard disks) after those resources have been released back to information systems. The control of information in shared resources is also commonly referred to as object reuse and residual information protection.\n\nThis requirement generally applies to the design of an information technology product, but it can also apply to the configuration of particular information system components that are, or use, such products. This can be verified by acceptance/validation processes in DoD or other government agencies.\n\nThere may be shared resources with configurable protections (e.g., files in storage) that may be assessed on specific information system components.","descriptions":{"default":"Preventing unauthorized information transfers mitigates the risk of information, including encrypted representations of information, produced by the actions of prior users/roles (or the actions of processes acting on behalf of prior users/roles) from being available to any current users/roles (or current processes) that obtain access to shared system resources (e.g., registers, main memory, hard disks) after those resources have been released back to information systems. The control of information in shared resources is also commonly referred to as object reuse and residual information protection.\n\nThis requirement generally applies to the design of an information technology product, but it can also apply to the configuration of particular information system components that are, or use, such products. This can be verified by acceptance/validation processes in DoD or other government agencies.\n\nThere may be shared resources with configurable protections (e.g., files in storage) that may be assessed on specific information system components.","check":"Confirm Nutanix AOS provides that all public directories are owned by root or a system account with the following command:\n\n$ sudo find / -type d -perm -0002 -exec ls -lLd {} \\;\ndrwxrwxrwt. 2 root root 40 Jun  4 15:21 /dev/mqueue\ndrwxrwxrwt. 2 root root 40 Jun  4 15:21 /dev/shm\ndrwxrwxrwt. 7 root root 4096 Jul 28 15:37 /tmp\n\nIf any of the returned directories are not owned by root or a system account, this is a finding.\n\nDetermine that all world-writable directories have the sticky bit set by running the following command:\n\n$ sudo find / -type d \\( -perm -0002 -a ! -perm -1000 \\) -print 2>/dev/null\ndrwxrwxrwxt 7 root root 4096 Jul 26 11:19 /tmp\n\nIf any of the returned directories are world-writable and do not have the sticky bit set, this is a finding.","fix":"Configure all public directories to be owned by root or a system account to prevent unauthorized and unintended information transferred via shared system resources.\n\nSet the owner of all public directories as root or a system account using the command, replace \"[Public Directory]\" with any directory path not owned by root or a system account:\n\n$ sudo chown root [Public Directory]\n\nSet the sticky bit on all world-writable directories using the command, replace \"[World-Writable Directory]\" with any directory path missing the sticky bit:\n\n$ sudo chmod 1777 [World-Writable Directory]"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57711r846764_chk","severity":"medium","gid":"V-254226","rid":"SV-254226r846766_rule","stig_id":"NUTX-OS-001490","gtitle":"SRG-OS-000138-GPOS-00069","fix_id":"F-57662r846765_fix","documentable":null,"cci":["CCI-001090"],"nist":["SC-4"]}},{"id":"SV-254227","code":"control 'SV-254227' do\n  title 'Nutanix AOS must protect against or limit the effects of denial-of-service (DoS) attacks by ensuring the operating system is implementing rate-limiting measures on impacted network interfaces.'\n  desc 'DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nThis requirement addresses the configuration of the operating system to mitigate the impact of DoS attacks that have occurred or are ongoing on system availability. For each system, known and potential DoS attacks must be identified and solutions for each type implemented. A variety of technologies exist to limit or, in some cases, eliminate the effects of DoS attacks (e.g., limiting processes or establishing memory partitions). Employing increased capacity and bandwidth, combined with service redundancy, may reduce the susceptibility to some DoS attacks.'\n  desc 'check', %q(Confirm Nutanix AOS protects against or limits the effects of DoS attacks by ensuring that a rate-limiting measures are enabled.\n\n$ /sbin/sysctl -a | grep 'net.ipv4.tcp_invalid_ratelimit'\nnet.ipv4.tcp_invalid_ratelimit = 500\n\nIf \"net.ipv4.tcp_invalid_ratelimit\" has a value of \"0\", this is a finding.\n\nIf \"net.ipv4.tcp_invalid_ratelimit\" has a value greater than \"1000\" and is not documented with the Information System Security Officer (ISSO), this is a finding.)\n  desc 'fix', 'Configure Nutanix AOS firewall services by running the following command:\n\n$ sudo salt-call state.sls security/CVM/iptables/init'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57712r846767_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254227'\n  tag rid: 'SV-254227r846769_rule'\n  tag stig_id: 'NUTX-OS-001500'\n  tag gtitle: 'SRG-OS-000420-GPOS-00186'\n  tag fix_id: 'F-57663r846768_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002385']\n  tag nist: ['SC-5 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254227.rb"},"title":"Nutanix AOS must protect against or limit the effects of denial-of-service (DoS) attacks by ensuring the operating system is implementing rate-limiting measures on impacted network interfaces.","desc":"DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nThis requirement addresses the configuration of the operating system to mitigate the impact of DoS attacks that have occurred or are ongoing on system availability. For each system, known and potential DoS attacks must be identified and solutions for each type implemented. A variety of technologies exist to limit or, in some cases, eliminate the effects of DoS attacks (e.g., limiting processes or establishing memory partitions). Employing increased capacity and bandwidth, combined with service redundancy, may reduce the susceptibility to some DoS attacks.","descriptions":{"default":"DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nThis requirement addresses the configuration of the operating system to mitigate the impact of DoS attacks that have occurred or are ongoing on system availability. For each system, known and potential DoS attacks must be identified and solutions for each type implemented. A variety of technologies exist to limit or, in some cases, eliminate the effects of DoS attacks (e.g., limiting processes or establishing memory partitions). Employing increased capacity and bandwidth, combined with service redundancy, may reduce the susceptibility to some DoS attacks.","check":"Confirm Nutanix AOS protects against or limits the effects of DoS attacks by ensuring that a rate-limiting measures are enabled.\n\n$ /sbin/sysctl -a | grep 'net.ipv4.tcp_invalid_ratelimit'\nnet.ipv4.tcp_invalid_ratelimit = 500\n\nIf \"net.ipv4.tcp_invalid_ratelimit\" has a value of \"0\", this is a finding.\n\nIf \"net.ipv4.tcp_invalid_ratelimit\" has a value greater than \"1000\" and is not documented with the Information System Security Officer (ISSO), this is a finding.","fix":"Configure Nutanix AOS firewall services by running the following command:\n\n$ sudo salt-call state.sls security/CVM/iptables/init"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57712r846767_chk","severity":"medium","gid":"V-254227","rid":"SV-254227r846769_rule","stig_id":"NUTX-OS-001500","gtitle":"SRG-OS-000420-GPOS-00186","fix_id":"F-57663r846768_fix","documentable":null,"cci":["CCI-002385"],"nist":["SC-5 a"]}},{"id":"SV-254228","code":"control 'SV-254228' do\n  title 'Nutanix AOS must be configured to use syncookies to limit denial-of-service (DoS) attacks.'\n  desc 'DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nManaging excess capacity ensures that sufficient capacity is available to counter flooding attacks. Employing increased capacity and service redundancy may reduce the susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning.'\n  desc 'check', %q(Confirm Nutanix AOS is configured to use syncookies.\n\n$ sysctl net.ipv4.tcp_syncookies \nnet.ipv4.tcp_syncookies = 1 \n\nIf the value is not \"1\", this is a finding. \n\nCheck the saved value of TCP syncookies with the following command: \n\n$ sudo grep -i net.ipv4.tcp_syncookies /etc/sysctl.conf /etc/sysctl.d/* | grep -v '#' \n\nIf no output is returned, this is a finding.)\n  desc 'fix', %q(Configure Nutanix AOS to use TCP syncookies by running the following command: \n\n$ sudo sysctl -w net.ipv4.tcp_syncookies=1 \n\nIf \"1\" is not the system's default value, add or update the following line in \"/etc/sysctl.conf\": \n\nnet.ipv4.tcp_syncookies = 1)\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57713r846770_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254228'\n  tag rid: 'SV-254228r846772_rule'\n  tag stig_id: 'NUTX-OS-001510'\n  tag gtitle: 'SRG-OS-000142-GPOS-00071'\n  tag fix_id: 'F-57664r846771_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001095']\n  tag nist: ['SC-5 (2)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254228.rb"},"title":"Nutanix AOS must be configured to use syncookies to limit denial-of-service (DoS) attacks.","desc":"DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nManaging excess capacity ensures that sufficient capacity is available to counter flooding attacks. Employing increased capacity and service redundancy may reduce the susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning.","descriptions":{"default":"DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nManaging excess capacity ensures that sufficient capacity is available to counter flooding attacks. Employing increased capacity and service redundancy may reduce the susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning.","check":"Confirm Nutanix AOS is configured to use syncookies.\n\n$ sysctl net.ipv4.tcp_syncookies \nnet.ipv4.tcp_syncookies = 1 \n\nIf the value is not \"1\", this is a finding. \n\nCheck the saved value of TCP syncookies with the following command: \n\n$ sudo grep -i net.ipv4.tcp_syncookies /etc/sysctl.conf /etc/sysctl.d/* | grep -v '#' \n\nIf no output is returned, this is a finding.","fix":"Configure Nutanix AOS to use TCP syncookies by running the following command: \n\n$ sudo sysctl -w net.ipv4.tcp_syncookies=1 \n\nIf \"1\" is not the system's default value, add or update the following line in \"/etc/sysctl.conf\": \n\nnet.ipv4.tcp_syncookies = 1"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57713r846770_chk","severity":"medium","gid":"V-254228","rid":"SV-254228r846772_rule","stig_id":"NUTX-OS-001510","gtitle":"SRG-OS-000142-GPOS-00071","fix_id":"F-57664r846771_fix","documentable":null,"cci":["CCI-001095"],"nist":["SC-5 (2)"]}},{"id":"SV-254229","code":"control 'SV-254229' do\n  title 'Nutanix AOS must protect the confidentiality and integrity of transmitted information.'\n  desc 'Without protection of the transmitted information, confidentiality and integrity may be compromised because unprotected communications can be intercepted and either read or altered.\n\nThis requirement applies to both internal and external networks and all types of information system components from which information can be transmitted (e.g., servers, mobile devices, notebook computers, printers, copiers, scanners, and facsimile machines). Communication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification.\n\nProtecting the confidentiality and integrity of organizational information can be accomplished by physical means (e.g., employing physical distribution systems) or by logical means (e.g., employing cryptographic techniques). If physical means of protection are employed, then logical means (cryptography) do not have to be employed, and vice versa.'\n  desc 'check', 'Confirm Nutanix AOS has SSH loaded and active.\n\n$ sudo systemctl status sshd\nsshd.service - OpenSSH server daemon\nLoaded: loaded (/usr/lib/systemd/system/sshd.service; enabled)\nActive: active (running) since Tue 2015-11-17 15:17:22 EST; 4 weeks 0 days ago\nMain PID: 1348 (sshd)\nCGroup: /system.slice/sshd.service\n1053 /usr/sbin/sshd -D\n\nIf \"sshd\" does not show a status of \"active\" and \"running\", this is a finding.\n\nIf the \"SSH server\" package is not installed, this is a finding.'\n  desc 'fix', 'Configure SSH on Nutanix AOS by running the following command:\n\n$ sudo salt-call state.sls security/CVM/sshdCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57714r846773_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254229'\n  tag rid: 'SV-254229r846775_rule'\n  tag stig_id: 'NUTX-OS-001520'\n  tag gtitle: 'SRG-OS-000423-GPOS-00187'\n  tag fix_id: 'F-57665r846774_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002418']\n  tag nist: ['SC-8']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254229.rb"},"title":"Nutanix AOS must protect the confidentiality and integrity of transmitted information.","desc":"Without protection of the transmitted information, confidentiality and integrity may be compromised because unprotected communications can be intercepted and either read or altered.\n\nThis requirement applies to both internal and external networks and all types of information system components from which information can be transmitted (e.g., servers, mobile devices, notebook computers, printers, copiers, scanners, and facsimile machines). Communication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification.\n\nProtecting the confidentiality and integrity of organizational information can be accomplished by physical means (e.g., employing physical distribution systems) or by logical means (e.g., employing cryptographic techniques). If physical means of protection are employed, then logical means (cryptography) do not have to be employed, and vice versa.","descriptions":{"default":"Without protection of the transmitted information, confidentiality and integrity may be compromised because unprotected communications can be intercepted and either read or altered.\n\nThis requirement applies to both internal and external networks and all types of information system components from which information can be transmitted (e.g., servers, mobile devices, notebook computers, printers, copiers, scanners, and facsimile machines). Communication paths outside the physical protection of a controlled boundary are exposed to the possibility of interception and modification.\n\nProtecting the confidentiality and integrity of organizational information can be accomplished by physical means (e.g., employing physical distribution systems) or by logical means (e.g., employing cryptographic techniques). If physical means of protection are employed, then logical means (cryptography) do not have to be employed, and vice versa.","check":"Confirm Nutanix AOS has SSH loaded and active.\n\n$ sudo systemctl status sshd\nsshd.service - OpenSSH server daemon\nLoaded: loaded (/usr/lib/systemd/system/sshd.service; enabled)\nActive: active (running) since Tue 2015-11-17 15:17:22 EST; 4 weeks 0 days ago\nMain PID: 1348 (sshd)\nCGroup: /system.slice/sshd.service\n1053 /usr/sbin/sshd -D\n\nIf \"sshd\" does not show a status of \"active\" and \"running\", this is a finding.\n\nIf the \"SSH server\" package is not installed, this is a finding.","fix":"Configure SSH on Nutanix AOS by running the following command:\n\n$ sudo salt-call state.sls security/CVM/sshdCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57714r846773_chk","severity":"medium","gid":"V-254229","rid":"SV-254229r846775_rule","stig_id":"NUTX-OS-001520","gtitle":"SRG-OS-000423-GPOS-00187","fix_id":"F-57665r846774_fix","documentable":null,"cci":["CCI-002418"],"nist":["SC-8"]}},{"id":"SV-254230","code":"control 'SV-254230' do\n  title 'Nutanix AOS must maintain the confidentiality and integrity of information during preparation for transmission.'\n  desc 'Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.\n\nEnsuring the confidentiality of transmitted information requires the operating system to take measures in preparing information for transmission. This can be accomplished via access control and encryption.\n\nUse of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process. When transmitting data, operating systems need to support transmission protection mechanisms such as TLS, SSL VPNs, or IPsec.'\n  desc 'check', 'Confirm Nutanix AOS has SSH loaded and active.\n\n$ sudo systemctl status sshd\nsshd.service - OpenSSH server daemon\nLoaded: loaded (/usr/lib/systemd/system/sshd.service; enabled)\nActive: active (running) since Tue 2015-11-17 15:17:22 EST; 4 weeks 0 days ago\nMain PID: 1348 (sshd)\nCGroup: /system.slice/sshd.service\n1053 /usr/sbin/sshd -D\n\nIf \"sshd\" does not show a status of \"active\" and \"running\", this is a finding.\n\nIf the \"SSH server\" package is not installed, this is a finding.'\n  desc 'fix', 'Configure SSH on Nutanix AOS by running the following command:\n\n$ sudo salt-call state.sls security/CVM/sshdCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57715r846776_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254230'\n  tag rid: 'SV-254230r846778_rule'\n  tag stig_id: 'NUTX-OS-001540'\n  tag gtitle: 'SRG-OS-000425-GPOS-00189'\n  tag fix_id: 'F-57666r846777_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002420']\n  tag nist: ['SC-8 (2)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254230.rb"},"title":"Nutanix AOS must maintain the confidentiality and integrity of information during preparation for transmission.","desc":"Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.\n\nEnsuring the confidentiality of transmitted information requires the operating system to take measures in preparing information for transmission. This can be accomplished via access control and encryption.\n\nUse of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process. When transmitting data, operating systems need to support transmission protection mechanisms such as TLS, SSL VPNs, or IPsec.","descriptions":{"default":"Information can be either unintentionally or maliciously disclosed or modified during preparation for transmission, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information.\n\nEnsuring the confidentiality of transmitted information requires the operating system to take measures in preparing information for transmission. This can be accomplished via access control and encryption.\n\nUse of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process. When transmitting data, operating systems need to support transmission protection mechanisms such as TLS, SSL VPNs, or IPsec.","check":"Confirm Nutanix AOS has SSH loaded and active.\n\n$ sudo systemctl status sshd\nsshd.service - OpenSSH server daemon\nLoaded: loaded (/usr/lib/systemd/system/sshd.service; enabled)\nActive: active (running) since Tue 2015-11-17 15:17:22 EST; 4 weeks 0 days ago\nMain PID: 1348 (sshd)\nCGroup: /system.slice/sshd.service\n1053 /usr/sbin/sshd -D\n\nIf \"sshd\" does not show a status of \"active\" and \"running\", this is a finding.\n\nIf the \"SSH server\" package is not installed, this is a finding.","fix":"Configure SSH on Nutanix AOS by running the following command:\n\n$ sudo salt-call state.sls security/CVM/sshdCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57715r846776_chk","severity":"medium","gid":"V-254230","rid":"SV-254230r846778_rule","stig_id":"NUTX-OS-001540","gtitle":"SRG-OS-000425-GPOS-00189","fix_id":"F-57666r846777_fix","documentable":null,"cci":["CCI-002420"],"nist":["SC-8 (2)"]}},{"id":"SV-254231","code":"control 'SV-254231' do\n  title 'Nutanix AOS must maintain the confidentiality and integrity of information during reception.'\n  desc 'Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information. Ensuring the confidentiality of transmitted information requires the operating system to take measures in preparing information for transmission. This can be accomplished via access control and encryption. Use of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process. When receiving data, operating systems need to leverage protection mechanisms such as TLS, SSL VPNs, or IPsec.'\n  desc 'check', 'Confirm Nutanix AOS has SSH loaded and active.\n\n$ sudo systemctl status sshd\nsshd.service - OpenSSH server daemon\nLoaded: loaded (/usr/lib/systemd/system/sshd.service; enabled)\nActive: active (running) since Tue 2015-11-17 15:17:22 EST; 4 weeks 0 days ago\nMain PID: 1348 (sshd)\nCGroup: /system.slice/sshd.service\n1053 /usr/sbin/sshd -D\n\nIf \"sshd\" does not show a status of \"active\" and \"running\", this is a finding.\n\nIf the \"SSH server\" package is not installed, this is a finding.'\n  desc 'fix', 'Configure SSH on Nutanix AOS by running the following command:\n\n$ sudo salt-call state.sls security/CVM/sshdCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57716r846779_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254231'\n  tag rid: 'SV-254231r846781_rule'\n  tag stig_id: 'NUTX-OS-001550'\n  tag gtitle: 'SRG-OS-000426-GPOS-00190'\n  tag fix_id: 'F-57667r846780_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002422']\n  tag nist: ['SC-8 (2)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254231.rb"},"title":"Nutanix AOS must maintain the confidentiality and integrity of information during reception.","desc":"Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information. Ensuring the confidentiality of transmitted information requires the operating system to take measures in preparing information for transmission. This can be accomplished via access control and encryption. Use of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process. When receiving data, operating systems need to leverage protection mechanisms such as TLS, SSL VPNs, or IPsec.","descriptions":{"default":"Information can be either unintentionally or maliciously disclosed or modified during reception, including, for example, during aggregation, at protocol transformation points, and during packing/unpacking. These unauthorized disclosures or modifications compromise the confidentiality or integrity of the information. Ensuring the confidentiality of transmitted information requires the operating system to take measures in preparing information for transmission. This can be accomplished via access control and encryption. Use of this requirement will be limited to situations where the data owner has a strict requirement for ensuring data integrity and confidentiality is maintained at every step of the data transfer and handling process. When receiving data, operating systems need to leverage protection mechanisms such as TLS, SSL VPNs, or IPsec.","check":"Confirm Nutanix AOS has SSH loaded and active.\n\n$ sudo systemctl status sshd\nsshd.service - OpenSSH server daemon\nLoaded: loaded (/usr/lib/systemd/system/sshd.service; enabled)\nActive: active (running) since Tue 2015-11-17 15:17:22 EST; 4 weeks 0 days ago\nMain PID: 1348 (sshd)\nCGroup: /system.slice/sshd.service\n1053 /usr/sbin/sshd -D\n\nIf \"sshd\" does not show a status of \"active\" and \"running\", this is a finding.\n\nIf the \"SSH server\" package is not installed, this is a finding.","fix":"Configure SSH on Nutanix AOS by running the following command:\n\n$ sudo salt-call state.sls security/CVM/sshdCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57716r846779_chk","severity":"medium","gid":"V-254231","rid":"SV-254231r846781_rule","stig_id":"NUTX-OS-001550","gtitle":"SRG-OS-000426-GPOS-00190","fix_id":"F-57667r846780_fix","documentable":null,"cci":["CCI-002422"],"nist":["SC-8 (2)"]}},{"id":"SV-254232","code":"control 'SV-254232' do\n  title 'Nutanix AOS must generate error messages that provide information necessary for corrective actions without revealing information that could be exploited by adversaries.'\n  desc 'Any operating system providing too much information in error messages risks compromising the data and security of the structure, and content of error messages needs to be carefully considered by the organization.\n\nOrganizations carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, erroneous logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers.'\n  desc 'check', 'Verify Nutanix AOS has all system log files under the /home/log directory with a permission set to \"640\", by using the following command:\n\n$ sudo find /home/log -perm /137 -type f -exec stat -c \"%n %a\" {} \\\\;\n\nIf command displays any output, this is a finding.'\n  desc 'fix', %q(Configure the Nutanix AOS to set permissions of all log files under /home/log directory to \"640\" or more restricted, by using the following command:\n\n$ sudo find /var/log -perm /137 -type f -exec chmod 640 '{}' \\;)\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57717r846782_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254232'\n  tag rid: 'SV-254232r846784_rule'\n  tag stig_id: 'NUTX-OS-001560'\n  tag gtitle: 'SRG-OS-000205-GPOS-00083'\n  tag fix_id: 'F-57668r846783_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254232.rb"},"title":"Nutanix AOS must generate error messages that provide information necessary for corrective actions without revealing information that could be exploited by adversaries.","desc":"Any operating system providing too much information in error messages risks compromising the data and security of the structure, and content of error messages needs to be carefully considered by the organization.\n\nOrganizations carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, erroneous logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers.","descriptions":{"default":"Any operating system providing too much information in error messages risks compromising the data and security of the structure, and content of error messages needs to be carefully considered by the organization.\n\nOrganizations carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, erroneous logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers.","check":"Verify Nutanix AOS has all system log files under the /home/log directory with a permission set to \"640\", by using the following command:\n\n$ sudo find /home/log -perm /137 -type f -exec stat -c \"%n %a\" {} \\;\n\nIf command displays any output, this is a finding.","fix":"Configure the Nutanix AOS to set permissions of all log files under /home/log directory to \"640\" or more restricted, by using the following command:\n\n$ sudo find /var/log -perm /137 -type f -exec chmod 640 '{}' \\;"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57717r846782_chk","severity":"medium","gid":"V-254232","rid":"SV-254232r846784_rule","stig_id":"NUTX-OS-001560","gtitle":"SRG-OS-000205-GPOS-00083","fix_id":"F-57668r846783_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-254233","code":"control 'SV-254233' do\n  title 'Nutanix AOS must reveal error messages only to authorized users.'\n  desc \"Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.\n\nThe structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.\"\n  desc 'check', 'Nutanix AOS audit logs must be owned by root to prevent unauthorized read access.\n\nDetermine where the audit log file is located:\n$sudo grep -iw log_file /etc/audit/auditd.conf\nlog_file = /home/log/audit/audit.log\n\nUsing the location of the audit log file, determine if the audit log is owned by \"root\" using the following command:\nls -al /home/log/audit/audit.log\n-rw-------. 1 root root 3427758 Apr  8 18:43 /home/log/audit/audit.log\n\nIf the audit log is not owned by \"root\", this is a finding.'\n  desc 'fix', 'Configure the audit rules ownership by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57718r846785_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254233'\n  tag rid: 'SV-254233r846787_rule'\n  tag stig_id: 'NUTX-OS-001570'\n  tag gtitle: 'SRG-OS-000206-GPOS-00084'\n  tag fix_id: 'F-57669r846786_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001314']\n  tag nist: ['SI-11 b']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254233.rb"},"title":"Nutanix AOS must reveal error messages only to authorized users.","desc":"Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.\n\nThe structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.","descriptions":{"default":"Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.\n\nThe structure and content of error messages must be carefully considered by the organization and development team. The extent to which the information system is able to identify and handle error conditions is guided by organizational policy and operational requirements.","check":"Nutanix AOS audit logs must be owned by root to prevent unauthorized read access.\n\nDetermine where the audit log file is located:\n$sudo grep -iw log_file /etc/audit/auditd.conf\nlog_file = /home/log/audit/audit.log\n\nUsing the location of the audit log file, determine if the audit log is owned by \"root\" using the following command:\nls -al /home/log/audit/audit.log\n-rw-------. 1 root root 3427758 Apr  8 18:43 /home/log/audit/audit.log\n\nIf the audit log is not owned by \"root\", this is a finding.","fix":"Configure the audit rules ownership by running the following command:\n\n$ sudo salt-call state.sls security/CVM/auditCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57718r846785_chk","severity":"medium","gid":"V-254233","rid":"SV-254233r846787_rule","stig_id":"NUTX-OS-001570","gtitle":"SRG-OS-000206-GPOS-00084","fix_id":"F-57669r846786_fix","documentable":null,"cci":["CCI-001314"],"nist":["SI-11 b"]}},{"id":"SV-254234","code":"control 'SV-254234' do\n  title 'Nutanix AOS must implement nonexecutable data to protect its memory from unauthorized code execution.'\n  desc 'Some adversaries launch attacks with the intent of executing code in nonexecutable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can either be hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.\n\nExamples of attacks are buffer overflow attacks.'\n  desc 'check', 'Nutanix AOS is configured to implement nonexecutable data to protect its memory from unauthorized code execution.\n\n$ sudo grep flags /proc/cpuinfo | grep -w nx\nflags.       : fpu vme de . nx pdpe1gb rdtscp...\n\nIf \"flags\" does not contain the \"nx\" flag, this is a finding.'\n  desc 'fix', %q(If Nutanix AOS does not list 'nx' flag in the /proc/cpuinfo and the system's BIOS setup configuration permits toggling the No Execution bit, then set it to \"enable\".)\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57719r846788_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254234'\n  tag rid: 'SV-254234r846790_rule'\n  tag stig_id: 'NUTX-OS-001580'\n  tag gtitle: 'SRG-OS-000433-GPOS-00192'\n  tag fix_id: 'F-57670r846789_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002824']\n  tag nist: ['SI-16']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254234.rb"},"title":"Nutanix AOS must implement nonexecutable data to protect its memory from unauthorized code execution.","desc":"Some adversaries launch attacks with the intent of executing code in nonexecutable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can either be hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.\n\nExamples of attacks are buffer overflow attacks.","descriptions":{"default":"Some adversaries launch attacks with the intent of executing code in nonexecutable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can either be hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.\n\nExamples of attacks are buffer overflow attacks.","check":"Nutanix AOS is configured to implement nonexecutable data to protect its memory from unauthorized code execution.\n\n$ sudo grep flags /proc/cpuinfo | grep -w nx\nflags.       : fpu vme de . nx pdpe1gb rdtscp...\n\nIf \"flags\" does not contain the \"nx\" flag, this is a finding.","fix":"If Nutanix AOS does not list 'nx' flag in the /proc/cpuinfo and the system's BIOS setup configuration permits toggling the No Execution bit, then set it to \"enable\"."},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57719r846788_chk","severity":"medium","gid":"V-254234","rid":"SV-254234r846790_rule","stig_id":"NUTX-OS-001580","gtitle":"SRG-OS-000433-GPOS-00192","fix_id":"F-57670r846789_fix","documentable":null,"cci":["CCI-002824"],"nist":["SI-16"]}},{"id":"SV-254235","code":"control 'SV-254235' do\n  title 'Nutanix AOS must implement address space layout randomization to protect its memory from unauthorized code execution.'\n  desc 'Some adversaries launch attacks with the intent of executing code in nonexecutable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can either be hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.\n\nExamples of attacks are buffer overflow attacks.'\n  desc 'check', 'Confirm Nutanix AOS is configured to implement address space layout randomization.\n\n$ sudo sysctl kernel.randomize_va_space\nkernel.randomize_va_space = 2\n\nIf the value of kernel.randomize_va_space is anything other than \"2\", this is a finding.'\n  desc 'fix', 'Configure Nutanix AOS to implement address space layout randomization by running the following command:\n\n$ sudo sysctl kernel.randomize_va_space=2'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57720r846791_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254235'\n  tag rid: 'SV-254235r846793_rule'\n  tag stig_id: 'NUTX-OS-001590'\n  tag gtitle: 'SRG-OS-000433-GPOS-00193'\n  tag fix_id: 'F-57671r846792_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002824']\n  tag nist: ['SI-16']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254235.rb"},"title":"Nutanix AOS must implement address space layout randomization to protect its memory from unauthorized code execution.","desc":"Some adversaries launch attacks with the intent of executing code in nonexecutable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can either be hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.\n\nExamples of attacks are buffer overflow attacks.","descriptions":{"default":"Some adversaries launch attacks with the intent of executing code in nonexecutable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can either be hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.\n\nExamples of attacks are buffer overflow attacks.","check":"Confirm Nutanix AOS is configured to implement address space layout randomization.\n\n$ sudo sysctl kernel.randomize_va_space\nkernel.randomize_va_space = 2\n\nIf the value of kernel.randomize_va_space is anything other than \"2\", this is a finding.","fix":"Configure Nutanix AOS to implement address space layout randomization by running the following command:\n\n$ sudo sysctl kernel.randomize_va_space=2"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57720r846791_chk","severity":"medium","gid":"V-254235","rid":"SV-254235r846793_rule","stig_id":"NUTX-OS-001590","gtitle":"SRG-OS-000433-GPOS-00193","fix_id":"F-57671r846792_fix","documentable":null,"cci":["CCI-002824"],"nist":["SI-16"]}},{"id":"SV-254236","code":"control 'SV-254236' do\n  title 'Nutanix AOS must remove all software components after updated versions have been installed.'\n  desc 'Previous versions of software components that are not removed from the information system after updates have been installed may be exploited by adversaries. Some information technology products may remove older versions of software automatically from the information system.'\n  desc 'check', 'Confirm Nutanix AOS removes all software components after updated versions have been installed.\n\n$ sudo grep -i clean_requirements_on_remove /etc/yum.conf\nclean_requirements_on_remove=1\n\nIf \"clean_requirements_on_remove\" is not set to \"1\", \"True\", or \"yes\", or is not set in \"/etc/yum.conf\", this is a finding.'\n  desc 'fix', 'Configure Yum settings to remove all software components after an updated version is installed by running the following command:\n\n$ sudo salt-call state.sls security/CVM/yumCVM'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57721r846794_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254236'\n  tag rid: 'SV-254236r846796_rule'\n  tag stig_id: 'NUTX-OS-001600'\n  tag gtitle: 'SRG-OS-000437-GPOS-00194'\n  tag fix_id: 'F-57672r846795_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002617']\n  tag nist: ['SI-2 (6)']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254236.rb"},"title":"Nutanix AOS must remove all software components after updated versions have been installed.","desc":"Previous versions of software components that are not removed from the information system after updates have been installed may be exploited by adversaries. Some information technology products may remove older versions of software automatically from the information system.","descriptions":{"default":"Previous versions of software components that are not removed from the information system after updates have been installed may be exploited by adversaries. Some information technology products may remove older versions of software automatically from the information system.","check":"Confirm Nutanix AOS removes all software components after updated versions have been installed.\n\n$ sudo grep -i clean_requirements_on_remove /etc/yum.conf\nclean_requirements_on_remove=1\n\nIf \"clean_requirements_on_remove\" is not set to \"1\", \"True\", or \"yes\", or is not set in \"/etc/yum.conf\", this is a finding.","fix":"Configure Yum settings to remove all software components after an updated version is installed by running the following command:\n\n$ sudo salt-call state.sls security/CVM/yumCVM"},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57721r846794_chk","severity":"medium","gid":"V-254236","rid":"SV-254236r846796_rule","stig_id":"NUTX-OS-001600","gtitle":"SRG-OS-000437-GPOS-00194","fix_id":"F-57672r846795_fix","documentable":null,"cci":["CCI-002617"],"nist":["SI-2 (6)"]}},{"id":"SV-254237","code":"control 'SV-254237' do\n  title 'Nutanix AOS must be configured to use SELinux Enforcing mode.'\n  desc 'Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.\n\nThis requirement applies to operating systems performing security function verification/testing and/or systems and environments that require this functionality.\n\n'\n  desc 'check', %q(Confirm Nutanix AOS verifies correct operation of all security functions.\n\n$ sudo sestatus\nSELinux status:                 enabled\nSELinuxfs mount:                /sys/fs/selinux\nSELinux root directory:         /etc/selinux\nLoaded policy name:             targeted\nCurrent mode:                   enforcing\nMode from config file:          enforcing\nPolicy MLS status:              enabled\nPolicy deny_unknown status:     allowed\nMax kernel policy version:      31\n\nIf the \"Loaded policy name\" is not set to \"targeted\", this is a finding.\n\nVerify that the /etc/selinux/config file is configured to the \"SELINUXTYPE\" to \"targeted\":\n\n$ sudo grep -i \"selinuxtype\" /etc/selinux/config | grep -v '^#'\nSELINUXTYPE = targeted\n\nIf no results are returned or \"SELINUXTYPE\" is not set to \"targeted\", this is a finding.)\n  desc 'fix', 'Configure Nutanix AOS to verify correct operation of all security functions.\n\nSet the \"SELinux\" status and the \"Enforcing\" mode by modifying the \"/etc/selinux/config\" file to have the following line:\n\nSELINUX=enforcing\n\nA reboot is required for the changes to take effect.'\n  impact 0.5\n  ref 'DPMS Target Nutanix AOS 5.20.x OS'\n  tag check_id: 'C-57722r846797_chk'\n  tag severity: 'medium'\n  tag gid: 'V-254237'\n  tag rid: 'SV-254237r846799_rule'\n  tag stig_id: 'NUTX-OS-001610'\n  tag gtitle: 'SRG-OS-000445-GPOS-00199'\n  tag fix_id: 'F-57673r846798_fix'\n  tag satisfies: ['SRG-OS-000445-GPOS-00199', 'SRG-OS-000446-GPOS-00200', 'SRG-OS-000447-GPOS-00201', 'SRG-OS-000134-GPOS-00068']\n  tag 'documentable'\n  tag cci: ['CCI-001084', 'CCI-002696', 'CCI-002699', 'CCI-002702']\n  tag nist: ['SC-3', 'SI-6 a', 'SI-6 b', 'SI-6 d']\nend","source_location":{"line":1,"ref":"U_Nutanix_AOS_5-20-x_OS_STIG_V1R1/controls/SV-254237.rb"},"title":"Nutanix AOS must be configured to use SELinux Enforcing mode.","desc":"Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.\n\nThis requirement applies to operating systems performing security function verification/testing and/or systems and environments that require this functionality.\n\n","descriptions":{"default":"Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.\n\nThis requirement applies to operating systems performing security function verification/testing and/or systems and environments that require this functionality.\n\n","check":"Confirm Nutanix AOS verifies correct operation of all security functions.\n\n$ sudo sestatus\nSELinux status:                 enabled\nSELinuxfs mount:                /sys/fs/selinux\nSELinux root directory:         /etc/selinux\nLoaded policy name:             targeted\nCurrent mode:                   enforcing\nMode from config file:          enforcing\nPolicy MLS status:              enabled\nPolicy deny_unknown status:     allowed\nMax kernel policy version:      31\n\nIf the \"Loaded policy name\" is not set to \"targeted\", this is a finding.\n\nVerify that the /etc/selinux/config file is configured to the \"SELINUXTYPE\" to \"targeted\":\n\n$ sudo grep -i \"selinuxtype\" /etc/selinux/config | grep -v '^#'\nSELINUXTYPE = targeted\n\nIf no results are returned or \"SELINUXTYPE\" is not set to \"targeted\", this is a finding.","fix":"Configure Nutanix AOS to verify correct operation of all security functions.\n\nSet the \"SELinux\" status and the \"Enforcing\" mode by modifying the \"/etc/selinux/config\" file to have the following line:\n\nSELINUX=enforcing\n\nA reboot is required for the changes to take effect."},"impact":0.5,"refs":[{"ref":"DPMS Target Nutanix AOS 5.20.x OS"}],"tags":{"check_id":"C-57722r846797_chk","severity":"medium","gid":"V-254237","rid":"SV-254237r846799_rule","stig_id":"NUTX-OS-001610","gtitle":"SRG-OS-000445-GPOS-00199","fix_id":"F-57673r846798_fix","satisfies":["SRG-OS-000445-GPOS-00199","SRG-OS-000446-GPOS-00200","SRG-OS-000447-GPOS-00201","SRG-OS-000134-GPOS-00068"],"documentable":null,"cci":["CCI-001084","CCI-002696","CCI-002699","CCI-002702"],"nist":["SC-3","SI-6 a","SI-6 b","SI-6 d"]}}],"groups":[{"id":"controls/SV-254120.rb","title":null,"controls":["SV-254120"]},{"id":"controls/SV-254121.rb","title":null,"controls":["SV-254121"]},{"id":"controls/SV-254122.rb","title":null,"controls":["SV-254122"]},{"id":"controls/SV-254123.rb","title":null,"controls":["SV-254123"]},{"id":"controls/SV-254124.rb","title":null,"controls":["SV-254124"]},{"id":"controls/SV-254125.rb","title":null,"controls":["SV-254125"]},{"id":"controls/SV-254126.rb","title":null,"controls":["SV-254126"]},{"id":"controls/SV-254127.rb","title":null,"controls":["SV-254127"]},{"id":"controls/SV-254128.rb","title":null,"controls":["SV-254128"]},{"id":"controls/SV-254129.rb","title":null,"controls":["SV-254129"]},{"id":"controls/SV-254130.rb","title":null,"controls":["SV-254130"]},{"id":"controls/SV-254131.rb","title":null,"controls":["SV-254131"]},{"id":"controls/SV-254132.rb","title":null,"controls":["SV-254132"]},{"id":"controls/SV-254133.rb","title":null,"controls":["SV-254133"]},{"id":"controls/SV-254134.rb","title":null,"controls":["SV-254134"]},{"id":"controls/SV-254135.rb","title":null,"controls":["SV-254135"]},{"id":"controls/SV-254136.rb","title":null,"controls":["SV-254136"]},{"id":"controls/SV-254137.rb","title":null,"controls":["SV-254137"]},{"id":"controls/SV-254138.rb","title":null,"controls":["SV-254138"]},{"id":"controls/SV-254139.rb","title":null,"controls":["SV-254139"]},{"id":"controls/SV-254140.rb","title":null,"controls":["SV-254140"]},{"id":"controls/SV-254141.rb","title":null,"controls":["SV-254141"]},{"id":"controls/SV-254142.rb","title":null,"controls":["SV-254142"]},{"id":"controls/SV-254143.rb","title":null,"controls":["SV-254143"]},{"id":"controls/SV-254144.rb","title":null,"controls":["SV-254144"]},{"id":"controls/SV-254145.rb","title":null,"controls":["SV-254145"]},{"id":"controls/SV-254146.rb","title":null,"controls":["SV-254146"]},{"id":"controls/SV-254147.rb","title":null,"controls":["SV-254147"]},{"id":"controls/SV-254148.rb","title":null,"controls":["SV-254148"]},{"id":"controls/SV-254149.rb","title":null,"controls":["SV-254149"]},{"id":"controls/SV-254150.rb","title":null,"controls":["SV-254150"]},{"id":"controls/SV-254151.rb","title":null,"controls":["SV-254151"]},{"id":"controls/SV-254152.rb","title":null,"controls":["SV-254152"]},{"id":"controls/SV-254153.rb","title":null,"controls":["SV-254153"]},{"id":"controls/SV-254154.rb","title":null,"controls":["SV-254154"]},{"id":"controls/SV-254155.rb","title":null,"controls":["SV-254155"]},{"id":"controls/SV-254156.rb","title":null,"controls":["SV-254156"]},{"id":"controls/SV-254157.rb","title":null,"controls":["SV-254157"]},{"id":"controls/SV-254158.rb","title":null,"controls":["SV-254158"]},{"id":"controls/SV-254159.rb","title":null,"controls":["SV-254159"]},{"id":"controls/SV-254160.rb","title":null,"controls":["SV-254160"]},{"id":"controls/SV-254161.rb","title":null,"controls":["SV-254161"]},{"id":"controls/SV-254162.rb","title":null,"controls":["SV-254162"]},{"id":"controls/SV-254163.rb","title":null,"controls":["SV-254163"]},{"id":"controls/SV-254164.rb","title":null,"controls":["SV-254164"]},{"id":"controls/SV-254165.rb","title":null,"controls":["SV-254165"]},{"id":"controls/SV-254166.rb","title":null,"controls":["SV-254166"]},{"id":"controls/SV-254167.rb","title":null,"controls":["SV-254167"]},{"id":"controls/SV-254168.rb","title":null,"controls":["SV-254168"]},{"id":"controls/SV-254169.rb","title":null,"controls":["SV-254169"]},{"id":"controls/SV-254170.rb","title":null,"controls":["SV-254170"]},{"id":"controls/SV-254171.rb","title":null,"controls":["SV-254171"]},{"id":"controls/SV-254172.rb","title":null,"controls":["SV-254172"]},{"id":"controls/SV-254173.rb","title":null,"controls":["SV-254173"]},{"id":"controls/SV-254174.rb","title":null,"controls":["SV-254174"]},{"id":"controls/SV-254175.rb","title":null,"controls":["SV-254175"]},{"id":"controls/SV-254176.rb","title":null,"controls":["SV-254176"]},{"id":"controls/SV-254177.rb","title":null,"controls":["SV-254177"]},{"id":"controls/SV-254178.rb","title":null,"controls":["SV-254178"]},{"id":"controls/SV-254179.rb","title":null,"controls":["SV-254179"]},{"id":"controls/SV-254180.rb","title":null,"controls":["SV-254180"]},{"id":"controls/SV-254181.rb","title":null,"controls":["SV-254181"]},{"id":"controls/SV-254182.rb","title":null,"controls":["SV-254182"]},{"id":"controls/SV-254183.rb","title":null,"controls":["SV-254183"]},{"id":"controls/SV-254184.rb","title":null,"controls":["SV-254184"]},{"id":"controls/SV-254185.rb","title":null,"controls":["SV-254185"]},{"id":"controls/SV-254186.rb","title":null,"controls":["SV-254186"]},{"id":"controls/SV-254187.rb","title":null,"controls":["SV-254187"]},{"id":"controls/SV-254188.rb","title":null,"controls":["SV-254188"]},{"id":"controls/SV-254189.rb","title":null,"controls":["SV-254189"]},{"id":"controls/SV-254190.rb","title":null,"controls":["SV-254190"]},{"id":"controls/SV-254191.rb","title":null,"controls":["SV-254191"]},{"id":"controls/SV-254192.rb","title":null,"controls":["SV-254192"]},{"id":"controls/SV-254193.rb","title":null,"controls":["SV-254193"]},{"id":"controls/SV-254194.rb","title":null,"controls":["SV-254194"]},{"id":"controls/SV-254195.rb","title":null,"controls":["SV-254195"]},{"id":"controls/SV-254196.rb","title":null,"controls":["SV-254196"]},{"id":"controls/SV-254197.rb","title":null,"controls":["SV-254197"]},{"id":"controls/SV-254198.rb","title":null,"controls":["SV-254198"]},{"id":"controls/SV-254199.rb","title":null,"controls":["SV-254199"]},{"id":"controls/SV-254200.rb","title":null,"controls":["SV-254200"]},{"id":"controls/SV-254201.rb","title":null,"controls":["SV-254201"]},{"id":"controls/SV-254202.rb","title":null,"controls":["SV-254202"]},{"id":"controls/SV-254203.rb","title":null,"controls":["SV-254203"]},{"id":"controls/SV-254204.rb","title":null,"controls":["SV-254204"]},{"id":"controls/SV-254205.rb","title":null,"controls":["SV-254205"]},{"id":"controls/SV-254206.rb","title":null,"controls":["SV-254206"]},{"id":"controls/SV-254207.rb","title":null,"controls":["SV-254207"]},{"id":"controls/SV-254208.rb","title":null,"controls":["SV-254208"]},{"id":"controls/SV-254209.rb","title":null,"controls":["SV-254209"]},{"id":"controls/SV-254210.rb","title":null,"controls":["SV-254210"]},{"id":"controls/SV-254211.rb","title":null,"controls":["SV-254211"]},{"id":"controls/SV-254212.rb","title":null,"controls":["SV-254212"]},{"id":"controls/SV-254213.rb","title":null,"controls":["SV-254213"]},{"id":"controls/SV-254214.rb","title":null,"controls":["SV-254214"]},{"id":"controls/SV-254215.rb","title":null,"controls":["SV-254215"]},{"id":"controls/SV-254216.rb","title":null,"controls":["SV-254216"]},{"id":"controls/SV-254217.rb","title":null,"controls":["SV-254217"]},{"id":"controls/SV-254218.rb","title":null,"controls":["SV-254218"]},{"id":"controls/SV-254219.rb","title":null,"controls":["SV-254219"]},{"id":"controls/SV-254220.rb","title":null,"controls":["SV-254220"]},{"id":"controls/SV-254221.rb","title":null,"controls":["SV-254221"]},{"id":"controls/SV-254222.rb","title":null,"controls":["SV-254222"]},{"id":"controls/SV-254223.rb","title":null,"controls":["SV-254223"]},{"id":"controls/SV-254224.rb","title":null,"controls":["SV-254224"]},{"id":"controls/SV-254225.rb","title":null,"controls":["SV-254225"]},{"id":"controls/SV-254226.rb","title":null,"controls":["SV-254226"]},{"id":"controls/SV-254227.rb","title":null,"controls":["SV-254227"]},{"id":"controls/SV-254228.rb","title":null,"controls":["SV-254228"]},{"id":"controls/SV-254229.rb","title":null,"controls":["SV-254229"]},{"id":"controls/SV-254230.rb","title":null,"controls":["SV-254230"]},{"id":"controls/SV-254231.rb","title":null,"controls":["SV-254231"]},{"id":"controls/SV-254232.rb","title":null,"controls":["SV-254232"]},{"id":"controls/SV-254233.rb","title":null,"controls":["SV-254233"]},{"id":"controls/SV-254234.rb","title":null,"controls":["SV-254234"]},{"id":"controls/SV-254235.rb","title":null,"controls":["SV-254235"]},{"id":"controls/SV-254236.rb","title":null,"controls":["SV-254236"]},{"id":"controls/SV-254237.rb","title":null,"controls":["SV-254237"]}],"name":"Nutanix_AOS_5-20-x_OS_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"ab0a93c6abdc5e2dc966664c70e65227441259c574d805fa2e7f1f92d1878ab8","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
