{"controls":[{"id":"SV-258801","code":"control 'SV-258801' do\n  title 'The Photon operating system must audit all account creations.'\n  desc 'Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.\n\n'\n  desc 'check', 'At the command line, run the following command to verify an audit rule exists to audit account creations:\n\n# auditctl -l | grep -E \"(useradd|groupadd)\"\n\nExample result:\n\n-w /usr/sbin/useradd -p x -k useradd\n-w /usr/sbin/groupadd -p x -k groupadd\n\nIf either \"useradd\" or \"groupadd\" are not listed with a permissions filter of at least \"x\", this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /usr/sbin/useradd -p x -k useradd\n-w /usr/sbin/groupadd -p x -k groupadd\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62541r933462_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258801'\n  tag rid: 'SV-258801r933464_rule'\n  tag stig_id: 'PHTN-40-000003'\n  tag gtitle: 'SRG-OS-000004-GPOS-00004'\n  tag fix_id: 'F-62450r933463_fix'\n  tag satisfies: ['SRG-OS-000004-GPOS-00004', 'SRG-OS-000476-GPOS-00221']\n  tag 'documentable'\n  tag cci: ['CCI-000018', 'CCI-000172']\n  tag nist: ['AC-2 (4)', 'AU-12 c']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258801.rb"},"title":"The Photon operating system must audit all account creations.","desc":"Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.\n\n","descriptions":{"default":"Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to create an account. Auditing account creation actions provides logging that can be used for forensic purposes.\n\n","check":"At the command line, run the following command to verify an audit rule exists to audit account creations:\n\n# auditctl -l | grep -E \"(useradd|groupadd)\"\n\nExample result:\n\n-w /usr/sbin/useradd -p x -k useradd\n-w /usr/sbin/groupadd -p x -k groupadd\n\nIf either \"useradd\" or \"groupadd\" are not listed with a permissions filter of at least \"x\", this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.","fix":"Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /usr/sbin/useradd -p x -k useradd\n-w /usr/sbin/groupadd -p x -k groupadd\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62541r933462_chk","severity":"medium","gid":"V-258801","rid":"SV-258801r933464_rule","stig_id":"PHTN-40-000003","gtitle":"SRG-OS-000004-GPOS-00004","fix_id":"F-62450r933463_fix","satisfies":["SRG-OS-000004-GPOS-00004","SRG-OS-000476-GPOS-00221"],"documentable":null,"cci":["CCI-000018","CCI-000172"],"nist":["AC-2 (4)","AU-12 c"]}},{"id":"SV-258802","code":"control 'SV-258802' do\n  title 'The Photon operating system must enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period.'\n  desc 'By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.'\n  desc 'check', %q(At the command line, run the following commands to verify accounts are locked after three consecutive invalid logon attempts by a user during a 15-minute time period:\n\n# grep '^deny =' /etc/security/faillock.conf\n\nExample result:\n\ndeny = 3\n\nIf the \"deny\" option is not set to \"3\" or less (but not \"0\"), is missing or commented out, this is a finding.\n\n# grep '^fail_interval =' /etc/security/faillock.conf\n\nExample result:\n\nfail_interval = 900\n\nIf the \"fail_interval\" option is not set to \"900\" or more, is missing or commented out, this is a finding.\n\nNote: If faillock.conf is not used to configure the \"pam_faillock.so\" module, then these options may be specified on the faillock lines in the system-auth and system-account PAM files.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\ndeny = 3\nfail_interval = 900\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62542r933465_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258802'\n  tag rid: 'SV-258802r933467_rule'\n  tag stig_id: 'PHTN-40-000004'\n  tag gtitle: 'SRG-OS-000021-GPOS-00005'\n  tag fix_id: 'F-62451r933466_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000044']\n  tag nist: ['AC-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258802.rb"},"title":"The Photon operating system must enforce the limit of three consecutive invalid logon attempts by a user during a 15-minute time period.","desc":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.","descriptions":{"default":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.","check":"At the command line, run the following commands to verify accounts are locked after three consecutive invalid logon attempts by a user during a 15-minute time period:\n\n# grep '^deny =' /etc/security/faillock.conf\n\nExample result:\n\ndeny = 3\n\nIf the \"deny\" option is not set to \"3\" or less (but not \"0\"), is missing or commented out, this is a finding.\n\n# grep '^fail_interval =' /etc/security/faillock.conf\n\nExample result:\n\nfail_interval = 900\n\nIf the \"fail_interval\" option is not set to \"900\" or more, is missing or commented out, this is a finding.\n\nNote: If faillock.conf is not used to configure the \"pam_faillock.so\" module, then these options may be specified on the faillock lines in the system-auth and system-account PAM files.","fix":"Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\ndeny = 3\nfail_interval = 900\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62542r933465_chk","severity":"medium","gid":"V-258802","rid":"SV-258802r933467_rule","stig_id":"PHTN-40-000004","gtitle":"SRG-OS-000021-GPOS-00005","fix_id":"F-62451r933466_fix","documentable":null,"cci":["CCI-000044"],"nist":["AC-7 a"]}},{"id":"SV-258803","code":"control 'SV-258803' do\n  title 'The Photon operating system must display the Standard Mandatory DOD Notice and Consent Banner before granting local or remote access to the system.'\n  desc %q(Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with applicable DOD policy. Use the following verbiage for operating systems that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read & consent to terms in IS user agreem't.\"\n\n)\n  desc 'check', 'At the command line, run the following command to verify SSH is configured to use the /etc/issue file for a banner:\n\n# sshd -T|&grep -i Banner\n\nExample result:\n\nbanner /etc/issue\n\nIf the \"banner\" setting is not configured to \"/etc/issue\", this is a finding. \n\nNext, open /etc/issue with a text editor.\n\nIf the file does not contain the Standard Mandatory DOD Notice and Consent Banner, this is a finding.\n\nStandard Mandatory DOD Notice and Consent Banner:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"Banner\" line is uncommented and set to the following:\n\nBanner /etc/issue\n\nNavigate to and open:\n\n/etc/issue\n\nEnsure the file contains the Standard Mandatory DOD Notice and Consent Banner.\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62543r933468_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258803'\n  tag rid: 'SV-258803r933470_rule'\n  tag stig_id: 'PHTN-40-000005'\n  tag gtitle: 'SRG-OS-000023-GPOS-00006'\n  tag fix_id: 'F-62452r933469_fix'\n  tag satisfies: ['SRG-OS-000023-GPOS-00006', 'SRG-OS-000228-GPOS-00088']\n  tag 'documentable'\n  tag cci: ['CCI-000048', 'CCI-001384']\n  tag nist: ['AC-8 a', 'AC-8 c 1']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258803.rb"},"title":"The Photon operating system must display the Standard Mandatory DOD Notice and Consent Banner before granting local or remote access to the system.","desc":"Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with applicable DOD policy. Use the following verbiage for operating systems that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read & consent to terms in IS user agreem't.\"\n\n","descriptions":{"default":"Display of a standardized and approved use notification before granting access to the operating system ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users and are not required when such human interfaces do not exist.\n\nThe banner must be formatted in accordance with applicable DOD policy. Use the following verbiage for operating systems that can accommodate banners of 1300 characters:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.\n\nBy using this IS (which includes any device attached to this IS), you consent to the following conditions:\n\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n\n-At any time, the USG may inspect and seize data stored on this IS.\n\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.\n\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nUse the following verbiage for operating systems that have severe limitations on the number of characters that can be displayed in the banner:\n\n\"I've read & consent to terms in IS user agreem't.\"\n\n","check":"At the command line, run the following command to verify SSH is configured to use the /etc/issue file for a banner:\n\n# sshd -T|&grep -i Banner\n\nExample result:\n\nbanner /etc/issue\n\nIf the \"banner\" setting is not configured to \"/etc/issue\", this is a finding. \n\nNext, open /etc/issue with a text editor.\n\nIf the file does not contain the Standard Mandatory DOD Notice and Consent Banner, this is a finding.\n\nStandard Mandatory DOD Notice and Consent Banner:\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"Banner\" line is uncommented and set to the following:\n\nBanner /etc/issue\n\nNavigate to and open:\n\n/etc/issue\n\nEnsure the file contains the Standard Mandatory DOD Notice and Consent Banner.\n\n\"You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:\n-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.\n-At any time, the USG may inspect and seize data stored on this IS.\n-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.\n-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.\n-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.\"\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62543r933468_chk","severity":"medium","gid":"V-258803","rid":"SV-258803r933470_rule","stig_id":"PHTN-40-000005","gtitle":"SRG-OS-000023-GPOS-00006","fix_id":"F-62452r933469_fix","satisfies":["SRG-OS-000023-GPOS-00006","SRG-OS-000228-GPOS-00088"],"documentable":null,"cci":["CCI-000048","CCI-001384"],"nist":["AC-8 a","AC-8 c 1"]}},{"id":"SV-258804","code":"control 'SV-258804' do\n  title 'The Photon operating system must limit the number of concurrent sessions to ten for all accounts and/or account types.'\n  desc 'Operating system management includes the ability to control the number of users and user sessions that utilize an operating system. Limiting the number of allowed users and sessions per user is helpful in reducing the risks related to Denial of Service (DoS) attacks.\n\nThis requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system.'\n  desc 'check', 'At the command line, run the following command to verify the limit for the number of concurrent sessions:\n\n# grep \"^[^#].*maxlogins.*\" /etc/security/limits.conf\n\nExample result:\n\n*       hard    maxlogins       10\n\nIf \"* hard maxlogins\" is not configured to \"10\", this is a finding.\n\nNote: The expected result may be repeated multiple times.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/security/limits.conf\n\nAdd or update the following line:\n\n*       hard    maxlogins       10'\n  impact 0.3\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62544r933471_chk'\n  tag severity: 'low'\n  tag gid: 'V-258804'\n  tag rid: 'SV-258804r933473_rule'\n  tag stig_id: 'PHTN-40-000007'\n  tag gtitle: 'SRG-OS-000027-GPOS-00008'\n  tag fix_id: 'F-62453r933472_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258804.rb"},"title":"The Photon operating system must limit the number of concurrent sessions to ten for all accounts and/or account types.","desc":"Operating system management includes the ability to control the number of users and user sessions that utilize an operating system. Limiting the number of allowed users and sessions per user is helpful in reducing the risks related to Denial of Service (DoS) attacks.\n\nThis requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system.","descriptions":{"default":"Operating system management includes the ability to control the number of users and user sessions that utilize an operating system. Limiting the number of allowed users and sessions per user is helpful in reducing the risks related to Denial of Service (DoS) attacks.\n\nThis requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system.","check":"At the command line, run the following command to verify the limit for the number of concurrent sessions:\n\n# grep \"^[^#].*maxlogins.*\" /etc/security/limits.conf\n\nExample result:\n\n*       hard    maxlogins       10\n\nIf \"* hard maxlogins\" is not configured to \"10\", this is a finding.\n\nNote: The expected result may be repeated multiple times.","fix":"Navigate to and open:\n\n/etc/security/limits.conf\n\nAdd or update the following line:\n\n*       hard    maxlogins       10"},"impact":0.3,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62544r933471_chk","severity":"low","gid":"V-258804","rid":"SV-258804r933473_rule","stig_id":"PHTN-40-000007","gtitle":"SRG-OS-000027-GPOS-00008","fix_id":"F-62453r933472_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-258805","code":"control 'SV-258805' do\n  title 'The Photon operating system must monitor remote access logins.'\n  desc 'Remote access services, such as those providing remote access to network devices and information systems, which lack automated monitoring capabilities, increase risk and make remote user access management difficult at best. Remote access is access to DOD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. Automated monitoring of remote access sessions allows organizations to detect cyberattacks and also ensure ongoing compliance with remote access policies by auditing connection activities of remote access capabilities, such as Remote Desktop Protocol (RDP), on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).'\n  desc 'check', 'If another package is used to offload logs, such as syslog-ng, and is properly configured, this is not applicable.\n\nAt the command line, run the following command to verify rsyslog is configured to log authentication requests:\n\n# grep -E \"(^auth.*|^authpriv.*|^daemon.*)\" /etc/rsyslog.conf\n\nExample result:\n\nauth.*;authpriv.*;daemon.* /var/log/audit/sshinfo.log\n\nIf \"auth.*\", \"authpriv.*\", and \"daemon.*\" are not configured to be logged, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/rsyslog.conf\n\nAdd or update the following line:\n\nauth.*;authpriv.*;daemon.* /var/log/audit/sshinfo.log\n\nNote: The path can be substituted for another suitable log destination dedicated to authentication logs.\n\nAt the command line, run the following command:\n\n# systemctl restart rsyslog.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62545r933474_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258805'\n  tag rid: 'SV-258805r933476_rule'\n  tag stig_id: 'PHTN-40-000012'\n  tag gtitle: 'SRG-OS-000032-GPOS-00013'\n  tag fix_id: 'F-62454r933475_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000067']\n  tag nist: ['AC-17 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258805.rb"},"title":"The Photon operating system must monitor remote access logins.","desc":"Remote access services, such as those providing remote access to network devices and information systems, which lack automated monitoring capabilities, increase risk and make remote user access management difficult at best. Remote access is access to DOD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. Automated monitoring of remote access sessions allows organizations to detect cyberattacks and also ensure ongoing compliance with remote access policies by auditing connection activities of remote access capabilities, such as Remote Desktop Protocol (RDP), on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).","descriptions":{"default":"Remote access services, such as those providing remote access to network devices and information systems, which lack automated monitoring capabilities, increase risk and make remote user access management difficult at best. Remote access is access to DOD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless. Automated monitoring of remote access sessions allows organizations to detect cyberattacks and also ensure ongoing compliance with remote access policies by auditing connection activities of remote access capabilities, such as Remote Desktop Protocol (RDP), on a variety of information system components (e.g., servers, workstations, notebook computers, smartphones, and tablets).","check":"If another package is used to offload logs, such as syslog-ng, and is properly configured, this is not applicable.\n\nAt the command line, run the following command to verify rsyslog is configured to log authentication requests:\n\n# grep -E \"(^auth.*|^authpriv.*|^daemon.*)\" /etc/rsyslog.conf\n\nExample result:\n\nauth.*;authpriv.*;daemon.* /var/log/audit/sshinfo.log\n\nIf \"auth.*\", \"authpriv.*\", and \"daemon.*\" are not configured to be logged, this is a finding.","fix":"Navigate to and open:\n\n/etc/rsyslog.conf\n\nAdd or update the following line:\n\nauth.*;authpriv.*;daemon.* /var/log/audit/sshinfo.log\n\nNote: The path can be substituted for another suitable log destination dedicated to authentication logs.\n\nAt the command line, run the following command:\n\n# systemctl restart rsyslog.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62545r933474_chk","severity":"medium","gid":"V-258805","rid":"SV-258805r933476_rule","stig_id":"PHTN-40-000012","gtitle":"SRG-OS-000032-GPOS-00013","fix_id":"F-62454r933475_fix","documentable":null,"cci":["CCI-000067"],"nist":["AC-17 (1)"]}},{"id":"SV-258806","code":"control 'SV-258806' do\n  title 'The Photon operating system must have the OpenSSL FIPS provider installed to protect the confidentiality of remote access sessions.'\n  desc 'Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session.\n\nOpenSSH on the Photon operating system when configured appropriately can utilize a FIPS validated OpenSSL for cryptographic operations.\n\n'\n  desc 'check', 'At the command line, run the following command to verify the OpenSSL FIPS provider is installed:\n\n# rpm -qa | grep openssl-fips\n\nExample result:\n\nopenssl-fips-provider-3.0.3-1.ph4.x86_64\n\nIf there is no output indicating that the OpenSSL FIPS provider is installed, this is a finding.'\n  desc 'fix', 'At the command line, run the following command:\n\n# tdnf install openssl-fips-provider'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62546r933477_chk'\n  tag severity: 'high'\n  tag gid: 'V-258806'\n  tag rid: 'SV-258806r933479_rule'\n  tag stig_id: 'PHTN-40-000013'\n  tag gtitle: 'SRG-OS-000033-GPOS-00014'\n  tag fix_id: 'F-62455r933478_fix'\n  tag satisfies: ['SRG-OS-000033-GPOS-00014', 'SRG-OS-000393-GPOS-00173', 'SRG-OS-000394-GPOS-00174', 'SRG-OS-000423-GPOS-00187', 'SRG-OS-000425-GPOS-00189', 'SRG-OS-000426-GPOS-00190']\n  tag 'documentable'\n  tag cci: ['CCI-000068', 'CCI-002418', 'CCI-002420', 'CCI-002422', 'CCI-002890', 'CCI-003123']\n  tag nist: ['AC-17 (2)', 'SC-8', 'SC-8 (2)', 'SC-8 (2)', 'MA-4 (6)', 'MA-4 (6)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258806.rb"},"title":"The Photon operating system must have the OpenSSL FIPS provider installed to protect the confidentiality of remote access sessions.","desc":"Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session.\n\nOpenSSH on the Photon operating system when configured appropriately can utilize a FIPS validated OpenSSL for cryptographic operations.\n\n","descriptions":{"default":"Without confidentiality protection mechanisms, unauthorized individuals may gain access to sensitive information via a remote access session.\n\nOpenSSH on the Photon operating system when configured appropriately can utilize a FIPS validated OpenSSL for cryptographic operations.\n\n","check":"At the command line, run the following command to verify the OpenSSL FIPS provider is installed:\n\n# rpm -qa | grep openssl-fips\n\nExample result:\n\nopenssl-fips-provider-3.0.3-1.ph4.x86_64\n\nIf there is no output indicating that the OpenSSL FIPS provider is installed, this is a finding.","fix":"At the command line, run the following command:\n\n# tdnf install openssl-fips-provider"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62546r933477_chk","severity":"high","gid":"V-258806","rid":"SV-258806r933479_rule","stig_id":"PHTN-40-000013","gtitle":"SRG-OS-000033-GPOS-00014","fix_id":"F-62455r933478_fix","satisfies":["SRG-OS-000033-GPOS-00014","SRG-OS-000393-GPOS-00173","SRG-OS-000394-GPOS-00174","SRG-OS-000423-GPOS-00187","SRG-OS-000425-GPOS-00189","SRG-OS-000426-GPOS-00190"],"documentable":null,"cci":["CCI-000068","CCI-002418","CCI-002420","CCI-002422","CCI-002890","CCI-003123"],"nist":["AC-17 (2)","SC-8","SC-8 (2)","SC-8 (2)","MA-4 (6)","MA-4 (6)"]}},{"id":"SV-258807","code":"control 'SV-258807' do\n  title 'The Photon operating system must configure auditd to log to disk.'\n  desc 'Without establishing what type of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content must be shipped to a central location, but it must also be logged locally.'\n  desc 'check', %q(At the command line, run the following command to verify auditd is configured to write logs to disk:\n\n# grep '^write_logs' /etc/audit/auditd.conf\n\nExample result:\n\nwrite_logs = yes\n\nIf there is no output, this is not a finding.\n\nIf \"write_logs\" exists and is not configured to \"yes\", this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/auditd.conf\n\nEnsure the \"write_logs\" line is uncommented and set to the following:\n\nwrite_logs = yes\n\nAt the command line, run the following command:\n\n# pkill -SIGHUP auditd'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62547r933480_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258807'\n  tag rid: 'SV-258807r933482_rule'\n  tag stig_id: 'PHTN-40-000014'\n  tag gtitle: 'SRG-OS-000037-GPOS-00015'\n  tag fix_id: 'F-62456r933481_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000130']\n  tag nist: ['AU-3 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258807.rb"},"title":"The Photon operating system must configure auditd to log to disk.","desc":"Without establishing what type of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content must be shipped to a central location, but it must also be logged locally.","descriptions":{"default":"Without establishing what type of events occurred, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.\n\nAudit record content must be shipped to a central location, but it must also be logged locally.","check":"At the command line, run the following command to verify auditd is configured to write logs to disk:\n\n# grep '^write_logs' /etc/audit/auditd.conf\n\nExample result:\n\nwrite_logs = yes\n\nIf there is no output, this is not a finding.\n\nIf \"write_logs\" exists and is not configured to \"yes\", this is a finding.","fix":"Navigate to and open:\n\n/etc/audit/auditd.conf\n\nEnsure the \"write_logs\" line is uncommented and set to the following:\n\nwrite_logs = yes\n\nAt the command line, run the following command:\n\n# pkill -SIGHUP auditd"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62547r933480_chk","severity":"medium","gid":"V-258807","rid":"SV-258807r933482_rule","stig_id":"PHTN-40-000014","gtitle":"SRG-OS-000037-GPOS-00015","fix_id":"F-62456r933481_fix","documentable":null,"cci":["CCI-000130"],"nist":["AU-3 a"]}},{"id":"SV-258808","code":"control 'SV-258808' do\n  title 'The Photon operating system must enable the auditd service.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. To that end, the auditd service must be configured to start automatically and be running at all times.\n\n'\n  desc 'check', 'At the command line, run the following command to verify auditd is enabled and running:\n\n# systemctl status auditd\n\nIf the service is not enabled and running, this is a finding.'\n  desc 'fix', 'At the command line, run the following commands:\n\n# systemctl enable auditd\n# systemctl start auditd'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62548r933483_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258808'\n  tag rid: 'SV-258808r933485_rule'\n  tag stig_id: 'PHTN-40-000016'\n  tag gtitle: 'SRG-OS-000039-GPOS-00017'\n  tag fix_id: 'F-62457r933484_fix'\n  tag satisfies: ['SRG-OS-000039-GPOS-00017', 'SRG-OS-000040-GPOS-00018', 'SRG-OS-000041-GPOS-00019', 'SRG-OS-000042-GPOS-00021', 'SRG-OS-000062-GPOS-00031', 'SRG-OS-000255-GPOS-00096', 'SRG-OS-000363-GPOS-00150', 'SRG-OS-000365-GPOS-00152', 'SRG-OS-000446-GPOS-00200']\n  tag 'documentable'\n  tag cci: ['CCI-000132', 'CCI-000133', 'CCI-000134', 'CCI-000135', 'CCI-000169', 'CCI-001487', 'CCI-001744', 'CCI-001814', 'CCI-002699']\n  tag nist: ['AU-3 c', 'AU-3 d', 'AU-3 e', 'AU-3 (1)', 'AU-12 a', 'AU-3 f', 'CM-3 (5)', 'CM-5 (1)', 'SI-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258808.rb"},"title":"The Photon operating system must enable the auditd service.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. To that end, the auditd service must be configured to start automatically and be running at all times.\n\n","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. To that end, the auditd service must be configured to start automatically and be running at all times.\n\n","check":"At the command line, run the following command to verify auditd is enabled and running:\n\n# systemctl status auditd\n\nIf the service is not enabled and running, this is a finding.","fix":"At the command line, run the following commands:\n\n# systemctl enable auditd\n# systemctl start auditd"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62548r933483_chk","severity":"medium","gid":"V-258808","rid":"SV-258808r933485_rule","stig_id":"PHTN-40-000016","gtitle":"SRG-OS-000039-GPOS-00017","fix_id":"F-62457r933484_fix","satisfies":["SRG-OS-000039-GPOS-00017","SRG-OS-000040-GPOS-00018","SRG-OS-000041-GPOS-00019","SRG-OS-000042-GPOS-00021","SRG-OS-000062-GPOS-00031","SRG-OS-000255-GPOS-00096","SRG-OS-000363-GPOS-00150","SRG-OS-000365-GPOS-00152","SRG-OS-000446-GPOS-00200"],"documentable":null,"cci":["CCI-000132","CCI-000133","CCI-000134","CCI-000135","CCI-000169","CCI-001487","CCI-001744","CCI-001814","CCI-002699"],"nist":["AU-3 c","AU-3 d","AU-3 e","AU-3 (1)","AU-12 a","AU-3 f","CM-3 (5)","CM-5 (1)","SI-6 b"]}},{"id":"SV-258809","code":"control 'SV-258809' do\n  title 'The Photon operating system must be configured to audit the execution of privileged functions.'\n  desc 'Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing all actions by superusers is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\n'\n  desc 'check', 'At the command line, run the following command to verify audit rules exist to audit privileged functions:\n\n# auditctl -l | grep execve\n\nExpected result:\n\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -F key=execpriv\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -F key=execpriv\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -F key=execpriv\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -F key=execpriv\n\nIf the output does not match the expected result, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -F key=execpriv\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -F key=execpriv\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -F key=execpriv\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -F key=execpriv\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62549r933486_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258809'\n  tag rid: 'SV-258809r933488_rule'\n  tag stig_id: 'PHTN-40-000019'\n  tag gtitle: 'SRG-OS-000042-GPOS-00020'\n  tag fix_id: 'F-62458r933487_fix'\n  tag satisfies: ['SRG-OS-000042-GPOS-00020', 'SRG-OS-000326-GPOS-00126']\n  tag 'documentable'\n  tag cci: ['CCI-000135', 'CCI-002233']\n  tag nist: ['AU-3 (1)', 'AC-6 (8)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258809.rb"},"title":"The Photon operating system must be configured to audit the execution of privileged functions.","desc":"Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing all actions by superusers is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\n","descriptions":{"default":"Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing all actions by superusers is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\n","check":"At the command line, run the following command to verify audit rules exist to audit privileged functions:\n\n# auditctl -l | grep execve\n\nExpected result:\n\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -F key=execpriv\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -F key=execpriv\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -F key=execpriv\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -F key=execpriv\n\nIf the output does not match the expected result, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.","fix":"Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -F key=execpriv\n-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -F key=execpriv\n-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -F key=execpriv\n-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -F key=execpriv\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62549r933486_chk","severity":"medium","gid":"V-258809","rid":"SV-258809r933488_rule","stig_id":"PHTN-40-000019","gtitle":"SRG-OS-000042-GPOS-00020","fix_id":"F-62458r933487_fix","satisfies":["SRG-OS-000042-GPOS-00020","SRG-OS-000326-GPOS-00126"],"documentable":null,"cci":["CCI-000135","CCI-002233"],"nist":["AU-3 (1)","AC-6 (8)"]}},{"id":"SV-258810","code":"control 'SV-258810' do\n  title 'The Photon operating system must alert the ISSO and SA in the event of an audit processing failure.'\n  desc 'It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.\n\nAudit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.\n\n'\n  desc 'check', 'At the command line, run the following command to verify auditd is configured to send an alert via syslog in the event of an audit processing failure:\n\n# grep -E \"^disk_full_action|^disk_error_action|^admin_space_left_action\" /etc/audit/auditd.conf\n\nExample result:\n\nadmin_space_left_action = SYSLOG\ndisk_full_action = SYSLOG\ndisk_error_action = SYSLOG\n\nIf \"disk_full_action\", \"disk_error_action\", and \"admin_space_left_action\" are not set to SYSLOG or are missing, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/auditd.conf\n\nEnsure the following lines are present, not duplicated, and not commented:\n\ndisk_full_action = SYSLOG\ndisk_error_action = SYSLOG\nadmin_space_left_action = SYSLOG\n\nAt the command line, run the following command:\n\n# pkill -SIGHUP auditd'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62550r933489_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258810'\n  tag rid: 'SV-258810r933491_rule'\n  tag stig_id: 'PHTN-40-000021'\n  tag gtitle: 'SRG-OS-000046-GPOS-00022'\n  tag fix_id: 'F-62459r933490_fix'\n  tag satisfies: ['SRG-OS-000046-GPOS-00022', 'SRG-OS-000344-GPOS-00135']\n  tag 'documentable'\n  tag cci: ['CCI-000139', 'CCI-001858']\n  tag nist: ['AU-5 a', 'AU-5 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258810.rb"},"title":"The Photon operating system must alert the ISSO and SA in the event of an audit processing failure.","desc":"It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.\n\nAudit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.\n\n","descriptions":{"default":"It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.\n\nAudit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.\n\n","check":"At the command line, run the following command to verify auditd is configured to send an alert via syslog in the event of an audit processing failure:\n\n# grep -E \"^disk_full_action|^disk_error_action|^admin_space_left_action\" /etc/audit/auditd.conf\n\nExample result:\n\nadmin_space_left_action = SYSLOG\ndisk_full_action = SYSLOG\ndisk_error_action = SYSLOG\n\nIf \"disk_full_action\", \"disk_error_action\", and \"admin_space_left_action\" are not set to SYSLOG or are missing, this is a finding.","fix":"Navigate to and open:\n\n/etc/audit/auditd.conf\n\nEnsure the following lines are present, not duplicated, and not commented:\n\ndisk_full_action = SYSLOG\ndisk_error_action = SYSLOG\nadmin_space_left_action = SYSLOG\n\nAt the command line, run the following command:\n\n# pkill -SIGHUP auditd"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62550r933489_chk","severity":"medium","gid":"V-258810","rid":"SV-258810r933491_rule","stig_id":"PHTN-40-000021","gtitle":"SRG-OS-000046-GPOS-00022","fix_id":"F-62459r933490_fix","satisfies":["SRG-OS-000046-GPOS-00022","SRG-OS-000344-GPOS-00135"],"documentable":null,"cci":["CCI-000139","CCI-001858"],"nist":["AU-5 a","AU-5 (2)"]}},{"id":"SV-258811","code":"control 'SV-258811' do\n  title 'The Photon operating system must protect audit logs from unauthorized access.'\n  desc 'Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.\n\nAudit information includes all information (e.g., audit records, audit settings, audit reports) needed to successfully audit operating system activity.\n\n'\n  desc 'check', 'At the command line, run the following command to find the current auditd log location:\n\n# grep -iw log_file /etc/audit/auditd.conf\n\nExample result:\n\nlog_file = /var/log/audit/audit.log\n\nAt the command line, run the following command using the file found in the previous step to verify auditd logs are protected from authorized access:\n\n# stat -c \"%n %U:%G %a\" /var/log/audit/audit.log\n\nExample result:\n\n/var/log/audit/audit.log root:root 600\n\nIf the audit log file does not have permissions set to \"0600\", this is a finding.\nIf the audit log file is not owned by root, this is a finding.\nIf the audit log file is not group owned by root, this is a finding.'\n  desc 'fix', 'At the command line, run the following commands:\n\n#  chmod 0600 <audit log file>\n#  chown root:root <audit log file>\n\nReplace <audit log file> with the target log file.\n\nNote: If \"log_group\" is configured in the auditd.conf file and set to something other than \"root\", the permissions changes will not be persistent.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62551r933492_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258811'\n  tag rid: 'SV-258811r933494_rule'\n  tag stig_id: 'PHTN-40-000026'\n  tag gtitle: 'SRG-OS-000057-GPOS-00027'\n  tag fix_id: 'F-62460r933493_fix'\n  tag satisfies: ['SRG-OS-000057-GPOS-00027', 'SRG-OS-000058-GPOS-00028', 'SRG-OS-000059-GPOS-00029']\n  tag 'documentable'\n  tag cci: ['CCI-000162', 'CCI-000163', 'CCI-000164']\n  tag nist: ['AU-9 a', 'AU-9 a', 'AU-9 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258811.rb"},"title":"The Photon operating system must protect audit logs from unauthorized access.","desc":"Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.\n\nAudit information includes all information (e.g., audit records, audit settings, audit reports) needed to successfully audit operating system activity.\n\n","descriptions":{"default":"Unauthorized disclosure of audit records can reveal system and configuration data to attackers, thus compromising its confidentiality.\n\nAudit information includes all information (e.g., audit records, audit settings, audit reports) needed to successfully audit operating system activity.\n\n","check":"At the command line, run the following command to find the current auditd log location:\n\n# grep -iw log_file /etc/audit/auditd.conf\n\nExample result:\n\nlog_file = /var/log/audit/audit.log\n\nAt the command line, run the following command using the file found in the previous step to verify auditd logs are protected from authorized access:\n\n# stat -c \"%n %U:%G %a\" /var/log/audit/audit.log\n\nExample result:\n\n/var/log/audit/audit.log root:root 600\n\nIf the audit log file does not have permissions set to \"0600\", this is a finding.\nIf the audit log file is not owned by root, this is a finding.\nIf the audit log file is not group owned by root, this is a finding.","fix":"At the command line, run the following commands:\n\n#  chmod 0600 <audit log file>\n#  chown root:root <audit log file>\n\nReplace <audit log file> with the target log file.\n\nNote: If \"log_group\" is configured in the auditd.conf file and set to something other than \"root\", the permissions changes will not be persistent."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62551r933492_chk","severity":"medium","gid":"V-258811","rid":"SV-258811r933494_rule","stig_id":"PHTN-40-000026","gtitle":"SRG-OS-000057-GPOS-00027","fix_id":"F-62460r933493_fix","satisfies":["SRG-OS-000057-GPOS-00027","SRG-OS-000058-GPOS-00028","SRG-OS-000059-GPOS-00029"],"documentable":null,"cci":["CCI-000162","CCI-000163","CCI-000164"],"nist":["AU-9 a","AU-9 a","AU-9 a"]}},{"id":"SV-258812","code":"control 'SV-258812' do\n  title 'The Photon operating system must allow only authorized users to configure the auditd service.'\n  desc \"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\"\n  desc 'check', 'At the command line, run the following command to verify permissions on auditd configuration and rules files:\n\n# find /etc/audit/* -type f -exec stat -c \"%n %U:%G %a\" {} $1\\\\;\n\nIf any files are returned with permissions more permissive than \"0640\", this is a finding.\nIf any files are returned not owned by root, this is a finding.\nIf any files are returned not group owned by root, this is a finding.'\n  desc 'fix', 'At the command line, run the following commands:\n\n#  chmod 0640 <audit file>\n#  chown root:root <audit file>\n\nReplace <audit file> with the target file.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62552r933495_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258812'\n  tag rid: 'SV-258812r933497_rule'\n  tag stig_id: 'PHTN-40-000030'\n  tag gtitle: 'SRG-OS-000063-GPOS-00032'\n  tag fix_id: 'F-62461r933496_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000171']\n  tag nist: ['AU-12 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258812.rb"},"title":"The Photon operating system must allow only authorized users to configure the auditd service.","desc":"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.","descriptions":{"default":"Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.","check":"At the command line, run the following command to verify permissions on auditd configuration and rules files:\n\n# find /etc/audit/* -type f -exec stat -c \"%n %U:%G %a\" {} $1\\;\n\nIf any files are returned with permissions more permissive than \"0640\", this is a finding.\nIf any files are returned not owned by root, this is a finding.\nIf any files are returned not group owned by root, this is a finding.","fix":"At the command line, run the following commands:\n\n#  chmod 0640 <audit file>\n#  chown root:root <audit file>\n\nReplace <audit file> with the target file."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62552r933495_chk","severity":"medium","gid":"V-258812","rid":"SV-258812r933497_rule","stig_id":"PHTN-40-000030","gtitle":"SRG-OS-000063-GPOS-00032","fix_id":"F-62461r933496_fix","documentable":null,"cci":["CCI-000171"],"nist":["AU-12 b"]}},{"id":"SV-258813","code":"control 'SV-258813' do\n  title 'The Photon operating system must generate audit records when successful/unsuccessful attempts to access privileges occur.'\n  desc 'The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.\n\n'\n  desc 'check', 'At the command line, run the following command to verify an audit rule exists to audit account creations:\n\n# auditctl -l | grep chmod\n\nExpected result:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid>=1000 -F auid!=-1 -F key=perm_mod\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid=0 -F key=perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid>=1000 -F auid!=-1 -F key=perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid=0 -F key=perm_mod\n\nIf the output does not match the expected result, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.\n\nNote: auid!=-1, auid!=4294967295, auid!=unset are functionally equivalent in this check and the output of the above commands may be displayed in either format.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid>=1000 -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid=0 -F key=perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid>=1000 -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid=0 -F key=perm_mod\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62553r933498_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258813'\n  tag rid: 'SV-258813r933500_rule'\n  tag stig_id: 'PHTN-40-000031'\n  tag gtitle: 'SRG-OS-000064-GPOS-00033'\n  tag fix_id: 'F-62462r933499_fix'\n  tag satisfies: ['SRG-OS-000064-GPOS-00033', 'SRG-OS-000462-GPOS-00206', 'SRG-OS-000466-GPOS-00210', 'SRG-OS-000468-GPOS-00212', 'SRG-OS-000474-GPOS-00219']\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258813.rb"},"title":"The Photon operating system must generate audit records when successful/unsuccessful attempts to access privileges occur.","desc":"The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.\n\n","descriptions":{"default":"The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users.\n\n","check":"At the command line, run the following command to verify an audit rule exists to audit account creations:\n\n# auditctl -l | grep chmod\n\nExpected result:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid>=1000 -F auid!=-1 -F key=perm_mod\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid=0 -F key=perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid>=1000 -F auid!=-1 -F key=perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid=0 -F key=perm_mod\n\nIf the output does not match the expected result, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.\n\nNote: auid!=-1, auid!=4294967295, auid!=unset are functionally equivalent in this check and the output of the above commands may be displayed in either format.","fix":"Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid>=1000 -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b64 -S chmod,fchmod,chown,fchown,lchown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid=0 -F key=perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid>=1000 -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b32 -S chmod,lchown,fchmod,fchown,chown,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr,fchownat,fchmodat -F auid=0 -F key=perm_mod\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62553r933498_chk","severity":"medium","gid":"V-258813","rid":"SV-258813r933500_rule","stig_id":"PHTN-40-000031","gtitle":"SRG-OS-000064-GPOS-00033","fix_id":"F-62462r933499_fix","satisfies":["SRG-OS-000064-GPOS-00033","SRG-OS-000462-GPOS-00206","SRG-OS-000466-GPOS-00210","SRG-OS-000468-GPOS-00212","SRG-OS-000474-GPOS-00219"],"documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-258814","code":"control 'SV-258814' do\n  title 'The Photon operating system must enforce password complexity by requiring that at least one uppercase character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.'\n  desc 'check', %q(At the command line, run the following command to verify at least one uppercase character be used:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"ucredit\" option is not < 0, is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"ucredit\" option set to \"-1\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62554r933501_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258814'\n  tag rid: 'SV-258814r933503_rule'\n  tag stig_id: 'PHTN-40-000035'\n  tag gtitle: 'SRG-OS-000069-GPOS-00037'\n  tag fix_id: 'F-62463r933502_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000192']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258814.rb"},"title":"The Photon operating system must enforce password complexity by requiring that at least one uppercase character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","check":"At the command line, run the following command to verify at least one uppercase character be used:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"ucredit\" option is not < 0, is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"ucredit\" option set to \"-1\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62554r933501_chk","severity":"medium","gid":"V-258814","rid":"SV-258814r933503_rule","stig_id":"PHTN-40-000035","gtitle":"SRG-OS-000069-GPOS-00037","fix_id":"F-62463r933502_fix","documentable":null,"cci":["CCI-000192"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-258815","code":"control 'SV-258815' do\n  title 'The Photon operating system must enforce password complexity by requiring that at least one lowercase character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.'\n  desc 'check', %q(At the command line, run the following command to verify at least one lowercase character be used:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"lcredit\" option is not < 0, is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"lcredit\" option set to \"-1\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62555r933504_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258815'\n  tag rid: 'SV-258815r933506_rule'\n  tag stig_id: 'PHTN-40-000036'\n  tag gtitle: 'SRG-OS-000070-GPOS-00038'\n  tag fix_id: 'F-62464r933505_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000193']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258815.rb"},"title":"The Photon operating system must enforce password complexity by requiring that at least one lowercase character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","check":"At the command line, run the following command to verify at least one lowercase character be used:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"lcredit\" option is not < 0, is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"lcredit\" option set to \"-1\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62555r933504_chk","severity":"medium","gid":"V-258815","rid":"SV-258815r933506_rule","stig_id":"PHTN-40-000036","gtitle":"SRG-OS-000070-GPOS-00038","fix_id":"F-62464r933505_fix","documentable":null,"cci":["CCI-000193"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-258816","code":"control 'SV-258816' do\n  title 'The Photon operating system must enforce password complexity by requiring that at least one numeric character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.'\n  desc 'check', %q(At the command line, run the following command to verify at least one numeric character be used:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"dcredit\" option is not < 0, is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"dcredit\" option set to \"-1\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62556r933507_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258816'\n  tag rid: 'SV-258816r933509_rule'\n  tag stig_id: 'PHTN-40-000037'\n  tag gtitle: 'SRG-OS-000071-GPOS-00039'\n  tag fix_id: 'F-62465r933508_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000194']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258816.rb"},"title":"The Photon operating system must enforce password complexity by requiring that at least one numeric character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","check":"At the command line, run the following command to verify at least one numeric character be used:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"dcredit\" option is not < 0, is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"dcredit\" option set to \"-1\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62556r933507_chk","severity":"medium","gid":"V-258816","rid":"SV-258816r933509_rule","stig_id":"PHTN-40-000037","gtitle":"SRG-OS-000071-GPOS-00039","fix_id":"F-62465r933508_fix","documentable":null,"cci":["CCI-000194"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-258817","code":"control 'SV-258817' do\n  title 'The Photon operating system must require the change of at least eight characters when passwords are changed.'\n  desc 'If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.'\n  desc 'check', %q(At the command line, run the following command to verify at least eight different characters be used:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"difok\" option is not >= 8, is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"difok\" option set to \"8\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62557r933510_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258817'\n  tag rid: 'SV-258817r933512_rule'\n  tag stig_id: 'PHTN-40-000038'\n  tag gtitle: 'SRG-OS-000072-GPOS-00040'\n  tag fix_id: 'F-62466r933511_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000195']\n  tag nist: ['IA-5 (1) (b)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258817.rb"},"title":"The Photon operating system must require the change of at least eight characters when passwords are changed.","desc":"If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.","descriptions":{"default":"If the operating system allows the user to consecutively reuse extensive portions of passwords, this increases the chances of password compromise by increasing the window of opportunity for attempts at guessing and brute-force attacks.\n\nThe number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.\n\nIf the password length is an odd number then number of changed characters must be rounded up. For example, a password length of 15 characters must require the change of at least eight characters.","check":"At the command line, run the following command to verify at least eight different characters be used:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"difok\" option is not >= 8, is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"difok\" option set to \"8\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62557r933510_chk","severity":"medium","gid":"V-258817","rid":"SV-258817r933512_rule","stig_id":"PHTN-40-000038","gtitle":"SRG-OS-000072-GPOS-00040","fix_id":"F-62466r933511_fix","documentable":null,"cci":["CCI-000195"],"nist":["IA-5 (1) (b)"]}},{"id":"SV-258818","code":"control 'SV-258818' do\n  title 'The operating system must store only encrypted representations of passwords.'\n  desc 'Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.'\n  desc 'check', 'At the command line, run the following command to verify passwords are stored with only encrypted representations:\n\n# grep ^ENCRYPT_METHOD /etc/login.defs\n\nExample result:\n\nENCRYPT_METHOD SHA512\n\nIf the \"ENCRYPT_METHOD\" option is not set to \"SHA512\", is missing or commented out, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line:\n\nENCRYPT_METHOD SHA512'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62558r933513_chk'\n  tag severity: 'high'\n  tag gid: 'V-258818'\n  tag rid: 'SV-258818r933515_rule'\n  tag stig_id: 'PHTN-40-000039'\n  tag gtitle: 'SRG-OS-000073-GPOS-00041'\n  tag fix_id: 'F-62467r933514_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000196']\n  tag nist: ['IA-5 (1) (c)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258818.rb"},"title":"The operating system must store only encrypted representations of passwords.","desc":"Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.","descriptions":{"default":"Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.","check":"At the command line, run the following command to verify passwords are stored with only encrypted representations:\n\n# grep ^ENCRYPT_METHOD /etc/login.defs\n\nExample result:\n\nENCRYPT_METHOD SHA512\n\nIf the \"ENCRYPT_METHOD\" option is not set to \"SHA512\", is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line:\n\nENCRYPT_METHOD SHA512"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62558r933513_chk","severity":"high","gid":"V-258818","rid":"SV-258818r933515_rule","stig_id":"PHTN-40-000039","gtitle":"SRG-OS-000073-GPOS-00041","fix_id":"F-62467r933514_fix","documentable":null,"cci":["CCI-000196"],"nist":["IA-5 (1) (c)"]}},{"id":"SV-258819","code":"control 'SV-258819' do\n  title 'The Photon operating system must not have the telnet package installed.'\n  desc 'Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.'\n  desc 'check', 'At the command line, run the following command to verify telnet is not installed:\n\n# rpm -qa | grep telnet\n\nIf any results are returned indicating telnet is installed, this is a finding.'\n  desc 'fix', 'At the command line, run the following command:\n\n# tdnf remove <package name>'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62559r933516_chk'\n  tag severity: 'high'\n  tag gid: 'V-258819'\n  tag rid: 'SV-258819r933518_rule'\n  tag stig_id: 'PHTN-40-000040'\n  tag gtitle: 'SRG-OS-000074-GPOS-00042'\n  tag fix_id: 'F-62468r933517_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000197']\n  tag nist: ['IA-5 (1) (c)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258819.rb"},"title":"The Photon operating system must not have the telnet package installed.","desc":"Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.","descriptions":{"default":"Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.","check":"At the command line, run the following command to verify telnet is not installed:\n\n# rpm -qa | grep telnet\n\nIf any results are returned indicating telnet is installed, this is a finding.","fix":"At the command line, run the following command:\n\n# tdnf remove <package name>"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62559r933516_chk","severity":"high","gid":"V-258819","rid":"SV-258819r933518_rule","stig_id":"PHTN-40-000040","gtitle":"SRG-OS-000074-GPOS-00042","fix_id":"F-62468r933517_fix","documentable":null,"cci":["CCI-000197"],"nist":["IA-5 (1) (c)"]}},{"id":"SV-258820","code":"control 'SV-258820' do\n  title 'The Photon operating system must enforce one day as the minimum password lifetime.'\n  desc \"Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, then the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.\"\n  desc 'check', %q(At the command line, run the following command to verify one day as the minimum password lifetime:\n\n# grep '^PASS_MIN_DAYS' /etc/login.defs\n\nIf \"PASS_MIN_DAYS\" is not set to 1, is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line: \n\nPASS_MIN_DAYS 1'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62560r933519_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258820'\n  tag rid: 'SV-258820r933521_rule'\n  tag stig_id: 'PHTN-40-000041'\n  tag gtitle: 'SRG-OS-000075-GPOS-00043'\n  tag fix_id: 'F-62469r933520_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000198']\n  tag nist: ['IA-5 (1) (d)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258820.rb"},"title":"The Photon operating system must enforce one day as the minimum password lifetime.","desc":"Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, then the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.","descriptions":{"default":"Enforcing a minimum password lifetime helps to prevent repeated password changes to defeat the password reuse or history enforcement requirement. If users are allowed to immediately and continually change their password, then the password could be repeatedly changed in a short period of time to defeat the organization's policy regarding password reuse.","check":"At the command line, run the following command to verify one day as the minimum password lifetime:\n\n# grep '^PASS_MIN_DAYS' /etc/login.defs\n\nIf \"PASS_MIN_DAYS\" is not set to 1, is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line: \n\nPASS_MIN_DAYS 1"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62560r933519_chk","severity":"medium","gid":"V-258820","rid":"SV-258820r933521_rule","stig_id":"PHTN-40-000041","gtitle":"SRG-OS-000075-GPOS-00043","fix_id":"F-62469r933520_fix","documentable":null,"cci":["CCI-000198"],"nist":["IA-5 (1) (d)"]}},{"id":"SV-258821","code":"control 'SV-258821' do\n  title 'The Photon operating systems must enforce a 90-day maximum password lifetime restriction.'\n  desc 'Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.'\n  desc 'check', %q(At the command line, run the following command to verify a 90-day maximum password lifetime restriction:\n\n# grep '^PASS_MAX_DAYS' /etc/login.defs\n\nIf \"PASS_MAX_DAYS\" is not set to <= 90, is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line: \n\nPASS_MAX_DAYS 90'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62561r933522_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258821'\n  tag rid: 'SV-258821r933524_rule'\n  tag stig_id: 'PHTN-40-000042'\n  tag gtitle: 'SRG-OS-000076-GPOS-00044'\n  tag fix_id: 'F-62470r933523_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000199']\n  tag nist: ['IA-5 (1) (d)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258821.rb"},"title":"The Photon operating systems must enforce a 90-day maximum password lifetime restriction.","desc":"Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.","descriptions":{"default":"Any password, no matter how complex, can eventually be cracked. Therefore, passwords need to be changed periodically. If the operating system does not limit the lifetime of passwords and force users to change their passwords, there is the risk that the operating system passwords could be compromised.","check":"At the command line, run the following command to verify a 90-day maximum password lifetime restriction:\n\n# grep '^PASS_MAX_DAYS' /etc/login.defs\n\nIf \"PASS_MAX_DAYS\" is not set to <= 90, is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line: \n\nPASS_MAX_DAYS 90"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62561r933522_chk","severity":"medium","gid":"V-258821","rid":"SV-258821r933524_rule","stig_id":"PHTN-40-000042","gtitle":"SRG-OS-000076-GPOS-00044","fix_id":"F-62470r933523_fix","documentable":null,"cci":["CCI-000199"],"nist":["IA-5 (1) (d)"]}},{"id":"SV-258822","code":"control 'SV-258822' do\n  title 'The Photon operating system must prohibit password reuse for a minimum of five generations.'\n  desc 'Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.'\n  desc 'check', %q(At the command line, run the following commands to verify passwords are not reused for a minimum of five generations:\n\n# grep '^password.*pam_pwhistory.so' /etc/pam.d/system-password\n\nExample result:\n\npassword required pam_pwhistory.so remember=5 retry=3 enforce_for_root use_authtok\n\nIf the \"remember\" option is not set to \"5\" or greater, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwhistory.so line to have the \"remember\" option set to 5 or greater as follows:\n\npassword required pam_pwhistory.so remember=5 retry=3 enforce_for_root use_authtok\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62562r933525_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258822'\n  tag rid: 'SV-258822r933527_rule'\n  tag stig_id: 'PHTN-40-000043'\n  tag gtitle: 'SRG-OS-000077-GPOS-00045'\n  tag fix_id: 'F-62471r933526_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000200']\n  tag nist: ['IA-5 (1) (e)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258822.rb"},"title":"The Photon operating system must prohibit password reuse for a minimum of five generations.","desc":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.","descriptions":{"default":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.","check":"At the command line, run the following commands to verify passwords are not reused for a minimum of five generations:\n\n# grep '^password.*pam_pwhistory.so' /etc/pam.d/system-password\n\nExample result:\n\npassword required pam_pwhistory.so remember=5 retry=3 enforce_for_root use_authtok\n\nIf the \"remember\" option is not set to \"5\" or greater, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwhistory.so line to have the \"remember\" option set to 5 or greater as follows:\n\npassword required pam_pwhistory.so remember=5 retry=3 enforce_for_root use_authtok\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62562r933525_chk","severity":"medium","gid":"V-258822","rid":"SV-258822r933527_rule","stig_id":"PHTN-40-000043","gtitle":"SRG-OS-000077-GPOS-00045","fix_id":"F-62471r933526_fix","documentable":null,"cci":["CCI-000200"],"nist":["IA-5 (1) (e)"]}},{"id":"SV-258823","code":"control 'SV-258823' do\n  title 'The Photon operating system must enforce a minimum 15-character password length.'\n  desc 'The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.'\n  desc 'check', %q(At the command line, run the following command to verify a minimum 15-character password length:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"minlen\" option is not >= 15, is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"minlen\" option set to \"15\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62563r933528_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258823'\n  tag rid: 'SV-258823r933530_rule'\n  tag stig_id: 'PHTN-40-000044'\n  tag gtitle: 'SRG-OS-000078-GPOS-00046'\n  tag fix_id: 'F-62472r933529_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000205']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258823.rb"},"title":"The Photon operating system must enforce a minimum 15-character password length.","desc":"The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","descriptions":{"default":"The shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised.\n\nPassword complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","check":"At the command line, run the following command to verify a minimum 15-character password length:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"minlen\" option is not >= 15, is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"minlen\" option set to \"15\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62563r933528_chk","severity":"medium","gid":"V-258823","rid":"SV-258823r933530_rule","stig_id":"PHTN-40-000044","gtitle":"SRG-OS-000078-GPOS-00046","fix_id":"F-62472r933529_fix","documentable":null,"cci":["CCI-000205"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-258824","code":"control 'SV-258824' do\n  title 'The Photon operating system must require authentication upon booting into single-user and maintenance modes.'\n  desc 'If the system does not require authentication before it boots into single-user mode, anyone with console access to the system can trivially access all files on the system. GRUB2 is the boot loader for Photon OS and can be configured to require a password to boot into single-user mode or make modifications to the boot menu.\n\nNote: Photon does not support building grub changes via grub2-mkconfig.'\n  desc 'check', 'At the command line, run the following command to verify a password is required to edit the grub bootloader to boot into single-user mode:\n\n# grep -E \"^set\\\\ssuperusers|^password_pbkdf2\" /boot/grub2/grub.cfg\n\nExample output:\n\nset superusers=\"root\"\npassword_pbkdf2 root grub.pbkdf2.sha512.[password_hash]\n\nIf superusers is not set, this is a finding.\nIf a password is not set for the super user, this is a finding.'\n  desc 'fix', %q(Before proceeding, ensure a snapshot is taken to rollback if needed.\n\nAt the command line, run the following command to generate a grub password:\n\n# grub2-mkpasswd-pbkdf2\n\nEnter a secure password and ensure this password is stored for break-glass situations. Users will not be able to recover the root account without knowing this separate password. Copy the resulting encrypted string.\n\nAn example string is below:\n\ngrub.pbkdf2.sha512.10000.983A13DF3C51BB2B5130F0B86DDBF0DEA1AAF766BD1F16B7840F79CE3E35494C4B99F505C99C150071E563DF1D7FE1F45456D5960C4C79DAB6C49298B02A5558.5B2C49E12D43CC5A876F6738462DE4EFC24939D4BE486CDB72CFBCD87FDE93FBAFCB817E01B90F23E53C2502C3230502BC3113BE4F80B0AFC0EE956E735F7F86\n\nNote: The grub2 package must be installed to generate a password for grub.\n\nNavigate to and open:\n\n/boot/grub2/grub.cfg\n\nFind the line that begins with \"set rootpartition\". Below this line, paste the following on its own line:\n\nset superusers=\"root\"\n\nNote: The superusers name can be a value other than root and is not tied to an OS account.\n\nBelow this paste the following, substituting the user's own encrypted string from the steps above:\n\npassword_pbkdf2 root <YOUR-LONG-STRING-FROM-ABOVE>\n\nNext edit the default Photon menuentry block with the \"--unrestricted\" parameter so that it will continue to boot without prompting for credentials, for example:\n\nmenuentry \"Photon\" --unrestricted {\n    linux /boot/$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline audit=1\n    if [ -f /boot/$photon_initrd ]; then\n        initrd /boot/$photon_initrd\n    fi\n}\n\nWhen booting now, if users press \"e\" when the Photon splash screen appears, users will be prompted for credentials before being presented the option to edit the boot loader before system startup.\n\nNote: Photon does not support building grub changes via grub2-mkconfig.)\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62564r933531_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258824'\n  tag rid: 'SV-258824r933533_rule'\n  tag stig_id: 'PHTN-40-000046'\n  tag gtitle: 'SRG-OS-000080-GPOS-00048'\n  tag fix_id: 'F-62473r933532_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000213']\n  tag nist: ['AC-3']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258824.rb"},"title":"The Photon operating system must require authentication upon booting into single-user and maintenance modes.","desc":"If the system does not require authentication before it boots into single-user mode, anyone with console access to the system can trivially access all files on the system. GRUB2 is the boot loader for Photon OS and can be configured to require a password to boot into single-user mode or make modifications to the boot menu.\n\nNote: Photon does not support building grub changes via grub2-mkconfig.","descriptions":{"default":"If the system does not require authentication before it boots into single-user mode, anyone with console access to the system can trivially access all files on the system. GRUB2 is the boot loader for Photon OS and can be configured to require a password to boot into single-user mode or make modifications to the boot menu.\n\nNote: Photon does not support building grub changes via grub2-mkconfig.","check":"At the command line, run the following command to verify a password is required to edit the grub bootloader to boot into single-user mode:\n\n# grep -E \"^set\\ssuperusers|^password_pbkdf2\" /boot/grub2/grub.cfg\n\nExample output:\n\nset superusers=\"root\"\npassword_pbkdf2 root grub.pbkdf2.sha512.[password_hash]\n\nIf superusers is not set, this is a finding.\nIf a password is not set for the super user, this is a finding.","fix":"Before proceeding, ensure a snapshot is taken to rollback if needed.\n\nAt the command line, run the following command to generate a grub password:\n\n# grub2-mkpasswd-pbkdf2\n\nEnter a secure password and ensure this password is stored for break-glass situations. Users will not be able to recover the root account without knowing this separate password. Copy the resulting encrypted string.\n\nAn example string is below:\n\ngrub.pbkdf2.sha512.10000.983A13DF3C51BB2B5130F0B86DDBF0DEA1AAF766BD1F16B7840F79CE3E35494C4B99F505C99C150071E563DF1D7FE1F45456D5960C4C79DAB6C49298B02A5558.5B2C49E12D43CC5A876F6738462DE4EFC24939D4BE486CDB72CFBCD87FDE93FBAFCB817E01B90F23E53C2502C3230502BC3113BE4F80B0AFC0EE956E735F7F86\n\nNote: The grub2 package must be installed to generate a password for grub.\n\nNavigate to and open:\n\n/boot/grub2/grub.cfg\n\nFind the line that begins with \"set rootpartition\". Below this line, paste the following on its own line:\n\nset superusers=\"root\"\n\nNote: The superusers name can be a value other than root and is not tied to an OS account.\n\nBelow this paste the following, substituting the user's own encrypted string from the steps above:\n\npassword_pbkdf2 root <YOUR-LONG-STRING-FROM-ABOVE>\n\nNext edit the default Photon menuentry block with the \"--unrestricted\" parameter so that it will continue to boot without prompting for credentials, for example:\n\nmenuentry \"Photon\" --unrestricted {\n    linux /boot/$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline audit=1\n    if [ -f /boot/$photon_initrd ]; then\n        initrd /boot/$photon_initrd\n    fi\n}\n\nWhen booting now, if users press \"e\" when the Photon splash screen appears, users will be prompted for credentials before being presented the option to edit the boot loader before system startup.\n\nNote: Photon does not support building grub changes via grub2-mkconfig."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62564r933531_chk","severity":"medium","gid":"V-258824","rid":"SV-258824r933533_rule","stig_id":"PHTN-40-000046","gtitle":"SRG-OS-000080-GPOS-00048","fix_id":"F-62473r933532_fix","documentable":null,"cci":["CCI-000213"],"nist":["AC-3"]}},{"id":"SV-258825","code":"control 'SV-258825' do\n  title 'The Photon operating system must disable unnecessary kernel modules.'\n  desc 'It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.\n\n'\n  desc 'check', 'At the command line, run the following command to verify the following kernel modules are not loaded:\n\n# modprobe --showconfig | grep \"^install\" | grep \"/bin\"\n\nExpected result:\n\ninstall bridge /bin/false\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb_storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false\n\nThe output may include other statements outside of the expected result.\n\nIf the output does not include at least every statement in the expected result, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/modprobe.d/modprobe.conf\n\nSet the contents as follows:\n\ninstall bridge /bin/false\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb_storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62565r933534_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258825'\n  tag rid: 'SV-258825r933536_rule'\n  tag stig_id: 'PHTN-40-000047'\n  tag gtitle: 'SRG-OS-000095-GPOS-00049'\n  tag fix_id: 'F-62474r933535_fix'\n  tag satisfies: ['SRG-OS-000095-GPOS-00049', 'SRG-OS-000114-GPOS-00059']\n  tag 'documentable'\n  tag cci: ['CCI-000381', 'CCI-000778']\n  tag nist: ['CM-7 a', 'IA-3']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258825.rb"},"title":"The Photon operating system must disable unnecessary kernel modules.","desc":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.\n\n","descriptions":{"default":"It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.\n\nOperating systems are capable of providing a wide variety of functions and services. Some of the functions and services, provided by default, may not be necessary to support essential organizational operations (e.g., key missions, functions).\n\nExamples of nonessential capabilities include, but are not limited to, games, software packages, tools, and demonstration software, not related to requirements or providing a wide array of functionality not required for every mission, but which cannot be disabled.\n\n","check":"At the command line, run the following command to verify the following kernel modules are not loaded:\n\n# modprobe --showconfig | grep \"^install\" | grep \"/bin\"\n\nExpected result:\n\ninstall bridge /bin/false\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb_storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false\n\nThe output may include other statements outside of the expected result.\n\nIf the output does not include at least every statement in the expected result, this is a finding.","fix":"Navigate to and open:\n\n/etc/modprobe.d/modprobe.conf\n\nSet the contents as follows:\n\ninstall bridge /bin/false\ninstall sctp /bin/false\ninstall dccp /bin/false\ninstall dccp_ipv4 /bin/false\ninstall dccp_ipv6 /bin/false\ninstall ipx /bin/false\ninstall appletalk /bin/false\ninstall decnet /bin/false\ninstall rds /bin/false\ninstall tipc /bin/false\ninstall bluetooth /bin/false\ninstall usb_storage /bin/false\ninstall ieee1394 /bin/false\ninstall cramfs /bin/false\ninstall freevxfs /bin/false\ninstall jffs2 /bin/false\ninstall hfs /bin/false\ninstall hfsplus /bin/false\ninstall squashfs /bin/false\ninstall udf /bin/false"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62565r933534_chk","severity":"medium","gid":"V-258825","rid":"SV-258825r933536_rule","stig_id":"PHTN-40-000047","gtitle":"SRG-OS-000095-GPOS-00049","fix_id":"F-62474r933535_fix","satisfies":["SRG-OS-000095-GPOS-00049","SRG-OS-000114-GPOS-00059"],"documentable":null,"cci":["CCI-000381","CCI-000778"],"nist":["CM-7 a","IA-3"]}},{"id":"SV-258826","code":"control 'SV-258826' do\n  title 'The Photon operating system must not have duplicate User IDs (UIDs).'\n  desc 'To ensure accountability and prevent unauthenticated access, organizational users must be uniquely identified and authenticated to prevent potential misuse and provide for nonrepudiation.'\n  desc 'check', %q(At the command line, run the following command to verify there are no duplicate user IDs present:\n\n# awk -F \":\" 'list[$3]++{print $1, $3}' /etc/passwd\n\nIf any lines are returned, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/passwd\n\nConfigure each user account that has a duplicate UID with a unique UID.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62566r933537_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258826'\n  tag rid: 'SV-258826r933539_rule'\n  tag stig_id: 'PHTN-40-000049'\n  tag gtitle: 'SRG-OS-000104-GPOS-00051'\n  tag fix_id: 'F-62475r933538_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000764']\n  tag nist: ['IA-2']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258826.rb"},"title":"The Photon operating system must not have duplicate User IDs (UIDs).","desc":"To ensure accountability and prevent unauthenticated access, organizational users must be uniquely identified and authenticated to prevent potential misuse and provide for nonrepudiation.","descriptions":{"default":"To ensure accountability and prevent unauthenticated access, organizational users must be uniquely identified and authenticated to prevent potential misuse and provide for nonrepudiation.","check":"At the command line, run the following command to verify there are no duplicate user IDs present:\n\n# awk -F \":\" 'list[$3]++{print $1, $3}' /etc/passwd\n\nIf any lines are returned, this is a finding.","fix":"Navigate to and open:\n\n/etc/passwd\n\nConfigure each user account that has a duplicate UID with a unique UID."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62566r933537_chk","severity":"medium","gid":"V-258826","rid":"SV-258826r933539_rule","stig_id":"PHTN-40-000049","gtitle":"SRG-OS-000104-GPOS-00051","fix_id":"F-62475r933538_fix","documentable":null,"cci":["CCI-000764"],"nist":["IA-2"]}},{"id":"SV-258827","code":"control 'SV-258827' do\n  title 'The Photon operating system must use mechanisms meeting the requirements of applicable federal laws, Executive orders, directives, policies, regulations, standards, and guidance for authentication to a cryptographic module.'\n  desc 'Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DOD data may be compromised.\n\nOperating systems utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2/140-3 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DOD requirements. This allows for Security Levels 1, 2, 3, or 4 for use on a general purpose computing system.'\n  desc 'check', 'At the command line, run the following command to verify system-password is configured to encrypt representations of passwords:\n\n# grep sha512 /etc/pam.d/system-password\n\nExample result:\n\npassword required pam_unix.so sha512 shadow use_authtok\n\nIf the \"pam_unix.so\" module is not configured with the \"sha512\" parameter, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nAdd or update the following line:\n\npassword required pam_unix.so sha512 shadow use_authtok'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62567r933540_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258827'\n  tag rid: 'SV-258827r933542_rule'\n  tag stig_id: 'PHTN-40-000059'\n  tag gtitle: 'SRG-OS-000120-GPOS-00061'\n  tag fix_id: 'F-62476r933541_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000803']\n  tag nist: ['IA-7']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258827.rb"},"title":"The Photon operating system must use mechanisms meeting the requirements of applicable federal laws, Executive orders, directives, policies, regulations, standards, and guidance for authentication to a cryptographic module.","desc":"Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DOD data may be compromised.\n\nOperating systems utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2/140-3 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DOD requirements. This allows for Security Levels 1, 2, 3, or 4 for use on a general purpose computing system.","descriptions":{"default":"Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DOD data may be compromised.\n\nOperating systems utilizing encryption are required to use FIPS-compliant mechanisms for authenticating to cryptographic modules.\n\nFIPS 140-2/140-3 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meets DOD requirements. This allows for Security Levels 1, 2, 3, or 4 for use on a general purpose computing system.","check":"At the command line, run the following command to verify system-password is configured to encrypt representations of passwords:\n\n# grep sha512 /etc/pam.d/system-password\n\nExample result:\n\npassword required pam_unix.so sha512 shadow use_authtok\n\nIf the \"pam_unix.so\" module is not configured with the \"sha512\" parameter, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nAdd or update the following line:\n\npassword required pam_unix.so sha512 shadow use_authtok"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62567r933540_chk","severity":"medium","gid":"V-258827","rid":"SV-258827r933542_rule","stig_id":"PHTN-40-000059","gtitle":"SRG-OS-000120-GPOS-00061","fix_id":"F-62476r933541_fix","documentable":null,"cci":["CCI-000803"],"nist":["IA-7"]}},{"id":"SV-258828","code":"control 'SV-258828' do\n  title 'The Photon operating system must restrict access to the kernel message buffer.'\n  desc 'Restricting access to the kernel message buffer limits access only to root. This prevents attackers from gaining additional system information as a nonprivileged user.'\n  desc 'check', 'At the command line, run the following command to verify kernel message buffer restrictions are enabled:\n\n# /sbin/sysctl kernel.dmesg_restrict\n\nExample result:\n\nkernel.dmesg_restrict = 1\n\nIf the \"kernel.dmesg_restrict\" kernel parameter is not set to \"1\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nkernel.dmesg_restrict = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62568r933543_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258828'\n  tag rid: 'SV-258828r933545_rule'\n  tag stig_id: 'PHTN-40-000067'\n  tag gtitle: 'SRG-OS-000138-GPOS-00069'\n  tag fix_id: 'F-62477r933544_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001090']\n  tag nist: ['SC-4']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258828.rb"},"title":"The Photon operating system must restrict access to the kernel message buffer.","desc":"Restricting access to the kernel message buffer limits access only to root. This prevents attackers from gaining additional system information as a nonprivileged user.","descriptions":{"default":"Restricting access to the kernel message buffer limits access only to root. This prevents attackers from gaining additional system information as a nonprivileged user.","check":"At the command line, run the following command to verify kernel message buffer restrictions are enabled:\n\n# /sbin/sysctl kernel.dmesg_restrict\n\nExample result:\n\nkernel.dmesg_restrict = 1\n\nIf the \"kernel.dmesg_restrict\" kernel parameter is not set to \"1\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nkernel.dmesg_restrict = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62568r933543_chk","severity":"medium","gid":"V-258828","rid":"SV-258828r933545_rule","stig_id":"PHTN-40-000067","gtitle":"SRG-OS-000138-GPOS-00069","fix_id":"F-62477r933544_fix","documentable":null,"cci":["CCI-001090"],"nist":["SC-4"]}},{"id":"SV-258829","code":"control 'SV-258829' do\n  title 'The Photon operating system must be configured to use TCP syncookies.'\n  desc \"A TCP SYN flood attack can cause a Denial of Service (DOS) by filling a system's TCP connection table with connections in the SYN_RCVD state. Syncookies can be used to track a connection when a subsequent ACK is received, verifying the initiator is attempting a valid connection and is not a flood source. This feature is activated when a flood condition is detected and enables the system to continue servicing valid connection requests.\n\n\"\n  desc 'check', 'At the command line, run the following command to verify TCP syncookies are enabled:\n\n# /sbin/sysctl net.ipv4.tcp_syncookies\n\nExample result:\n\nnet.ipv4.tcp_syncookies = 1\n\nIf \"net.ipv4.tcp_syncookies\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nnet.ipv4.tcp_syncookies = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62569r933546_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258829'\n  tag rid: 'SV-258829r933548_rule'\n  tag stig_id: 'PHTN-40-000068'\n  tag gtitle: 'SRG-OS-000142-GPOS-00071'\n  tag fix_id: 'F-62478r933547_fix'\n  tag satisfies: ['SRG-OS-000142-GPOS-00071', 'SRG-OS-000420-GPOS-00186']\n  tag 'documentable'\n  tag cci: ['CCI-001095', 'CCI-002385']\n  tag nist: ['SC-5 (2)', 'SC-5 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258829.rb"},"title":"The Photon operating system must be configured to use TCP syncookies.","desc":"A TCP SYN flood attack can cause a Denial of Service (DOS) by filling a system's TCP connection table with connections in the SYN_RCVD state. Syncookies can be used to track a connection when a subsequent ACK is received, verifying the initiator is attempting a valid connection and is not a flood source. This feature is activated when a flood condition is detected and enables the system to continue servicing valid connection requests.\n\n","descriptions":{"default":"A TCP SYN flood attack can cause a Denial of Service (DOS) by filling a system's TCP connection table with connections in the SYN_RCVD state. Syncookies can be used to track a connection when a subsequent ACK is received, verifying the initiator is attempting a valid connection and is not a flood source. This feature is activated when a flood condition is detected and enables the system to continue servicing valid connection requests.\n\n","check":"At the command line, run the following command to verify TCP syncookies are enabled:\n\n# /sbin/sysctl net.ipv4.tcp_syncookies\n\nExample result:\n\nnet.ipv4.tcp_syncookies = 1\n\nIf \"net.ipv4.tcp_syncookies\" is not set to \"1\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nnet.ipv4.tcp_syncookies = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62569r933546_chk","severity":"medium","gid":"V-258829","rid":"SV-258829r933548_rule","stig_id":"PHTN-40-000068","gtitle":"SRG-OS-000142-GPOS-00071","fix_id":"F-62478r933547_fix","satisfies":["SRG-OS-000142-GPOS-00071","SRG-OS-000420-GPOS-00186"],"documentable":null,"cci":["CCI-001095","CCI-002385"],"nist":["SC-5 (2)","SC-5 a"]}},{"id":"SV-258830","code":"control 'SV-258830' do\n  title 'The Photon operating system must terminate idle Secure Shell (SSH) sessions after 15 minutes.'\n  desc 'Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. \n\nTerminating network connections associated with communications sessions includes, for example, deallocating associated TCP/IP address/port pairs at the operating system level, and deallocating networking assignments at the application level if multiple application sessions are using a single operating system-level network connection. This does not mean that the operating system terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.\n\n'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i ClientAliveInterval\n\nExample result:\n\nClientAliveInterval 900\n\nIf there is no output or if \"ClientAliveInterval\" is not set to \"900\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"ClientAliveInterval\" line is uncommented and set to the following:\n\nClientAliveInterval 900\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62570r933549_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258830'\n  tag rid: 'SV-258830r933551_rule'\n  tag stig_id: 'PHTN-40-000069'\n  tag gtitle: 'SRG-OS-000163-GPOS-00072'\n  tag fix_id: 'F-62479r933550_fix'\n  tag satisfies: ['SRG-OS-000163-GPOS-00072', 'SRG-OS-000395-GPOS-00175']\n  tag 'documentable'\n  tag cci: ['CCI-001133', 'CCI-002891']\n  tag nist: ['SC-10', 'MA-4 (7)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258830.rb"},"title":"The Photon operating system must terminate idle Secure Shell (SSH) sessions after 15 minutes.","desc":"Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. \n\nTerminating network connections associated with communications sessions includes, for example, deallocating associated TCP/IP address/port pairs at the operating system level, and deallocating networking assignments at the application level if multiple application sessions are using a single operating system-level network connection. This does not mean that the operating system terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.\n\n","descriptions":{"default":"Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element. \n\nTerminating network connections associated with communications sessions includes, for example, deallocating associated TCP/IP address/port pairs at the operating system level, and deallocating networking assignments at the application level if multiple application sessions are using a single operating system-level network connection. This does not mean that the operating system terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.\n\n","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i ClientAliveInterval\n\nExample result:\n\nClientAliveInterval 900\n\nIf there is no output or if \"ClientAliveInterval\" is not set to \"900\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"ClientAliveInterval\" line is uncommented and set to the following:\n\nClientAliveInterval 900\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62570r933549_chk","severity":"medium","gid":"V-258830","rid":"SV-258830r933551_rule","stig_id":"PHTN-40-000069","gtitle":"SRG-OS-000163-GPOS-00072","fix_id":"F-62479r933550_fix","satisfies":["SRG-OS-000163-GPOS-00072","SRG-OS-000395-GPOS-00175"],"documentable":null,"cci":["CCI-001133","CCI-002891"],"nist":["SC-10","MA-4 (7)"]}},{"id":"SV-258831","code":"control 'SV-258831' do\n  title 'The Photon operating system /var/log directory must be restricted.'\n  desc 'Any operating system providing too much information in error messages risks compromising the data and security of the structure, and content of error messages needs to be carefully considered by the organization.\n\nOrganizations carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, erroneous logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers.'\n  desc 'check', 'At the command line, run the following command to verify permissions on the /var/log directory:\n\n# stat -c \"%n is owned by %U and group owned by %G with permissions of %a\" /var/log\n\nExpected result:\n\n/var/log is owned by root and group owned by root with permissions of 755\n\nIf the /var/log directory is not owned by root, this is a finding.\nIf the /var/log directory is not group owned by root, this is a finding.\nIf the /var/log directory permissions are not set to 0755 or less, this is a finding.'\n  desc 'fix', 'At the command line, run the following commands:\n\n# chown root:root /var/log\n# chmod 0755 /var/log'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62571r933552_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258831'\n  tag rid: 'SV-258831r933554_rule'\n  tag stig_id: 'PHTN-40-000073'\n  tag gtitle: 'SRG-OS-000205-GPOS-00083'\n  tag fix_id: 'F-62480r933553_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001312']\n  tag nist: ['SI-11 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258831.rb"},"title":"The Photon operating system /var/log directory must be restricted.","desc":"Any operating system providing too much information in error messages risks compromising the data and security of the structure, and content of error messages needs to be carefully considered by the organization.\n\nOrganizations carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, erroneous logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers.","descriptions":{"default":"Any operating system providing too much information in error messages risks compromising the data and security of the structure, and content of error messages needs to be carefully considered by the organization.\n\nOrganizations carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, erroneous logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers.","check":"At the command line, run the following command to verify permissions on the /var/log directory:\n\n# stat -c \"%n is owned by %U and group owned by %G with permissions of %a\" /var/log\n\nExpected result:\n\n/var/log is owned by root and group owned by root with permissions of 755\n\nIf the /var/log directory is not owned by root, this is a finding.\nIf the /var/log directory is not group owned by root, this is a finding.\nIf the /var/log directory permissions are not set to 0755 or less, this is a finding.","fix":"At the command line, run the following commands:\n\n# chown root:root /var/log\n# chmod 0755 /var/log"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62571r933552_chk","severity":"medium","gid":"V-258831","rid":"SV-258831r933554_rule","stig_id":"PHTN-40-000073","gtitle":"SRG-OS-000205-GPOS-00083","fix_id":"F-62480r933553_fix","documentable":null,"cci":["CCI-001312"],"nist":["SI-11 a"]}},{"id":"SV-258832","code":"control 'SV-258832' do\n  title 'The Photon operating system must reveal error messages only to authorized users.'\n  desc \"Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.\"\n  desc 'check', %q(If another package is used to offload logs, such as syslog-ng, and is properly configured, this is not applicable.\n\nAt the command line, run the following command to verify rsyslog generates log files that are not world readable:\n\n# grep '^\\$umask' /etc/rsyslog.conf\n\nExample result:\n\n$umask 0037\n\nIf \"$umask\" is not set to \"0037\" or more restrictive, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/rsyslog.conf\n\nAdd or update the following line:\n\n$umask 0037\n\nAt the command line, run the following command:\n\n# systemctl restart rsyslog.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62572r933555_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258832'\n  tag rid: 'SV-258832r933557_rule'\n  tag stig_id: 'PHTN-40-000074'\n  tag gtitle: 'SRG-OS-000206-GPOS-00084'\n  tag fix_id: 'F-62481r933556_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001314']\n  tag nist: ['SI-11 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258832.rb"},"title":"The Photon operating system must reveal error messages only to authorized users.","desc":"Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.","descriptions":{"default":"Only authorized personnel should be aware of errors and the details of the errors. Error messages are an indicator of an organization's operational state or can identify the operating system or platform. Additionally, Personally Identifiable Information (PII) and operational information must not be revealed through error messages to unauthorized personnel or their designated representatives.","check":"If another package is used to offload logs, such as syslog-ng, and is properly configured, this is not applicable.\n\nAt the command line, run the following command to verify rsyslog generates log files that are not world readable:\n\n# grep '^\\$umask' /etc/rsyslog.conf\n\nExample result:\n\n$umask 0037\n\nIf \"$umask\" is not set to \"0037\" or more restrictive, this is a finding.","fix":"Navigate to and open:\n\n/etc/rsyslog.conf\n\nAdd or update the following line:\n\n$umask 0037\n\nAt the command line, run the following command:\n\n# systemctl restart rsyslog.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62572r933555_chk","severity":"medium","gid":"V-258832","rid":"SV-258832r933557_rule","stig_id":"PHTN-40-000074","gtitle":"SRG-OS-000206-GPOS-00084","fix_id":"F-62481r933556_fix","documentable":null,"cci":["CCI-001314"],"nist":["SI-11 b"]}},{"id":"SV-258833","code":"control 'SV-258833' do\n  title 'The Photon operating system must audit all account modifications.'\n  desc 'Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes. \n\nTo address access requirements, many operating systems can be integrated with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.'\n  desc 'check', 'At the command line, run the following command to verify an audit rule exists to audit account modifications:\n\n# auditctl -l | grep -E \"(usermod|groupmod)\"\n\nExample result:\n\n-w /usr/sbin/usermod -p x -k usermod\n-w /usr/sbin/groupmod -p x -k groupmod\n\nIf either \"usermod\" or \"groupmod\" are not listed with a permissions filter of at least \"x\", this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /usr/sbin/usermod -p x -k usermod\n-w /usr/sbin/groupmod -p x -k groupmod\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62573r933558_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258833'\n  tag rid: 'SV-258833r933560_rule'\n  tag stig_id: 'PHTN-40-000076'\n  tag gtitle: 'SRG-OS-000239-GPOS-00089'\n  tag fix_id: 'F-62482r933559_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001403']\n  tag nist: ['AC-2 (4)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258833.rb"},"title":"The Photon operating system must audit all account modifications.","desc":"Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes. \n\nTo address access requirements, many operating systems can be integrated with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.","descriptions":{"default":"Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes. \n\nTo address access requirements, many operating systems can be integrated with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.","check":"At the command line, run the following command to verify an audit rule exists to audit account modifications:\n\n# auditctl -l | grep -E \"(usermod|groupmod)\"\n\nExample result:\n\n-w /usr/sbin/usermod -p x -k usermod\n-w /usr/sbin/groupmod -p x -k groupmod\n\nIf either \"usermod\" or \"groupmod\" are not listed with a permissions filter of at least \"x\", this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.","fix":"Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /usr/sbin/usermod -p x -k usermod\n-w /usr/sbin/groupmod -p x -k groupmod\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62573r933558_chk","severity":"medium","gid":"V-258833","rid":"SV-258833r933560_rule","stig_id":"PHTN-40-000076","gtitle":"SRG-OS-000239-GPOS-00089","fix_id":"F-62482r933559_fix","documentable":null,"cci":["CCI-001403"],"nist":["AC-2 (4)"]}},{"id":"SV-258834","code":"control 'SV-258834' do\n  title 'The Photon operating system must audit all account removal actions.'\n  desc 'When operating system accounts are removed, user accessibility is affected. Accounts are utilized for identifying individual users or for identifying the operating system processes themselves. In order to detect and respond to events affecting user accessibility and system processing, operating systems must audit account removal actions and, as required, notify the appropriate individuals so they can investigate the event. Such a capability greatly reduces the risk that operating system accessibility will be negatively affected for extended periods of time and provides logging that can be used for forensic purposes.'\n  desc 'check', 'At the command line, run the following command to verify an audit rule exists to audit account removals:\n\n# auditctl -l | grep -E \"(userdel|groupdel)\"\n\nExample result:\n\n-w /usr/sbin/userdel -p x -k userdel\n-w /usr/sbin/groupdel -p x -k groupdel\n\nIf either \"userdel\" or \"groupdel\" are not listed with a permissions filter of at least \"x\", this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /usr/sbin/userdel -p x -k userdel\n-w /usr/sbin/groupdel -p x -k groupdel\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62574r933561_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258834'\n  tag rid: 'SV-258834r933563_rule'\n  tag stig_id: 'PHTN-40-000078'\n  tag gtitle: 'SRG-OS-000241-GPOS-00091'\n  tag fix_id: 'F-62483r933562_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001405']\n  tag nist: ['AC-2 (4)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258834.rb"},"title":"The Photon operating system must audit all account removal actions.","desc":"When operating system accounts are removed, user accessibility is affected. Accounts are utilized for identifying individual users or for identifying the operating system processes themselves. In order to detect and respond to events affecting user accessibility and system processing, operating systems must audit account removal actions and, as required, notify the appropriate individuals so they can investigate the event. Such a capability greatly reduces the risk that operating system accessibility will be negatively affected for extended periods of time and provides logging that can be used for forensic purposes.","descriptions":{"default":"When operating system accounts are removed, user accessibility is affected. Accounts are utilized for identifying individual users or for identifying the operating system processes themselves. In order to detect and respond to events affecting user accessibility and system processing, operating systems must audit account removal actions and, as required, notify the appropriate individuals so they can investigate the event. Such a capability greatly reduces the risk that operating system accessibility will be negatively affected for extended periods of time and provides logging that can be used for forensic purposes.","check":"At the command line, run the following command to verify an audit rule exists to audit account removals:\n\n# auditctl -l | grep -E \"(userdel|groupdel)\"\n\nExample result:\n\n-w /usr/sbin/userdel -p x -k userdel\n-w /usr/sbin/groupdel -p x -k groupdel\n\nIf either \"userdel\" or \"groupdel\" are not listed with a permissions filter of at least \"x\", this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.","fix":"Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /usr/sbin/userdel -p x -k userdel\n-w /usr/sbin/groupdel -p x -k groupdel\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62574r933561_chk","severity":"medium","gid":"V-258834","rid":"SV-258834r933563_rule","stig_id":"PHTN-40-000078","gtitle":"SRG-OS-000241-GPOS-00091","fix_id":"F-62483r933562_fix","documentable":null,"cci":["CCI-001405"],"nist":["AC-2 (4)"]}},{"id":"SV-258835","code":"control 'SV-258835' do\n  title 'The Photon operating system must implement only approved ciphers to protect the integrity of remote access sessions.'\n  desc 'Without cryptographic integrity protections, information can be altered by unauthorized users without detection.\n\nRemote access (e.g., RDP) is access to DOD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nCryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i Ciphers\n\nExpected result:\n\nciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n\nIf the output matches the ciphers in the expected result or a subset thereof, this is not a finding.\n\nIf the ciphers in the output contain any ciphers not listed in the expected result, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"Ciphers\" line is uncommented and set to the following:\n\nCiphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62575r933564_chk'\n  tag severity: 'high'\n  tag gid: 'V-258835'\n  tag rid: 'SV-258835r933566_rule'\n  tag stig_id: 'PHTN-40-000079'\n  tag gtitle: 'SRG-OS-000250-GPOS-00093'\n  tag fix_id: 'F-62484r933565_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001453']\n  tag nist: ['AC-17 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258835.rb"},"title":"The Photon operating system must implement only approved ciphers to protect the integrity of remote access sessions.","desc":"Without cryptographic integrity protections, information can be altered by unauthorized users without detection.\n\nRemote access (e.g., RDP) is access to DOD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nCryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash.","descriptions":{"default":"Without cryptographic integrity protections, information can be altered by unauthorized users without detection.\n\nRemote access (e.g., RDP) is access to DOD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nCryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i Ciphers\n\nExpected result:\n\nciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n\nIf the output matches the ciphers in the expected result or a subset thereof, this is not a finding.\n\nIf the ciphers in the output contain any ciphers not listed in the expected result, this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"Ciphers\" line is uncommented and set to the following:\n\nCiphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62575r933564_chk","severity":"high","gid":"V-258835","rid":"SV-258835r933566_rule","stig_id":"PHTN-40-000079","gtitle":"SRG-OS-000250-GPOS-00093","fix_id":"F-62484r933565_fix","documentable":null,"cci":["CCI-001453"],"nist":["AC-17 (2)"]}},{"id":"SV-258836","code":"control 'SV-258836' do\n  title 'The Photon operating system must initiate session audits at system startup.'\n  desc 'If auditing is enabled late in the startup process, the actions of some startup processes may not be audited. Some audit systems also maintain state information only available if auditing is enabled before a given process is created.'\n  desc 'check', %q(At the command line, run the following command to verify auditing is enabled at startup:\n\n# grep 'audit' /proc/cmdline\n\nExample result:\n\nBOOT_IMAGE=/boot/vmlinuz-5.10.109-2.ph4-esx root=PARTUUID=6e6293c6-9ab6-49e9-aa97-9b212f2e037a init=/lib/systemd/systemd rcupdate.rcu_expedited=1 rw systemd.show_status=1 quiet noreplace-smp cpu_init_udelay=0 plymouth.enable=0 systemd.legacy_systemd_cgroup_controller=yes audit=1\n\nIf the \"audit\" parameter is not present with a value of \"1\", this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/boot/grub2/grub.cfg\n\nLocate the boot command line arguments. An example follows:\n\nlinux /boot/$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline\n\nAdd \"audit=1\" to the end of the line so it reads as follows:\n\nlinux /boot/$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline audit=1\n\nNote: Do not copy/paste in this example argument line. This may change in future releases. Find the similar line and append \"audit=1\" to it.\n\nReboot the system for the change to take effect.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62576r933567_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258836'\n  tag rid: 'SV-258836r933569_rule'\n  tag stig_id: 'PHTN-40-000080'\n  tag gtitle: 'SRG-OS-000254-GPOS-00095'\n  tag fix_id: 'F-62485r933568_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001464']\n  tag nist: ['AU-14 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258836.rb"},"title":"The Photon operating system must initiate session audits at system startup.","desc":"If auditing is enabled late in the startup process, the actions of some startup processes may not be audited. Some audit systems also maintain state information only available if auditing is enabled before a given process is created.","descriptions":{"default":"If auditing is enabled late in the startup process, the actions of some startup processes may not be audited. Some audit systems also maintain state information only available if auditing is enabled before a given process is created.","check":"At the command line, run the following command to verify auditing is enabled at startup:\n\n# grep 'audit' /proc/cmdline\n\nExample result:\n\nBOOT_IMAGE=/boot/vmlinuz-5.10.109-2.ph4-esx root=PARTUUID=6e6293c6-9ab6-49e9-aa97-9b212f2e037a init=/lib/systemd/systemd rcupdate.rcu_expedited=1 rw systemd.show_status=1 quiet noreplace-smp cpu_init_udelay=0 plymouth.enable=0 systemd.legacy_systemd_cgroup_controller=yes audit=1\n\nIf the \"audit\" parameter is not present with a value of \"1\", this is a finding.","fix":"Navigate to and open:\n\n/boot/grub2/grub.cfg\n\nLocate the boot command line arguments. An example follows:\n\nlinux /boot/$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline\n\nAdd \"audit=1\" to the end of the line so it reads as follows:\n\nlinux /boot/$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline audit=1\n\nNote: Do not copy/paste in this example argument line. This may change in future releases. Find the similar line and append \"audit=1\" to it.\n\nReboot the system for the change to take effect."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62576r933567_chk","severity":"medium","gid":"V-258836","rid":"SV-258836r933569_rule","stig_id":"PHTN-40-000080","gtitle":"SRG-OS-000254-GPOS-00095","fix_id":"F-62485r933568_fix","documentable":null,"cci":["CCI-001464"],"nist":["AU-14 (1)"]}},{"id":"SV-258837","code":"control 'SV-258837' do\n  title 'The Photon operating system must protect audit tools from unauthorized access.'\n  desc 'Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.\n\n'\n  desc 'check', 'At the command line, run the following command to verify permissions on audit tools:\n\n# stat -c \"%n is owned by %U and group owned by %G and permissions are %a\" /usr/sbin/audispd /usr/sbin/auditctl /usr/sbin/auditd /usr/sbin/aureport /usr/sbin/ausearch /usr/sbin/autrace /usr/sbin/augenrules\n\nExpected result:\n\n/usr/sbin/audispd is owned by root and group owned by root and permissions are 750\n/usr/sbin/auditctl is owned by root and group owned by root and permissions are 755\n/usr/sbin/auditd is owned by root and group owned by root and permissions are 755\n/usr/sbin/aureport is owned by root and group owned by root and permissions are 755\n/usr/sbin/ausearch is owned by root and group owned by root and permissions are 755\n/usr/sbin/autrace is owned by root and group owned by root and permissions are 755\n/usr/sbin/augenrules is owned by root and group owned by root and permissions are 750\n\nIf any file is not owned by root or group owned by root or permissions are more permissive than listed above, this is a finding.'\n  desc 'fix', 'At the command line, run the following commands for each file returned:\n\n# chown root:root <file>\n# chmod 750 <file>\n\nNote: Update permissions to match the target file as listed in the check text.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62577r933570_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258837'\n  tag rid: 'SV-258837r933572_rule'\n  tag stig_id: 'PHTN-40-000082'\n  tag gtitle: 'SRG-OS-000256-GPOS-00097'\n  tag fix_id: 'F-62486r933571_fix'\n  tag satisfies: ['SRG-OS-000256-GPOS-00097', 'SRG-OS-000257-GPOS-00098', 'SRG-OS-000258-GPOS-00099']\n  tag 'documentable'\n  tag cci: ['CCI-001493', 'CCI-001494', 'CCI-001495']\n  tag nist: ['AU-9 a', 'AU-9', 'AU-9']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258837.rb"},"title":"The Photon operating system must protect audit tools from unauthorized access.","desc":"Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.\n\n","descriptions":{"default":"Protecting audit information also includes identifying and protecting the tools used to view and manipulate log data. Therefore, protecting audit tools is necessary to prevent unauthorized operation on audit information.\n\nOperating systems providing tools to interface with audit information will leverage user permissions and roles identifying the user accessing the tools and the corresponding rights the user enjoys in order to make access decisions regarding the access to audit tools.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.\n\n","check":"At the command line, run the following command to verify permissions on audit tools:\n\n# stat -c \"%n is owned by %U and group owned by %G and permissions are %a\" /usr/sbin/audispd /usr/sbin/auditctl /usr/sbin/auditd /usr/sbin/aureport /usr/sbin/ausearch /usr/sbin/autrace /usr/sbin/augenrules\n\nExpected result:\n\n/usr/sbin/audispd is owned by root and group owned by root and permissions are 750\n/usr/sbin/auditctl is owned by root and group owned by root and permissions are 755\n/usr/sbin/auditd is owned by root and group owned by root and permissions are 755\n/usr/sbin/aureport is owned by root and group owned by root and permissions are 755\n/usr/sbin/ausearch is owned by root and group owned by root and permissions are 755\n/usr/sbin/autrace is owned by root and group owned by root and permissions are 755\n/usr/sbin/augenrules is owned by root and group owned by root and permissions are 750\n\nIf any file is not owned by root or group owned by root or permissions are more permissive than listed above, this is a finding.","fix":"At the command line, run the following commands for each file returned:\n\n# chown root:root <file>\n# chmod 750 <file>\n\nNote: Update permissions to match the target file as listed in the check text."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62577r933570_chk","severity":"medium","gid":"V-258837","rid":"SV-258837r933572_rule","stig_id":"PHTN-40-000082","gtitle":"SRG-OS-000256-GPOS-00097","fix_id":"F-62486r933571_fix","satisfies":["SRG-OS-000256-GPOS-00097","SRG-OS-000257-GPOS-00098","SRG-OS-000258-GPOS-00099"],"documentable":null,"cci":["CCI-001493","CCI-001494","CCI-001495"],"nist":["AU-9 a","AU-9","AU-9"]}},{"id":"SV-258838","code":"control 'SV-258838' do\n  title 'The Photon operating system must enforce password complexity by requiring that at least one special character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nSpecial characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.'\n  desc 'check', %q(At the command line, run the following command to verify at least one special character be used:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"ocredit\" option is not < 0, is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"ocredit\" option set to \"-1\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62578r933573_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258838'\n  tag rid: 'SV-258838r933575_rule'\n  tag stig_id: 'PHTN-40-000086'\n  tag gtitle: 'SRG-OS-000266-GPOS-00101'\n  tag fix_id: 'F-62487r933574_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001619']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258838.rb"},"title":"The Photon operating system must enforce password complexity by requiring that at least one special character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nSpecial characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity or strength is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor in determining how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nSpecial characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.","check":"At the command line, run the following command to verify at least one special character be used:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"ocredit\" option is not < 0, is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"ocredit\" option set to \"-1\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62578r933573_chk","severity":"medium","gid":"V-258838","rid":"SV-258838r933575_rule","stig_id":"PHTN-40-000086","gtitle":"SRG-OS-000266-GPOS-00101","fix_id":"F-62487r933574_fix","documentable":null,"cci":["CCI-001619"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-258839","code":"control 'SV-258839' do\n  title 'The Photon operating system must use cryptographic mechanisms to protect the integrity of audit tools.'\n  desc 'Protecting the integrity of the tools used for auditing purposes is a critical step toward ensuring the integrity of audit information. Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.\n\nIt is not uncommon for attackers to replace the audit tools or inject code into the existing tools with the purpose of providing the capability to hide or erase system activity from the audit logs.\n\nTo address this risk, audit tools must be cryptographically signed in order to provide the capability to identify when the audit tools have been modified, manipulated, or replaced. An example is a checksum hash of the file or files.'\n  desc 'check', 'Use the verification capability of rpm to check the MD5 hashes of the audit files on disk versus the expected ones from the installation package.\n\nAt the command line, run the following command:\n\n# rpm -V audit | grep \"^..5\"\n\nExample output:\n\nS.5....T.  c /etc/audit/auditd.conf\n\nIf there is any output for files that are not configuration files, this is a finding.'\n  desc 'fix', 'If the audit system binaries have been altered investigate the cause and then reinstall the audit package to restore the integrity of the package.\n\nIf performed on a VMware reinstalling the audit tools is not supported. The appliance should be restored from a backup or redeployed once the root cause is remediated.'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62579r933576_chk'\n  tag severity: 'high'\n  tag gid: 'V-258839'\n  tag rid: 'SV-258839r933578_rule'\n  tag stig_id: 'PHTN-40-000092'\n  tag gtitle: 'SRG-OS-000278-GPOS-00108'\n  tag fix_id: 'F-62488r933577_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001496']\n  tag nist: ['AU-9 (3)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258839.rb"},"title":"The Photon operating system must use cryptographic mechanisms to protect the integrity of audit tools.","desc":"Protecting the integrity of the tools used for auditing purposes is a critical step toward ensuring the integrity of audit information. Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.\n\nIt is not uncommon for attackers to replace the audit tools or inject code into the existing tools with the purpose of providing the capability to hide or erase system activity from the audit logs.\n\nTo address this risk, audit tools must be cryptographically signed in order to provide the capability to identify when the audit tools have been modified, manipulated, or replaced. An example is a checksum hash of the file or files.","descriptions":{"default":"Protecting the integrity of the tools used for auditing purposes is a critical step toward ensuring the integrity of audit information. Audit information includes all information (e.g., audit records, audit settings, and audit reports) needed to successfully audit information system activity.\n\nAudit tools include, but are not limited to, vendor-provided and open source audit tools needed to successfully view and manipulate audit information system activity and records. Audit tools include custom queries and report generators.\n\nIt is not uncommon for attackers to replace the audit tools or inject code into the existing tools with the purpose of providing the capability to hide or erase system activity from the audit logs.\n\nTo address this risk, audit tools must be cryptographically signed in order to provide the capability to identify when the audit tools have been modified, manipulated, or replaced. An example is a checksum hash of the file or files.","check":"Use the verification capability of rpm to check the MD5 hashes of the audit files on disk versus the expected ones from the installation package.\n\nAt the command line, run the following command:\n\n# rpm -V audit | grep \"^..5\"\n\nExample output:\n\nS.5....T.  c /etc/audit/auditd.conf\n\nIf there is any output for files that are not configuration files, this is a finding.","fix":"If the audit system binaries have been altered investigate the cause and then reinstall the audit package to restore the integrity of the package.\n\nIf performed on a VMware reinstalling the audit tools is not supported. The appliance should be restored from a backup or redeployed once the root cause is remediated."},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62579r933576_chk","severity":"high","gid":"V-258839","rid":"SV-258839r933578_rule","stig_id":"PHTN-40-000092","gtitle":"SRG-OS-000278-GPOS-00108","fix_id":"F-62488r933577_fix","documentable":null,"cci":["CCI-001496"],"nist":["AU-9 (3)"]}},{"id":"SV-258840","code":"control 'SV-258840' do\n  title 'The operating system must automatically terminate a user session after inactivity time-outs have expired.'\n  desc \"Automatic session termination addresses the termination of user-initiated logical sessions in contrast to the termination of network connections that are associated with communications sessions (i.e., network disconnect). A logical session (for local, network, and remote access) is initiated whenever a user (or process acting on behalf of a user) accesses an organizational information system. Such user sessions can be terminated (and thus terminate user access) without terminating network sessions.\n\nSession termination terminates all processes associated with a user's logical session except those processes that are specifically created by the user (i.e., session owner) to continue after the session is terminated.\n\nConditions or trigger events requiring automatic session termination can include, for example, organization-defined periods of user inactivity, targeted responses to certain types of incidents, and time-of-day restrictions on information system use.\n\nThis capability is typically reserved for specific operating system functionality where the system owner, data owner, or organization requires additional assurance.\n\n\"\n  desc 'check', 'At the command line, run the following command:\n\n# grep -E \"TMOUT=900\" /etc/bash.bashrc /etc/profile.d/*\n\nExample result:\n\n/etc/profile.d/tmout.sh:TMOUT=900\n\nIf the \"TMOUT\" environmental variable is not set, the value is more than \"900\", or is set to \"0\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/profile.d/tmout.sh\n\nSet its content to the following: \n\nTMOUT=900\nreadonly TMOUT \nexport TMOUT\nmesg n 2>/dev/null'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62580r933579_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258840'\n  tag rid: 'SV-258840r933581_rule'\n  tag stig_id: 'PHTN-40-000093'\n  tag gtitle: 'SRG-OS-000279-GPOS-00109'\n  tag fix_id: 'F-62489r933580_fix'\n  tag satisfies: ['SRG-OS-000279-GPOS-00109', 'SRG-OS-000126-GPOS-00066']\n  tag 'documentable'\n  tag cci: ['CCI-000879', 'CCI-002361']\n  tag nist: ['MA-4 e', 'AC-12']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258840.rb"},"title":"The operating system must automatically terminate a user session after inactivity time-outs have expired.","desc":"Automatic session termination addresses the termination of user-initiated logical sessions in contrast to the termination of network connections that are associated with communications sessions (i.e., network disconnect). A logical session (for local, network, and remote access) is initiated whenever a user (or process acting on behalf of a user) accesses an organizational information system. Such user sessions can be terminated (and thus terminate user access) without terminating network sessions.\n\nSession termination terminates all processes associated with a user's logical session except those processes that are specifically created by the user (i.e., session owner) to continue after the session is terminated.\n\nConditions or trigger events requiring automatic session termination can include, for example, organization-defined periods of user inactivity, targeted responses to certain types of incidents, and time-of-day restrictions on information system use.\n\nThis capability is typically reserved for specific operating system functionality where the system owner, data owner, or organization requires additional assurance.\n\n","descriptions":{"default":"Automatic session termination addresses the termination of user-initiated logical sessions in contrast to the termination of network connections that are associated with communications sessions (i.e., network disconnect). A logical session (for local, network, and remote access) is initiated whenever a user (or process acting on behalf of a user) accesses an organizational information system. Such user sessions can be terminated (and thus terminate user access) without terminating network sessions.\n\nSession termination terminates all processes associated with a user's logical session except those processes that are specifically created by the user (i.e., session owner) to continue after the session is terminated.\n\nConditions or trigger events requiring automatic session termination can include, for example, organization-defined periods of user inactivity, targeted responses to certain types of incidents, and time-of-day restrictions on information system use.\n\nThis capability is typically reserved for specific operating system functionality where the system owner, data owner, or organization requires additional assurance.\n\n","check":"At the command line, run the following command:\n\n# grep -E \"TMOUT=900\" /etc/bash.bashrc /etc/profile.d/*\n\nExample result:\n\n/etc/profile.d/tmout.sh:TMOUT=900\n\nIf the \"TMOUT\" environmental variable is not set, the value is more than \"900\", or is set to \"0\", this is a finding.","fix":"Navigate to and open:\n\n/etc/profile.d/tmout.sh\n\nSet its content to the following: \n\nTMOUT=900\nreadonly TMOUT \nexport TMOUT\nmesg n 2>/dev/null"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62580r933579_chk","severity":"medium","gid":"V-258840","rid":"SV-258840r933581_rule","stig_id":"PHTN-40-000093","gtitle":"SRG-OS-000279-GPOS-00109","fix_id":"F-62489r933580_fix","satisfies":["SRG-OS-000279-GPOS-00109","SRG-OS-000126-GPOS-00066"],"documentable":null,"cci":["CCI-000879","CCI-002361"],"nist":["MA-4 e","AC-12"]}},{"id":"SV-258841","code":"control 'SV-258841' do\n  title 'The Photon operating system must enable symlink access control protection in the kernel.'\n  desc \"By enabling the fs.protected_symlinks kernel parameter, symbolic links are permitted to be followed only when outside a sticky world-writable directory, or when the UID of the link and follower match, or when the directory owner matches the symlink's owner. Disallowing such symlinks helps mitigate vulnerabilities based on insecure file system accessed by privileged programs, avoiding an exploitation vector exploiting unsafe use of open() or creat().\"\n  desc 'check', 'At the command line, run the following command to verify symlink protection is enabled:\n\n# /sbin/sysctl fs.protected_symlinks\n\nExample result:\n\nfs.protected_symlinks = 1\n\nIf the \"fs.protected_symlinks\" kernel parameter is not set to \"1\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nfs.protected_symlinks = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62581r933582_chk'\n  tag severity: 'high'\n  tag gid: 'V-258841'\n  tag rid: 'SV-258841r933584_rule'\n  tag stig_id: 'PHTN-40-000105'\n  tag gtitle: 'SRG-OS-000324-GPOS-00125'\n  tag fix_id: 'F-62490r933583_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002235']\n  tag nist: ['AC-6 (10)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258841.rb"},"title":"The Photon operating system must enable symlink access control protection in the kernel.","desc":"By enabling the fs.protected_symlinks kernel parameter, symbolic links are permitted to be followed only when outside a sticky world-writable directory, or when the UID of the link and follower match, or when the directory owner matches the symlink's owner. Disallowing such symlinks helps mitigate vulnerabilities based on insecure file system accessed by privileged programs, avoiding an exploitation vector exploiting unsafe use of open() or creat().","descriptions":{"default":"By enabling the fs.protected_symlinks kernel parameter, symbolic links are permitted to be followed only when outside a sticky world-writable directory, or when the UID of the link and follower match, or when the directory owner matches the symlink's owner. Disallowing such symlinks helps mitigate vulnerabilities based on insecure file system accessed by privileged programs, avoiding an exploitation vector exploiting unsafe use of open() or creat().","check":"At the command line, run the following command to verify symlink protection is enabled:\n\n# /sbin/sysctl fs.protected_symlinks\n\nExample result:\n\nfs.protected_symlinks = 1\n\nIf the \"fs.protected_symlinks\" kernel parameter is not set to \"1\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nfs.protected_symlinks = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62581r933582_chk","severity":"high","gid":"V-258841","rid":"SV-258841r933584_rule","stig_id":"PHTN-40-000105","gtitle":"SRG-OS-000324-GPOS-00125","fix_id":"F-62490r933583_fix","documentable":null,"cci":["CCI-002235"],"nist":["AC-6 (10)"]}},{"id":"SV-258842","code":"control 'SV-258842' do\n  title 'The Photon operating system must audit the execution of privileged functions.'\n  desc 'Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\n'\n  desc 'check', 'At the command line, run the following command to output a list of files with setuid/setgid configured and their corresponding audit rules:\n\n# for file in $(find / -xdev -path /var/lib/containerd -prune -o \\\\( -perm -4000 -o -perm -2000 \\\\) -type f -print | sort); do echo \"Found file with setuid/setgid configured: $file\";rule=\"$(auditctl -l | grep \"$file \")\";echo \"Audit Rule Result: $rule\";echo \"\"; done\n\nExample output:\n\nFound file with setuid/setgid configured: /usr/bin/chage\nAudit Rule Result: -a always,exit -S all -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged\n\nFound file with setuid/setgid configured: /usr/bin/chfn\nAudit Rule Result: -a always,exit -S all -F path=/usr/bin/chfn -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged\n\nIf each file returned does not have a corresponding audit rule, this is a finding. \n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.\n\nNote: auid!=-1, auid!=4294967295, auid!=unset are functionally equivalent in this check and the output of the above commands may be displayed in either format.'\n  desc 'fix', 'Run the following steps for each file found in the check that does not have a corresponding line in the audit rules:\n\nNavigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd the following line:\n\n-a always,exit -F path=<path> -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nRun the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62582r933585_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258842'\n  tag rid: 'SV-258842r933587_rule'\n  tag stig_id: 'PHTN-40-000107'\n  tag gtitle: 'SRG-OS-000327-GPOS-00127'\n  tag fix_id: 'F-62491r933586_fix'\n  tag satisfies: ['SRG-OS-000327-GPOS-00127', 'SRG-OS-000240-GPOS-00090', 'SRG-OS-000458-GPOS-00203', 'SRG-OS-000463-GPOS-00207', 'SRG-OS-000471-GPOS-00215']\n  tag 'documentable'\n  tag cci: ['CCI-000172', 'CCI-001404', 'CCI-002234']\n  tag nist: ['AU-12 c', 'AC-2 (4)', 'AC-6 (9)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258842.rb"},"title":"The Photon operating system must audit the execution of privileged functions.","desc":"Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\n","descriptions":{"default":"Misuse of privileged functions, either intentionally or unintentionally by authorized users, or by unauthorized external entities that have compromised information system accounts, is a serious and ongoing concern and can have significant adverse impacts on organizations. Auditing the use of privileged functions is one way to detect such misuse and identify the risk from insider threats and the advanced persistent threat.\n\n","check":"At the command line, run the following command to output a list of files with setuid/setgid configured and their corresponding audit rules:\n\n# for file in $(find / -xdev -path /var/lib/containerd -prune -o \\( -perm -4000 -o -perm -2000 \\) -type f -print | sort); do echo \"Found file with setuid/setgid configured: $file\";rule=\"$(auditctl -l | grep \"$file \")\";echo \"Audit Rule Result: $rule\";echo \"\"; done\n\nExample output:\n\nFound file with setuid/setgid configured: /usr/bin/chage\nAudit Rule Result: -a always,exit -S all -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged\n\nFound file with setuid/setgid configured: /usr/bin/chfn\nAudit Rule Result: -a always,exit -S all -F path=/usr/bin/chfn -F perm=x -F auid>=1000 -F auid!=-1 -F key=privileged\n\nIf each file returned does not have a corresponding audit rule, this is a finding. \n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.\n\nNote: auid!=-1, auid!=4294967295, auid!=unset are functionally equivalent in this check and the output of the above commands may be displayed in either format.","fix":"Run the following steps for each file found in the check that does not have a corresponding line in the audit rules:\n\nNavigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd the following line:\n\n-a always,exit -F path=<path> -F perm=x -F auid>=1000 -F auid!=unset -F key=privileged\n\nRun the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62582r933585_chk","severity":"medium","gid":"V-258842","rid":"SV-258842r933587_rule","stig_id":"PHTN-40-000107","gtitle":"SRG-OS-000327-GPOS-00127","fix_id":"F-62491r933586_fix","satisfies":["SRG-OS-000327-GPOS-00127","SRG-OS-000240-GPOS-00090","SRG-OS-000458-GPOS-00203","SRG-OS-000463-GPOS-00207","SRG-OS-000471-GPOS-00215"],"documentable":null,"cci":["CCI-000172","CCI-001404","CCI-002234"],"nist":["AU-12 c","AC-2 (4)","AC-6 (9)"]}},{"id":"SV-258843","code":"control 'SV-258843' do\n  title 'The Photon operating system must automatically lock an account until the locked account is released by an administrator when three unsuccessful logon attempts in 15 minutes occur.'\n  desc 'By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account.'\n  desc 'check', %q(At the command line, run the following commands to verify accounts are locked until the locked account is released by an administrator when three unsuccessful logon attempts in 15 minutes are made:\n\n# grep '^unlock_time =' /etc/security/faillock.conf\n\nExample result:\n\nunlock_time = 0\n\nIf the \"unlock_time\" option is not set to \"0\", is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\nunlock_time = 0\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62583r933588_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258843'\n  tag rid: 'SV-258843r933590_rule'\n  tag stig_id: 'PHTN-40-000108'\n  tag gtitle: 'SRG-OS-000329-GPOS-00128'\n  tag fix_id: 'F-62492r933589_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002238']\n  tag nist: ['AC-7 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258843.rb"},"title":"The Photon operating system must automatically lock an account until the locked account is released by an administrator when three unsuccessful logon attempts in 15 minutes occur.","desc":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account.","descriptions":{"default":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced. Limits are imposed by locking the account.","check":"At the command line, run the following commands to verify accounts are locked until the locked account is released by an administrator when three unsuccessful logon attempts in 15 minutes are made:\n\n# grep '^unlock_time =' /etc/security/faillock.conf\n\nExample result:\n\nunlock_time = 0\n\nIf the \"unlock_time\" option is not set to \"0\", is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\nunlock_time = 0\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62583r933588_chk","severity":"medium","gid":"V-258843","rid":"SV-258843r933590_rule","stig_id":"PHTN-40-000108","gtitle":"SRG-OS-000329-GPOS-00128","fix_id":"F-62492r933589_fix","documentable":null,"cci":["CCI-002238"],"nist":["AC-7 b"]}},{"id":"SV-258844","code":"control 'SV-258844' do\n  title 'The Photon operating system must allocate audit record storage capacity to store audit records when audit records are not immediately sent to a central audit record storage facility.'\n  desc 'Audit logs are most useful when accessible by date, rather than size. This can be accomplished through a combination of an audit log rotation and setting a reasonable number of logs to keep. This ensures that audit logs are accessible to the ISSO in the event of a central log processing failure.'\n  desc 'check', 'At the command line, run the following command to verify auditd is configured to keep a number of audit logs in the event of a central log processing failure:\n\n# grep -E \"^num_logs|^max_log_file_action\" /etc/audit/auditd.conf\n\nExample result:\n\nnum_logs = 5\nmax_log_file_action = ROTATE\n\nIf \"num_logs\" is not configured to \"5\" or greater, this is a finding.\nIf \"max_log_file_action\" is not configured to \"ROTATE\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/auditd.conf\n\nEnsure the following lines are present, not duplicated, and not commented:\n\nnum_logs = 5\nmax_log_file_action = ROTATE\n\nAt the command line, run the following command:\n\n# pkill -SIGHUP auditd'\n  impact 0.3\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62584r933591_chk'\n  tag severity: 'low'\n  tag gid: 'V-258844'\n  tag rid: 'SV-258844r933593_rule'\n  tag stig_id: 'PHTN-40-000110'\n  tag gtitle: 'SRG-OS-000341-GPOS-00132'\n  tag fix_id: 'F-62493r933592_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001849']\n  tag nist: ['AU-4']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258844.rb"},"title":"The Photon operating system must allocate audit record storage capacity to store audit records when audit records are not immediately sent to a central audit record storage facility.","desc":"Audit logs are most useful when accessible by date, rather than size. This can be accomplished through a combination of an audit log rotation and setting a reasonable number of logs to keep. This ensures that audit logs are accessible to the ISSO in the event of a central log processing failure.","descriptions":{"default":"Audit logs are most useful when accessible by date, rather than size. This can be accomplished through a combination of an audit log rotation and setting a reasonable number of logs to keep. This ensures that audit logs are accessible to the ISSO in the event of a central log processing failure.","check":"At the command line, run the following command to verify auditd is configured to keep a number of audit logs in the event of a central log processing failure:\n\n# grep -E \"^num_logs|^max_log_file_action\" /etc/audit/auditd.conf\n\nExample result:\n\nnum_logs = 5\nmax_log_file_action = ROTATE\n\nIf \"num_logs\" is not configured to \"5\" or greater, this is a finding.\nIf \"max_log_file_action\" is not configured to \"ROTATE\", this is a finding.","fix":"Navigate to and open:\n\n/etc/audit/auditd.conf\n\nEnsure the following lines are present, not duplicated, and not commented:\n\nnum_logs = 5\nmax_log_file_action = ROTATE\n\nAt the command line, run the following command:\n\n# pkill -SIGHUP auditd"},"impact":0.3,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62584r933591_chk","severity":"low","gid":"V-258844","rid":"SV-258844r933593_rule","stig_id":"PHTN-40-000110","gtitle":"SRG-OS-000341-GPOS-00132","fix_id":"F-62493r933592_fix","documentable":null,"cci":["CCI-001849"],"nist":["AU-4"]}},{"id":"SV-258845","code":"control 'SV-258845' do\n  title 'The Photon operating system must immediately notify the SA and ISSO when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity.'\n  desc 'If security personnel are not notified immediately when storage volume reaches 75 percent utilization, they are unable to plan for audit record storage capacity expansion.'\n  desc 'check', \"At the command line, run the following command to verify auditd is alerting when low disk space is detected:\n\n# grep '^space_left' /etc/audit/auditd.conf\n\nExpected result:\n\nspace_left = 25%\nspace_left_action = SYSLOG\n\nIf the output does not match the expected result, this is a finding.\"\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/auditd.conf\n\nEnsure the \"space_left\" and \"space_left_action\" lines are uncommented and set to the following:\n\nspace_left = 25%\nspace_left_action = SYSLOG\n\nAt the command line, run the following command:\n\n# pkill -SIGHUP auditd'\n  impact 0.3\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62585r933594_chk'\n  tag severity: 'low'\n  tag gid: 'V-258845'\n  tag rid: 'SV-258845r935564_rule'\n  tag stig_id: 'PHTN-40-000112'\n  tag gtitle: 'SRG-OS-000343-GPOS-00134'\n  tag fix_id: 'F-62494r933595_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001855']\n  tag nist: ['AU-5 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258845.rb"},"title":"The Photon operating system must immediately notify the SA and ISSO when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity.","desc":"If security personnel are not notified immediately when storage volume reaches 75 percent utilization, they are unable to plan for audit record storage capacity expansion.","descriptions":{"default":"If security personnel are not notified immediately when storage volume reaches 75 percent utilization, they are unable to plan for audit record storage capacity expansion.","check":"At the command line, run the following command to verify auditd is alerting when low disk space is detected:\n\n# grep '^space_left' /etc/audit/auditd.conf\n\nExpected result:\n\nspace_left = 25%\nspace_left_action = SYSLOG\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open:\n\n/etc/audit/auditd.conf\n\nEnsure the \"space_left\" and \"space_left_action\" lines are uncommented and set to the following:\n\nspace_left = 25%\nspace_left_action = SYSLOG\n\nAt the command line, run the following command:\n\n# pkill -SIGHUP auditd"},"impact":0.3,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62585r933594_chk","severity":"low","gid":"V-258845","rid":"SV-258845r935564_rule","stig_id":"PHTN-40-000112","gtitle":"SRG-OS-000343-GPOS-00134","fix_id":"F-62494r933595_fix","documentable":null,"cci":["CCI-001855"],"nist":["AU-5 (1)"]}},{"id":"SV-258846","code":"control 'SV-258846' do\n  title 'The Photon operating system TDNF package management tool must cryptographically verify the authenticity of all software packages during installation.'\n  desc 'Installation of any nontrusted software, patches, service packs, device drivers, or operating system components can significantly affect the overall security of the operating system. This requirement ensures the software has not been tampered with and has been provided by a trusted vendor.'\n  desc 'check', %q(At the command line, run the following command to verify software packages are cryptographically verified during installation:\n\n# grep '^gpgcheck' /etc/tdnf/tdnf.conf\n\nExample result:\n\ngpgcheck=1\n\nIf \"gpgcheck\" is not set to \"true\", \"1\", or \"yes\", this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/tdnf/tdnf.conf\n\nAdd or update the following line:\n\ngpgcheck=1'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62586r933597_chk'\n  tag severity: 'high'\n  tag gid: 'V-258846'\n  tag rid: 'SV-258846r933599_rule'\n  tag stig_id: 'PHTN-40-000130'\n  tag gtitle: 'SRG-OS-000366-GPOS-00153'\n  tag fix_id: 'F-62495r933598_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001749']\n  tag nist: ['CM-5 (3)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258846.rb"},"title":"The Photon operating system TDNF package management tool must cryptographically verify the authenticity of all software packages during installation.","desc":"Installation of any nontrusted software, patches, service packs, device drivers, or operating system components can significantly affect the overall security of the operating system. This requirement ensures the software has not been tampered with and has been provided by a trusted vendor.","descriptions":{"default":"Installation of any nontrusted software, patches, service packs, device drivers, or operating system components can significantly affect the overall security of the operating system. This requirement ensures the software has not been tampered with and has been provided by a trusted vendor.","check":"At the command line, run the following command to verify software packages are cryptographically verified during installation:\n\n# grep '^gpgcheck' /etc/tdnf/tdnf.conf\n\nExample result:\n\ngpgcheck=1\n\nIf \"gpgcheck\" is not set to \"true\", \"1\", or \"yes\", this is a finding.","fix":"Navigate to and open:\n\n/etc/tdnf/tdnf.conf\n\nAdd or update the following line:\n\ngpgcheck=1"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62586r933597_chk","severity":"high","gid":"V-258846","rid":"SV-258846r933599_rule","stig_id":"PHTN-40-000130","gtitle":"SRG-OS-000366-GPOS-00153","fix_id":"F-62495r933598_fix","documentable":null,"cci":["CCI-001749"],"nist":["CM-5 (3)"]}},{"id":"SV-258847","code":"control 'SV-258847' do\n  title 'The Photon operating system must require users to reauthenticate for privilege escalation.'\n  desc 'Without reauthentication, users may access resources or perform tasks for which they do not have authorization. \n\nWhen operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.\n\n'\n  desc 'check', %q(At the command line, run the following commands to verify users with a set password are not allowed to sudo without reauthentication:\n\n# grep -ihs nopasswd /etc/sudoers /etc/sudoers.d/*|grep -vE '(^#|^%)'\n\n# awk -F: '($2 != \"x\" && $2 != \"!\") {print $1}' /etc/shadow\n\nIf any account listed in the first output is also listed in the second output and is not documented, this is a finding.)\n  desc 'fix', 'Check the configuration of the \"/etc/sudoers\" and \"/etc/sudoers.d/*\" files with the following command:\n\n# visudo\n\nOR\n\n# visudo -f /etc/sudoers.d/<file name>\n\nRemove any occurrences of \"NOPASSWD\" tags associated with user accounts with a password hash.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62587r933600_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258847'\n  tag rid: 'SV-258847r933602_rule'\n  tag stig_id: 'PHTN-40-000133'\n  tag gtitle: 'SRG-OS-000373-GPOS-00156'\n  tag fix_id: 'F-62496r933601_fix'\n  tag satisfies: ['SRG-OS-000373-GPOS-00156', 'SRG-OS-000373-GPOS-00157', 'SRG-OS-000373-GPOS-00158']\n  tag 'documentable'\n  tag cci: ['CCI-002038']\n  tag nist: ['IA-11']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258847.rb"},"title":"The Photon operating system must require users to reauthenticate for privilege escalation.","desc":"Without reauthentication, users may access resources or perform tasks for which they do not have authorization. \n\nWhen operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.\n\n","descriptions":{"default":"Without reauthentication, users may access resources or perform tasks for which they do not have authorization. \n\nWhen operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.\n\n","check":"At the command line, run the following commands to verify users with a set password are not allowed to sudo without reauthentication:\n\n# grep -ihs nopasswd /etc/sudoers /etc/sudoers.d/*|grep -vE '(^#|^%)'\n\n# awk -F: '($2 != \"x\" && $2 != \"!\") {print $1}' /etc/shadow\n\nIf any account listed in the first output is also listed in the second output and is not documented, this is a finding.","fix":"Check the configuration of the \"/etc/sudoers\" and \"/etc/sudoers.d/*\" files with the following command:\n\n# visudo\n\nOR\n\n# visudo -f /etc/sudoers.d/<file name>\n\nRemove any occurrences of \"NOPASSWD\" tags associated with user accounts with a password hash."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62587r933600_chk","severity":"medium","gid":"V-258847","rid":"SV-258847r933602_rule","stig_id":"PHTN-40-000133","gtitle":"SRG-OS-000373-GPOS-00156","fix_id":"F-62496r933601_fix","satisfies":["SRG-OS-000373-GPOS-00156","SRG-OS-000373-GPOS-00157","SRG-OS-000373-GPOS-00158"],"documentable":null,"cci":["CCI-002038"],"nist":["IA-11"]}},{"id":"SV-258848","code":"control 'SV-258848' do\n  title 'The Photon operating system must implement address space layout randomization to protect its memory from unauthorized code execution.'\n  desc 'Some adversaries launch attacks with the intent of executing code in nonexecutable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can either be hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.\n\nExamples of attacks are buffer overflow attacks.'\n  desc 'check', 'At the command line, run the following command to verify address space layout randomization is enabled:\n\n# cat /proc/sys/kernel/randomize_va_space\n\nIf the value of \"randomize_va_space\" is not \"2\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nkernel.randomize_va_space=2\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62588r933603_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258848'\n  tag rid: 'SV-258848r933605_rule'\n  tag stig_id: 'PHTN-40-000160'\n  tag gtitle: 'SRG-OS-000433-GPOS-00193'\n  tag fix_id: 'F-62497r933604_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002824']\n  tag nist: ['SI-16']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258848.rb"},"title":"The Photon operating system must implement address space layout randomization to protect its memory from unauthorized code execution.","desc":"Some adversaries launch attacks with the intent of executing code in nonexecutable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can either be hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.\n\nExamples of attacks are buffer overflow attacks.","descriptions":{"default":"Some adversaries launch attacks with the intent of executing code in nonexecutable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can either be hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.\n\nExamples of attacks are buffer overflow attacks.","check":"At the command line, run the following command to verify address space layout randomization is enabled:\n\n# cat /proc/sys/kernel/randomize_va_space\n\nIf the value of \"randomize_va_space\" is not \"2\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nkernel.randomize_va_space=2\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62588r933603_chk","severity":"medium","gid":"V-258848","rid":"SV-258848r933605_rule","stig_id":"PHTN-40-000160","gtitle":"SRG-OS-000433-GPOS-00193","fix_id":"F-62497r933604_fix","documentable":null,"cci":["CCI-002824"],"nist":["SI-16"]}},{"id":"SV-258849","code":"control 'SV-258849' do\n  title 'The Photon operating system must remove all software components after updated versions have been installed.'\n  desc 'Previous versions of software components that are not removed from the information system after updates have been installed may be exploited by adversaries. Some information technology products may remove older versions of software automatically from the information system.'\n  desc 'check', %q(At the command line, run the following command:\n\n# grep -i '^clean_requirements_on_remove' /etc/tdnf/tdnf.conf\n\nExample result:\n\nclean_requirements_on_remove=1\n\nIf \"clean_requirements_on_remove\" is not set to \"true\", \"1\", or \"yes\", this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/tdnf/tdnf.conf\n\nAdd or update the following line:\n\nclean_requirements_on_remove=1'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62589r933606_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258849'\n  tag rid: 'SV-258849r933608_rule'\n  tag stig_id: 'PHTN-40-000161'\n  tag gtitle: 'SRG-OS-000437-GPOS-00194'\n  tag fix_id: 'F-62498r933607_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002617']\n  tag nist: ['SI-2 (6)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258849.rb"},"title":"The Photon operating system must remove all software components after updated versions have been installed.","desc":"Previous versions of software components that are not removed from the information system after updates have been installed may be exploited by adversaries. Some information technology products may remove older versions of software automatically from the information system.","descriptions":{"default":"Previous versions of software components that are not removed from the information system after updates have been installed may be exploited by adversaries. Some information technology products may remove older versions of software automatically from the information system.","check":"At the command line, run the following command:\n\n# grep -i '^clean_requirements_on_remove' /etc/tdnf/tdnf.conf\n\nExample result:\n\nclean_requirements_on_remove=1\n\nIf \"clean_requirements_on_remove\" is not set to \"true\", \"1\", or \"yes\", this is a finding.","fix":"Navigate to and open:\n\n/etc/tdnf/tdnf.conf\n\nAdd or update the following line:\n\nclean_requirements_on_remove=1"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62589r933606_chk","severity":"medium","gid":"V-258849","rid":"SV-258849r933608_rule","stig_id":"PHTN-40-000161","gtitle":"SRG-OS-000437-GPOS-00194","fix_id":"F-62498r933607_fix","documentable":null,"cci":["CCI-002617"],"nist":["SI-2 (6)"]}},{"id":"SV-258850","code":"control 'SV-258850' do\n  title 'The Photon operating system must generate audit records when successful/unsuccessful logon attempts occur.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).'\n  desc 'check', 'At the command line, run the following command to verify an audit rule exists to audit logon attempts:\n\n# auditctl -l | grep -E \"faillog|lastlog|tallylog\"\n\nExpected result:\n\n-w /var/log/faillog -p wa -k logons\n-w /var/log/lastlog -p wa -k logons\n-w /var/log/tallylog -p wa -k logons\n\nIf the output does not match the expected result, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /var/log/faillog -p wa -k logons\n-w /var/log/lastlog -p wa -k logons\n-w /var/log/tallylog -p wa -k logons\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62590r933609_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258850'\n  tag rid: 'SV-258850r933611_rule'\n  tag stig_id: 'PHTN-40-000173'\n  tag gtitle: 'SRG-OS-000470-GPOS-00214'\n  tag fix_id: 'F-62499r933610_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258850.rb"},"title":"The Photon operating system must generate audit records when successful/unsuccessful logon attempts occur.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).","check":"At the command line, run the following command to verify an audit rule exists to audit logon attempts:\n\n# auditctl -l | grep -E \"faillog|lastlog|tallylog\"\n\nExpected result:\n\n-w /var/log/faillog -p wa -k logons\n-w /var/log/lastlog -p wa -k logons\n-w /var/log/tallylog -p wa -k logons\n\nIf the output does not match the expected result, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.","fix":"Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /var/log/faillog -p wa -k logons\n-w /var/log/lastlog -p wa -k logons\n-w /var/log/tallylog -p wa -k logons\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62590r933609_chk","severity":"medium","gid":"V-258850","rid":"SV-258850r933611_rule","stig_id":"PHTN-40-000173","gtitle":"SRG-OS-000470-GPOS-00214","fix_id":"F-62499r933610_fix","documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-258851","code":"control 'SV-258851' do\n  title 'The Photon operating system must be configured to audit the loading and unloading of dynamic kernel modules.'\n  desc 'Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n'\n  desc 'check', 'At the command line, run the following command to verify an audit rule exists to audit kernel modules:\n\n# auditctl -l | grep init_module\n\nExpected result:\n\n-a always,exit -F arch=b32 -S init_module -F key=modules\n-a always,exit -F arch=b64 -S init_module -F key=modules\n\nIf the output does not match the expected result, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-a always,exit -F arch=b32 -S init_module -F key=modules\n-a always,exit -F arch=b64 -S init_module -F key=modules\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62591r933612_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258851'\n  tag rid: 'SV-258851r933614_rule'\n  tag stig_id: 'PHTN-40-000175'\n  tag gtitle: 'SRG-OS-000471-GPOS-00216'\n  tag fix_id: 'F-62500r933613_fix'\n  tag satisfies: ['SRG-OS-000471-GPOS-00216', 'SRG-OS-000477-GPOS-00222']\n  tag 'documentable'\n  tag cci: ['CCI-000172']\n  tag nist: ['AU-12 c']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258851.rb"},"title":"The Photon operating system must be configured to audit the loading and unloading of dynamic kernel modules.","desc":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n","descriptions":{"default":"Without generating audit records that are specific to the security and mission needs of the organization, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.\n\nAudit records can be generated from various components within the information system (e.g., module or policy filter).\n\n","check":"At the command line, run the following command to verify an audit rule exists to audit kernel modules:\n\n# auditctl -l | grep init_module\n\nExpected result:\n\n-a always,exit -F arch=b32 -S init_module -F key=modules\n-a always,exit -F arch=b64 -S init_module -F key=modules\n\nIf the output does not match the expected result, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.","fix":"Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-a always,exit -F arch=b32 -S init_module -F key=modules\n-a always,exit -F arch=b64 -S init_module -F key=modules\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62591r933612_chk","severity":"medium","gid":"V-258851","rid":"SV-258851r933614_rule","stig_id":"PHTN-40-000175","gtitle":"SRG-OS-000471-GPOS-00216","fix_id":"F-62500r933613_fix","satisfies":["SRG-OS-000471-GPOS-00216","SRG-OS-000477-GPOS-00222"],"documentable":null,"cci":["CCI-000172"],"nist":["AU-12 c"]}},{"id":"SV-258852","code":"control 'SV-258852' do\n  title 'The Photon operating system must implement NIST FIPS-validated cryptography for the following: to provision digital signatures, to generate cryptographic hashes, and to protect unclassified information requiring confidentiality and cryptographic protection in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards.'\n  desc 'Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n'\n  desc 'check', 'At the command line, run the following command to verify FIPS is enabled for the OS:\n\n# cat /proc/sys/crypto/fips_enabled\n\nExample result:\n\n1\n\nIf \"fips_enabled\" is not set to \"1\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/boot/grub2/grub.cfg\n\nLocate the boot command line arguments. An example follows:\n\nlinux /boot/$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline\n\nAdd \"fips=1\" to the end of the line so it reads as follows:\n\nlinux /boot/$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline fips=1\n\nNote: Do not copy/paste in this example argument line. This may change in future releases. Find the similar line and append \"fips=1\" to it.\n\nReboot the system for the change to take effect.'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62592r933615_chk'\n  tag severity: 'high'\n  tag gid: 'V-258852'\n  tag rid: 'SV-258852r933617_rule'\n  tag stig_id: 'PHTN-40-000182'\n  tag gtitle: 'SRG-OS-000478-GPOS-00223'\n  tag fix_id: 'F-62501r933616_fix'\n  tag satisfies: ['SRG-OS-000478-GPOS-00223', 'SRG-OS-000396-GPOS-00176']\n  tag 'documentable'\n  tag cci: ['CCI-002450']\n  tag nist: ['SC-13 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258852.rb"},"title":"The Photon operating system must implement NIST FIPS-validated cryptography for the following: to provision digital signatures, to generate cryptographic hashes, and to protect unclassified information requiring confidentiality and cryptographic protection in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards.","desc":"Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n","descriptions":{"default":"Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.\n\n","check":"At the command line, run the following command to verify FIPS is enabled for the OS:\n\n# cat /proc/sys/crypto/fips_enabled\n\nExample result:\n\n1\n\nIf \"fips_enabled\" is not set to \"1\", this is a finding.","fix":"Navigate to and open:\n\n/boot/grub2/grub.cfg\n\nLocate the boot command line arguments. An example follows:\n\nlinux /boot/$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline\n\nAdd \"fips=1\" to the end of the line so it reads as follows:\n\nlinux /boot/$photon_linux root=$rootpartition $photon_cmdline $systemd_cmdline fips=1\n\nNote: Do not copy/paste in this example argument line. This may change in future releases. Find the similar line and append \"fips=1\" to it.\n\nReboot the system for the change to take effect."},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62592r933615_chk","severity":"high","gid":"V-258852","rid":"SV-258852r933617_rule","stig_id":"PHTN-40-000182","gtitle":"SRG-OS-000478-GPOS-00223","fix_id":"F-62501r933616_fix","satisfies":["SRG-OS-000478-GPOS-00223","SRG-OS-000396-GPOS-00176"],"documentable":null,"cci":["CCI-002450"],"nist":["SC-13 b"]}},{"id":"SV-258853","code":"control 'SV-258853' do\n  title 'The Photon operating system must prevent the use of dictionary words for passwords.'\n  desc 'If the operating system allows the user to select passwords based on dictionary words, then this increases the chances of password compromise by increasing the opportunity for successful guesses and brute-force attacks.'\n  desc 'check', %q(At the command line, run the following command to verify passwords do not match dictionary words:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"dictcheck\" option is not set to 1, is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"dictcheck\" option set to \"1\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62593r933618_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258853'\n  tag rid: 'SV-258853r933620_rule'\n  tag stig_id: 'PHTN-40-000184'\n  tag gtitle: 'SRG-OS-000480-GPOS-00225'\n  tag fix_id: 'F-62502r933619_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258853.rb"},"title":"The Photon operating system must prevent the use of dictionary words for passwords.","desc":"If the operating system allows the user to select passwords based on dictionary words, then this increases the chances of password compromise by increasing the opportunity for successful guesses and brute-force attacks.","descriptions":{"default":"If the operating system allows the user to select passwords based on dictionary words, then this increases the chances of password compromise by increasing the opportunity for successful guesses and brute-force attacks.","check":"At the command line, run the following command to verify passwords do not match dictionary words:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"dictcheck\" option is not set to 1, is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"dictcheck\" option set to \"1\" as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62593r933618_chk","severity":"medium","gid":"V-258853","rid":"SV-258853r933620_rule","stig_id":"PHTN-40-000184","gtitle":"SRG-OS-000480-GPOS-00225","fix_id":"F-62502r933619_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258854","code":"control 'SV-258854' do\n  title 'The Photon operating system must enforce a delay of at least four seconds between logon prompts following a failed logon attempt in login.defs.'\n  desc 'Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.'\n  desc 'check', %q(At the command line, run the following command to verify a four second delay is configured between logon attempts:\n\n# grep '^FAIL_DELAY' /etc/login.defs\n\nExample result:\n\nFAIL_DELAY 4\n\nIf the \"FAIL_DELAY\" option is not set to 4 or more, is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line:\n\nFAIL_DELAY 4'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62594r933621_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258854'\n  tag rid: 'SV-258854r933623_rule'\n  tag stig_id: 'PHTN-40-000185'\n  tag gtitle: 'SRG-OS-000480-GPOS-00226'\n  tag fix_id: 'F-62503r933622_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258854.rb"},"title":"The Photon operating system must enforce a delay of at least four seconds between logon prompts following a failed logon attempt in login.defs.","desc":"Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.","descriptions":{"default":"Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.","check":"At the command line, run the following command to verify a four second delay is configured between logon attempts:\n\n# grep '^FAIL_DELAY' /etc/login.defs\n\nExample result:\n\nFAIL_DELAY 4\n\nIf the \"FAIL_DELAY\" option is not set to 4 or more, is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line:\n\nFAIL_DELAY 4"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62594r933621_chk","severity":"medium","gid":"V-258854","rid":"SV-258854r933623_rule","stig_id":"PHTN-40-000185","gtitle":"SRG-OS-000480-GPOS-00226","fix_id":"F-62503r933622_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258855","code":"control 'SV-258855' do\n  title 'The Photon operating system must ensure audit events are flushed to disk at proper intervals.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. To that end, the auditd service must be configured to start automatically and be running at all times.'\n  desc 'check', 'At the command line, run the following command to verify auditd is configured to flush audit events to disk regularly:\n\n# grep -E \"freq|flush\" /etc/audit/auditd.conf\n\nExample result:\n\nflush = INCREMENTAL_ASYNC\nfreq = 50\n\nIf \"flush\" is not set to \"INCREMENTAL_ASYNC\", this is a finding.\nIf \"freq\" is not set to \"50\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/auditd.conf\n\nAdd or update the following lines:\n\nflush = INCREMENTAL_ASYNC\nfreq = 50\n\nAt the command line, run the following command:\n\n# pkill -SIGHUP auditd'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62595r933624_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258855'\n  tag rid: 'SV-258855r933626_rule'\n  tag stig_id: 'PHTN-40-000186'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62504r933625_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258855.rb"},"title":"The Photon operating system must ensure audit events are flushed to disk at proper intervals.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. To that end, the auditd service must be configured to start automatically and be running at all times.","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one. To that end, the auditd service must be configured to start automatically and be running at all times.","check":"At the command line, run the following command to verify auditd is configured to flush audit events to disk regularly:\n\n# grep -E \"freq|flush\" /etc/audit/auditd.conf\n\nExample result:\n\nflush = INCREMENTAL_ASYNC\nfreq = 50\n\nIf \"flush\" is not set to \"INCREMENTAL_ASYNC\", this is a finding.\nIf \"freq\" is not set to \"50\", this is a finding.","fix":"Navigate to and open:\n\n/etc/audit/auditd.conf\n\nAdd or update the following lines:\n\nflush = INCREMENTAL_ASYNC\nfreq = 50\n\nAt the command line, run the following command:\n\n# pkill -SIGHUP auditd"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62595r933624_chk","severity":"medium","gid":"V-258855","rid":"SV-258855r933626_rule","stig_id":"PHTN-40-000186","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62504r933625_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258856","code":"control 'SV-258856' do\n  title 'The Photon operating system must define default permissions for all authenticated users in such a way that the user can only read and modify their own files.'\n  desc 'Setting the most restrictive default permissions ensures that when new accounts are created they do not have unnecessary access.'\n  desc 'check', %q(At the command line, run the following command to verify the default umask configuration:\n\n# grep '^UMASK' /etc/login.defs\n\nExpected result:\n\nUMASK 077\n\nIf the \"UMASK\" option is not set to \"077\", is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line:\n\nUMASK 077'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62596r933627_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258856'\n  tag rid: 'SV-258856r933629_rule'\n  tag stig_id: 'PHTN-40-000187'\n  tag gtitle: 'SRG-OS-000480-GPOS-00228'\n  tag fix_id: 'F-62505r933628_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258856.rb"},"title":"The Photon operating system must define default permissions for all authenticated users in such a way that the user can only read and modify their own files.","desc":"Setting the most restrictive default permissions ensures that when new accounts are created they do not have unnecessary access.","descriptions":{"default":"Setting the most restrictive default permissions ensures that when new accounts are created they do not have unnecessary access.","check":"At the command line, run the following command to verify the default umask configuration:\n\n# grep '^UMASK' /etc/login.defs\n\nExpected result:\n\nUMASK 077\n\nIf the \"UMASK\" option is not set to \"077\", is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line:\n\nUMASK 077"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62596r933627_chk","severity":"medium","gid":"V-258856","rid":"SV-258856r933629_rule","stig_id":"PHTN-40-000187","gtitle":"SRG-OS-000480-GPOS-00228","fix_id":"F-62505r933628_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258857","code":"control 'SV-258857' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to disallow HostbasedAuthentication.'\n  desc 'SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i HostbasedAuthentication\n\nExample result:\n\nhostbasedauthentication no\n\nIf \"HostbasedAuthentication\" is not set to \"no\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"HostbasedAuthentication\" line is uncommented and set to the following:\n\nHostbasedAuthentication no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62597r933630_chk'\n  tag severity: 'high'\n  tag gid: 'V-258857'\n  tag rid: 'SV-258857r933632_rule'\n  tag stig_id: 'PHTN-40-000188'\n  tag gtitle: 'SRG-OS-000480-GPOS-00229'\n  tag fix_id: 'F-62506r933631_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258857.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to disallow HostbasedAuthentication.","desc":"SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled.","descriptions":{"default":"SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i HostbasedAuthentication\n\nExample result:\n\nhostbasedauthentication no\n\nIf \"HostbasedAuthentication\" is not set to \"no\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"HostbasedAuthentication\" line is uncommented and set to the following:\n\nHostbasedAuthentication no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62597r933630_chk","severity":"high","gid":"V-258857","rid":"SV-258857r933632_rule","stig_id":"PHTN-40-000188","gtitle":"SRG-OS-000480-GPOS-00229","fix_id":"F-62506r933631_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258858","code":"control 'SV-258858' do\n  title 'The Photon operating system must be configured to use the pam_faillock.so module.'\n  desc 'By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nThis module maintains a list of failed authentication attempts per user during a specified interval and locks the account in case there were more than deny consecutive failed authentications.'\n  desc 'check', %q(At the command line, run the following commands to verify the pam_faillock.so module is used:\n\n# grep '^auth' /etc/pam.d/system-auth\n\nExample result:\n\nauth required pam_faillock.so preauth\nauth required pam_unix.so\nauth required pam_faillock.so authfail\n\nIf the pam_faillock.so module is not present with the \"preauth\" line listed before pam_unix.so, this is a finding.\nIf the pam_faillock.so module is not present with the \"authfail\" line listed after pam_unix.so, this is a finding.\n\n# grep '^account' /etc/pam.d/system-account\n\nExample result:\n\naccount required pam_faillock.so\naccount required pam_unix.so\n\nIf the pam_faillock.so module is not present and listed before pam_unix.so, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-auth\n\nAdd or update the following lines making sure to place the preauth line before the pam_unix.so module:\n\nauth required pam_faillock.so preauth\nauth required pam_faillock.so authfail\n\nNavigate to and open:\n\n/etc/pam.d/system-account\n\nAdd or update the following lines making sure to place the line before the pam_unix.so module:\n\naccount required pam_faillock.so\n\nNote: The lines shown assume the /etc/security/faillock.conf file is used to configure pam_faillock.\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62598r933633_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258858'\n  tag rid: 'SV-258858r933635_rule'\n  tag stig_id: 'PHTN-40-000192'\n  tag gtitle: 'SRG-OS-000021-GPOS-00005'\n  tag fix_id: 'F-62507r933634_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000044']\n  tag nist: ['AC-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258858.rb"},"title":"The Photon operating system must be configured to use the pam_faillock.so module.","desc":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nThis module maintains a list of failed authentication attempts per user during a specified interval and locks the account in case there were more than deny consecutive failed authentications.","descriptions":{"default":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nThis module maintains a list of failed authentication attempts per user during a specified interval and locks the account in case there were more than deny consecutive failed authentications.","check":"At the command line, run the following commands to verify the pam_faillock.so module is used:\n\n# grep '^auth' /etc/pam.d/system-auth\n\nExample result:\n\nauth required pam_faillock.so preauth\nauth required pam_unix.so\nauth required pam_faillock.so authfail\n\nIf the pam_faillock.so module is not present with the \"preauth\" line listed before pam_unix.so, this is a finding.\nIf the pam_faillock.so module is not present with the \"authfail\" line listed after pam_unix.so, this is a finding.\n\n# grep '^account' /etc/pam.d/system-account\n\nExample result:\n\naccount required pam_faillock.so\naccount required pam_unix.so\n\nIf the pam_faillock.so module is not present and listed before pam_unix.so, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-auth\n\nAdd or update the following lines making sure to place the preauth line before the pam_unix.so module:\n\nauth required pam_faillock.so preauth\nauth required pam_faillock.so authfail\n\nNavigate to and open:\n\n/etc/pam.d/system-account\n\nAdd or update the following lines making sure to place the line before the pam_unix.so module:\n\naccount required pam_faillock.so\n\nNote: The lines shown assume the /etc/security/faillock.conf file is used to configure pam_faillock.\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62598r933633_chk","severity":"medium","gid":"V-258858","rid":"SV-258858r933635_rule","stig_id":"PHTN-40-000192","gtitle":"SRG-OS-000021-GPOS-00005","fix_id":"F-62507r933634_fix","documentable":null,"cci":["CCI-000044"],"nist":["AC-7 a"]}},{"id":"SV-258859","code":"control 'SV-258859' do\n  title 'The Photon operating system must prevent leaking information of the existence of a user account.'\n  desc 'By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nIf the pam_faillock.so module is not configured to use the silent flag it could leak information about the existence or nonexistence of a user account.'\n  desc 'check', %q(At the command line, run the following command to verify account information is not leaked during the login process:\n\n# grep '^silent' /etc/security/faillock.conf\n\nExample result:\n\nsilent\n\nIf the \"silent\" option is not set, is missing or commented out, this is a finding.\n\nNote: If faillock.conf is not used to configure pam_faillock.so then these options may be specified on the faillock lines in the system-auth and system-account files.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\nsilent\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62599r933636_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258859'\n  tag rid: 'SV-258859r933638_rule'\n  tag stig_id: 'PHTN-40-000193'\n  tag gtitle: 'SRG-OS-000021-GPOS-00005'\n  tag fix_id: 'F-62508r933637_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000044']\n  tag nist: ['AC-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258859.rb"},"title":"The Photon operating system must prevent leaking information of the existence of a user account.","desc":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nIf the pam_faillock.so module is not configured to use the silent flag it could leak information about the existence or nonexistence of a user account.","descriptions":{"default":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nIf the pam_faillock.so module is not configured to use the silent flag it could leak information about the existence or nonexistence of a user account.","check":"At the command line, run the following command to verify account information is not leaked during the login process:\n\n# grep '^silent' /etc/security/faillock.conf\n\nExample result:\n\nsilent\n\nIf the \"silent\" option is not set, is missing or commented out, this is a finding.\n\nNote: If faillock.conf is not used to configure pam_faillock.so then these options may be specified on the faillock lines in the system-auth and system-account files.","fix":"Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\nsilent\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62599r933636_chk","severity":"medium","gid":"V-258859","rid":"SV-258859r933638_rule","stig_id":"PHTN-40-000193","gtitle":"SRG-OS-000021-GPOS-00005","fix_id":"F-62508r933637_fix","documentable":null,"cci":["CCI-000044"],"nist":["AC-7 a"]}},{"id":"SV-258860","code":"control 'SV-258860' do\n  title 'The Photon operating system must audit logon attempts for unknown users.'\n  desc 'By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.'\n  desc 'check', %q(At the command line, run the following command to verify that audit logon attempts for unknown users is performed:\n\n# grep '^audit' /etc/security/faillock.conf\n\nExample result:\n\naudit\n\nIf the \"audit\" option is not set, is missing or commented out, this is a finding.\n\nNote: If faillock.conf is not used to configure pam_faillock.so then these options may be specified on the faillock lines in the system-auth and system-account files.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\naudit\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62600r933639_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258860'\n  tag rid: 'SV-258860r933641_rule'\n  tag stig_id: 'PHTN-40-000194'\n  tag gtitle: 'SRG-OS-000021-GPOS-00005'\n  tag fix_id: 'F-62509r933640_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000044']\n  tag nist: ['AC-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258860.rb"},"title":"The Photon operating system must audit logon attempts for unknown users.","desc":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.","descriptions":{"default":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.","check":"At the command line, run the following command to verify that audit logon attempts for unknown users is performed:\n\n# grep '^audit' /etc/security/faillock.conf\n\nExample result:\n\naudit\n\nIf the \"audit\" option is not set, is missing or commented out, this is a finding.\n\nNote: If faillock.conf is not used to configure pam_faillock.so then these options may be specified on the faillock lines in the system-auth and system-account files.","fix":"Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\naudit\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62600r933639_chk","severity":"medium","gid":"V-258860","rid":"SV-258860r933641_rule","stig_id":"PHTN-40-000194","gtitle":"SRG-OS-000021-GPOS-00005","fix_id":"F-62509r933640_fix","documentable":null,"cci":["CCI-000044"],"nist":["AC-7 a"]}},{"id":"SV-258861","code":"control 'SV-258861' do\n  title 'The Photon operating system must include root when automatically locking an account until the locked account is released by an administrator when three unsuccessful logon attempts occur during a 15-minute time period.'\n  desc 'By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nUnless specified the root account is not included in the default faillock module options and should be included.'\n  desc 'check', %q(At the command line, run the following command to verify accounts are locked after three consecutive invalid logon attempts by a user during a 15-minute time period includes the root account:\n\n# grep '^even_deny_root' /etc/security/faillock.conf\n\nExample result:\n\neven_deny_root\n\nIf the \"even_deny_root\" option is not set, is missing or commented out, this is a finding.\n\nNote: If faillock.conf is not used to configure pam_faillock.so then these options may be specified on the faillock lines in the system-auth and system-account files.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\neven_deny_root\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62601r933642_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258861'\n  tag rid: 'SV-258861r933644_rule'\n  tag stig_id: 'PHTN-40-000195'\n  tag gtitle: 'SRG-OS-000021-GPOS-00005'\n  tag fix_id: 'F-62510r933643_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000044']\n  tag nist: ['AC-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258861.rb"},"title":"The Photon operating system must include root when automatically locking an account until the locked account is released by an administrator when three unsuccessful logon attempts occur during a 15-minute time period.","desc":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nUnless specified the root account is not included in the default faillock module options and should be included.","descriptions":{"default":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nUnless specified the root account is not included in the default faillock module options and should be included.","check":"At the command line, run the following command to verify accounts are locked after three consecutive invalid logon attempts by a user during a 15-minute time period includes the root account:\n\n# grep '^even_deny_root' /etc/security/faillock.conf\n\nExample result:\n\neven_deny_root\n\nIf the \"even_deny_root\" option is not set, is missing or commented out, this is a finding.\n\nNote: If faillock.conf is not used to configure pam_faillock.so then these options may be specified on the faillock lines in the system-auth and system-account files.","fix":"Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\neven_deny_root\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62601r933642_chk","severity":"medium","gid":"V-258861","rid":"SV-258861r933644_rule","stig_id":"PHTN-40-000195","gtitle":"SRG-OS-000021-GPOS-00005","fix_id":"F-62510r933643_fix","documentable":null,"cci":["CCI-000044"],"nist":["AC-7 a"]}},{"id":"SV-258862","code":"control 'SV-258862' do\n  title 'The Photon operating system must persist lockouts between system reboots.'\n  desc 'By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nBy default, account lockout information is stored under /var/run/faillock and is not persistent between reboots.'\n  desc 'check', %q(At the command line, run the following command to verify account locking persists lockouts between system reboots:\n\n# grep '^dir' /etc/security/faillock.conf\n\nExample result:\n\ndir = /var/log/faillock\n\nIf the \"dir\" option is set to \"/var/run/faillock\", this is a finding.\nIf the \"dir\" option is not set to a persistent documented faillock directory, is missing or commented out, this is a finding.\n\nNote: If faillock.conf is not used to configure pam_faillock.so then these options may be specified on the faillock lines in the system-auth and system-account files.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\ndir = /var/log/faillock\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62602r933645_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258862'\n  tag rid: 'SV-258862r933647_rule'\n  tag stig_id: 'PHTN-40-000196'\n  tag gtitle: 'SRG-OS-000021-GPOS-00005'\n  tag fix_id: 'F-62511r933646_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000044']\n  tag nist: ['AC-7 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258862.rb"},"title":"The Photon operating system must persist lockouts between system reboots.","desc":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nBy default, account lockout information is stored under /var/run/faillock and is not persistent between reboots.","descriptions":{"default":"By limiting the number of failed logon attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-force attacks, is reduced. Limits are imposed by locking the account.\n\nBy default, account lockout information is stored under /var/run/faillock and is not persistent between reboots.","check":"At the command line, run the following command to verify account locking persists lockouts between system reboots:\n\n# grep '^dir' /etc/security/faillock.conf\n\nExample result:\n\ndir = /var/log/faillock\n\nIf the \"dir\" option is set to \"/var/run/faillock\", this is a finding.\nIf the \"dir\" option is not set to a persistent documented faillock directory, is missing or commented out, this is a finding.\n\nNote: If faillock.conf is not used to configure pam_faillock.so then these options may be specified on the faillock lines in the system-auth and system-account files.","fix":"Navigate to and open:\n\n/etc/security/faillock.conf\n\nAdd or update the following lines:\n\ndir = /var/log/faillock\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62602r933645_chk","severity":"medium","gid":"V-258862","rid":"SV-258862r933647_rule","stig_id":"PHTN-40-000196","gtitle":"SRG-OS-000021-GPOS-00005","fix_id":"F-62511r933646_fix","documentable":null,"cci":["CCI-000044"],"nist":["AC-7 a"]}},{"id":"SV-258863","code":"control 'SV-258863' do\n  title 'The Photon operating system must be configured to use the pam_pwquality.so module.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.'\n  desc 'check', \"At the command line, run the following command to verify the pam_pwquality.so module is used:\n\n# grep '^password' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\npassword  required    pam_pwhistory.so  remember=5 retry=3 enforce_for_root use_authtok\npassword  required    pam_unix.so       sha512 use_authtok shadow try_first_pass\n\nIf the pam_pwquality.so module is not present, this is a finding.\"\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nAdd or update the pam_pwquality.so module line as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: The line must be configured before pam_pwhistory.so.\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62603r933648_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258863'\n  tag rid: 'SV-258863r933650_rule'\n  tag stig_id: 'PHTN-40-000197'\n  tag gtitle: 'SRG-OS-000069-GPOS-00037'\n  tag fix_id: 'F-62512r933649_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000192']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258863.rb"},"title":"The Photon operating system must be configured to use the pam_pwquality.so module.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determines how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.","check":"At the command line, run the following command to verify the pam_pwquality.so module is used:\n\n# grep '^password' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\npassword  required    pam_pwhistory.so  remember=5 retry=3 enforce_for_root use_authtok\npassword  required    pam_unix.so       sha512 use_authtok shadow try_first_pass\n\nIf the pam_pwquality.so module is not present, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nAdd or update the pam_pwquality.so module line as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: The line must be configured before pam_pwhistory.so.\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62603r933648_chk","severity":"medium","gid":"V-258863","rid":"SV-258863r933650_rule","stig_id":"PHTN-40-000197","gtitle":"SRG-OS-000069-GPOS-00037","fix_id":"F-62512r933649_fix","documentable":null,"cci":["CCI-000192"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-258864","code":"control 'SV-258864' do\n  title 'The Photon operating system TDNF package management tool must cryptographically verify the authenticity of all software packages during installation for all repos.'\n  desc 'Installation of any nontrusted software, patches, service packs, device drivers, or operating system components can significantly affect the overall security of the operating system. This requirement ensures the software has not been tampered with and has been provided by a trusted vendor.'\n  desc 'check', 'At the command line, run the following command to verify software packages are cryptographically verified during installation:\n\n# grep gpgcheck /etc/yum.repos.d/*\n\nIf \"gpgcheck\" is not set to \"1\" in any returned file, this is a finding.'\n  desc 'fix', 'Open the file where \"gpgcheck\" is not set to 1 with a text editor.\n\nAdd or update the following line:\n\ngpgcheck=1'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62604r933651_chk'\n  tag severity: 'high'\n  tag gid: 'V-258864'\n  tag rid: 'SV-258864r933653_rule'\n  tag stig_id: 'PHTN-40-000199'\n  tag gtitle: 'SRG-OS-000366-GPOS-00153'\n  tag fix_id: 'F-62513r933652_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001749']\n  tag nist: ['CM-5 (3)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258864.rb"},"title":"The Photon operating system TDNF package management tool must cryptographically verify the authenticity of all software packages during installation for all repos.","desc":"Installation of any nontrusted software, patches, service packs, device drivers, or operating system components can significantly affect the overall security of the operating system. This requirement ensures the software has not been tampered with and has been provided by a trusted vendor.","descriptions":{"default":"Installation of any nontrusted software, patches, service packs, device drivers, or operating system components can significantly affect the overall security of the operating system. This requirement ensures the software has not been tampered with and has been provided by a trusted vendor.","check":"At the command line, run the following command to verify software packages are cryptographically verified during installation:\n\n# grep gpgcheck /etc/yum.repos.d/*\n\nIf \"gpgcheck\" is not set to \"1\" in any returned file, this is a finding.","fix":"Open the file where \"gpgcheck\" is not set to 1 with a text editor.\n\nAdd or update the following line:\n\ngpgcheck=1"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62604r933651_chk","severity":"high","gid":"V-258864","rid":"SV-258864r933653_rule","stig_id":"PHTN-40-000199","gtitle":"SRG-OS-000366-GPOS-00153","fix_id":"F-62513r933652_fix","documentable":null,"cci":["CCI-001749"],"nist":["CM-5 (3)"]}},{"id":"SV-258865","code":"control 'SV-258865' do\n  title 'The Photon operating system must configure the Secure Shell (SSH) SyslogFacility.'\n  desc 'Automated monitoring of remote access sessions allows organizations to detect cyberattacks and ensure ongoing compliance with remote access policies by auditing connection activities.\n\nShipping sshd authentication events to syslog allows organizations to use their log aggregators to correlate forensic activities among multiple systems.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i SyslogFacility\n\nExample result:\n\nsyslogfacility AUTHPRIV\n\nIf \"syslogfacility\" is not set to \"AUTH\" or \"AUTHPRIV\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"SyslogFacility\" line is uncommented and set to the following:\n\nSyslogFacility AUTHPRIV\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62605r933654_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258865'\n  tag rid: 'SV-258865r933656_rule'\n  tag stig_id: 'PHTN-40-000200'\n  tag gtitle: 'SRG-OS-000032-GPOS-00013'\n  tag fix_id: 'F-62514r933655_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000067']\n  tag nist: ['AC-17 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258865.rb"},"title":"The Photon operating system must configure the Secure Shell (SSH) SyslogFacility.","desc":"Automated monitoring of remote access sessions allows organizations to detect cyberattacks and ensure ongoing compliance with remote access policies by auditing connection activities.\n\nShipping sshd authentication events to syslog allows organizations to use their log aggregators to correlate forensic activities among multiple systems.","descriptions":{"default":"Automated monitoring of remote access sessions allows organizations to detect cyberattacks and ensure ongoing compliance with remote access policies by auditing connection activities.\n\nShipping sshd authentication events to syslog allows organizations to use their log aggregators to correlate forensic activities among multiple systems.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i SyslogFacility\n\nExample result:\n\nsyslogfacility AUTHPRIV\n\nIf \"syslogfacility\" is not set to \"AUTH\" or \"AUTHPRIV\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"SyslogFacility\" line is uncommented and set to the following:\n\nSyslogFacility AUTHPRIV\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62605r933654_chk","severity":"medium","gid":"V-258865","rid":"SV-258865r933656_rule","stig_id":"PHTN-40-000200","gtitle":"SRG-OS-000032-GPOS-00013","fix_id":"F-62514r933655_fix","documentable":null,"cci":["CCI-000067"],"nist":["AC-17 (1)"]}},{"id":"SV-258866","code":"control 'SV-258866' do\n  title 'The Photon operating system must enable Secure Shell (SSH) authentication logging.'\n  desc 'Automated monitoring of remote access sessions allows organizations to detect cyberattacks and ensure ongoing compliance with remote access policies by auditing connection activities.\n\nThe INFO LogLevel is required, at least, to ensure the capturing of failed login events.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i LogLevel\n\nExample result:\n\nloglevel INFO\n\nIf \"LogLevel\" is not set to \"INFO\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"LogLevel\" line is uncommented and set to the following:\n\nLogLevel INFO\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62606r933657_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258866'\n  tag rid: 'SV-258866r933659_rule'\n  tag stig_id: 'PHTN-40-000201'\n  tag gtitle: 'SRG-OS-000032-GPOS-00013'\n  tag fix_id: 'F-62515r933658_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000067']\n  tag nist: ['AC-17 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258866.rb"},"title":"The Photon operating system must enable Secure Shell (SSH) authentication logging.","desc":"Automated monitoring of remote access sessions allows organizations to detect cyberattacks and ensure ongoing compliance with remote access policies by auditing connection activities.\n\nThe INFO LogLevel is required, at least, to ensure the capturing of failed login events.","descriptions":{"default":"Automated monitoring of remote access sessions allows organizations to detect cyberattacks and ensure ongoing compliance with remote access policies by auditing connection activities.\n\nThe INFO LogLevel is required, at least, to ensure the capturing of failed login events.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i LogLevel\n\nExample result:\n\nloglevel INFO\n\nIf \"LogLevel\" is not set to \"INFO\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"LogLevel\" line is uncommented and set to the following:\n\nLogLevel INFO\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62606r933657_chk","severity":"medium","gid":"V-258866","rid":"SV-258866r933659_rule","stig_id":"PHTN-40-000201","gtitle":"SRG-OS-000032-GPOS-00013","fix_id":"F-62515r933658_fix","documentable":null,"cci":["CCI-000067"],"nist":["AC-17 (1)"]}},{"id":"SV-258867","code":"control 'SV-258867' do\n  title 'The Photon operating system must terminate idle Secure Shell (SSH) sessions.'\n  desc 'Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.\n\nTerminating network connections associated with communications sessions includes, for example, deallocating associated TCP/IP address/port pairs at the operating system level, and deallocating networking assignments at the application level if multiple application sessions are using a single operating system-level network connection. This does not mean that the operating system terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i ClientAliveCountMax\n\nExpected result:\n\nclientalivecountmax 0\n\nIf \"ClientAliveCountMax\" is not set to \"0\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"ClientAliveCountMax\" line is uncommented and set to the following:\n\nClientAliveCountMax 0\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62607r933660_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258867'\n  tag rid: 'SV-258867r933662_rule'\n  tag stig_id: 'PHTN-40-000203'\n  tag gtitle: 'SRG-OS-000163-GPOS-00072'\n  tag fix_id: 'F-62516r933661_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001133']\n  tag nist: ['SC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258867.rb"},"title":"The Photon operating system must terminate idle Secure Shell (SSH) sessions.","desc":"Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.\n\nTerminating network connections associated with communications sessions includes, for example, deallocating associated TCP/IP address/port pairs at the operating system level, and deallocating networking assignments at the application level if multiple application sessions are using a single operating system-level network connection. This does not mean that the operating system terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.","descriptions":{"default":"Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.\n\nTerminating network connections associated with communications sessions includes, for example, deallocating associated TCP/IP address/port pairs at the operating system level, and deallocating networking assignments at the application level if multiple application sessions are using a single operating system-level network connection. This does not mean that the operating system terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i ClientAliveCountMax\n\nExpected result:\n\nclientalivecountmax 0\n\nIf \"ClientAliveCountMax\" is not set to \"0\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"ClientAliveCountMax\" line is uncommented and set to the following:\n\nClientAliveCountMax 0\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62607r933660_chk","severity":"medium","gid":"V-258867","rid":"SV-258867r933662_rule","stig_id":"PHTN-40-000203","gtitle":"SRG-OS-000163-GPOS-00072","fix_id":"F-62516r933661_fix","documentable":null,"cci":["CCI-001133"],"nist":["SC-10"]}},{"id":"SV-258868","code":"control 'SV-258868' do\n  title 'The Photon operating system must audit all account modifications.'\n  desc 'Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes.\n\nTo address access requirements, many operating systems can be integrated with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.\n\n'\n  desc 'check', 'At the command line, run the following command to verify an audit rule exists to audit account modifications:\n\n# auditctl -l | grep -E \"(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow)\"\n\nExpected result:\n\n-w /etc/passwd -p wa -k passwd\n-w /etc/shadow -p wa -k shadow\n-w /etc/group -p wa -k group\n-w /etc/gshadow -p wa -k gshadow\n\nIf the output does not match the expected result, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /etc/passwd -p wa -k passwd\n-w /etc/shadow -p wa -k shadow\n-w /etc/group -p wa -k group\n-w /etc/gshadow -p wa -k gshadow\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62608r933663_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258868'\n  tag rid: 'SV-258868r933665_rule'\n  tag stig_id: 'PHTN-40-000204'\n  tag gtitle: 'SRG-OS-000239-GPOS-00089'\n  tag fix_id: 'F-62517r933664_fix'\n  tag satisfies: ['SRG-OS-000239-GPOS-00089', 'SRG-OS-000303-GPOS-00120', 'SRG-OS-000467-GPOS-00211']\n  tag 'documentable'\n  tag cci: ['CCI-000172', 'CCI-001403', 'CCI-002130']\n  tag nist: ['AU-12 c', 'AC-2 (4)', 'AC-2 (4)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258868.rb"},"title":"The Photon operating system must audit all account modifications.","desc":"Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes.\n\nTo address access requirements, many operating systems can be integrated with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.\n\n","descriptions":{"default":"Once an attacker establishes access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to modify an existing account. Auditing account modification actions provides logging that can be used for forensic purposes.\n\nTo address access requirements, many operating systems can be integrated with enterprise-level authentication/access/auditing mechanisms that meet or exceed access control policy requirements.\n\n","check":"At the command line, run the following command to verify an audit rule exists to audit account modifications:\n\n# auditctl -l | grep -E \"(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow)\"\n\nExpected result:\n\n-w /etc/passwd -p wa -k passwd\n-w /etc/shadow -p wa -k shadow\n-w /etc/group -p wa -k group\n-w /etc/gshadow -p wa -k gshadow\n\nIf the output does not match the expected result, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.","fix":"Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /etc/passwd -p wa -k passwd\n-w /etc/shadow -p wa -k shadow\n-w /etc/group -p wa -k group\n-w /etc/gshadow -p wa -k gshadow\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62608r933663_chk","severity":"medium","gid":"V-258868","rid":"SV-258868r933665_rule","stig_id":"PHTN-40-000204","gtitle":"SRG-OS-000239-GPOS-00089","fix_id":"F-62517r933664_fix","satisfies":["SRG-OS-000239-GPOS-00089","SRG-OS-000303-GPOS-00120","SRG-OS-000467-GPOS-00211"],"documentable":null,"cci":["CCI-000172","CCI-001403","CCI-002130"],"nist":["AU-12 c","AC-2 (4)","AC-2 (4)"]}},{"id":"SV-258869","code":"control 'SV-258869' do\n  title 'The Photon operating system must enforce a delay of at least four seconds between logon prompts following a failed logon attempt.'\n  desc 'Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.'\n  desc 'check', \"At the command line, run the following command to verify the pam_faildelay.so module is used:\n\n# grep '^auth' /etc/pam.d/system-auth\n\nExample result:\n\nauth required pam_faillock.so preauth\nauth required pam_unix.so\nauth required pam_faillock.so authfail\nauth optional pam_faildelay.so delay=4000000\n\nIf the pam_faildelay.so module is not present with the delay set to at least four seconds, this is a finding.\n\nNote: The delay is configured in milliseconds.\"\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-auth\n\nAdd or update the following line:\n\nauth optional pam_faildelay.so delay=4000000\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62609r933666_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258869'\n  tag rid: 'SV-258869r933668_rule'\n  tag stig_id: 'PHTN-40-000206'\n  tag gtitle: 'SRG-OS-000480-GPOS-00226'\n  tag fix_id: 'F-62518r933667_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258869.rb"},"title":"The Photon operating system must enforce a delay of at least four seconds between logon prompts following a failed logon attempt.","desc":"Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.","descriptions":{"default":"Limiting the number of logon attempts over a certain time interval reduces the chances that an unauthorized user may gain access to an account.","check":"At the command line, run the following command to verify the pam_faildelay.so module is used:\n\n# grep '^auth' /etc/pam.d/system-auth\n\nExample result:\n\nauth required pam_faillock.so preauth\nauth required pam_unix.so\nauth required pam_faillock.so authfail\nauth optional pam_faildelay.so delay=4000000\n\nIf the pam_faildelay.so module is not present with the delay set to at least four seconds, this is a finding.\n\nNote: The delay is configured in milliseconds.","fix":"Navigate to and open:\n\n/etc/pam.d/system-auth\n\nAdd or update the following line:\n\nauth optional pam_faildelay.so delay=4000000\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62609r933666_chk","severity":"medium","gid":"V-258869","rid":"SV-258869r933668_rule","stig_id":"PHTN-40-000206","gtitle":"SRG-OS-000480-GPOS-00226","fix_id":"F-62518r933667_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258870","code":"control 'SV-258870' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to disallow authentication with an empty password.'\n  desc 'Blank passwords are one of the first things an attacker checks for when probing a system. Even if the user somehow has a blank password on the OS, SSH must not allow that user to log in.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i PermitEmptyPasswords\n\nExample result:\n\npermitemptypasswords no\n\nIf \"PermitEmptyPasswords\" is not set to \"no\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"PermitEmptyPasswords\" line is uncommented and set to the following:\n\nPermitEmptyPasswords no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62610r933669_chk'\n  tag severity: 'high'\n  tag gid: 'V-258870'\n  tag rid: 'SV-258870r933671_rule'\n  tag stig_id: 'PHTN-40-000207'\n  tag gtitle: 'SRG-OS-000480-GPOS-00229'\n  tag fix_id: 'F-62519r933670_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258870.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to disallow authentication with an empty password.","desc":"Blank passwords are one of the first things an attacker checks for when probing a system. Even if the user somehow has a blank password on the OS, SSH must not allow that user to log in.","descriptions":{"default":"Blank passwords are one of the first things an attacker checks for when probing a system. Even if the user somehow has a blank password on the OS, SSH must not allow that user to log in.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i PermitEmptyPasswords\n\nExample result:\n\npermitemptypasswords no\n\nIf \"PermitEmptyPasswords\" is not set to \"no\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"PermitEmptyPasswords\" line is uncommented and set to the following:\n\nPermitEmptyPasswords no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62610r933669_chk","severity":"high","gid":"V-258870","rid":"SV-258870r933671_rule","stig_id":"PHTN-40-000207","gtitle":"SRG-OS-000480-GPOS-00229","fix_id":"F-62519r933670_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258871","code":"control 'SV-258871' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to disable user environment processing.'\n  desc 'Enabling user environment processing may enable users to bypass access restrictions in some configurations and must therefore be disabled.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i PermitUserEnvironment\n\nExample result:\n\npermituserenvironment no\n\nIf \"PermitUserEnvironment\" is not set to \"no\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"PermitUserEnvironment\" line is uncommented and set to the following:\n\nPermitUserEnvironment no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62611r933672_chk'\n  tag severity: 'high'\n  tag gid: 'V-258871'\n  tag rid: 'SV-258871r933674_rule'\n  tag stig_id: 'PHTN-40-000208'\n  tag gtitle: 'SRG-OS-000480-GPOS-00229'\n  tag fix_id: 'F-62520r933673_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258871.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to disable user environment processing.","desc":"Enabling user environment processing may enable users to bypass access restrictions in some configurations and must therefore be disabled.","descriptions":{"default":"Enabling user environment processing may enable users to bypass access restrictions in some configurations and must therefore be disabled.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i PermitUserEnvironment\n\nExample result:\n\npermituserenvironment no\n\nIf \"PermitUserEnvironment\" is not set to \"no\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"PermitUserEnvironment\" line is uncommented and set to the following:\n\nPermitUserEnvironment no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62611r933672_chk","severity":"high","gid":"V-258871","rid":"SV-258871r933674_rule","stig_id":"PHTN-40-000208","gtitle":"SRG-OS-000480-GPOS-00229","fix_id":"F-62520r933673_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258872","code":"control 'SV-258872' do\n  title 'The Photon operating system must create a home directory for all new local interactive user accounts.'\n  desc 'If local interactive users are not assigned a valid home directory, there is no place for the storage and control of files they should own.'\n  desc 'check', %q(At the command line, run the following command to verify a home directory is created for all new user accounts:\n\n# grep '^CREATE_HOME' /etc/login.defs\n\nExample result:\n\nCREATE_HOME yes\n\nIf the \"CREATE_HOME\" option is not set to \"yes\", is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line:\n\nCREATE_HOME yes'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62612r933675_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258872'\n  tag rid: 'SV-258872r933677_rule'\n  tag stig_id: 'PHTN-40-000209'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62521r933676_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258872.rb"},"title":"The Photon operating system must create a home directory for all new local interactive user accounts.","desc":"If local interactive users are not assigned a valid home directory, there is no place for the storage and control of files they should own.","descriptions":{"default":"If local interactive users are not assigned a valid home directory, there is no place for the storage and control of files they should own.","check":"At the command line, run the following command to verify a home directory is created for all new user accounts:\n\n# grep '^CREATE_HOME' /etc/login.defs\n\nExample result:\n\nCREATE_HOME yes\n\nIf the \"CREATE_HOME\" option is not set to \"yes\", is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/login.defs\n\nAdd or update the following line:\n\nCREATE_HOME yes"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62612r933675_chk","severity":"medium","gid":"V-258872","rid":"SV-258872r933677_rule","stig_id":"PHTN-40-000209","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62521r933676_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258873","code":"control 'SV-258873' do\n  title 'The Photon operating system must disable the debug-shell service.'\n  desc 'The debug-shell service is intended to diagnose systemd related boot issues with various systemctl commands. Once enabled and following a system reboot, the root shell will be available on tty9. This service must remain disabled until and unless otherwise directed by VMware support.'\n  desc 'check', 'At the command line, run the following command to verify the debug-shell service is disabled:\n\n# systemctl status debug-shell.service\n\nIf the debug-shell service is not stopped and disabled, this is a finding.'\n  desc 'fix', 'At the command line, run the following commands:\n\n# systemctl stop debug-shell.service\n# systemctl disable debug-shell.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62613r933678_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258873'\n  tag rid: 'SV-258873r933680_rule'\n  tag stig_id: 'PHTN-40-000210'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62522r933679_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258873.rb"},"title":"The Photon operating system must disable the debug-shell service.","desc":"The debug-shell service is intended to diagnose systemd related boot issues with various systemctl commands. Once enabled and following a system reboot, the root shell will be available on tty9. This service must remain disabled until and unless otherwise directed by VMware support.","descriptions":{"default":"The debug-shell service is intended to diagnose systemd related boot issues with various systemctl commands. Once enabled and following a system reboot, the root shell will be available on tty9. This service must remain disabled until and unless otherwise directed by VMware support.","check":"At the command line, run the following command to verify the debug-shell service is disabled:\n\n# systemctl status debug-shell.service\n\nIf the debug-shell service is not stopped and disabled, this is a finding.","fix":"At the command line, run the following commands:\n\n# systemctl stop debug-shell.service\n# systemctl disable debug-shell.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62613r933678_chk","severity":"medium","gid":"V-258873","rid":"SV-258873r933680_rule","stig_id":"PHTN-40-000210","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62522r933679_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258874","code":"control 'SV-258874' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to disallow Generic Security Service Application Program Interface (GSSAPI) authentication.'\n  desc \"GSSAPI authentication is used to provide additional authentication mechanisms to applications. Allowing GSSAPI authentication through Secure Shell (SSH) exposes the system's GSSAPI to remote hosts, increasing the attack surface of the system.\"\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i GSSAPIAuthentication\n\nExample result:\n\ngssapiauthentication no\n\nIf \"GSSAPIAuthentication\" is not set to \"no\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"GSSAPIAuthentication\" line is uncommented and set to the following:\n\nGSSAPIAuthentication no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62614r933681_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258874'\n  tag rid: 'SV-258874r933683_rule'\n  tag stig_id: 'PHTN-40-000211'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62523r933682_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258874.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to disallow Generic Security Service Application Program Interface (GSSAPI) authentication.","desc":"GSSAPI authentication is used to provide additional authentication mechanisms to applications. Allowing GSSAPI authentication through Secure Shell (SSH) exposes the system's GSSAPI to remote hosts, increasing the attack surface of the system.","descriptions":{"default":"GSSAPI authentication is used to provide additional authentication mechanisms to applications. Allowing GSSAPI authentication through Secure Shell (SSH) exposes the system's GSSAPI to remote hosts, increasing the attack surface of the system.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i GSSAPIAuthentication\n\nExample result:\n\ngssapiauthentication no\n\nIf \"GSSAPIAuthentication\" is not set to \"no\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"GSSAPIAuthentication\" line is uncommented and set to the following:\n\nGSSAPIAuthentication no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62614r933681_chk","severity":"medium","gid":"V-258874","rid":"SV-258874r933683_rule","stig_id":"PHTN-40-000211","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62523r933682_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258875","code":"control 'SV-258875' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to disable X11 forwarding.'\n  desc 'X11 is an older, insecure graphics forwarding protocol. It is not used by Photon and should be disabled as a general best practice to limit attack surface area and communication channels.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i X11Forwarding\n\nExample result:\n\nx11forwarding no\n\nIf \"X11Forwarding\" is not set to \"no\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"X11Forwarding\" line is uncommented and set to the following:\n\nX11Forwarding no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62615r933684_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258875'\n  tag rid: 'SV-258875r933686_rule'\n  tag stig_id: 'PHTN-40-000212'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62524r933685_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258875.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to disable X11 forwarding.","desc":"X11 is an older, insecure graphics forwarding protocol. It is not used by Photon and should be disabled as a general best practice to limit attack surface area and communication channels.","descriptions":{"default":"X11 is an older, insecure graphics forwarding protocol. It is not used by Photon and should be disabled as a general best practice to limit attack surface area and communication channels.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i X11Forwarding\n\nExample result:\n\nx11forwarding no\n\nIf \"X11Forwarding\" is not set to \"no\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"X11Forwarding\" line is uncommented and set to the following:\n\nX11Forwarding no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62615r933684_chk","severity":"medium","gid":"V-258875","rid":"SV-258875r933686_rule","stig_id":"PHTN-40-000212","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62524r933685_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258876","code":"control 'SV-258876' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to perform strict mode checking of home directory configuration files.'\n  desc 'If other users have access to modify user-specific SSH configuration files, they may be able to log on to the system as another user.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i StrictModes\n\nExample result:\n\nstrictmodes yes\n\nIf \"StrictModes\" is not set to \"yes\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"StrictModes\" line is uncommented and set to the following:\n\nStrictModes yes\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62616r933687_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258876'\n  tag rid: 'SV-258876r933689_rule'\n  tag stig_id: 'PHTN-40-000213'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62525r933688_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258876.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to perform strict mode checking of home directory configuration files.","desc":"If other users have access to modify user-specific SSH configuration files, they may be able to log on to the system as another user.","descriptions":{"default":"If other users have access to modify user-specific SSH configuration files, they may be able to log on to the system as another user.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i StrictModes\n\nExample result:\n\nstrictmodes yes\n\nIf \"StrictModes\" is not set to \"yes\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"StrictModes\" line is uncommented and set to the following:\n\nStrictModes yes\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62616r933687_chk","severity":"medium","gid":"V-258876","rid":"SV-258876r933689_rule","stig_id":"PHTN-40-000213","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62525r933688_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258877","code":"control 'SV-258877' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to disallow Kerberos authentication.'\n  desc \"If Kerberos is enabled through SSH, sshd provides a means of access to the system's Kerberos implementation. Vulnerabilities in the system's Kerberos implementation may then be subject to exploitation. To reduce the attack surface of the system, the Kerberos authentication mechanism within SSH must be disabled.\"\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i KerberosAuthentication\n\nExample result:\n\nkerberosauthentication no\n\nIf \"KerberosAuthentication\" is not set to \"no\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"KerberosAuthentication\" line is uncommented and set to the following:\n\nKerberosAuthentication no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62617r933690_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258877'\n  tag rid: 'SV-258877r933692_rule'\n  tag stig_id: 'PHTN-40-000214'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62526r933691_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258877.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to disallow Kerberos authentication.","desc":"If Kerberos is enabled through SSH, sshd provides a means of access to the system's Kerberos implementation. Vulnerabilities in the system's Kerberos implementation may then be subject to exploitation. To reduce the attack surface of the system, the Kerberos authentication mechanism within SSH must be disabled.","descriptions":{"default":"If Kerberos is enabled through SSH, sshd provides a means of access to the system's Kerberos implementation. Vulnerabilities in the system's Kerberos implementation may then be subject to exploitation. To reduce the attack surface of the system, the Kerberos authentication mechanism within SSH must be disabled.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i KerberosAuthentication\n\nExample result:\n\nkerberosauthentication no\n\nIf \"KerberosAuthentication\" is not set to \"no\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"KerberosAuthentication\" line is uncommented and set to the following:\n\nKerberosAuthentication no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62617r933690_chk","severity":"medium","gid":"V-258877","rid":"SV-258877r933692_rule","stig_id":"PHTN-40-000214","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62526r933691_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258878","code":"control 'SV-258878' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to disallow compression of the encrypted session stream.'\n  desc 'If compression is allowed in an SSH connection prior to authentication, vulnerabilities in the compression software could result in compromise of the system from an unauthenticated connection.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i Compression\n\nExample result:\n\ncompression no\n\nIf there is no output or if \"Compression\" is not set to \"delayed\" or \"no\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"Compression\" line is uncommented and set to the following:\n\nCompression no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62618r933693_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258878'\n  tag rid: 'SV-258878r933695_rule'\n  tag stig_id: 'PHTN-40-000215'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62527r933694_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258878.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to disallow compression of the encrypted session stream.","desc":"If compression is allowed in an SSH connection prior to authentication, vulnerabilities in the compression software could result in compromise of the system from an unauthenticated connection.","descriptions":{"default":"If compression is allowed in an SSH connection prior to authentication, vulnerabilities in the compression software could result in compromise of the system from an unauthenticated connection.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i Compression\n\nExample result:\n\ncompression no\n\nIf there is no output or if \"Compression\" is not set to \"delayed\" or \"no\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"Compression\" line is uncommented and set to the following:\n\nCompression no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62618r933693_chk","severity":"medium","gid":"V-258878","rid":"SV-258878r933695_rule","stig_id":"PHTN-40-000215","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62527r933694_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258879","code":"control 'SV-258879' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to display the last login immediately after authentication.'\n  desc 'Providing users with feedback on the last time they logged on via SSH facilitates user recognition and reporting of unauthorized account use.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i PrintLastLog\n\nExample result:\n\nprintlastlog yes\n\nIf \"PrintLastLog\" is not set to \"yes\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"PrintLastLog\" line is uncommented and set to the following:\n\nPrintLastLog yes\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62619r933696_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258879'\n  tag rid: 'SV-258879r933698_rule'\n  tag stig_id: 'PHTN-40-000216'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62528r933697_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258879.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to display the last login immediately after authentication.","desc":"Providing users with feedback on the last time they logged on via SSH facilitates user recognition and reporting of unauthorized account use.","descriptions":{"default":"Providing users with feedback on the last time they logged on via SSH facilitates user recognition and reporting of unauthorized account use.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i PrintLastLog\n\nExample result:\n\nprintlastlog yes\n\nIf \"PrintLastLog\" is not set to \"yes\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"PrintLastLog\" line is uncommented and set to the following:\n\nPrintLastLog yes\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62619r933696_chk","severity":"medium","gid":"V-258879","rid":"SV-258879r933698_rule","stig_id":"PHTN-40-000216","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62528r933697_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258880","code":"control 'SV-258880' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to ignore user-specific trusted hosts lists.'\n  desc 'SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled. Individual users can have a local list of trusted remote machines, which must also be ignored while disabling host-based authentication generally.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i IgnoreRhosts\n\nExample result:\n\nignorerhosts yes\n\nIf \"IgnoreRhosts\" is not set to \"yes\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"IgnoreRhosts\" line is uncommented and set to the following:\n\nIgnoreRhosts yes\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62620r933699_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258880'\n  tag rid: 'SV-258880r933701_rule'\n  tag stig_id: 'PHTN-40-000217'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62529r933700_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258880.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to ignore user-specific trusted hosts lists.","desc":"SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled. Individual users can have a local list of trusted remote machines, which must also be ignored while disabling host-based authentication generally.","descriptions":{"default":"SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled. Individual users can have a local list of trusted remote machines, which must also be ignored while disabling host-based authentication generally.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i IgnoreRhosts\n\nExample result:\n\nignorerhosts yes\n\nIf \"IgnoreRhosts\" is not set to \"yes\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"IgnoreRhosts\" line is uncommented and set to the following:\n\nIgnoreRhosts yes\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62620r933699_chk","severity":"medium","gid":"V-258880","rid":"SV-258880r933701_rule","stig_id":"PHTN-40-000217","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62529r933700_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258881","code":"control 'SV-258881' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to ignore user-specific known_host files.'\n  desc 'SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled. Individual users can have a local list of trusted remote machines, which must also be ignored while disabling host-based authentication generally.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i IgnoreUserKnownHosts\n\nExpected result:\n\nignoreuserknownhosts yes\n\nIf \"IgnoreUserKnownHosts\" is not set to \"yes\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"IgnoreUserKnownHosts\" line is uncommented and set to the following:\n\nIgnoreUserKnownHosts yes\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62621r933702_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258881'\n  tag rid: 'SV-258881r935567_rule'\n  tag stig_id: 'PHTN-40-000218'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62530r933703_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258881.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to ignore user-specific known_host files.","desc":"SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled. Individual users can have a local list of trusted remote machines, which must also be ignored while disabling host-based authentication generally.","descriptions":{"default":"SSH trust relationships enable trivial lateral spread after a host compromise and therefore must be explicitly disabled. Individual users can have a local list of trusted remote machines, which must also be ignored while disabling host-based authentication generally.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i IgnoreUserKnownHosts\n\nExpected result:\n\nignoreuserknownhosts yes\n\nIf \"IgnoreUserKnownHosts\" is not set to \"yes\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"IgnoreUserKnownHosts\" line is uncommented and set to the following:\n\nIgnoreUserKnownHosts yes\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62621r933702_chk","severity":"medium","gid":"V-258881","rid":"SV-258881r935567_rule","stig_id":"PHTN-40-000218","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62530r933703_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258882","code":"control 'SV-258882' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to limit the number of allowed login attempts per connection.'\n  desc 'By setting the login attempt limit to a low value, an attacker will be forced to reconnect frequently, which severely limits the speed and effectiveness of brute-force attacks.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i MaxAuthTries\n\nExample result:\n\nmaxauthtries 6\n\nIf \"MaxAuthTries\" is not set to \"6\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"MaxAuthTries\" line is uncommented and set to the following:\n\nMaxAuthTries 6\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62622r933705_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258882'\n  tag rid: 'SV-258882r933707_rule'\n  tag stig_id: 'PHTN-40-000219'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62531r933706_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258882.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to limit the number of allowed login attempts per connection.","desc":"By setting the login attempt limit to a low value, an attacker will be forced to reconnect frequently, which severely limits the speed and effectiveness of brute-force attacks.","descriptions":{"default":"By setting the login attempt limit to a low value, an attacker will be forced to reconnect frequently, which severely limits the speed and effectiveness of brute-force attacks.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i MaxAuthTries\n\nExample result:\n\nmaxauthtries 6\n\nIf \"MaxAuthTries\" is not set to \"6\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"MaxAuthTries\" line is uncommented and set to the following:\n\nMaxAuthTries 6\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62622r933705_chk","severity":"medium","gid":"V-258882","rid":"SV-258882r933707_rule","stig_id":"PHTN-40-000219","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62531r933706_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258883","code":"control 'SV-258883' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to restrict AllowTcpForwarding.'\n  desc 'While enabling TCP tunnels is a valuable function of sshd, this feature is not appropriate for use on single purpose appliances.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i AllowTcpForwarding\n\nExample result:\n\nallowtcpforwarding no\n\nIf \"AllowTcpForwarding\" is not set to \"no\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"AllowTcpForwarding\" line is uncommented and set to the following:\n\nAllowTcpForwarding no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62623r933708_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258883'\n  tag rid: 'SV-258883r933710_rule'\n  tag stig_id: 'PHTN-40-000220'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62532r933709_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258883.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to restrict AllowTcpForwarding.","desc":"While enabling TCP tunnels is a valuable function of sshd, this feature is not appropriate for use on single purpose appliances.","descriptions":{"default":"While enabling TCP tunnels is a valuable function of sshd, this feature is not appropriate for use on single purpose appliances.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i AllowTcpForwarding\n\nExample result:\n\nallowtcpforwarding no\n\nIf \"AllowTcpForwarding\" is not set to \"no\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"AllowTcpForwarding\" line is uncommented and set to the following:\n\nAllowTcpForwarding no\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62623r933708_chk","severity":"medium","gid":"V-258883","rid":"SV-258883r933710_rule","stig_id":"PHTN-40-000220","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62532r933709_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258884","code":"control 'SV-258884' do\n  title 'The Photon operating system must configure Secure Shell (SSH) to restrict LoginGraceTime.'\n  desc 'By default, SSH unauthenticated connections are left open for two minutes before being closed. This setting is too permissive as no legitimate login would need such an amount of time to complete a login. Quickly terminating idle or incomplete login attempts will free up resources and reduce the exposure any partial logon attempts may create.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i LoginGraceTime\n\nExample result:\n\nlogingracetime 30\n\nIf \"LoginGraceTime\" is not set to \"30\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"LoginGraceTime\" line is uncommented and set to the following:\n\nLoginGraceTime 30\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62624r933711_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258884'\n  tag rid: 'SV-258884r933713_rule'\n  tag stig_id: 'PHTN-40-000221'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62533r933712_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258884.rb"},"title":"The Photon operating system must configure Secure Shell (SSH) to restrict LoginGraceTime.","desc":"By default, SSH unauthenticated connections are left open for two minutes before being closed. This setting is too permissive as no legitimate login would need such an amount of time to complete a login. Quickly terminating idle or incomplete login attempts will free up resources and reduce the exposure any partial logon attempts may create.","descriptions":{"default":"By default, SSH unauthenticated connections are left open for two minutes before being closed. This setting is too permissive as no legitimate login would need such an amount of time to complete a login. Quickly terminating idle or incomplete login attempts will free up resources and reduce the exposure any partial logon attempts may create.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i LoginGraceTime\n\nExample result:\n\nlogingracetime 30\n\nIf \"LoginGraceTime\" is not set to \"30\", this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"LoginGraceTime\" line is uncommented and set to the following:\n\nLoginGraceTime 30\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62624r933711_chk","severity":"medium","gid":"V-258884","rid":"SV-258884r933713_rule","stig_id":"PHTN-40-000221","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62533r933712_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258885","code":"control 'SV-258885' do\n  title 'The Photon operating system must be configured so that the x86 Ctrl-Alt-Delete key sequence is disabled on the command line.'\n  desc 'When the Ctrl-Alt-Del target is enabled, a locally logged-on user who presses Ctrl-Alt-Delete, when at the console, can reboot the system. If accidentally pressed, as could happen in the case of a mixed OS environment, this can create the risk of short-term loss of systems availability due to unintentional reboot.'\n  desc 'check', 'At the command line, run the following command to verify the ctrl-alt-del target is disabled and masked:\n\n# systemctl status ctrl-alt-del.target --no-pager\n\nExample output:\n\nctrl-alt-del.target\n                Loaded: masked (Reason: Unit ctrl-alt-del.target is masked.)\n                Active: inactive (dead)\n\nIf the \"ctrl-alt-del.target\" is not \"inactive\" and \"masked\", this is a finding.'\n  desc 'fix', 'At the command line, run the following commands:\n\n# systemctl disable ctrl-alt-del.target\n# systemctl mask ctrl-alt-del.target\n# systemctl daemon-reload'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62625r933714_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258885'\n  tag rid: 'SV-258885r933716_rule'\n  tag stig_id: 'PHTN-40-000222'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62534r933715_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258885.rb"},"title":"The Photon operating system must be configured so that the x86 Ctrl-Alt-Delete key sequence is disabled on the command line.","desc":"When the Ctrl-Alt-Del target is enabled, a locally logged-on user who presses Ctrl-Alt-Delete, when at the console, can reboot the system. If accidentally pressed, as could happen in the case of a mixed OS environment, this can create the risk of short-term loss of systems availability due to unintentional reboot.","descriptions":{"default":"When the Ctrl-Alt-Del target is enabled, a locally logged-on user who presses Ctrl-Alt-Delete, when at the console, can reboot the system. If accidentally pressed, as could happen in the case of a mixed OS environment, this can create the risk of short-term loss of systems availability due to unintentional reboot.","check":"At the command line, run the following command to verify the ctrl-alt-del target is disabled and masked:\n\n# systemctl status ctrl-alt-del.target --no-pager\n\nExample output:\n\nctrl-alt-del.target\n                Loaded: masked (Reason: Unit ctrl-alt-del.target is masked.)\n                Active: inactive (dead)\n\nIf the \"ctrl-alt-del.target\" is not \"inactive\" and \"masked\", this is a finding.","fix":"At the command line, run the following commands:\n\n# systemctl disable ctrl-alt-del.target\n# systemctl mask ctrl-alt-del.target\n# systemctl daemon-reload"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62625r933714_chk","severity":"medium","gid":"V-258885","rid":"SV-258885r933716_rule","stig_id":"PHTN-40-000222","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62534r933715_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258886","code":"control 'SV-258886' do\n  title 'The Photon operating system must not forward IPv4 or IPv6 source-routed packets.'\n  desc 'Source routing is an Internet Protocol mechanism that allows an IP packet to carry information, a list of addresses, that tells a router the path the packet must take. There is also an option to record the hops as the route is traversed.\n\nThe list of hops taken, the \"route record\", provides the destination with a return path to the source. This allows the source (the sending host) to specify the route, loosely or strictly, ignoring the routing tables of some or all of the routers. It can allow a user to redirect network traffic for malicious purposes and should therefore be disabled.'\n  desc 'check', 'At the command line, run the following command to verify source-routed packets are not forwarded:\n\n# /sbin/sysctl -a --pattern \"net.ipv[4|6].conf.(all|default).accept_source_route\"\n\nExpected result:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nIf the \"accept_source_route\" kernel parameters are not set to \"0\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62626r933717_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258886'\n  tag rid: 'SV-258886r933719_rule'\n  tag stig_id: 'PHTN-40-000223'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62535r933718_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258886.rb"},"title":"The Photon operating system must not forward IPv4 or IPv6 source-routed packets.","desc":"Source routing is an Internet Protocol mechanism that allows an IP packet to carry information, a list of addresses, that tells a router the path the packet must take. There is also an option to record the hops as the route is traversed.\n\nThe list of hops taken, the \"route record\", provides the destination with a return path to the source. This allows the source (the sending host) to specify the route, loosely or strictly, ignoring the routing tables of some or all of the routers. It can allow a user to redirect network traffic for malicious purposes and should therefore be disabled.","descriptions":{"default":"Source routing is an Internet Protocol mechanism that allows an IP packet to carry information, a list of addresses, that tells a router the path the packet must take. There is also an option to record the hops as the route is traversed.\n\nThe list of hops taken, the \"route record\", provides the destination with a return path to the source. This allows the source (the sending host) to specify the route, loosely or strictly, ignoring the routing tables of some or all of the routers. It can allow a user to redirect network traffic for malicious purposes and should therefore be disabled.","check":"At the command line, run the following command to verify source-routed packets are not forwarded:\n\n# /sbin/sysctl -a --pattern \"net.ipv[4|6].conf.(all|default).accept_source_route\"\n\nExpected result:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nIf the \"accept_source_route\" kernel parameters are not set to \"0\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nnet.ipv6.conf.all.accept_source_route = 0\nnet.ipv6.conf.default.accept_source_route = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62626r933717_chk","severity":"medium","gid":"V-258886","rid":"SV-258886r933719_rule","stig_id":"PHTN-40-000223","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62535r933718_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258887","code":"control 'SV-258887' do\n  title 'The Photon operating system must not respond to IPv4 Internet Control Message Protocol (ICMP) echoes sent to a broadcast address.'\n  desc 'Responding to broadcast (ICMP) echoes facilitates network mapping and provides a vector for amplification attacks.'\n  desc 'check', 'At the command line, run the following command to verify ICMP echoes sent to a broadcast address are ignored:\n\n# /sbin/sysctl net.ipv4.icmp_echo_ignore_broadcasts\n\nExample result:\n\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\n\nIf the \"net.ipv4.icmp_echo_ignore_broadcasts\" kernel parameter is not set to \"1\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62627r933720_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258887'\n  tag rid: 'SV-258887r933722_rule'\n  tag stig_id: 'PHTN-40-000224'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62536r933721_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258887.rb"},"title":"The Photon operating system must not respond to IPv4 Internet Control Message Protocol (ICMP) echoes sent to a broadcast address.","desc":"Responding to broadcast (ICMP) echoes facilitates network mapping and provides a vector for amplification attacks.","descriptions":{"default":"Responding to broadcast (ICMP) echoes facilitates network mapping and provides a vector for amplification attacks.","check":"At the command line, run the following command to verify ICMP echoes sent to a broadcast address are ignored:\n\n# /sbin/sysctl net.ipv4.icmp_echo_ignore_broadcasts\n\nExample result:\n\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\n\nIf the \"net.ipv4.icmp_echo_ignore_broadcasts\" kernel parameter is not set to \"1\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nnet.ipv4.icmp_echo_ignore_broadcasts = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62627r933720_chk","severity":"medium","gid":"V-258887","rid":"SV-258887r933722_rule","stig_id":"PHTN-40-000224","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62536r933721_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258888","code":"control 'SV-258888' do\n  title 'The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messages from being accepted.'\n  desc \"ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.\"\n  desc 'check', 'At the command line, run the following command to verify ICMP redirects are not accepted:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default).accept_redirects\"\n\nExpected result:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\n\nIf the \"accept_redirects\" kernel parameters are not set to \"0\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62628r933723_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258888'\n  tag rid: 'SV-258888r933725_rule'\n  tag stig_id: 'PHTN-40-000225'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62537r933724_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258888.rb"},"title":"The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messages from being accepted.","desc":"ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.","descriptions":{"default":"ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.","check":"At the command line, run the following command to verify ICMP redirects are not accepted:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default).accept_redirects\"\n\nExpected result:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\n\nIf the \"accept_redirects\" kernel parameters are not set to \"0\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.accept_redirects = 0\nnet.ipv4.conf.default.accept_redirects = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62628r933723_chk","severity":"medium","gid":"V-258888","rid":"SV-258888r933725_rule","stig_id":"PHTN-40-000225","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62537r933724_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258889","code":"control 'SV-258889' do\n  title 'The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) secure redirect messages from being accepted.'\n  desc \"ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.\"\n  desc 'check', 'At the command line, run the following command to verify ICMP secure redirects are not accepted:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default).secure_redirects\"\n\nExpected result:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\n\nIf the \"secure_redirects\" kernel parameters are not set to \"0\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62629r933726_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258889'\n  tag rid: 'SV-258889r933728_rule'\n  tag stig_id: 'PHTN-40-000226'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62538r933727_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258889.rb"},"title":"The Photon operating system must prevent IPv4 Internet Control Message Protocol (ICMP) secure redirect messages from being accepted.","desc":"ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.","descriptions":{"default":"ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.","check":"At the command line, run the following command to verify ICMP secure redirects are not accepted:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default).secure_redirects\"\n\nExpected result:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\n\nIf the \"secure_redirects\" kernel parameters are not set to \"0\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.secure_redirects = 0\nnet.ipv4.conf.default.secure_redirects = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62629r933726_chk","severity":"medium","gid":"V-258889","rid":"SV-258889r933728_rule","stig_id":"PHTN-40-000226","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62538r933727_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258890","code":"control 'SV-258890' do\n  title 'The Photon operating system must not send IPv4 Internet Control Message Protocol (ICMP) redirects.'\n  desc \"ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages contain information from the system's route table, possibly revealing portions of the network topology.\"\n  desc 'check', 'At the command line, run the following command to verify ICMP send redirects are not accepted:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default).send_redirects\"\n\nExpected result:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\nIf the \"send_redirects\" kernel parameters are not set to \"0\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62630r933729_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258890'\n  tag rid: 'SV-258890r933731_rule'\n  tag stig_id: 'PHTN-40-000227'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62539r933730_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258890.rb"},"title":"The Photon operating system must not send IPv4 Internet Control Message Protocol (ICMP) redirects.","desc":"ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages contain information from the system's route table, possibly revealing portions of the network topology.","descriptions":{"default":"ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages contain information from the system's route table, possibly revealing portions of the network topology.","check":"At the command line, run the following command to verify ICMP send redirects are not accepted:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default).send_redirects\"\n\nExpected result:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\nIf the \"send_redirects\" kernel parameters are not set to \"0\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62630r933729_chk","severity":"medium","gid":"V-258890","rid":"SV-258890r933731_rule","stig_id":"PHTN-40-000227","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62539r933730_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258891","code":"control 'SV-258891' do\n  title 'The Photon operating system must log IPv4 packets with impossible addresses.'\n  desc 'The presence of \"martian\" packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.'\n  desc 'check', 'At the command line, run the following command to verify martian packets are logged:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default).log_martians\"\n\nExpected result:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\n\nIf the \"log_martians\" kernel parameters are not set to \"1\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62631r933732_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258891'\n  tag rid: 'SV-258891r933734_rule'\n  tag stig_id: 'PHTN-40-000228'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62540r933733_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258891.rb"},"title":"The Photon operating system must log IPv4 packets with impossible addresses.","desc":"The presence of \"martian\" packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.","descriptions":{"default":"The presence of \"martian\" packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.","check":"At the command line, run the following command to verify martian packets are logged:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default).log_martians\"\n\nExpected result:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\n\nIf the \"log_martians\" kernel parameters are not set to \"1\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.log_martians = 1\nnet.ipv4.conf.default.log_martians = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62631r933732_chk","severity":"medium","gid":"V-258891","rid":"SV-258891r933734_rule","stig_id":"PHTN-40-000228","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62540r933733_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258892","code":"control 'SV-258892' do\n  title 'The Photon operating system must use a reverse-path filter for IPv4 network traffic.'\n  desc 'Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface they were received on. It should not be used on systems that are routers for complicated networks but is helpful for end hosts and routers serving small networks.'\n  desc 'check', 'At the command line, run the following command to verify IPv4 traffic is using a reverse path filter:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default).rp_filter\"\n\nExpected result:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\nIf the \"rp_filter\" kernel parameters are not set to \"1\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62632r933735_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258892'\n  tag rid: 'SV-258892r933737_rule'\n  tag stig_id: 'PHTN-40-000229'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62541r933736_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258892.rb"},"title":"The Photon operating system must use a reverse-path filter for IPv4 network traffic.","desc":"Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface they were received on. It should not be used on systems that are routers for complicated networks but is helpful for end hosts and routers serving small networks.","descriptions":{"default":"Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface they were received on. It should not be used on systems that are routers for complicated networks but is helpful for end hosts and routers serving small networks.","check":"At the command line, run the following command to verify IPv4 traffic is using a reverse path filter:\n\n# /sbin/sysctl -a --pattern \"net.ipv4.conf.(all|default).rp_filter\"\n\nExpected result:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\nIf the \"rp_filter\" kernel parameters are not set to \"1\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following lines:\n\nnet.ipv4.conf.all.rp_filter = 1\nnet.ipv4.conf.default.rp_filter = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62632r933735_chk","severity":"medium","gid":"V-258892","rid":"SV-258892r933737_rule","stig_id":"PHTN-40-000229","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62541r933736_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258893","code":"control 'SV-258893' do\n  title 'The Photon operating system must not perform IPv4 packet forwarding.'\n  desc 'Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.'\n  desc 'check', 'If IP forwarding is required, for example if Kubernetes is installed, this is Not Applicable.\n\nAt the command line, run the following command to verify packet forwarding it disabled:\n\n# /sbin/sysctl net.ipv4.ip_forward\n\nExpected result:\n\nnet.ipv4.ip_forward = 0\n\nIf the \"net.ipv4.ip_forward\" kernel parameter is not set to \"0\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nnet.ipv4.ip_forward = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62633r933738_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258893'\n  tag rid: 'SV-258893r933740_rule'\n  tag stig_id: 'PHTN-40-000231'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62542r933739_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258893.rb"},"title":"The Photon operating system must not perform IPv4 packet forwarding.","desc":"Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.","descriptions":{"default":"Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.","check":"If IP forwarding is required, for example if Kubernetes is installed, this is Not Applicable.\n\nAt the command line, run the following command to verify packet forwarding it disabled:\n\n# /sbin/sysctl net.ipv4.ip_forward\n\nExpected result:\n\nnet.ipv4.ip_forward = 0\n\nIf the \"net.ipv4.ip_forward\" kernel parameter is not set to \"0\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nnet.ipv4.ip_forward = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62633r933738_chk","severity":"medium","gid":"V-258893","rid":"SV-258893r933740_rule","stig_id":"PHTN-40-000231","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62542r933739_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258894","code":"control 'SV-258894' do\n  title 'The Photon operating system must send TCP timestamps.'\n  desc 'TCP timestamps are used to provide protection against wrapped sequence numbers. It is possible to calculate system uptime (and boot time) by analyzing TCP timestamps. These calculated uptimes can help a bad actor in determining likely patch levels for vulnerabilities.'\n  desc 'check', 'At the command line, run the following command to verify TCP timestamps are enabled:\n\n# /sbin/sysctl net.ipv4.tcp_timestamps\n\nExpected result:\n\nnet.ipv4.tcp_timestamps = 1\n\nIf the \"net.ipv4.tcp_timestamps\" kernel parameter is not set to \"1\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nnet.ipv4.tcp_timestamps = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62634r933741_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258894'\n  tag rid: 'SV-258894r933743_rule'\n  tag stig_id: 'PHTN-40-000232'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62543r933742_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258894.rb"},"title":"The Photon operating system must send TCP timestamps.","desc":"TCP timestamps are used to provide protection against wrapped sequence numbers. It is possible to calculate system uptime (and boot time) by analyzing TCP timestamps. These calculated uptimes can help a bad actor in determining likely patch levels for vulnerabilities.","descriptions":{"default":"TCP timestamps are used to provide protection against wrapped sequence numbers. It is possible to calculate system uptime (and boot time) by analyzing TCP timestamps. These calculated uptimes can help a bad actor in determining likely patch levels for vulnerabilities.","check":"At the command line, run the following command to verify TCP timestamps are enabled:\n\n# /sbin/sysctl net.ipv4.tcp_timestamps\n\nExpected result:\n\nnet.ipv4.tcp_timestamps = 1\n\nIf the \"net.ipv4.tcp_timestamps\" kernel parameter is not set to \"1\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nnet.ipv4.tcp_timestamps = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62634r933741_chk","severity":"medium","gid":"V-258894","rid":"SV-258894r933743_rule","stig_id":"PHTN-40-000232","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62543r933742_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258895","code":"control 'SV-258895' do\n  title 'The Photon operating system must be configured to protect the Secure Shell (SSH) public host key from unauthorized modification.'\n  desc 'If a public host key file is modified by an unauthorized user, the SSH service may be compromised.'\n  desc 'check', 'At the command line, run the following command:\n\n# stat -c \"%n permissions are %a and owned by %U:%G\" /etc/ssh/*key.pub\n\nExample result:\n\n/etc/ssh/ssh_host_dsa_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_ecdsa_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_ed25519_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_rsa_key.pub permissions are 644 and owned by root:root\n\nIf any \"key.pub\" file listed is not owned by root or not group owned by root or does not have permissions of \"0644\", this is a finding.'\n  desc 'fix', 'At the command line, run the following commands for each returned file:\n\n# chmod 644 <file>\n# chown root:root <file>\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62635r933744_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258895'\n  tag rid: 'SV-258895r933746_rule'\n  tag stig_id: 'PHTN-40-000233'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62544r933745_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258895.rb"},"title":"The Photon operating system must be configured to protect the Secure Shell (SSH) public host key from unauthorized modification.","desc":"If a public host key file is modified by an unauthorized user, the SSH service may be compromised.","descriptions":{"default":"If a public host key file is modified by an unauthorized user, the SSH service may be compromised.","check":"At the command line, run the following command:\n\n# stat -c \"%n permissions are %a and owned by %U:%G\" /etc/ssh/*key.pub\n\nExample result:\n\n/etc/ssh/ssh_host_dsa_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_ecdsa_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_ed25519_key.pub permissions are 644 and owned by root:root\n/etc/ssh/ssh_host_rsa_key.pub permissions are 644 and owned by root:root\n\nIf any \"key.pub\" file listed is not owned by root or not group owned by root or does not have permissions of \"0644\", this is a finding.","fix":"At the command line, run the following commands for each returned file:\n\n# chmod 644 <file>\n# chown root:root <file>\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62635r933744_chk","severity":"medium","gid":"V-258895","rid":"SV-258895r933746_rule","stig_id":"PHTN-40-000233","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62544r933745_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258896","code":"control 'SV-258896' do\n  title 'The Photon operating system must be configured to protect the Secure Shell (SSH) private host key from unauthorized access.'\n  desc 'If an unauthorized user obtains the private SSH host key file, the host could be impersonated.'\n  desc 'check', 'At the command line, run the following command:\n\n# stat -c \"%n permissions are %a and owned by %U:%G\" /etc/ssh/*key\n\nExample result:\n\n/etc/ssh/ssh_host_dsa_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_ecdsa_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_ed25519_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_rsa_key permissions are 600 and owned by root:root\n\nIf any key file listed is not owned by root or not group owned by root or does not have permissions of \"0600\", this is a finding.'\n  desc 'fix', 'At the command line, run the following commands for each returned file:\n\n# chmod 600 <file>\n# chown root:root <file>\n# systemctl restart sshd.service'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62636r933747_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258896'\n  tag rid: 'SV-258896r933749_rule'\n  tag stig_id: 'PHTN-40-000234'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62545r933748_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258896.rb"},"title":"The Photon operating system must be configured to protect the Secure Shell (SSH) private host key from unauthorized access.","desc":"If an unauthorized user obtains the private SSH host key file, the host could be impersonated.","descriptions":{"default":"If an unauthorized user obtains the private SSH host key file, the host could be impersonated.","check":"At the command line, run the following command:\n\n# stat -c \"%n permissions are %a and owned by %U:%G\" /etc/ssh/*key\n\nExample result:\n\n/etc/ssh/ssh_host_dsa_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_ecdsa_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_ed25519_key permissions are 600 and owned by root:root\n/etc/ssh/ssh_host_rsa_key permissions are 600 and owned by root:root\n\nIf any key file listed is not owned by root or not group owned by root or does not have permissions of \"0600\", this is a finding.","fix":"At the command line, run the following commands for each returned file:\n\n# chmod 600 <file>\n# chown root:root <file>\n# systemctl restart sshd.service"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62636r933747_chk","severity":"medium","gid":"V-258896","rid":"SV-258896r933749_rule","stig_id":"PHTN-40-000234","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62545r933748_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258897","code":"control 'SV-258897' do\n  title 'The Photon operating system must enforce password complexity on the root account.'\n  desc 'Password complexity rules must apply to all accounts on the system, including root. Without specifying the enforce_for_root flag, pam_pwquality does not apply complexity rules to the root user. While root users can find ways around this requirement, given its superuser power, it is necessary to attempt to force compliance.'\n  desc 'check', %q(At the command line, run the following command to verify password complexity is enforced for the root account:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"enforce_for_root\" option is missing or commented out, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"enforce_for_root\" option present as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62637r933750_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258897'\n  tag rid: 'SV-258897r933752_rule'\n  tag stig_id: 'PHTN-40-000235'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62546r933751_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258897.rb"},"title":"The Photon operating system must enforce password complexity on the root account.","desc":"Password complexity rules must apply to all accounts on the system, including root. Without specifying the enforce_for_root flag, pam_pwquality does not apply complexity rules to the root user. While root users can find ways around this requirement, given its superuser power, it is necessary to attempt to force compliance.","descriptions":{"default":"Password complexity rules must apply to all accounts on the system, including root. Without specifying the enforce_for_root flag, pam_pwquality does not apply complexity rules to the root user. While root users can find ways around this requirement, given its superuser power, it is necessary to attempt to force compliance.","check":"At the command line, run the following command to verify password complexity is enforced for the root account:\n\n# grep '^password.*pam_pwquality.so' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nIf the \"enforce_for_root\" option is missing or commented out, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nConfigure the pam_pwquality.so line to have the \"enforce_for_root\" option present as follows:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62637r933750_chk","severity":"medium","gid":"V-258897","rid":"SV-258897r933752_rule","stig_id":"PHTN-40-000235","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62546r933751_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258898","code":"control 'SV-258898' do\n  title 'The Photon operating system must disable systemd fallback DNS.'\n  desc 'Systemd contains an ability to set fallback DNS servers, which is used for DNS lookups in the event no system level DNS servers are configured or other DNS servers are specified in the Systemd resolved.conf file. If uncommented, this configuration contains Google DNS servers by default and could result in DNS leaking info unknowingly in the event DNS is absent or misconfigured at the system level.'\n  desc 'check', \"At the command line, run the following command to verify systemd fallback DNS is disabled:\n\n# resolvectl status | grep '^Fallback DNS'\n\nIf the output indicates that Fallback DNS servers are configured, this is a finding.\"\n  desc 'fix', 'Navigate to and open:\n\n/etc/systemd/resolved.conf\n\nAdd or update the \"FallbackDNS\" entry to the following:\n\nFallbackDNS=\n\nRestart the Systemd resolved service by running the following command:\n\n# systemctl restart systemd-resolved\n\nNote: If this option is not given, a compiled-in list of DNS servers is used instead, which is undesirable.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62638r933753_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258898'\n  tag rid: 'SV-258898r935569_rule'\n  tag stig_id: 'PHTN-40-000236'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62547r935568_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258898.rb"},"title":"The Photon operating system must disable systemd fallback DNS.","desc":"Systemd contains an ability to set fallback DNS servers, which is used for DNS lookups in the event no system level DNS servers are configured or other DNS servers are specified in the Systemd resolved.conf file. If uncommented, this configuration contains Google DNS servers by default and could result in DNS leaking info unknowingly in the event DNS is absent or misconfigured at the system level.","descriptions":{"default":"Systemd contains an ability to set fallback DNS servers, which is used for DNS lookups in the event no system level DNS servers are configured or other DNS servers are specified in the Systemd resolved.conf file. If uncommented, this configuration contains Google DNS servers by default and could result in DNS leaking info unknowingly in the event DNS is absent or misconfigured at the system level.","check":"At the command line, run the following command to verify systemd fallback DNS is disabled:\n\n# resolvectl status | grep '^Fallback DNS'\n\nIf the output indicates that Fallback DNS servers are configured, this is a finding.","fix":"Navigate to and open:\n\n/etc/systemd/resolved.conf\n\nAdd or update the \"FallbackDNS\" entry to the following:\n\nFallbackDNS=\n\nRestart the Systemd resolved service by running the following command:\n\n# systemctl restart systemd-resolved\n\nNote: If this option is not given, a compiled-in list of DNS servers is used instead, which is undesirable."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62638r933753_chk","severity":"medium","gid":"V-258898","rid":"SV-258898r935569_rule","stig_id":"PHTN-40-000236","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62547r935568_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258899","code":"control 'SV-258899' do\n  title 'The Photon operating system must generate audit records for all access and modifications to the opasswd file.'\n  desc 'Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.'\n  desc 'check', 'At the command line, run the following command to verify an audit rule exists to audit the opasswd file:\n\n# auditctl -l | grep -E /etc/security/opasswd\n\nExpected result:\n\n-w /etc/security/opasswd -p wa -k opasswd\n\nIf the opasswd file is not monitored for access or writes, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /etc/security/opasswd -p wa -k opasswd\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62639r933756_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258899'\n  tag rid: 'SV-258899r933758_rule'\n  tag stig_id: 'PHTN-40-000238'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62548r933757_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258899.rb"},"title":"The Photon operating system must generate audit records for all access and modifications to the opasswd file.","desc":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.","descriptions":{"default":"Without the capability to generate audit records, it would be difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.","check":"At the command line, run the following command to verify an audit rule exists to audit the opasswd file:\n\n# auditctl -l | grep -E /etc/security/opasswd\n\nExpected result:\n\n-w /etc/security/opasswd -p wa -k opasswd\n\nIf the opasswd file is not monitored for access or writes, this is a finding.\n\nNote: This check depends on the \"auditd\" service to be in a running state for accurate results. The \"auditd\" service is enabled in control PHTN-40-000016.","fix":"Navigate to and open:\n\n/etc/audit/rules.d/audit.STIG.rules\n\nAdd or update the following lines:\n\n-w /etc/security/opasswd -p wa -k opasswd\n\nAt the command line, run the following command to load the new audit rules:\n\n# /sbin/augenrules --load\n\nNote: An \"audit.STIG.rules\" file is provided with this guidance for placement in \"/etc/audit/rules.d\" that contains all rules needed for auditd.\n\nNote: An older \"audit.STIG.rules\" may exist and may reference older \"GEN\" SRG IDs. This file can be removed and replaced as necessary with an updated one."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62639r933756_chk","severity":"medium","gid":"V-258899","rid":"SV-258899r933758_rule","stig_id":"PHTN-40-000238","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62548r933757_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258900","code":"control 'SV-258900' do\n  title 'The Photon operating system must implement only approved Message Authentication Codes (MACs) to protect the integrity of remote access sessions.'\n  desc 'Without cryptographic integrity protections, information can be altered by unauthorized users without detection.\n\nRemote access (e.g., RDP) is access to DOD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nCryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash.'\n  desc 'check', 'At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i MACs\n\nExample result:\n\nmacs hmac-sha2-512,hmac-sha2-256\n\nIf the output matches the macs in the example result or a subset thereof, this is not a finding.\n\nIf the output contains any macs not listed in the example result, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"MACs\" line is uncommented and set to the following:\n\nMACs hmac-sha2-512,hmac-sha2-256\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service'\n  impact 0.7\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62640r933759_chk'\n  tag severity: 'high'\n  tag gid: 'V-258900'\n  tag rid: 'SV-258900r933761_rule'\n  tag stig_id: 'PHTN-40-000239'\n  tag gtitle: 'SRG-OS-000250-GPOS-00093'\n  tag fix_id: 'F-62549r933760_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001453']\n  tag nist: ['AC-17 (2)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258900.rb"},"title":"The Photon operating system must implement only approved Message Authentication Codes (MACs) to protect the integrity of remote access sessions.","desc":"Without cryptographic integrity protections, information can be altered by unauthorized users without detection.\n\nRemote access (e.g., RDP) is access to DOD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nCryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash.","descriptions":{"default":"Without cryptographic integrity protections, information can be altered by unauthorized users without detection.\n\nRemote access (e.g., RDP) is access to DOD nonpublic information systems by an authorized user (or an information system) communicating through an external, nonorganization-controlled network. Remote access methods include, for example, dial-up, broadband, and wireless.\n\nCryptographic mechanisms used for protecting the integrity of information include, for example, signed hash functions using asymmetric cryptography enabling distribution of the public key to verify the hash information while maintaining the confidentiality of the secret key used to generate the hash.","check":"At the command line, run the following command to verify the running configuration of sshd:\n\n# sshd -T|&grep -i MACs\n\nExample result:\n\nmacs hmac-sha2-512,hmac-sha2-256\n\nIf the output matches the macs in the example result or a subset thereof, this is not a finding.\n\nIf the output contains any macs not listed in the example result, this is a finding.","fix":"Navigate to and open:\n\n/etc/ssh/sshd_config\n\nEnsure the \"MACs\" line is uncommented and set to the following:\n\nMACs hmac-sha2-512,hmac-sha2-256\n\nAt the command line, run the following command:\n\n# systemctl restart sshd.service"},"impact":0.7,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62640r933759_chk","severity":"high","gid":"V-258900","rid":"SV-258900r933761_rule","stig_id":"PHTN-40-000239","gtitle":"SRG-OS-000250-GPOS-00093","fix_id":"F-62549r933760_fix","documentable":null,"cci":["CCI-001453"],"nist":["AC-17 (2)"]}},{"id":"SV-258901","code":"control 'SV-258901' do\n  title 'The Photon operating system must enable the rsyslog service.'\n  desc 'Information stored in one location is vulnerable to accidental or incidental deletion or alteration. Off-loading is a common process in information systems with limited audit storage capacity.'\n  desc 'check', 'If another package is used to offload logs, such as syslog-ng, and is properly configured, this is not applicable.\n\nAt the command line, run the following command to verify rsyslog is enabled and running:\n\n# systemctl status rsyslog\n\nIf the rsyslog service is not enabled and running, this is a finding.'\n  desc 'fix', 'At the command line, run the following commands:\n\n# systemctl enable rsyslog\n# systemctl start rsyslog'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62641r933762_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258901'\n  tag rid: 'SV-258901r933764_rule'\n  tag stig_id: 'PHTN-40-000242'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62550r933763_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258901.rb"},"title":"The Photon operating system must enable the rsyslog service.","desc":"Information stored in one location is vulnerable to accidental or incidental deletion or alteration. Off-loading is a common process in information systems with limited audit storage capacity.","descriptions":{"default":"Information stored in one location is vulnerable to accidental or incidental deletion or alteration. Off-loading is a common process in information systems with limited audit storage capacity.","check":"If another package is used to offload logs, such as syslog-ng, and is properly configured, this is not applicable.\n\nAt the command line, run the following command to verify rsyslog is enabled and running:\n\n# systemctl status rsyslog\n\nIf the rsyslog service is not enabled and running, this is a finding.","fix":"At the command line, run the following commands:\n\n# systemctl enable rsyslog\n# systemctl start rsyslog"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62641r933762_chk","severity":"medium","gid":"V-258901","rid":"SV-258901r933764_rule","stig_id":"PHTN-40-000242","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62550r933763_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258902","code":"control 'SV-258902' do\n  title 'The Photon operating system must be configured to use the pam_pwhistory.so module.'\n  desc 'Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.'\n  desc 'check', %q(At the command line, run the following command to verify the pam_pwhistory.so module is used:\n\n# grep '^password' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\npassword  required    pam_pwhistory.so  remember=5 retry=3 enforce_for_root use_authtok\npassword  required    pam_unix.so       sha512 use_authtok shadow try_first_pass\n\nIf the \"pam_pwhistory.so\" module is not present, this is a finding.\nIf \"use_authtok\" is not present for the \"pam_pwhistory.so\" module, this is a finding.\nIf \"conf\" or \"file\" are present for the \"pam_pwhistory.so\" module, this is a finding.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/pam.d/system-password\n\nAdd or update the pam_pwhistory.so module line as follows:\n\npassword  required    pam_pwhistory.so  remember=5 retry=3 enforce_for_root use_authtok\n\nNote: The line must be configured after pam_pwquality.so.\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62642r933765_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258902'\n  tag rid: 'SV-258902r933767_rule'\n  tag stig_id: 'PHTN-40-000243'\n  tag gtitle: 'SRG-OS-000077-GPOS-00045'\n  tag fix_id: 'F-62551r933766_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000200']\n  tag nist: ['IA-5 (1) (e)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258902.rb"},"title":"The Photon operating system must be configured to use the pam_pwhistory.so module.","desc":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.","descriptions":{"default":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If the information system or application allows the user to consecutively reuse their password when that password has exceeded its defined lifetime, the end result is a password that is not changed as per policy requirements.","check":"At the command line, run the following command to verify the pam_pwhistory.so module is used:\n\n# grep '^password' /etc/pam.d/system-password\n\nExample result:\n\npassword  requisite   pam_pwquality.so  dcredit=-1 ucredit=-1 lcredit=-1 ocredit=-1 minlen=15 difok=8 enforce_for_root dictcheck=1\npassword  required    pam_pwhistory.so  remember=5 retry=3 enforce_for_root use_authtok\npassword  required    pam_unix.so       sha512 use_authtok shadow try_first_pass\n\nIf the \"pam_pwhistory.so\" module is not present, this is a finding.\nIf \"use_authtok\" is not present for the \"pam_pwhistory.so\" module, this is a finding.\nIf \"conf\" or \"file\" are present for the \"pam_pwhistory.so\" module, this is a finding.","fix":"Navigate to and open:\n\n/etc/pam.d/system-password\n\nAdd or update the pam_pwhistory.so module line as follows:\n\npassword  required    pam_pwhistory.so  remember=5 retry=3 enforce_for_root use_authtok\n\nNote: The line must be configured after pam_pwquality.so.\n\nNote: On vCenter appliances, the equivalent file must be edited under \"/etc/applmgmt/appliance\", if one exists, for the changes to persist after a reboot."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62642r933765_chk","severity":"medium","gid":"V-258902","rid":"SV-258902r933767_rule","stig_id":"PHTN-40-000243","gtitle":"SRG-OS-000077-GPOS-00045","fix_id":"F-62551r933766_fix","documentable":null,"cci":["CCI-000200"],"nist":["IA-5 (1) (e)"]}},{"id":"SV-258903","code":"control 'SV-258903' do\n  title 'The Photon operating system must enable hardlink access control protection in the kernel.'\n  desc 'By enabling the fs.protected_hardlinks kernel parameter, users can no longer create soft or hard links to files they do not own. Disallowing such hardlinks mitigate vulnerabilities based on insecure file system accessed by privileged programs, avoiding an exploitation vector exploiting unsafe use of open() or creat().'\n  desc 'check', 'At the command line, run the following command to verify hardlink protection is enabled:\n\n# /sbin/sysctl fs.protected_hardlinks\n\nExample result:\n\nfs.protected_hardlinks = 1\n\nIf the \"fs.protected_hardlinks\" kernel parameter is not set to \"1\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nfs.protected_hardlinks = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62643r933768_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258903'\n  tag rid: 'SV-258903r933770_rule'\n  tag stig_id: 'PHTN-40-000244'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62552r933769_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258903.rb"},"title":"The Photon operating system must enable hardlink access control protection in the kernel.","desc":"By enabling the fs.protected_hardlinks kernel parameter, users can no longer create soft or hard links to files they do not own. Disallowing such hardlinks mitigate vulnerabilities based on insecure file system accessed by privileged programs, avoiding an exploitation vector exploiting unsafe use of open() or creat().","descriptions":{"default":"By enabling the fs.protected_hardlinks kernel parameter, users can no longer create soft or hard links to files they do not own. Disallowing such hardlinks mitigate vulnerabilities based on insecure file system accessed by privileged programs, avoiding an exploitation vector exploiting unsafe use of open() or creat().","check":"At the command line, run the following command to verify hardlink protection is enabled:\n\n# /sbin/sysctl fs.protected_hardlinks\n\nExample result:\n\nfs.protected_hardlinks = 1\n\nIf the \"fs.protected_hardlinks\" kernel parameter is not set to \"1\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nfs.protected_hardlinks = 1\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62643r933768_chk","severity":"medium","gid":"V-258903","rid":"SV-258903r933770_rule","stig_id":"PHTN-40-000244","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62552r933769_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-258904","code":"control 'SV-258904' do\n  title 'The Photon operating system must restrict core dumps.'\n  desc 'By enabling the fs.suid_dumpable kernel parameter, core dumps are not generated for setuid or otherwise protected/tainted binaries. This prevents users from potentially accessing core dumps with privileged information they would otherwise not have access to read.'\n  desc 'check', 'At the command line, run the following command to verify core dumps are restricted:\n\n# /sbin/sysctl fs.suid_dumpable\n\nExample result:\n\nfs.suid_dumpable = 0\n\nIf the \"fs.suid_dumpable\" kernel parameter is not set to \"0\", this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nfs.suid_dumpable = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created.'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0'\n  tag check_id: 'C-62644r933771_chk'\n  tag severity: 'medium'\n  tag gid: 'V-258904'\n  tag rid: 'SV-258904r933773_rule'\n  tag stig_id: 'PHTN-40-000246'\n  tag gtitle: 'SRG-OS-000480-GPOS-00227'\n  tag fix_id: 'F-62553r933772_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG_V1R1/controls/SV-258904.rb"},"title":"The Photon operating system must restrict core dumps.","desc":"By enabling the fs.suid_dumpable kernel parameter, core dumps are not generated for setuid or otherwise protected/tainted binaries. This prevents users from potentially accessing core dumps with privileged information they would otherwise not have access to read.","descriptions":{"default":"By enabling the fs.suid_dumpable kernel parameter, core dumps are not generated for setuid or otherwise protected/tainted binaries. This prevents users from potentially accessing core dumps with privileged information they would otherwise not have access to read.","check":"At the command line, run the following command to verify core dumps are restricted:\n\n# /sbin/sysctl fs.suid_dumpable\n\nExample result:\n\nfs.suid_dumpable = 0\n\nIf the \"fs.suid_dumpable\" kernel parameter is not set to \"0\", this is a finding.","fix":"Navigate to and open:\n\n/etc/sysctl.d/zz-stig-hardening.conf\n\nAdd or update the following line:\n\nfs.suid_dumpable = 0\n\nAt the command line, run the following command to load the new configuration:\n\n# /sbin/sysctl --load /etc/sysctl.d/zz-stig-hardening.conf\n\nNote: If the file zz-stig-hardening.conf does not exist, it must be created."},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Photon OS 4.0"}],"tags":{"check_id":"C-62644r933771_chk","severity":"medium","gid":"V-258904","rid":"SV-258904r933773_rule","stig_id":"PHTN-40-000246","gtitle":"SRG-OS-000480-GPOS-00227","fix_id":"F-62553r933772_fix","documentable":null,"cci":["CCI-000366"],"nist":["CM-6 b"]}}],"groups":[{"id":"controls/SV-258801.rb","title":null,"controls":["SV-258801"]},{"id":"controls/SV-258802.rb","title":null,"controls":["SV-258802"]},{"id":"controls/SV-258803.rb","title":null,"controls":["SV-258803"]},{"id":"controls/SV-258804.rb","title":null,"controls":["SV-258804"]},{"id":"controls/SV-258805.rb","title":null,"controls":["SV-258805"]},{"id":"controls/SV-258806.rb","title":null,"controls":["SV-258806"]},{"id":"controls/SV-258807.rb","title":null,"controls":["SV-258807"]},{"id":"controls/SV-258808.rb","title":null,"controls":["SV-258808"]},{"id":"controls/SV-258809.rb","title":null,"controls":["SV-258809"]},{"id":"controls/SV-258810.rb","title":null,"controls":["SV-258810"]},{"id":"controls/SV-258811.rb","title":null,"controls":["SV-258811"]},{"id":"controls/SV-258812.rb","title":null,"controls":["SV-258812"]},{"id":"controls/SV-258813.rb","title":null,"controls":["SV-258813"]},{"id":"controls/SV-258814.rb","title":null,"controls":["SV-258814"]},{"id":"controls/SV-258815.rb","title":null,"controls":["SV-258815"]},{"id":"controls/SV-258816.rb","title":null,"controls":["SV-258816"]},{"id":"controls/SV-258817.rb","title":null,"controls":["SV-258817"]},{"id":"controls/SV-258818.rb","title":null,"controls":["SV-258818"]},{"id":"controls/SV-258819.rb","title":null,"controls":["SV-258819"]},{"id":"controls/SV-258820.rb","title":null,"controls":["SV-258820"]},{"id":"controls/SV-258821.rb","title":null,"controls":["SV-258821"]},{"id":"controls/SV-258822.rb","title":null,"controls":["SV-258822"]},{"id":"controls/SV-258823.rb","title":null,"controls":["SV-258823"]},{"id":"controls/SV-258824.rb","title":null,"controls":["SV-258824"]},{"id":"controls/SV-258825.rb","title":null,"controls":["SV-258825"]},{"id":"controls/SV-258826.rb","title":null,"controls":["SV-258826"]},{"id":"controls/SV-258827.rb","title":null,"controls":["SV-258827"]},{"id":"controls/SV-258828.rb","title":null,"controls":["SV-258828"]},{"id":"controls/SV-258829.rb","title":null,"controls":["SV-258829"]},{"id":"controls/SV-258830.rb","title":null,"controls":["SV-258830"]},{"id":"controls/SV-258831.rb","title":null,"controls":["SV-258831"]},{"id":"controls/SV-258832.rb","title":null,"controls":["SV-258832"]},{"id":"controls/SV-258833.rb","title":null,"controls":["SV-258833"]},{"id":"controls/SV-258834.rb","title":null,"controls":["SV-258834"]},{"id":"controls/SV-258835.rb","title":null,"controls":["SV-258835"]},{"id":"controls/SV-258836.rb","title":null,"controls":["SV-258836"]},{"id":"controls/SV-258837.rb","title":null,"controls":["SV-258837"]},{"id":"controls/SV-258838.rb","title":null,"controls":["SV-258838"]},{"id":"controls/SV-258839.rb","title":null,"controls":["SV-258839"]},{"id":"controls/SV-258840.rb","title":null,"controls":["SV-258840"]},{"id":"controls/SV-258841.rb","title":null,"controls":["SV-258841"]},{"id":"controls/SV-258842.rb","title":null,"controls":["SV-258842"]},{"id":"controls/SV-258843.rb","title":null,"controls":["SV-258843"]},{"id":"controls/SV-258844.rb","title":null,"controls":["SV-258844"]},{"id":"controls/SV-258845.rb","title":null,"controls":["SV-258845"]},{"id":"controls/SV-258846.rb","title":null,"controls":["SV-258846"]},{"id":"controls/SV-258847.rb","title":null,"controls":["SV-258847"]},{"id":"controls/SV-258848.rb","title":null,"controls":["SV-258848"]},{"id":"controls/SV-258849.rb","title":null,"controls":["SV-258849"]},{"id":"controls/SV-258850.rb","title":null,"controls":["SV-258850"]},{"id":"controls/SV-258851.rb","title":null,"controls":["SV-258851"]},{"id":"controls/SV-258852.rb","title":null,"controls":["SV-258852"]},{"id":"controls/SV-258853.rb","title":null,"controls":["SV-258853"]},{"id":"controls/SV-258854.rb","title":null,"controls":["SV-258854"]},{"id":"controls/SV-258855.rb","title":null,"controls":["SV-258855"]},{"id":"controls/SV-258856.rb","title":null,"controls":["SV-258856"]},{"id":"controls/SV-258857.rb","title":null,"controls":["SV-258857"]},{"id":"controls/SV-258858.rb","title":null,"controls":["SV-258858"]},{"id":"controls/SV-258859.rb","title":null,"controls":["SV-258859"]},{"id":"controls/SV-258860.rb","title":null,"controls":["SV-258860"]},{"id":"controls/SV-258861.rb","title":null,"controls":["SV-258861"]},{"id":"controls/SV-258862.rb","title":null,"controls":["SV-258862"]},{"id":"controls/SV-258863.rb","title":null,"controls":["SV-258863"]},{"id":"controls/SV-258864.rb","title":null,"controls":["SV-258864"]},{"id":"controls/SV-258865.rb","title":null,"controls":["SV-258865"]},{"id":"controls/SV-258866.rb","title":null,"controls":["SV-258866"]},{"id":"controls/SV-258867.rb","title":null,"controls":["SV-258867"]},{"id":"controls/SV-258868.rb","title":null,"controls":["SV-258868"]},{"id":"controls/SV-258869.rb","title":null,"controls":["SV-258869"]},{"id":"controls/SV-258870.rb","title":null,"controls":["SV-258870"]},{"id":"controls/SV-258871.rb","title":null,"controls":["SV-258871"]},{"id":"controls/SV-258872.rb","title":null,"controls":["SV-258872"]},{"id":"controls/SV-258873.rb","title":null,"controls":["SV-258873"]},{"id":"controls/SV-258874.rb","title":null,"controls":["SV-258874"]},{"id":"controls/SV-258875.rb","title":null,"controls":["SV-258875"]},{"id":"controls/SV-258876.rb","title":null,"controls":["SV-258876"]},{"id":"controls/SV-258877.rb","title":null,"controls":["SV-258877"]},{"id":"controls/SV-258878.rb","title":null,"controls":["SV-258878"]},{"id":"controls/SV-258879.rb","title":null,"controls":["SV-258879"]},{"id":"controls/SV-258880.rb","title":null,"controls":["SV-258880"]},{"id":"controls/SV-258881.rb","title":null,"controls":["SV-258881"]},{"id":"controls/SV-258882.rb","title":null,"controls":["SV-258882"]},{"id":"controls/SV-258883.rb","title":null,"controls":["SV-258883"]},{"id":"controls/SV-258884.rb","title":null,"controls":["SV-258884"]},{"id":"controls/SV-258885.rb","title":null,"controls":["SV-258885"]},{"id":"controls/SV-258886.rb","title":null,"controls":["SV-258886"]},{"id":"controls/SV-258887.rb","title":null,"controls":["SV-258887"]},{"id":"controls/SV-258888.rb","title":null,"controls":["SV-258888"]},{"id":"controls/SV-258889.rb","title":null,"controls":["SV-258889"]},{"id":"controls/SV-258890.rb","title":null,"controls":["SV-258890"]},{"id":"controls/SV-258891.rb","title":null,"controls":["SV-258891"]},{"id":"controls/SV-258892.rb","title":null,"controls":["SV-258892"]},{"id":"controls/SV-258893.rb","title":null,"controls":["SV-258893"]},{"id":"controls/SV-258894.rb","title":null,"controls":["SV-258894"]},{"id":"controls/SV-258895.rb","title":null,"controls":["SV-258895"]},{"id":"controls/SV-258896.rb","title":null,"controls":["SV-258896"]},{"id":"controls/SV-258897.rb","title":null,"controls":["SV-258897"]},{"id":"controls/SV-258898.rb","title":null,"controls":["SV-258898"]},{"id":"controls/SV-258899.rb","title":null,"controls":["SV-258899"]},{"id":"controls/SV-258900.rb","title":null,"controls":["SV-258900"]},{"id":"controls/SV-258901.rb","title":null,"controls":["SV-258901"]},{"id":"controls/SV-258902.rb","title":null,"controls":["SV-258902"]},{"id":"controls/SV-258903.rb","title":null,"controls":["SV-258903"]},{"id":"controls/SV-258904.rb","title":null,"controls":["SV-258904"]}],"name":"VMW_vSphere_8-0_VCSA_Photon_OS_4-0_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"e023e3057ff01102b03ff96cf3eeb22f1adf1e318320f9e444cfbc7f25e50f8c","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
