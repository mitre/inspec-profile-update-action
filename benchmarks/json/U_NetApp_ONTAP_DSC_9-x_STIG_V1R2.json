{"controls":[{"id":"SV-246922","code":"control 'SV-246922' do\n  title 'ONTAP must be configured to limit the number of concurrent sessions.'\n  desc 'Device management includes the ability to control the number of administrators and management sessions that manage a device. Limiting the number of allowed administrators and sessions per administrator based on account type, role, or access type is helpful in limiting risks related to DoS attacks.'\n  desc 'check', 'Use \"security session limit show -interface cli\" to check the concurrent session limit.\n\nIf the security session limit is not configured to limit the number of concurrent sessions to 1, this is a finding.'\n  desc 'fix', 'Configure session limits with the command, “security session limit modify -max-active-limit 1 -interface cli -category application\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50354r769096_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246922'\n  tag rid: 'SV-246922r769098_rule'\n  tag stig_id: 'NAOT-AC-000001'\n  tag gtitle: 'SRG-APP-000001-NDM-000200'\n  tag fix_id: 'F-50308r769097_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246922.rb"},"title":"ONTAP must be configured to limit the number of concurrent sessions.","desc":"Device management includes the ability to control the number of administrators and management sessions that manage a device. Limiting the number of allowed administrators and sessions per administrator based on account type, role, or access type is helpful in limiting risks related to DoS attacks.","descriptions":{"default":"Device management includes the ability to control the number of administrators and management sessions that manage a device. Limiting the number of allowed administrators and sessions per administrator based on account type, role, or access type is helpful in limiting risks related to DoS attacks.","check":"Use \"security session limit show -interface cli\" to check the concurrent session limit.\n\nIf the security session limit is not configured to limit the number of concurrent sessions to 1, this is a finding.","fix":"Configure session limits with the command, “security session limit modify -max-active-limit 1 -interface cli -category application\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50354r769096_chk","severity":"medium","gid":"V-246922","rid":"SV-246922r769098_rule","stig_id":"NAOT-AC-000001","gtitle":"SRG-APP-000001-NDM-000200","fix_id":"F-50308r769097_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}},{"id":"SV-246923","code":"control 'SV-246923' do\n  title 'ONTAP must be configured to create a session lock after 15 minutes.'\n  desc 'A session lock is a temporary network device or administrator-initiated action taken when the administrator stops work but does not log out of the network device. Rather than relying on the user to manually lock their management session prior to vacating the vicinity, network devices need to be able to identify when a management session has idled and take action to initiate the session lock. Once invoked, the session lock must remain in place until the administrator re-authenticates. No other system activity aside from re-authentication must unlock the management session.\n\nNote that CCI-001133 requires that administrative network sessions be disconnected after 10 minutes of idle time. This requirement may only apply to local administrative sessions.'\n  desc 'check', 'Use \"system timeout show\" to check the current CLI timeout.\n\nIf the system timeout is not set to 15 minute(s) or less, this is a finding.'\n  desc 'fix', 'Configure the CLI timeout value to 15 minutes with the command, \"system timeout modify -timeout 15\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50355r835205_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246923'\n  tag rid: 'SV-246923r835206_rule'\n  tag stig_id: 'NAOT-AC-000002'\n  tag gtitle: 'SRG-APP-000003-NDM-000202'\n  tag fix_id: 'F-50309r769100_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000057']\n  tag nist: ['AC-11 a']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246923.rb"},"title":"ONTAP must be configured to create a session lock after 15 minutes.","desc":"A session lock is a temporary network device or administrator-initiated action taken when the administrator stops work but does not log out of the network device. Rather than relying on the user to manually lock their management session prior to vacating the vicinity, network devices need to be able to identify when a management session has idled and take action to initiate the session lock. Once invoked, the session lock must remain in place until the administrator re-authenticates. No other system activity aside from re-authentication must unlock the management session.\n\nNote that CCI-001133 requires that administrative network sessions be disconnected after 10 minutes of idle time. This requirement may only apply to local administrative sessions.","descriptions":{"default":"A session lock is a temporary network device or administrator-initiated action taken when the administrator stops work but does not log out of the network device. Rather than relying on the user to manually lock their management session prior to vacating the vicinity, network devices need to be able to identify when a management session has idled and take action to initiate the session lock. Once invoked, the session lock must remain in place until the administrator re-authenticates. No other system activity aside from re-authentication must unlock the management session.\n\nNote that CCI-001133 requires that administrative network sessions be disconnected after 10 minutes of idle time. This requirement may only apply to local administrative sessions.","check":"Use \"system timeout show\" to check the current CLI timeout.\n\nIf the system timeout is not set to 15 minute(s) or less, this is a finding.","fix":"Configure the CLI timeout value to 15 minutes with the command, \"system timeout modify -timeout 15\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50355r835205_chk","severity":"medium","gid":"V-246923","rid":"SV-246923r835206_rule","stig_id":"NAOT-AC-000002","gtitle":"SRG-APP-000003-NDM-000202","fix_id":"F-50309r769100_fix","documentable":null,"cci":["CCI-000057"],"nist":["AC-11 a"]}},{"id":"SV-246925","code":"control 'SV-246925' do\n  title 'ONTAP must automatically audit account-enabling actions.'\n  desc 'Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to simply enable a new or disabled account. Notification of account enabling is one method for mitigating this risk. A comprehensive account management process will ensure an audit trail, which documents the creation of application user accounts and notifies administrators and Information System Security Officer (ISSO). Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes.'\n  desc 'check', 'Use \"cluster log-forwarding show\" to see if a remote syslog destination is defined for ONTAP.\n\nUse commands available on the remote syslog server to check for new account creation or enabling a disabled account.\n\nIf ONTAP does not automatically audit account-enabling actions, this is a finding.'\n  desc 'fix', 'Use \"cluster log-forwarding show\" to identify defined ONTAP remote syslog servers. If no remote syslog servers are defined, use \"cluster log-forwarding create\" to define a syslog destination.\n\nOn the remote syslog server, use commands available to check for new account creation or enabling a disabled account.'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50357r769105_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246925'\n  tag rid: 'SV-246925r769107_rule'\n  tag stig_id: 'NAOT-AC-000004'\n  tag gtitle: 'SRG-APP-000319-NDM-000283'\n  tag fix_id: 'F-50311r769106_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002130']\n  tag nist: ['AC-2 (4)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246925.rb"},"title":"ONTAP must automatically audit account-enabling actions.","desc":"Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to simply enable a new or disabled account. Notification of account enabling is one method for mitigating this risk. A comprehensive account management process will ensure an audit trail, which documents the creation of application user accounts and notifies administrators and Information System Security Officer (ISSO). Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes.","descriptions":{"default":"Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of reestablishing access. One way to accomplish this is for the attacker to simply enable a new or disabled account. Notification of account enabling is one method for mitigating this risk. A comprehensive account management process will ensure an audit trail, which documents the creation of application user accounts and notifies administrators and Information System Security Officer (ISSO). Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes.","check":"Use \"cluster log-forwarding show\" to see if a remote syslog destination is defined for ONTAP.\n\nUse commands available on the remote syslog server to check for new account creation or enabling a disabled account.\n\nIf ONTAP does not automatically audit account-enabling actions, this is a finding.","fix":"Use \"cluster log-forwarding show\" to identify defined ONTAP remote syslog servers. If no remote syslog servers are defined, use \"cluster log-forwarding create\" to define a syslog destination.\n\nOn the remote syslog server, use commands available to check for new account creation or enabling a disabled account."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50357r769105_chk","severity":"medium","gid":"V-246925","rid":"SV-246925r769107_rule","stig_id":"NAOT-AC-000004","gtitle":"SRG-APP-000319-NDM-000283","fix_id":"F-50311r769106_fix","documentable":null,"cci":["CCI-002130"],"nist":["AC-2 (4)"]}},{"id":"SV-246926","code":"control 'SV-246926' do\n  title 'ONTAP must be configured with only one local account to be used as the account of last resort in the event the authentication server is unavailable.'\n  desc \"Authentication for administrative (privileged-level) access to the device is required at all times. An account can be created on the device's local database for use when the authentication server is down or connectivity between the device and the authentication server is not operable. This account is referred to as the account of last resort since it is intended to be used as a last resort and when immediate administrative access is absolutely necessary.\n\nThe account of last resort logon credentials must be stored in a sealed envelope and kept in a safe. The safe must be periodically audited to verify the envelope remains sealed. The signature of the auditor and the date of the audit should be added to the envelope as a record. Administrators should secure the credentials and disable the root account (if possible) when not needed for system administration functions.\"\n  desc 'check', 'Use \"security login show -role admin -authentication-method password\" to see the local administrative account.\n\nIf ONTAP is not configured with only one local account to be used as the account of last resort in the event the authentication server is unavailable, this is a finding.'\n  desc 'fix', 'Configure a secure password for the local administrative account with \"security login password -username <user_name>\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50358r835208_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246926'\n  tag rid: 'SV-246926r835209_rule'\n  tag stig_id: 'NAOT-AC-000005'\n  tag gtitle: 'SRG-APP-000148-NDM-000346'\n  tag fix_id: 'F-50312r769109_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001358', 'CCI-002111']\n  tag nist: ['AC-2 (7) (a)', 'AC-2 a']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246926.rb"},"title":"ONTAP must be configured with only one local account to be used as the account of last resort in the event the authentication server is unavailable.","desc":"Authentication for administrative (privileged-level) access to the device is required at all times. An account can be created on the device's local database for use when the authentication server is down or connectivity between the device and the authentication server is not operable. This account is referred to as the account of last resort since it is intended to be used as a last resort and when immediate administrative access is absolutely necessary.\n\nThe account of last resort logon credentials must be stored in a sealed envelope and kept in a safe. The safe must be periodically audited to verify the envelope remains sealed. The signature of the auditor and the date of the audit should be added to the envelope as a record. Administrators should secure the credentials and disable the root account (if possible) when not needed for system administration functions.","descriptions":{"default":"Authentication for administrative (privileged-level) access to the device is required at all times. An account can be created on the device's local database for use when the authentication server is down or connectivity between the device and the authentication server is not operable. This account is referred to as the account of last resort since it is intended to be used as a last resort and when immediate administrative access is absolutely necessary.\n\nThe account of last resort logon credentials must be stored in a sealed envelope and kept in a safe. The safe must be periodically audited to verify the envelope remains sealed. The signature of the auditor and the date of the audit should be added to the envelope as a record. Administrators should secure the credentials and disable the root account (if possible) when not needed for system administration functions.","check":"Use \"security login show -role admin -authentication-method password\" to see the local administrative account.\n\nIf ONTAP is not configured with only one local account to be used as the account of last resort in the event the authentication server is unavailable, this is a finding.","fix":"Configure a secure password for the local administrative account with \"security login password -username <user_name>\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50358r835208_chk","severity":"medium","gid":"V-246926","rid":"SV-246926r835209_rule","stig_id":"NAOT-AC-000005","gtitle":"SRG-APP-000148-NDM-000346","fix_id":"F-50312r769109_fix","documentable":null,"cci":["CCI-001358","CCI-002111"],"nist":["AC-2 (7) (a)","AC-2 a"]}},{"id":"SV-246927","code":"control 'SV-246927' do\n  title 'ONTAP must enforce administrator privileges based on their defined roles.'\n  desc 'To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Network devices use access control policies and enforcement mechanisms to implement this requirement.\n\nAccess control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the network device to control access between administrators (or processes acting on behalf of administrators) and objects (e.g., device commands, files, records, processes) in the network device.\n\nThe access policies must include protecting the data in all three states, i.e. Data at rest, data in use, and data in motion. An example of each state can be seen through the use of a configuration setting or file for ONTAP. When stored, the data is at rest. When the data is being updated either through CLI or some web frontend, the data is in use and when the configuration is being transmitted to the devices being managed, the data is in transit.'\n  desc 'check', 'Use \"security login show\" to see all configured users and their roles. Use \"security login role show\" to see specific commands allowed for each role.\n\nIf ONTAP does not enforce administrator privileges based on their defined roles, this is a finding.'\n  desc 'fix', 'Configure roles with \"security login role create -role <name>\" to create new roles, and \"security login create -user-or-group-name <user_name> -role <name>\" to assign the role to a specific user or group.'\n  impact 0.7\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50359r769111_chk'\n  tag severity: 'high'\n  tag gid: 'V-246927'\n  tag rid: 'SV-246927r835210_rule'\n  tag stig_id: 'NAOT-AC-000006'\n  tag gtitle: 'SRG-APP-000033-NDM-000212'\n  tag fix_id: 'F-50313r769112_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000213', 'CCI-001199', 'CCI-000366', 'CCI-002139']\n  tag nist: ['AC-3', 'SC-28', 'CM-6 b', 'AC-2 (8)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246927.rb"},"title":"ONTAP must enforce administrator privileges based on their defined roles.","desc":"To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Network devices use access control policies and enforcement mechanisms to implement this requirement.\n\nAccess control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the network device to control access between administrators (or processes acting on behalf of administrators) and objects (e.g., device commands, files, records, processes) in the network device.\n\nThe access policies must include protecting the data in all three states, i.e. Data at rest, data in use, and data in motion. An example of each state can be seen through the use of a configuration setting or file for ONTAP. When stored, the data is at rest. When the data is being updated either through CLI or some web frontend, the data is in use and when the configuration is being transmitted to the devices being managed, the data is in transit.","descriptions":{"default":"To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems must be properly configured to incorporate access control methods that do not rely solely on the possession of a certificate for access. Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Network devices use access control policies and enforcement mechanisms to implement this requirement.\n\nAccess control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the network device to control access between administrators (or processes acting on behalf of administrators) and objects (e.g., device commands, files, records, processes) in the network device.\n\nThe access policies must include protecting the data in all three states, i.e. Data at rest, data in use, and data in motion. An example of each state can be seen through the use of a configuration setting or file for ONTAP. When stored, the data is at rest. When the data is being updated either through CLI or some web frontend, the data is in use and when the configuration is being transmitted to the devices being managed, the data is in transit.","check":"Use \"security login show\" to see all configured users and their roles. Use \"security login role show\" to see specific commands allowed for each role.\n\nIf ONTAP does not enforce administrator privileges based on their defined roles, this is a finding.","fix":"Configure roles with \"security login role create -role <name>\" to create new roles, and \"security login create -user-or-group-name <user_name> -role <name>\" to assign the role to a specific user or group."},"impact":0.7,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50359r769111_chk","severity":"high","gid":"V-246927","rid":"SV-246927r835210_rule","stig_id":"NAOT-AC-000006","gtitle":"SRG-APP-000033-NDM-000212","fix_id":"F-50313r769112_fix","documentable":null,"cci":["CCI-000213","CCI-001199","CCI-000366","CCI-002139"],"nist":["AC-3","SC-28","CM-6 b","AC-2 (8)"]}},{"id":"SV-246930","code":"control 'SV-246930' do\n  title 'ONTAP must prevent non-privileged users from executing privileged functions to include disabling, circumventing, or altering implemented security safeguards/countermeasures.'\n  desc 'Preventing non-privileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges.\n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Non-privileged users are individuals that do not possess appropriate authorizations.'\n  desc 'check', 'Use \"security login role show” to see role-based access policies defined in ONTAP for privileged and unprivileged users. Privileged users have the role of admin.\n\nIf ONTAP does not prevent non-privileged users from executing privileged functions to include disabling, circumventing, or altering implemented security safeguards/countermeasures, this is a finding.'\n  desc 'fix', 'Configure privileged users with \"security login create -user-or-group-name <user_name> -role admin\".\n\nConfigure non-privileged users with \"security login create -user-or-group-name <user_name> -role <role_name>“where a non-privileged user role other than admin is used.'\n  impact 0.7\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50362r769120_chk'\n  tag severity: 'high'\n  tag gid: 'V-246930'\n  tag rid: 'SV-246930r835213_rule'\n  tag stig_id: 'NAOT-AC-000009'\n  tag gtitle: 'SRG-APP-000340-NDM-000288'\n  tag fix_id: 'F-50316r769121_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002235', 'CCI-000366', 'CCI-002139']\n  tag nist: ['AC-6 (10)', 'CM-6 b', 'AC-2 (8)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246930.rb"},"title":"ONTAP must prevent non-privileged users from executing privileged functions to include disabling, circumventing, or altering implemented security safeguards/countermeasures.","desc":"Preventing non-privileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges.\n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Non-privileged users are individuals that do not possess appropriate authorizations.","descriptions":{"default":"Preventing non-privileged users from executing privileged functions mitigates the risk that unauthorized individuals or processes may gain unnecessary access to information or privileges.\n\nPrivileged functions include, for example, establishing accounts, performing system integrity checks, or administering cryptographic key management activities. Non-privileged users are individuals that do not possess appropriate authorizations.","check":"Use \"security login role show” to see role-based access policies defined in ONTAP for privileged and unprivileged users. Privileged users have the role of admin.\n\nIf ONTAP does not prevent non-privileged users from executing privileged functions to include disabling, circumventing, or altering implemented security safeguards/countermeasures, this is a finding.","fix":"Configure privileged users with \"security login create -user-or-group-name <user_name> -role admin\".\n\nConfigure non-privileged users with \"security login create -user-or-group-name <user_name> -role <role_name>“where a non-privileged user role other than admin is used."},"impact":0.7,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50362r769120_chk","severity":"high","gid":"V-246930","rid":"SV-246930r835213_rule","stig_id":"NAOT-AC-000009","gtitle":"SRG-APP-000340-NDM-000288","fix_id":"F-50316r769121_fix","documentable":null,"cci":["CCI-002235","CCI-000366","CCI-002139"],"nist":["AC-6 (10)","CM-6 b","AC-2 (8)"]}},{"id":"SV-246931","code":"control 'SV-246931' do\n  title 'ONTAP must be configured to enforce the limit of three consecutive failed logon attempts.'\n  desc 'By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced.'\n  desc 'check', 'Use the command \"security login role config show\" to get a list of roles.\n\nFor each role, use the command \"security login role config show -vserver <vserver_name> -role <role_name>\" to view the password requirements for each role. \n\nIf any role has \"Maximum Number of Failed Attempts\" not set to 3, this is a finding.\n\nUse \"security login role config show -role admin -instance\" to see the settings for \"Maximum Number of Failed Attempts\" and “Delay after Each Failed Login Attempt\".\n\nIf ONTAP is not configured to enforce a limit of three consecutive invalid logon attempts, after which time it must block any login attempt for 15 minutes, this is a finding.'\n  desc 'fix', 'Use the command \"security login role config show\" to get a list of roles.\n\nFor each role, use the command \"security login role config show -vserver <vserver_name> -role <role_name>\" to view the password requirements for each role. \n\nFor any role that does not have \"Maximum Number of Failed Attempts\" set to 3, use the command \"security login role config modify -role <role_name> -vserver <vserver_name>  -max-failed-login-attempts 3\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50363r835214_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246931'\n  tag rid: 'SV-246931r835216_rule'\n  tag stig_id: 'NAOT-AC-000010'\n  tag gtitle: 'SRG-APP-000065-NDM-000214'\n  tag fix_id: 'F-50317r835215_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000044']\n  tag nist: ['AC-7 a']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246931.rb"},"title":"ONTAP must be configured to enforce the limit of three consecutive failed logon attempts.","desc":"By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced.","descriptions":{"default":"By limiting the number of failed login attempts, the risk of unauthorized system access via user password guessing, otherwise known as brute-forcing, is reduced.","check":"Use the command \"security login role config show\" to get a list of roles.\n\nFor each role, use the command \"security login role config show -vserver <vserver_name> -role <role_name>\" to view the password requirements for each role. \n\nIf any role has \"Maximum Number of Failed Attempts\" not set to 3, this is a finding.\n\nUse \"security login role config show -role admin -instance\" to see the settings for \"Maximum Number of Failed Attempts\" and “Delay after Each Failed Login Attempt\".\n\nIf ONTAP is not configured to enforce a limit of three consecutive invalid logon attempts, after which time it must block any login attempt for 15 minutes, this is a finding.","fix":"Use the command \"security login role config show\" to get a list of roles.\n\nFor each role, use the command \"security login role config show -vserver <vserver_name> -role <role_name>\" to view the password requirements for each role. \n\nFor any role that does not have \"Maximum Number of Failed Attempts\" set to 3, use the command \"security login role config modify -role <role_name> -vserver <vserver_name>  -max-failed-login-attempts 3\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50363r835214_chk","severity":"medium","gid":"V-246931","rid":"SV-246931r835216_rule","stig_id":"NAOT-AC-000010","gtitle":"SRG-APP-000065-NDM-000214","fix_id":"F-50317r835215_fix","documentable":null,"cci":["CCI-000044"],"nist":["AC-7 a"]}},{"id":"SV-246932","code":"control 'SV-246932' do\n  title 'ONTAP must be configured to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device.'\n  desc 'Display of the DoD-approved use notification before granting access to the network device ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users.'\n  desc 'check', 'Use \"security login banner show\" to see the current login notice and consent banner.\n\nIf ONTAP is not configured to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device, this is a finding.'\n  desc 'fix', 'Configure the Standard Mandatory DoD Notice and Consent Banner with \"security login banner modify -message <Standard DoD Notice and Consent Banner>\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50364r835217_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246932'\n  tag rid: 'SV-246932r835218_rule'\n  tag stig_id: 'NAOT-AC-000011'\n  tag gtitle: 'SRG-APP-000068-NDM-000215'\n  tag fix_id: 'F-50318r769127_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000048']\n  tag nist: ['AC-8 a']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246932.rb"},"title":"ONTAP must be configured to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device.","desc":"Display of the DoD-approved use notification before granting access to the network device ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users.","descriptions":{"default":"Display of the DoD-approved use notification before granting access to the network device ensures privacy and security notification verbiage used is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.\n\nSystem use notifications are required only for access via logon interfaces with human users.","check":"Use \"security login banner show\" to see the current login notice and consent banner.\n\nIf ONTAP is not configured to display the Standard Mandatory DoD Notice and Consent Banner before granting access to the device, this is a finding.","fix":"Configure the Standard Mandatory DoD Notice and Consent Banner with \"security login banner modify -message <Standard DoD Notice and Consent Banner>\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50364r835217_chk","severity":"medium","gid":"V-246932","rid":"SV-246932r835218_rule","stig_id":"NAOT-AC-000011","gtitle":"SRG-APP-000068-NDM-000215","fix_id":"F-50318r769127_fix","documentable":null,"cci":["CCI-000048"],"nist":["AC-8 a"]}},{"id":"SV-246933","code":"control 'SV-246933' do\n  title 'ONTAP must allocate audit record storage capacity in accordance with organization-defined audit record storage requirements.'\n  desc 'Audit records are stored on staging volumes when auditing is enabled. If the staging volumes do not exist when auditing is enabled, the auditing subsystem creates the staging volumes. These volumes hold the audit logs until they can be consolidated.\n\nEnabling auditing will also enable guaranteed auditing by default. This feature will guarantee audit records are not lost even when a node goes offline or the disk becomes filled.\nAudit records are stored on staging volumes prior to consolidation and conversion.\n\nStaging volumes can only be created by ONTAP and are given volume names that begin with MDV_aud_ followed by the UUID of the aggregate containing the staging volume.'\n  desc 'check', 'To ensure audit record storage capacity is sufficient, use the command \"df MDV*\".  The output from the command will show the size of the audit volumes, amount used and amount available.  Sample output from the command looks like the following:\n\ncluster ::> df MDV*\n\nFilesystem                                                                                            kbytes       used      avail           capacity        Mounted on\n/vol/MDV_aud_4a9d8065eac9454bbe042ffddd0df645/    1992296        532      1991764             0%         /vol/MDV_aud_4a9d8065eac9454bbe042ffddd0df645/\n/vol/MDV_aud_62a9aebc8f3d4fe2990e39bb34c66999/    1992296        384      1991912              0%        /vol/MDV_aud_62a9aebc8f3d4fe2990e39bb34c66999/\n/vol/MDV_aud_fdb78598bd5945ffa6f7bd1197a9f975/      1992296    1992296              0           100%      /vol/MDV_aud_fdb78598bd5945ffa6f7bd1197a9f975/ \n\nIf any ONTAP volumes show 100 percent capacity, this is a finding.'\n  desc 'fix', 'Increase the size of the volume that is filled using the command \"vol size <volume name> <size increase>\".  \n\nTo increase vol1 by 500MB, the command would be \"vol size vol1 +500m\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50365r835219_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246933'\n  tag rid: 'SV-246933r835221_rule'\n  tag stig_id: 'NAOT-AU-000001'\n  tag gtitle: 'SRG-APP-000357-NDM-000293'\n  tag fix_id: 'F-50319r835220_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001819']\n  tag nist: ['CM-3 d']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246933.rb"},"title":"ONTAP must allocate audit record storage capacity in accordance with organization-defined audit record storage requirements.","desc":"Audit records are stored on staging volumes when auditing is enabled. If the staging volumes do not exist when auditing is enabled, the auditing subsystem creates the staging volumes. These volumes hold the audit logs until they can be consolidated.\n\nEnabling auditing will also enable guaranteed auditing by default. This feature will guarantee audit records are not lost even when a node goes offline or the disk becomes filled.\nAudit records are stored on staging volumes prior to consolidation and conversion.\n\nStaging volumes can only be created by ONTAP and are given volume names that begin with MDV_aud_ followed by the UUID of the aggregate containing the staging volume.","descriptions":{"default":"Audit records are stored on staging volumes when auditing is enabled. If the staging volumes do not exist when auditing is enabled, the auditing subsystem creates the staging volumes. These volumes hold the audit logs until they can be consolidated.\n\nEnabling auditing will also enable guaranteed auditing by default. This feature will guarantee audit records are not lost even when a node goes offline or the disk becomes filled.\nAudit records are stored on staging volumes prior to consolidation and conversion.\n\nStaging volumes can only be created by ONTAP and are given volume names that begin with MDV_aud_ followed by the UUID of the aggregate containing the staging volume.","check":"To ensure audit record storage capacity is sufficient, use the command \"df MDV*\".  The output from the command will show the size of the audit volumes, amount used and amount available.  Sample output from the command looks like the following:\n\ncluster ::> df MDV*\n\nFilesystem                                                                                            kbytes       used      avail           capacity        Mounted on\n/vol/MDV_aud_4a9d8065eac9454bbe042ffddd0df645/    1992296        532      1991764             0%         /vol/MDV_aud_4a9d8065eac9454bbe042ffddd0df645/\n/vol/MDV_aud_62a9aebc8f3d4fe2990e39bb34c66999/    1992296        384      1991912              0%        /vol/MDV_aud_62a9aebc8f3d4fe2990e39bb34c66999/\n/vol/MDV_aud_fdb78598bd5945ffa6f7bd1197a9f975/      1992296    1992296              0           100%      /vol/MDV_aud_fdb78598bd5945ffa6f7bd1197a9f975/ \n\nIf any ONTAP volumes show 100 percent capacity, this is a finding.","fix":"Increase the size of the volume that is filled using the command \"vol size <volume name> <size increase>\".  \n\nTo increase vol1 by 500MB, the command would be \"vol size vol1 +500m\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50365r835219_chk","severity":"medium","gid":"V-246933","rid":"SV-246933r835221_rule","stig_id":"NAOT-AU-000001","gtitle":"SRG-APP-000357-NDM-000293","fix_id":"F-50319r835220_fix","documentable":null,"cci":["CCI-001819"],"nist":["CM-3 d"]}},{"id":"SV-246935","code":"control 'SV-246935' do\n  title 'ONTAP must have audit guarantee enabled.'\n  desc 'It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. With audit guarantee enabled, all SMB operations must generate an audit event before an ACK is returned to the client and the operation completed.  If the audit event cannot be written, then the client operation is delayed or denied.'\n  desc 'check', 'Use \"vserver audit show -fields audit-guarantee\" to see if audit guarantee is enabled.\n\nIf audit-guarantee is set to false, this is a finding.'\n  desc 'fix', 'Use the command \"vserver audit modify -vserver <vserver_name> -destination <audit log location> -audit-guarantee true\" to set audit-guarantee to true.  \n\nAn example command for a vserver named svm01 with the audit logs at /audit_log would be \"vserver audit modify -vserver svm01 -destination /audit_log -audit-guarantee true\".\n\nUse the command \"vserver audit show -fields audit-guarantee\" to verify the change.'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50367r835223_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246935'\n  tag rid: 'SV-246935r835225_rule'\n  tag stig_id: 'NAOT-AU-000003'\n  tag gtitle: 'SRG-APP-000360-NDM-000295'\n  tag fix_id: 'F-50321r835224_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001858']\n  tag nist: ['AU-5 (2)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246935.rb"},"title":"ONTAP must have audit guarantee enabled.","desc":"It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. With audit guarantee enabled, all SMB operations must generate an audit event before an ACK is returned to the client and the operation completed.  If the audit event cannot be written, then the client operation is delayed or denied.","descriptions":{"default":"It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. With audit guarantee enabled, all SMB operations must generate an audit event before an ACK is returned to the client and the operation completed.  If the audit event cannot be written, then the client operation is delayed or denied.","check":"Use \"vserver audit show -fields audit-guarantee\" to see if audit guarantee is enabled.\n\nIf audit-guarantee is set to false, this is a finding.","fix":"Use the command \"vserver audit modify -vserver <vserver_name> -destination <audit log location> -audit-guarantee true\" to set audit-guarantee to true.  \n\nAn example command for a vserver named svm01 with the audit logs at /audit_log would be \"vserver audit modify -vserver svm01 -destination /audit_log -audit-guarantee true\".\n\nUse the command \"vserver audit show -fields audit-guarantee\" to verify the change."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50367r835223_chk","severity":"medium","gid":"V-246935","rid":"SV-246935r835225_rule","stig_id":"NAOT-AU-000003","gtitle":"SRG-APP-000360-NDM-000295","fix_id":"F-50321r835224_fix","documentable":null,"cci":["CCI-001858"],"nist":["AU-5 (2)"]}},{"id":"SV-246936","code":"control 'SV-246936' do\n  title 'ONTAP must be configured to synchronize internal information system clocks using redundant authoritative time sources.'\n  desc 'The loss of connectivity to a particular authoritative time source will result in the loss of time synchronization (free-run mode) and increasingly inaccurate time stamps on audit events and other functions.\n\nMultiple time sources provide redundancy by including a secondary source. Time synchronization is usually a hierarchy; clients synchronize time to a local source while that source synchronizes its time to a more accurate source. The network device must utilize an authoritative time server and/or be configured to use redundant authoritative time sources. This requirement is related to the comparison done in CCI-001891.\n\nDoD-approved solutions consist of a combination of a primary and secondary time source using a combination or multiple instances of the following: a time server designated for the appropriate DoD network (NIPRNet/SIPRNet); United States Naval Observatory (USNO) time servers; and/or the Global Positioning System (GPS). The secondary time source must be located in a different geographic region than the primary time source.'\n  desc 'check', 'Use \"cluster time-service ntp server show\" to see the current network time protocol configuration for ONTAP and ensure there are at least three ntp servers defined.\n\nIf ONTAP is not configured to synchronize internal information system clocks using redundant authoritative time sources, this is a finding.'\n  desc 'fix', 'Configure network time protocol for ONTAP with \"cluster time-service ntp server create -server <IP address>\" to add new ntp servers. Up to 10 servers can be defined.'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50368r835226_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246936'\n  tag rid: 'SV-246936r835228_rule'\n  tag stig_id: 'NAOT-AU-000004'\n  tag gtitle: 'SRG-APP-000373-NDM-000298'\n  tag fix_id: 'F-50322r835227_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-001893']\n  tag nist: ['CM-6 b', 'AU-8 (2)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246936.rb"},"title":"ONTAP must be configured to synchronize internal information system clocks using redundant authoritative time sources.","desc":"The loss of connectivity to a particular authoritative time source will result in the loss of time synchronization (free-run mode) and increasingly inaccurate time stamps on audit events and other functions.\n\nMultiple time sources provide redundancy by including a secondary source. Time synchronization is usually a hierarchy; clients synchronize time to a local source while that source synchronizes its time to a more accurate source. The network device must utilize an authoritative time server and/or be configured to use redundant authoritative time sources. This requirement is related to the comparison done in CCI-001891.\n\nDoD-approved solutions consist of a combination of a primary and secondary time source using a combination or multiple instances of the following: a time server designated for the appropriate DoD network (NIPRNet/SIPRNet); United States Naval Observatory (USNO) time servers; and/or the Global Positioning System (GPS). The secondary time source must be located in a different geographic region than the primary time source.","descriptions":{"default":"The loss of connectivity to a particular authoritative time source will result in the loss of time synchronization (free-run mode) and increasingly inaccurate time stamps on audit events and other functions.\n\nMultiple time sources provide redundancy by including a secondary source. Time synchronization is usually a hierarchy; clients synchronize time to a local source while that source synchronizes its time to a more accurate source. The network device must utilize an authoritative time server and/or be configured to use redundant authoritative time sources. This requirement is related to the comparison done in CCI-001891.\n\nDoD-approved solutions consist of a combination of a primary and secondary time source using a combination or multiple instances of the following: a time server designated for the appropriate DoD network (NIPRNet/SIPRNet); United States Naval Observatory (USNO) time servers; and/or the Global Positioning System (GPS). The secondary time source must be located in a different geographic region than the primary time source.","check":"Use \"cluster time-service ntp server show\" to see the current network time protocol configuration for ONTAP and ensure there are at least three ntp servers defined.\n\nIf ONTAP is not configured to synchronize internal information system clocks using redundant authoritative time sources, this is a finding.","fix":"Configure network time protocol for ONTAP with \"cluster time-service ntp server create -server <IP address>\" to add new ntp servers. Up to 10 servers can be defined."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50368r835226_chk","severity":"medium","gid":"V-246936","rid":"SV-246936r835228_rule","stig_id":"NAOT-AU-000004","gtitle":"SRG-APP-000373-NDM-000298","fix_id":"F-50322r835227_fix","documentable":null,"cci":["CCI-000366","CCI-001893"],"nist":["CM-6 b","AU-8 (2)"]}},{"id":"SV-246938","code":"control 'SV-246938' do\n  title 'ONTAP must record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT).'\n  desc 'If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by the application include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.'\n  desc 'check', 'Use \"cluster date show\" to see the current time zone configured.\n\nIf ONTAP is not configured to record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT), this is a finding.'\n  desc 'fix', 'Configure the time zone to UTC with \"cluster date modify -timezone UTC\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50370r835230_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246938'\n  tag rid: 'SV-246938r835232_rule'\n  tag stig_id: 'NAOT-AU-000006'\n  tag gtitle: 'SRG-APP-000374-NDM-000299'\n  tag fix_id: 'F-50324r835231_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001890']\n  tag nist: ['AU-8 b']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246938.rb"},"title":"ONTAP must record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT).","desc":"If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by the application include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.","descriptions":{"default":"If time stamps are not consistently applied and there is no common time reference, it is difficult to perform forensic analysis.\n\nTime stamps generated by the application include date and time. Time is commonly expressed in Coordinated Universal Time (UTC), a modern continuation of Greenwich Mean Time (GMT), or local time with an offset from UTC.","check":"Use \"cluster date show\" to see the current time zone configured.\n\nIf ONTAP is not configured to record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC) or Greenwich Mean Time (GMT), this is a finding.","fix":"Configure the time zone to UTC with \"cluster date modify -timezone UTC\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50370r835230_chk","severity":"medium","gid":"V-246938","rid":"SV-246938r835232_rule","stig_id":"NAOT-AU-000006","gtitle":"SRG-APP-000374-NDM-000299","fix_id":"F-50324r835231_fix","documentable":null,"cci":["CCI-001890"],"nist":["AU-8 b"]}},{"id":"SV-246939","code":"control 'SV-246939' do\n  title 'ONTAP must enforce access restrictions associated with changes to the device configuration.'\n  desc 'Failure to provide logical access restrictions associated with changes to device configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the device could potentially have significant effects on the overall security of the device.\n\nAccordingly, only qualified and authorized individuals should be allowed to obtain access to device components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).'\n  desc 'check', 'Use \"security login show -role admin\" to see users with administrative privilege that allow device configuration. \n\nIf ONTAP does not enforce access restrictions associated with changes to the device configuration, this is a finding.'\n  desc 'fix', 'Configure users with administrative privilege that allows device configuration with \"security login create -user-or-group-name <user_name> -role admin\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50371r835233_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246939'\n  tag rid: 'SV-246939r835234_rule'\n  tag stig_id: 'NAOT-CM-000001'\n  tag gtitle: 'SRG-APP-000380-NDM-000304'\n  tag fix_id: 'F-50325r769148_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001813']\n  tag nist: ['CM-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246939.rb"},"title":"ONTAP must enforce access restrictions associated with changes to the device configuration.","desc":"Failure to provide logical access restrictions associated with changes to device configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the device could potentially have significant effects on the overall security of the device.\n\nAccordingly, only qualified and authorized individuals should be allowed to obtain access to device components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","descriptions":{"default":"Failure to provide logical access restrictions associated with changes to device configuration may have significant effects on the overall security of the system.\n\nWhen dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the device could potentially have significant effects on the overall security of the device.\n\nAccordingly, only qualified and authorized individuals should be allowed to obtain access to device components for the purposes of initiating changes, including upgrades and modifications.\n\nLogical access restrictions include, for example, controls that restrict access to workflow automation, media libraries, abstract layers (e.g., changes implemented into third-party interfaces rather than directly into information systems), and change windows (e.g., changes occur only during specified times, making unauthorized changes easy to discover).","check":"Use \"security login show -role admin\" to see users with administrative privilege that allow device configuration. \n\nIf ONTAP does not enforce access restrictions associated with changes to the device configuration, this is a finding.","fix":"Configure users with administrative privilege that allows device configuration with \"security login create -user-or-group-name <user_name> -role admin\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50371r835233_chk","severity":"medium","gid":"V-246939","rid":"SV-246939r835234_rule","stig_id":"NAOT-CM-000001","gtitle":"SRG-APP-000380-NDM-000304","fix_id":"F-50325r769148_fix","documentable":null,"cci":["CCI-001813"],"nist":["CM-5 (1) (a)"]}},{"id":"SV-246940","code":"control 'SV-246940' do\n  title 'ONTAP must be configured to use an authentication server to provide multifactor authentication.'\n  desc \"Centralized management of authentication settings increases the security of remote and nonlocal access methods. This control is particularly important protection against the insider threat. With robust centralized management, audit records for administrator account access to the organization's network devices can be more readily analyzed for trends and anomalies. The alternative method of defining administrator accounts on each device exposes the device configuration to remote access authentication attacks and system administrators with multiple authenticators for each network device.\n\n\"\n  desc 'check', 'Use \"security login show -authentication-method domain\" to see users configured to authenticate with Active Directory.\n\nIf ONTAP is not configured to use an authentication server, this is a finding.'\n  desc 'fix', 'Configure ONTAP to make use of Active Directory to authenticate users and prohibit the use of cached authenticators with \"security login create -user-or-group-name <user or group name> -authentication-method domain -application ssh\".'\n  impact 0.7\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50372r835235_chk'\n  tag severity: 'high'\n  tag gid: 'V-246940'\n  tag rid: 'SV-246940r835236_rule'\n  tag stig_id: 'NAOT-CM-000002'\n  tag gtitle: 'SRG-APP-000516-NDM-000336'\n  tag fix_id: 'F-50326r769151_fix'\n  tag satisfies: ['SRG-APP-000516-NDM-000336', 'SRG-APP-000149-NDM-000247', 'SRG-APP-000175-NDM-000262', 'SRG-APP-000177-NDM-000263']\n  tag 'documentable'\n  tag cci: ['CCI-000370', 'CCI-000764', 'CCI-000765', 'CCI-000166', 'CCI-000185', 'CCI-000187']\n  tag nist: ['CM-6 (1)', 'IA-2', 'IA-2 (1)', 'AU-10', 'IA-5 (2) (b) (1)', 'IA-5 (2) (a) (2)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246940.rb"},"title":"ONTAP must be configured to use an authentication server to provide multifactor authentication.","desc":"Centralized management of authentication settings increases the security of remote and nonlocal access methods. This control is particularly important protection against the insider threat. With robust centralized management, audit records for administrator account access to the organization's network devices can be more readily analyzed for trends and anomalies. The alternative method of defining administrator accounts on each device exposes the device configuration to remote access authentication attacks and system administrators with multiple authenticators for each network device.\n\n","descriptions":{"default":"Centralized management of authentication settings increases the security of remote and nonlocal access methods. This control is particularly important protection against the insider threat. With robust centralized management, audit records for administrator account access to the organization's network devices can be more readily analyzed for trends and anomalies. The alternative method of defining administrator accounts on each device exposes the device configuration to remote access authentication attacks and system administrators with multiple authenticators for each network device.\n\n","check":"Use \"security login show -authentication-method domain\" to see users configured to authenticate with Active Directory.\n\nIf ONTAP is not configured to use an authentication server, this is a finding.","fix":"Configure ONTAP to make use of Active Directory to authenticate users and prohibit the use of cached authenticators with \"security login create -user-or-group-name <user or group name> -authentication-method domain -application ssh\"."},"impact":0.7,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50372r835235_chk","severity":"high","gid":"V-246940","rid":"SV-246940r835236_rule","stig_id":"NAOT-CM-000002","gtitle":"SRG-APP-000516-NDM-000336","fix_id":"F-50326r769151_fix","satisfies":["SRG-APP-000516-NDM-000336","SRG-APP-000149-NDM-000247","SRG-APP-000175-NDM-000262","SRG-APP-000177-NDM-000263"],"documentable":null,"cci":["CCI-000370","CCI-000764","CCI-000765","CCI-000166","CCI-000185","CCI-000187"],"nist":["CM-6 (1)","IA-2","IA-2 (1)","AU-10","IA-5 (2) (b) (1)","IA-5 (2) (a) (2)"]}},{"id":"SV-246944","code":"control 'SV-246944' do\n  title 'ONTAP must be configured to conduct backups of system level information.'\n  desc 'System-level information includes default and customized settings and security attributes, including ACLs that relate to the network device configuration, as well as software required for the execution and operation of the device. Information system backup is a critical step in ensuring system integrity and availability. If the system fails and there is no backup of the system-level information, a denial of service condition is possible for all who utilize this critical network component.\n\nThis control requires the network device to support the organizational central backup process for system-level information associated with the network device. This function may be provided by the network device itself; however, the preferred best practice is a centralized backup rather than each network device performing discrete backups.'\n  desc 'check', 'Use \"set -privilege advanced\" reply \"y\" to continue and \"system configuration backup show\" to see if ONTAP is configured for system backups.\n\nIf ONTAP is not configured to conduct backups of system-level data when changes occur, this is a finding.'\n  desc 'fix', 'Configure ONTAP to conduct backups of system level information with \"set -privilege advanced\" reply \"y\" to continue and \"system configuration backup create -node <node_name> -backup-type cluster -backup-name <name>\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50376r835240_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246944'\n  tag rid: 'SV-246944r835241_rule'\n  tag stig_id: 'NAOT-CM-000007'\n  tag gtitle: 'SRG-APP-000516-NDM-000340'\n  tag fix_id: 'F-50330r769163_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-000537']\n  tag nist: ['CM-6 b', 'CP-9 (b)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246944.rb"},"title":"ONTAP must be configured to conduct backups of system level information.","desc":"System-level information includes default and customized settings and security attributes, including ACLs that relate to the network device configuration, as well as software required for the execution and operation of the device. Information system backup is a critical step in ensuring system integrity and availability. If the system fails and there is no backup of the system-level information, a denial of service condition is possible for all who utilize this critical network component.\n\nThis control requires the network device to support the organizational central backup process for system-level information associated with the network device. This function may be provided by the network device itself; however, the preferred best practice is a centralized backup rather than each network device performing discrete backups.","descriptions":{"default":"System-level information includes default and customized settings and security attributes, including ACLs that relate to the network device configuration, as well as software required for the execution and operation of the device. Information system backup is a critical step in ensuring system integrity and availability. If the system fails and there is no backup of the system-level information, a denial of service condition is possible for all who utilize this critical network component.\n\nThis control requires the network device to support the organizational central backup process for system-level information associated with the network device. This function may be provided by the network device itself; however, the preferred best practice is a centralized backup rather than each network device performing discrete backups.","check":"Use \"set -privilege advanced\" reply \"y\" to continue and \"system configuration backup show\" to see if ONTAP is configured for system backups.\n\nIf ONTAP is not configured to conduct backups of system-level data when changes occur, this is a finding.","fix":"Configure ONTAP to conduct backups of system level information with \"set -privilege advanced\" reply \"y\" to continue and \"system configuration backup create -node <node_name> -backup-type cluster -backup-name <name>\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50376r835240_chk","severity":"medium","gid":"V-246944","rid":"SV-246944r835241_rule","stig_id":"NAOT-CM-000007","gtitle":"SRG-APP-000516-NDM-000340","fix_id":"F-50330r769163_fix","documentable":null,"cci":["CCI-000366","CCI-000537"],"nist":["CM-6 b","CP-9 (b)"]}},{"id":"SV-246945","code":"control 'SV-246945' do\n  title 'ONTAP must use DoD-approved PKI rather than proprietary or self-signed device certificates.'\n  desc 'Each organization obtains user certificates from an approved, shared service provider as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority (CA) at medium assurance or higher, this CA will suffice.'\n  desc 'check', 'Use the command \"security certificate show -instance -type client-ca\" to show information about the ca-certificates that are installed.\n\nIf any of the certificates have the name or identifier of a non-approved source in the Issuer field, this is a finding.'\n  desc 'fix', 'Generate a new key-pair from a DoD-approved certificate issuer. Sites must consult the PKI/PKI pages on the http://iase.disa.mil/ website for procedures for NIPRNet and SIPRNet.\n\nRSA:\nrequest security pki generate-key-pair certificate-id <cert name> type rsa size <512 | 1024 | 2048 | 4096>\n\nECDSA:\nrequest security pki generate-key-pair certificate-id <cert_name> type ecdsa size <256 | 384>\n\nGenerate a CSR from RSA key-pair using the following command and options.\n\nrequest security generate-certificate-request certificate-id <cert_name_from_key_file> digest <sha1 | sha256> domain <FQDN> email <admin_email> ip-address <ip_address> subject “CN=<hostname>,DC=<domain_part>,DC=<TLD_domain>,O=<organization>,OU=<organization_dept>,\nL=<city>,ST=<state>,C=<us>” filename <path/filename>\n\nGenerate a CSR from ECDSA key-pair use the following command and options.\n\nrequest security generate-certificate-request certificate-id <cert_name_from_key_file> digest <sha256 | sha384> domain <FQDN> email <admin_email> ip-address <ip_address> subject “CN=<hostname>,DC=<domain_part>,DC=<TLD_domain>,O=<organization>,OU=<organization_dept>,\nL=<city>,ST=<state>,C=<us>” filename <path/filename>\n\nIf no filename is specified, the CSR is displayed on the standard out (terminal)\n\nAfter receiving the approved certificate from the CA, install the certificate with the command \"security certificate install -type client-ca -vserver <vserver_name>\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50377r835242_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246945'\n  tag rid: 'SV-246945r835244_rule'\n  tag stig_id: 'NAOT-CM-000008'\n  tag gtitle: 'SRG-APP-000516-NDM-000344'\n  tag fix_id: 'F-50331r835243_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000366', 'CCI-001159']\n  tag nist: ['CM-6 b', 'SC-17 a']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246945.rb"},"title":"ONTAP must use DoD-approved PKI rather than proprietary or self-signed device certificates.","desc":"Each organization obtains user certificates from an approved, shared service provider as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority (CA) at medium assurance or higher, this CA will suffice.","descriptions":{"default":"Each organization obtains user certificates from an approved, shared service provider as required by OMB policy. For federal agencies operating a legacy public key infrastructure cross-certified with the Federal Bridge Certification Authority (CA) at medium assurance or higher, this CA will suffice.","check":"Use the command \"security certificate show -instance -type client-ca\" to show information about the ca-certificates that are installed.\n\nIf any of the certificates have the name or identifier of a non-approved source in the Issuer field, this is a finding.","fix":"Generate a new key-pair from a DoD-approved certificate issuer. Sites must consult the PKI/PKI pages on the http://iase.disa.mil/ website for procedures for NIPRNet and SIPRNet.\n\nRSA:\nrequest security pki generate-key-pair certificate-id <cert name> type rsa size <512 | 1024 | 2048 | 4096>\n\nECDSA:\nrequest security pki generate-key-pair certificate-id <cert_name> type ecdsa size <256 | 384>\n\nGenerate a CSR from RSA key-pair using the following command and options.\n\nrequest security generate-certificate-request certificate-id <cert_name_from_key_file> digest <sha1 | sha256> domain <FQDN> email <admin_email> ip-address <ip_address> subject “CN=<hostname>,DC=<domain_part>,DC=<TLD_domain>,O=<organization>,OU=<organization_dept>,\nL=<city>,ST=<state>,C=<us>” filename <path/filename>\n\nGenerate a CSR from ECDSA key-pair use the following command and options.\n\nrequest security generate-certificate-request certificate-id <cert_name_from_key_file> digest <sha256 | sha384> domain <FQDN> email <admin_email> ip-address <ip_address> subject “CN=<hostname>,DC=<domain_part>,DC=<TLD_domain>,O=<organization>,OU=<organization_dept>,\nL=<city>,ST=<state>,C=<us>” filename <path/filename>\n\nIf no filename is specified, the CSR is displayed on the standard out (terminal)\n\nAfter receiving the approved certificate from the CA, install the certificate with the command \"security certificate install -type client-ca -vserver <vserver_name>\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50377r835242_chk","severity":"medium","gid":"V-246945","rid":"SV-246945r835244_rule","stig_id":"NAOT-CM-000008","gtitle":"SRG-APP-000516-NDM-000344","fix_id":"F-50331r835243_fix","documentable":null,"cci":["CCI-000366","CCI-001159"],"nist":["CM-6 b","SC-17 a"]}},{"id":"SV-246946","code":"control 'SV-246946' do\n  title 'ONTAP must be configured to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services.'\n  desc 'In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable unused or unnecessary physical and logical ports/protocols on information systems.\n\nNetwork devices are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the network device must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved. Some network devices have capabilities enabled by default; if these capabilities are not necessary, they must be disabled. If a particular capability is used, then it must be documented and approved.'\n  desc 'check', 'Use \"system services firewall policy show\" to see all of the configured firewall policies defined in ONTAP.\n\nUse \"network interface show -fields firewall-policy\" to see which network logical interfaces (LIFs) have which firewall policies configured.\n\nNote: Because the cluster LIF is completely open with no configurable firewall policy, it must be on a private IP subnet on a secure isolated network.\n\nIf ONTAP is not configured to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services, this is a finding.'\n  desc 'fix', 'Configure ONTAP new or modify ONTAP firewall policies with \"system services firewall policy create or modify\" to allow specific IP addresses to access specific network services or ports.\n\nConfigure logical interfaces to use firewall policies with \"network interface modify -firewall-policy <firewall_policy_name> -lif <logical_interface_name>\".'\n  impact 0.7\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50378r835245_chk'\n  tag severity: 'high'\n  tag gid: 'V-246946'\n  tag rid: 'SV-246946r835246_rule'\n  tag stig_id: 'NAOT-CM-000009'\n  tag gtitle: 'SRG-APP-000142-NDM-000245'\n  tag fix_id: 'F-50332r769169_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000382']\n  tag nist: ['CM-7 b']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246946.rb"},"title":"ONTAP must be configured to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services.","desc":"In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable unused or unnecessary physical and logical ports/protocols on information systems.\n\nNetwork devices are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the network device must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved. Some network devices have capabilities enabled by default; if these capabilities are not necessary, they must be disabled. If a particular capability is used, then it must be documented and approved.","descriptions":{"default":"In order to prevent unauthorized connection of devices, unauthorized transfer of information, or unauthorized tunneling (i.e., embedding of data types within data types), organizations must disable unused or unnecessary physical and logical ports/protocols on information systems.\n\nNetwork devices are capable of providing a wide variety of functions and services. Some of the functions and services provided by default may not be necessary to support essential organizational operations. Additionally, it is sometimes convenient to provide multiple services from a single component (e.g., email and web services); however, doing so increases risk over limiting the services provided by any one component.\n\nTo support the requirements and principles of least functionality, the network device must support the organizational requirements providing only essential capabilities and limiting the use of ports, protocols, and/or services to only those required, authorized, and approved. Some network devices have capabilities enabled by default; if these capabilities are not necessary, they must be disabled. If a particular capability is used, then it must be documented and approved.","check":"Use \"system services firewall policy show\" to see all of the configured firewall policies defined in ONTAP.\n\nUse \"network interface show -fields firewall-policy\" to see which network logical interfaces (LIFs) have which firewall policies configured.\n\nNote: Because the cluster LIF is completely open with no configurable firewall policy, it must be on a private IP subnet on a secure isolated network.\n\nIf ONTAP is not configured to prohibit the use of all unnecessary and/or nonsecure functions, ports, protocols, and/or services, this is a finding.","fix":"Configure ONTAP new or modify ONTAP firewall policies with \"system services firewall policy create or modify\" to allow specific IP addresses to access specific network services or ports.\n\nConfigure logical interfaces to use firewall policies with \"network interface modify -firewall-policy <firewall_policy_name> -lif <logical_interface_name>\"."},"impact":0.7,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50378r835245_chk","severity":"high","gid":"V-246946","rid":"SV-246946r835246_rule","stig_id":"NAOT-CM-000009","gtitle":"SRG-APP-000142-NDM-000245","fix_id":"F-50332r769169_fix","documentable":null,"cci":["CCI-000382"],"nist":["CM-7 b"]}},{"id":"SV-246947","code":"control 'SV-246947' do\n  title 'ONTAP must be configured to authenticate each administrator prior to authorizing privileges based on assignment of group or role.'\n  desc 'To assure individual accountability and prevent unauthorized access, administrators must be individually identified and authenticated.\n\nIndividual accountability mandates that each administrator is uniquely identified. A group authenticator is a shared account or some other form of authentication that allows multiple unique individuals to access the network device using a single account.\n\nIf a device allows or provides for group authenticators, it must first individually authenticate administrators prior to implementing group authenticator functionality.\n\nSome devices may not have the need to provide a group authenticator; this is considered a matter of device design. In those instances where the device design includes the use of a group authenticator, this requirement will apply. This requirement applies to accounts created and managed on or by the network device.'\n  desc 'check', 'Use \"security login show -role admin -authentication-method domain\" to see all configured admin users and groups that authenticate using active directory.\n\nIf ONTAP is not configured to authenticate each administrator prior to authorizing privileges based on assignment of group or role, this is a finding.'\n  desc 'fix', 'Configure new administrator active directory users or groups with \"security login create -user-or-group-name <user_name> -role admin -authentication-method domain\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50379r835247_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246947'\n  tag rid: 'SV-246947r835248_rule'\n  tag stig_id: 'NAOT-IA-000001'\n  tag gtitle: 'SRG-APP-000153-NDM-000249'\n  tag fix_id: 'F-50333r769172_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000770']\n  tag nist: ['IA-2 (5)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246947.rb"},"title":"ONTAP must be configured to authenticate each administrator prior to authorizing privileges based on assignment of group or role.","desc":"To assure individual accountability and prevent unauthorized access, administrators must be individually identified and authenticated.\n\nIndividual accountability mandates that each administrator is uniquely identified. A group authenticator is a shared account or some other form of authentication that allows multiple unique individuals to access the network device using a single account.\n\nIf a device allows or provides for group authenticators, it must first individually authenticate administrators prior to implementing group authenticator functionality.\n\nSome devices may not have the need to provide a group authenticator; this is considered a matter of device design. In those instances where the device design includes the use of a group authenticator, this requirement will apply. This requirement applies to accounts created and managed on or by the network device.","descriptions":{"default":"To assure individual accountability and prevent unauthorized access, administrators must be individually identified and authenticated.\n\nIndividual accountability mandates that each administrator is uniquely identified. A group authenticator is a shared account or some other form of authentication that allows multiple unique individuals to access the network device using a single account.\n\nIf a device allows or provides for group authenticators, it must first individually authenticate administrators prior to implementing group authenticator functionality.\n\nSome devices may not have the need to provide a group authenticator; this is considered a matter of device design. In those instances where the device design includes the use of a group authenticator, this requirement will apply. This requirement applies to accounts created and managed on or by the network device.","check":"Use \"security login show -role admin -authentication-method domain\" to see all configured admin users and groups that authenticate using active directory.\n\nIf ONTAP is not configured to authenticate each administrator prior to authorizing privileges based on assignment of group or role, this is a finding.","fix":"Configure new administrator active directory users or groups with \"security login create -user-or-group-name <user_name> -role admin -authentication-method domain\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50379r835247_chk","severity":"medium","gid":"V-246947","rid":"SV-246947r835248_rule","stig_id":"NAOT-IA-000001","gtitle":"SRG-APP-000153-NDM-000249","fix_id":"F-50333r769172_fix","documentable":null,"cci":["CCI-000770"],"nist":["IA-2 (5)"]}},{"id":"SV-246948","code":"control 'SV-246948' do\n  title 'ONTAP must implement replay-resistant authentication mechanisms for network access to privileges accounts.'\n  desc 'A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. \n\nTechniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.'\n  desc 'check', 'Use \"security login show -role admin\" to see all configured admin users and groups. \n\nIf any account, other than the admin account used as the account of last resort, has an authentication method other than domain, this is a finding.'\n  desc 'fix', 'Configure new administrator active directory users or groups with \"security login create -user-or-group-name <user_name> -role admin -authentication-method domain\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50380r835249_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246948'\n  tag rid: 'SV-246948r835250_rule'\n  tag stig_id: 'NAOT-IA-000002'\n  tag gtitle: 'SRG-APP-000156-NDM-000250'\n  tag fix_id: 'F-50334r769175_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001941']\n  tag nist: ['IA-2 (8)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246948.rb"},"title":"ONTAP must implement replay-resistant authentication mechanisms for network access to privileges accounts.","desc":"A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. \n\nTechniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.","descriptions":{"default":"A replay attack may enable an unauthorized user to gain access to the application. Authentication sessions between the authenticator and the application validating the user credentials must not be vulnerable to a replay attack.\n\nAn authentication process resists replay attacks if it is impractical to achieve a successful authentication by recording and replaying a previous authentication message. \n\nTechniques used to address this include protocols using nonces (e.g., numbers generated for a specific one-time use) or challenges (e.g., TLS, WS_Security). Additional techniques include time-synchronous or challenge-response one-time authenticators.","check":"Use \"security login show -role admin\" to see all configured admin users and groups. \n\nIf any account, other than the admin account used as the account of last resort, has an authentication method other than domain, this is a finding.","fix":"Configure new administrator active directory users or groups with \"security login create -user-or-group-name <user_name> -role admin -authentication-method domain\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50380r835249_chk","severity":"medium","gid":"V-246948","rid":"SV-246948r835250_rule","stig_id":"NAOT-IA-000002","gtitle":"SRG-APP-000156-NDM-000250","fix_id":"F-50334r769175_fix","documentable":null,"cci":["CCI-001941"],"nist":["IA-2 (8)"]}},{"id":"SV-246949","code":"control 'SV-246949' do\n  title 'ONTAP must be configured to authenticate SNMP messages using FIPS-validated Keyed-HMAC.'\n  desc 'Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.\n\nA local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, internet). A remote connection is any connection with a device communicating through an external network (e.g., the internet).\n\nBecause of the challenges of applying this requirement on a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability.'\n  desc 'check', 'Validate that SNMP is enabled using the command \"options -option-name snmp*\".\n\nIf snmp.enable and snmp.san.enable are set to \"off\", then SNMP is not enabled and this requirement is not applicable.\n\nUse \"security snmpusers -authmethod usm\" to see snmpV3 users using FIPS-validated Keyed-HMAC.\n\nIf ONTAP is not configured to authenticate SNMP messages using FIPS-validated Keyed-HMAC, this is a finding.'\n  desc 'fix', %q(Configure a snmpV3 user using FIPS-validated Keyed-HMAC with \"security login create -user-or-group-name snmptest2 -application snmp -authentication-method usm\".\n\nEnter the authoritative entity's EngineID [local EngineID]:\n\nWhich authentication protocol do you want to choose (none, md5, sha, sha2-256) [none]: sha2-256\n\nEnter the authentication protocol password (minimum 8 characters long):\n\nEnter the authentication protocol password again:\n\nWhich privacy protocol do you want to choose (none, des, aes128) [none]: aes128.)\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50381r835251_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246949'\n  tag rid: 'SV-246949r835252_rule'\n  tag stig_id: 'NAOT-IA-000003'\n  tag gtitle: 'SRG-APP-000395-NDM-000310'\n  tag fix_id: 'F-50335r769178_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001967']\n  tag nist: ['IA-3 (1)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246949.rb"},"title":"ONTAP must be configured to authenticate SNMP messages using FIPS-validated Keyed-HMAC.","desc":"Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.\n\nA local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, internet). A remote connection is any connection with a device communicating through an external network (e.g., the internet).\n\nBecause of the challenges of applying this requirement on a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability.","descriptions":{"default":"Without authenticating devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity. Bidirectional authentication provides stronger safeguards to validate the identity of other devices for connections that are of greater risk.\n\nA local connection is any connection with a device communicating without the use of a network. A network connection is any connection with a device that communicates through a network (e.g., local area or wide area network, internet). A remote connection is any connection with a device communicating through an external network (e.g., the internet).\n\nBecause of the challenges of applying this requirement on a large scale, organizations are encouraged to only apply the requirement to those limited number (and type) of devices that truly need to support this capability.","check":"Validate that SNMP is enabled using the command \"options -option-name snmp*\".\n\nIf snmp.enable and snmp.san.enable are set to \"off\", then SNMP is not enabled and this requirement is not applicable.\n\nUse \"security snmpusers -authmethod usm\" to see snmpV3 users using FIPS-validated Keyed-HMAC.\n\nIf ONTAP is not configured to authenticate SNMP messages using FIPS-validated Keyed-HMAC, this is a finding.","fix":"Configure a snmpV3 user using FIPS-validated Keyed-HMAC with \"security login create -user-or-group-name snmptest2 -application snmp -authentication-method usm\".\n\nEnter the authoritative entity's EngineID [local EngineID]:\n\nWhich authentication protocol do you want to choose (none, md5, sha, sha2-256) [none]: sha2-256\n\nEnter the authentication protocol password (minimum 8 characters long):\n\nEnter the authentication protocol password again:\n\nWhich privacy protocol do you want to choose (none, des, aes128) [none]: aes128."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50381r835251_chk","severity":"medium","gid":"V-246949","rid":"SV-246949r835252_rule","stig_id":"NAOT-IA-000003","gtitle":"SRG-APP-000395-NDM-000310","fix_id":"F-50335r769178_fix","documentable":null,"cci":["CCI-001967"],"nist":["IA-3 (1)"]}},{"id":"SV-246950","code":"control 'SV-246950' do\n  title 'ONTAP must authenticate NTP sources using authentication that is cryptographically based.'\n  desc 'If Network Time Protocol (NTP) is not authenticated, an attacker can introduce a rogue NTP server. This rogue server can then be used to send incorrect time information to network devices, which will make log timestamps inaccurate and affect scheduled actions. NTP authentication is used to prevent this tampering by authenticating the time source.'\n  desc 'check', 'Use \"cluster time-service ntp server show\" to see authenticated NTP sources using authentication that is cryptographically based.\n\nIf any of the NTP servers listed has the field \"Is Authentication Enabled\" set to false, this is a finding.'\n  desc 'fix', 'Configure an authenticated NTP source using authentication that is cryptographically based with \"cluster time-service ntp server create -server <ip_address> -key-id <NTP_Symmetric_Authentication_Key_ID>\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50382r835253_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246950'\n  tag rid: 'SV-246950r835254_rule'\n  tag stig_id: 'NAOT-IA-000004'\n  tag gtitle: 'SRG-APP-000395-NDM-000347'\n  tag fix_id: 'F-50336r769181_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001967']\n  tag nist: ['IA-3 (1)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246950.rb"},"title":"ONTAP must authenticate NTP sources using authentication that is cryptographically based.","desc":"If Network Time Protocol (NTP) is not authenticated, an attacker can introduce a rogue NTP server. This rogue server can then be used to send incorrect time information to network devices, which will make log timestamps inaccurate and affect scheduled actions. NTP authentication is used to prevent this tampering by authenticating the time source.","descriptions":{"default":"If Network Time Protocol (NTP) is not authenticated, an attacker can introduce a rogue NTP server. This rogue server can then be used to send incorrect time information to network devices, which will make log timestamps inaccurate and affect scheduled actions. NTP authentication is used to prevent this tampering by authenticating the time source.","check":"Use \"cluster time-service ntp server show\" to see authenticated NTP sources using authentication that is cryptographically based.\n\nIf any of the NTP servers listed has the field \"Is Authentication Enabled\" set to false, this is a finding.","fix":"Configure an authenticated NTP source using authentication that is cryptographically based with \"cluster time-service ntp server create -server <ip_address> -key-id <NTP_Symmetric_Authentication_Key_ID>\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50382r835253_chk","severity":"medium","gid":"V-246950","rid":"SV-246950r835254_rule","stig_id":"NAOT-IA-000004","gtitle":"SRG-APP-000395-NDM-000347","fix_id":"F-50336r769181_fix","documentable":null,"cci":["CCI-001967"],"nist":["IA-3 (1)"]}},{"id":"SV-246951","code":"control 'SV-246951' do\n  title 'ONTAP must enforce a minimum 15-character password length.'\n  desc 'Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password.\n\nThe shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.'\n  desc 'check', 'Use \"security login role config show -role admin -fields passwd-minlength\" to see the minimum password length for the role admin.\n\nIf ONTAP is not configured to enforce a minimum 15-character password length, this is a finding.'\n  desc 'fix', 'Configure the minimum password length for the role admin to 15 with \"security login role config modify -role admin -passwd-minlength 15\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50383r835255_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246951'\n  tag rid: 'SV-246951r835256_rule'\n  tag stig_id: 'NAOT-IA-000005'\n  tag gtitle: 'SRG-APP-000164-NDM-000252'\n  tag fix_id: 'F-50337r769184_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000205']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246951.rb"},"title":"ONTAP must enforce a minimum 15-character password length.","desc":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password.\n\nThe shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","descriptions":{"default":"Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. Password length is one factor of several that helps to determine strength and how long it takes to crack a password.\n\nThe shorter the password, the lower the number of possible combinations that need to be tested before the password is compromised. Use of more characters in a password helps to exponentially increase the time and/or resources required to compromise the password.","check":"Use \"security login role config show -role admin -fields passwd-minlength\" to see the minimum password length for the role admin.\n\nIf ONTAP is not configured to enforce a minimum 15-character password length, this is a finding.","fix":"Configure the minimum password length for the role admin to 15 with \"security login role config modify -role admin -passwd-minlength 15\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50383r835255_chk","severity":"medium","gid":"V-246951","rid":"SV-246951r835256_rule","stig_id":"NAOT-IA-000005","gtitle":"SRG-APP-000164-NDM-000252","fix_id":"F-50337r769184_fix","documentable":null,"cci":["CCI-000205"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-246952","code":"control 'SV-246952' do\n  title 'ONTAP must enforce password complexity by requiring that at least one uppercase character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.'\n  desc 'check', 'Use \"security login role config show -role admin -fields passwd-min-uppercase-chars\" to see the minimum number of uppercase characters required in a password for the role admin.\n\nIf ONTAP is not configured to enforce password complexity by requiring that at least one uppercase character be used, this is a finding.'\n  desc 'fix', 'Configure ONTAP to enforce password complexity by requiring that at least one uppercase character be used for the role admin with \"security login role config modify  -role admin -passwd-min-uppercase-chars 1\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50384r835257_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246952'\n  tag rid: 'SV-246952r835259_rule'\n  tag stig_id: 'NAOT-IA-000006'\n  tag gtitle: 'SRG-APP-000166-NDM-000254'\n  tag fix_id: 'F-50338r835258_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000192']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246952.rb"},"title":"ONTAP must enforce password complexity by requiring that at least one uppercase character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password is, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","check":"Use \"security login role config show -role admin -fields passwd-min-uppercase-chars\" to see the minimum number of uppercase characters required in a password for the role admin.\n\nIf ONTAP is not configured to enforce password complexity by requiring that at least one uppercase character be used, this is a finding.","fix":"Configure ONTAP to enforce password complexity by requiring that at least one uppercase character be used for the role admin with \"security login role config modify  -role admin -passwd-min-uppercase-chars 1\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50384r835257_chk","severity":"medium","gid":"V-246952","rid":"SV-246952r835259_rule","stig_id":"NAOT-IA-000006","gtitle":"SRG-APP-000166-NDM-000254","fix_id":"F-50338r835258_fix","documentable":null,"cci":["CCI-000192"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-246953","code":"control 'SV-246953' do\n  title 'ONTAP must enforce password complexity by requiring that at least one lowercase character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.'\n  desc 'check', 'Use \"security login role config show -role admin -fields passwd-min-lowercase-chars\" to see the minimum number of lowercase characters required in a password for the role admin.\n\nIf ONTAP is not configured to enforce password complexity by requiring that at least one lowercase character be used, this is a finding.'\n  desc 'fix', 'Configure ONTAP to enforce password complexity by requiring that at least one lowercase character be used for the role admin with \"security login role config modify  -role admin -passwd-min-lowercase-chars 1\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50385r835260_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246953'\n  tag rid: 'SV-246953r835262_rule'\n  tag stig_id: 'NAOT-IA-000007'\n  tag gtitle: 'SRG-APP-000167-NDM-000255'\n  tag fix_id: 'F-50339r835261_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000193']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246953.rb"},"title":"ONTAP must enforce password complexity by requiring that at least one lowercase character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","check":"Use \"security login role config show -role admin -fields passwd-min-lowercase-chars\" to see the minimum number of lowercase characters required in a password for the role admin.\n\nIf ONTAP is not configured to enforce password complexity by requiring that at least one lowercase character be used, this is a finding.","fix":"Configure ONTAP to enforce password complexity by requiring that at least one lowercase character be used for the role admin with \"security login role config modify  -role admin -passwd-min-lowercase-chars 1\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50385r835260_chk","severity":"medium","gid":"V-246953","rid":"SV-246953r835262_rule","stig_id":"NAOT-IA-000007","gtitle":"SRG-APP-000167-NDM-000255","fix_id":"F-50339r835261_fix","documentable":null,"cci":["CCI-000193"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-246954","code":"control 'SV-246954' do\n  title 'ONTAP must enforce password complexity by requiring that at least one numeric character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.'\n  desc 'check', 'Use \"security login role config show -role admin -fields passwd-alphanum\" to see at least one letter and one number are required in a password for the role admin.\n\nIf ONTAP is not configured to enforce password complexity by requiring that at least one numeric character be used, this is a finding.'\n  desc 'fix', 'Configure ONTAP to enforce password complexity by requiring that at least one numeric character be used with \"security login role config modify -role admin -passwd-alphanum enabled\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50386r835263_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246954'\n  tag rid: 'SV-246954r835264_rule'\n  tag stig_id: 'NAOT-IA-000008'\n  tag gtitle: 'SRG-APP-000168-NDM-000256'\n  tag fix_id: 'F-50340r769193_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000194']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246954.rb"},"title":"ONTAP must enforce password complexity by requiring that at least one numeric character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","check":"Use \"security login role config show -role admin -fields passwd-alphanum\" to see at least one letter and one number are required in a password for the role admin.\n\nIf ONTAP is not configured to enforce password complexity by requiring that at least one numeric character be used, this is a finding.","fix":"Configure ONTAP to enforce password complexity by requiring that at least one numeric character be used with \"security login role config modify -role admin -passwd-alphanum enabled\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50386r835263_chk","severity":"medium","gid":"V-246954","rid":"SV-246954r835264_rule","stig_id":"NAOT-IA-000008","gtitle":"SRG-APP-000168-NDM-000256","fix_id":"F-50340r769193_fix","documentable":null,"cci":["CCI-000194"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-246955","code":"control 'SV-246955' do\n  title 'ONTAP must enforce password complexity by requiring that at least one special character be used.'\n  desc 'Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.'\n  desc 'check', 'Use \"security login role config show -role admin -fields passwd-min-special-chars\" to see the minimum number of special characters required in a password for the role admin.\n\nIf ONTAP is not configured to enforce password complexity by requiring that at least one special character be used, this is a finding.'\n  desc 'fix', 'Configure ONTAP to enforce password complexity by requiring that at least one special character be used with \"security login role config modify -role admin -passwd-min-special-chars 1\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50387r835265_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246955'\n  tag rid: 'SV-246955r835266_rule'\n  tag stig_id: 'NAOT-IA-000009'\n  tag gtitle: 'SRG-APP-000169-NDM-000257'\n  tag fix_id: 'F-50341r769196_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001619']\n  tag nist: ['IA-5 (1) (a)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246955.rb"},"title":"ONTAP must enforce password complexity by requiring that at least one special character be used.","desc":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","descriptions":{"default":"Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks.\n\nPassword complexity is one factor of several that determine how long it takes to crack a password. The more complex the password, the greater the number of possible combinations that need to be tested before the password is compromised.\n\nMultifactor authentication (MFA) is required for all administrative and user accounts on network devices, except for an account of last resort and (where applicable) a root account. Passwords should only be used when MFA using PKI is not available, and for the account of last resort and root account.","check":"Use \"security login role config show -role admin -fields passwd-min-special-chars\" to see the minimum number of special characters required in a password for the role admin.\n\nIf ONTAP is not configured to enforce password complexity by requiring that at least one special character be used, this is a finding.","fix":"Configure ONTAP to enforce password complexity by requiring that at least one special character be used with \"security login role config modify -role admin -passwd-min-special-chars 1\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50387r835265_chk","severity":"medium","gid":"V-246955","rid":"SV-246955r835266_rule","stig_id":"NAOT-IA-000009","gtitle":"SRG-APP-000169-NDM-000257","fix_id":"F-50341r769196_fix","documentable":null,"cci":["CCI-001619"],"nist":["IA-5 (1) (a)"]}},{"id":"SV-246958","code":"control 'SV-246958' do\n  title 'ONTAP must be configured to implement cryptographic mechanisms using FIPS 140-2.'\n  desc 'Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\n'\n  desc 'check', 'Use \"set -privilege advanced\" reply \"y\" to continue and \"security config show\" to see if cluster FIPS mode is true.\n\nIf ONTAP is not configured to implement cryptographic mechanisms using FIPS 140-2, this is a finding.'\n  desc 'fix', 'Configure ONTAP to use cryptographic mechanisms with \"set -privilege advanced\" reply \"y\" to continue and  \"security config modify -is-fips-enabled true\".'\n  impact 0.7\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50390r835270_chk'\n  tag severity: 'high'\n  tag gid: 'V-246958'\n  tag rid: 'SV-246958r835271_rule'\n  tag stig_id: 'NAOT-MA-000002'\n  tag gtitle: 'SRG-APP-000412-NDM-000331'\n  tag fix_id: 'F-50344r769205_fix'\n  tag satisfies: ['SRG-APP-000412-NDM-000331', 'SRG-APP-000411-NDM-000330', 'SRG-APP-000179-NDM-000265']\n  tag 'documentable'\n  tag cci: ['CCI-000803', 'CCI-003123', 'CCI-002890']\n  tag nist: ['IA-7', 'MA-4 (6)', 'MA-4 (6)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246958.rb"},"title":"ONTAP must be configured to implement cryptographic mechanisms using FIPS 140-2.","desc":"Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\n","descriptions":{"default":"Unapproved mechanisms that are used for authentication to the cryptographic module are not verified and therefore cannot be relied upon to provide confidentiality or integrity, and DoD data may be compromised.\n\n","check":"Use \"set -privilege advanced\" reply \"y\" to continue and \"security config show\" to see if cluster FIPS mode is true.\n\nIf ONTAP is not configured to implement cryptographic mechanisms using FIPS 140-2, this is a finding.","fix":"Configure ONTAP to use cryptographic mechanisms with \"set -privilege advanced\" reply \"y\" to continue and  \"security config modify -is-fips-enabled true\"."},"impact":0.7,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50390r835270_chk","severity":"high","gid":"V-246958","rid":"SV-246958r835271_rule","stig_id":"NAOT-MA-000002","gtitle":"SRG-APP-000412-NDM-000331","fix_id":"F-50344r769205_fix","satisfies":["SRG-APP-000412-NDM-000331","SRG-APP-000411-NDM-000330","SRG-APP-000179-NDM-000265"],"documentable":null,"cci":["CCI-000803","CCI-003123","CCI-002890"],"nist":["IA-7","MA-4 (6)","MA-4 (6)"]}},{"id":"SV-246959","code":"control 'SV-246959' do\n  title 'ONTAP must terminate all network connections associated with a device management session at the end of the session, or the session must be terminated after 10 minutes of inactivity except to fulfill documented and validated mission requirements.'\n  desc 'Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.\n\nTerminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system-level network connection. This does not mean that the device terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.'\n  desc 'check', 'Use \"system timeout show\" to see the session timeout in minutes.\n\nIf ONTAP does not terminate the connection associated with a device management session at the end of the session or after 10 minutes of inactivity, this is a finding.'\n  desc 'fix', 'Configure ONTAP to timeout idle sessions after 10 minutes with \"system timeout modify -timeout 10\".'\n  impact 0.7\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50391r769207_chk'\n  tag severity: 'high'\n  tag gid: 'V-246959'\n  tag rid: 'SV-246959r769209_rule'\n  tag stig_id: 'NAOT-SC-000001'\n  tag gtitle: 'SRG-APP-000190-NDM-000267'\n  tag fix_id: 'F-50345r769208_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001133']\n  tag nist: ['SC-10']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246959.rb"},"title":"ONTAP must terminate all network connections associated with a device management session at the end of the session, or the session must be terminated after 10 minutes of inactivity except to fulfill documented and validated mission requirements.","desc":"Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.\n\nTerminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system-level network connection. This does not mean that the device terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.","descriptions":{"default":"Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session will also free up resources committed by the managed network element.\n\nTerminating network connections associated with communications sessions includes, for example, de-allocating associated TCP/IP address/port pairs at the operating system level, or de-allocating networking assignments at the application level if multiple application sessions are using a single, operating system-level network connection. This does not mean that the device terminates all sessions or network access; it only ends the inactive session and releases the resources associated with that session.","check":"Use \"system timeout show\" to see the session timeout in minutes.\n\nIf ONTAP does not terminate the connection associated with a device management session at the end of the session or after 10 minutes of inactivity, this is a finding.","fix":"Configure ONTAP to timeout idle sessions after 10 minutes with \"system timeout modify -timeout 10\"."},"impact":0.7,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50391r769207_chk","severity":"high","gid":"V-246959","rid":"SV-246959r769209_rule","stig_id":"NAOT-SC-000001","gtitle":"SRG-APP-000190-NDM-000267","fix_id":"F-50345r769208_fix","documentable":null,"cci":["CCI-001133"],"nist":["SC-10"]}},{"id":"SV-246963","code":"control 'SV-246963' do\n  title 'ONTAP must be configured to use a data authentication key to safeguard against denial-of-service (DoS) attacks.'\n  desc 'DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nUsually, DoS attacks are assumed to be network related where the attacker floods the network with traffic that causes legitimate network traffic to be either slowed or blocked. For a storage device, a DoS attack can also occur when an attacker is able to make the data on the disks unreadable, thus unavailable, to the customer. This is a common attack used by ransomware where the attacker encrypts the data on the drives requesting payment for the unencryption key. By using data authentication keys, an attacker is unable to read or write data to the drives. It is also important to make sure the mode of the drives is set to full, otherwise only some of the data on the drive is protected.'\n  desc 'check', 'Validate that a data authentication key has been assigned using the command \"storage encryption disk show\".\n\nIf any of the disks has a mode other than \"full\" or the Data Key ID is missing, this is a finding.'\n  desc 'fix', 'Configure ONTAP to use a data authentication key for access with the command \"storage encryption disk modify -disk <disk_ID> -data-key-id <key-ID>\" where disk_ID is the disk and key_ID is the data authentication key. \n\nTo verify the key is set, use the command \"storage encryption disk show -disk <disk_ID>\". The command will show the data mode. The mode must be set to full.\n\nIf the mode is not set to full, use the command \"disk modify -disk <disk_ID> -protection-mode full\" to set the mode to full.  Validate the mode changed using the command \"storage encryption disk show -disk <disk_ID>\".'\n  impact 0.5\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50395r835275_chk'\n  tag severity: 'medium'\n  tag gid: 'V-246963'\n  tag rid: 'SV-246963r835277_rule'\n  tag stig_id: 'NAOT-SC-000005'\n  tag gtitle: 'SRG-APP-000435-NDM-000315'\n  tag fix_id: 'F-50349r835276_fix'\n  tag 'documentable'\n  tag cci: ['CCI-002385']\n  tag nist: ['SC-5 a']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246963.rb"},"title":"ONTAP must be configured to use a data authentication key to safeguard against denial-of-service (DoS) attacks.","desc":"DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nUsually, DoS attacks are assumed to be network related where the attacker floods the network with traffic that causes legitimate network traffic to be either slowed or blocked. For a storage device, a DoS attack can also occur when an attacker is able to make the data on the disks unreadable, thus unavailable, to the customer. This is a common attack used by ransomware where the attacker encrypts the data on the drives requesting payment for the unencryption key. By using data authentication keys, an attacker is unable to read or write data to the drives. It is also important to make sure the mode of the drives is set to full, otherwise only some of the data on the drive is protected.","descriptions":{"default":"DoS is a condition when a resource is not available for legitimate users. When this occurs, the organization either cannot accomplish its mission or must operate at degraded capacity.\n\nUsually, DoS attacks are assumed to be network related where the attacker floods the network with traffic that causes legitimate network traffic to be either slowed or blocked. For a storage device, a DoS attack can also occur when an attacker is able to make the data on the disks unreadable, thus unavailable, to the customer. This is a common attack used by ransomware where the attacker encrypts the data on the drives requesting payment for the unencryption key. By using data authentication keys, an attacker is unable to read or write data to the drives. It is also important to make sure the mode of the drives is set to full, otherwise only some of the data on the drive is protected.","check":"Validate that a data authentication key has been assigned using the command \"storage encryption disk show\".\n\nIf any of the disks has a mode other than \"full\" or the Data Key ID is missing, this is a finding.","fix":"Configure ONTAP to use a data authentication key for access with the command \"storage encryption disk modify -disk <disk_ID> -data-key-id <key-ID>\" where disk_ID is the disk and key_ID is the data authentication key. \n\nTo verify the key is set, use the command \"storage encryption disk show -disk <disk_ID>\". The command will show the data mode. The mode must be set to full.\n\nIf the mode is not set to full, use the command \"disk modify -disk <disk_ID> -protection-mode full\" to set the mode to full.  Validate the mode changed using the command \"storage encryption disk show -disk <disk_ID>\"."},"impact":0.5,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50395r835275_chk","severity":"medium","gid":"V-246963","rid":"SV-246963r835277_rule","stig_id":"NAOT-SC-000005","gtitle":"SRG-APP-000435-NDM-000315","fix_id":"F-50349r835276_fix","documentable":null,"cci":["CCI-002385"],"nist":["SC-5 a"]}},{"id":"SV-246964","code":"control 'SV-246964' do\n  title 'ONTAP must be configured to send audit log data to a central log server.'\n  desc 'The aggregation of log data kept on a syslog server can be used to detect attacks and trigger an alert to the appropriate security personnel. The stored log data can used to detect weaknesses in security that enable the network IA team to find and address these weaknesses before breaches can occur. Reviewing these logs, whether before or after a security breach, are important in showing whether someone is an internal employee or an outside threat.'\n  desc 'check', 'Use \"cluster log-forwarding show\" to see if audit logs are being sent to a remote logging server.\n\nSample output from the command:\n\n                                                                                           Verify   Syslog\nDestination Host         Port   Protocol                   Server   Facility\n------------------------ ------ ----------------------- --------  --------\n192.168.0.1                     514    udp-unencrypted false       user\n\nIf no remote logging servers are listed, this is a finding.'\n  desc 'fix', 'Configure ONTAP for remote syslogging with \"cluster log-forwarding create -destination <hostname_or_ip_address>\".'\n  impact 0.7\n  ref 'DPMS Target NetApp ONTAP DSC 9.x'\n  tag check_id: 'C-50396r835278_chk'\n  tag severity: 'high'\n  tag gid: 'V-246964'\n  tag rid: 'SV-246964r835279_rule'\n  tag stig_id: 'NAOT-SI-000001'\n  tag gtitle: 'SRG-APP-000516-NDM-000350'\n  tag fix_id: 'F-50350r769223_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_NetApp_ONTAP_DSC_9-x_STIG_V1R2/controls/SV-246964.rb"},"title":"ONTAP must be configured to send audit log data to a central log server.","desc":"The aggregation of log data kept on a syslog server can be used to detect attacks and trigger an alert to the appropriate security personnel. The stored log data can used to detect weaknesses in security that enable the network IA team to find and address these weaknesses before breaches can occur. Reviewing these logs, whether before or after a security breach, are important in showing whether someone is an internal employee or an outside threat.","descriptions":{"default":"The aggregation of log data kept on a syslog server can be used to detect attacks and trigger an alert to the appropriate security personnel. The stored log data can used to detect weaknesses in security that enable the network IA team to find and address these weaknesses before breaches can occur. Reviewing these logs, whether before or after a security breach, are important in showing whether someone is an internal employee or an outside threat.","check":"Use \"cluster log-forwarding show\" to see if audit logs are being sent to a remote logging server.\n\nSample output from the command:\n\n                                                                                           Verify   Syslog\nDestination Host         Port   Protocol                   Server   Facility\n------------------------ ------ ----------------------- --------  --------\n192.168.0.1                     514    udp-unencrypted false       user\n\nIf no remote logging servers are listed, this is a finding.","fix":"Configure ONTAP for remote syslogging with \"cluster log-forwarding create -destination <hostname_or_ip_address>\"."},"impact":0.7,"refs":[{"ref":"DPMS Target NetApp ONTAP DSC 9.x"}],"tags":{"check_id":"C-50396r835278_chk","severity":"high","gid":"V-246964","rid":"SV-246964r835279_rule","stig_id":"NAOT-SI-000001","gtitle":"SRG-APP-000516-NDM-000350","fix_id":"F-50350r769223_fix","documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}}],"groups":[{"id":"controls/SV-246922.rb","title":null,"controls":["SV-246922"]},{"id":"controls/SV-246923.rb","title":null,"controls":["SV-246923"]},{"id":"controls/SV-246925.rb","title":null,"controls":["SV-246925"]},{"id":"controls/SV-246926.rb","title":null,"controls":["SV-246926"]},{"id":"controls/SV-246927.rb","title":null,"controls":["SV-246927"]},{"id":"controls/SV-246930.rb","title":null,"controls":["SV-246930"]},{"id":"controls/SV-246931.rb","title":null,"controls":["SV-246931"]},{"id":"controls/SV-246932.rb","title":null,"controls":["SV-246932"]},{"id":"controls/SV-246933.rb","title":null,"controls":["SV-246933"]},{"id":"controls/SV-246935.rb","title":null,"controls":["SV-246935"]},{"id":"controls/SV-246936.rb","title":null,"controls":["SV-246936"]},{"id":"controls/SV-246938.rb","title":null,"controls":["SV-246938"]},{"id":"controls/SV-246939.rb","title":null,"controls":["SV-246939"]},{"id":"controls/SV-246940.rb","title":null,"controls":["SV-246940"]},{"id":"controls/SV-246944.rb","title":null,"controls":["SV-246944"]},{"id":"controls/SV-246945.rb","title":null,"controls":["SV-246945"]},{"id":"controls/SV-246946.rb","title":null,"controls":["SV-246946"]},{"id":"controls/SV-246947.rb","title":null,"controls":["SV-246947"]},{"id":"controls/SV-246948.rb","title":null,"controls":["SV-246948"]},{"id":"controls/SV-246949.rb","title":null,"controls":["SV-246949"]},{"id":"controls/SV-246950.rb","title":null,"controls":["SV-246950"]},{"id":"controls/SV-246951.rb","title":null,"controls":["SV-246951"]},{"id":"controls/SV-246952.rb","title":null,"controls":["SV-246952"]},{"id":"controls/SV-246953.rb","title":null,"controls":["SV-246953"]},{"id":"controls/SV-246954.rb","title":null,"controls":["SV-246954"]},{"id":"controls/SV-246955.rb","title":null,"controls":["SV-246955"]},{"id":"controls/SV-246958.rb","title":null,"controls":["SV-246958"]},{"id":"controls/SV-246959.rb","title":null,"controls":["SV-246959"]},{"id":"controls/SV-246963.rb","title":null,"controls":["SV-246963"]},{"id":"controls/SV-246964.rb","title":null,"controls":["SV-246964"]}],"name":"NetApp_ONTAP_DSC_9-x_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"aa48bae28e390b17734cf83598d06cf9337f5f4afc951b7068228ef3f8683a6c","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
