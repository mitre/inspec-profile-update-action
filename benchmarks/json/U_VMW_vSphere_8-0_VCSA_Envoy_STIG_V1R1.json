{"controls":[{"id":"SV-259161","code":"control 'SV-259161' do\n  title 'The vCenter Envoy and Rhttpproxy service log files permissions must be set correctly.'\n  desc 'Log data is essential in the investigation of events. If log data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to log records provides information an attacker could potentially use to their advantage since each event record might contain communication ports, protocols, services, trust relationships, usernames, etc.\n\nThe web server must protect the log data from unauthorized read, write, copy, etc. This can be done by the web server if the web server is also doing the logging function. The web server may also use an external log system. In either case, the logs must be protected from access by nonprivileged users.\n\n'\n  desc 'check', \"At the command prompt, run the following commands:\n\n# find /var/log/vmware/rhttpproxy/ -xdev -type f -a '(' -perm -o+w -o -not -user rhttpproxy -o -not -group rhttpproxy ')' -exec ls -ld {} \\\\;\n# find /var/log/vmware/envoy/ -xdev -type f -a '(' -perm -o+w -o -not -user envoy -o -not -group envoy ')' -exec ls -ld {} \\\\;\n\nIf any files are returned, this is a finding.\"\n  desc 'fix', 'At the command prompt, run the following commands for rhttpproxy log files:\n\n# chmod o-w <file>\n# chown rhttpproxy:rhttpproxy <file>\n\nor\n\nAt the command prompt, run the following commands for envoy log files:\n\n# chmod o-w <file>\n# chown envoy:envoy <file>'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Envoy'\n  tag check_id: 'C-62901r935385_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259161'\n  tag rid: 'SV-259161r935387_rule'\n  tag stig_id: 'VCRP-80-000019'\n  tag gtitle: 'SRG-APP-000118-WSR-000068'\n  tag fix_id: 'F-62810r935386_fix'\n  tag satisfies: ['SRG-APP-000118-WSR-000068', 'SRG-APP-000119-WSR-000069', 'SRG-APP-000120-WSR-000070']\n  tag 'documentable'\n  tag cci: ['CCI-000162', 'CCI-000163', 'CCI-000164']\n  tag nist: ['AU-9 a', 'AU-9 a', 'AU-9 a']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Envoy_STIG_V1R1/controls/SV-259161.rb"},"title":"The vCenter Envoy and Rhttpproxy service log files permissions must be set correctly.","desc":"Log data is essential in the investigation of events. If log data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to log records provides information an attacker could potentially use to their advantage since each event record might contain communication ports, protocols, services, trust relationships, usernames, etc.\n\nThe web server must protect the log data from unauthorized read, write, copy, etc. This can be done by the web server if the web server is also doing the logging function. The web server may also use an external log system. In either case, the logs must be protected from access by nonprivileged users.\n\n","descriptions":{"default":"Log data is essential in the investigation of events. If log data were to become compromised, then competent forensic analysis and discovery of the true source of potentially malicious system activity would be difficult, if not impossible, to achieve. In addition, access to log records provides information an attacker could potentially use to their advantage since each event record might contain communication ports, protocols, services, trust relationships, usernames, etc.\n\nThe web server must protect the log data from unauthorized read, write, copy, etc. This can be done by the web server if the web server is also doing the logging function. The web server may also use an external log system. In either case, the logs must be protected from access by nonprivileged users.\n\n","check":"At the command prompt, run the following commands:\n\n# find /var/log/vmware/rhttpproxy/ -xdev -type f -a '(' -perm -o+w -o -not -user rhttpproxy -o -not -group rhttpproxy ')' -exec ls -ld {} \\;\n# find /var/log/vmware/envoy/ -xdev -type f -a '(' -perm -o+w -o -not -user envoy -o -not -group envoy ')' -exec ls -ld {} \\;\n\nIf any files are returned, this is a finding.","fix":"At the command prompt, run the following commands for rhttpproxy log files:\n\n# chmod o-w <file>\n# chown rhttpproxy:rhttpproxy <file>\n\nor\n\nAt the command prompt, run the following commands for envoy log files:\n\n# chmod o-w <file>\n# chown envoy:envoy <file>"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Envoy"}],"tags":{"check_id":"C-62901r935385_chk","severity":"medium","gid":"V-259161","rid":"SV-259161r935387_rule","stig_id":"VCRP-80-000019","gtitle":"SRG-APP-000118-WSR-000068","fix_id":"F-62810r935386_fix","satisfies":["SRG-APP-000118-WSR-000068","SRG-APP-000119-WSR-000069","SRG-APP-000120-WSR-000070"],"documentable":null,"cci":["CCI-000162","CCI-000163","CCI-000164"],"nist":["AU-9 a","AU-9 a","AU-9 a"]}},{"id":"SV-259162","code":"control 'SV-259162' do\n  title 'The vCenter Envoy service private key file must be protected from unauthorized access.'\n  desc \"Envoy's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients.\n \nBy gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the Transport Layer Security (TLS) traffic between a client and the web server.\"\n  desc 'check', 'At the command prompt, run the following command:\n\n# stat -c \"%n permissions are %a, is owned by %U and group owned by %G\" /etc/vmware-rhttpproxy/ssl/rui.key\n\nExpected result:\n\n/etc/vmware-rhttpproxy/ssl/rui.key permissions are 600, is owned by rhttpproxy and group owned by rhttpproxy\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'At the command prompt, run the following commands:\n\n# chmod 600 /etc/vmware-rhttpproxy/ssl/rui.key\n# chown rhttpproxy:rhttpproxy /etc/vmware-rhttpproxy/ssl/rui.key'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Envoy'\n  tag check_id: 'C-62902r935388_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259162'\n  tag rid: 'SV-259162r935390_rule'\n  tag stig_id: 'VCRP-80-000040'\n  tag gtitle: 'SRG-APP-000176-WSR-000096'\n  tag fix_id: 'F-62811r935389_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000186']\n  tag nist: ['IA-5 (2) (a) (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Envoy_STIG_V1R1/controls/SV-259162.rb"},"title":"The vCenter Envoy service private key file must be protected from unauthorized access.","desc":"Envoy's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients.\n \nBy gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the Transport Layer Security (TLS) traffic between a client and the web server.","descriptions":{"default":"Envoy's private key is used to prove the identity of the server to clients and securely exchange the shared secret key used to encrypt communications between the web server and clients.\n \nBy gaining access to the private key, an attacker can pretend to be an authorized server and decrypt the Transport Layer Security (TLS) traffic between a client and the web server.","check":"At the command prompt, run the following command:\n\n# stat -c \"%n permissions are %a, is owned by %U and group owned by %G\" /etc/vmware-rhttpproxy/ssl/rui.key\n\nExpected result:\n\n/etc/vmware-rhttpproxy/ssl/rui.key permissions are 600, is owned by rhttpproxy and group owned by rhttpproxy\n\nIf the output does not match the expected result, this is a finding.","fix":"At the command prompt, run the following commands:\n\n# chmod 600 /etc/vmware-rhttpproxy/ssl/rui.key\n# chown rhttpproxy:rhttpproxy /etc/vmware-rhttpproxy/ssl/rui.key"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Envoy"}],"tags":{"check_id":"C-62902r935388_chk","severity":"medium","gid":"V-259162","rid":"SV-259162r935390_rule","stig_id":"VCRP-80-000040","gtitle":"SRG-APP-000176-WSR-000096","fix_id":"F-62811r935389_fix","documentable":null,"cci":["CCI-000186"],"nist":["IA-5 (2) (a) (1)"]}},{"id":"SV-259163","code":"control 'SV-259163' do\n  title 'The vCenter Rhttpproxy service log files must be sent to a central log server.'\n  desc 'Writing events to a centralized management audit system offers many benefits to the enterprise over having dispersed logs. Centralized management of audit records and logs provides for efficiency in maintenance and management of records, enterprise analysis of events, and backup and archiving of event records enterprise-wide. The web server and related components are required to be capable of writing logs to centralized audit log servers.\n\n'\n  desc 'check', 'By default, there is a vmware-services-rhttpproxy.conf rsyslog configuration file that includes the service logs when syslog is configured on vCenter, but it must be verified.\n\nAt the command prompt, run the following command:\n\n# cat /etc/vmware-syslog/vmware-services-rhttpproxy.conf\n\nExpected result:\n\n#rhttpproxy log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\"\n      Tag=\"rhttpproxy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rhttpproxy init stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rproxy_init.log.stdout\"\n      Tag=\"rhttpproxy-stdout\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rhttpproxy init stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rproxy_init.log.stderr\"\n      Tag=\"rhttpproxy-stderr\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/vmware-syslog/vmware-services-rhttpproxy.conf\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\n#rhttpproxy log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\"\n      Tag=\"rhttpproxy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rhttpproxy init stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rproxy_init.log.stdout\"\n      Tag=\"rhttpproxy-stdout\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rhttpproxy init stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rproxy_init.log.stderr\"\n      Tag=\"rhttpproxy-stderr\"\n      Severity=\"info\"\n      Facility=\"local0\")'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Envoy'\n  tag check_id: 'C-62903r935391_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259163'\n  tag rid: 'SV-259163r935393_rule'\n  tag stig_id: 'VCRP-80-000073'\n  tag gtitle: 'SRG-APP-000358-WSR-000063'\n  tag fix_id: 'F-62812r935392_fix'\n  tag satisfies: ['SRG-APP-000358-WSR-000063', 'SRG-APP-000125-WSR-000071']\n  tag 'documentable'\n  tag cci: ['CCI-001348', 'CCI-001851']\n  tag nist: ['AU-9 (2)', 'AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Envoy_STIG_V1R1/controls/SV-259163.rb"},"title":"The vCenter Rhttpproxy service log files must be sent to a central log server.","desc":"Writing events to a centralized management audit system offers many benefits to the enterprise over having dispersed logs. Centralized management of audit records and logs provides for efficiency in maintenance and management of records, enterprise analysis of events, and backup and archiving of event records enterprise-wide. The web server and related components are required to be capable of writing logs to centralized audit log servers.\n\n","descriptions":{"default":"Writing events to a centralized management audit system offers many benefits to the enterprise over having dispersed logs. Centralized management of audit records and logs provides for efficiency in maintenance and management of records, enterprise analysis of events, and backup and archiving of event records enterprise-wide. The web server and related components are required to be capable of writing logs to centralized audit log servers.\n\n","check":"By default, there is a vmware-services-rhttpproxy.conf rsyslog configuration file that includes the service logs when syslog is configured on vCenter, but it must be verified.\n\nAt the command prompt, run the following command:\n\n# cat /etc/vmware-syslog/vmware-services-rhttpproxy.conf\n\nExpected result:\n\n#rhttpproxy log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\"\n      Tag=\"rhttpproxy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rhttpproxy init stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rproxy_init.log.stdout\"\n      Tag=\"rhttpproxy-stdout\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rhttpproxy init stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rproxy_init.log.stderr\"\n      Tag=\"rhttpproxy-stderr\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open:\n\n/etc/vmware-syslog/vmware-services-rhttpproxy.conf\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\n#rhttpproxy log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rhttpproxy.log\"\n      Tag=\"rhttpproxy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rhttpproxy init stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rproxy_init.log.stdout\"\n      Tag=\"rhttpproxy-stdout\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#rhttpproxy init stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/rhttpproxy/rproxy_init.log.stderr\"\n      Tag=\"rhttpproxy-stderr\"\n      Severity=\"info\"\n      Facility=\"local0\")"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Envoy"}],"tags":{"check_id":"C-62903r935391_chk","severity":"medium","gid":"V-259163","rid":"SV-259163r935393_rule","stig_id":"VCRP-80-000073","gtitle":"SRG-APP-000358-WSR-000063","fix_id":"F-62812r935392_fix","satisfies":["SRG-APP-000358-WSR-000063","SRG-APP-000125-WSR-000071"],"documentable":null,"cci":["CCI-001348","CCI-001851"],"nist":["AU-9 (2)","AU-4 (1)"]}},{"id":"SV-259164","code":"control 'SV-259164' do\n  title 'The vCenter Envoy service log files must be sent to a central log server.'\n  desc 'Writing events to a centralized management audit system offers many benefits to the enterprise over having dispersed logs. Centralized management of audit records and logs provides for efficiency in maintenance and management of records, enterprise analysis of events, and backup and archiving of event records enterprise-wide. The web server and related components are required to be capable of writing logs to centralized audit log servers.'\n  desc 'check', 'By default, there is a vmware-services-envoy.conf rsyslog configuration file that includes the service logs when syslog is configured on vCenter, but it must be verified.\n\nAt the command prompt, run the following command:\n\n# cat /etc/vmware-syslog/vmware-services-envoy.conf\n\nExpected result:\n\n#envoy service log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy.log\"\n      Tag=\"envoy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy access log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy-access.log\"\n      Tag=\"envoy-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy init stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy_init.log.stdout\"\n      Tag=\"envoy-stdout\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy init stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy_init.log.stderr\"\n      Tag=\"envoy-stderr\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the output does not match the expected result, this is a finding.'\n  desc 'fix', 'Navigate to and open:\n\n/etc/vmware-syslog/vmware-services-envoy.conf\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\n#envoy service log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy.log\"\n      Tag=\"envoy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy access log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy-access.log\"\n      Tag=\"envoy-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy init stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy_init.log.stdout\"\n      Tag=\"envoy-stdout\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy init stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy_init.log.stderr\"\n      Tag=\"envoy-stderr\"\n      Severity=\"info\"\n      Facility=\"local0\")'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Envoy'\n  tag check_id: 'C-62904r935394_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259164'\n  tag rid: 'SV-259164r935396_rule'\n  tag stig_id: 'VCRP-80-000097'\n  tag gtitle: 'SRG-APP-000358-WSR-000063'\n  tag fix_id: 'F-62813r935395_fix'\n  tag 'documentable'\n  tag cci: ['CCI-001851']\n  tag nist: ['AU-4 (1)']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Envoy_STIG_V1R1/controls/SV-259164.rb"},"title":"The vCenter Envoy service log files must be sent to a central log server.","desc":"Writing events to a centralized management audit system offers many benefits to the enterprise over having dispersed logs. Centralized management of audit records and logs provides for efficiency in maintenance and management of records, enterprise analysis of events, and backup and archiving of event records enterprise-wide. The web server and related components are required to be capable of writing logs to centralized audit log servers.","descriptions":{"default":"Writing events to a centralized management audit system offers many benefits to the enterprise over having dispersed logs. Centralized management of audit records and logs provides for efficiency in maintenance and management of records, enterprise analysis of events, and backup and archiving of event records enterprise-wide. The web server and related components are required to be capable of writing logs to centralized audit log servers.","check":"By default, there is a vmware-services-envoy.conf rsyslog configuration file that includes the service logs when syslog is configured on vCenter, but it must be verified.\n\nAt the command prompt, run the following command:\n\n# cat /etc/vmware-syslog/vmware-services-envoy.conf\n\nExpected result:\n\n#envoy service log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy.log\"\n      Tag=\"envoy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy access log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy-access.log\"\n      Tag=\"envoy-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy init stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy_init.log.stdout\"\n      Tag=\"envoy-stdout\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy init stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy_init.log.stderr\"\n      Tag=\"envoy-stderr\"\n      Severity=\"info\"\n      Facility=\"local0\")\n\nIf the output does not match the expected result, this is a finding.","fix":"Navigate to and open:\n\n/etc/vmware-syslog/vmware-services-envoy.conf\n\nCreate the file if it does not exist.\n\nSet the contents of the file as follows:\n\n#envoy service log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy.log\"\n      Tag=\"envoy-main\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy access log\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy-access.log\"\n      Tag=\"envoy-access\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy init stdout\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy_init.log.stdout\"\n      Tag=\"envoy-stdout\"\n      Severity=\"info\"\n      Facility=\"local0\")\n#envoy init stderr\ninput(type=\"imfile\"\n      File=\"/var/log/vmware/envoy/envoy_init.log.stderr\"\n      Tag=\"envoy-stderr\"\n      Severity=\"info\"\n      Facility=\"local0\")"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Envoy"}],"tags":{"check_id":"C-62904r935394_chk","severity":"medium","gid":"V-259164","rid":"SV-259164r935396_rule","stig_id":"VCRP-80-000097","gtitle":"SRG-APP-000358-WSR-000063","fix_id":"F-62813r935395_fix","documentable":null,"cci":["CCI-001851"],"nist":["AU-4 (1)"]}},{"id":"SV-259165","code":"control 'SV-259165' do\n  title 'The vCenter Envoy service must set a limit on remote connections.'\n  desc 'Envoy client connections must be limited to preserve system resources and continue servicing connections without interruption. Without a limit set, the system would be vulnerable to a trivial denial-of-service attack where connections are created en masse and vCenter resources are entirely consumed.\n\nEnvoy comes hard coded with a tested and supported value for \"maxRemoteHttpsConnections\" and \"maxRemoteHttpConnections\" that must be verified and maintained.'\n  desc 'check', %q(At the command prompt, run the following commands:\n\n# xmllint --xpath '/config/envoy/L4Filter/maxRemoteHttpsConnections/text()' /etc/vmware-rhttpproxy/config.xml\n# xmllint --xpath '/config/envoy/L4Filter/maxRemoteHttpConnections/text()' /etc/vmware-rhttpproxy/config.xml\n\nExample result:\n\n2048\n\nor\n\nXPath set is empty\n\nIf the output is not \"2048\" or \"XPath set it empty\", this is a finding.\n\nNote: If \"XPath set is empty\" is returned the default values are in effect and is 2048.)\n  desc 'fix', 'Navigate to and open:\n\n/etc/vmware-rhttpproxy/config.xml\n\nLocate the <config>/<envoy>/<L4Filter> block and configure it as follows:\n\n<maxRemoteHttpsConnections>2048</maxRemoteHttpsConnections>\n<maxRemoteHttpConnections>2048</maxRemoteHttpConnections>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy'\n  impact 0.5\n  ref 'DPMS Target VMware vSphere 8.0 VCSA Envoy'\n  tag check_id: 'C-62905r935397_chk'\n  tag severity: 'medium'\n  tag gid: 'V-259165'\n  tag rid: 'SV-259165r935399_rule'\n  tag stig_id: 'VCRP-80-000098'\n  tag gtitle: 'SRG-APP-000001-WSR-000001'\n  tag fix_id: 'F-62814r935398_fix'\n  tag 'documentable'\n  tag cci: ['CCI-000054']\n  tag nist: ['AC-10']\nend","source_location":{"line":1,"ref":"U_VMW_vSphere_8-0_VCSA_Envoy_STIG_V1R1/controls/SV-259165.rb"},"title":"The vCenter Envoy service must set a limit on remote connections.","desc":"Envoy client connections must be limited to preserve system resources and continue servicing connections without interruption. Without a limit set, the system would be vulnerable to a trivial denial-of-service attack where connections are created en masse and vCenter resources are entirely consumed.\n\nEnvoy comes hard coded with a tested and supported value for \"maxRemoteHttpsConnections\" and \"maxRemoteHttpConnections\" that must be verified and maintained.","descriptions":{"default":"Envoy client connections must be limited to preserve system resources and continue servicing connections without interruption. Without a limit set, the system would be vulnerable to a trivial denial-of-service attack where connections are created en masse and vCenter resources are entirely consumed.\n\nEnvoy comes hard coded with a tested and supported value for \"maxRemoteHttpsConnections\" and \"maxRemoteHttpConnections\" that must be verified and maintained.","check":"At the command prompt, run the following commands:\n\n# xmllint --xpath '/config/envoy/L4Filter/maxRemoteHttpsConnections/text()' /etc/vmware-rhttpproxy/config.xml\n# xmllint --xpath '/config/envoy/L4Filter/maxRemoteHttpConnections/text()' /etc/vmware-rhttpproxy/config.xml\n\nExample result:\n\n2048\n\nor\n\nXPath set is empty\n\nIf the output is not \"2048\" or \"XPath set it empty\", this is a finding.\n\nNote: If \"XPath set is empty\" is returned the default values are in effect and is 2048.","fix":"Navigate to and open:\n\n/etc/vmware-rhttpproxy/config.xml\n\nLocate the <config>/<envoy>/<L4Filter> block and configure it as follows:\n\n<maxRemoteHttpsConnections>2048</maxRemoteHttpsConnections>\n<maxRemoteHttpConnections>2048</maxRemoteHttpConnections>\n\nRestart the service for changes to take effect.\n\n# vmon-cli --restart rhttpproxy"},"impact":0.5,"refs":[{"ref":"DPMS Target VMware vSphere 8.0 VCSA Envoy"}],"tags":{"check_id":"C-62905r935397_chk","severity":"medium","gid":"V-259165","rid":"SV-259165r935399_rule","stig_id":"VCRP-80-000098","gtitle":"SRG-APP-000001-WSR-000001","fix_id":"F-62814r935398_fix","documentable":null,"cci":["CCI-000054"],"nist":["AC-10"]}}],"groups":[{"id":"controls/SV-259161.rb","title":null,"controls":["SV-259161"]},{"id":"controls/SV-259162.rb","title":null,"controls":["SV-259162"]},{"id":"controls/SV-259163.rb","title":null,"controls":["SV-259163"]},{"id":"controls/SV-259164.rb","title":null,"controls":["SV-259164"]},{"id":"controls/SV-259165.rb","title":null,"controls":["SV-259165"]}],"name":"VMW_vSphere_8-0_VCSA_Envoy_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"bee086df747533d0fd93726f5615be9501c943f53e8e9ee9c27203429fcf3872","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
