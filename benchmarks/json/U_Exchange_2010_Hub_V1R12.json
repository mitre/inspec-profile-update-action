{"controls":[{"id":"SV-43981","code":"control 'SV-43981' do\n  title 'Message size restrictions must be controlled on Receive connectors.'\n  desc 'Email system availability depends in part on best practices strategies for setting tuning configurations. For message size restrictions, multiple places exist to set or override inbound or outbound message size. Failure to control the configuration strategy can result in loss of data or system availability. \n\nThis setting enables the administrator to control the maximum message size on receive connectors. Using connectors to control size limits may necessitate the need to apply message size limitations in multiple places, with the potential of introducing conflicts and impediments in the mail flow. Changing this setting at the connector overrides the global one. Therefore, if operational needs require it, the connector value may be set lower than that of the global value with the rationale and documented in the EDSP.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the global maximum message receive size and if signoff with risk acceptance is documented for the receive connector to have a different value.\n\nOpen the Exchange Management Shell and enter the following command:\nGet-ReceiveConnector | Select Name, Identity, MaxMessageSize \n\nor\n\nGet-TransportConfig | Select Identity, MaxReceiveSize \n\nIdentify Internet-facing connectors on the Edge Transport server. \n\nIf 'MaxMessageSize' is set to a numeric value different from the global value, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of ‘MaxMessageSize' is not the same as the global value, this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -MaxMessageSize <MaxReceiveSize>\n\nIf an alternate value is desired from the global value MaxReceiveSize, obtain signoff with risk acceptance and document in the EDSP.\"\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41668r4_chk'\n  tag severity: 'low'\n  tag gid: 'V-33561'\n  tag rid: 'SV-43981r3_rule'\n  tag stig_id: 'Exch-2-705'\n  tag gtitle: 'Exch-2-705'\n  tag fix_id: 'F-37453r3_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-43981.rb"},"title":"Message size restrictions must be controlled on Receive connectors.","desc":"Email system availability depends in part on best practices strategies for setting tuning configurations. For message size restrictions, multiple places exist to set or override inbound or outbound message size. Failure to control the configuration strategy can result in loss of data or system availability. \n\nThis setting enables the administrator to control the maximum message size on receive connectors. Using connectors to control size limits may necessitate the need to apply message size limitations in multiple places, with the potential of introducing conflicts and impediments in the mail flow. Changing this setting at the connector overrides the global one. Therefore, if operational needs require it, the connector value may be set lower than that of the global value with the rationale and documented in the EDSP.","descriptions":{"default":"Email system availability depends in part on best practices strategies for setting tuning configurations. For message size restrictions, multiple places exist to set or override inbound or outbound message size. Failure to control the configuration strategy can result in loss of data or system availability. \n\nThis setting enables the administrator to control the maximum message size on receive connectors. Using connectors to control size limits may necessitate the need to apply message size limitations in multiple places, with the potential of introducing conflicts and impediments in the mail flow. Changing this setting at the connector overrides the global one. Therefore, if operational needs require it, the connector value may be set lower than that of the global value with the rationale and documented in the EDSP.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the global maximum message receive size and if signoff with risk acceptance is documented for the receive connector to have a different value.\n\nOpen the Exchange Management Shell and enter the following command:\nGet-ReceiveConnector | Select Name, Identity, MaxMessageSize \n\nor\n\nGet-TransportConfig | Select Identity, MaxReceiveSize \n\nIdentify Internet-facing connectors on the Edge Transport server. \n\nIf 'MaxMessageSize' is set to a numeric value different from the global value, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of ‘MaxMessageSize' is not the same as the global value, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -MaxMessageSize <MaxReceiveSize>\n\nIf an alternate value is desired from the global value MaxReceiveSize, obtain signoff with risk acceptance and document in the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41668r4_chk","severity":"low","gid":"V-33561","rid":"SV-43981r3_rule","stig_id":"Exch-2-705","gtitle":"Exch-2-705","fix_id":"F-37453r3_fix","documentable":null}},{"id":"SV-43984","code":"control 'SV-43984' do\n  title 'Receive Connector timeout must be limited.'\n  desc 'Email system availability depends in part on best practices strategies for setting tuning.   This configuration controls the number of idle minutes before the connection is dropped.   It works in conjunction with the Maximum Inbound Connections Count setting.  \n\nConnections, once established, may incur delays in message transfer.   If the timeout period is too long, there is risk that idle connections may be maintained for unnecessarily long time periods, preventing new connections from being established.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the 'Connection Timeout' value.  \n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity, ConnectionTimeout\n\nIf the value of 'ConnectionTimeout' is set to 00:10:00, this is not a finding.\n\nIf 'ConnectionTimeout' is set to other than 00:10:00, and has signoff and risk acceptance in the EDSP, this is not a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -ConnectionTimeout 00:10:00 or other value as identified by the EDSP.\"\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41670r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-33564'\n  tag rid: 'SV-43984r1_rule'\n  tag stig_id: 'Exch-2-710'\n  tag gtitle: 'Exch-2-710'\n  tag fix_id: 'F-37456r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-43984.rb"},"title":"Receive Connector timeout must be limited.","desc":"Email system availability depends in part on best practices strategies for setting tuning.   This configuration controls the number of idle minutes before the connection is dropped.   It works in conjunction with the Maximum Inbound Connections Count setting.  \n\nConnections, once established, may incur delays in message transfer.   If the timeout period is too long, there is risk that idle connections may be maintained for unnecessarily long time periods, preventing new connections from being established.","descriptions":{"default":"Email system availability depends in part on best practices strategies for setting tuning.   This configuration controls the number of idle minutes before the connection is dropped.   It works in conjunction with the Maximum Inbound Connections Count setting.  \n\nConnections, once established, may incur delays in message transfer.   If the timeout period is too long, there is risk that idle connections may be maintained for unnecessarily long time periods, preventing new connections from being established.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the 'Connection Timeout' value.  \n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity, ConnectionTimeout\n\nIf the value of 'ConnectionTimeout' is set to 00:10:00, this is not a finding.\n\nIf 'ConnectionTimeout' is set to other than 00:10:00, and has signoff and risk acceptance in the EDSP, this is not a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -ConnectionTimeout 00:10:00 or other value as identified by the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41670r1_chk","severity":"low","gid":"V-33564","rid":"SV-43984r1_rule","stig_id":"Exch-2-710","gtitle":"Exch-2-710","fix_id":"F-37456r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-43986","code":"control 'SV-43986' do\n  title 'Internal Receive Connectors must not allow anonymous connections.'\n  desc 'This control is used to limit the servers that may use this server as a relay.  If a Simple Mail Transport Protocol (SMTP) sender does not have a direct connection to the Internet (for example, an application that produces reports to be emailed) then it will need to use an SMTP Receive Connector that does have a path to the Internet (for example, a local email server) as a relay.\n\nSMTP relay functions must be protected so third parties are not able to hijack a relay service for their own purposes.  Most commonly, hijacking of relays is done by SPAMMERS to disguise the source of their messages, and may also be used to cover the source of more destructive attacks.  \n \nRelays can be restricted in one of three ways; by blocking relays (restrict to a blank list of servers), by restricting use to lists of valid servers, or by restricting use to servers that can authenticate.   Because authenticated connections are the most secure for SMTP Receive Connectors, it is recommended that relays allow only servers that can authenticate.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity, PermissionGroups\n\nIf the value of 'PermissionGroups' is 'AnonymousUsers' for any non-internet connector, this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -PermissionGroups and enter a valid value other than 'AnonymousUsers'.\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41672r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33566'\n  tag rid: 'SV-43986r1_rule'\n  tag stig_id: 'Exch-2-715'\n  tag gtitle: 'Exch-2-715'\n  tag fix_id: 'F-37458r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-43986.rb"},"title":"Internal Receive Connectors must not allow anonymous connections.","desc":"This control is used to limit the servers that may use this server as a relay.  If a Simple Mail Transport Protocol (SMTP) sender does not have a direct connection to the Internet (for example, an application that produces reports to be emailed) then it will need to use an SMTP Receive Connector that does have a path to the Internet (for example, a local email server) as a relay.\n\nSMTP relay functions must be protected so third parties are not able to hijack a relay service for their own purposes.  Most commonly, hijacking of relays is done by SPAMMERS to disguise the source of their messages, and may also be used to cover the source of more destructive attacks.  \n \nRelays can be restricted in one of three ways; by blocking relays (restrict to a blank list of servers), by restricting use to lists of valid servers, or by restricting use to servers that can authenticate.   Because authenticated connections are the most secure for SMTP Receive Connectors, it is recommended that relays allow only servers that can authenticate.","descriptions":{"default":"This control is used to limit the servers that may use this server as a relay.  If a Simple Mail Transport Protocol (SMTP) sender does not have a direct connection to the Internet (for example, an application that produces reports to be emailed) then it will need to use an SMTP Receive Connector that does have a path to the Internet (for example, a local email server) as a relay.\n\nSMTP relay functions must be protected so third parties are not able to hijack a relay service for their own purposes.  Most commonly, hijacking of relays is done by SPAMMERS to disguise the source of their messages, and may also be used to cover the source of more destructive attacks.  \n \nRelays can be restricted in one of three ways; by blocking relays (restrict to a blank list of servers), by restricting use to lists of valid servers, or by restricting use to servers that can authenticate.   Because authenticated connections are the most secure for SMTP Receive Connectors, it is recommended that relays allow only servers that can authenticate.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity, PermissionGroups\n\nIf the value of 'PermissionGroups' is 'AnonymousUsers' for any non-internet connector, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -PermissionGroups and enter a valid value other than 'AnonymousUsers'."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41672r1_chk","severity":"medium","gid":"V-33566","rid":"SV-43986r1_rule","stig_id":"Exch-2-715","gtitle":"Exch-2-715","fix_id":"F-37458r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-43987","code":"control 'SV-43987' do\n  title 'Internal Receive Connectors must require encryption.'\n  desc 'The Simple Mail Transfer Protocol (SMTP) Receive Connector is used by Exchange to send and receive messages from server to server using SMTP protocol.  This setting controls the encryption strength used for client connections to the SMTP Receive Connector.  With this feature enabled, only clients capable of supporting secure communications will be able to send mail using this SMTP server.  Where secure channels are required, encryption can also be selected. \n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers.    While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from the client to the server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender.  \n\nIndividually, channel security and encryption have been compromised by attackers.  Used together, email becomes a more difficult target, and security is heightened.  Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between the client and server.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity, AuthMechanism\n\nIf the value of 'AuthMechanism' is not set to 'Tls', this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -AuthMechanism 'Tls'\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41673r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33567'\n  tag rid: 'SV-43987r1_rule'\n  tag stig_id: 'Exch-2-718'\n  tag gtitle: 'Exch-2-718'\n  tag fix_id: 'F-37459r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-43987.rb"},"title":"Internal Receive Connectors must require encryption.","desc":"The Simple Mail Transfer Protocol (SMTP) Receive Connector is used by Exchange to send and receive messages from server to server using SMTP protocol.  This setting controls the encryption strength used for client connections to the SMTP Receive Connector.  With this feature enabled, only clients capable of supporting secure communications will be able to send mail using this SMTP server.  Where secure channels are required, encryption can also be selected. \n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers.    While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from the client to the server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender.  \n\nIndividually, channel security and encryption have been compromised by attackers.  Used together, email becomes a more difficult target, and security is heightened.  Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between the client and server.","descriptions":{"default":"The Simple Mail Transfer Protocol (SMTP) Receive Connector is used by Exchange to send and receive messages from server to server using SMTP protocol.  This setting controls the encryption strength used for client connections to the SMTP Receive Connector.  With this feature enabled, only clients capable of supporting secure communications will be able to send mail using this SMTP server.  Where secure channels are required, encryption can also be selected. \n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers.    While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from the client to the server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender.  \n\nIndividually, channel security and encryption have been compromised by attackers.  Used together, email becomes a more difficult target, and security is heightened.  Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between the client and server.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity, AuthMechanism\n\nIf the value of 'AuthMechanism' is not set to 'Tls', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -AuthMechanism 'Tls'"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41673r1_chk","severity":"medium","gid":"V-33567","rid":"SV-43987r1_rule","stig_id":"Exch-2-718","gtitle":"Exch-2-718","fix_id":"F-37459r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-43992","code":"control 'SV-43992' do\n  title 'Receive Connectors must control the number of recipients per message.'\n  desc 'Email system availability depends in part on best practices strategies for setting tuning configurations. \n\nThis configuration controls the maximum number of recipients who will receive a copy of a message at one time.  This tunable value is related to throughput capacity and can enable the ability to optimize message delivery. \n\nNote: There are two types of default Receive Connecters:\nClient Servername: This Receive connector accepts SMTP connections from all non-MAPI clients, such as POP and IMAP. As POP and IMAP are not authorized for use in DoD, these should not be present. Their default value for MaxRecipientsPerMessage is 200.\nDefault Servername: This Receive connector accepts connections from other Hub Transport servers and any Edge Transport servers. Their default value for MaxRecipientsPerMessage is 5000.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the 'Maximum Recipients per Message' value:\n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity, MaxRecipientsPerMessage\n\nFor each receive connector, evaluate the 'MaxRecipientsPerMessage' value.  \n\nIf the value of 'Maximum Recipients per Message' is set to a value other than 5000, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of 'MaxRecipientsPerMessage' is not set to 5000, this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -MaxRecipientsPerMessage 5000 or other value as identified by the EDSP.\"\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41678r2_chk'\n  tag severity: 'low'\n  tag gid: 'V-33572'\n  tag rid: 'SV-43992r2_rule'\n  tag stig_id: 'Exch-2-727'\n  tag gtitle: 'Exch-2-727'\n  tag fix_id: 'F-37463r2_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-43992.rb"},"title":"Receive Connectors must control the number of recipients per message.","desc":"Email system availability depends in part on best practices strategies for setting tuning configurations. \n\nThis configuration controls the maximum number of recipients who will receive a copy of a message at one time.  This tunable value is related to throughput capacity and can enable the ability to optimize message delivery. \n\nNote: There are two types of default Receive Connecters:\nClient Servername: This Receive connector accepts SMTP connections from all non-MAPI clients, such as POP and IMAP. As POP and IMAP are not authorized for use in DoD, these should not be present. Their default value for MaxRecipientsPerMessage is 200.\nDefault Servername: This Receive connector accepts connections from other Hub Transport servers and any Edge Transport servers. Their default value for MaxRecipientsPerMessage is 5000.","descriptions":{"default":"Email system availability depends in part on best practices strategies for setting tuning configurations. \n\nThis configuration controls the maximum number of recipients who will receive a copy of a message at one time.  This tunable value is related to throughput capacity and can enable the ability to optimize message delivery. \n\nNote: There are two types of default Receive Connecters:\nClient Servername: This Receive connector accepts SMTP connections from all non-MAPI clients, such as POP and IMAP. As POP and IMAP are not authorized for use in DoD, these should not be present. Their default value for MaxRecipientsPerMessage is 200.\nDefault Servername: This Receive connector accepts connections from other Hub Transport servers and any Edge Transport servers. Their default value for MaxRecipientsPerMessage is 5000.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the 'Maximum Recipients per Message' value:\n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity, MaxRecipientsPerMessage\n\nFor each receive connector, evaluate the 'MaxRecipientsPerMessage' value.  \n\nIf the value of 'Maximum Recipients per Message' is set to a value other than 5000, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of 'MaxRecipientsPerMessage' is not set to 5000, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -MaxRecipientsPerMessage 5000 or other value as identified by the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41678r2_chk","severity":"low","gid":"V-33572","rid":"SV-43992r2_rule","stig_id":"Exch-2-727","gtitle":"Exch-2-727","fix_id":"F-37463r2_fix","documentable":null}},{"id":"SV-43995","code":"control 'SV-43995' do\n  title 'Receive Connectors must be clearly named.'\n  desc 'For receive connectors, unclear naming as to direction and purpose increases risk that messages may not flow as intended, troubleshooting efforts may be impaired, or incorrect assumptions may be made about the completeness of the configuration.  \n\nCollectively,  connectors should account for all connections required for the overall email topology design.  Simple Mail Transfer Protocol (SMTP) connectors, when listed, must name purpose and direction clearly, and their counterparts on servers to which they connect should be recognizable as their partners.'\n  desc 'check', 'Open the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity\n\nReview the naming for connectors. If the connectors are not clearly named for purpose and direction, this is a finding.'\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Name <'NewName'> -Identity <'ReceiveConnector'>\"\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41681r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-33575'\n  tag rid: 'SV-43995r1_rule'\n  tag stig_id: 'Exch-2-733'\n  tag gtitle: 'Exch-2-733'\n  tag fix_id: 'F-37466r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-43995.rb"},"title":"Receive Connectors must be clearly named.","desc":"For receive connectors, unclear naming as to direction and purpose increases risk that messages may not flow as intended, troubleshooting efforts may be impaired, or incorrect assumptions may be made about the completeness of the configuration.  \n\nCollectively,  connectors should account for all connections required for the overall email topology design.  Simple Mail Transfer Protocol (SMTP) connectors, when listed, must name purpose and direction clearly, and their counterparts on servers to which they connect should be recognizable as their partners.","descriptions":{"default":"For receive connectors, unclear naming as to direction and purpose increases risk that messages may not flow as intended, troubleshooting efforts may be impaired, or incorrect assumptions may be made about the completeness of the configuration.  \n\nCollectively,  connectors should account for all connections required for the overall email topology design.  Simple Mail Transfer Protocol (SMTP) connectors, when listed, must name purpose and direction clearly, and their counterparts on servers to which they connect should be recognizable as their partners.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity\n\nReview the naming for connectors. If the connectors are not clearly named for purpose and direction, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Name <'NewName'> -Identity <'ReceiveConnector'>"},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41681r1_chk","severity":"low","gid":"V-33575","rid":"SV-43995r1_rule","stig_id":"Exch-2-733","gtitle":"Exch-2-733","fix_id":"F-37466r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-43996","code":"control 'SV-43996' do\n  title 'Auto-forwarding email to remote domains must be disabled or restricted.'\n  desc 'Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Ensure Automatic Forwards to remote domains are disabled, except for enterprise mail that must be restricted to forward-only to .mil and .gov. domains.\n\nBefore enabling this setting first configure a remote domain.'\n  desc 'check', \"Non- Enterprise Mail Check Content: \n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-RemoteDomain | select identity, AutoForwardEnabled\n\nIf the value of 'AutoForwardEnabled' is not set to 'False', this is a finding.\n\nEnterprise Mail Check Content:\n\nIf the value of 'AutoForwardEnabled' is set to 'True', this is not a finding.\n\nand \n\nIn the Exchange Management Shell and enter the following command:\n\nGet-RemoteDomain\n\nIf the value of  'RemoteDomain ' is not set to a ' .mil' and/or '.gov ' domain(s), this is a finding.\"\n  desc 'fix', \"Non- Enterprise Mail Fix Text:\n\nOpen the Exchange Management Shell and enter the following command:\n\nSet-RemoteDomain -Identity <'RemoteDomainName'> -AutoForwardEnabled $false \n\nEnterprise Mail Fix Text:\n\nNew-RemoteDomain -Name <Descriptive Name> -DomainName <SMTP address space>\n\nSet-RemoteDomain -Identity <'RemoteDomainName'> -AutoForwardEnabled $true\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41682r6_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33576'\n  tag rid: 'SV-43996r2_rule'\n  tag stig_id: 'Exch-2-736'\n  tag gtitle: 'Exch-2-736'\n  tag fix_id: 'F-37467r3_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-43996.rb"},"title":"Auto-forwarding email to remote domains must be disabled or restricted.","desc":"Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Ensure Automatic Forwards to remote domains are disabled, except for enterprise mail that must be restricted to forward-only to .mil and .gov. domains.\n\nBefore enabling this setting first configure a remote domain.","descriptions":{"default":"Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Ensure Automatic Forwards to remote domains are disabled, except for enterprise mail that must be restricted to forward-only to .mil and .gov. domains.\n\nBefore enabling this setting first configure a remote domain.","check":"Non- Enterprise Mail Check Content: \n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-RemoteDomain | select identity, AutoForwardEnabled\n\nIf the value of 'AutoForwardEnabled' is not set to 'False', this is a finding.\n\nEnterprise Mail Check Content:\n\nIf the value of 'AutoForwardEnabled' is set to 'True', this is not a finding.\n\nand \n\nIn the Exchange Management Shell and enter the following command:\n\nGet-RemoteDomain\n\nIf the value of  'RemoteDomain ' is not set to a ' .mil' and/or '.gov ' domain(s), this is a finding.","fix":"Non- Enterprise Mail Fix Text:\n\nOpen the Exchange Management Shell and enter the following command:\n\nSet-RemoteDomain -Identity <'RemoteDomainName'> -AutoForwardEnabled $false \n\nEnterprise Mail Fix Text:\n\nNew-RemoteDomain -Name <Descriptive Name> -DomainName <SMTP address space>\n\nSet-RemoteDomain -Identity <'RemoteDomainName'> -AutoForwardEnabled $true"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41682r6_chk","severity":"medium","gid":"V-33576","rid":"SV-43996r2_rule","stig_id":"Exch-2-736","gtitle":"Exch-2-736","fix_id":"F-37467r3_fix","documentable":null}},{"id":"SV-43999","code":"control 'SV-43999' do\n  title 'Receive Connector Maximum Hop Count must be 60.'\n  desc 'Email system availability depends in part on best practices strategies for setting tuning configurations. This setting controls the maximum number of hops (email servers traversed) a message may take as it travels to its destination. Part of the original Internet protocol implementation, the hop count limit prevents a message being passed in a routing loop indefinitely. Messages exceeding the maximum hop count are discarded undelivered. \n\nRecent studies indicate that virtually all messages can be delivered in fewer than 60 hops. If the hop count is set too low, messages may expire before they reach their destinations. If set too high, an undeliverable message may cycle between servers, raising the risk of network congestion.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the value for 'Receive Connectors”.\nOpen the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select name, MaxHopCount\n\nIf the value of 'MaxHopCount' is set to 60 this is not a finding.\n\nIf the value of 'MaxHopCount' is set to a value other than 60 and has signoff and risk acceptance in the EDSP, this is not a finding.\"\n  desc 'fix', 'Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -MaxHopCount 60\n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP.'\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41685r3_chk'\n  tag severity: 'low'\n  tag gid: 'V-33579'\n  tag rid: 'SV-43999r2_rule'\n  tag stig_id: 'Exch-2-741'\n  tag gtitle: 'Exch-2-741'\n  tag fix_id: 'F-37470r1_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-43999.rb"},"title":"Receive Connector Maximum Hop Count must be 60.","desc":"Email system availability depends in part on best practices strategies for setting tuning configurations. This setting controls the maximum number of hops (email servers traversed) a message may take as it travels to its destination. Part of the original Internet protocol implementation, the hop count limit prevents a message being passed in a routing loop indefinitely. Messages exceeding the maximum hop count are discarded undelivered. \n\nRecent studies indicate that virtually all messages can be delivered in fewer than 60 hops. If the hop count is set too low, messages may expire before they reach their destinations. If set too high, an undeliverable message may cycle between servers, raising the risk of network congestion.","descriptions":{"default":"Email system availability depends in part on best practices strategies for setting tuning configurations. This setting controls the maximum number of hops (email servers traversed) a message may take as it travels to its destination. Part of the original Internet protocol implementation, the hop count limit prevents a message being passed in a routing loop indefinitely. Messages exceeding the maximum hop count are discarded undelivered. \n\nRecent studies indicate that virtually all messages can be delivered in fewer than 60 hops. If the hop count is set too low, messages may expire before they reach their destinations. If set too high, an undeliverable message may cycle between servers, raising the risk of network congestion.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the value for 'Receive Connectors”.\nOpen the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select name, MaxHopCount\n\nIf the value of 'MaxHopCount' is set to 60 this is not a finding.\n\nIf the value of 'MaxHopCount' is set to a value other than 60 and has signoff and risk acceptance in the EDSP, this is not a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -MaxHopCount 60\n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41685r3_chk","severity":"low","gid":"V-33579","rid":"SV-43999r2_rule","stig_id":"Exch-2-741","gtitle":"Exch-2-741","fix_id":"F-37470r1_fix","documentable":null}},{"id":"SV-44004","code":"control 'SV-44004' do\n  title 'Send Connectors must be clearly named.'\n  desc 'For send connectors, unclear naming as to direction and purpose increases risk that messages may not flow as intended, troubleshooting efforts may be impaired, or incorrect assumptions may be made about the completeness of the configuration.  \n\nCollectively,  connectors should account for all connections required for the overall email topology design.  Simple Mail Transfer Protocol (SMTP) connectors, when listed, must name purpose and direction clearly, and their counterparts on servers to which they connect should be recognizable as their partners.'\n  desc 'check', 'Open the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select Name, Identity\n\nReview the naming for connectors. If the connectors are not clearly named for purpose and direction, this is a finding.'\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector -Name <'NewName'> -Identity <'SendConnector'>\"\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41689r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-33583'\n  tag rid: 'SV-44004r1_rule'\n  tag stig_id: 'Exch-2-751'\n  tag gtitle: 'Exch-2-751'\n  tag fix_id: 'F-37474r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44004.rb"},"title":"Send Connectors must be clearly named.","desc":"For send connectors, unclear naming as to direction and purpose increases risk that messages may not flow as intended, troubleshooting efforts may be impaired, or incorrect assumptions may be made about the completeness of the configuration.  \n\nCollectively,  connectors should account for all connections required for the overall email topology design.  Simple Mail Transfer Protocol (SMTP) connectors, when listed, must name purpose and direction clearly, and their counterparts on servers to which they connect should be recognizable as their partners.","descriptions":{"default":"For send connectors, unclear naming as to direction and purpose increases risk that messages may not flow as intended, troubleshooting efforts may be impaired, or incorrect assumptions may be made about the completeness of the configuration.  \n\nCollectively,  connectors should account for all connections required for the overall email topology design.  Simple Mail Transfer Protocol (SMTP) connectors, when listed, must name purpose and direction clearly, and their counterparts on servers to which they connect should be recognizable as their partners.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select Name, Identity\n\nReview the naming for connectors. If the connectors are not clearly named for purpose and direction, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector -Name <'NewName'> -Identity <'SendConnector'>"},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41689r1_chk","severity":"low","gid":"V-33583","rid":"SV-44004r1_rule","stig_id":"Exch-2-751","gtitle":"Exch-2-751","fix_id":"F-37474r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44006","code":"control 'SV-44006' do\n  title 'Send Connectors delivery retries must be controlled.'\n  desc 'This setting controls the rate at which delivery attempts from the home domain are retried, user notifications are issued, and notes the expiration time when the message will be discarded.  \n\nIf delivery retry attempts are too frequent, servers will generate network congestion. If too far apart, then messages may remain queued longer than necessary, potentially raising disk resource requirements.    \n\nThe default values of these fields should be adequate for most environments.  Administrators may wish to modify the values as a result, but changes should be documented in the System Security Plan.\n\nNOTE: Transport configuration settings apply to the organization/global level of the Exchange SMTP path.  By checking and setting them at the Hub server the setting will apply to both Hub and Edge roles.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the value for 'Transient Failure Retry Count'.\n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-TransportServer -Identity <'ServerUnderReview'> | Select Name, Identity, TransientFailureRetryCount\n\nIf the value of 'TransientFailureRetryCount' is set to 10 or less, this is not a finding.\n\nIf the value of 'TransientFailureRetryCount' is set to more than 10, and has signoff and risk acceptance in the EDSP, this is not a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-TransportServer -Identity <'ServerUnderReview'> -TransientFailureRetryCount 10 or other value as identified by the EDSP.\"\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41691r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-33586'\n  tag rid: 'SV-44006r1_rule'\n  tag stig_id: 'Exch-2-754'\n  tag gtitle: 'Exch-2-754'\n  tag fix_id: 'F-37476r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44006.rb"},"title":"Send Connectors delivery retries must be controlled.","desc":"This setting controls the rate at which delivery attempts from the home domain are retried, user notifications are issued, and notes the expiration time when the message will be discarded.  \n\nIf delivery retry attempts are too frequent, servers will generate network congestion. If too far apart, then messages may remain queued longer than necessary, potentially raising disk resource requirements.    \n\nThe default values of these fields should be adequate for most environments.  Administrators may wish to modify the values as a result, but changes should be documented in the System Security Plan.\n\nNOTE: Transport configuration settings apply to the organization/global level of the Exchange SMTP path.  By checking and setting them at the Hub server the setting will apply to both Hub and Edge roles.","descriptions":{"default":"This setting controls the rate at which delivery attempts from the home domain are retried, user notifications are issued, and notes the expiration time when the message will be discarded.  \n\nIf delivery retry attempts are too frequent, servers will generate network congestion. If too far apart, then messages may remain queued longer than necessary, potentially raising disk resource requirements.    \n\nThe default values of these fields should be adequate for most environments.  Administrators may wish to modify the values as a result, but changes should be documented in the System Security Plan.\n\nNOTE: Transport configuration settings apply to the organization/global level of the Exchange SMTP path.  By checking and setting them at the Hub server the setting will apply to both Hub and Edge roles.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the value for 'Transient Failure Retry Count'.\n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-TransportServer -Identity <'ServerUnderReview'> | Select Name, Identity, TransientFailureRetryCount\n\nIf the value of 'TransientFailureRetryCount' is set to 10 or less, this is not a finding.\n\nIf the value of 'TransientFailureRetryCount' is set to more than 10, and has signoff and risk acceptance in the EDSP, this is not a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-TransportServer -Identity <'ServerUnderReview'> -TransientFailureRetryCount 10 or other value as identified by the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41691r1_chk","severity":"low","gid":"V-33586","rid":"SV-44006r1_rule","stig_id":"Exch-2-754","gtitle":"Exch-2-754","fix_id":"F-37476r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44007","code":"control 'SV-44007' do\n  title 'Message size restrictions must be controlled on Send connectors.'\n  desc 'Email system availability depends in part on best practices strategies for setting tuning configurations. For message size restrictions, multiple places exist to set or override inbound or outbound message size. Failure to control the configuration strategy can result in loss of data or system availability. \n\nThis setting enables the administrator to control the maximum message size on a send connector. Using connectors to control size limits may necessitate the need to apply message size limitations in multiple places, with the potential of introducing conflicts and impediments in the mail flow. Changing this setting at the connector overrides the global one. Therefore, if operational needs require it, the connector value may be set lower than that of the global value with the rationale and documented in the EDSP.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the global maximum message send size and if signoff with risk acceptance is documented for the receive connector to have a different value.\n\nOpen the Exchange Management Shell and enter the following command:\nGet-SendConnector | Select Identity, MaxMessageSize\n\nor \n\nGet-TransportConfig | Select Identity, MaxSendSize\n\nIf 'MaxMessageSize' is set to a numeric value different from the global value, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of ‘MaxMessageSize' is not the same as the global value, this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector -Identity <'SendConnector'> -MaxMessageSize <MaxSendSize>\n\nIf an alternate value is desired from the global value MaxSendSize, obtain signoff with risk acceptance and document in the EDSP.\"\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41694r5_chk'\n  tag severity: 'low'\n  tag gid: 'V-33587'\n  tag rid: 'SV-44007r3_rule'\n  tag stig_id: 'Exch-2-757'\n  tag gtitle: 'Exch-2-757'\n  tag fix_id: 'F-37478r3_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44007.rb"},"title":"Message size restrictions must be controlled on Send connectors.","desc":"Email system availability depends in part on best practices strategies for setting tuning configurations. For message size restrictions, multiple places exist to set or override inbound or outbound message size. Failure to control the configuration strategy can result in loss of data or system availability. \n\nThis setting enables the administrator to control the maximum message size on a send connector. Using connectors to control size limits may necessitate the need to apply message size limitations in multiple places, with the potential of introducing conflicts and impediments in the mail flow. Changing this setting at the connector overrides the global one. Therefore, if operational needs require it, the connector value may be set lower than that of the global value with the rationale and documented in the EDSP.","descriptions":{"default":"Email system availability depends in part on best practices strategies for setting tuning configurations. For message size restrictions, multiple places exist to set or override inbound or outbound message size. Failure to control the configuration strategy can result in loss of data or system availability. \n\nThis setting enables the administrator to control the maximum message size on a send connector. Using connectors to control size limits may necessitate the need to apply message size limitations in multiple places, with the potential of introducing conflicts and impediments in the mail flow. Changing this setting at the connector overrides the global one. Therefore, if operational needs require it, the connector value may be set lower than that of the global value with the rationale and documented in the EDSP.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the global maximum message send size and if signoff with risk acceptance is documented for the receive connector to have a different value.\n\nOpen the Exchange Management Shell and enter the following command:\nGet-SendConnector | Select Identity, MaxMessageSize\n\nor \n\nGet-TransportConfig | Select Identity, MaxSendSize\n\nIf 'MaxMessageSize' is set to a numeric value different from the global value, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of ‘MaxMessageSize' is not the same as the global value, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector -Identity <'SendConnector'> -MaxMessageSize <MaxSendSize>\n\nIf an alternate value is desired from the global value MaxSendSize, obtain signoff with risk acceptance and document in the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41694r5_chk","severity":"low","gid":"V-33587","rid":"SV-44007r3_rule","stig_id":"Exch-2-757","gtitle":"Exch-2-757","fix_id":"F-37478r3_fix","documentable":null}},{"id":"SV-44009","code":"control 'SV-44009' do\n  title 'Send Connector connections count must be limited.'\n  desc 'This setting controls the maximum number of simultaneous outbound connections allowed for a given SMTP Connector, and can be used to throttle the SMTP service if resource constraints warrant it.  If the limit is too low, connections may be dropped.  If too high, some domains may use a disproportionate resource share, denying access to other domains.   Appropriate tuning reduces risk of data delay or loss.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the value for 'SMTP Server Maximum Outbound Connections'.\n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-TransportServer -Identity <'ServerUnderReview'> | Select Name, Identity, MaxOutboundConnections\n\nIf the value of 'MaxOutboundConnections' is set to 1000 this is not a finding.\n\nIf the value of 'MaxOutboundConnections' is set to a value other than 1000 and has signoff and risk acceptance in the EDSP, this is not a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-TransportServer -Identity <'ServerUnderReview'> -MaxOutboundConnections 1000.  \n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP.\"\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41695r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-33589'\n  tag rid: 'SV-44009r1_rule'\n  tag stig_id: 'Exch-2-760'\n  tag gtitle: 'Exch-2-760'\n  tag fix_id: 'F-37480r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44009.rb"},"title":"Send Connector connections count must be limited.","desc":"This setting controls the maximum number of simultaneous outbound connections allowed for a given SMTP Connector, and can be used to throttle the SMTP service if resource constraints warrant it.  If the limit is too low, connections may be dropped.  If too high, some domains may use a disproportionate resource share, denying access to other domains.   Appropriate tuning reduces risk of data delay or loss.","descriptions":{"default":"This setting controls the maximum number of simultaneous outbound connections allowed for a given SMTP Connector, and can be used to throttle the SMTP service if resource constraints warrant it.  If the limit is too low, connections may be dropped.  If too high, some domains may use a disproportionate resource share, denying access to other domains.   Appropriate tuning reduces risk of data delay or loss.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the value for 'SMTP Server Maximum Outbound Connections'.\n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-TransportServer -Identity <'ServerUnderReview'> | Select Name, Identity, MaxOutboundConnections\n\nIf the value of 'MaxOutboundConnections' is set to 1000 this is not a finding.\n\nIf the value of 'MaxOutboundConnections' is set to a value other than 1000 and has signoff and risk acceptance in the EDSP, this is not a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-TransportServer -Identity <'ServerUnderReview'> -MaxOutboundConnections 1000.  \n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41695r1_chk","severity":"low","gid":"V-33589","rid":"SV-44009r1_rule","stig_id":"Exch-2-760","gtitle":"Exch-2-760","fix_id":"F-37480r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44010","code":"control 'SV-44010' do\n  title 'Internal Send Connectors must use Domain Security (Mutual Authentication TLS).'\n  desc 'The Simple Mail Transfer Protocol (SMTP) connector is used by Exchange to send and receive messages from server to server. There are several controls that work together to provide security between internal servers. This setting controls the authentication method used for communications between servers.  With this feature enabled, only servers capable of supporting domain authentication will be able to send and receive mail within the domain.\n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers.    While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from server to server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender.  \n\nIndividually, channel security and encryption can be compromised by attackers.  Used together, email becomes a more difficult target, and security is heightened.  Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between servers.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select  Name, Identity, DomainSecureEnabled\n\nIf the value of 'DomainSecureEnabled' is not set  to 'True', this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector <'InternalSendConnector'> -DomainSecureEnabled $true\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41697r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33590'\n  tag rid: 'SV-44010r1_rule'\n  tag stig_id: 'Exch-2-763'\n  tag gtitle: 'Exch-2-763'\n  tag fix_id: 'F-37482r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44010.rb"},"title":"Internal Send Connectors must use Domain Security (Mutual Authentication TLS).","desc":"The Simple Mail Transfer Protocol (SMTP) connector is used by Exchange to send and receive messages from server to server. There are several controls that work together to provide security between internal servers. This setting controls the authentication method used for communications between servers.  With this feature enabled, only servers capable of supporting domain authentication will be able to send and receive mail within the domain.\n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers.    While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from server to server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender.  \n\nIndividually, channel security and encryption can be compromised by attackers.  Used together, email becomes a more difficult target, and security is heightened.  Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between servers.","descriptions":{"default":"The Simple Mail Transfer Protocol (SMTP) connector is used by Exchange to send and receive messages from server to server. There are several controls that work together to provide security between internal servers. This setting controls the authentication method used for communications between servers.  With this feature enabled, only servers capable of supporting domain authentication will be able to send and receive mail within the domain.\n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers.    While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from server to server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender.  \n\nIndividually, channel security and encryption can be compromised by attackers.  Used together, email becomes a more difficult target, and security is heightened.  Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between servers.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select  Name, Identity, DomainSecureEnabled\n\nIf the value of 'DomainSecureEnabled' is not set  to 'True', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector <'InternalSendConnector'> -DomainSecureEnabled $true"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41697r1_chk","severity":"medium","gid":"V-33590","rid":"SV-44010r1_rule","stig_id":"Exch-2-763","gtitle":"Exch-2-763","fix_id":"F-37482r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44012","code":"control 'SV-44012' do\n  title 'Internal Send Connectors must require encryption.'\n  desc 'The Simple Mail Transfer Protocol (SMTP) connector is used by Exchange to send and receive messages from server to server. There are several controls that work together to provide security between internal servers. This setting controls the encryption method used for communications between servers.  With this feature  enabled, only servers capable of supporting Transport Layer Security (TLS) will be able to send and receive mail within the domain.\n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers.  While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from server to server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender.  \n\nIndividually, channel security and encryption can be compromised by attackers.  Used together, email becomes a more difficult target, and security is heightened.  Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between servers.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select Name, Identity, TlsDomain\n\nIf the value of 'TlsDomain' is not set to the value of the internal <'SMTP Domain'>, this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector -Identity <'SendConnector'> -TlsDomain <'SMTP Domain'>\n\n<'SMTP Domain'> \n\nNote: 'SMTP Domain' is the internal SMTP domain within the organization.\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41699r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33592'\n  tag rid: 'SV-44012r3_rule'\n  tag stig_id: 'Exch-2-766'\n  tag gtitle: 'Exch-2-766'\n  tag fix_id: 'F-37484r4_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44012.rb"},"title":"Internal Send Connectors must require encryption.","desc":"The Simple Mail Transfer Protocol (SMTP) connector is used by Exchange to send and receive messages from server to server. There are several controls that work together to provide security between internal servers. This setting controls the encryption method used for communications between servers.  With this feature  enabled, only servers capable of supporting Transport Layer Security (TLS) will be able to send and receive mail within the domain.\n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers.  While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from server to server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender.  \n\nIndividually, channel security and encryption can be compromised by attackers.  Used together, email becomes a more difficult target, and security is heightened.  Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between servers.","descriptions":{"default":"The Simple Mail Transfer Protocol (SMTP) connector is used by Exchange to send and receive messages from server to server. There are several controls that work together to provide security between internal servers. This setting controls the encryption method used for communications between servers.  With this feature  enabled, only servers capable of supporting Transport Layer Security (TLS) will be able to send and receive mail within the domain.\n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers.  While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from server to server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender.  \n\nIndividually, channel security and encryption can be compromised by attackers.  Used together, email becomes a more difficult target, and security is heightened.  Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between servers.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select Name, Identity, TlsDomain\n\nIf the value of 'TlsDomain' is not set to the value of the internal <'SMTP Domain'>, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector -Identity <'SendConnector'> -TlsDomain <'SMTP Domain'>\n\n<'SMTP Domain'> \n\nNote: 'SMTP Domain' is the internal SMTP domain within the organization."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41699r4_chk","severity":"medium","gid":"V-33592","rid":"SV-44012r3_rule","stig_id":"Exch-2-766","gtitle":"Exch-2-766","fix_id":"F-37484r4_fix","documentable":null}},{"id":"SV-44014","code":"control 'SV-44014' do\n  title 'Internet facing send Connectors must specify a Smart Host.'\n  desc \"In the case of identifying a 'Smart Host' for the email environment, a logical send connector is the preferred method.\n \nA 'Smart Host' acts as an Internet Facing Concentrator for other email servers. Appropriate hardening can be applied to the Smart Host rather than at multiple locations throughout the enterprise.\n \nFailure to identify a 'Smart Host' could default to each email server performing its own lookups (potentially through protective firewalls). Exchange servers should not be Internet facing, and should therefore not perform any 'Smart Host' functions. When the Exchange servers are Internet facing they must, however, be configured to identify the Internet facing server that is performing the 'Smart Host' function.\"\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select Name, Identity, SmartHosts\n\nIdentify the Internet facing connectors. \n\nIf the value of 'SmartHosts' does not return the Smart Host IP Address, this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector <'SendConnector'> -SmartHosts <'IP Address of Smart Host'> -DNSRoutingEnabled $false\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41701r4_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33594'\n  tag rid: 'SV-44014r2_rule'\n  tag stig_id: 'Exch-2-771'\n  tag gtitle: 'Exch-2-771'\n  tag fix_id: 'F-37486r1_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44014.rb"},"title":"Internet facing send Connectors must specify a Smart Host.","desc":"In the case of identifying a 'Smart Host' for the email environment, a logical send connector is the preferred method.\n \nA 'Smart Host' acts as an Internet Facing Concentrator for other email servers. Appropriate hardening can be applied to the Smart Host rather than at multiple locations throughout the enterprise.\n \nFailure to identify a 'Smart Host' could default to each email server performing its own lookups (potentially through protective firewalls). Exchange servers should not be Internet facing, and should therefore not perform any 'Smart Host' functions. When the Exchange servers are Internet facing they must, however, be configured to identify the Internet facing server that is performing the 'Smart Host' function.","descriptions":{"default":"In the case of identifying a 'Smart Host' for the email environment, a logical send connector is the preferred method.\n \nA 'Smart Host' acts as an Internet Facing Concentrator for other email servers. Appropriate hardening can be applied to the Smart Host rather than at multiple locations throughout the enterprise.\n \nFailure to identify a 'Smart Host' could default to each email server performing its own lookups (potentially through protective firewalls). Exchange servers should not be Internet facing, and should therefore not perform any 'Smart Host' functions. When the Exchange servers are Internet facing they must, however, be configured to identify the Internet facing server that is performing the 'Smart Host' function.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select Name, Identity, SmartHosts\n\nIdentify the Internet facing connectors. \n\nIf the value of 'SmartHosts' does not return the Smart Host IP Address, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector <'SendConnector'> -SmartHosts <'IP Address of Smart Host'> -DNSRoutingEnabled $false"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41701r4_chk","severity":"medium","gid":"V-33594","rid":"SV-44014r2_rule","stig_id":"Exch-2-771","gtitle":"Exch-2-771","fix_id":"F-37486r1_fix","documentable":null}},{"id":"SV-44016","code":"control 'SV-44016' do\n  title 'Connectivity logging must be enabled.'\n  desc 'A connectivity log is a record of the SMTP connection activity of the outbound message delivery queues to the destination Mailbox server, smart host, or domain. Connectivity logging is available on Hub Transport servers and Edge Transport servers. By default, connectivity logging is disabled. If events are not recorded it may be difficult or impossible to determine the root cause of system problems or the unauthorized activities of malicious users.\n\nNOTE: Transport configuration settings apply to the organization/global level of the Exchange SMTP path.  By checking and setting them at the Hub server the setting will apply to both Hub and Edge roles.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-TransportServer -Identity <'ServerUnderReview'>  | Select Name, Identity, ConnectivityLogEnabled\n\nIf the value of 'ConnectivityLogEnabled' is not set to 'True', this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\n Set-TransportServer -Identity <'ServerUnderReview'> -ConnectivityLogEnabled $true\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41703r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33596'\n  tag rid: 'SV-44016r1_rule'\n  tag stig_id: 'Exch-2-801'\n  tag gtitle: 'Exch-2-801'\n  tag fix_id: 'F-37488r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44016.rb"},"title":"Connectivity logging must be enabled.","desc":"A connectivity log is a record of the SMTP connection activity of the outbound message delivery queues to the destination Mailbox server, smart host, or domain. Connectivity logging is available on Hub Transport servers and Edge Transport servers. By default, connectivity logging is disabled. If events are not recorded it may be difficult or impossible to determine the root cause of system problems or the unauthorized activities of malicious users.\n\nNOTE: Transport configuration settings apply to the organization/global level of the Exchange SMTP path.  By checking and setting them at the Hub server the setting will apply to both Hub and Edge roles.","descriptions":{"default":"A connectivity log is a record of the SMTP connection activity of the outbound message delivery queues to the destination Mailbox server, smart host, or domain. Connectivity logging is available on Hub Transport servers and Edge Transport servers. By default, connectivity logging is disabled. If events are not recorded it may be difficult or impossible to determine the root cause of system problems or the unauthorized activities of malicious users.\n\nNOTE: Transport configuration settings apply to the organization/global level of the Exchange SMTP path.  By checking and setting them at the Hub server the setting will apply to both Hub and Edge roles.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-TransportServer -Identity <'ServerUnderReview'>  | Select Name, Identity, ConnectivityLogEnabled\n\nIf the value of 'ConnectivityLogEnabled' is not set to 'True', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\n Set-TransportServer -Identity <'ServerUnderReview'> -ConnectivityLogEnabled $true"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41703r1_chk","severity":"medium","gid":"V-33596","rid":"SV-44016r1_rule","stig_id":"Exch-2-801","gtitle":"Exch-2-801","fix_id":"F-37488r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44018","code":"control 'SV-44018' do\n  title 'Exchange must not send delivery reports to remote domains.'\n  desc 'Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Ensure that delivery reports to remote domains are disabled. Before enabling this setting first configure a remote domain using the EMC or the New-RemoteDomain cmdlet.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n \nGet-RemoteDomain | select identity, DeliveryReportEnabled\n\nIf the value of 'DeliveryReportEnabled' is not set to 'False', this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-RemoteDomain -Identity <'RemoteDomainName'> -DeliveryReportEnabled $false\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41705r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33598'\n  tag rid: 'SV-44018r1_rule'\n  tag stig_id: 'Exch-2-805'\n  tag gtitle: 'Exch-2-805'\n  tag fix_id: 'F-37490r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44018.rb"},"title":"Exchange must not send delivery reports to remote domains.","desc":"Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Ensure that delivery reports to remote domains are disabled. Before enabling this setting first configure a remote domain using the EMC or the New-RemoteDomain cmdlet.","descriptions":{"default":"Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Ensure that delivery reports to remote domains are disabled. Before enabling this setting first configure a remote domain using the EMC or the New-RemoteDomain cmdlet.","check":"Open the Exchange Management Shell and enter the following command:\n \nGet-RemoteDomain | select identity, DeliveryReportEnabled\n\nIf the value of 'DeliveryReportEnabled' is not set to 'False', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-RemoteDomain -Identity <'RemoteDomainName'> -DeliveryReportEnabled $false"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41705r1_chk","severity":"medium","gid":"V-33598","rid":"SV-44018r1_rule","stig_id":"Exch-2-805","gtitle":"Exch-2-805","fix_id":"F-37490r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44019","code":"control 'SV-44019' do\n  title 'Exchange must not send non-delivery reports to remote domains.'\n  desc 'Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Ensure that non-delivery reports to remote domains are disabled. Before enabling this setting first configure a remote domain using the EMC or the New-RemoteDomain cmdlet.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-RemoteDomain | select identity, NDREnabled\n\nIf the value of 'NDREnabled' is not set to 'False', this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-RemoteDomain -Identity <'RemoteDomainName'> -NDREnabled $false\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41706r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33599'\n  tag rid: 'SV-44019r1_rule'\n  tag stig_id: 'Exch-2-808'\n  tag gtitle: 'Exch-2-808'\n  tag fix_id: 'F-37491r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44019.rb"},"title":"Exchange must not send non-delivery reports to remote domains.","desc":"Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Ensure that non-delivery reports to remote domains are disabled. Before enabling this setting first configure a remote domain using the EMC or the New-RemoteDomain cmdlet.","descriptions":{"default":"Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Ensure that non-delivery reports to remote domains are disabled. Before enabling this setting first configure a remote domain using the EMC or the New-RemoteDomain cmdlet.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-RemoteDomain | select identity, NDREnabled\n\nIf the value of 'NDREnabled' is not set to 'False', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-RemoteDomain -Identity <'RemoteDomainName'> -NDREnabled $false"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41706r2_chk","severity":"medium","gid":"V-33599","rid":"SV-44019r1_rule","stig_id":"Exch-2-808","gtitle":"Exch-2-808","fix_id":"F-37491r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44021","code":"control 'SV-44021' do\n  title 'External/Internet bound automated response messages must be disabled.'\n  desc \"SPAM originators, in an effort to refine mailing lists, sometimes use a technique where they monitor transmissions for automated bounce back messages, such as 'Out of Office' messages.  Automated messages include such items as Out of Office responses, non-delivery messages, or automated message forwarding.\n\nAutomated bounce back messages can be used by a third party to determine if users exist on the server. This can result in the disclosure of active user accounts to third parties, paving the way for possible future attacks.\"\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-RemoteDomain -Identity 'default' | Select Name, Identity, AllowedOOFType\n\nIf the value of 'AllowedOOFType' is set to 'External' or 'ExternalLegacy', this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-RemoteDomain -AllowedOOFType 'InternalLegacy' -Identity 'default'\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41708r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33601'\n  tag rid: 'SV-44021r1_rule'\n  tag stig_id: 'Exch-2-811'\n  tag gtitle: 'Exch-2-811'\n  tag fix_id: 'F-37493r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44021.rb"},"title":"External/Internet bound automated response messages must be disabled.","desc":"SPAM originators, in an effort to refine mailing lists, sometimes use a technique where they monitor transmissions for automated bounce back messages, such as 'Out of Office' messages.  Automated messages include such items as Out of Office responses, non-delivery messages, or automated message forwarding.\n\nAutomated bounce back messages can be used by a third party to determine if users exist on the server. This can result in the disclosure of active user accounts to third parties, paving the way for possible future attacks.","descriptions":{"default":"SPAM originators, in an effort to refine mailing lists, sometimes use a technique where they monitor transmissions for automated bounce back messages, such as 'Out of Office' messages.  Automated messages include such items as Out of Office responses, non-delivery messages, or automated message forwarding.\n\nAutomated bounce back messages can be used by a third party to determine if users exist on the server. This can result in the disclosure of active user accounts to third parties, paving the way for possible future attacks.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-RemoteDomain -Identity 'default' | Select Name, Identity, AllowedOOFType\n\nIf the value of 'AllowedOOFType' is set to 'External' or 'ExternalLegacy', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-RemoteDomain -AllowedOOFType 'InternalLegacy' -Identity 'default'"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41708r1_chk","severity":"medium","gid":"V-33601","rid":"SV-44021r1_rule","stig_id":"Exch-2-811","gtitle":"Exch-2-811","fix_id":"F-37493r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44023","code":"control 'SV-44023' do\n  title 'Exchange must not send auto replies to remote domains.'\n  desc \"Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Remote users will not receive automated 'Out Of Office' delivery reports. This setting can be used to determine if all the servers in the Organization can send 'Out of Office' messages.\"\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-RemoteDomain | select identity, AutoReplyEnabled\n\nIf the value of 'AutoReplyEnabled' is not set to 'False', this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-RemoteDomain -Identity <'RemoteDomainName'> -AutoReplyEnabled $false\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41711r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33603'\n  tag rid: 'SV-44023r1_rule'\n  tag stig_id: 'Exch-2-814'\n  tag gtitle: 'Exch-2-814'\n  tag fix_id: 'F-37496r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44023.rb"},"title":"Exchange must not send auto replies to remote domains.","desc":"Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Remote users will not receive automated 'Out Of Office' delivery reports. This setting can be used to determine if all the servers in the Organization can send 'Out of Office' messages.","descriptions":{"default":"Attackers can use automated messages to determine whether a user account is active, in the office, traveling, and so on. An attacker might use this information to conduct future attacks. Remote users will not receive automated 'Out Of Office' delivery reports. This setting can be used to determine if all the servers in the Organization can send 'Out of Office' messages.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-RemoteDomain | select identity, AutoReplyEnabled\n\nIf the value of 'AutoReplyEnabled' is not set to 'False', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-RemoteDomain -Identity <'RemoteDomainName'> -AutoReplyEnabled $false"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41711r2_chk","severity":"medium","gid":"V-33603","rid":"SV-44023r1_rule","stig_id":"Exch-2-814","gtitle":"Exch-2-814","fix_id":"F-37496r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44026","code":"control 'SV-44026' do\n  title 'Email Diagnostic log level must be set to low or lowest level.'\n  desc 'Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability. Diagnostic logging, however, characteristically produces large volumes of data and requires care in managing the logs to prevent risk of disk capacity denial of service conditions. \nExchange diagnostic logging is broken up into 29 main “services”, each of which has anywhere from 2 to 26 “categories” of events to be monitored. Moreover, each category may be set to one of four levels of logging: Lowest, Low, Medium, and High, depending on how much detail one desires. The higher the level of detail, the more disk space required to store the audit material.\nDiagnostic logging is intended to help administrators debug problems with their systems, not as a general purpose auditing tool. Because the diagnostic logs collect a great deal of information, the log files may grow huge very quickly. Diagnostic log levels may be raised for limited periods of time when attempting to debug relevant pieces of Exchange functionality. Once debugging has finished, diagnostic log levels should be reduced again.'\n  desc 'check', 'Open the Exchange Management Shell and enter the following command:\n\nGet-EventLogLevel\n\nIf any Diagnostic “EventLevel” is not set to “Low” or “Lowest”, this is a finding.'\n  desc 'fix', 'Open the Exchange Management Shell and enter the following command:\n\nSet-EventLogLevel -Identity <ServiceName\\\\Name> -Level Lowest \n  \nor\n\nSet-EventLogLevel -Identity <ServiceName\\\\Name> -Level Low'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41713r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33606'\n  tag rid: 'SV-44026r2_rule'\n  tag stig_id: 'Exch-2-817'\n  tag gtitle: 'Exch-2-817'\n  tag fix_id: 'F-37498r3_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44026.rb"},"title":"Email Diagnostic log level must be set to low or lowest level.","desc":"Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability. Diagnostic logging, however, characteristically produces large volumes of data and requires care in managing the logs to prevent risk of disk capacity denial of service conditions. \nExchange diagnostic logging is broken up into 29 main “services”, each of which has anywhere from 2 to 26 “categories” of events to be monitored. Moreover, each category may be set to one of four levels of logging: Lowest, Low, Medium, and High, depending on how much detail one desires. The higher the level of detail, the more disk space required to store the audit material.\nDiagnostic logging is intended to help administrators debug problems with their systems, not as a general purpose auditing tool. Because the diagnostic logs collect a great deal of information, the log files may grow huge very quickly. Diagnostic log levels may be raised for limited periods of time when attempting to debug relevant pieces of Exchange functionality. Once debugging has finished, diagnostic log levels should be reduced again.","descriptions":{"default":"Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability. Diagnostic logging, however, characteristically produces large volumes of data and requires care in managing the logs to prevent risk of disk capacity denial of service conditions. \nExchange diagnostic logging is broken up into 29 main “services”, each of which has anywhere from 2 to 26 “categories” of events to be monitored. Moreover, each category may be set to one of four levels of logging: Lowest, Low, Medium, and High, depending on how much detail one desires. The higher the level of detail, the more disk space required to store the audit material.\nDiagnostic logging is intended to help administrators debug problems with their systems, not as a general purpose auditing tool. Because the diagnostic logs collect a great deal of information, the log files may grow huge very quickly. Diagnostic log levels may be raised for limited periods of time when attempting to debug relevant pieces of Exchange functionality. Once debugging has finished, diagnostic log levels should be reduced again.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-EventLogLevel\n\nIf any Diagnostic “EventLevel” is not set to “Low” or “Lowest”, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-EventLogLevel -Identity <ServiceName\\Name> -Level Lowest \n  \nor\n\nSet-EventLogLevel -Identity <ServiceName\\Name> -Level Low"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41713r3_chk","severity":"medium","gid":"V-33606","rid":"SV-44026r2_rule","stig_id":"Exch-2-817","gtitle":"Exch-2-817","fix_id":"F-37498r3_fix","documentable":null}},{"id":"SV-44028","code":"control 'SV-44028' do\n  title 'The Send Fatal Errors to Microsoft must be disabled.'\n  desc \"Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability.   This setting enables an automated log entry to be sent to Microsoft giving general details about the nature and location of the error.   Microsoft, in turn, uses this information to improve the robustness of their product.\n\nWhile this type of debugging information would not ordinarily contain sensitive information, it may alert eavesdroppers to the existence of problems in your Exchange organization. At the very least, it could alert them to (possibly) advantageous timing to mount an attack.  At worst, it may provide them with information as to which aspects of Exchange are causing problems and might be vulnerable (or at least sensitive) to attack.   \n\nAll system errors in Exchange will result in outbound traffic that may be identified by an eavesdropper.  For this reason, the 'Report Fatal Errors to Microsoft' feature must be disabled.\"\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-ExchangeServer –status | Select Name, Identity, ErrorReportingEnabled\n\nIf the value of 'ErrorReportingEnabled' is not set to 'False', this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-ExchangeServer -Identity <'ServerName'>  -ErrorReportingEnabled $false\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41715r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33608'\n  tag rid: 'SV-44028r2_rule'\n  tag stig_id: 'Exch-2-820'\n  tag gtitle: 'Exch-2-820'\n  tag fix_id: 'F-37500r1_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44028.rb"},"title":"The Send Fatal Errors to Microsoft must be disabled.","desc":"Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability.   This setting enables an automated log entry to be sent to Microsoft giving general details about the nature and location of the error.   Microsoft, in turn, uses this information to improve the robustness of their product.\n\nWhile this type of debugging information would not ordinarily contain sensitive information, it may alert eavesdroppers to the existence of problems in your Exchange organization. At the very least, it could alert them to (possibly) advantageous timing to mount an attack.  At worst, it may provide them with information as to which aspects of Exchange are causing problems and might be vulnerable (or at least sensitive) to attack.   \n\nAll system errors in Exchange will result in outbound traffic that may be identified by an eavesdropper.  For this reason, the 'Report Fatal Errors to Microsoft' feature must be disabled.","descriptions":{"default":"Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability.   This setting enables an automated log entry to be sent to Microsoft giving general details about the nature and location of the error.   Microsoft, in turn, uses this information to improve the robustness of their product.\n\nWhile this type of debugging information would not ordinarily contain sensitive information, it may alert eavesdroppers to the existence of problems in your Exchange organization. At the very least, it could alert them to (possibly) advantageous timing to mount an attack.  At worst, it may provide them with information as to which aspects of Exchange are causing problems and might be vulnerable (or at least sensitive) to attack.   \n\nAll system errors in Exchange will result in outbound traffic that may be identified by an eavesdropper.  For this reason, the 'Report Fatal Errors to Microsoft' feature must be disabled.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-ExchangeServer –status | Select Name, Identity, ErrorReportingEnabled\n\nIf the value of 'ErrorReportingEnabled' is not set to 'False', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-ExchangeServer -Identity <'ServerName'>  -ErrorReportingEnabled $false"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41715r3_chk","severity":"medium","gid":"V-33608","rid":"SV-44028r2_rule","stig_id":"Exch-2-820","gtitle":"Exch-2-820","fix_id":"F-37500r1_fix","documentable":null}},{"id":"SV-44029","code":"control 'SV-44029' do\n  title 'Administrator audit logging must be enabled.'\n  desc \"Unauthorized or malicious data changes can compromise the integrity and usefulness of the data.  Automated attacks or malicious users with elevated privileges have the ability to affect change using the same mechanisms as email administrators.  \n\nAuditing changes to access mechanisms not only supports accountability and non-repudiation for those authorized to define the environment but also enables investigation of changes made by others who may not be authorized.   \n\nNote: This administrator auditing feature audits all exchange changes regardless of the users' assigned role or permissions.\"\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-AdminAuditLogConfig | Select AdminAuditLogEnabled\n\nIf the value of 'AdminAuditLogEnabled' is not set to 'True', this is a finding.\"\n  desc 'fix', 'Open the Exchange Management Shell and enter the following command:\n\nSet-AdminAuditLogConfig  -AdminAuditLogEnabled $true'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41716r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33609'\n  tag rid: 'SV-44029r2_rule'\n  tag stig_id: 'Exch-2-823'\n  tag gtitle: 'Exch-2-823'\n  tag fix_id: 'F-37501r1_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44029.rb"},"title":"Administrator audit logging must be enabled.","desc":"Unauthorized or malicious data changes can compromise the integrity and usefulness of the data.  Automated attacks or malicious users with elevated privileges have the ability to affect change using the same mechanisms as email administrators.  \n\nAuditing changes to access mechanisms not only supports accountability and non-repudiation for those authorized to define the environment but also enables investigation of changes made by others who may not be authorized.   \n\nNote: This administrator auditing feature audits all exchange changes regardless of the users' assigned role or permissions.","descriptions":{"default":"Unauthorized or malicious data changes can compromise the integrity and usefulness of the data.  Automated attacks or malicious users with elevated privileges have the ability to affect change using the same mechanisms as email administrators.  \n\nAuditing changes to access mechanisms not only supports accountability and non-repudiation for those authorized to define the environment but also enables investigation of changes made by others who may not be authorized.   \n\nNote: This administrator auditing feature audits all exchange changes regardless of the users' assigned role or permissions.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-AdminAuditLogConfig | Select AdminAuditLogEnabled\n\nIf the value of 'AdminAuditLogEnabled' is not set to 'True', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-AdminAuditLogConfig  -AdminAuditLogEnabled $true"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41716r1_chk","severity":"medium","gid":"V-33609","rid":"SV-44029r2_rule","stig_id":"Exch-2-823","gtitle":"Exch-2-823","fix_id":"F-37501r1_fix","documentable":null}},{"id":"SV-44031","code":"control 'SV-44031' do\n  title 'Audit data must be protected against unauthorized access.'\n  desc 'Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability.   Audit log content must always be considered sensitive, and in need of protection.  Audit data available for modification by a malicious user can be altered to conceal malicious activity.  Audit data might also provide a means for the malicious user to plan unauthorized activities that exploit weaknesses.\n  \nThe contents of audit logs are protected against unauthorized access, modification, or deletion. Only authorized auditors and the audit functions should be granted Read and Write access to audit log data.'\n  desc 'check', 'Obtain the Email Domain Security Plan (EDSP)  and locate the authorized groups or users that should have access to the audit data.\n\nIf any group or user has access to the audit data that is not documented in the EDSP, this is a finding.'\n  desc 'fix', 'Restrict any unauthorized groups or users from accessing the audit logs.'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41718r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33611'\n  tag rid: 'SV-44031r1_rule'\n  tag stig_id: 'Exch-2-826'\n  tag gtitle: 'Exch-2-826'\n  tag fix_id: 'F-37503r3_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44031.rb"},"title":"Audit data must be protected against unauthorized access.","desc":"Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability.   Audit log content must always be considered sensitive, and in need of protection.  Audit data available for modification by a malicious user can be altered to conceal malicious activity.  Audit data might also provide a means for the malicious user to plan unauthorized activities that exploit weaknesses.\n  \nThe contents of audit logs are protected against unauthorized access, modification, or deletion. Only authorized auditors and the audit functions should be granted Read and Write access to audit log data.","descriptions":{"default":"Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability.   Audit log content must always be considered sensitive, and in need of protection.  Audit data available for modification by a malicious user can be altered to conceal malicious activity.  Audit data might also provide a means for the malicious user to plan unauthorized activities that exploit weaknesses.\n  \nThe contents of audit logs are protected against unauthorized access, modification, or deletion. Only authorized auditors and the audit functions should be granted Read and Write access to audit log data.","check":"Obtain the Email Domain Security Plan (EDSP)  and locate the authorized groups or users that should have access to the audit data.\n\nIf any group or user has access to the audit data that is not documented in the EDSP, this is a finding.","fix":"Restrict any unauthorized groups or users from accessing the audit logs."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41718r1_chk","severity":"medium","gid":"V-33611","rid":"SV-44031r1_rule","stig_id":"Exch-2-826","gtitle":"Exch-2-826","fix_id":"F-37503r3_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44033","code":"control 'SV-44033' do\n  title 'Exchange application directory must be protected from unauthorized access.'\n  desc 'Default product installations may provide more generous access permissions than are necessary to run the application.  By examining and tailoring access permissions to more closely provide the least amount of privilege possible, attack vectors that align with user permissions are less likely to access more highly secured areas.'\n  desc 'check', 'Obtain the Email Domain Security Plan (EDSP) and locate the authorized groups and users that have access to the Exchange application directories.\n\nVerify the access permissions on the directory match the access permissions listed in the EDSP. If any group or user has different access permissions, this is a finding. \n\nNote: The default installation directory is \\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V14.'\n  desc 'fix', 'Locate the Exchange application directory and Remove or modify the group or user access permissions. \n\nNote: The default installation directory is \\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V14.'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41720r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33613'\n  tag rid: 'SV-44033r1_rule'\n  tag stig_id: 'Exch-2-828'\n  tag gtitle: 'Exch-2-828'\n  tag fix_id: 'F-37505r2_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44033.rb"},"title":"Exchange application directory must be protected from unauthorized access.","desc":"Default product installations may provide more generous access permissions than are necessary to run the application.  By examining and tailoring access permissions to more closely provide the least amount of privilege possible, attack vectors that align with user permissions are less likely to access more highly secured areas.","descriptions":{"default":"Default product installations may provide more generous access permissions than are necessary to run the application.  By examining and tailoring access permissions to more closely provide the least amount of privilege possible, attack vectors that align with user permissions are less likely to access more highly secured areas.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the authorized groups and users that have access to the Exchange application directories.\n\nVerify the access permissions on the directory match the access permissions listed in the EDSP. If any group or user has different access permissions, this is a finding. \n\nNote: The default installation directory is \\Program Files\\Microsoft\\Exchange Server\\V14.","fix":"Locate the Exchange application directory and Remove or modify the group or user access permissions. \n\nNote: The default installation directory is \\Program Files\\Microsoft\\Exchange Server\\V14."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41720r1_chk","severity":"medium","gid":"V-33613","rid":"SV-44033r1_rule","stig_id":"Exch-2-828","gtitle":"Exch-2-828","fix_id":"F-37505r2_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44036","code":"control 'SV-44036' do\n  title 'Exchange must not send Customer Experience reports to Microsoft.'\n  desc 'Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability. This setting enables an automated entry to be sent to Microsoft giving general details about how the product is used.  Microsoft, in turn, uses this information to improve the robustness of their product.\n\nWhile this type of information does not ordinarily contain sensitive information, it may alert eavesdroppers to the existence of the environment and its configurations.  It could alert them to (possibly) advantageous timing or weaknesses toward which to mount an attack.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-OrganizationConfig\nIf the value for CustomerFeedbackEnabled is not set to 'False', this is a finding.\"\n  desc 'fix', 'Open the Exchange Management Shell and enter the following command:\n\nSet-OrganizationConfig -CustomerFeedbackEnabled $false'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41723r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33616'\n  tag rid: 'SV-44036r1_rule'\n  tag stig_id: 'Exch-2-831'\n  tag gtitle: 'Exch-2-831'\n  tag fix_id: 'F-37508r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44036.rb"},"title":"Exchange must not send Customer Experience reports to Microsoft.","desc":"Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability. This setting enables an automated entry to be sent to Microsoft giving general details about how the product is used.  Microsoft, in turn, uses this information to improve the robustness of their product.\n\nWhile this type of information does not ordinarily contain sensitive information, it may alert eavesdroppers to the existence of the environment and its configurations.  It could alert them to (possibly) advantageous timing or weaknesses toward which to mount an attack.","descriptions":{"default":"Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability. This setting enables an automated entry to be sent to Microsoft giving general details about how the product is used.  Microsoft, in turn, uses this information to improve the robustness of their product.\n\nWhile this type of information does not ordinarily contain sensitive information, it may alert eavesdroppers to the existence of the environment and its configurations.  It could alert them to (possibly) advantageous timing or weaknesses toward which to mount an attack.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-OrganizationConfig\nIf the value for CustomerFeedbackEnabled is not set to 'False', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-OrganizationConfig -CustomerFeedbackEnabled $false"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41723r2_chk","severity":"medium","gid":"V-33616","rid":"SV-44036r1_rule","stig_id":"Exch-2-831","gtitle":"Exch-2-831","fix_id":"F-37508r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44037","code":"control 'SV-44037' do\n  title 'Audit record parameters must be set.'\n  desc 'Log files help establish a history of activities, and can be useful in detecting attack attempts.   This item declares the fields that must be available in the audit log file in order to adequately research events that are logged. \nAudit records should include the following fields to supply useful event accounting: \nObject modified, Cmdlet name, Cmdlet parameters, Modified parameters, Caller, Succeeded, and Originating server.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-AdminAuditLogConfig | Select AdminAuditLogParameters\n\nIf the value of 'AdminAuditLogParameters' is not set to '{*}', this is a finding.\n\nNote: The value of {*} indicates all parameters are being audited.\"\n  desc 'fix', 'Open the Exchange Management Shell and enter the following command:\n\nSet-AdminAuditLogConfig -AdminAuditLogParameters *'\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41724r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-33617'\n  tag rid: 'SV-44037r2_rule'\n  tag stig_id: 'Exch-2-833'\n  tag gtitle: 'Exch-2-833'\n  tag fix_id: 'F-37509r1_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44037.rb"},"title":"Audit record parameters must be set.","desc":"Log files help establish a history of activities, and can be useful in detecting attack attempts.   This item declares the fields that must be available in the audit log file in order to adequately research events that are logged. \nAudit records should include the following fields to supply useful event accounting: \nObject modified, Cmdlet name, Cmdlet parameters, Modified parameters, Caller, Succeeded, and Originating server.","descriptions":{"default":"Log files help establish a history of activities, and can be useful in detecting attack attempts.   This item declares the fields that must be available in the audit log file in order to adequately research events that are logged. \nAudit records should include the following fields to supply useful event accounting: \nObject modified, Cmdlet name, Cmdlet parameters, Modified parameters, Caller, Succeeded, and Originating server.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-AdminAuditLogConfig | Select AdminAuditLogParameters\n\nIf the value of 'AdminAuditLogParameters' is not set to '{*}', this is a finding.\n\nNote: The value of {*} indicates all parameters are being audited.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-AdminAuditLogConfig -AdminAuditLogParameters *"},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41724r1_chk","severity":"low","gid":"V-33617","rid":"SV-44037r2_rule","stig_id":"Exch-2-833","gtitle":"Exch-2-833","fix_id":"F-37509r1_fix","documentable":null}},{"id":"SV-44038","code":"control 'SV-44038' do\n  title 'Audit data must be on separate partitions.'\n  desc 'Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability.   Audit log content must always be considered sensitive, and in need of protection.   \n\nSuccessful exploit of an application server vulnerability may well be logged by monitoring or audit processes when it occurs.  By writing log and audit data to a separate partition where separate security contexts protect them, it may offer the ability to protect this information from being modified or removed by the exploit mechanism.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the audit logs assigned partition.\n\nBy default the logs are located on the application partition in '\\\\Program Files\\\\Microsoft\\\\Exchange Server\\\\V14\\\\Logging\\\\'.   \n\nIf the log files are not on a separate partition from the application, this is a finding.\"\n  desc 'fix', 'Configure the audit log location to be on a partition drive separate from the application.  \n\nDocument the location in the EDSP.'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41725r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33618'\n  tag rid: 'SV-44038r1_rule'\n  tag stig_id: 'Exch-2-839'\n  tag gtitle: 'Exch-2-839'\n  tag fix_id: 'F-37510r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44038.rb"},"title":"Audit data must be on separate partitions.","desc":"Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability.   Audit log content must always be considered sensitive, and in need of protection.   \n\nSuccessful exploit of an application server vulnerability may well be logged by monitoring or audit processes when it occurs.  By writing log and audit data to a separate partition where separate security contexts protect them, it may offer the ability to protect this information from being modified or removed by the exploit mechanism.","descriptions":{"default":"Log files help establish a history of activities, and can be useful in detecting attack attempts or determining tuning adjustments to improve availability.   Audit log content must always be considered sensitive, and in need of protection.   \n\nSuccessful exploit of an application server vulnerability may well be logged by monitoring or audit processes when it occurs.  By writing log and audit data to a separate partition where separate security contexts protect them, it may offer the ability to protect this information from being modified or removed by the exploit mechanism.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the audit logs assigned partition.\n\nBy default the logs are located on the application partition in '\\Program Files\\Microsoft\\Exchange Server\\V14\\Logging\\'.   \n\nIf the log files are not on a separate partition from the application, this is a finding.","fix":"Configure the audit log location to be on a partition drive separate from the application.  \n\nDocument the location in the EDSP."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41725r1_chk","severity":"medium","gid":"V-33618","rid":"SV-44038r1_rule","stig_id":"Exch-2-839","gtitle":"Exch-2-839","fix_id":"F-37510r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44039","code":"control 'SV-44039' do\n  title 'Queue monitoring must be configured with threshold and action.'\n  desc 'Monitors are automated “process watchers” that respond to performance changes, and can be useful in detecting outages and alerting administrators where attention is needed. Exchange has built-in monitors that enable the administrator to generate alerts if thresholds are reached, better enabling them to react in a timely fashion. \n\nThe intent of this check is for system administrators to have awareness of performance changes on their network. \n\nNotification choices include email an alert to an email-enabled account, for example, an email Administrator, or invoke a script to take other action, for example, to add an Event to the Microsoft Application Event Log, where external monitors might detect it.\n\nData elements configured to be monitored should be specific to the organization’s network.\n.'\n  desc 'check', 'Note: If a third-party application is performing monitoring functions, the reviewer should verify the application is monitoring correctly and mark the vulnerability NA.\n\nOpen the Exchange Management Shell and enter the following command:\nperfmon\n\nIn the left pane, expand and navigate Data Collector Sets >> User Defined. \nIf no sets are defined or queues are not being monitored, this is a finding.'\n  desc 'fix', 'Open the Exchange Management Console\n\nIn the left pane, navigate to and select Microsoft Exchange On-Premises <server.domain> --> Toolbox \n\nIn the Right pane double click on Performance Monitor \n\nIn the left pane, navigate to and select Performance Logs and Alerts --> Data Collector Sets --> User Defined \n\nRight click on User Defined and configure the system to use User Defined data collection for monitoring the queues.'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41726r9_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33619'\n  tag rid: 'SV-44039r3_rule'\n  tag stig_id: 'Exch-2-842'\n  tag gtitle: 'Exch-2-842'\n  tag fix_id: 'F-37511r5_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44039.rb"},"title":"Queue monitoring must be configured with threshold and action.","desc":"Monitors are automated “process watchers” that respond to performance changes, and can be useful in detecting outages and alerting administrators where attention is needed. Exchange has built-in monitors that enable the administrator to generate alerts if thresholds are reached, better enabling them to react in a timely fashion. \n\nThe intent of this check is for system administrators to have awareness of performance changes on their network. \n\nNotification choices include email an alert to an email-enabled account, for example, an email Administrator, or invoke a script to take other action, for example, to add an Event to the Microsoft Application Event Log, where external monitors might detect it.\n\nData elements configured to be monitored should be specific to the organization’s network.\n.","descriptions":{"default":"Monitors are automated “process watchers” that respond to performance changes, and can be useful in detecting outages and alerting administrators where attention is needed. Exchange has built-in monitors that enable the administrator to generate alerts if thresholds are reached, better enabling them to react in a timely fashion. \n\nThe intent of this check is for system administrators to have awareness of performance changes on their network. \n\nNotification choices include email an alert to an email-enabled account, for example, an email Administrator, or invoke a script to take other action, for example, to add an Event to the Microsoft Application Event Log, where external monitors might detect it.\n\nData elements configured to be monitored should be specific to the organization’s network.\n.","check":"Note: If a third-party application is performing monitoring functions, the reviewer should verify the application is monitoring correctly and mark the vulnerability NA.\n\nOpen the Exchange Management Shell and enter the following command:\nperfmon\n\nIn the left pane, expand and navigate Data Collector Sets >> User Defined. \nIf no sets are defined or queues are not being monitored, this is a finding.","fix":"Open the Exchange Management Console\n\nIn the left pane, navigate to and select Microsoft Exchange On-Premises <server.domain> --> Toolbox \n\nIn the Right pane double click on Performance Monitor \n\nIn the left pane, navigate to and select Performance Logs and Alerts --> Data Collector Sets --> User Defined \n\nRight click on User Defined and configure the system to use User Defined data collection for monitoring the queues."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41726r9_chk","severity":"medium","gid":"V-33619","rid":"SV-44039r3_rule","stig_id":"Exch-2-842","gtitle":"Exch-2-842","fix_id":"F-37511r5_fix","documentable":null}},{"id":"SV-44040","code":"control 'SV-44040' do\n  title 'Email software must be monitored for change on INFOCON frequency schedule.'\n  desc 'The INFOCON system provides a framework within which the Commander USSTRATCOM regional commanders, service chiefs, base/post/camp/station/vessel commanders, or agency directors can increase the measurable readiness of their networks to match operational priorities. The readiness strategy provides the ability to continuously maintain and sustain one’s own information systems and networks throughout their schedule of deployments, exercises, and operational readiness life cycle independent of network attacks or threats. The system provides a framework of prescribed actions and cycles necessary for reestablishing the confidence level and security of information systems for the commander and thereby supporting the entire Global Information Grid (GIG) (SD 527-1 Purpose).\n\nThe Exchange software files and directories are vulnerable to unauthorized changes if not adequately protected.  An unauthorized change could affect the integrity or availability of email services overall. For this reason, all application software installations must monitor for change against a software baseline that is preserved when installed, and updated periodically as patches or upgrades are installed. Automated and manual schedules for software change monitoring must be compliant with SD527-1 frequencies. \n\nNote: Policy Auditor 5.2 or later, File Integrity Monitor (FIM) module will meet the requirement for file integrity checking. The Asset module within HBSS does not meet this requirement.'\n  desc 'check', 'Access the EDSP baseline section and determine the process and frequency for identifying software changes (*.exe, *.bat, *.com, *.cmd, and *.dll) on servers against a baseline.  \n\nExamine artifacts identified as outputs of this process.  \n\nIf baseline comparisons are not done on the INFOCON-required schedule, this is a finding.'\n  desc 'fix', 'Implement a process to compare software against a baseline (*.exe, *.bat, *.com, *.cmd, and *.dll) on a frequency required by the prevailing INFOCON level. \n\n Document the process and output artifacts in the EDSP.'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41727r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33620'\n  tag rid: 'SV-44040r1_rule'\n  tag stig_id: 'Exch-3-003'\n  tag gtitle: 'Exch-3-003'\n  tag fix_id: 'F-37512r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44040.rb"},"title":"Email software must be monitored for change on INFOCON frequency schedule.","desc":"The INFOCON system provides a framework within which the Commander USSTRATCOM regional commanders, service chiefs, base/post/camp/station/vessel commanders, or agency directors can increase the measurable readiness of their networks to match operational priorities. The readiness strategy provides the ability to continuously maintain and sustain one’s own information systems and networks throughout their schedule of deployments, exercises, and operational readiness life cycle independent of network attacks or threats. The system provides a framework of prescribed actions and cycles necessary for reestablishing the confidence level and security of information systems for the commander and thereby supporting the entire Global Information Grid (GIG) (SD 527-1 Purpose).\n\nThe Exchange software files and directories are vulnerable to unauthorized changes if not adequately protected.  An unauthorized change could affect the integrity or availability of email services overall. For this reason, all application software installations must monitor for change against a software baseline that is preserved when installed, and updated periodically as patches or upgrades are installed. Automated and manual schedules for software change monitoring must be compliant with SD527-1 frequencies. \n\nNote: Policy Auditor 5.2 or later, File Integrity Monitor (FIM) module will meet the requirement for file integrity checking. The Asset module within HBSS does not meet this requirement.","descriptions":{"default":"The INFOCON system provides a framework within which the Commander USSTRATCOM regional commanders, service chiefs, base/post/camp/station/vessel commanders, or agency directors can increase the measurable readiness of their networks to match operational priorities. The readiness strategy provides the ability to continuously maintain and sustain one’s own information systems and networks throughout their schedule of deployments, exercises, and operational readiness life cycle independent of network attacks or threats. The system provides a framework of prescribed actions and cycles necessary for reestablishing the confidence level and security of information systems for the commander and thereby supporting the entire Global Information Grid (GIG) (SD 527-1 Purpose).\n\nThe Exchange software files and directories are vulnerable to unauthorized changes if not adequately protected.  An unauthorized change could affect the integrity or availability of email services overall. For this reason, all application software installations must monitor for change against a software baseline that is preserved when installed, and updated periodically as patches or upgrades are installed. Automated and manual schedules for software change monitoring must be compliant with SD527-1 frequencies. \n\nNote: Policy Auditor 5.2 or later, File Integrity Monitor (FIM) module will meet the requirement for file integrity checking. The Asset module within HBSS does not meet this requirement.","check":"Access the EDSP baseline section and determine the process and frequency for identifying software changes (*.exe, *.bat, *.com, *.cmd, and *.dll) on servers against a baseline.  \n\nExamine artifacts identified as outputs of this process.  \n\nIf baseline comparisons are not done on the INFOCON-required schedule, this is a finding.","fix":"Implement a process to compare software against a baseline (*.exe, *.bat, *.com, *.cmd, and *.dll) on a frequency required by the prevailing INFOCON level. \n\n Document the process and output artifacts in the EDSP."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41727r1_chk","severity":"medium","gid":"V-33620","rid":"SV-44040r1_rule","stig_id":"Exch-3-003","gtitle":"Exch-3-003","fix_id":"F-37512r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44041","code":"control 'SV-44041' do\n  title 'Exchange software baseline copy must exist.'\n  desc 'Exchange software, as with other application software installed on a host system, must be included in a system baseline record and periodically reviewed;  otherwise unauthorized changes to the software may not be discovered. This effort is a vital step to securing the host and the applications, as it is the only method that may provide the ability to detect and recover from otherwise undetected changes, such as those that result from worm or bot intrusions. \n\nThe Exchange software and configuration baseline is created and maintained for comparison during scanning efforts. Operational procedures must include baseline updates as part of configuration management tasks that change the software and configuration.'\n  desc 'check', 'Access the EDSP and locate the baseline documentation.  \n\nReview the application software baseline procedures and implementation artifacts. Note the list of files and directories included in the baseline procedure for completeness. \n\nIf an email software copy exists to serve as a baseline and is available for comparison during scanning efforts, this is not a finding.'\n  desc 'fix', 'Implement email software baseline process. Document the details in the EDSP.'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41728r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33621'\n  tag rid: 'SV-44041r1_rule'\n  tag stig_id: 'Exch-3-006'\n  tag gtitle: 'Exch-3-006'\n  tag fix_id: 'F-37513r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44041.rb"},"title":"Exchange software baseline copy must exist.","desc":"Exchange software, as with other application software installed on a host system, must be included in a system baseline record and periodically reviewed;  otherwise unauthorized changes to the software may not be discovered. This effort is a vital step to securing the host and the applications, as it is the only method that may provide the ability to detect and recover from otherwise undetected changes, such as those that result from worm or bot intrusions. \n\nThe Exchange software and configuration baseline is created and maintained for comparison during scanning efforts. Operational procedures must include baseline updates as part of configuration management tasks that change the software and configuration.","descriptions":{"default":"Exchange software, as with other application software installed on a host system, must be included in a system baseline record and periodically reviewed;  otherwise unauthorized changes to the software may not be discovered. This effort is a vital step to securing the host and the applications, as it is the only method that may provide the ability to detect and recover from otherwise undetected changes, such as those that result from worm or bot intrusions. \n\nThe Exchange software and configuration baseline is created and maintained for comparison during scanning efforts. Operational procedures must include baseline updates as part of configuration management tasks that change the software and configuration.","check":"Access the EDSP and locate the baseline documentation.  \n\nReview the application software baseline procedures and implementation artifacts. Note the list of files and directories included in the baseline procedure for completeness. \n\nIf an email software copy exists to serve as a baseline and is available for comparison during scanning efforts, this is not a finding.","fix":"Implement email software baseline process. Document the details in the EDSP."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41728r1_chk","severity":"medium","gid":"V-33621","rid":"SV-44041r1_rule","stig_id":"Exch-3-006","gtitle":"Exch-3-006","fix_id":"F-37513r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44043","code":"control 'SV-44043' do\n  title 'Services must be documented and unnecessary services must be removed or disabled.'\n  desc 'Unneeded, but running,  services offer attackers an enhanced attack profile, and attackers are constantly watching to discover open ports with running services.  By analyzing and disabling unneeded services, the associated open ports become unresponsive to outside queries, and servers become more secure as a result.  \n \nExchange Server has role-based server deployment to enable protocol path control and logical separation of network traffic types.   \n\nFor example, a server implemented in the Client Access role (i.e., Outlook Web App [OWA]) is configured and tuned as a web server using web protocols.  A client access server exposes only web protocols (HTTP/HTTPS) enabling system administrators to optimize the protocol path and disable all services unnecessary for Exchange web services.    Similarly, servers created to host mailboxes are dedicated to that task, and must operate only the services needed for mailbox hosting.  (Exchange servers must also operate some Web services, but only to the degree that Exchange requires the IIS engine in order to function).   \n\nBecause POP3, and IMAP4 clients are not included in the standard desktop offering, they must be disabled.'\n  desc 'check', \"To view system services open a windows power shell and enter the following command:\n\nGet-Service | Where-Object {$_.status -eq 'running'}\n\nThe command returns a list of installed services and the status of that service. \n\nRequired services will vary between organizations, and will vary depending on the role of the individual system. Organizations will develop their own list of services which will be documented and justified with the ISSO. The Site’s list will be provided for any security review. Services that are common to multiple systems can be addressed in one document. Exceptions for individual systems should be identified separately by system.\n\nIf the site has not documented the services required for their system(s), this is a finding.\n\nIf any undocumented or unnecessary services are running, then this is a finding.\"\n  desc 'fix', 'Document the services required for the system to operate. Remove or disable any services that are not required.'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41730r3_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33623'\n  tag rid: 'SV-44043r2_rule'\n  tag stig_id: 'Exch-3-804'\n  tag gtitle: 'Exch-3-804'\n  tag fix_id: 'F-37515r1_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44043.rb"},"title":"Services must be documented and unnecessary services must be removed or disabled.","desc":"Unneeded, but running,  services offer attackers an enhanced attack profile, and attackers are constantly watching to discover open ports with running services.  By analyzing and disabling unneeded services, the associated open ports become unresponsive to outside queries, and servers become more secure as a result.  \n \nExchange Server has role-based server deployment to enable protocol path control and logical separation of network traffic types.   \n\nFor example, a server implemented in the Client Access role (i.e., Outlook Web App [OWA]) is configured and tuned as a web server using web protocols.  A client access server exposes only web protocols (HTTP/HTTPS) enabling system administrators to optimize the protocol path and disable all services unnecessary for Exchange web services.    Similarly, servers created to host mailboxes are dedicated to that task, and must operate only the services needed for mailbox hosting.  (Exchange servers must also operate some Web services, but only to the degree that Exchange requires the IIS engine in order to function).   \n\nBecause POP3, and IMAP4 clients are not included in the standard desktop offering, they must be disabled.","descriptions":{"default":"Unneeded, but running,  services offer attackers an enhanced attack profile, and attackers are constantly watching to discover open ports with running services.  By analyzing and disabling unneeded services, the associated open ports become unresponsive to outside queries, and servers become more secure as a result.  \n \nExchange Server has role-based server deployment to enable protocol path control and logical separation of network traffic types.   \n\nFor example, a server implemented in the Client Access role (i.e., Outlook Web App [OWA]) is configured and tuned as a web server using web protocols.  A client access server exposes only web protocols (HTTP/HTTPS) enabling system administrators to optimize the protocol path and disable all services unnecessary for Exchange web services.    Similarly, servers created to host mailboxes are dedicated to that task, and must operate only the services needed for mailbox hosting.  (Exchange servers must also operate some Web services, but only to the degree that Exchange requires the IIS engine in order to function).   \n\nBecause POP3, and IMAP4 clients are not included in the standard desktop offering, they must be disabled.","check":"To view system services open a windows power shell and enter the following command:\n\nGet-Service | Where-Object {$_.status -eq 'running'}\n\nThe command returns a list of installed services and the status of that service. \n\nRequired services will vary between organizations, and will vary depending on the role of the individual system. Organizations will develop their own list of services which will be documented and justified with the ISSO. The Site’s list will be provided for any security review. Services that are common to multiple systems can be addressed in one document. Exceptions for individual systems should be identified separately by system.\n\nIf the site has not documented the services required for their system(s), this is a finding.\n\nIf any undocumented or unnecessary services are running, then this is a finding.","fix":"Document the services required for the system to operate. Remove or disable any services that are not required."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41730r3_chk","severity":"medium","gid":"V-33623","rid":"SV-44043r2_rule","stig_id":"Exch-3-804","gtitle":"Exch-3-804","fix_id":"F-37515r1_fix","documentable":null}},{"id":"SV-44044","code":"control 'SV-44044' do\n  title 'Global inbound message size must be controlled.'\n  desc 'Email system availability depends in part on best practices strategies for setting tuning configurations. Message size limits should be set to 10 megabytes at most, but often are smaller, depending on the organization. The key point in message size is that it should be set globally, and it should not be set to ‘unlimited’.   Selecting ‘unlimited’ on either field is likely to result in abuse and can contribute to excessive server disk space consumption. \n\nMessage size limits may also be applied on SMTP connectors, Public Folders, and on the user account under AD.  Changes at these lower levels are discouraged, as the single global setting is usually sufficient. This practice prevents conflicts that could impact availability and it simplifies server administration.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the global maximum message receive size. \n\nOpen the Exchange Management Shell and enter the following command:\nGet-TransportConfig | Select Identity, MaxReceiveSize\n\nIf the value of 'MaxReceiveSize' is set to 10MB, this is not a finding.\n\nIf the value of 'MaxReceiveSize' is set to an alternate value, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of 'MaxReceiveSize' is set to “Unlimited”, this is a finding.\"\n  desc 'fix', 'Open the Exchange Management Shell and enter the following command:\n\nSet-TransportConfig  -MaxReceiveSize 10MB\n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP.'\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41731r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-33624'\n  tag rid: 'SV-44044r1_rule'\n  tag stig_id: 'Exch-2-011'\n  tag gtitle: 'Exch-2-011'\n  tag fix_id: 'F-37516r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44044.rb"},"title":"Global inbound message size must be controlled.","desc":"Email system availability depends in part on best practices strategies for setting tuning configurations. Message size limits should be set to 10 megabytes at most, but often are smaller, depending on the organization. The key point in message size is that it should be set globally, and it should not be set to ‘unlimited’.   Selecting ‘unlimited’ on either field is likely to result in abuse and can contribute to excessive server disk space consumption. \n\nMessage size limits may also be applied on SMTP connectors, Public Folders, and on the user account under AD.  Changes at these lower levels are discouraged, as the single global setting is usually sufficient. This practice prevents conflicts that could impact availability and it simplifies server administration.","descriptions":{"default":"Email system availability depends in part on best practices strategies for setting tuning configurations. Message size limits should be set to 10 megabytes at most, but often are smaller, depending on the organization. The key point in message size is that it should be set globally, and it should not be set to ‘unlimited’.   Selecting ‘unlimited’ on either field is likely to result in abuse and can contribute to excessive server disk space consumption. \n\nMessage size limits may also be applied on SMTP connectors, Public Folders, and on the user account under AD.  Changes at these lower levels are discouraged, as the single global setting is usually sufficient. This practice prevents conflicts that could impact availability and it simplifies server administration.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the global maximum message receive size. \n\nOpen the Exchange Management Shell and enter the following command:\nGet-TransportConfig | Select Identity, MaxReceiveSize\n\nIf the value of 'MaxReceiveSize' is set to 10MB, this is not a finding.\n\nIf the value of 'MaxReceiveSize' is set to an alternate value, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of 'MaxReceiveSize' is set to “Unlimited”, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-TransportConfig  -MaxReceiveSize 10MB\n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41731r1_chk","severity":"low","gid":"V-33624","rid":"SV-44044r1_rule","stig_id":"Exch-2-011","gtitle":"Exch-2-011","fix_id":"F-37516r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44045","code":"control 'SV-44045' do\n  title 'Email application must not share a partition with another application.'\n  desc 'In the same way that added security layers can provide a cumulative positive effect on security posture, multiple applications can provide a cumulative negative effect. A vulnerability and subsequent exploit to one application can lead to an exploit of other applications sharing the same security context. For example, an exploit to a web server process that leads to unauthorized administrative access to the host system can most likely lead to a compromise of all applications hosted by the same system.\n\nEmail services should be installed on a partition that does not host other applications. Email services should never be installed on a Domain Controller / Directory Services server.'\n  desc 'check', 'Access Windows Explorer and identify the OS partition.  Navigate to configured partitions, and access the ‘Program Files’ directory. \n\nNote the installation partition for Microsoft Exchange.   \n\nIf Exchange resides on a partition other than that of the OS, and does not have other applications installed (without associated approval from the ISSO), this is not a finding.'\n  desc 'fix', 'Install Exchange on a dedicated application partition separate than that of the OS.'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41732r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33625'\n  tag rid: 'SV-44045r2_rule'\n  tag stig_id: 'Exch-3-807'\n  tag gtitle: 'Exch-3-807'\n  tag fix_id: 'F-37517r1_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44045.rb"},"title":"Email application must not share a partition with another application.","desc":"In the same way that added security layers can provide a cumulative positive effect on security posture, multiple applications can provide a cumulative negative effect. A vulnerability and subsequent exploit to one application can lead to an exploit of other applications sharing the same security context. For example, an exploit to a web server process that leads to unauthorized administrative access to the host system can most likely lead to a compromise of all applications hosted by the same system.\n\nEmail services should be installed on a partition that does not host other applications. Email services should never be installed on a Domain Controller / Directory Services server.","descriptions":{"default":"In the same way that added security layers can provide a cumulative positive effect on security posture, multiple applications can provide a cumulative negative effect. A vulnerability and subsequent exploit to one application can lead to an exploit of other applications sharing the same security context. For example, an exploit to a web server process that leads to unauthorized administrative access to the host system can most likely lead to a compromise of all applications hosted by the same system.\n\nEmail services should be installed on a partition that does not host other applications. Email services should never be installed on a Domain Controller / Directory Services server.","check":"Access Windows Explorer and identify the OS partition.  Navigate to configured partitions, and access the ‘Program Files’ directory. \n\nNote the installation partition for Microsoft Exchange.   \n\nIf Exchange resides on a partition other than that of the OS, and does not have other applications installed (without associated approval from the ISSO), this is not a finding.","fix":"Install Exchange on a dedicated application partition separate than that of the OS."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41732r2_chk","severity":"medium","gid":"V-33625","rid":"SV-44045r2_rule","stig_id":"Exch-3-807","gtitle":"Exch-3-807","fix_id":"F-37517r1_fix","documentable":null}},{"id":"SV-44046","code":"control 'SV-44046' do\n  title 'Servers must use approved DoD certificates.'\n  desc \"Server certificates are required for many security features in Exchange; without them the server cannot engage in many forms of secure communication. \nFailure to implement valid certificates makes it virtually impossible to secure Exchange's communications.\"\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-ExchangeCertificate | Select CertificateDomains, issuer\n\nIf the value of 'CertificateDomains' does not indicate it is issued by the DoD, this is a finding.\"\n  desc 'fix', 'Remove the non-DoD certificate and import the correct DoD certificates.'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41733r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33626'\n  tag rid: 'SV-44046r2_rule'\n  tag stig_id: 'Exch-2-014'\n  tag gtitle: 'Exch-2-014'\n  tag fix_id: 'F-37518r1_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44046.rb"},"title":"Servers must use approved DoD certificates.","desc":"Server certificates are required for many security features in Exchange; without them the server cannot engage in many forms of secure communication. \nFailure to implement valid certificates makes it virtually impossible to secure Exchange's communications.","descriptions":{"default":"Server certificates are required for many security features in Exchange; without them the server cannot engage in many forms of secure communication. \nFailure to implement valid certificates makes it virtually impossible to secure Exchange's communications.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-ExchangeCertificate | Select CertificateDomains, issuer\n\nIf the value of 'CertificateDomains' does not indicate it is issued by the DoD, this is a finding.","fix":"Remove the non-DoD certificate and import the correct DoD certificates."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41733r5_chk","severity":"medium","gid":"V-33626","rid":"SV-44046r2_rule","stig_id":"Exch-2-014","gtitle":"Exch-2-014","fix_id":"F-37518r1_fix","documentable":null}},{"id":"SV-44047","code":"control 'SV-44047' do\n  title 'Global outbound message size must be controlled.'\n  desc 'Email system availability depends in part on best practices strategies for setting tuning configurations. Message size limits should be set to 10 megabytes at most, but often are smaller, depending on the organization. The key point in message size is that it should be set globally, and it should not be set to ‘unlimited’.   Selecting ‘unlimited’ on either field is likely to result in abuse and can contribute to excessive server disk space consumption. \n\nMessage size limits may also be applied on send and receive connectors, Public Folders, and on the user account under AD. Changes at these lower levels are discouraged, as the single global setting is usually sufficient. This practice prevents conflicts that could impact availability and it simplifies server administration.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the global maximum message send size. \n\nOpen the Exchange Management Shell and enter the following command:\nGet-TransportConfig | Select Identity, MaxSendSize\n\nIf the value of 'MaxSendSize' is set to 10MB, this is not a finding.\n\nIf the value of 'MaxSendSize' is set to an alternate value, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of 'MaxSendSize' is set to “Unlimited”, this is a finding.\"\n  desc 'fix', 'Open the Exchange Management Shell and enter the following command:\n\nSet-TransportConfig  -MaxSendSize 10MB\n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP.'\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41735r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-33627'\n  tag rid: 'SV-44047r2_rule'\n  tag stig_id: 'Exch-2-015'\n  tag gtitle: 'Exch-2-015'\n  tag fix_id: 'F-37519r1_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44047.rb"},"title":"Global outbound message size must be controlled.","desc":"Email system availability depends in part on best practices strategies for setting tuning configurations. Message size limits should be set to 10 megabytes at most, but often are smaller, depending on the organization. The key point in message size is that it should be set globally, and it should not be set to ‘unlimited’.   Selecting ‘unlimited’ on either field is likely to result in abuse and can contribute to excessive server disk space consumption. \n\nMessage size limits may also be applied on send and receive connectors, Public Folders, and on the user account under AD. Changes at these lower levels are discouraged, as the single global setting is usually sufficient. This practice prevents conflicts that could impact availability and it simplifies server administration.","descriptions":{"default":"Email system availability depends in part on best practices strategies for setting tuning configurations. Message size limits should be set to 10 megabytes at most, but often are smaller, depending on the organization. The key point in message size is that it should be set globally, and it should not be set to ‘unlimited’.   Selecting ‘unlimited’ on either field is likely to result in abuse and can contribute to excessive server disk space consumption. \n\nMessage size limits may also be applied on send and receive connectors, Public Folders, and on the user account under AD. Changes at these lower levels are discouraged, as the single global setting is usually sufficient. This practice prevents conflicts that could impact availability and it simplifies server administration.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the global maximum message send size. \n\nOpen the Exchange Management Shell and enter the following command:\nGet-TransportConfig | Select Identity, MaxSendSize\n\nIf the value of 'MaxSendSize' is set to 10MB, this is not a finding.\n\nIf the value of 'MaxSendSize' is set to an alternate value, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of 'MaxSendSize' is set to “Unlimited”, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-TransportConfig  -MaxSendSize 10MB\n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41735r1_chk","severity":"low","gid":"V-33627","rid":"SV-44047r2_rule","stig_id":"Exch-2-015","gtitle":"Exch-2-015","fix_id":"F-37519r1_fix","documentable":null}},{"id":"SV-44049","code":"control 'SV-44049' do\n  title 'The current, approved service pack must be installed.'\n  desc 'Failure to install the most current Exchange service pack leaves a system vulnerable to exploitation. Current service packs correct known security and system vulnerabilities.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-ExchangeServer | fl name, AdminDisplayVersion\n\nIf the value of 'AdminDisplayVersion' does not return Version 14.2 (Build 247.5) or greater, this is a finding.\"\n  desc 'fix', 'Update the system with the latest approved service pack or a supported release.'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41737r5_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33629'\n  tag rid: 'SV-44049r3_rule'\n  tag stig_id: 'Exch-3-814'\n  tag gtitle: 'Exch-3-814'\n  tag fix_id: 'F-37521r3_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44049.rb"},"title":"The current, approved service pack must be installed.","desc":"Failure to install the most current Exchange service pack leaves a system vulnerable to exploitation. Current service packs correct known security and system vulnerabilities.","descriptions":{"default":"Failure to install the most current Exchange service pack leaves a system vulnerable to exploitation. Current service packs correct known security and system vulnerabilities.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-ExchangeServer | fl name, AdminDisplayVersion\n\nIf the value of 'AdminDisplayVersion' does not return Version 14.2 (Build 247.5) or greater, this is a finding.","fix":"Update the system with the latest approved service pack or a supported release."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41737r5_chk","severity":"medium","gid":"V-33629","rid":"SV-44049r3_rule","stig_id":"Exch-3-814","gtitle":"Exch-3-814","fix_id":"F-37521r3_fix","documentable":null}},{"id":"SV-44050","code":"control 'SV-44050' do\n  title 'Global recipient count limit must be set.'\n  desc 'Email system availability depends in part on best practices strategies for setting tuning configurations. The Global Recipient Count limit field is used to control the maximum number of recipients that can be specified in a single message sent from this server. Its primary purpose is to minimize the chance of an internal sender spamming other recipients, since SPAM messages often have a large number of recipients. SPAM prevention can originate from both outside and inside organizations. While inbound SPAM is evaluated as it arrives, controls such as this one help prevent SPAM that might originate inside the organization. \n\nThe Recipient Count Limit is global to the Exchange implementation. Lower-level refinements are possible; however, in this configuration strategy, setting the value once at the global level ensures a more available system by eliminating potential conflicts among multiple settings. A value of less than or equal to 5000 is probably larger than is needed for most organizations, but is small enough to minimize usefulness to spammers, and is easily handled by Exchange.  An unexpanded distribution is handled as one recipient.  Specifying “unlimited” may result in abuse.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the global maximum message recipient count. \n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-TransportConfig | Select Identity, MaxRecipientEnvelopeLimit\nIf the value of 'MaxRecipientEnvelopeLimit' is set to 5000, this is not a finding.\n\nIf the value of 'MaxRecipientEnvelopeLimit' value is set to an alternate value, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of 'MaxRecipientEnvelopeLimit' is set to 'Unlimited', this is a finding.\"\n  desc 'fix', \"Set-transportConfig  -'MaxRecipientEnvelopeLimit' 5000\n\nRestart the “Microsoft Exchange Information Store” service.  \n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP.\"\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41736r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-33630'\n  tag rid: 'SV-44050r1_rule'\n  tag stig_id: 'Exch-2-017'\n  tag gtitle: 'Exch-2-017'\n  tag fix_id: 'F-37522r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44050.rb"},"title":"Global recipient count limit must be set.","desc":"Email system availability depends in part on best practices strategies for setting tuning configurations. The Global Recipient Count limit field is used to control the maximum number of recipients that can be specified in a single message sent from this server. Its primary purpose is to minimize the chance of an internal sender spamming other recipients, since SPAM messages often have a large number of recipients. SPAM prevention can originate from both outside and inside organizations. While inbound SPAM is evaluated as it arrives, controls such as this one help prevent SPAM that might originate inside the organization. \n\nThe Recipient Count Limit is global to the Exchange implementation. Lower-level refinements are possible; however, in this configuration strategy, setting the value once at the global level ensures a more available system by eliminating potential conflicts among multiple settings. A value of less than or equal to 5000 is probably larger than is needed for most organizations, but is small enough to minimize usefulness to spammers, and is easily handled by Exchange.  An unexpanded distribution is handled as one recipient.  Specifying “unlimited” may result in abuse.","descriptions":{"default":"Email system availability depends in part on best practices strategies for setting tuning configurations. The Global Recipient Count limit field is used to control the maximum number of recipients that can be specified in a single message sent from this server. Its primary purpose is to minimize the chance of an internal sender spamming other recipients, since SPAM messages often have a large number of recipients. SPAM prevention can originate from both outside and inside organizations. While inbound SPAM is evaluated as it arrives, controls such as this one help prevent SPAM that might originate inside the organization. \n\nThe Recipient Count Limit is global to the Exchange implementation. Lower-level refinements are possible; however, in this configuration strategy, setting the value once at the global level ensures a more available system by eliminating potential conflicts among multiple settings. A value of less than or equal to 5000 is probably larger than is needed for most organizations, but is small enough to minimize usefulness to spammers, and is easily handled by Exchange.  An unexpanded distribution is handled as one recipient.  Specifying “unlimited” may result in abuse.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the global maximum message recipient count. \n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-TransportConfig | Select Identity, MaxRecipientEnvelopeLimit\nIf the value of 'MaxRecipientEnvelopeLimit' is set to 5000, this is not a finding.\n\nIf the value of 'MaxRecipientEnvelopeLimit' value is set to an alternate value, and has signoff and risk acceptance in the EDSP, this is not a finding.\n\nIf the value of 'MaxRecipientEnvelopeLimit' is set to 'Unlimited', this is a finding.","fix":"Set-transportConfig  -'MaxRecipientEnvelopeLimit' 5000\n\nRestart the “Microsoft Exchange Information Store” service.  \n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41736r1_chk","severity":"low","gid":"V-33630","rid":"SV-44050r1_rule","stig_id":"Exch-2-017","gtitle":"Exch-2-017","fix_id":"F-37522r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44052","code":"control 'SV-44052' do\n  title 'Local machine policy must require signed scripts.'\n  desc 'Scripts often provide a way for attackers to infiltrate a system, especially those downloaded from untrusted locations.   By setting machine policy to prevent unauthorized script executions, unanticipated system impacts can be avoided.  Failure to allow only signed remote scripts reduces the attack vector vulnerabilities from unsigned remote scripts.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-ExecutionPolicy\n\nIf the value of 'LocalMachine' does not return a value of 'RemoteSigned', this is a finding.\"\n  desc 'fix', 'Open the Exchange Management Shell and enter the following command:\n\nSet-ExecutionPolicy RemoteSigned'\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41741r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33632'\n  tag rid: 'SV-44052r1_rule'\n  tag stig_id: 'Exch-2-019'\n  tag gtitle: 'Exch-2-019'\n  tag fix_id: 'F-37524r2_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44052.rb"},"title":"Local machine policy must require signed scripts.","desc":"Scripts often provide a way for attackers to infiltrate a system, especially those downloaded from untrusted locations.   By setting machine policy to prevent unauthorized script executions, unanticipated system impacts can be avoided.  Failure to allow only signed remote scripts reduces the attack vector vulnerabilities from unsigned remote scripts.","descriptions":{"default":"Scripts often provide a way for attackers to infiltrate a system, especially those downloaded from untrusted locations.   By setting machine policy to prevent unauthorized script executions, unanticipated system impacts can be avoided.  Failure to allow only signed remote scripts reduces the attack vector vulnerabilities from unsigned remote scripts.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-ExecutionPolicy\n\nIf the value of 'LocalMachine' does not return a value of 'RemoteSigned', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-ExecutionPolicy RemoteSigned"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41741r1_chk","severity":"medium","gid":"V-33632","rid":"SV-44052r1_rule","stig_id":"Exch-2-019","gtitle":"Exch-2-019","fix_id":"F-37524r2_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44054","code":"control 'SV-44054' do\n  title 'SMTP automated banner response must not reveal server details.'\n  desc 'Automated connection responses occur as a result of FTP or Telnet connections, when connecting to those services. They report a successful connection by greeting the connecting client, stating the name, release level, and (often) additional information regarding the responding product. While useful to the connecting client, connection responses can also be used by a third party to determine operating system (OS) or product release levels on the target server. The result can include disclosure of configuration information to third parties, paving the way for possible future attacks.   For example, when querying the SMTP service on port 25, the default response looks similar to this one: \n\n220 exchange.mydomain.org Microsoft ESMTP MAIL Service, Version: 6.0.3790.211 ready at Wed, 2 Feb 2005 23:40:00 -0500\n\nChanging the response to hide local configuration details reduces the attack profile of the target.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity, Banner\n\nIf the value of 'Banner' is not set to '220 SMTP Server Ready', this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -Banner '220 SMTP Server Ready'\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41743r1_chk'\n  tag severity: 'medium'\n  tag gid: 'V-33634'\n  tag rid: 'SV-44054r1_rule'\n  tag stig_id: 'Exch-2-200'\n  tag gtitle: 'Exch-2-200'\n  tag fix_id: 'F-37526r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44054.rb"},"title":"SMTP automated banner response must not reveal server details.","desc":"Automated connection responses occur as a result of FTP or Telnet connections, when connecting to those services. They report a successful connection by greeting the connecting client, stating the name, release level, and (often) additional information regarding the responding product. While useful to the connecting client, connection responses can also be used by a third party to determine operating system (OS) or product release levels on the target server. The result can include disclosure of configuration information to third parties, paving the way for possible future attacks.   For example, when querying the SMTP service on port 25, the default response looks similar to this one: \n\n220 exchange.mydomain.org Microsoft ESMTP MAIL Service, Version: 6.0.3790.211 ready at Wed, 2 Feb 2005 23:40:00 -0500\n\nChanging the response to hide local configuration details reduces the attack profile of the target.","descriptions":{"default":"Automated connection responses occur as a result of FTP or Telnet connections, when connecting to those services. They report a successful connection by greeting the connecting client, stating the name, release level, and (often) additional information regarding the responding product. While useful to the connecting client, connection responses can also be used by a third party to determine operating system (OS) or product release levels on the target server. The result can include disclosure of configuration information to third parties, paving the way for possible future attacks.   For example, when querying the SMTP service on port 25, the default response looks similar to this one: \n\n220 exchange.mydomain.org Microsoft ESMTP MAIL Service, Version: 6.0.3790.211 ready at Wed, 2 Feb 2005 23:40:00 -0500\n\nChanging the response to hide local configuration details reduces the attack profile of the target.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-ReceiveConnector | Select Name, Identity, Banner\n\nIf the value of 'Banner' is not set to '220 SMTP Server Ready', this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -Banner '220 SMTP Server Ready'"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41743r1_chk","severity":"medium","gid":"V-33634","rid":"SV-44054r1_rule","stig_id":"Exch-2-200","gtitle":"Exch-2-200","fix_id":"F-37526r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-44055","code":"control 'SV-44055' do\n  title 'Outbound Connection Limit per Domain Count must be controlled.'\n  desc 'Email system availability depends in part on best practices strategies for setting tuning configurations. This configuration controls the maximum number of simultaneous outbound connections from a domain, and works in conjunction with the Maximum Outbound Connections Count setting as a delivery tuning mechanism. If the limit is too low, connections may be dropped. If too high, some domains may use a disproportionate resource share, denying access to other domains. Appropriate tuning reduces risk of data delay or loss. \n\nBy default, a limit of 20 simultaneous outbound connections from a domain should be sufficient. The value may be adjusted if justified by local site conditions.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the value for 'Maximum Domain Connections' and the server under review.  \n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-TransportServer -Identity \n<'ServerUnderReview'> | Select Name, Identity, MaxPerDomainOutboundConnections\n\nIf the value of 'MaxPerDomainOutboundConnections' is set to 20 this is not a finding.\n\nIf the value of 'MaxPerDomainOutboundConnections' is set to a value other than 20 and has signoff and risk acceptance in the EDSP, this is not a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-TransportServer -Identity <'ServerUnderReview'> -MaxPerDomainOutboundConnections 20\n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP.\"\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41744r2_chk'\n  tag severity: 'low'\n  tag gid: 'V-33635'\n  tag rid: 'SV-44055r2_rule'\n  tag stig_id: 'Exch-2-201'\n  tag gtitle: 'Exch-2-201'\n  tag fix_id: 'F-37527r2_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44055.rb"},"title":"Outbound Connection Limit per Domain Count must be controlled.","desc":"Email system availability depends in part on best practices strategies for setting tuning configurations. This configuration controls the maximum number of simultaneous outbound connections from a domain, and works in conjunction with the Maximum Outbound Connections Count setting as a delivery tuning mechanism. If the limit is too low, connections may be dropped. If too high, some domains may use a disproportionate resource share, denying access to other domains. Appropriate tuning reduces risk of data delay or loss. \n\nBy default, a limit of 20 simultaneous outbound connections from a domain should be sufficient. The value may be adjusted if justified by local site conditions.","descriptions":{"default":"Email system availability depends in part on best practices strategies for setting tuning configurations. This configuration controls the maximum number of simultaneous outbound connections from a domain, and works in conjunction with the Maximum Outbound Connections Count setting as a delivery tuning mechanism. If the limit is too low, connections may be dropped. If too high, some domains may use a disproportionate resource share, denying access to other domains. Appropriate tuning reduces risk of data delay or loss. \n\nBy default, a limit of 20 simultaneous outbound connections from a domain should be sufficient. The value may be adjusted if justified by local site conditions.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the value for 'Maximum Domain Connections' and the server under review.  \n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-TransportServer -Identity \n<'ServerUnderReview'> | Select Name, Identity, MaxPerDomainOutboundConnections\n\nIf the value of 'MaxPerDomainOutboundConnections' is set to 20 this is not a finding.\n\nIf the value of 'MaxPerDomainOutboundConnections' is set to a value other than 20 and has signoff and risk acceptance in the EDSP, this is not a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-TransportServer -Identity <'ServerUnderReview'> -MaxPerDomainOutboundConnections 20\n\nIf an alternate value is desired, obtain signoff with risk acceptance and document in the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41744r2_chk","severity":"low","gid":"V-33635","rid":"SV-44055r2_rule","stig_id":"Exch-2-201","gtitle":"Exch-2-201","fix_id":"F-37527r2_fix","documentable":null}},{"id":"SV-44066","code":"control 'SV-44066' do\n  title 'Outbound Connection Timeout must be 10 or less.'\n  desc 'Email system availability depends in part on best practices strategies for setting tuning configurations. This configuration controls the number of idle minutes before the connection is dropped. It works in conjunction with the Maximum Outbound Connections Count setting.\n\nConnections, once established, may incur delays in message transfer. The default of 10 minutes is a reasonable window in which to resume activities without maintaining idle connections for excessive intervals. If the timeout period is too long, idle connections may be maintained for unnecessarily long time periods, preventing new connections from being established. Sluggish connectivity increases the risk of lost data. A value of 10 or less is optimal.'\n  desc 'check', \"Obtain the Email Domain Security Plan (EDSP) and locate the 'Connection Timeout' value.  \n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select Name, Identity, ConnectionInactivityTimeOut \n\nIf the value of 'ConnectionInactivityTimeOut' is set to 00:10:00, this is not a finding.\n\nIf 'ConnectionInactivityTimeOut' is set to other than 00:10:00, and has signoff and risk acceptance in the EDSP, this is not a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -ConnectionInactivityTimeOut \n 00:10:00 or other value as identified by the EDSP.\"\n  impact 0.3\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-41756r1_chk'\n  tag severity: 'low'\n  tag gid: 'V-33646'\n  tag rid: 'SV-44066r1_rule'\n  tag stig_id: 'Exch-2-769'\n  tag gtitle: 'Exch-2-769'\n  tag fix_id: 'F-37539r1_fix'\n  tag 'documentable'\n  tag ia_controls: 'ECSC-1'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-44066.rb"},"title":"Outbound Connection Timeout must be 10 or less.","desc":"Email system availability depends in part on best practices strategies for setting tuning configurations. This configuration controls the number of idle minutes before the connection is dropped. It works in conjunction with the Maximum Outbound Connections Count setting.\n\nConnections, once established, may incur delays in message transfer. The default of 10 minutes is a reasonable window in which to resume activities without maintaining idle connections for excessive intervals. If the timeout period is too long, idle connections may be maintained for unnecessarily long time periods, preventing new connections from being established. Sluggish connectivity increases the risk of lost data. A value of 10 or less is optimal.","descriptions":{"default":"Email system availability depends in part on best practices strategies for setting tuning configurations. This configuration controls the number of idle minutes before the connection is dropped. It works in conjunction with the Maximum Outbound Connections Count setting.\n\nConnections, once established, may incur delays in message transfer. The default of 10 minutes is a reasonable window in which to resume activities without maintaining idle connections for excessive intervals. If the timeout period is too long, idle connections may be maintained for unnecessarily long time periods, preventing new connections from being established. Sluggish connectivity increases the risk of lost data. A value of 10 or less is optimal.","check":"Obtain the Email Domain Security Plan (EDSP) and locate the 'Connection Timeout' value.  \n\nOpen the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select Name, Identity, ConnectionInactivityTimeOut \n\nIf the value of 'ConnectionInactivityTimeOut' is set to 00:10:00, this is not a finding.\n\nIf 'ConnectionInactivityTimeOut' is set to other than 00:10:00, and has signoff and risk acceptance in the EDSP, this is not a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-ReceiveConnector -Identity <'ReceiveConnector'> -ConnectionInactivityTimeOut \n 00:10:00 or other value as identified by the EDSP."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-41756r1_chk","severity":"low","gid":"V-33646","rid":"SV-44066r1_rule","stig_id":"Exch-2-769","gtitle":"Exch-2-769","fix_id":"F-37539r1_fix","documentable":null,"ia_controls":"ECSC-1"}},{"id":"SV-75445","code":"control 'SV-75445' do\n  title 'Internal Send Connectors must use an authentication level'\n  desc 'The Simple Mail Transfer Protocol (SMTP) connector is used by Exchange to send and receive messages from server to server. There are several controls that work together to provide security between internal servers. This setting controls the encryption method used for communications between servers. With this feature enabled, only servers capable of supporting Transport Layer Security (TLS) will be able to send and receive mail within the domain.\n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers. While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from server to server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender. \n\nIndividually, channel security and encryption can be compromised by attackers. Used together, email becomes a more difficult target, and security is heightened. Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between servers.'\n  desc 'check', \"Open the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select Name, Identity, TlsAuthLevel\n\nIf the value of 'TlsAuthLevel' is not set to 'DomainValidation, this is a finding.\"\n  desc 'fix', \"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector -Identity <'SendConnector'> -TlsAuthLevel DomainValidation\"\n  impact 0.5\n  ref 'DPMS Target Microsoft Exchange Server 2010'\n  tag check_id: 'C-61913r2_chk'\n  tag severity: 'medium'\n  tag gid: 'V-60981'\n  tag rid: 'SV-75445r1_rule'\n  tag stig_id: 'Exch-2-768'\n  tag gtitle: 'Exch-2-768'\n  tag fix_id: 'F-66713r1_fix'\n  tag 'documentable'\nend","source_location":{"line":1,"ref":"../inspec_stubs/U_Exchange_2010_Hub_V1R12/controls/SV-75445.rb"},"title":"Internal Send Connectors must use an authentication level","desc":"The Simple Mail Transfer Protocol (SMTP) connector is used by Exchange to send and receive messages from server to server. There are several controls that work together to provide security between internal servers. This setting controls the encryption method used for communications between servers. With this feature enabled, only servers capable of supporting Transport Layer Security (TLS) will be able to send and receive mail within the domain.\n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers. While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from server to server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender. \n\nIndividually, channel security and encryption can be compromised by attackers. Used together, email becomes a more difficult target, and security is heightened. Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between servers.","descriptions":{"default":"The Simple Mail Transfer Protocol (SMTP) connector is used by Exchange to send and receive messages from server to server. There are several controls that work together to provide security between internal servers. This setting controls the encryption method used for communications between servers. With this feature enabled, only servers capable of supporting Transport Layer Security (TLS) will be able to send and receive mail within the domain.\n\nThe use of secure communication prevents eavesdroppers from reading or modifying communications between mail clients and servers. While sensitive message bodies should be encrypted by the sender at the client, requiring a secure connection from server to server adds protection by encrypting the sender and recipient information that cannot be encrypted by the sender. \n\nIndividually, channel security and encryption can be compromised by attackers. Used together, email becomes a more difficult target, and security is heightened. Failure to enable this feature gives eavesdroppers an opportunity to read or modify messages between servers.","check":"Open the Exchange Management Shell and enter the following command:\n\nGet-SendConnector | Select Name, Identity, TlsAuthLevel\n\nIf the value of 'TlsAuthLevel' is not set to 'DomainValidation, this is a finding.","fix":"Open the Exchange Management Shell and enter the following command:\n\nSet-SendConnector -Identity <'SendConnector'> -TlsAuthLevel DomainValidation"},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft Exchange Server 2010"}],"tags":{"check_id":"C-61913r2_chk","severity":"medium","gid":"V-60981","rid":"SV-75445r1_rule","stig_id":"Exch-2-768","gtitle":"Exch-2-768","fix_id":"F-66713r1_fix","documentable":null}}],"groups":[{"id":"controls/SV-43981.rb","title":null,"controls":["SV-43981"]},{"id":"controls/SV-43984.rb","title":null,"controls":["SV-43984"]},{"id":"controls/SV-43986.rb","title":null,"controls":["SV-43986"]},{"id":"controls/SV-43987.rb","title":null,"controls":["SV-43987"]},{"id":"controls/SV-43992.rb","title":null,"controls":["SV-43992"]},{"id":"controls/SV-43995.rb","title":null,"controls":["SV-43995"]},{"id":"controls/SV-43996.rb","title":null,"controls":["SV-43996"]},{"id":"controls/SV-43999.rb","title":null,"controls":["SV-43999"]},{"id":"controls/SV-44004.rb","title":null,"controls":["SV-44004"]},{"id":"controls/SV-44006.rb","title":null,"controls":["SV-44006"]},{"id":"controls/SV-44007.rb","title":null,"controls":["SV-44007"]},{"id":"controls/SV-44009.rb","title":null,"controls":["SV-44009"]},{"id":"controls/SV-44010.rb","title":null,"controls":["SV-44010"]},{"id":"controls/SV-44012.rb","title":null,"controls":["SV-44012"]},{"id":"controls/SV-44014.rb","title":null,"controls":["SV-44014"]},{"id":"controls/SV-44016.rb","title":null,"controls":["SV-44016"]},{"id":"controls/SV-44018.rb","title":null,"controls":["SV-44018"]},{"id":"controls/SV-44019.rb","title":null,"controls":["SV-44019"]},{"id":"controls/SV-44021.rb","title":null,"controls":["SV-44021"]},{"id":"controls/SV-44023.rb","title":null,"controls":["SV-44023"]},{"id":"controls/SV-44026.rb","title":null,"controls":["SV-44026"]},{"id":"controls/SV-44028.rb","title":null,"controls":["SV-44028"]},{"id":"controls/SV-44029.rb","title":null,"controls":["SV-44029"]},{"id":"controls/SV-44031.rb","title":null,"controls":["SV-44031"]},{"id":"controls/SV-44033.rb","title":null,"controls":["SV-44033"]},{"id":"controls/SV-44036.rb","title":null,"controls":["SV-44036"]},{"id":"controls/SV-44037.rb","title":null,"controls":["SV-44037"]},{"id":"controls/SV-44038.rb","title":null,"controls":["SV-44038"]},{"id":"controls/SV-44039.rb","title":null,"controls":["SV-44039"]},{"id":"controls/SV-44040.rb","title":null,"controls":["SV-44040"]},{"id":"controls/SV-44041.rb","title":null,"controls":["SV-44041"]},{"id":"controls/SV-44043.rb","title":null,"controls":["SV-44043"]},{"id":"controls/SV-44044.rb","title":null,"controls":["SV-44044"]},{"id":"controls/SV-44045.rb","title":null,"controls":["SV-44045"]},{"id":"controls/SV-44046.rb","title":null,"controls":["SV-44046"]},{"id":"controls/SV-44047.rb","title":null,"controls":["SV-44047"]},{"id":"controls/SV-44049.rb","title":null,"controls":["SV-44049"]},{"id":"controls/SV-44050.rb","title":null,"controls":["SV-44050"]},{"id":"controls/SV-44052.rb","title":null,"controls":["SV-44052"]},{"id":"controls/SV-44054.rb","title":null,"controls":["SV-44054"]},{"id":"controls/SV-44055.rb","title":null,"controls":["SV-44055"]},{"id":"controls/SV-44066.rb","title":null,"controls":["SV-44066"]},{"id":"controls/SV-75445.rb","title":null,"controls":["SV-75445"]}],"name":"Exchange_2010_Hub_Transport_Server_STIG","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"f578dd617eaafeb5f61479831bb6c48a76d253b2852a1d3df1582758a6f837ea","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
