{"controls":[{"id":"SV-225223","code":"control 'SV-225223' do\n  title 'Digital signatures assigned to strongly named assemblies must be verified.'\n  desc \"A strong name consists of the assembly's identity, simple text name, version number, and culture information (if provided)—plus a public key and a digital signature.  Strong names serve to identify the author of the code.  If digital signatures used to sign strong name assemblies are not verified, any self signed code can be impersonated.  This can lead to a loss of system integrity.\"\n  desc 'check', 'Use regedit to review the Windows registry key \nHKLM\\\\Software\\\\Microsoft\\\\StrongName\\\\Verification. \nThere should be no assemblies or hash values listed under this registry key. If the StrongName\\\\Verification key does not exist, this is not a finding.\n\nIf there are assemblies or hash values listed in this key, each value represents a distinct application assembly that does not have the application strong name verified.  \n\nIf any assemblies are listed as omitting strong name verification in a production environment, this is a finding.\n\nIf any assemblies are listed as omitting strong name verification in a development or test environment and the IAO has not provided documented approvals, this is a finding.'\n  desc 'fix', 'Use regedit to remove the values stored in Windows registry key HKLM\\\\Software\\\\Microsoft\\\\StrongName\\\\Verification. There should be no assemblies or hash values listed under this registry key.\n\nAll assemblies must require strong name verification in a production environment.\n\nStrong name assemblies that do not require verification in a development or test environment must have documented approvals from the IAO.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26922r467984_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225223'\n  tag rid: 'SV-225223r615940_rule'\n  tag stig_id: 'APPNET0031'\n  tag gtitle: 'SRG-APP-000175'\n  tag fix_id: 'F-26910r467985_fix'\n  tag 'documentable'\n  tag legacy: ['SV-7438', 'V-7055']\n  tag cci: ['CCI-000185']\n  tag nist: ['IA-5 (2) (b) (1)']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225223.rb"},"title":"Digital signatures assigned to strongly named assemblies must be verified.","desc":"A strong name consists of the assembly's identity, simple text name, version number, and culture information (if provided)—plus a public key and a digital signature.  Strong names serve to identify the author of the code.  If digital signatures used to sign strong name assemblies are not verified, any self signed code can be impersonated.  This can lead to a loss of system integrity.","descriptions":{"default":"A strong name consists of the assembly's identity, simple text name, version number, and culture information (if provided)—plus a public key and a digital signature.  Strong names serve to identify the author of the code.  If digital signatures used to sign strong name assemblies are not verified, any self signed code can be impersonated.  This can lead to a loss of system integrity.","check":"Use regedit to review the Windows registry key \nHKLM\\Software\\Microsoft\\StrongName\\Verification. \nThere should be no assemblies or hash values listed under this registry key. If the StrongName\\Verification key does not exist, this is not a finding.\n\nIf there are assemblies or hash values listed in this key, each value represents a distinct application assembly that does not have the application strong name verified.  \n\nIf any assemblies are listed as omitting strong name verification in a production environment, this is a finding.\n\nIf any assemblies are listed as omitting strong name verification in a development or test environment and the IAO has not provided documented approvals, this is a finding.","fix":"Use regedit to remove the values stored in Windows registry key HKLM\\Software\\Microsoft\\StrongName\\Verification. There should be no assemblies or hash values listed under this registry key.\n\nAll assemblies must require strong name verification in a production environment.\n\nStrong name assemblies that do not require verification in a development or test environment must have documented approvals from the IAO."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26922r467984_chk","severity":"medium","gid":"V-225223","rid":"SV-225223r615940_rule","stig_id":"APPNET0031","gtitle":"SRG-APP-000175","fix_id":"F-26910r467985_fix","documentable":null,"legacy":["SV-7438","V-7055"],"cci":["CCI-000185"],"nist":["IA-5 (2) (b) (1)"]}},{"id":"SV-225224","code":"control 'SV-225224' do\n  title 'The Trust Providers Software Publishing State must be set to 0x23C00.'\n  desc 'Microsoft Windows operating systems provide a feature called Authenticode.  Authenticode technology and its underlying code signing mechanisms serve to provide a structure to identify software publishers and ensure that software applications have not been tampered with.  Authenticode technology relies on digital certificates and is based on Public Key Cryptography Standards (PKCS) #7 (encrypted key specification), PKCS #10 (certificate request formats), X.509 (certificate specification), and Secure Hash Algorithm (SHA) and MD5 hash algorithms.\n\nThe manner in which the Authenticode technology validates a certificate and determines what is considered a valid certificate can be modified to meet the mission of the Microsoft Windows system.  Each facade of certificate validation is controlled through the bits that makeup the hexadecimal value for the Authenticode setting.  An improper setting will allow non-valid certificates to be accepted and can put the integrity of the system into jeopardy.\n\nThe hexadecimal value of 0x23C00 will implement the following certificate enforcement policy:\n- Trust the Test Root = FALSE\n- Use expiration date on certificates = TRUE\n- Check the revocation list = TRUE\n- Offline revocation server OK (Individual) = TRUE\n- Offline revocation server OK (Commercial) = TRUE\n- Java offline revocation server OK (Individual) = TRUE\n- Java offline revocation server OK (Commercial) = TRUE\n- Invalidate version 1 signed objects = FALSE\n- Check the revocation list on Time Stamp Signer = FALSE\n- Only trust items found in the Trust DB = FALSE'\n  desc 'check', 'If the system or application being reviewed is SIPR based, this finding is NA.\n\nThis check must be performed for each user on the system. \n\nUse regedit to locate \"HKEY_USER\\\\[UNIQUE USER SID VALUE]\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WinTrust\\\\Trust Providers\\\\Software Publishing\\\\State\".  \n\nIf the State value for any user is not set to the hexadecimal value of 0x23C00, this is a finding.'\n  desc 'fix', 'This fix must be performed for each user on the system.\n\nUsing regedit, change the hexadecimal value of the \"HKEY_USER\\\\[UNIQUE USER SID VALUE]\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\WinTrust\\\\Trust Providers\\\\Software Publishing\\\\State\" registry key to 0x23C00.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26923r467987_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225224'\n  tag rid: 'SV-225224r615940_rule'\n  tag stig_id: 'APPNET0046'\n  tag gtitle: 'SRG-APP-000175'\n  tag fix_id: 'F-26911r467988_fix'\n  tag 'documentable'\n  tag legacy: ['SV-7444', 'V-7061']\n  tag cci: ['CCI-000185']\n  tag nist: ['IA-5 (2) (b) (1)']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225224.rb"},"title":"The Trust Providers Software Publishing State must be set to 0x23C00.","desc":"Microsoft Windows operating systems provide a feature called Authenticode.  Authenticode technology and its underlying code signing mechanisms serve to provide a structure to identify software publishers and ensure that software applications have not been tampered with.  Authenticode technology relies on digital certificates and is based on Public Key Cryptography Standards (PKCS) #7 (encrypted key specification), PKCS #10 (certificate request formats), X.509 (certificate specification), and Secure Hash Algorithm (SHA) and MD5 hash algorithms.\n\nThe manner in which the Authenticode technology validates a certificate and determines what is considered a valid certificate can be modified to meet the mission of the Microsoft Windows system.  Each facade of certificate validation is controlled through the bits that makeup the hexadecimal value for the Authenticode setting.  An improper setting will allow non-valid certificates to be accepted and can put the integrity of the system into jeopardy.\n\nThe hexadecimal value of 0x23C00 will implement the following certificate enforcement policy:\n- Trust the Test Root = FALSE\n- Use expiration date on certificates = TRUE\n- Check the revocation list = TRUE\n- Offline revocation server OK (Individual) = TRUE\n- Offline revocation server OK (Commercial) = TRUE\n- Java offline revocation server OK (Individual) = TRUE\n- Java offline revocation server OK (Commercial) = TRUE\n- Invalidate version 1 signed objects = FALSE\n- Check the revocation list on Time Stamp Signer = FALSE\n- Only trust items found in the Trust DB = FALSE","descriptions":{"default":"Microsoft Windows operating systems provide a feature called Authenticode.  Authenticode technology and its underlying code signing mechanisms serve to provide a structure to identify software publishers and ensure that software applications have not been tampered with.  Authenticode technology relies on digital certificates and is based on Public Key Cryptography Standards (PKCS) #7 (encrypted key specification), PKCS #10 (certificate request formats), X.509 (certificate specification), and Secure Hash Algorithm (SHA) and MD5 hash algorithms.\n\nThe manner in which the Authenticode technology validates a certificate and determines what is considered a valid certificate can be modified to meet the mission of the Microsoft Windows system.  Each facade of certificate validation is controlled through the bits that makeup the hexadecimal value for the Authenticode setting.  An improper setting will allow non-valid certificates to be accepted and can put the integrity of the system into jeopardy.\n\nThe hexadecimal value of 0x23C00 will implement the following certificate enforcement policy:\n- Trust the Test Root = FALSE\n- Use expiration date on certificates = TRUE\n- Check the revocation list = TRUE\n- Offline revocation server OK (Individual) = TRUE\n- Offline revocation server OK (Commercial) = TRUE\n- Java offline revocation server OK (Individual) = TRUE\n- Java offline revocation server OK (Commercial) = TRUE\n- Invalidate version 1 signed objects = FALSE\n- Check the revocation list on Time Stamp Signer = FALSE\n- Only trust items found in the Trust DB = FALSE","check":"If the system or application being reviewed is SIPR based, this finding is NA.\n\nThis check must be performed for each user on the system. \n\nUse regedit to locate \"HKEY_USER\\[UNIQUE USER SID VALUE]\\Software\\Microsoft\\Windows\\CurrentVersion\\WinTrust\\Trust Providers\\Software Publishing\\State\".  \n\nIf the State value for any user is not set to the hexadecimal value of 0x23C00, this is a finding.","fix":"This fix must be performed for each user on the system.\n\nUsing regedit, change the hexadecimal value of the \"HKEY_USER\\[UNIQUE USER SID VALUE]\\Software\\Microsoft\\Windows\\CurrentVersion\\WinTrust\\Trust Providers\\Software Publishing\\State\" registry key to 0x23C00."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26923r467987_chk","severity":"medium","gid":"V-225224","rid":"SV-225224r615940_rule","stig_id":"APPNET0046","gtitle":"SRG-APP-000175","fix_id":"F-26911r467988_fix","documentable":null,"legacy":["SV-7444","V-7061"],"cci":["CCI-000185"],"nist":["IA-5 (2) (b) (1)"]}},{"id":"SV-225225","code":"control 'SV-225225' do\n  title 'Developer certificates used with the .NET Publisher Membership Condition must be approved by the IAO.'\n  desc 'A .Net assembly will satisfy the Publisher Membership Condition if it is signed with a software publisher’s Authenticode X.509v3 digital certificate that can be verified by the Windows operating system as having a chain of trust that leads to a trusted root certificate stored in the user’s certificate store. The  Publisher Membership Condition can be used to identify an organization, developer, vendor, or other entity as the ultimate source of the assembly, even if the code itself was obtained from a third party, such as a mirror site.  Access to system resources, such as file systems or printers, may then be granted to the assembly based on the trust relationship with the identified entity.\n\nCertificates used to sign assemblies so the Publisher Member Condition may be applied must originate from a trusted source.  Using a certificate that is not from a trusted source could potentially violate  system integrity and confidentiality.'\n  desc 'check', \"Caspol.exe is a Microsoft tool used for working with .Net policy.  Use caspol.exe to list the code groups and any publisher membership conditions.\n\nThe location of the caspol utility is dependent upon the system architecture of the system running .Net. \n\nFor 32 bit systems, caspol.exe is located at %SYSTEMROOT%\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319.\n \nFor 64 bit systems, caspol.exe is located at %SYSTEMROOT%\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319.  \n\nExample:\n\ncd %SYSTEMROOT%\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\n\nTo check code groups for the machine, run the following command.\n\ncaspol.exe -m -lg\n\nSample Results:\nMicrosoft (R) .NET Framework CasPol 4.0.30319.1\nCopyright (c) Microsoft Corporation.  All rights reserved.\n\nPolicy change prompt is ON\n\nLevel = Machine\n\nCode Groups:\n\n1.  All code: Nothing\n   1.1.  Zone - MyComputer: FullTrust (LevelFinal)\n      1.1.1.  StrongName - 002400000480000094000000060200000024000052534131000400000100010007D1FA57C4AED9F0A32E84AA0FAEFD0DE9E8FD6AEC8F87FB03766C834C99921EB23BE79AD9D5DCC1DD9AD236132102900B723CF980957FC4E177108FC607774F29E8320E92EA05ECE4E821C0A5EFE8F1645C4C0C93C1AB99285D622CAA652C1DFAD63D745D6F2DE5F17E5EAF0FC4963D261C8A12436518206DC093344D5AD293: FullTrust\n      1.1.2.  StrongName - 00000000000000000400000000000000: FullTrust\n   1.2.  Zone - Intranet: LocalIntranet\n      1.2.1.  All code: Same site Web\n      1.2.2.  All code: Same directory FileIO - 'Read, PathDiscovery'\n   1.3.  Zone - Internet: Internet\n      1.3.1.  All code: Same site Web\n   1.4.  Zone - Untrusted: Nothing\n   1.5.  (First Match) Zone - Trusted: Internet\n      1.5.1.  All code: Same site Web\n   1.6.  Publisher - 30818902818100E47B359ACC061D70C237B572FA276C9854CFABD469DFB74E77D026630BEE2A0C2F8170A823AE69FDEB65704D7FD446DEFEF1F6BA12B6ACBDB1BFA7B9B595AB9A40636467CFF7C73F198B53A9A7CF177F6E7896EBC591DD3003C5992A266C0AD9FBEE4E2A056BE7F7ED154D806F7965F83B0AED616C192C6416CFCB46FC2F5CFD0203010001: FullTrust\nSuccess\n\nSection 1.6 above indicates the presence of a publishers key that meets the Publishers Membership Condition and is also given full trust. \n\nIf the Publisher Membership Condition is used on a non-default Code Group and the use of that publisher's certificate is not documented and approved by the IAO, this is a finding.\"\n  desc 'fix', \"Trust must be established when utilizing Publishers Membership Condition.  All publishers' certificates must have documented approvals from the IAO.\"\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26924r467990_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225225'\n  tag rid: 'SV-225225r615940_rule'\n  tag stig_id: 'APPNET0048'\n  tag gtitle: 'SRG-APP-000175'\n  tag fix_id: 'F-26912r467991_fix'\n  tag 'documentable'\n  tag legacy: ['SV-7446', 'V-7063']\n  tag cci: ['CCI-000185']\n  tag nist: ['IA-5 (2) (b) (1)']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225225.rb"},"title":"Developer certificates used with the .NET Publisher Membership Condition must be approved by the IAO.","desc":"A .Net assembly will satisfy the Publisher Membership Condition if it is signed with a software publisher’s Authenticode X.509v3 digital certificate that can be verified by the Windows operating system as having a chain of trust that leads to a trusted root certificate stored in the user’s certificate store. The  Publisher Membership Condition can be used to identify an organization, developer, vendor, or other entity as the ultimate source of the assembly, even if the code itself was obtained from a third party, such as a mirror site.  Access to system resources, such as file systems or printers, may then be granted to the assembly based on the trust relationship with the identified entity.\n\nCertificates used to sign assemblies so the Publisher Member Condition may be applied must originate from a trusted source.  Using a certificate that is not from a trusted source could potentially violate  system integrity and confidentiality.","descriptions":{"default":"A .Net assembly will satisfy the Publisher Membership Condition if it is signed with a software publisher’s Authenticode X.509v3 digital certificate that can be verified by the Windows operating system as having a chain of trust that leads to a trusted root certificate stored in the user’s certificate store. The  Publisher Membership Condition can be used to identify an organization, developer, vendor, or other entity as the ultimate source of the assembly, even if the code itself was obtained from a third party, such as a mirror site.  Access to system resources, such as file systems or printers, may then be granted to the assembly based on the trust relationship with the identified entity.\n\nCertificates used to sign assemblies so the Publisher Member Condition may be applied must originate from a trusted source.  Using a certificate that is not from a trusted source could potentially violate  system integrity and confidentiality.","check":"Caspol.exe is a Microsoft tool used for working with .Net policy.  Use caspol.exe to list the code groups and any publisher membership conditions.\n\nThe location of the caspol utility is dependent upon the system architecture of the system running .Net. \n\nFor 32 bit systems, caspol.exe is located at %SYSTEMROOT%\\Microsoft.NET\\Framework\\v4.0.30319.\n \nFor 64 bit systems, caspol.exe is located at %SYSTEMROOT%\\Microsoft.NET\\Framework64\\v4.0.30319.  \n\nExample:\n\ncd %SYSTEMROOT%\\Microsoft.NET\\Framework\\v4.0.30319\n\nTo check code groups for the machine, run the following command.\n\ncaspol.exe -m -lg\n\nSample Results:\nMicrosoft (R) .NET Framework CasPol 4.0.30319.1\nCopyright (c) Microsoft Corporation.  All rights reserved.\n\nPolicy change prompt is ON\n\nLevel = Machine\n\nCode Groups:\n\n1.  All code: Nothing\n   1.1.  Zone - MyComputer: FullTrust (LevelFinal)\n      1.1.1.  StrongName - 002400000480000094000000060200000024000052534131000400000100010007D1FA57C4AED9F0A32E84AA0FAEFD0DE9E8FD6AEC8F87FB03766C834C99921EB23BE79AD9D5DCC1DD9AD236132102900B723CF980957FC4E177108FC607774F29E8320E92EA05ECE4E821C0A5EFE8F1645C4C0C93C1AB99285D622CAA652C1DFAD63D745D6F2DE5F17E5EAF0FC4963D261C8A12436518206DC093344D5AD293: FullTrust\n      1.1.2.  StrongName - 00000000000000000400000000000000: FullTrust\n   1.2.  Zone - Intranet: LocalIntranet\n      1.2.1.  All code: Same site Web\n      1.2.2.  All code: Same directory FileIO - 'Read, PathDiscovery'\n   1.3.  Zone - Internet: Internet\n      1.3.1.  All code: Same site Web\n   1.4.  Zone - Untrusted: Nothing\n   1.5.  (First Match) Zone - Trusted: Internet\n      1.5.1.  All code: Same site Web\n   1.6.  Publisher - 30818902818100E47B359ACC061D70C237B572FA276C9854CFABD469DFB74E77D026630BEE2A0C2F8170A823AE69FDEB65704D7FD446DEFEF1F6BA12B6ACBDB1BFA7B9B595AB9A40636467CFF7C73F198B53A9A7CF177F6E7896EBC591DD3003C5992A266C0AD9FBEE4E2A056BE7F7ED154D806F7965F83B0AED616C192C6416CFCB46FC2F5CFD0203010001: FullTrust\nSuccess\n\nSection 1.6 above indicates the presence of a publishers key that meets the Publishers Membership Condition and is also given full trust. \n\nIf the Publisher Membership Condition is used on a non-default Code Group and the use of that publisher's certificate is not documented and approved by the IAO, this is a finding.","fix":"Trust must be established when utilizing Publishers Membership Condition.  All publishers' certificates must have documented approvals from the IAO."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26924r467990_chk","severity":"medium","gid":"V-225225","rid":"SV-225225r615940_rule","stig_id":"APPNET0048","gtitle":"SRG-APP-000175","fix_id":"F-26912r467991_fix","documentable":null,"legacy":["SV-7446","V-7063"],"cci":["CCI-000185"],"nist":["IA-5 (2) (b) (1)"]}},{"id":"SV-225226","code":"control 'SV-225226' do\n  title 'Encryption keys used for the .NET Strong Name Membership Condition must be protected.'\n  desc \"The Strong Name Membership condition requires that member assemblies be defined with Strong Names.  A strong name consists of the assembly's identity, simple text name, version number, and culture information (if provided) — plus a public key and a digital signature.  If assemblies do not have a strong name assigned, the assembly cannot be unique and the author of the code cannot be uniquely identified.  In order to create the strong name, the developer must use a cryptographic key pair to sign the assembly.  If the developer does not protect the key, the key can be stolen and used to sign any application, including malware applications.  This could adversely affect application integrity and confidentiality.\"\n  desc 'check', \"If the application is a COTS product, the requirement is Not Applicable (NA).\n\nCaspol.exe is a Microsoft tool used for working with .Net policy.  Use caspol.exe to list the code groups and any publisher membership conditions.\n\nThe location of the caspol utility is dependent upon the system architecture of the system running .Net. \n\nFor 32 bit systems, caspol.exe is located at %SYSTEMROOT%\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319.\n \nFor 64 bit systems, caspol.exe is located at %SYSTEMROOT%\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319.  \n\nExample:\n\ncd %SYSTEMROOT%\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\n\nTo check code groups, run the following command:\n\ncaspol.exe -all -lg\n\nSample response:\nMicrosoft (R) .NET Framework CasPol 4.0.30319.1\n\nSecurity is ON\nExecution checking is ON\nPolicy change prompt is ON\n\nLevel = Machine\n\nCode Groups:\n\n1.  All code: Nothing\n   1.1.  Zone - MyComputer: FullTrust (LevelFinal)\n      1.1.1.  StrongName - 002400000480000094000000060200000024000052534131000400000100010007D1FA57C4AED9F0A32E84AA0FAEFD0DE9E8FD6AEC8F87FB03766C834C99921EB23BE79AD9D5DCC1DD9AD236132102900B723CF980957FC4E177108FC607774F29E8320E92EA05ECE4E821C0A5EFE8F1645C4C0C93C1AB99285D622CAA652C1DFAD63D745D6F2DE5F17E5EAF0FC4963D261C8A12436518206DC093344D5AD293: FullTrust\n      1.1.2.  StrongName - 00000000000000000400000000000000: FullTrust\n   1.2.  Zone - Intranet: LocalIntranet\n      1.2.1.  All code: Same site Web\n      1.2.2.  All code: Same directory FileIO - 'Read, PathDiscovery'\n   1.3.  Zone - Internet: Internet\n      1.3.1.  All code: Same site Web\n   1.4.  Zone - Untrusted: Nothing\n   1.5.  (First Match) Zone - Trusted: Internet\n      1.5.1.  All code: Same site Web\n   1.6.  Publisher - 30818902818100E47B359ACC061D70C237B572FA276C9854CFABD469DFB74E77D026630BEE2A0C2F8170A823AE69FDEB65704D7FD446DEFEF1F6BA12B6ACBDB1BFA7B9B595AB9A40636467CFF7C73F198B53A9A7CF177F6E7896EBC591DD3003C5992A266C0AD9FBEE4E2A056BE7F7ED154D806F7965F83B0AED616C192C6416CFCB46FC2F5CFD0203010001: FullTrust\nSuccess\n\nAn assembly will satisfy the StrongName Membership Condition if its metadata contains the strongly identifying data associated with the specified strong name. At the least, this means it has been digitally signed with the private key associated with the public key recorded in the policy.\n\nThe presence of the encryption key values in the StrongName field indicates the use of StrongName Membership Condition. \n\nIf a Strong Name Membership Condition is assigned to a non-default Code Group the private key must be adequately protected by the software developer or the entity responsible for signing the assemblies. \n\nAsk the Systems Programmer how the private keys are protected. \n\nPrivate keys are simply values stored as strings of data.  Keys can be stored in files on the file system or in a centralized data repository. \n\nAdequate protection methods include, but are not limited to:\n\n - utilizing centralized key management;\n - using strict file permissions to limit access; and\n - tying strong pass phrases to the key.\n\nIf the private key used to sign the assembly is not adequately protected, this is a finding.\"\n  desc 'fix', 'Ask the Systems Programmer how the private keys used to sign the assembly are protected. \n\nPrivate keys are simply values stored as strings of data.  Keys can be stored in files on the file system or in a centralized data repository. \n\nAdequate protection methods include, but are not limited to:\n\n - utilizing centralized key management;\n - using strict file permissions to limit access; and\n - tying strong pass phrases to the key.\n\nThe private key(s) used to sign the assembly must be protected.  Utilize centralized key management or strict file permissions along with strong pass phrases and/or other well established industry practices for managing and controlling access to private keys.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26925r467993_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225226'\n  tag rid: 'SV-225226r615940_rule'\n  tag stig_id: 'APPNET0052'\n  tag gtitle: 'SRG-APP-000176'\n  tag fix_id: 'F-26913r467994_fix'\n  tag 'documentable'\n  tag legacy: ['SV-7450', 'V-7067']\n  tag cci: ['CCI-000186']\n  tag nist: ['IA-5 (2) (a) (1)']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225226.rb"},"title":"Encryption keys used for the .NET Strong Name Membership Condition must be protected.","desc":"The Strong Name Membership condition requires that member assemblies be defined with Strong Names.  A strong name consists of the assembly's identity, simple text name, version number, and culture information (if provided) — plus a public key and a digital signature.  If assemblies do not have a strong name assigned, the assembly cannot be unique and the author of the code cannot be uniquely identified.  In order to create the strong name, the developer must use a cryptographic key pair to sign the assembly.  If the developer does not protect the key, the key can be stolen and used to sign any application, including malware applications.  This could adversely affect application integrity and confidentiality.","descriptions":{"default":"The Strong Name Membership condition requires that member assemblies be defined with Strong Names.  A strong name consists of the assembly's identity, simple text name, version number, and culture information (if provided) — plus a public key and a digital signature.  If assemblies do not have a strong name assigned, the assembly cannot be unique and the author of the code cannot be uniquely identified.  In order to create the strong name, the developer must use a cryptographic key pair to sign the assembly.  If the developer does not protect the key, the key can be stolen and used to sign any application, including malware applications.  This could adversely affect application integrity and confidentiality.","check":"If the application is a COTS product, the requirement is Not Applicable (NA).\n\nCaspol.exe is a Microsoft tool used for working with .Net policy.  Use caspol.exe to list the code groups and any publisher membership conditions.\n\nThe location of the caspol utility is dependent upon the system architecture of the system running .Net. \n\nFor 32 bit systems, caspol.exe is located at %SYSTEMROOT%\\Microsoft.NET\\Framework\\v4.0.30319.\n \nFor 64 bit systems, caspol.exe is located at %SYSTEMROOT%\\Microsoft.NET\\Framework64\\v4.0.30319.  \n\nExample:\n\ncd %SYSTEMROOT%\\Microsoft.NET\\Framework\\v4.0.30319\n\nTo check code groups, run the following command:\n\ncaspol.exe -all -lg\n\nSample response:\nMicrosoft (R) .NET Framework CasPol 4.0.30319.1\n\nSecurity is ON\nExecution checking is ON\nPolicy change prompt is ON\n\nLevel = Machine\n\nCode Groups:\n\n1.  All code: Nothing\n   1.1.  Zone - MyComputer: FullTrust (LevelFinal)\n      1.1.1.  StrongName - 002400000480000094000000060200000024000052534131000400000100010007D1FA57C4AED9F0A32E84AA0FAEFD0DE9E8FD6AEC8F87FB03766C834C99921EB23BE79AD9D5DCC1DD9AD236132102900B723CF980957FC4E177108FC607774F29E8320E92EA05ECE4E821C0A5EFE8F1645C4C0C93C1AB99285D622CAA652C1DFAD63D745D6F2DE5F17E5EAF0FC4963D261C8A12436518206DC093344D5AD293: FullTrust\n      1.1.2.  StrongName - 00000000000000000400000000000000: FullTrust\n   1.2.  Zone - Intranet: LocalIntranet\n      1.2.1.  All code: Same site Web\n      1.2.2.  All code: Same directory FileIO - 'Read, PathDiscovery'\n   1.3.  Zone - Internet: Internet\n      1.3.1.  All code: Same site Web\n   1.4.  Zone - Untrusted: Nothing\n   1.5.  (First Match) Zone - Trusted: Internet\n      1.5.1.  All code: Same site Web\n   1.6.  Publisher - 30818902818100E47B359ACC061D70C237B572FA276C9854CFABD469DFB74E77D026630BEE2A0C2F8170A823AE69FDEB65704D7FD446DEFEF1F6BA12B6ACBDB1BFA7B9B595AB9A40636467CFF7C73F198B53A9A7CF177F6E7896EBC591DD3003C5992A266C0AD9FBEE4E2A056BE7F7ED154D806F7965F83B0AED616C192C6416CFCB46FC2F5CFD0203010001: FullTrust\nSuccess\n\nAn assembly will satisfy the StrongName Membership Condition if its metadata contains the strongly identifying data associated with the specified strong name. At the least, this means it has been digitally signed with the private key associated with the public key recorded in the policy.\n\nThe presence of the encryption key values in the StrongName field indicates the use of StrongName Membership Condition. \n\nIf a Strong Name Membership Condition is assigned to a non-default Code Group the private key must be adequately protected by the software developer or the entity responsible for signing the assemblies. \n\nAsk the Systems Programmer how the private keys are protected. \n\nPrivate keys are simply values stored as strings of data.  Keys can be stored in files on the file system or in a centralized data repository. \n\nAdequate protection methods include, but are not limited to:\n\n - utilizing centralized key management;\n - using strict file permissions to limit access; and\n - tying strong pass phrases to the key.\n\nIf the private key used to sign the assembly is not adequately protected, this is a finding.","fix":"Ask the Systems Programmer how the private keys used to sign the assembly are protected. \n\nPrivate keys are simply values stored as strings of data.  Keys can be stored in files on the file system or in a centralized data repository. \n\nAdequate protection methods include, but are not limited to:\n\n - utilizing centralized key management;\n - using strict file permissions to limit access; and\n - tying strong pass phrases to the key.\n\nThe private key(s) used to sign the assembly must be protected.  Utilize centralized key management or strict file permissions along with strong pass phrases and/or other well established industry practices for managing and controlling access to private keys."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26925r467993_chk","severity":"medium","gid":"V-225226","rid":"SV-225226r615940_rule","stig_id":"APPNET0052","gtitle":"SRG-APP-000176","fix_id":"F-26913r467994_fix","documentable":null,"legacy":["SV-7450","V-7067"],"cci":["CCI-000186"],"nist":["IA-5 (2) (a) (1)"]}},{"id":"SV-225227","code":"control 'SV-225227' do\n  title 'CAS and policy configuration files must be backed up.'\n  desc 'A successful disaster recovery plan requires that CAS policy and CAS policy configuration files are identified and included in systems disaster backup and recovery events.  Documentation regarding the location of system and application specific CAS policy configuration files and the frequency in which backups occur is required.  If these files are not identified and the information is not documented, there is the potential that critical application configuration files may not be included in disaster recovery events which could lead to an availability risk.'\n  desc 'check', 'Ask the System Administrator if all CAS policy and policy configuration files are included in the system backup. If they are not, this is a finding.\n\nAsk the System Administrator if the policy and configuration files are backed up prior to migration, deployment, and reconfiguration. If they are not, this is a finding.\n\nAsk the System Administrator for documentation that shows CAS Policy configuration files are backed up as part of a disaster recovery plan. If they have no documentation proving the files are backed up, this is a finding.'\n  desc 'fix', 'All CAS policy and policy configuration files must be included in the system backup. \n\nAll CAS policy and policy configuration files must be backed up prior to migration, deployment, and reconfiguration.\n\nCAS policy configuration files must be included in disaster recovery plan documentation.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26926r467996_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225227'\n  tag rid: 'SV-225227r615940_rule'\n  tag stig_id: 'APPNET0055'\n  tag gtitle: 'SRG-APP-000120'\n  tag fix_id: 'F-26914r467997_fix'\n  tag 'documentable'\n  tag legacy: ['SV-7452', 'V-7069']\n  tag cci: ['CCI-000164']\n  tag nist: ['AU-9 a']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225227.rb"},"title":"CAS and policy configuration files must be backed up.","desc":"A successful disaster recovery plan requires that CAS policy and CAS policy configuration files are identified and included in systems disaster backup and recovery events.  Documentation regarding the location of system and application specific CAS policy configuration files and the frequency in which backups occur is required.  If these files are not identified and the information is not documented, there is the potential that critical application configuration files may not be included in disaster recovery events which could lead to an availability risk.","descriptions":{"default":"A successful disaster recovery plan requires that CAS policy and CAS policy configuration files are identified and included in systems disaster backup and recovery events.  Documentation regarding the location of system and application specific CAS policy configuration files and the frequency in which backups occur is required.  If these files are not identified and the information is not documented, there is the potential that critical application configuration files may not be included in disaster recovery events which could lead to an availability risk.","check":"Ask the System Administrator if all CAS policy and policy configuration files are included in the system backup. If they are not, this is a finding.\n\nAsk the System Administrator if the policy and configuration files are backed up prior to migration, deployment, and reconfiguration. If they are not, this is a finding.\n\nAsk the System Administrator for documentation that shows CAS Policy configuration files are backed up as part of a disaster recovery plan. If they have no documentation proving the files are backed up, this is a finding.","fix":"All CAS policy and policy configuration files must be included in the system backup. \n\nAll CAS policy and policy configuration files must be backed up prior to migration, deployment, and reconfiguration.\n\nCAS policy configuration files must be included in disaster recovery plan documentation."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26926r467996_chk","severity":"medium","gid":"V-225227","rid":"SV-225227r615940_rule","stig_id":"APPNET0055","gtitle":"SRG-APP-000120","fix_id":"F-26914r467997_fix","documentable":null,"legacy":["SV-7452","V-7069"],"cci":["CCI-000164"],"nist":["AU-9 a"]}},{"id":"SV-225228","code":"control 'SV-225228' do\n  title 'Remoting Services HTTP channels must utilize authentication and encryption.'\n  desc 'Note: Microsoft recommends using the Windows Communication Framework (WCF) rather than using .Net remoting. New development projects should refrain from using .Net remoting capabilities whenever possible.\n\n.NET remoting provides the capability to build widely distributed applications. The application components may reside all on one computer or they may be spread out across the enclave. .NET client applications can make remoting calls to use objects in other processes on the same computer or on any other computer that is reachable over the network. .NET remoting can also be used to communicate with other application domains within the same process.  Remoting is achieved via the exposure of endpoints that can be used to establish remote connectivity.\n\nNormally when application code attempts to access a protected resource, a stack walk is performed to ensure that all stack frames have permission to access the resource. However, with .Net 4.0, when a call is made on a remote object, this stack walk is not performed across the remoting boundary. The .Net remoting infrastructure requires FullTrust permission to execute on either the client or the server. \n\nDue to the fact that FullTrust permission is required, Remoting endpoints should be authenticated and encrypted in order to protect the system and the data. \n\nMicrosoft provides 3 different \"channels\" that are used for remoting.  They are HTTP, TCP and IPC.\n\nAny unauthorized use of a remoting application provides unauthorized access with FullTrust permissions to the system. This can potentially result in a loss of system integrity or confidentiality.'\n  desc 'check', 'Review the machine.config file and the [application name].exe.config file.\n\nFor 32 bit systems, the \"machine.config\" file is contained in the following folder. %SYSTEMROOT%\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\\\\Config \n\nFor 64 bit systems, the \"machine.config\" file is contained in the following folder. %SYSTEMROOT%\\\\Microsoft.NET\\\\Framework64\\\\v4.0.30319\\\\Config.\n\nMicrosoft specifies locating the [application].config file in the same folder as the application executable (.exe) file. However, the developer does have the capability to specify a different location when the application is compiled.  Therefore, if the file is not found in the application home folder, a search of the system is required. If the [application name].exe.config file is not found on the system, then only a check of the machine.config file is required.\n\nSample machine/application config file:\n\n<application name=“remoteserver”> \n  <service> \n    <activated type=“sample.my.object, myobjects”/> \n  </service> \n  <channels> \n    <channel ref=“http server” port=“80”/> \n  </channels> \n</application>\n\n<serverProviders>\n  <provider ref=\"wsdl\" />\n  <formatter ref=\"soap\" typeFilterLevel=\"Low\" /> \n  <formatter ref=\"binary\" typeFilterLevel=\"Low\" /> \n</serverProviders> \n\nMicrosoft provides 3 \"channels\" that are used for remoting connectivity.  They are the HTTP, TCP and IPC channels.  The channel that is used is specified via the <channels> element in the config file.  \n\nHTTP channel example:\n<channel ref=“http server” port=“80”/> \n\nThe HTTP Channel only supports encryption and message integrity when the remote object is hosted in Internet Information Services (IIS) using TLS.\n\nThe above example shows the well known TLS port of 443 is not being used. \n\nIf the HTTP remoting channel is not configured to protect the channel by using TLS encryption, this is a finding.'\n  desc 'fix', 'Ensure encryption and message integrity are used for HTTP remoting channels.\n\nThe HTTP Channel only supports encryption and message integrity when the remote object is hosted in Internet Information Services (IIS) using TLS.\n\nHTTP channels are protected via TLS (HTTPS). \n<channels> \n   <channel ref=“http server” port=“443”/> \n</channels> \n\nChange the channel ref parameter to utilize a TLS port and leverage TLS on the remote IIS server.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26927r467999_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225228'\n  tag rid: 'SV-225228r615940_rule'\n  tag stig_id: 'APPNET0060'\n  tag gtitle: 'SRG-APP-000219'\n  tag fix_id: 'F-26915r468000_fix'\n  tag 'documentable'\n  tag legacy: ['SV-7453', 'V-7070']\n  tag cci: ['CCI-001184']\n  tag nist: ['SC-23']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225228.rb"},"title":"Remoting Services HTTP channels must utilize authentication and encryption.","desc":"Note: Microsoft recommends using the Windows Communication Framework (WCF) rather than using .Net remoting. New development projects should refrain from using .Net remoting capabilities whenever possible.\n\n.NET remoting provides the capability to build widely distributed applications. The application components may reside all on one computer or they may be spread out across the enclave. .NET client applications can make remoting calls to use objects in other processes on the same computer or on any other computer that is reachable over the network. .NET remoting can also be used to communicate with other application domains within the same process.  Remoting is achieved via the exposure of endpoints that can be used to establish remote connectivity.\n\nNormally when application code attempts to access a protected resource, a stack walk is performed to ensure that all stack frames have permission to access the resource. However, with .Net 4.0, when a call is made on a remote object, this stack walk is not performed across the remoting boundary. The .Net remoting infrastructure requires FullTrust permission to execute on either the client or the server. \n\nDue to the fact that FullTrust permission is required, Remoting endpoints should be authenticated and encrypted in order to protect the system and the data. \n\nMicrosoft provides 3 different \"channels\" that are used for remoting.  They are HTTP, TCP and IPC.\n\nAny unauthorized use of a remoting application provides unauthorized access with FullTrust permissions to the system. This can potentially result in a loss of system integrity or confidentiality.","descriptions":{"default":"Note: Microsoft recommends using the Windows Communication Framework (WCF) rather than using .Net remoting. New development projects should refrain from using .Net remoting capabilities whenever possible.\n\n.NET remoting provides the capability to build widely distributed applications. The application components may reside all on one computer or they may be spread out across the enclave. .NET client applications can make remoting calls to use objects in other processes on the same computer or on any other computer that is reachable over the network. .NET remoting can also be used to communicate with other application domains within the same process.  Remoting is achieved via the exposure of endpoints that can be used to establish remote connectivity.\n\nNormally when application code attempts to access a protected resource, a stack walk is performed to ensure that all stack frames have permission to access the resource. However, with .Net 4.0, when a call is made on a remote object, this stack walk is not performed across the remoting boundary. The .Net remoting infrastructure requires FullTrust permission to execute on either the client or the server. \n\nDue to the fact that FullTrust permission is required, Remoting endpoints should be authenticated and encrypted in order to protect the system and the data. \n\nMicrosoft provides 3 different \"channels\" that are used for remoting.  They are HTTP, TCP and IPC.\n\nAny unauthorized use of a remoting application provides unauthorized access with FullTrust permissions to the system. This can potentially result in a loss of system integrity or confidentiality.","check":"Review the machine.config file and the [application name].exe.config file.\n\nFor 32 bit systems, the \"machine.config\" file is contained in the following folder. %SYSTEMROOT%\\Microsoft.NET\\Framework\\v4.0.30319\\Config \n\nFor 64 bit systems, the \"machine.config\" file is contained in the following folder. %SYSTEMROOT%\\Microsoft.NET\\Framework64\\v4.0.30319\\Config.\n\nMicrosoft specifies locating the [application].config file in the same folder as the application executable (.exe) file. However, the developer does have the capability to specify a different location when the application is compiled.  Therefore, if the file is not found in the application home folder, a search of the system is required. If the [application name].exe.config file is not found on the system, then only a check of the machine.config file is required.\n\nSample machine/application config file:\n\n<application name=“remoteserver”> \n  <service> \n    <activated type=“sample.my.object, myobjects”/> \n  </service> \n  <channels> \n    <channel ref=“http server” port=“80”/> \n  </channels> \n</application>\n\n<serverProviders>\n  <provider ref=\"wsdl\" />\n  <formatter ref=\"soap\" typeFilterLevel=\"Low\" /> \n  <formatter ref=\"binary\" typeFilterLevel=\"Low\" /> \n</serverProviders> \n\nMicrosoft provides 3 \"channels\" that are used for remoting connectivity.  They are the HTTP, TCP and IPC channels.  The channel that is used is specified via the <channels> element in the config file.  \n\nHTTP channel example:\n<channel ref=“http server” port=“80”/> \n\nThe HTTP Channel only supports encryption and message integrity when the remote object is hosted in Internet Information Services (IIS) using TLS.\n\nThe above example shows the well known TLS port of 443 is not being used. \n\nIf the HTTP remoting channel is not configured to protect the channel by using TLS encryption, this is a finding.","fix":"Ensure encryption and message integrity are used for HTTP remoting channels.\n\nThe HTTP Channel only supports encryption and message integrity when the remote object is hosted in Internet Information Services (IIS) using TLS.\n\nHTTP channels are protected via TLS (HTTPS). \n<channels> \n   <channel ref=“http server” port=“443”/> \n</channels> \n\nChange the channel ref parameter to utilize a TLS port and leverage TLS on the remote IIS server."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26927r467999_chk","severity":"medium","gid":"V-225228","rid":"SV-225228r615940_rule","stig_id":"APPNET0060","gtitle":"SRG-APP-000219","fix_id":"F-26915r468000_fix","documentable":null,"legacy":["SV-7453","V-7070"],"cci":["CCI-001184"],"nist":["SC-23"]}},{"id":"SV-225229","code":"control 'SV-225229' do\n  title '.Net Framework versions installed on the system must be supported.'\n  desc 'Unsupported software introduces risks and violates DoD policy.  Applications utilizing unsupported versions of .NET introduce substantial risk to the host, network, and the enclave by virtue of the fact they leverage an architecture that is no longer updated by the vendor.  This introduces potential application integrity, availability, or confidentiality issues.'\n  desc 'check', 'Determine which versions of the .NET Framework are installed by opening the directory %systemroot%\\\\Microsoft.NET.\n\nThe folder named \"%systemroot%\\\\Microsoft.NET\\\\Framework\" contains .NET files for 32 bit systems.  The folder named \"%systemroot%\\\\Microsoft.NET\\\\Framework64\" contains .NET files for 64 bit systems. 64 bit systems will have both the 32 bit and the 64 bit folders while 32 bit systems do not have a Framework64 folder.\n\nWithin each of the aforementioned folders are the individual folder names that contain the corresponding versions of the .NET Framework:\n\nv4.0.30319\nv3.5\nv3.0\nv2.0.50727\nv1.1.4322\nv1.0.3705\n\nSearch for all the Mscorlib.dll files in the %systemroot%\\\\Microsoft.NET\\\\Framework folder and the %systemroot%\\\\Microsoft.NET\\\\Framework64 folder if the folder exists. Click on each of the files, view properties, and click version tab to determine the version installed.  If there is no Mscorlib.dll, there is no installed version of .Net Framework in that directory.\n\nMore specific information on determining versions of .Net Framework installed can be found at the following link. http://support.microsoft.com/kb/318785\n\nVerify extended support is available for the installed versions of .Net Framework.\n\nVerify the .Net Framework support dates with Microsoft Product Lifecycle Search link.\nhttp://support.microsoft.com/lifecycle/search/?sort=PN&alpha=.NET+Framework\n\nBeginning with .NET 3.5 SP1, the .NET Framework is considered a Component of the Windows OS. Components follow the Support Lifecycle policy of their parent product or platform.\n \nIf any versions of the .Net Framework are installed and support is no longer available, this is a finding.'\n  desc 'fix', 'Remove unsupported versions of the .NET Framework and upgrade legacy applications that utilize unsupported versions of the .NET framework.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26928r468002_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225229'\n  tag rid: 'SV-225229r615940_rule'\n  tag stig_id: 'APPNET0061'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-26916r468003_fix'\n  tag 'documentable'\n  tag legacy: ['SV-55642', 'V-18395']\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225229.rb"},"title":".Net Framework versions installed on the system must be supported.","desc":"Unsupported software introduces risks and violates DoD policy.  Applications utilizing unsupported versions of .NET introduce substantial risk to the host, network, and the enclave by virtue of the fact they leverage an architecture that is no longer updated by the vendor.  This introduces potential application integrity, availability, or confidentiality issues.","descriptions":{"default":"Unsupported software introduces risks and violates DoD policy.  Applications utilizing unsupported versions of .NET introduce substantial risk to the host, network, and the enclave by virtue of the fact they leverage an architecture that is no longer updated by the vendor.  This introduces potential application integrity, availability, or confidentiality issues.","check":"Determine which versions of the .NET Framework are installed by opening the directory %systemroot%\\Microsoft.NET.\n\nThe folder named \"%systemroot%\\Microsoft.NET\\Framework\" contains .NET files for 32 bit systems.  The folder named \"%systemroot%\\Microsoft.NET\\Framework64\" contains .NET files for 64 bit systems. 64 bit systems will have both the 32 bit and the 64 bit folders while 32 bit systems do not have a Framework64 folder.\n\nWithin each of the aforementioned folders are the individual folder names that contain the corresponding versions of the .NET Framework:\n\nv4.0.30319\nv3.5\nv3.0\nv2.0.50727\nv1.1.4322\nv1.0.3705\n\nSearch for all the Mscorlib.dll files in the %systemroot%\\Microsoft.NET\\Framework folder and the %systemroot%\\Microsoft.NET\\Framework64 folder if the folder exists. Click on each of the files, view properties, and click version tab to determine the version installed.  If there is no Mscorlib.dll, there is no installed version of .Net Framework in that directory.\n\nMore specific information on determining versions of .Net Framework installed can be found at the following link. http://support.microsoft.com/kb/318785\n\nVerify extended support is available for the installed versions of .Net Framework.\n\nVerify the .Net Framework support dates with Microsoft Product Lifecycle Search link.\nhttp://support.microsoft.com/lifecycle/search/?sort=PN&alpha=.NET+Framework\n\nBeginning with .NET 3.5 SP1, the .NET Framework is considered a Component of the Windows OS. Components follow the Support Lifecycle policy of their parent product or platform.\n \nIf any versions of the .Net Framework are installed and support is no longer available, this is a finding.","fix":"Remove unsupported versions of the .NET Framework and upgrade legacy applications that utilize unsupported versions of the .NET framework."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26928r468002_chk","severity":"medium","gid":"V-225229","rid":"SV-225229r615940_rule","stig_id":"APPNET0061","gtitle":"SRG-APP-000516","fix_id":"F-26916r468003_fix","documentable":null,"legacy":["SV-55642","V-18395"],"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-225230","code":"control 'SV-225230' do\n  title 'The .NET CLR must be configured to use FIPS approved encryption modules.'\n  desc '<0> [object Object]'\n  desc 'check', 'Examine the .NET CLR configuration files from the vulnerability discussion to find the runtime element and then the \"enforceFIPSPolicy\" element.\n\nExample:\n<configuration> \n  <runtime> \n                <enforceFIPSPolicy enabled=\"true|false\" />\n  </runtime>\n</configuration>\n\nBy default, the .NET \"enforceFIPSPolicy\" element is set to \"true\".\n\nIf the \"enforceFIPSPolicy\" element does not exist within the \"runtime\" element of the CLR configuration, this is not a finding.\n\nIf the \"enforceFIPSPolicy\" element exists and is set to \"false\", and the IAO has not accepted the risk and documented the risk acceptance, this is a finding.'\n  desc 'fix', 'Examine the .NET CLR configuration files to find the runtime element and then the \"enforceFIPSPolicy\" element.\n\nExample:\n<configuration> \n  <runtime> \n                <enforceFIPSPolicy enabled=\"true|false\" />\n  </runtime>\n</configuration>\n\nDelete the \"enforceFIPSPolicy\" runtime element, change the setting to \"true\" or there must be documented IAO approvals for the FIPS setting.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26929r468005_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225230'\n  tag rid: 'SV-225230r849747_rule'\n  tag stig_id: 'APPNET0062'\n  tag gtitle: 'SRG-APP-000635'\n  tag fix_id: 'F-26917r468006_fix'\n  tag legacy: ['SV-40966', 'V-30926']\n  tag cci: ['CCI-002450']\n  tag nist: ['SC-13 b']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225230.rb"},"title":"The .NET CLR must be configured to use FIPS approved encryption modules.","desc":"<0> [object Object]","descriptions":{"default":"<0> [object Object]","check":"Examine the .NET CLR configuration files from the vulnerability discussion to find the runtime element and then the \"enforceFIPSPolicy\" element.\n\nExample:\n<configuration> \n  <runtime> \n                <enforceFIPSPolicy enabled=\"true|false\" />\n  </runtime>\n</configuration>\n\nBy default, the .NET \"enforceFIPSPolicy\" element is set to \"true\".\n\nIf the \"enforceFIPSPolicy\" element does not exist within the \"runtime\" element of the CLR configuration, this is not a finding.\n\nIf the \"enforceFIPSPolicy\" element exists and is set to \"false\", and the IAO has not accepted the risk and documented the risk acceptance, this is a finding.","fix":"Examine the .NET CLR configuration files to find the runtime element and then the \"enforceFIPSPolicy\" element.\n\nExample:\n<configuration> \n  <runtime> \n                <enforceFIPSPolicy enabled=\"true|false\" />\n  </runtime>\n</configuration>\n\nDelete the \"enforceFIPSPolicy\" runtime element, change the setting to \"true\" or there must be documented IAO approvals for the FIPS setting."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26929r468005_chk","severity":"medium","gid":"V-225230","rid":"SV-225230r849747_rule","stig_id":"APPNET0062","gtitle":"SRG-APP-000635","fix_id":"F-26917r468006_fix","legacy":["SV-40966","V-30926"],"cci":["CCI-002450"],"nist":["SC-13 b"]}},{"id":"SV-225231","code":"control 'SV-225231' do\n  title '.NET must be configured to validate strong names on full-trust assemblies.'\n  desc 'The \"bypassTrustedAppStrongNames\" setting specifies whether the bypass feature that avoids validating strong names for full-trust assemblies is enabled. By default the bypass feature is enabled in .Net 4, therefore strong names are not validated for correctness when the assembly/program is loaded. Not validating strong names provides a faster application load time but at the expense of performing certificate validation. \n\nFull trust assemblies are .Net applications launched from the local host. Strong names are digital signatures tied to .Net applications/assemblies.  .Net 4 considers applications installed locally to be fully trusted by default and grants these applications full permissions to access host resources. \n\nThe bypass feature applies to any assembly signed with a strong name and having the following characteristics:\n\n    Fully trusted without the StrongName evidence (for example, has MyComputer zone evidence).\n\n    Loaded into a fully trusted AppDomain.\n\n    Loaded from a location under the ApplicationBase property of that AppDomain.\n\n    Not delay-signed.\n\nNot validating the certificates used to sign strong name assemblies will provide a faster application load time, but falsely assumes that signatures used to sign the application are to be implicitly trusted.  Not validating strong name certificates introduces an integrity risk to the system.'\n  desc 'check', 'If there is documented ISSO risk acceptance for development systems, this is not a finding.\nFor 32 bit production systems: \nUse regedit to examine the “HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\.NETFramework” key.  \nOn 64-bit production systems:\nUse regedit to examine both the “HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\.NETFramework” and “HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\.NETFramework” keys.\nIf the \"AllowStrongNameBypass\" value does not exist, or if the “DWORD” value is set to “1”, this is a finding.\n\nDocumentation must include a complete list of installed .Net applications, application versions, and acknowledgement that ISSO trusts each installed application.\n\nIf application versions installed on the system do not match approval documentation, this is a finding.'\n  desc 'fix', 'For 32 bit production systems: \nSet “HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\.NETFramework\\\\AllowStrongNameBypass\" to a “DWORD” value of “0”.\nOn 64-bit production systems:\nSet “HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\.NETFramework\\\\ AllowStrongNameBypass” and “HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\.NETFramework\\\\ AllowStrongNameBypass” to a “DWORD” value of “0”.\nOr, obtain documented ISSO risk acceptance for each .Net application installed on the system. \n\nApproval documentation will include complete list of all installed .Net applications, application versions, and acknowledgement of ISSO trust of each installed application.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26930r468008_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225231'\n  tag rid: 'SV-225231r615940_rule'\n  tag stig_id: 'APPNET0063'\n  tag gtitle: 'SRG-APP-000175'\n  tag fix_id: 'F-26918r468009_fix'\n  tag 'documentable'\n  tag legacy: ['SV-40977', 'V-30935']\n  tag cci: ['CCI-000185']\n  tag nist: ['IA-5 (2) (b) (1)']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225231.rb"},"title":".NET must be configured to validate strong names on full-trust assemblies.","desc":"The \"bypassTrustedAppStrongNames\" setting specifies whether the bypass feature that avoids validating strong names for full-trust assemblies is enabled. By default the bypass feature is enabled in .Net 4, therefore strong names are not validated for correctness when the assembly/program is loaded. Not validating strong names provides a faster application load time but at the expense of performing certificate validation. \n\nFull trust assemblies are .Net applications launched from the local host. Strong names are digital signatures tied to .Net applications/assemblies.  .Net 4 considers applications installed locally to be fully trusted by default and grants these applications full permissions to access host resources. \n\nThe bypass feature applies to any assembly signed with a strong name and having the following characteristics:\n\n    Fully trusted without the StrongName evidence (for example, has MyComputer zone evidence).\n\n    Loaded into a fully trusted AppDomain.\n\n    Loaded from a location under the ApplicationBase property of that AppDomain.\n\n    Not delay-signed.\n\nNot validating the certificates used to sign strong name assemblies will provide a faster application load time, but falsely assumes that signatures used to sign the application are to be implicitly trusted.  Not validating strong name certificates introduces an integrity risk to the system.","descriptions":{"default":"The \"bypassTrustedAppStrongNames\" setting specifies whether the bypass feature that avoids validating strong names for full-trust assemblies is enabled. By default the bypass feature is enabled in .Net 4, therefore strong names are not validated for correctness when the assembly/program is loaded. Not validating strong names provides a faster application load time but at the expense of performing certificate validation. \n\nFull trust assemblies are .Net applications launched from the local host. Strong names are digital signatures tied to .Net applications/assemblies.  .Net 4 considers applications installed locally to be fully trusted by default and grants these applications full permissions to access host resources. \n\nThe bypass feature applies to any assembly signed with a strong name and having the following characteristics:\n\n    Fully trusted without the StrongName evidence (for example, has MyComputer zone evidence).\n\n    Loaded into a fully trusted AppDomain.\n\n    Loaded from a location under the ApplicationBase property of that AppDomain.\n\n    Not delay-signed.\n\nNot validating the certificates used to sign strong name assemblies will provide a faster application load time, but falsely assumes that signatures used to sign the application are to be implicitly trusted.  Not validating strong name certificates introduces an integrity risk to the system.","check":"If there is documented ISSO risk acceptance for development systems, this is not a finding.\nFor 32 bit production systems: \nUse regedit to examine the “HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework” key.  \nOn 64-bit production systems:\nUse regedit to examine both the “HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework” and “HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\.NETFramework” keys.\nIf the \"AllowStrongNameBypass\" value does not exist, or if the “DWORD” value is set to “1”, this is a finding.\n\nDocumentation must include a complete list of installed .Net applications, application versions, and acknowledgement that ISSO trusts each installed application.\n\nIf application versions installed on the system do not match approval documentation, this is a finding.","fix":"For 32 bit production systems: \nSet “HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\AllowStrongNameBypass\" to a “DWORD” value of “0”.\nOn 64-bit production systems:\nSet “HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\ AllowStrongNameBypass” and “HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\.NETFramework\\ AllowStrongNameBypass” to a “DWORD” value of “0”.\nOr, obtain documented ISSO risk acceptance for each .Net application installed on the system. \n\nApproval documentation will include complete list of all installed .Net applications, application versions, and acknowledgement of ISSO trust of each installed application."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26930r468008_chk","severity":"medium","gid":"V-225231","rid":"SV-225231r615940_rule","stig_id":"APPNET0063","gtitle":"SRG-APP-000175","fix_id":"F-26918r468009_fix","documentable":null,"legacy":["SV-40977","V-30935"],"cci":["CCI-000185"],"nist":["IA-5 (2) (b) (1)"]}},{"id":"SV-225232","code":"control 'SV-225232' do\n  title '.Net applications that invoke NetFx40_LegacySecurityPolicy must apply previous versions of .NET STIG guidance.'\n  desc 'CAS policy is .NET runtime version-specific.  In .NET Framework version 4, CAS policy is disabled by default however; it can be re-enabled by using the NetFx40_LegacySecurityPolicy setting on a per application basis. Caspol.exe is provided by Microsoft to set security policy on .Net applications prior to version 4.0. This requirement does not apply to the caspol.exe assembly or other assemblies provided with the Windows OS or the Windows Secure Host Baseline (SHB).\n\nWhen invoking the NetFx40_LegacySecurityPolicy setting in .NET 4, earlier versions of the .NET Framework CAS policy will become active therefore previous .NET STIG guidance that applies to the reactivated versions must also be applied. \n\nFailure to apply applicable versions of STIG guidance can result in the loss of system confidentiality, integrity or availability.'\n  desc 'check', 'Open Windows explorer and search for all *.exe.config files.  This requirement does not apply to the caspol.exe assembly or other assemblies provided with the Windows OS or the Windows Secure Host Baseline (SHB).\n\nTo find relevant files, you can run the FINDSTR command from an elevated (admin) command prompt: \nFINDSTR /i /s \"NetFx40_LegacySecurityPolicy\" c:\\\\*.exe.config \nThis command will search all .\"exe.config\" files on the c: drive partition for the \"LegacySecurityPolicy\" setting. Repeat the command for each drive partition on the system.\n\n\nIf the .NET application configuration file utilizes the legacy policy element and .NET STIG guidance that covers these legacy versions has not been applied, this is a finding.'\n  desc 'fix', 'Apply the .NET Framework Security Checklist for .Net versions 1 through 3.5 when utilizing the NetFx40_LegacySecurityPolicy setting.'\n  impact 0.3\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26931r468011_chk'\n  tag severity: 'low'\n  tag gid: 'V-225232'\n  tag rid: 'SV-225232r615940_rule'\n  tag stig_id: 'APPNET0064'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-26919r468012_fix'\n  tag 'documentable'\n  tag legacy: ['SV-40979', 'V-30937']\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225232.rb"},"title":".Net applications that invoke NetFx40_LegacySecurityPolicy must apply previous versions of .NET STIG guidance.","desc":"CAS policy is .NET runtime version-specific.  In .NET Framework version 4, CAS policy is disabled by default however; it can be re-enabled by using the NetFx40_LegacySecurityPolicy setting on a per application basis. Caspol.exe is provided by Microsoft to set security policy on .Net applications prior to version 4.0. This requirement does not apply to the caspol.exe assembly or other assemblies provided with the Windows OS or the Windows Secure Host Baseline (SHB).\n\nWhen invoking the NetFx40_LegacySecurityPolicy setting in .NET 4, earlier versions of the .NET Framework CAS policy will become active therefore previous .NET STIG guidance that applies to the reactivated versions must also be applied. \n\nFailure to apply applicable versions of STIG guidance can result in the loss of system confidentiality, integrity or availability.","descriptions":{"default":"CAS policy is .NET runtime version-specific.  In .NET Framework version 4, CAS policy is disabled by default however; it can be re-enabled by using the NetFx40_LegacySecurityPolicy setting on a per application basis. Caspol.exe is provided by Microsoft to set security policy on .Net applications prior to version 4.0. This requirement does not apply to the caspol.exe assembly or other assemblies provided with the Windows OS or the Windows Secure Host Baseline (SHB).\n\nWhen invoking the NetFx40_LegacySecurityPolicy setting in .NET 4, earlier versions of the .NET Framework CAS policy will become active therefore previous .NET STIG guidance that applies to the reactivated versions must also be applied. \n\nFailure to apply applicable versions of STIG guidance can result in the loss of system confidentiality, integrity or availability.","check":"Open Windows explorer and search for all *.exe.config files.  This requirement does not apply to the caspol.exe assembly or other assemblies provided with the Windows OS or the Windows Secure Host Baseline (SHB).\n\nTo find relevant files, you can run the FINDSTR command from an elevated (admin) command prompt: \nFINDSTR /i /s \"NetFx40_LegacySecurityPolicy\" c:\\*.exe.config \nThis command will search all .\"exe.config\" files on the c: drive partition for the \"LegacySecurityPolicy\" setting. Repeat the command for each drive partition on the system.\n\n\nIf the .NET application configuration file utilizes the legacy policy element and .NET STIG guidance that covers these legacy versions has not been applied, this is a finding.","fix":"Apply the .NET Framework Security Checklist for .Net versions 1 through 3.5 when utilizing the NetFx40_LegacySecurityPolicy setting."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26931r468011_chk","severity":"low","gid":"V-225232","rid":"SV-225232r615940_rule","stig_id":"APPNET0064","gtitle":"SRG-APP-000516","fix_id":"F-26919r468012_fix","documentable":null,"legacy":["SV-40979","V-30937"],"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-225233","code":"control 'SV-225233' do\n  title 'Trust must be established prior to enabling the loading of remote code in .Net 4.'\n  desc '<0> [object Object]'\n  desc 'check', 'Open Windows explorer and search for *.exe.config.\n\nSearch each config file found for the \"loadFromRemoteSources\" element.\n\nIf the loadFromRemoteSources element is enabled  \n(\"loadFromRemoteSources enabled = true\"), and the remotely loaded application is not run in a sandboxed environment, or if OS based software controls, such as AppLocker or Software Security Policies, are not utilized, this is a finding.'\n  desc 'fix', '.Net application code loaded from a remote source must be run in a controlled environment.  \n\nA controlled environment consists of a sandbox, such as running in an Internet Explorer host environment or employing OS based software access controls, such as AppLocker or Software Security Policies, when application design permits.  \n\nObtain documented IAO approvals for all remotely loaded code.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26932r468014_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225233'\n  tag rid: 'SV-225233r849748_rule'\n  tag stig_id: 'APPNET0065'\n  tag gtitle: 'SRG-APP-000431'\n  tag fix_id: 'F-26920r468015_fix'\n  tag legacy: ['SV-41010', 'V-30968']\n  tag cci: ['CCI-002530']\n  tag nist: ['SC-39']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225233.rb"},"title":"Trust must be established prior to enabling the loading of remote code in .Net 4.","desc":"<0> [object Object]","descriptions":{"default":"<0> [object Object]","check":"Open Windows explorer and search for *.exe.config.\n\nSearch each config file found for the \"loadFromRemoteSources\" element.\n\nIf the loadFromRemoteSources element is enabled  \n(\"loadFromRemoteSources enabled = true\"), and the remotely loaded application is not run in a sandboxed environment, or if OS based software controls, such as AppLocker or Software Security Policies, are not utilized, this is a finding.","fix":".Net application code loaded from a remote source must be run in a controlled environment.  \n\nA controlled environment consists of a sandbox, such as running in an Internet Explorer host environment or employing OS based software access controls, such as AppLocker or Software Security Policies, when application design permits.  \n\nObtain documented IAO approvals for all remotely loaded code."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26932r468014_chk","severity":"medium","gid":"V-225233","rid":"SV-225233r849748_rule","stig_id":"APPNET0065","gtitle":"SRG-APP-000431","fix_id":"F-26920r468015_fix","legacy":["SV-41010","V-30968"],"cci":["CCI-002530"],"nist":["SC-39"]}},{"id":"SV-225234","code":"control 'SV-225234' do\n  title '.NET default proxy settings must be reviewed and approved.'\n  desc \"The .Net framework can be configured to utilize a different proxy or altogether bypass the default proxy settings in the client's browser.  This may lead to the framework using a proxy that is not approved for use.  If the proxy is malicious, this could lead to a loss of application integrity and confidentiality.\"\n  desc 'check', 'Open Windows explorer and search for all \"*.exe.config\" and \"machine.config\" files.\n\nSearch each file for the \"defaultProxy\" element.\n\n<defaultProxy\n  enabled=\"true|false\"\n  useDefaultCredentials=\"true|false\"\n  <bypasslist> … </bypasslist>\n  <proxy> … </proxy>\n  <module> … </module>\n/>\n\nIf the \"defaultProxy\" setting \"enabled=false\" or if the \"bypasslist\", \"module\", or \"proxy\" child elements have configuration entries and there are no documented approvals from the IAO, this is a finding.\n\n If the \"defaultProxy\" element is empty or if \"useSystemDefault =True” then the framework is using default browser settings, this is not a finding.'\n  desc 'fix', 'Open Windows explorer and search for all \"*.exe.config\" and \"machine.config\" files.\n\nSearch each file for the \"defaultProxy\" element.\n\nClear the values contained in the \"defaultProxy\" element, and the \"bypasslist\", \"module\", and \"proxy\" child elements.\n\nThe IAO must provide documented approvals of any non-default proxy servers.'\n  impact 0.3\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26933r864036_chk'\n  tag severity: 'low'\n  tag gid: 'V-225234'\n  tag rid: 'SV-225234r864037_rule'\n  tag stig_id: 'APPNET0066'\n  tag gtitle: 'SRG-APP-000516'\n  tag fix_id: 'F-26921r468018_fix'\n  tag 'documentable'\n  tag legacy: ['SV-41014', 'V-30972']\n  tag cci: ['CCI-000366']\n  tag nist: ['CM-6 b']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225234.rb"},"title":".NET default proxy settings must be reviewed and approved.","desc":"The .Net framework can be configured to utilize a different proxy or altogether bypass the default proxy settings in the client's browser.  This may lead to the framework using a proxy that is not approved for use.  If the proxy is malicious, this could lead to a loss of application integrity and confidentiality.","descriptions":{"default":"The .Net framework can be configured to utilize a different proxy or altogether bypass the default proxy settings in the client's browser.  This may lead to the framework using a proxy that is not approved for use.  If the proxy is malicious, this could lead to a loss of application integrity and confidentiality.","check":"Open Windows explorer and search for all \"*.exe.config\" and \"machine.config\" files.\n\nSearch each file for the \"defaultProxy\" element.\n\n<defaultProxy\n  enabled=\"true|false\"\n  useDefaultCredentials=\"true|false\"\n  <bypasslist> … </bypasslist>\n  <proxy> … </proxy>\n  <module> … </module>\n/>\n\nIf the \"defaultProxy\" setting \"enabled=false\" or if the \"bypasslist\", \"module\", or \"proxy\" child elements have configuration entries and there are no documented approvals from the IAO, this is a finding.\n\n If the \"defaultProxy\" element is empty or if \"useSystemDefault =True” then the framework is using default browser settings, this is not a finding.","fix":"Open Windows explorer and search for all \"*.exe.config\" and \"machine.config\" files.\n\nSearch each file for the \"defaultProxy\" element.\n\nClear the values contained in the \"defaultProxy\" element, and the \"bypasslist\", \"module\", and \"proxy\" child elements.\n\nThe IAO must provide documented approvals of any non-default proxy servers."},"impact":0.3,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26933r864036_chk","severity":"low","gid":"V-225234","rid":"SV-225234r864037_rule","stig_id":"APPNET0066","gtitle":"SRG-APP-000516","fix_id":"F-26921r468018_fix","documentable":null,"legacy":["SV-41014","V-30972"],"cci":["CCI-000366"],"nist":["CM-6 b"]}},{"id":"SV-225235","code":"control 'SV-225235' do\n  title 'Event tracing for Windows (ETW) for Common Language Runtime events must be enabled.'\n  desc 'Event tracing captures information about applications utilizing the .NET CLR and the .NET CLR itself. This includes security oriented information, such as Strong Name and Authenticode verification.  \n\nBeginning with Windows Vista, ETW is enabled by default however, the .Net CLR and .Net applications can be configured to not utilize Event Tracing. If ETW event tracing is disabled, critical events that occurred within the runtime will not be captured in event logs.'\n  desc 'check', 'Open Windows explorer and search for all .NET config files including application config files (*.exe.config)\n\nNOTE:\nBeginning with Windows Vista and Windows Server 2008, ETW Tracing is enabled by default and the \"etwEnable\" setting is not required in order for Event Tracing to be enabled.  An etwEnable setting of \"true\" IS required in earlier versions of Windows as ETW is disabled by default. \n\nExamine the configuration settings for \n<etwEnable enabled=\"false\" />.\n\nIf the \"etwEnable\" element is set to \"true\", this is not a finding.\n\nIf the \"etwEnable\" element is set to \"false\" and documented approvals by the IAO are not provided, this is a finding.'\n  desc 'fix', 'Open Windows explorer and search for all .NET config files including application config files (*.exe.config).\n\nExamine the configuration settings for \n<etwEnable enabled=\"false\" />.\n\nEnable ETW Tracing by setting the etwEnable flag to \"true\" or obtain documented IAO approvals.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26934r468020_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225235'\n  tag rid: 'SV-225235r615940_rule'\n  tag stig_id: 'APPNET0067'\n  tag gtitle: 'SRG-APP-000095'\n  tag fix_id: 'F-26922r468021_fix'\n  tag 'documentable'\n  tag legacy: ['SV-41075', 'V-31026']\n  tag cci: ['CCI-000130']\n  tag nist: ['AU-3 a']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225235.rb"},"title":"Event tracing for Windows (ETW) for Common Language Runtime events must be enabled.","desc":"Event tracing captures information about applications utilizing the .NET CLR and the .NET CLR itself. This includes security oriented information, such as Strong Name and Authenticode verification.  \n\nBeginning with Windows Vista, ETW is enabled by default however, the .Net CLR and .Net applications can be configured to not utilize Event Tracing. If ETW event tracing is disabled, critical events that occurred within the runtime will not be captured in event logs.","descriptions":{"default":"Event tracing captures information about applications utilizing the .NET CLR and the .NET CLR itself. This includes security oriented information, such as Strong Name and Authenticode verification.  \n\nBeginning with Windows Vista, ETW is enabled by default however, the .Net CLR and .Net applications can be configured to not utilize Event Tracing. If ETW event tracing is disabled, critical events that occurred within the runtime will not be captured in event logs.","check":"Open Windows explorer and search for all .NET config files including application config files (*.exe.config)\n\nNOTE:\nBeginning with Windows Vista and Windows Server 2008, ETW Tracing is enabled by default and the \"etwEnable\" setting is not required in order for Event Tracing to be enabled.  An etwEnable setting of \"true\" IS required in earlier versions of Windows as ETW is disabled by default. \n\nExamine the configuration settings for \n<etwEnable enabled=\"false\" />.\n\nIf the \"etwEnable\" element is set to \"true\", this is not a finding.\n\nIf the \"etwEnable\" element is set to \"false\" and documented approvals by the IAO are not provided, this is a finding.","fix":"Open Windows explorer and search for all .NET config files including application config files (*.exe.config).\n\nExamine the configuration settings for \n<etwEnable enabled=\"false\" />.\n\nEnable ETW Tracing by setting the etwEnable flag to \"true\" or obtain documented IAO approvals."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26934r468020_chk","severity":"medium","gid":"V-225235","rid":"SV-225235r615940_rule","stig_id":"APPNET0067","gtitle":"SRG-APP-000095","fix_id":"F-26922r468021_fix","documentable":null,"legacy":["SV-41075","V-31026"],"cci":["CCI-000130"],"nist":["AU-3 a"]}},{"id":"SV-225236","code":"control 'SV-225236' do\n  title 'Software utilizing .Net 4.0 must be identified and relevant access controls configured.'\n  desc 'With the advent of .Net 4.0, the .Net framework no longer directly configures or enforces security policy for .Net applications.  This task is now relegated to the operating system layer and the security protections built-in to .Net application \"runtime hosts\" that run on the O.S. \n\nExamples of these .Net \"runtime hosts\" include; Internet Explorer, Windows Shell, ASP.NET, Database Engines or any other \"runtime hosts\" that utilize .Net and load the .Net CLR.\n\nSecurity protections include utilizing runtime host security controls such as sandboxing to restrict or control application behavior as designed or required.  \n\nTo compensate for these design changes, Windows provides native solutions such as Software Security Policies (SSP) and Application Locker (AL) which are technologies that can be implemented via Group Policy (GPO).  SSP, AL and similar third party solutions serve to restrict execution of applications, scripts and libraries based upon cryptographic hash, security zones, path and certificate values that are associated with the application files.  Additionally, application developers will utilize \"sandboxing\" techniques within their code in order to isolate 3rd party code libraries from critical system resources.\n\nIn order to assign protections to .Net 4.0 applications, the applications must first be identified and the appropriate hosting security mechanisms configured to accomplish that task.  \n\n.Net STIG guidance cannot be applied if .Net applications are not identified and documented.  The lack of an application inventory introduces confidentiality, availability and integrity vulnerabilities to the system.'\n  desc 'check', 'This requirement does not apply to the \"caspol.exe\" assembly or other assemblies provided with the Windows OS or the Windows Secure Host Baseline (SHB).\n\nAsk the system administrator to provide documentation that identifies:\n\n- Each .Net 4.0 application they run on the system.\n- The .Net runtime host that invokes the application. \n- The security measures employed to control application access to system resources or user access to application.\n\nIf all .Net applications, runtime hosts and security protections have been documented or if there are no .Net 4.0 applications existing on the system, this is not a finding.\n\nIf there is no documentation that identifies the existence of .NET 4.0 applications or the lack thereof, this is a finding.\n\nIf the runtime hosts have not been identified, this is a finding.\n\nIf the security protections have not been identified, this is a finding.'\n  desc 'fix', 'Document the existence of all .Net 4.0 applications that are not provided by the host Windows OS or the Windows Secure Host Baseline (SHB).\n\nDocument the corresponding runtime hosts that are used to invoke the applications.\n\nDocument the applications security control requirements (restricting application access to resources or user access to the application).'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26935r468023_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225236'\n  tag rid: 'SV-225236r849749_rule'\n  tag stig_id: 'APPNET0070'\n  tag gtitle: 'SRG-APP-000431'\n  tag fix_id: 'F-26923r468024_fix'\n  tag 'documentable'\n  tag legacy: ['SV-41030', 'V-30986']\n  tag cci: ['CCI-002530']\n  tag nist: ['SC-39']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225236.rb"},"title":"Software utilizing .Net 4.0 must be identified and relevant access controls configured.","desc":"With the advent of .Net 4.0, the .Net framework no longer directly configures or enforces security policy for .Net applications.  This task is now relegated to the operating system layer and the security protections built-in to .Net application \"runtime hosts\" that run on the O.S. \n\nExamples of these .Net \"runtime hosts\" include; Internet Explorer, Windows Shell, ASP.NET, Database Engines or any other \"runtime hosts\" that utilize .Net and load the .Net CLR.\n\nSecurity protections include utilizing runtime host security controls such as sandboxing to restrict or control application behavior as designed or required.  \n\nTo compensate for these design changes, Windows provides native solutions such as Software Security Policies (SSP) and Application Locker (AL) which are technologies that can be implemented via Group Policy (GPO).  SSP, AL and similar third party solutions serve to restrict execution of applications, scripts and libraries based upon cryptographic hash, security zones, path and certificate values that are associated with the application files.  Additionally, application developers will utilize \"sandboxing\" techniques within their code in order to isolate 3rd party code libraries from critical system resources.\n\nIn order to assign protections to .Net 4.0 applications, the applications must first be identified and the appropriate hosting security mechanisms configured to accomplish that task.  \n\n.Net STIG guidance cannot be applied if .Net applications are not identified and documented.  The lack of an application inventory introduces confidentiality, availability and integrity vulnerabilities to the system.","descriptions":{"default":"With the advent of .Net 4.0, the .Net framework no longer directly configures or enforces security policy for .Net applications.  This task is now relegated to the operating system layer and the security protections built-in to .Net application \"runtime hosts\" that run on the O.S. \n\nExamples of these .Net \"runtime hosts\" include; Internet Explorer, Windows Shell, ASP.NET, Database Engines or any other \"runtime hosts\" that utilize .Net and load the .Net CLR.\n\nSecurity protections include utilizing runtime host security controls such as sandboxing to restrict or control application behavior as designed or required.  \n\nTo compensate for these design changes, Windows provides native solutions such as Software Security Policies (SSP) and Application Locker (AL) which are technologies that can be implemented via Group Policy (GPO).  SSP, AL and similar third party solutions serve to restrict execution of applications, scripts and libraries based upon cryptographic hash, security zones, path and certificate values that are associated with the application files.  Additionally, application developers will utilize \"sandboxing\" techniques within their code in order to isolate 3rd party code libraries from critical system resources.\n\nIn order to assign protections to .Net 4.0 applications, the applications must first be identified and the appropriate hosting security mechanisms configured to accomplish that task.  \n\n.Net STIG guidance cannot be applied if .Net applications are not identified and documented.  The lack of an application inventory introduces confidentiality, availability and integrity vulnerabilities to the system.","check":"This requirement does not apply to the \"caspol.exe\" assembly or other assemblies provided with the Windows OS or the Windows Secure Host Baseline (SHB).\n\nAsk the system administrator to provide documentation that identifies:\n\n- Each .Net 4.0 application they run on the system.\n- The .Net runtime host that invokes the application. \n- The security measures employed to control application access to system resources or user access to application.\n\nIf all .Net applications, runtime hosts and security protections have been documented or if there are no .Net 4.0 applications existing on the system, this is not a finding.\n\nIf there is no documentation that identifies the existence of .NET 4.0 applications or the lack thereof, this is a finding.\n\nIf the runtime hosts have not been identified, this is a finding.\n\nIf the security protections have not been identified, this is a finding.","fix":"Document the existence of all .Net 4.0 applications that are not provided by the host Windows OS or the Windows Secure Host Baseline (SHB).\n\nDocument the corresponding runtime hosts that are used to invoke the applications.\n\nDocument the applications security control requirements (restricting application access to resources or user access to the application)."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26935r468023_chk","severity":"medium","gid":"V-225236","rid":"SV-225236r849749_rule","stig_id":"APPNET0070","gtitle":"SRG-APP-000431","fix_id":"F-26923r468024_fix","documentable":null,"legacy":["SV-41030","V-30986"],"cci":["CCI-002530"],"nist":["SC-39"]}},{"id":"SV-225237","code":"control 'SV-225237' do\n  title 'Remoting Services TCP channels must utilize authentication and encryption.'\n  desc 'Note: Microsoft recommends using the Windows Communication Framework (WCF) rather than .Net remoting. New development projects should refrain from using .Net remoting capabilities whenever possible.\n\n.NET remoting provides the capability to build widely distributed applications. The application components may reside all on one computer or they may be spread out across the enclave. .NET client applications can make remoting calls to use objects in other processes on the same computer or on any other computer that is reachable over the network. .NET remoting can also be used to communicate with other application domains within the same process.  Remoting is achieved via the exposure of endpoints that can be used to establish remote connectivity.\n\nNormally when application code attempts to access a protected resource, a stack walk is performed to ensure that all stack frames have permission to access the resource. However, with .Net 4.0, when a call is made on a remote object, this stack walk is not performed across the remoting boundary. The .Net remoting infrastructure requires FullTrust permission to execute on either the client or the server. \n\nDue to the fact that FullTrust permission is required, Remoting endpoints should be authenticated and encrypted in order to protect the system and the data. \n\nMicrosoft provides 3 different \"channels\" that are used for remoting.  They are HTTP, TCP and IPC.\n\nAny unauthorized use of a remoting application provides unauthorized access with FullTrust permissions to the system. This can potentially result in a loss of system integrity or confidentiality.'\n  desc 'check', %q(Check the machine.config and the [application executable name].exe.config configuration files. \n\nFor 32 bit systems, the \"machine.config\" file is contained in the following folder. %SYSTEMROOT%\\Microsoft.NET\\Framework\\v4.0.30319\\Config \n\nFor 64 bit systems, the \"machine.config\" file is contained in the following folder. %SYSTEMROOT%\\Microsoft.NET\\Framework64\\v4.0.30319\\Config.\n\nMicrosoft specifies locating the application config file in the same folder as the application executable (.exe) file. However, the developer does have the capability to specify a different location when the application is compiled.  Therefore, if the config file is not found in the application home folder, a search of the system is required. If the [application name].exe.config file is not found on the system, then only a check of the machine.config file is required.\n\nSample machine/application config file:\n\n<application name=“remoteserver”> \n  <service> \n    <activated type=“sample.my.object, myobjects”/> \n  </service> \n  <channels> \n    <channel ref=“tcp server” port=“6134”/> \n  </channels> \n</application>\n\n<serverProviders>\n  <provider ref=\"wsdl\" />\n  <formatter ref=\"soap\" typeFilterLevel=\"Full\" /> \n  <formatter ref=\"binary\" typeFilterLevel=\"Full\" /> \n</serverProviders> \n\nMicrosoft provides 3 \"channels\" that are used for remoting connectivity.  They are the HTTP, TCP, and IPC channels.  The channel that is used is specified via the <channels> element in the config file.  \n\nTCP channel example:\n<channel ref=“tcp” port=“6134” secure=\"true\"/> \n\nThe TCP Channel provides encryption and message integrity when the 'secure' flag is set to true as shown in the above example.\n\nIf the secure flag is not set to \"true\" for the TCP channel, this is a finding.)\n  desc 'fix', 'Ensure encryption and message integrity are used for TCP remoting channels.\n\nTCP remoting connections are protected via the secure=true configuration parameter.\n<channels>\n   <channel ref=\"tcp\" secure=\"true\" />\n</channels>\n\nInclude the secure=\"true\" flag in the channel ref parameter of the machine.config and [application name].exe.config file if the [application name].exe.config file exists on the system.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26936r468026_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225237'\n  tag rid: 'SV-225237r615940_rule'\n  tag stig_id: 'APPNET0071'\n  tag gtitle: 'SRG-APP-000219'\n  tag fix_id: 'F-26924r468027_fix'\n  tag 'documentable'\n  tag legacy: ['SV-42341', 'V-32025']\n  tag cci: ['CCI-001184']\n  tag nist: ['SC-23']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225237.rb"},"title":"Remoting Services TCP channels must utilize authentication and encryption.","desc":"Note: Microsoft recommends using the Windows Communication Framework (WCF) rather than .Net remoting. New development projects should refrain from using .Net remoting capabilities whenever possible.\n\n.NET remoting provides the capability to build widely distributed applications. The application components may reside all on one computer or they may be spread out across the enclave. .NET client applications can make remoting calls to use objects in other processes on the same computer or on any other computer that is reachable over the network. .NET remoting can also be used to communicate with other application domains within the same process.  Remoting is achieved via the exposure of endpoints that can be used to establish remote connectivity.\n\nNormally when application code attempts to access a protected resource, a stack walk is performed to ensure that all stack frames have permission to access the resource. However, with .Net 4.0, when a call is made on a remote object, this stack walk is not performed across the remoting boundary. The .Net remoting infrastructure requires FullTrust permission to execute on either the client or the server. \n\nDue to the fact that FullTrust permission is required, Remoting endpoints should be authenticated and encrypted in order to protect the system and the data. \n\nMicrosoft provides 3 different \"channels\" that are used for remoting.  They are HTTP, TCP and IPC.\n\nAny unauthorized use of a remoting application provides unauthorized access with FullTrust permissions to the system. This can potentially result in a loss of system integrity or confidentiality.","descriptions":{"default":"Note: Microsoft recommends using the Windows Communication Framework (WCF) rather than .Net remoting. New development projects should refrain from using .Net remoting capabilities whenever possible.\n\n.NET remoting provides the capability to build widely distributed applications. The application components may reside all on one computer or they may be spread out across the enclave. .NET client applications can make remoting calls to use objects in other processes on the same computer or on any other computer that is reachable over the network. .NET remoting can also be used to communicate with other application domains within the same process.  Remoting is achieved via the exposure of endpoints that can be used to establish remote connectivity.\n\nNormally when application code attempts to access a protected resource, a stack walk is performed to ensure that all stack frames have permission to access the resource. However, with .Net 4.0, when a call is made on a remote object, this stack walk is not performed across the remoting boundary. The .Net remoting infrastructure requires FullTrust permission to execute on either the client or the server. \n\nDue to the fact that FullTrust permission is required, Remoting endpoints should be authenticated and encrypted in order to protect the system and the data. \n\nMicrosoft provides 3 different \"channels\" that are used for remoting.  They are HTTP, TCP and IPC.\n\nAny unauthorized use of a remoting application provides unauthorized access with FullTrust permissions to the system. This can potentially result in a loss of system integrity or confidentiality.","check":"Check the machine.config and the [application executable name].exe.config configuration files. \n\nFor 32 bit systems, the \"machine.config\" file is contained in the following folder. %SYSTEMROOT%\\Microsoft.NET\\Framework\\v4.0.30319\\Config \n\nFor 64 bit systems, the \"machine.config\" file is contained in the following folder. %SYSTEMROOT%\\Microsoft.NET\\Framework64\\v4.0.30319\\Config.\n\nMicrosoft specifies locating the application config file in the same folder as the application executable (.exe) file. However, the developer does have the capability to specify a different location when the application is compiled.  Therefore, if the config file is not found in the application home folder, a search of the system is required. If the [application name].exe.config file is not found on the system, then only a check of the machine.config file is required.\n\nSample machine/application config file:\n\n<application name=“remoteserver”> \n  <service> \n    <activated type=“sample.my.object, myobjects”/> \n  </service> \n  <channels> \n    <channel ref=“tcp server” port=“6134”/> \n  </channels> \n</application>\n\n<serverProviders>\n  <provider ref=\"wsdl\" />\n  <formatter ref=\"soap\" typeFilterLevel=\"Full\" /> \n  <formatter ref=\"binary\" typeFilterLevel=\"Full\" /> \n</serverProviders> \n\nMicrosoft provides 3 \"channels\" that are used for remoting connectivity.  They are the HTTP, TCP, and IPC channels.  The channel that is used is specified via the <channels> element in the config file.  \n\nTCP channel example:\n<channel ref=“tcp” port=“6134” secure=\"true\"/> \n\nThe TCP Channel provides encryption and message integrity when the 'secure' flag is set to true as shown in the above example.\n\nIf the secure flag is not set to \"true\" for the TCP channel, this is a finding.","fix":"Ensure encryption and message integrity are used for TCP remoting channels.\n\nTCP remoting connections are protected via the secure=true configuration parameter.\n<channels>\n   <channel ref=\"tcp\" secure=\"true\" />\n</channels>\n\nInclude the secure=\"true\" flag in the channel ref parameter of the machine.config and [application name].exe.config file if the [application name].exe.config file exists on the system."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26936r468026_chk","severity":"medium","gid":"V-225237","rid":"SV-225237r615940_rule","stig_id":"APPNET0071","gtitle":"SRG-APP-000219","fix_id":"F-26924r468027_fix","documentable":null,"legacy":["SV-42341","V-32025"],"cci":["CCI-001184"],"nist":["SC-23"]}},{"id":"SV-225238","code":"control 'SV-225238' do\n  title 'Disable TLS RC4 cipher in .Net'\n  desc 'Use of the RC4 cipher in TLS could allow an attacker to perform man-in-the-middle attacks and recover plaintext from encrypted sessions. Applications that target .Net version 4.x running on multiple Windows versions could be vulnerable to these types of attacks. The registry settings in this requirement will prevent .Net applications that target the 4.x framework from selecting and utilizing the Schannel.dll RC4 cipher for TLS connections. Applications that use TLS when connecting to remote systems will perform a handshake and negotiate the TLS version and cipher that is to be used between the client and the server. This is standard protocol for all TLS connections. If the server and client are not configured to use the same TLS version and cipher, the TLS connection may fail. Applications should be tested with these registry settings prior to production implementation of the fix in order to avoid application outages.'\n  desc 'check', 'Use regedit to review the following Windows registry keys:\n\nFor 32-bit systems: HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\.NETFramework\\\\v4.0.30319\\\\\n\nFor 64 bit systems:\nHKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\.NETFramework\\\\v4.0.30319\\\\\nHKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\.NETFramework\\\\v4.0.30319\\\\\n\nIf the “SchUseStrongCrypto” value name does not exist, or is not a REG_DWORD type set to “1”, this is a finding.'\n  desc 'fix', 'Use regedit to access the following registry key.\n\nFor 32-bit systems:\nHKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\.NETFramework\\\\v4.0.30319\\\\\n\nFor 64-bit systems: \nHKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\.NETFramework\\\\v4.0.30319\\\\\nHKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Wow6432Node\\\\Microsoft\\\\.NETFramework\\\\v4.0.30319\\\\\n\nModify or create the following Windows registry value: SchUseStrongCrypto\n\nSet SchUseStrongCrypto to a REG_DWORD value of “1”.'\n  impact 0.5\n  ref 'DPMS Target Microsoft DotNet Framework 4-0'\n  tag check_id: 'C-26937r622493_chk'\n  tag severity: 'medium'\n  tag gid: 'V-225238'\n  tag rid: 'SV-225238r849750_rule'\n  tag stig_id: 'APPNET0075'\n  tag gtitle: 'SRG-APP-000383'\n  tag fix_id: 'F-26925r622494_fix'\n  tag 'documentable'\n  tag legacy: ['SV-96209', 'V-81495']\n  tag cci: ['CCI-001762']\n  tag nist: ['CM-7 (1) (b)']\nend","source_location":{"line":1,"ref":"U_MS_DotNet_Framework_4-0_STIG_V2R2/controls/SV-225238.rb"},"title":"Disable TLS RC4 cipher in .Net","desc":"Use of the RC4 cipher in TLS could allow an attacker to perform man-in-the-middle attacks and recover plaintext from encrypted sessions. Applications that target .Net version 4.x running on multiple Windows versions could be vulnerable to these types of attacks. The registry settings in this requirement will prevent .Net applications that target the 4.x framework from selecting and utilizing the Schannel.dll RC4 cipher for TLS connections. Applications that use TLS when connecting to remote systems will perform a handshake and negotiate the TLS version and cipher that is to be used between the client and the server. This is standard protocol for all TLS connections. If the server and client are not configured to use the same TLS version and cipher, the TLS connection may fail. Applications should be tested with these registry settings prior to production implementation of the fix in order to avoid application outages.","descriptions":{"default":"Use of the RC4 cipher in TLS could allow an attacker to perform man-in-the-middle attacks and recover plaintext from encrypted sessions. Applications that target .Net version 4.x running on multiple Windows versions could be vulnerable to these types of attacks. The registry settings in this requirement will prevent .Net applications that target the 4.x framework from selecting and utilizing the Schannel.dll RC4 cipher for TLS connections. Applications that use TLS when connecting to remote systems will perform a handshake and negotiate the TLS version and cipher that is to be used between the client and the server. This is standard protocol for all TLS connections. If the server and client are not configured to use the same TLS version and cipher, the TLS connection may fail. Applications should be tested with these registry settings prior to production implementation of the fix in order to avoid application outages.","check":"Use regedit to review the following Windows registry keys:\n\nFor 32-bit systems: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\v4.0.30319\\\n\nFor 64 bit systems:\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\v4.0.30319\\\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\.NETFramework\\v4.0.30319\\\n\nIf the “SchUseStrongCrypto” value name does not exist, or is not a REG_DWORD type set to “1”, this is a finding.","fix":"Use regedit to access the following registry key.\n\nFor 32-bit systems:\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\v4.0.30319\\\n\nFor 64-bit systems: \nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\.NETFramework\\v4.0.30319\\\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\.NETFramework\\v4.0.30319\\\n\nModify or create the following Windows registry value: SchUseStrongCrypto\n\nSet SchUseStrongCrypto to a REG_DWORD value of “1”."},"impact":0.5,"refs":[{"ref":"DPMS Target Microsoft DotNet Framework 4-0"}],"tags":{"check_id":"C-26937r622493_chk","severity":"medium","gid":"V-225238","rid":"SV-225238r849750_rule","stig_id":"APPNET0075","gtitle":"SRG-APP-000383","fix_id":"F-26925r622494_fix","documentable":null,"legacy":["SV-96209","V-81495"],"cci":["CCI-001762"],"nist":["CM-7 (1) (b)"]}}],"groups":[{"id":"controls/SV-225223.rb","title":null,"controls":["SV-225223"]},{"id":"controls/SV-225224.rb","title":null,"controls":["SV-225224"]},{"id":"controls/SV-225225.rb","title":null,"controls":["SV-225225"]},{"id":"controls/SV-225226.rb","title":null,"controls":["SV-225226"]},{"id":"controls/SV-225227.rb","title":null,"controls":["SV-225227"]},{"id":"controls/SV-225228.rb","title":null,"controls":["SV-225228"]},{"id":"controls/SV-225229.rb","title":null,"controls":["SV-225229"]},{"id":"controls/SV-225230.rb","title":null,"controls":["SV-225230"]},{"id":"controls/SV-225231.rb","title":null,"controls":["SV-225231"]},{"id":"controls/SV-225232.rb","title":null,"controls":["SV-225232"]},{"id":"controls/SV-225233.rb","title":null,"controls":["SV-225233"]},{"id":"controls/SV-225234.rb","title":null,"controls":["SV-225234"]},{"id":"controls/SV-225235.rb","title":null,"controls":["SV-225235"]},{"id":"controls/SV-225236.rb","title":null,"controls":["SV-225236"]},{"id":"controls/SV-225237.rb","title":null,"controls":["SV-225237"]},{"id":"controls/SV-225238.rb","title":null,"controls":["SV-225238"]}],"name":"MS_Dot_Net_Framework","title":null,"maintainer":null,"copyright":null,"copyright_email":null,"license":null,"summary":null,"description":null,"version":"1.0.0","supports":[],"depends":[],"inspec_version":null,"inputs":[],"sha256":"66a355bbde0a7d717f673625bfbc0748c4312c34f0a1dc51229b6a2fb0a1581c","status_message":"","status":"loaded","generator":{"name":"inspec","version":"6.6.0"}}
